{
  assertRunOnServiceThread();
  if (!HdmiCecKeycode.isSupportedKeycode(keyCode)) {
    Slog.w(TAG,"Unsupported key: " + keyCode);
    return;
  }
  List<SendKeyAction> action=getActions(SendKeyAction.class);
  if (!action.isEmpty()) {
    action.get(0).processKeyEvent(keyCode,isPressed);
  }
 else {
    if (isPressed && getActiveSource().isValid()) {
      int logicalAddress=getActiveSource().logicalAddress;
      addAndStartAction(new SendKeyAction(this,logicalAddress,keyCode));
    }
 else {
      Slog.w(TAG,"Discard key event: " + keyCode + " pressed:"+ isPressed);
    }
  }
}
