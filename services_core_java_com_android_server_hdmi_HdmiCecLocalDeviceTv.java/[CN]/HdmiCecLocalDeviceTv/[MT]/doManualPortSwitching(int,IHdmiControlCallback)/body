{
  assertRunOnServiceThread();
  if (!mService.isValidPortId(portId)) {
    invokeCallback(callback,HdmiControlManager.RESULT_INCORRECT_MODE);
    return;
  }
  if (!mService.isControlEnabled()) {
    setActivePortId(portId);
    invokeCallback(callback,HdmiControlManager.RESULT_INCORRECT_MODE);
    return;
  }
  if (portId == getActivePortId()) {
    invokeCallback(callback,HdmiControlManager.RESULT_SUCCESS);
    return;
  }
  setActivePortId(portId);
  removeAction(RoutingControlAction.class);
  int oldPath=mService.portIdToPath(mService.portIdToPath(getActivePortId()));
  int newPath=mService.portIdToPath(portId);
  HdmiCecMessage routingChange=HdmiCecMessageBuilder.buildRoutingChange(mAddress,oldPath,newPath);
  mService.sendCecCommand(routingChange);
  addAndStartAction(new RoutingControlAction(this,newPath,false,callback));
}
