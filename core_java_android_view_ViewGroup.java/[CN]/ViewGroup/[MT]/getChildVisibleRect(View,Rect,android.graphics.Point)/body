{
  final RectF rect=mAttachInfo != null ? mAttachInfo.mTmpTransformRect : new RectF();
  rect.set(r);
  if (!child.hasIdentityMatrix()) {
    child.getMatrix().mapRect(rect);
  }
  final int dx=child.mLeft - mScrollX;
  final int dy=child.mTop - mScrollY;
  rect.offset(dx,dy);
  if (offset != null) {
    if (!child.hasIdentityMatrix()) {
      float[] position=mAttachInfo != null ? mAttachInfo.mTmpTransformLocation : new float[2];
      position[0]=offset.x;
      position[1]=offset.y;
      child.getMatrix().mapPoints(position);
      offset.x=(int)(position[0] + 0.5f);
      offset.y=(int)(position[1] + 0.5f);
    }
    offset.x+=dx;
    offset.y+=dy;
  }
  final int width=mRight - mLeft;
  final int height=mBottom - mTop;
  boolean rectIsVisible=true;
  if (mParent instanceof ViewGroup && ((ViewGroup)mParent).getClipChildren()) {
    rectIsVisible=rect.intersect(0,0,width,height);
  }
  if (rectIsVisible && (mGroupFlags & CLIP_TO_PADDING_MASK) == CLIP_TO_PADDING_MASK) {
    rectIsVisible=rect.intersect(mPaddingLeft,mPaddingTop,width - mPaddingRight,height - mPaddingBottom);
  }
  if (rectIsVisible && mClipBounds != null) {
    rectIsVisible=rect.intersect(mClipBounds.left,mClipBounds.top,mClipBounds.right,mClipBounds.bottom);
  }
  r.set((int)(rect.left + 0.5f),(int)(rect.top + 0.5f),(int)(rect.right + 0.5f),(int)(rect.bottom + 0.5f));
  if (rectIsVisible && mParent != null) {
    rectIsVisible=mParent.getChildVisibleRect(this,r,offset);
  }
  return rectIsVisible;
}
