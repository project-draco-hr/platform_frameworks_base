{
  child.mLayoutParams=params;
  if (index < 0) {
    index=mChildrenCount;
  }
  addInArray(child,index);
  child.mParent=this;
  child.mPrivateFlags=(child.mPrivateFlags & ~PFLAG_DIRTY_MASK & ~PFLAG_DRAWING_CACHE_VALID) | PFLAG_DRAWN | PFLAG_INVALIDATED;
  this.mPrivateFlags|=PFLAG_INVALIDATED;
  if (child.hasFocus()) {
    requestChildFocus(child,child.findFocus());
  }
  dispatchVisibilityAggregated(isAttachedToWindow() && getWindowVisibility() == VISIBLE && isShown());
}
