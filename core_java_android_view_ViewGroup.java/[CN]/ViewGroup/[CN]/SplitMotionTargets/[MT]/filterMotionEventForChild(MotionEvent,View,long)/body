{
  int action=ev.getAction();
  final int maskedAction=action & MotionEvent.ACTION_MASK;
  if (maskedAction == MotionEvent.ACTION_POINTER_UP && get(ev.getPointerId(ev.getActionIndex())) != child) {
    return null;
  }
  int pointerCount=0;
  final int idCount=getIdCount();
  for (int i=0; i < idCount; i++) {
    if (targetAt(i) == child) {
      pointerCount++;
    }
  }
  int actionId=-1;
  boolean needsNewIndex=false;
  if (maskedAction == MotionEvent.ACTION_DOWN) {
    pointerCount++;
    actionId=ev.getPointerId(0);
  }
 else   if (maskedAction == MotionEvent.ACTION_POINTER_DOWN) {
    pointerCount++;
    actionId=ev.getPointerId(ev.getActionIndex());
    if (indexOfTarget(child) < 0) {
      action=MotionEvent.ACTION_DOWN;
    }
 else {
      needsNewIndex=true;
    }
  }
 else   if (maskedAction == MotionEvent.ACTION_POINTER_UP) {
    actionId=ev.getPointerId(ev.getActionIndex());
    if (pointerCount == 1) {
      action=MotionEvent.ACTION_UP;
    }
 else {
      needsNewIndex=true;
    }
  }
  if (pointerCount == 0) {
    return null;
  }
  final int eventPointerCount=ev.getPointerCount();
  int bucketIndex=0;
  int newActionIndex=-1;
  for (int evp=0; evp < eventPointerCount; evp++) {
    final int id=ev.getPointerId(evp);
    if (id == actionId || get(id) == child) {
      if (mPointerCoords.length <= bucketIndex) {
        int[] pointerIds=new int[pointerCount];
        MotionEvent.PointerCoords[] pointerCoords=new MotionEvent.PointerCoords[pointerCount];
        for (int i=mPointerCoords.length; i < pointerCoords.length; i++) {
          pointerCoords[i]=new MotionEvent.PointerCoords();
        }
        System.arraycopy(mPointerCoords,0,pointerCoords,0,mPointerCoords.length);
        System.arraycopy(mPointerIds,0,pointerIds,0,mPointerIds.length);
        mPointerCoords=pointerCoords;
        mPointerIds=pointerIds;
      }
      mPointerIds[bucketIndex]=id;
      ev.getPointerCoords(evp,mPointerCoords[bucketIndex]);
      if (needsNewIndex && id == actionId) {
        newActionIndex=bucketIndex;
      }
      bucketIndex++;
    }
  }
  if (newActionIndex >= 0) {
    action=(action & MotionEvent.ACTION_MASK) | (newActionIndex << MotionEvent.ACTION_POINTER_INDEX_SHIFT);
  }
  return MotionEvent.obtain(downTime,ev.getEventTime(),action,pointerCount,mPointerIds,mPointerCoords,ev.getMetaState(),ev.getXPrecision(),ev.getYPrecision(),ev.getDeviceId(),ev.getEdgeFlags(),ev.getSource(),ev.getFlags());
}
