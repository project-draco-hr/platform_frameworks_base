{
  int event;
switch (msg.what) {
case EVENT_DHCP_START:
    boolean modifiedBluetoothCoexistenceMode=false;
  int powerMode=DRIVER_POWER_MODE_AUTO;
if (shouldDisableCoexistenceMode()) {
  modifiedBluetoothCoexistenceMode=true;
synchronized (WifiStateTracker.this) {
    WifiNative.setBluetoothCoexistenceModeCommand(WifiNative.BLUETOOTH_COEXISTENCE_MODE_DISABLED);
  }
}
synchronized (WifiStateTracker.this) {
powerMode=WifiNative.getPowerModeCommand();
if (powerMode < 0) {
  powerMode=DRIVER_POWER_MODE_AUTO;
}
if (powerMode != DRIVER_POWER_MODE_ACTIVE) {
  WifiNative.setPowerModeCommand(DRIVER_POWER_MODE_ACTIVE);
}
}
synchronized (this) {
mCancelCallback=false;
}
Log.d(TAG,"DhcpHandler: DHCP request started");
if (NetworkUtils.runDhcp(mInterfaceName,mDhcpInfo)) {
event=EVENT_INTERFACE_CONFIGURATION_SUCCEEDED;
if (LOCAL_LOGD) Log.v(TAG,"DhcpHandler: DHCP request succeeded");
}
 else {
event=EVENT_INTERFACE_CONFIGURATION_FAILED;
Log.i(TAG,"DhcpHandler: DHCP request failed: " + NetworkUtils.getDhcpError());
}
synchronized (WifiStateTracker.this) {
if (powerMode != DRIVER_POWER_MODE_ACTIVE) {
WifiNative.setPowerModeCommand(powerMode);
}
}
if (modifiedBluetoothCoexistenceMode) {
synchronized (WifiStateTracker.this) {
WifiNative.setBluetoothCoexistenceModeCommand(WifiNative.BLUETOOTH_COEXISTENCE_MODE_SENSE);
}
}
synchronized (this) {
if (!mCancelCallback) {
mTarget.sendEmptyMessage(event);
}
}
break;
}
}
