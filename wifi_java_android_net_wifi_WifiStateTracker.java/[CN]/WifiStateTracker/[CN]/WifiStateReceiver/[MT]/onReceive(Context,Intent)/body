{
  if (intent.getAction().equals(WifiManager.NETWORK_STATE_CHANGED_ACTION)) {
    mNetworkInfo=(NetworkInfo)intent.getParcelableExtra(WifiManager.EXTRA_NETWORK_INFO);
    mLinkProperties=intent.getParcelableExtra(WifiManager.EXTRA_LINK_PROPERTIES);
    if (mLinkProperties == null) {
      mLinkProperties=new LinkProperties();
    }
    mNetworkCapabilities=intent.getParcelableExtra(WifiManager.EXTRA_NETWORK_CAPABILITIES);
    if (mNetworkCapabilities == null) {
      mNetworkCapabilities=new NetworkCapabilities();
    }
    mWifiInfo=intent.getParcelableExtra(WifiManager.EXTRA_WIFI_INFO);
    NetworkInfo.State state=mNetworkInfo.getState();
    if (mLastState == state && mNetworkInfo.getDetailedState() != DetailedState.CAPTIVE_PORTAL_CHECK) {
      return;
    }
 else {
      mLastState=state;
      mSamplingDataTracker.resetSamplingData();
    }
    Message msg=mCsHandler.obtainMessage(EVENT_STATE_CHANGED,new NetworkInfo(mNetworkInfo));
    msg.sendToTarget();
  }
 else   if (intent.getAction().equals(WifiManager.LINK_CONFIGURATION_CHANGED_ACTION)) {
    mLinkProperties=intent.getParcelableExtra(WifiManager.EXTRA_LINK_PROPERTIES);
    Message msg=mCsHandler.obtainMessage(EVENT_CONFIGURATION_CHANGED,mNetworkInfo);
    msg.sendToTarget();
  }
}
