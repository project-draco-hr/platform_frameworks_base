{
  final PositionMetadata posMetadata=mConnector.getUnflattenedPos(position);
  id=getChildOrGroupId(posMetadata.position);
  boolean returnValue;
  if (posMetadata.position.type == ExpandableListPosition.GROUP) {
    if (posMetadata.isExpanded()) {
      mConnector.collapseGroup(posMetadata);
      playSoundEffect(SoundEffectConstants.CLICK);
      if (mOnGroupCollapseListener != null) {
        mOnGroupCollapseListener.onGroupCollapse(posMetadata.position.groupPos);
      }
    }
 else {
      if (mOnGroupClickListener != null) {
        if (mOnGroupClickListener.onGroupClick(this,v,posMetadata.position.groupPos,id)) {
          posMetadata.recycle();
          return true;
        }
      }
      mConnector.expandGroup(posMetadata);
      playSoundEffect(SoundEffectConstants.CLICK);
      if (mOnGroupExpandListener != null) {
        mOnGroupExpandListener.onGroupExpand(posMetadata.position.groupPos);
      }
    }
    returnValue=true;
  }
 else {
    if (mOnChildClickListener != null) {
      playSoundEffect(SoundEffectConstants.CLICK);
      return mOnChildClickListener.onChildClick(this,v,posMetadata.position.groupPos,posMetadata.position.childPos,id);
    }
    returnValue=false;
  }
  posMetadata.recycle();
  return returnValue;
}
