{
  int energy=0;
  int count=0;
  if (mVisualizer != null) {
    mVisualizer.setEnabled(true);
    for (int i=0; i < 10; i++) {
      if (mVisualizer.getFft(mFft) == Visualizer.SUCCESS) {
        int bin=freq / (22050 / 1024);
        int tmp=0;
        for (int j=bin - 2; j < bin + 3; j++) {
          tmp+=(int)mFft[j] * (int)mFft[j];
        }
        energy+=tmp / 5;
        count++;
      }
      Thread.sleep(50);
    }
    mVisualizer.setEnabled(false);
  }
  if (count == 0) {
    return 0;
  }
  return energy / count;
}
