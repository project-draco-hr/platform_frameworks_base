{
  boolean result=false;
  String msg="test2_0SoundModification()";
  EnergyProbe probe=null;
  AudioEffect vc=null;
  MediaPlayer mp=null;
  AudioManager am=(AudioManager)getActivity().getSystemService(Context.AUDIO_SERVICE);
  int volume=am.getStreamMaxVolume(AudioManager.STREAM_MUSIC);
  am.setStreamVolume(AudioManager.STREAM_MUSIC,TEST_VOLUME,0);
  try {
    probe=new EnergyProbe(0);
    vc=new AudioEffect(AudioEffect.EFFECT_TYPE_NULL,UUID.fromString("119341a0-8469-11df-81f9-0002a5d5c51b"),0,0);
    vc.setEnabled(true);
    mp=new MediaPlayer();
    mp.setDataSource(MediaNames.SINE_200_1000);
    mp.setAudioStreamType(AudioManager.STREAM_MUSIC);
    getVirtualizer(mp.getAudioSessionId());
    mp.prepare();
    mp.start();
    Thread.sleep(200);
    int refEnergy200=probe.capture(200);
    int refEnergy1000=probe.capture(1000);
    mVirtualizer.setStrength((short)1000);
    mVirtualizer.setEnabled(true);
    Thread.sleep(500);
    int energy200=probe.capture(200);
    int energy1000=probe.capture(1000);
    assertTrue(msg + ": virtiualizer has no effect",((float)energy200 / (float)energy1000) > (MIN_ENERGY_RATIO_2 * ((float)refEnergy200 / (float)refEnergy1000)));
    result=true;
  }
 catch (  IllegalArgumentException e) {
    msg=msg.concat(": Bad parameter value");
    loge(msg,"Bad parameter value");
  }
catch (  UnsupportedOperationException e) {
    msg=msg.concat(": get parameter() rejected");
    loge(msg,"get parameter() rejected");
  }
catch (  IllegalStateException e) {
    msg=msg.concat("get parameter() called in wrong state");
    loge(msg,"get parameter() called in wrong state");
  }
catch (  InterruptedException e) {
    loge(msg,"sleep() interrupted");
  }
 finally {
    releaseVirtualizer();
    if (mp != null) {
      mp.release();
    }
    if (vc != null) {
      vc.release();
    }
    if (probe != null) {
      probe.release();
    }
    am.setStreamVolume(AudioManager.STREAM_MUSIC,volume,0);
  }
  assertTrue(msg,result);
}
