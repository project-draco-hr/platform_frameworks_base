{
  boolean becomeInactive=false;
  if (mState != STATE_ACTIVE) {
    scheduleReportActiveLocked(type,Process.myUid());
    mState=STATE_ACTIVE;
    mInactiveTimeout=timeout;
    mCurIdleBudget=0;
    mMaintenanceStartTime=0;
    EventLogTags.writeDeviceIdle(mState,type);
    addEvent(EVENT_NORMAL);
    becomeInactive=true;
  }
  if (mLightState == LIGHT_STATE_OVERRIDE) {
    mLightState=STATE_ACTIVE;
    EventLogTags.writeDeviceIdleLight(mLightState,type);
    becomeInactive=true;
  }
  if (becomeInactive) {
    becomeInactiveIfAppropriateLocked();
  }
}
