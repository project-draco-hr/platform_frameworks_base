{
  if (mState == STATE_IDLE_MAINTENANCE || mLightState == LIGHT_STATE_IDLE_MAINTENANCE) {
    if (mActiveIdleOpCount <= 0 && mDownloadServiceActive == null && !mJobsActive && !mAlarmsActive) {
      final long now=SystemClock.elapsedRealtime();
      if (DEBUG) {
        StringBuilder sb=new StringBuilder();
        sb.append("Exit: start=");
        TimeUtils.formatDuration(mMaintenanceStartTime,sb);
        sb.append(" now=");
        TimeUtils.formatDuration(now,sb);
        Slog.d(TAG,sb.toString());
      }
      if (mState == STATE_IDLE_MAINTENANCE) {
        if (now >= (mMaintenanceStartTime + mConstants.MIN_DEEP_MAINTENANCE_TIME)) {
          stepIdleStateLocked("s:early");
        }
      }
 else {
        if (now >= (mMaintenanceStartTime + mConstants.MIN_LIGHT_MAINTENANCE_TIME)) {
          stepLightIdleStateLocked("s:early");
        }
      }
    }
  }
}
