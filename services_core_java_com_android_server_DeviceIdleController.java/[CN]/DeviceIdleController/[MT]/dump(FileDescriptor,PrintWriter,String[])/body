{
  if (getContext().checkCallingOrSelfPermission(android.Manifest.permission.DUMP) != PackageManager.PERMISSION_GRANTED) {
    pw.println("Permission Denial: can't dump DeviceIdleController from from pid=" + Binder.getCallingPid() + ", uid="+ Binder.getCallingUid()+ " without permission "+ android.Manifest.permission.DUMP);
    return;
  }
  if (args != null) {
    for (int i=0; i < args.length; i++) {
      String arg=args[i];
      if ("-h".equals(arg)) {
        dumpHelp(pw);
        return;
      }
 else       if ("-a".equals(arg)) {
      }
 else       if ("step".equals(arg)) {
synchronized (this) {
          stepIdleStateLocked();
          pw.print("Stepped to: ");
          pw.println(stateToString(mState));
        }
        return;
      }
 else       if ("disable".equals(arg)) {
synchronized (this) {
          if (!mIdleDisabled) {
            mIdleDisabled=true;
            becomeActiveLocked("disabled");
            pw.println("Idle mode disabled");
          }
        }
        return;
      }
 else       if ("enable".equals(arg)) {
synchronized (this) {
          if (mIdleDisabled) {
            mIdleDisabled=false;
            becomeInactiveIfAppropriateLocked();
            pw.println("Idle mode enabled");
          }
        }
        return;
      }
 else       if ("whitelist".equals(arg)) {
        i++;
        while (i < args.length) {
          arg=args[i];
          i++;
          if (arg.length() < 1 || (arg.charAt(0) != '-' && arg.charAt(0) != '+')) {
            pw.println("Package must be prefixed with + or -: " + arg);
            return;
          }
          char op=arg.charAt(0);
          String pkg=arg.substring(1);
          if (op == '+') {
            if (addPowerSaveWhitelistAppInternal(pkg)) {
              pw.println("Added: " + pkg);
            }
 else {
              pw.println("Unknown package: " + pkg);
            }
          }
 else {
            if (removePowerSaveWhitelistAppInternal(pkg)) {
              pw.println("Removed: " + pkg);
            }
          }
        }
        return;
      }
 else       if (arg.length() > 0 && arg.charAt(0) == '-') {
        pw.println("Unknown option: " + arg);
        return;
      }
 else {
        pw.println("Unknown command: " + arg);
        return;
      }
    }
  }
synchronized (this) {
    int size=mPowerSaveWhitelistApps.size();
    if (size > 0) {
      pw.println("  Whitelist system apps:");
      for (int i=0; i < size; i++) {
        pw.print("    ");
        pw.println(mPowerSaveWhitelistApps.keyAt(i));
      }
    }
    size=mPowerSaveWhitelistUserApps.size();
    if (size > 0) {
      pw.println("  Whitelist user apps:");
      for (int i=0; i < size; i++) {
        pw.print("    ");
        pw.println(mPowerSaveWhitelistUserApps.keyAt(i));
      }
    }
    size=mPowerSaveWhitelistAppIds.size();
    if (size > 0) {
      pw.println("  Whitelist app uids:");
      for (int i=0; i < size; i++) {
        pw.print("    UID=");
        pw.print(mPowerSaveWhitelistAppIds.keyAt(i));
        pw.print(": ");
        pw.print(mPowerSaveWhitelistAppIds.valueAt(i));
        pw.println();
      }
    }
    pw.print("  mSigMotionSensor=");
    pw.println(mSigMotionSensor);
    pw.print("  mCurDisplay=");
    pw.println(mCurDisplay);
    pw.print("  mIdleDisabled=");
    pw.println(mIdleDisabled);
    pw.print("  mScreenOn=");
    pw.println(mScreenOn);
    pw.print("  mCharging=");
    pw.println(mCharging);
    pw.print("  mSigMotionActive=");
    pw.println(mSigMotionActive);
    pw.print("  mState=");
    pw.println(stateToString(mState));
    pw.print("  mInactiveTimeout=");
    TimeUtils.formatDuration(mInactiveTimeout,pw);
    pw.println();
    if (mNextAlarmTime != 0) {
      pw.print("  mNextAlarmTime=");
      TimeUtils.formatDuration(mNextAlarmTime,SystemClock.elapsedRealtime(),pw);
      pw.println();
    }
    if (mNextIdlePendingDelay != 0) {
      pw.print("  mNextIdlePendingDelay=");
      TimeUtils.formatDuration(mNextIdlePendingDelay,pw);
      pw.println();
    }
    if (mNextIdleDelay != 0) {
      pw.print("  mNextIdleDelay=");
      TimeUtils.formatDuration(mNextIdleDelay,pw);
      pw.println();
    }
  }
}
