{
  if (DEBUG)   Slog.d(TAG,"becomeInactiveIfAppropriateLocked()");
  if ((!mScreenOn && !mCharging) || mForceIdle) {
    if (mState == STATE_ACTIVE && mDeepEnabled) {
      mState=STATE_INACTIVE;
      if (DEBUG)       Slog.d(TAG,"Moved from STATE_ACTIVE to STATE_INACTIVE");
      resetIdleManagementLocked();
      scheduleAlarmLocked(mInactiveTimeout,false);
      EventLogTags.writeDeviceIdle(mState,"no activity");
    }
    if (mLightState == LIGHT_STATE_ACTIVE && mLightEnabled) {
      mLightState=LIGHT_STATE_INACTIVE;
      if (DEBUG)       Slog.d(TAG,"Moved from LIGHT_STATE_ACTIVE to LIGHT_STATE_INACTIVE");
      resetLightIdleManagementLocked();
      scheduleLightAlarmLocked(mConstants.LIGHT_IDLE_TIMEOUT);
      EventLogTags.writeDeviceIdleLight(mLightState,"no activity");
    }
  }
}
