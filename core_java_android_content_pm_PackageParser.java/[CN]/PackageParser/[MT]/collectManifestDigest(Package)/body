{
  pkg.manifestDigest=null;
  try {
    final StrictJarFile jarFile=new StrictJarFile(pkg.codePath);
    try {
      final ZipEntry je=jarFile.findEntry(ANDROID_MANIFEST_FILENAME);
      if (je != null) {
        pkg.manifestDigest=ManifestDigest.fromInputStream(jarFile.getInputStream(je));
      }
    }
  finally {
      jarFile.close();
    }
  }
 catch (  IOException|RuntimeException e) {
    throw new PackageParserException(INSTALL_PARSE_FAILED_MANIFEST_MALFORMED,"Failed to collect manifest digest");
  }
}
