{
  final String apkPath=apkFile.getAbsolutePath();
  try {
    final StrictJarFile jarFile=new StrictJarFile(apkPath);
    try {
      final ZipEntry jarEntry=jarFile.findEntry(ANDROID_MANIFEST_FILENAME);
      if (jarEntry == null) {
        throw new PackageParserException(INSTALL_PARSE_FAILED_MANIFEST_MALFORMED,"Package " + apkPath + " has no manifest");
      }
      final Certificate[][] certs=loadCertificates(jarFile,jarEntry);
      return convertToSignatures(certs);
    }
  finally {
      jarFile.close();
    }
  }
 catch (  GeneralSecurityException|IOException|RuntimeException e) {
    throw new PackageParserException(INSTALL_PARSE_FAILED_CERTIFICATE_ENCODING,"Failed to collect certificates from " + apkPath,e);
  }
}
