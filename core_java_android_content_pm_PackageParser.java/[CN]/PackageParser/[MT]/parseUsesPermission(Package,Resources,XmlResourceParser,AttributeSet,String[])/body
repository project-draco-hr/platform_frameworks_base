{
  TypedArray sa=res.obtainAttributes(attrs,com.android.internal.R.styleable.AndroidManifestUsesPermission);
  String name=sa.getNonResourceString(com.android.internal.R.styleable.AndroidManifestUsesPermission_name);
  boolean required=true;
  sa.recycle();
  if (name != null) {
    int index=pkg.requestedPermissions.indexOf(name);
    if (index == -1) {
      pkg.requestedPermissions.add(name.intern());
      pkg.requestedPermissionsRequired.add(required ? Boolean.TRUE : Boolean.FALSE);
    }
 else {
      if (pkg.requestedPermissionsRequired.get(index) != required) {
        outError[0]="conflicting <uses-permission> entries";
        mParseError=PackageManager.INSTALL_PARSE_FAILED_MANIFEST_MALFORMED;
        return false;
      }
    }
  }
  XmlUtils.skipCurrentTag(parser);
  return true;
}
