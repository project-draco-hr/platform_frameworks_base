{
  final Intent resolveIntent=new Intent();
  resolveIntent.setComponent(admin);
  final List<ResolveInfo> realResolveInfo=mRealTestContext.getPackageManager().queryBroadcastReceivers(resolveIntent,PackageManager.GET_META_DATA);
  assertNotNull(realResolveInfo);
  assertEquals(1,realResolveInfo.size());
  realResolveInfo.set(0,DpmTestUtils.cloneParcelable(realResolveInfo.get(0)));
  realResolveInfo.get(0).activityInfo.applicationInfo.uid=packageUid;
  doReturn(realResolveInfo).when(mMockContext.packageManager).queryBroadcastReceivers(MockUtils.checkIntentComponent(admin),eq(PackageManager.GET_META_DATA | PackageManager.GET_DISABLED_UNTIL_USED_COMPONENTS),eq(UserHandle.getUserId(packageUid)));
  final ApplicationInfo ai=DpmTestUtils.cloneParcelable(mRealTestContext.getPackageManager().getApplicationInfo(admin.getPackageName(),PackageManager.GET_DISABLED_UNTIL_USED_COMPONENTS));
  ai.enabledSetting=enabledSetting;
  ai.uid=packageUid;
  doReturn(ai).when(mMockContext.ipackageManager).getApplicationInfo(eq(admin.getPackageName()),eq(PackageManager.GET_DISABLED_UNTIL_USED_COMPONENTS),eq(UserHandle.getUserId(packageUid)));
  final PackageInfo pi=DpmTestUtils.cloneParcelable(mRealTestContext.getPackageManager().getPackageInfo(admin.getPackageName(),0));
  assertTrue(pi.applicationInfo.flags != 0);
  pi.applicationInfo.uid=packageUid;
  doReturn(pi).when(mMockContext.ipackageManager).getPackageInfo(eq(admin.getPackageName()),eq(0),eq(UserHandle.getUserId(packageUid)));
}
