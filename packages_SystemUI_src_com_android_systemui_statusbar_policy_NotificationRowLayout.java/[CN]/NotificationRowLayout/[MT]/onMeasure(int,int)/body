{
  final int count=getChildCount();
  int numRows=0;
  for (int i=0; i < count; i++) {
    final View child=getChildAt(i);
    if (child.getVisibility() == GONE) {
      continue;
    }
    if (mDisappearingViews.containsKey(child)) {
      continue;
    }
    numRows++;
  }
  if (numRows != mNumRows) {
    final int computedHeight=numRows * mRowHeight;
    if (DEBUG) {
      Slog.d(TAG,String.format("rows went from %d to %d, resizing to %dpx",mNumRows,numRows,computedHeight));
    }
    mNumRows=numRows;
    if (mAnimateBounds && isShown()) {
      ObjectAnimator.ofInt(this,"forcedHeight",computedHeight).setDuration(APPEAR_ANIM_LEN).start();
    }
 else {
      setForcedHeight(computedHeight);
    }
  }
  final int childWidthMS=widthMeasureSpec;
  final int childHeightMS=MeasureSpec.makeMeasureSpec(mRowHeight,MeasureSpec.EXACTLY);
  for (int i=0; i < count; i++) {
    final View child=getChildAt(i);
    if (child.getVisibility() == GONE) {
      continue;
    }
    child.measure(childWidthMS,childHeightMS);
  }
  setMeasuredDimension(getDefaultSize(getSuggestedMinimumWidth(),widthMeasureSpec),resolveSize(getForcedHeight(),heightMeasureSpec));
}
