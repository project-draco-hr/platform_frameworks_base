{
  String action=intent.getAction();
  if (DevicePolicyManager.ACTION_DEVICE_POLICY_MANAGER_STATE_CHANGED.equals(action)) {
    refreshAgentList(getSendingUserId());
    updateDevicePolicyFeatures();
  }
 else   if (Intent.ACTION_USER_PRESENT.equals(action)) {
    updateUserHasAuthenticated(getSendingUserId());
  }
 else   if (Intent.ACTION_USER_ADDED.equals(action)) {
    int userId=intent.getIntExtra(Intent.EXTRA_USER_HANDLE,-100);
    if (userId > 0) {
      maybeEnableFactoryTrustAgents(mLockPatternUtils,userId);
    }
 else {
      Log.wtf(TAG,"EXTRA_USER_HANDLE missing or invalid, value=" + userId);
    }
  }
}
