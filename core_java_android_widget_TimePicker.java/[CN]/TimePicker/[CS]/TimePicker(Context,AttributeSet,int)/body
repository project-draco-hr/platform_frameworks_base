{
  super(context,attrs,defStyle);
  LayoutInflater inflater=(LayoutInflater)context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
  inflater.inflate(R.layout.time_picker,this,true);
  mHourPicker=(NumberPicker)findViewById(R.id.hour);
  mHourPicker.setOnChangeListener(new NumberPicker.OnChangedListener(){
    public void onChanged(    NumberPicker spinner,    int oldVal,    int newVal){
      mCurrentHour=newVal;
      if (!mIs24HourView) {
        if (mCurrentHour == 12) {
          mCurrentHour=0;
        }
        if (!mIsAm) {
          mCurrentHour+=12;
        }
      }
      onTimeChanged();
    }
  }
);
  mMinutePicker=(NumberPicker)findViewById(R.id.minute);
  mMinutePicker.setRange(0,59);
  mMinutePicker.setSpeed(100);
  mMinutePicker.setFormatter(NumberPicker.TWO_DIGIT_FORMATTER);
  mMinutePicker.setOnChangeListener(new NumberPicker.OnChangedListener(){
    public void onChanged(    NumberPicker spinner,    int oldVal,    int newVal){
      mCurrentMinute=newVal;
      onTimeChanged();
    }
  }
);
  mAmPmButton=(Button)findViewById(R.id.amPm);
  configurePickerRanges();
  Calendar cal=Calendar.getInstance();
  setOnTimeChangedListener(NO_OP_CHANGE_LISTENER);
  setCurrentHour(cal.get(Calendar.HOUR_OF_DAY));
  setCurrentMinute(cal.get(Calendar.MINUTE));
  mIsAm=(mCurrentHour < 12);
  DateFormatSymbols dfs=new DateFormatSymbols();
  String[] dfsAmPm=dfs.getAmPmStrings();
  mAmText=dfsAmPm[Calendar.AM];
  mPmText=dfsAmPm[Calendar.PM];
  mAmPmButton.setText(mIsAm ? mAmText : mPmText);
  mAmPmButton.setOnClickListener(new OnClickListener(){
    public void onClick(    View v){
      requestFocus();
      if (mIsAm) {
        if (mCurrentHour < 12) {
          mCurrentHour+=12;
        }
      }
 else {
        if (mCurrentHour >= 12) {
          mCurrentHour-=12;
        }
      }
      mIsAm=!mIsAm;
      mAmPmButton.setText(mIsAm ? mAmText : mPmText);
      onTimeChanged();
    }
  }
);
  if (!isEnabled()) {
    setEnabled(false);
  }
}
