{
  boolean changed=false;
synchronized (mTrackedTasks) {
    if (mAppIdleParoleOn) {
      return;
    }
    for (    JobStatus task : mTrackedTasks) {
      if (task.job.getService().getPackageName().equals(packageName) && task.getUserId() == userId) {
        if (task.appNotIdleConstraintSatisfied.get() != !idle) {
          if (DEBUG) {
            Slog.d(LOG_TAG,"App Idle state changed, setting idle state of " + packageName + " to "+ idle);
          }
          task.appNotIdleConstraintSatisfied.set(!idle);
          changed=true;
        }
      }
    }
  }
  if (changed) {
    mStateChangedListener.onControllerStateChanged();
  }
}
