{
  if (!mHasFeature) {
    return null;
  }
  enforceCrossUserPermission(userHandle);
synchronized (this) {
    if (who == null) {
      throw new NullPointerException("ComponentName is null");
    }
    DevicePolicyData policy=getUserData(UserHandle.USER_OWNER);
    ActiveAdmin admin=getActiveAdminForCallerLocked(who,DeviceAdminInfo.USES_POLICY_SETS_GLOBAL_PROXY);
    Set<ComponentName> compSet=policy.mAdminMap.keySet();
    for (    ComponentName component : compSet) {
      ActiveAdmin ap=policy.mAdminMap.get(component);
      if ((ap.specifiesGlobalProxy) && (!component.equals(who))) {
        return component;
      }
    }
    if (UserHandle.getCallingUserId() != UserHandle.USER_OWNER) {
      Slog.w(LOG_TAG,"Only the owner is allowed to set the global proxy. User " + userHandle + " is not permitted.");
      return null;
    }
    if (proxySpec == null) {
      admin.specifiesGlobalProxy=false;
      admin.globalProxySpec=null;
      admin.globalProxyExclusionList=null;
    }
 else {
      admin.specifiesGlobalProxy=true;
      admin.globalProxySpec=proxySpec;
      admin.globalProxyExclusionList=exclusionList;
    }
    long origId=Binder.clearCallingIdentity();
    resetGlobalProxyLocked(policy);
    Binder.restoreCallingIdentity(origId);
    return null;
  }
}
