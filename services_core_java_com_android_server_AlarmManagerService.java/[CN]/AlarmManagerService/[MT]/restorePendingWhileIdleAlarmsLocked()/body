{
  if (RECORD_DEVICE_IDLE_ALARMS) {
    IdleDispatchEntry ent=new IdleDispatchEntry();
    ent.uid=0;
    ent.pkg="FINISH IDLE";
    ent.elapsedRealtime=SystemClock.elapsedRealtime();
    mAllowWhileIdleDispatches.add(ent);
  }
  if (mPendingWhileIdleAlarms.size() > 0) {
    ArrayList<Alarm> alarms=mPendingWhileIdleAlarms;
    mPendingWhileIdleAlarms=new ArrayList<>();
    final long nowElapsed=SystemClock.elapsedRealtime();
    for (int i=alarms.size() - 1; i >= 0; i--) {
      Alarm a=alarms.get(i);
      reAddAlarmLocked(a,nowElapsed,false);
    }
  }
  mConstants.updateAllowWhileIdleMinTimeLocked();
  rescheduleKernelAlarmsLocked();
  updateNextAlarmClockLocked();
  try {
    mTimeTickSender.send();
  }
 catch (  PendingIntent.CanceledException e) {
  }
}
