{
  final long nowElapsed=SystemClock.elapsedRealtime();
  for (int i=mPendingWhileIdleAlarms.size() - 1; i >= 0 && mPendingIdleUntil != null; i--) {
    Alarm a=mPendingWhileIdleAlarms.remove(i);
    reAddAlarmLocked(a,nowElapsed,false);
  }
  rescheduleKernelAlarmsLocked();
  updateNextAlarmClockLocked();
}
