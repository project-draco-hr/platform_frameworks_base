{
  byte[] body=updateRequestHeaders(packet);
  if (body != null) {
    mHasBody=true;
  }
  if (mListener.getConnectionId() != -1 && requestHeader.mConnectionID != null) {
    mListener.setConnectionId(ObexHelper.convertToLong(requestHeader.mConnectionID));
  }
 else {
    mListener.setConnectionId(1);
  }
  if (requestHeader.mAuthResp != null) {
    if (!mParent.handleAuthResp(requestHeader.mAuthResp)) {
      mExceptionString="Authentication Failed";
      mParent.sendResponse(ResponseCodes.OBEX_HTTP_UNAUTHORIZED,null);
      mClosed=true;
      requestHeader.mAuthResp=null;
      return false;
    }
    requestHeader.mAuthResp=null;
  }
  if (requestHeader.mAuthChall != null) {
    mParent.handleAuthChall(requestHeader);
    replyHeader.mAuthResp=new byte[requestHeader.mAuthResp.length];
    System.arraycopy(requestHeader.mAuthResp,0,replyHeader.mAuthResp,0,replyHeader.mAuthResp.length);
    requestHeader.mAuthResp=null;
    requestHeader.mAuthChall=null;
  }
  if (body != null) {
    mPrivateInput.writeBytes(body,1);
  }
  return true;
}
