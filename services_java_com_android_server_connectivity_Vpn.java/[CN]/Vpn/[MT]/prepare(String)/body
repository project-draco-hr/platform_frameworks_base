{
  if (packageName == null) {
    return mPackageName;
  }
  PackageManager pm=mContext.getPackageManager();
  if (pm.checkPermission(VPN,packageName) != PackageManager.PERMISSION_GRANTED) {
    throw new SecurityException(packageName + " does not have " + VPN);
  }
  if (mInterfaceName != null) {
    nativeReset(mInterfaceName);
    mInterfaceName=null;
    hideNotification();
  }
  mPackageName=packageName;
  Log.i(TAG,"Prepared for " + packageName);
  return mPackageName;
}
