{
  PackageManager pm=mContext.getPackageManager();
  int appUid=pm.getPackageUid(mPackage,mUserId);
  if (Binder.getCallingUid() != appUid) {
    throw new SecurityException("Unauthorized Caller");
  }
  final long token=Binder.clearCallingIdentity();
  try {
    mCallback.protect(socket);
  }
  finally {
    Binder.restoreCallingIdentity(token);
  }
}
