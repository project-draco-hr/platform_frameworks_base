{
  mContext.enforceCallingPermission(VPN,"establish");
  PackageManager pm=mContext.getPackageManager();
  ApplicationInfo app=null;
  try {
    app=pm.getApplicationInfo(mPackageName,0);
  }
 catch (  Exception e) {
    throw new SecurityException("Not prepared");
  }
  if (Binder.getCallingUid() != app.uid) {
    throw new SecurityException("Not prepared");
  }
  String session=config.getString("session");
  String addresses=config.getString("addresses");
  String routes=config.getString("routes");
  String dnsServers=config.getString("dnsServers");
  ParcelFileDescriptor descriptor=ParcelFileDescriptor.adoptFd(nativeEstablish(addresses,routes));
  try {
    String interfaceName=nativeGetName(descriptor.getFd());
    if (mInterfaceName != null && !mInterfaceName.equals(interfaceName)) {
      nativeReset(mInterfaceName);
    }
    mInterfaceName=interfaceName;
  }
 catch (  RuntimeException e) {
    try {
      descriptor.close();
    }
 catch (    Exception ex) {
    }
    throw e;
  }
  dnsServers=(dnsServers == null) ? "" : dnsServers.trim();
  mCallback.override(dnsServers.isEmpty() ? null : dnsServers.split(" "));
  showNotification(pm,app,session);
  return descriptor;
}
