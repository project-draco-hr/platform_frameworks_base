{
  assertTrue(message + ": display should not show content before window is shown",mImageListener.getColor() != color);
  final TestPresentation[] presentation=new TestPresentation[1];
  try {
    runOnUiThread(new Runnable(){
      @Override public void run(){
        presentation[0]=new TestPresentation(getContext(),display,color,windowType,windowFlags);
        presentation[0].show();
      }
    }
);
    assertTrue(message + ": display should show content after window is shown",mImageListener.waitForColor(color,TIMEOUT));
  }
  finally {
    if (presentation[0] != null) {
      runOnUiThread(new Runnable(){
        @Override public void run(){
          presentation[0].dismiss();
        }
      }
);
    }
  }
}
