{
  KeymasterArguments args=new KeymasterArguments();
  args.addInt(KeymasterDefs.KM_TAG_PURPOSE,KeymasterDefs.KM_PURPOSE_ENCRYPT);
  args.addInt(KeymasterDefs.KM_TAG_PURPOSE,KeymasterDefs.KM_PURPOSE_DECRYPT);
  args.addInt(KeymasterDefs.KM_TAG_ALGORITHM,KeymasterDefs.KM_ALGORITHM_RSA);
  args.addInt(KeymasterDefs.KM_TAG_PADDING,KeymasterDefs.KM_PAD_NONE);
  args.addInt(KeymasterDefs.KM_TAG_KEY_SIZE,2048);
  args.addBlob(KeymasterDefs.KM_TAG_APPLICATION_ID,null);
  args.addBlob(KeymasterDefs.KM_TAG_APPLICATION_DATA,null);
  args.addBlob(KeymasterDefs.KM_TAG_RSA_PUBLIC_EXPONENT,RSAKeyGenParameterSpec.F4.toByteArray());
  KeyCharacteristics outCharacteristics=new KeyCharacteristics();
  int result=mKeyStore.generateKey(name,args,0,outCharacteristics);
  assertEquals("generateRsaKey should succeed",KeyStore.NO_ERROR,result);
  return outCharacteristics;
}
