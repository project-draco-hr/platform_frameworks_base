{
  if (mAmKeyCode == -1 || mPmKeyCode == -1) {
    final KeyCharacterMap kcm=KeyCharacterMap.load(KeyCharacterMap.VIRTUAL_KEYBOARD);
    final CharSequence amText=mAmText.toLowerCase(mCurrentLocale);
    final CharSequence pmText=mPmText.toLowerCase(mCurrentLocale);
    final int N=Math.min(amText.length(),pmText.length());
    for (int i=0; i < N; i++) {
      final char amChar=amText.charAt(i);
      final char pmChar=pmText.charAt(i);
      if (amChar != pmChar) {
        final KeyEvent[] events=kcm.getEvents(new char[]{amChar,pmChar});
        if (events != null && events.length == 4) {
          mAmKeyCode=events[0].getKeyCode();
          mPmKeyCode=events[2].getKeyCode();
        }
 else {
          Log.e(TAG,"Unable to find keycodes for AM and PM.");
        }
        break;
      }
    }
  }
  if (amOrPm == AM) {
    return mAmKeyCode;
  }
 else   if (amOrPm == PM) {
    return mPmKeyCode;
  }
  return -1;
}
