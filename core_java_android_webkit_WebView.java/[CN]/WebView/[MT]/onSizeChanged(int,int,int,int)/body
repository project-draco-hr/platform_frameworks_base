{
  super.onSizeChanged(w,h,ow,oh);
  if (mZoomScale == 0) {
    mZoomCenterX=getViewWidth() * .5f;
    mZoomCenterY=getViewHeight() * .5f;
  }
  int newMaxViewportWidth=(int)(Math.max(w,h) / DEFAULT_MIN_ZOOM_SCALE);
  if (newMaxViewportWidth > sMaxViewportWidth) {
    sMaxViewportWidth=newMaxViewportWidth;
  }
  if (!mMinZoomScaleFixed) {
    mMinZoomScale=Math.min(1.0f,(float)getViewWidth() / (mDrawHistory ? mHistoryPicture.getWidth() : mZoomOverviewWidth));
    if (mInitialScaleInPercent > 0) {
      float initialScale=mInitialScaleInPercent / 100.0f;
      if (mMinZoomScale > initialScale) {
        mMinZoomScale=initialScale;
      }
    }
  }
  post(new Runnable(){
    public void run(){
      setNewZoomScale(mActualScale,true);
    }
  }
);
}
