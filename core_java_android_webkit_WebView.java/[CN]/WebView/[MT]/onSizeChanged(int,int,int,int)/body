{
  super.onSizeChanged(w,h,ow,oh);
  if (!mZoomManager.isZoomAnimating()) {
    int visibleTitleHeight=getVisibleTitleHeight();
    mZoomManager.setZoomCenter(0,visibleTitleHeight);
    mAnchorX=viewToContentX(mScrollX);
    mAnchorY=viewToContentY(visibleTitleHeight + mScrollY);
  }
  int newMaxViewportWidth=(int)(Math.max(w,h) / mZoomManager.DEFAULT_MIN_ZOOM_SCALE);
  if (newMaxViewportWidth > sMaxViewportWidth) {
    sMaxViewportWidth=newMaxViewportWidth;
  }
  if (!mZoomManager.mMinZoomScaleFixed) {
    mZoomManager.mMinZoomScale=Math.min(1.0f,(float)getViewWidth() / (mDrawHistory ? mHistoryPicture.getWidth() : mZoomManager.mZoomOverviewWidth));
    if (mInitialScaleInPercent > 0) {
      float initialScale=mInitialScaleInPercent / 100.0f;
      if (mZoomManager.mMinZoomScale > initialScale) {
        mZoomManager.mMinZoomScale=initialScale;
      }
    }
  }
  mZoomManager.dismissZoomPicker();
  post(new PostScale(this,w != ow));
}
