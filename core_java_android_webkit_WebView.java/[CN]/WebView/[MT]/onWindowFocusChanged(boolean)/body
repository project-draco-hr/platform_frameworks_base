{
  if (hasWindowFocus) {
    if (hasFocus()) {
      mDrawCursorRing=true;
      if (mNeedsUpdateTextEntry) {
        updateTextEntry();
      }
      if (mNativeClass != 0) {
        nativeRecordButtons(true,false,true);
      }
      setFocusControllerActive(true);
    }
 else {
      mDrawCursorRing=false;
    }
  }
 else {
    if (getSettings().getBuiltInZoomControls() && !mZoomButtonsController.isVisible()) {
      mDrawCursorRing=false;
    }
    mGotKeyDown=false;
    mShiftIsPressed=false;
    if (mNativeClass != 0) {
      nativeRecordButtons(false,false,true);
    }
    setFocusControllerActive(false);
  }
  invalidate();
  super.onWindowFocusChanged(hasWindowFocus);
}
