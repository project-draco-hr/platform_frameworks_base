{
  if (mNativeClass == 0) {
    return null;
  }
  HitTestResult result=new HitTestResult();
  if (nativeUpdateFocusNode()) {
    FocusNode node=mFocusNode;
    if (node.mIsAnchor && node.mText == null) {
      result.setType(HitTestResult.ANCHOR_TYPE);
    }
 else     if (node.mIsTextField || node.mIsTextArea) {
      result.setType(HitTestResult.EDIT_TEXT_TYPE);
    }
 else {
      String text=node.mText;
      if (text != null) {
        if (text.startsWith(SCHEME_TEL)) {
          result.setType(HitTestResult.PHONE_TYPE);
          result.setExtra(text.substring(SCHEME_TEL.length()));
        }
 else         if (text.startsWith(SCHEME_MAILTO)) {
          result.setType(HitTestResult.EMAIL_TYPE);
          result.setExtra(text.substring(SCHEME_MAILTO.length()));
        }
 else         if (text.startsWith(SCHEME_GEO)) {
          result.setType(HitTestResult.GEO_TYPE);
          result.setExtra(URLDecoder.decode(text.substring(SCHEME_GEO.length())));
        }
      }
    }
  }
  int type=result.getType();
  if (type == HitTestResult.UNKNOWN_TYPE || type == HitTestResult.ANCHOR_TYPE) {
    int contentX=viewToContent((int)mLastTouchX + mScrollX);
    int contentY=viewToContent((int)mLastTouchY + mScrollY);
    if (nativeIsImage(contentX,contentY)) {
      result.setType(type == HitTestResult.UNKNOWN_TYPE ? HitTestResult.IMAGE_TYPE : HitTestResult.IMAGE_ANCHOR_TYPE);
    }
    if (nativeHasSrcUrl()) {
      result.setType(result.getType() == HitTestResult.ANCHOR_TYPE ? HitTestResult.SRC_ANCHOR_TYPE : HitTestResult.SRC_IMAGE_ANCHOR_TYPE);
    }
  }
  return result;
}
