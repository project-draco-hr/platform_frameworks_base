{
  if (mTextSelectionPaint == null) {
    mTextSelectionPaint=new Paint();
    mTextSelectionPaint.setColor(HIGHLIGHT_COLOR);
  }
  mTextSelectionRegion.setEmpty();
  nativeGetTextSelectionRegion(mNativeClass,mTextSelectionRegion);
  Rect r=new Rect();
  RegionIterator iter=new RegionIterator(mTextSelectionRegion);
  Rect clip=canvas.getClipBounds();
  while (iter.next(r)) {
    r.set(contentToViewDimension(r.left),contentToViewDimension(r.top),contentToViewDimension(r.right),contentToViewDimension(r.bottom));
    if (r.intersect(clip)) {
      canvas.drawRect(r,mTextSelectionPaint);
    }
  }
  if (mSelectHandleLeft == null) {
    mSelectHandleLeft=mContext.getResources().getDrawable(com.android.internal.R.drawable.text_select_handle_left);
  }
  int[] handles=new int[4];
  nativeGetSelectionHandles(mNativeClass,handles);
  int start_x=contentToViewDimension(handles[0]);
  int start_y=contentToViewDimension(handles[1]);
  int end_x=contentToViewDimension(handles[2]);
  int end_y=contentToViewDimension(handles[3]);
  start_x-=(mSelectHandleLeft.getIntrinsicWidth() * 3) / 4;
  mSelectHandleLeft.setBounds(start_x,start_y,start_x + mSelectHandleLeft.getIntrinsicWidth(),start_y + mSelectHandleLeft.getIntrinsicHeight());
  if (mSelectHandleRight == null) {
    mSelectHandleRight=mContext.getResources().getDrawable(com.android.internal.R.drawable.text_select_handle_right);
  }
  end_x-=mSelectHandleRight.getIntrinsicWidth() / 4;
  mSelectHandleRight.setBounds(end_x,end_y,end_x + mSelectHandleRight.getIntrinsicWidth(),end_y + mSelectHandleRight.getIntrinsicHeight());
  if (DEBUG_TEXT_HANDLES) {
    mSelectHandleLeft.setAlpha(125);
    mSelectHandleRight.setAlpha(125);
  }
  mSelectHandleLeft.draw(canvas);
  mSelectHandleRight.draw(canvas);
}
