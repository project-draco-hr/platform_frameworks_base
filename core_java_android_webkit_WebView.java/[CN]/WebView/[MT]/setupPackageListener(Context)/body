{
synchronized (WebView.class) {
    if (sPackageInstallationReceiverAdded) {
      return;
    }
    IntentFilter filter=new IntentFilter(Intent.ACTION_PACKAGE_ADDED);
    filter.addAction(Intent.ACTION_PACKAGE_REMOVED);
    filter.addDataScheme("package");
    BroadcastReceiver packageListener=new PackageListener();
    context.getApplicationContext().registerReceiver(packageListener,filter);
    sPackageInstallationReceiverAdded=true;
  }
  AsyncTask<Void,Void,Set<String>> task=new AsyncTask<Void,Void,Set<String>>(){
    @Override protected Set<String> doInBackground(    Void... unused){
      Set<String> installedPackages=new HashSet<String>();
      PackageManager pm=mContext.getPackageManager();
      List<PackageInfo> packages=pm.getInstalledPackages(0);
      for (      PackageInfo p : packages) {
        if (sGoogleApps.contains(p.packageName)) {
          installedPackages.add(p.packageName);
        }
      }
      return installedPackages;
    }
    @Override protected void onPostExecute(    Set<String> installedPackages){
      if (mWebViewCore != null) {
        mWebViewCore.sendMessage(EventHub.ADD_PACKAGE_NAMES,installedPackages);
      }
    }
  }
;
  task.execute();
}
