{
  if (mDbg)   Log.d(TAG,"handleMessage: E msg.what=" + msg.what);
  if (!mIsConstructionCompleted) {
    Log.e(TAG,"The start method not called, ignore msg: " + msg);
    return;
  }
  processMsg(msg);
  if (mDestState != null) {
    if (mDbg)     Log.d(TAG,"handleMessage: new destination call exit");
    StateInfo commonStateInfo=setupTempStateStackWithStatesToEnter(mDestState);
    invokeExitMethods(commonStateInfo);
    int stateStackEnteringIndex=moveTempStateStackToStateStack();
    invokeEnterMethods(stateStackEnteringIndex);
    moveDeferredMessageAtFrontOfQueue();
    if (mDestState == mQuittingState) {
      mHsm.quitting();
      if (mHsm.mHsmThread != null) {
        getLooper().quit();
      }
    }
 else     if (mDestState == mHaltingState) {
      mHsm.halting();
    }
    mDestState=null;
  }
  if (mDbg)   Log.d(TAG,"handleMessage: X");
}
