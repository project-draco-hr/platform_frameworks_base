{
  if (state != State.DISCONNECTED) {
    boolean allConnectionsDisconnected=true;
    Log.v(LOG_TAG,"---check if all connections are disconnected: " + connections.size());
    for (    Connection c : connections) {
      Log.v(LOG_TAG,"   state=" + c.getState() + ": "+ c);
      if (c.getState() != State.DISCONNECTED) {
        allConnectionsDisconnected=false;
        break;
      }
    }
    if (allConnectionsDisconnected)     setState(State.DISCONNECTED);
  }
  notifyDisconnectP(conn);
}
