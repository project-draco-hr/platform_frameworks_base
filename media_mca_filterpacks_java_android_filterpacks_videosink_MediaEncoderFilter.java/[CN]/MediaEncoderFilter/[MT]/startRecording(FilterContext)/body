{
  if (mLogVerbose)   Log.v(TAG,"Starting recording");
  MutableFrameFormat screenFormat=new MutableFrameFormat(FrameFormat.TYPE_BYTE,FrameFormat.TARGET_GPU);
  screenFormat.setBytesPerSample(4);
  int width, height;
  boolean widthHeightSpecified=mWidth > 0 && mHeight > 0;
  if (mProfile != null && !widthHeightSpecified) {
    width=mProfile.videoFrameWidth;
    height=mProfile.videoFrameHeight;
  }
 else {
    width=mWidth;
    height=mHeight;
  }
  screenFormat.setDimensions(width,height);
  mScreen=(GLFrame)context.getFrameManager().newBoundFrame(screenFormat,GLFrame.EXISTING_FBO_BINDING,0);
  mMediaRecorder=new MediaRecorder();
  updateMediaRecorderParams();
  try {
    mMediaRecorder.prepare();
  }
 catch (  IllegalStateException e) {
    throw e;
  }
catch (  IOException e) {
    throw new RuntimeException("IOException in" + "MediaRecorder.prepare()!",e);
  }
catch (  Exception e) {
    throw new RuntimeException("Unknown Exception in" + "MediaRecorder.prepare()!",e);
  }
  mMediaRecorder.start();
  if (mLogVerbose)   Log.v(TAG,"Open: registering surface from Mediarecorder");
  mSurfaceId=context.getGLEnvironment().registerSurfaceFromMediaRecorder(mMediaRecorder);
  mNumFramesEncoded=0;
  mRecordingActive=true;
}
