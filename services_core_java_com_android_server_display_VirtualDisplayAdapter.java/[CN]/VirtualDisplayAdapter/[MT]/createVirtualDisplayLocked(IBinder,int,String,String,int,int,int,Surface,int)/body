{
  boolean secure=(flags & DisplayManager.VIRTUAL_DISPLAY_FLAG_SECURE) != 0;
  IBinder displayToken=SurfaceControl.createDisplay(name,secure);
  VirtualDisplayDevice device=new VirtualDisplayDevice(displayToken,appToken,ownerUid,ownerPackageName,name,width,height,densityDpi,surface,flags);
  try {
    appToken.linkToDeath(device,0);
  }
 catch (  RemoteException ex) {
    device.destroyLocked();
    return null;
  }
  mVirtualDisplayDevices.put(appToken,device);
  return device;
}
