{
  if (mAm == null)   return null;
  if (Constants.DebugFlags.App.EnableSystemServicesProxy) {
    Bitmap thumbnail=Bitmap.createBitmap(mDummyThumbnailWidth,mDummyThumbnailHeight,Bitmap.Config.ARGB_8888);
    thumbnail.eraseColor(0xff333333);
    return thumbnail;
  }
  Bitmap thumbnail=SystemServicesProxy.getThumbnail(mAm,taskId);
  if (thumbnail != null) {
    if (Color.alpha(thumbnail.getPixel(0,0)) == 0) {
      mBgProtectionCanvas.setBitmap(thumbnail);
      mBgProtectionCanvas.drawRect(0,0,thumbnail.getWidth(),thumbnail.getHeight(),mBgProtectionPaint);
      mBgProtectionCanvas.setBitmap(null);
      Log.e(TAG,"Invalid screenshot detected from getTaskThumbnail()");
    }
  }
  return thumbnail;
}
