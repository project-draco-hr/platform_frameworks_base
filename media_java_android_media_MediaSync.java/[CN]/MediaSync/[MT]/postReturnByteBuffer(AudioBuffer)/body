{
synchronized (mCallbackLock) {
    if (mCallbackHandler != null) {
      final MediaSync sync=this;
      mCallbackHandler.post(new Runnable(){
        public void run(){
          Callback callback;
synchronized (mCallbackLock) {
            callback=mCallback;
            if (mCallbackHandler == null || mCallbackHandler.getLooper().getThread() != Thread.currentThread()) {
              return;
            }
          }
          if (callback != null) {
            callback.onAudioBufferConsumed(sync,audioBuffer.mByteBuffer,audioBuffer.mBufferIndex);
          }
        }
      }
);
    }
  }
}
