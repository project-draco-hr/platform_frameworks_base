{
  int[] displayIds=mGlobal.getDisplayIds();
  int expectedCount=displayIds.length;
  Display[] displays=new Display[expectedCount];
synchronized (mLock) {
    int actualCount=0;
    for (int i=0; i < expectedCount; i++) {
      Display display=getOrCreateDisplayLocked(displayIds[i],true);
      if (display != null) {
        displays[actualCount++]=display;
      }
    }
    if (actualCount != expectedCount) {
      Display[] oldDisplays=displays;
      displays=new Display[actualCount];
      System.arraycopy(oldDisplays,0,displays,0,actualCount);
    }
  }
  return displays;
}
