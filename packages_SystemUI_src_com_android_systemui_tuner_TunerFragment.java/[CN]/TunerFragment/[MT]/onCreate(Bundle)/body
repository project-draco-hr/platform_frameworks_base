{
  super.onCreate(savedInstanceState);
  addPreferencesFromResource(R.xml.tuner_prefs);
  getActivity().getActionBar().setDisplayHomeAsUpEnabled(true);
  setHasOptionsMenu(true);
  mQsTuner=findPreference(KEY_QS_TUNER);
  mQsTuner.setOnPreferenceClickListener(new OnPreferenceClickListener(){
    @Override public boolean onPreferenceClick(    Preference preference){
      FragmentTransaction ft=getFragmentManager().beginTransaction();
      ft.replace(android.R.id.content,new QsTuner(),"QsTuner");
      ft.addToBackStack(null);
      ft.commit();
      return true;
    }
  }
);
  findPreference(KEY_DEMO_MODE).setOnPreferenceClickListener(new OnPreferenceClickListener(){
    @Override public boolean onPreferenceClick(    Preference preference){
      FragmentTransaction ft=getFragmentManager().beginTransaction();
      ft.replace(android.R.id.content,new DemoModeFragment(),"DemoMode");
      ft.addToBackStack(null);
      ft.commit();
      return true;
    }
  }
);
  mBatteryPct=(SwitchPreference)findPreference(KEY_BATTERY_PCT);
  if (Settings.Secure.getInt(getContext().getContentResolver(),SETTING_SEEN_TUNER_WARNING,0) == 0) {
    new AlertDialog.Builder(getContext()).setTitle(R.string.tuner_warning_title).setMessage(R.string.tuner_warning).setPositiveButton(R.string.got_it,new OnClickListener(){
      @Override public void onClick(      DialogInterface dialog,      int which){
        Settings.Secure.putInt(getContext().getContentResolver(),SETTING_SEEN_TUNER_WARNING,1);
      }
    }
).show();
  }
  TunerService.get(getContext()).addTunable(mQsPaging,QSPanel.QS_PAGED_PANEL);
}
