{
  DataInputStream inputStream;
  try {
    inputStream=new DataInputStream(new FileInputStream(new File(mDataBlockFile)));
  }
 catch (  FileNotFoundException e) {
    Slog.e(TAG,"partition not available?",e);
    return null;
  }
  MessageDigest md;
  try {
    md=MessageDigest.getInstance("SHA-256");
  }
 catch (  NoSuchAlgorithmException e) {
    Slog.e(TAG,"SHA-256 not supported?",e);
    IoUtils.closeQuietly(inputStream);
    return null;
  }
  try {
    if (storedDigest != null && storedDigest.length == DIGEST_SIZE_BYTES) {
      inputStream.read(storedDigest);
    }
 else {
      inputStream.skipBytes(DIGEST_SIZE_BYTES);
    }
    int read;
    byte[] data=new byte[1024];
    md.update(data,0,DIGEST_SIZE_BYTES);
    while ((read=inputStream.read(data)) != -1) {
      md.update(data,0,read);
    }
  }
 catch (  IOException e) {
    Slog.e(TAG,"failed to read partition",e);
    return null;
  }
 finally {
    IoUtils.closeQuietly(inputStream);
  }
  return md.digest();
}
