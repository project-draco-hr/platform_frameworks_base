{
synchronized (mPackages) {
    WeakReference<PackageInfo> ref;
    if (includeCode) {
      ref=mPackages.get(aInfo.packageName);
    }
 else {
      ref=mResourcePackages.get(aInfo.packageName);
    }
    PackageInfo packageInfo=ref != null ? ref.get() : null;
    if (packageInfo == null || (packageInfo.mResources != null && !packageInfo.mResources.getAssets().isUpToDate())) {
      if (localLOGV)       Log.v(TAG,(includeCode ? "Loading code package " : "Loading resource-only package ") + aInfo.packageName + " (in "+ (mBoundApplication != null ? mBoundApplication.processName : null)+ ")");
      packageInfo=new PackageInfo(this,aInfo,this,baseLoader,securityViolation,includeCode && (aInfo.flags & ApplicationInfo.FLAG_HAS_CODE) != 0);
      if (includeCode) {
        mPackages.put(aInfo.packageName,new WeakReference<PackageInfo>(packageInfo));
      }
 else {
        mResourcePackages.put(aInfo.packageName,new WeakReference<PackageInfo>(packageInfo));
      }
    }
    return packageInfo;
  }
}
