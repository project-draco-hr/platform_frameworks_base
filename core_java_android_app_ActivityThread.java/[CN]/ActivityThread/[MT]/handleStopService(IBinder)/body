{
  Service s=mServices.remove(token);
  if (s != null) {
    try {
      if (localLOGV)       Log.v(TAG,"Destroying service " + s);
      s.onDestroy();
      Context context=s.getBaseContext();
      if (context instanceof ApplicationContext) {
        final String who=s.getClassName();
        ((ApplicationContext)context).scheduleFinalCleanup(who,"Service");
      }
      try {
        ActivityManagerNative.getDefault().serviceDoneExecuting(token);
      }
 catch (      RemoteException e) {
      }
    }
 catch (    Exception e) {
      if (!mInstrumentation.onException(s,e)) {
        throw new RuntimeException("Unable to stop service " + s + ": "+ e.toString(),e);
      }
    }
  }
}
