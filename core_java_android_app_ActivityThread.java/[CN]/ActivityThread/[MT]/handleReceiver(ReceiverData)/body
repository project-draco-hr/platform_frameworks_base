{
  unscheduleGcIdler();
  String component=data.intent.getComponent().getClassName();
  LoadedApk packageInfo=getPackageInfoNoCheck(data.info.applicationInfo);
  IActivityManager mgr=ActivityManagerNative.getDefault();
  BroadcastReceiver receiver=null;
  try {
    java.lang.ClassLoader cl=packageInfo.getClassLoader();
    data.intent.setExtrasClassLoader(cl);
    if (data.resultExtras != null) {
      data.resultExtras.setClassLoader(cl);
    }
    receiver=(BroadcastReceiver)cl.loadClass(component).newInstance();
  }
 catch (  Exception e) {
    try {
      if (DEBUG_BROADCAST)       Slog.i(TAG,"Finishing failed broadcast to " + data.intent.getComponent());
      mgr.finishReceiver(mAppThread.asBinder(),data.resultCode,data.resultData,data.resultExtras,data.resultAbort);
    }
 catch (    RemoteException ex) {
    }
    throw new RuntimeException("Unable to instantiate receiver " + component + ": "+ e.toString(),e);
  }
  try {
    Application app=packageInfo.makeApplication(false,mInstrumentation);
    if (localLOGV)     Slog.v(TAG,"Performing receive of " + data.intent + ": app="+ app+ ", appName="+ app.getPackageName()+ ", pkg="+ packageInfo.getPackageName()+ ", comp="+ data.intent.getComponent().toShortString()+ ", dir="+ packageInfo.getAppDir());
    ContextImpl context=(ContextImpl)app.getBaseContext();
    receiver.setOrderedHint(true);
    receiver.setResult(data.resultCode,data.resultData,data.resultExtras);
    receiver.setOrderedHint(data.sync);
    receiver.onReceive(context.getReceiverRestrictedContext(),data.intent);
  }
 catch (  Exception e) {
    try {
      if (DEBUG_BROADCAST)       Slog.i(TAG,"Finishing failed broadcast to " + data.intent.getComponent());
      mgr.finishReceiver(mAppThread.asBinder(),data.resultCode,data.resultData,data.resultExtras,data.resultAbort);
    }
 catch (    RemoteException ex) {
    }
    if (!mInstrumentation.onException(receiver,e)) {
      throw new RuntimeException("Unable to start receiver " + component + ": "+ e.toString(),e);
    }
  }
  try {
    if (data.sync) {
      if (DEBUG_BROADCAST)       Slog.i(TAG,"Finishing ordered broadcast to " + data.intent.getComponent());
      mgr.finishReceiver(mAppThread.asBinder(),receiver.getResultCode(),receiver.getResultData(),receiver.getResultExtras(false),receiver.getAbortBroadcast());
    }
 else {
      if (DEBUG_BROADCAST)       Slog.i(TAG,"Finishing broadcast to " + data.intent.getComponent());
      mgr.finishReceiver(mAppThread.asBinder(),0,null,null,false);
    }
  }
 catch (  RemoteException ex) {
  }
}
