{
  ArrayList<ComponentCallbacks2> callbacks=new ArrayList<ComponentCallbacks2>();
synchronized (mPackages) {
    final int N=mAllApplications.size();
    for (int i=0; i < N; i++) {
      callbacks.add(mAllApplications.get(i));
    }
    if (mActivities.size() > 0) {
      for (      ActivityClientRecord ar : mActivities.values()) {
        Activity a=ar.activity;
        if (a != null) {
          Configuration thisConfig=applyConfigCompatMainThread(mCurDefaultDisplayDpi,newConfig,ar.packageInfo.mCompatibilityInfo.getIfNeeded());
          if (!ar.activity.mFinished && (allActivities || !ar.paused)) {
            callbacks.add(a);
          }
 else           if (thisConfig != null) {
            if (DEBUG_CONFIGURATION) {
              Slog.v(TAG,"Setting activity " + ar.activityInfo.name + " newConfig="+ thisConfig);
            }
            ar.newConfig=thisConfig;
          }
        }
      }
    }
    if (mServices.size() > 0) {
      for (      Service service : mServices.values()) {
        callbacks.add(service);
      }
    }
  }
synchronized (mProviderMap) {
    if (mLocalProviders.size() > 0) {
      for (      ProviderClientRecord providerClientRecord : mLocalProviders.values()) {
        callbacks.add(providerClientRecord.mLocalProvider);
      }
    }
  }
  return callbacks;
}
