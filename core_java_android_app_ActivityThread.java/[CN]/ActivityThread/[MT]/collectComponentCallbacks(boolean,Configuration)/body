{
  ArrayList<ComponentCallbacks2> callbacks=new ArrayList<ComponentCallbacks2>();
synchronized (mResourcesManager) {
    final int NAPP=mAllApplications.size();
    for (int i=0; i < NAPP; i++) {
      callbacks.add(mAllApplications.get(i));
    }
    final int NACT=mActivities.size();
    for (int i=0; i < NACT; i++) {
      ActivityClientRecord ar=mActivities.valueAt(i);
      Activity a=ar.activity;
      if (a != null) {
        Configuration thisConfig=applyConfigCompatMainThread(mCurDefaultDisplayDpi,newConfig,ar.packageInfo.getCompatibilityInfo());
        if (!ar.activity.mFinished && (allActivities || !ar.paused)) {
          callbacks.add(a);
        }
 else         if (thisConfig != null) {
          if (DEBUG_CONFIGURATION) {
            Slog.v(TAG,"Setting activity " + ar.activityInfo.name + " newConfig="+ thisConfig);
          }
          ar.newConfig=thisConfig;
        }
      }
    }
    final int NSVC=mServices.size();
    for (int i=0; i < NSVC; i++) {
      callbacks.add(mServices.valueAt(i));
    }
  }
synchronized (mProviderMap) {
    final int NPRV=mLocalProviders.size();
    for (int i=0; i < NPRV; i++) {
      callbacks.add(mLocalProviders.valueAt(i).mLocalProvider);
    }
  }
  return callbacks;
}
