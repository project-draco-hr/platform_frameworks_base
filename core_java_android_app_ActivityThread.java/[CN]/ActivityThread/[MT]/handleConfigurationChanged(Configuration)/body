{
  ArrayList<ComponentCallbacks> callbacks=null;
synchronized (mPackages) {
    if (mPendingConfiguration != null) {
      if (!mPendingConfiguration.isOtherSeqNewer(config)) {
        config=mPendingConfiguration;
      }
      mPendingConfiguration=null;
    }
    if (config == null) {
      return;
    }
    if (DEBUG_CONFIGURATION)     Slog.v(TAG,"Handle configuration changed: " + config);
    applyConfigurationToResourcesLocked(config);
    if (mConfiguration == null) {
      mConfiguration=new Configuration();
    }
    if (!mConfiguration.isOtherSeqNewer(config)) {
      return;
    }
    mConfiguration.updateFrom(config);
    callbacks=collectComponentCallbacksLocked(false,config);
  }
  if (callbacks != null) {
    final int N=callbacks.size();
    for (int i=0; i < N; i++) {
      performConfigurationChanged(callbacks.get(i),config);
    }
  }
}
