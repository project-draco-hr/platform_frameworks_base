{
  SamplingProfilerIntegration.start();
  Process.setArgV0("<pre-initialized>");
  Looper.prepareMainLooper();
  if (sMainThreadHandler == null) {
    sMainThreadHandler=new Handler();
  }
  ActivityThread thread=new ActivityThread();
  thread.attach(false);
  Looper.loop();
  if (Process.supportsProcesses()) {
    throw new RuntimeException("Main thread loop unexpectedly exited");
  }
  thread.detach();
  String name=(thread.mInitialApplication != null) ? thread.mInitialApplication.getPackageName() : "<unknown>";
  Slog.i(TAG,"Main thread of " + name + " is now exiting");
}
