{
  ActivityClientRecord r=mActivities.get(token);
  if (r != null) {
    mSomeActivitiesChanged=true;
    final Activity activity=r.activity;
    if (activity.mVisibleBehind) {
      activity.mCalled=false;
      activity.onVisibleBehindCanceled();
      if (!activity.mCalled) {
        throw new SuperNotCalledException("Activity " + activity.getLocalClassName() + " did not call through to super.onVisibleBehindCanceled()");
      }
      activity.mVisibleBehind=false;
    }
  }
  try {
    ActivityManagerNative.getDefault().backgroundResourcesReleased(token);
  }
 catch (  RemoteException e) {
    throw e.rethrowFromSystemServer();
  }
}
