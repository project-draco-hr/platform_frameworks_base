{
  Activity activity=(cb instanceof Activity) ? (Activity)cb : null;
  if (activity != null) {
    activity.mCalled=false;
  }
  boolean shouldChangeConfig=false;
  if ((activity == null) || (activity.mCurrentConfig == null)) {
    shouldChangeConfig=true;
  }
 else {
    int diff=activity.mCurrentConfig.diff(config);
    if (diff != 0) {
      if ((~activity.mActivityInfo.getRealConfigChanged() & diff) == 0) {
        shouldChangeConfig=true;
      }
    }
  }
  if (DEBUG_CONFIGURATION)   Slog.v(TAG,"Config callback " + cb + ": shouldChangeConfig="+ shouldChangeConfig);
  if (shouldChangeConfig) {
    cb.onConfigurationChanged(config);
    if (activity != null) {
      if (!activity.mCalled) {
        throw new SuperNotCalledException("Activity " + activity.getLocalClassName() + " did not call through to super.onConfigurationChanged()");
      }
      activity.mConfigChangeFlags=0;
      activity.mCurrentConfig=new Configuration(config);
    }
  }
}
