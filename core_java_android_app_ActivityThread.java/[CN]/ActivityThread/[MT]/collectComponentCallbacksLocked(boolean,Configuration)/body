{
  ArrayList<ComponentCallbacks> callbacks=new ArrayList<ComponentCallbacks>();
  if (mActivities.size() > 0) {
    Iterator<ActivityRecord> it=mActivities.values().iterator();
    while (it.hasNext()) {
      ActivityRecord ar=it.next();
      Activity a=ar.activity;
      if (a != null) {
        if (!ar.activity.mFinished && (allActivities || (a != null && !ar.paused))) {
          callbacks.add(a);
        }
 else         if (newConfig != null) {
          ar.newConfig=newConfig;
        }
      }
    }
  }
  if (mServices.size() > 0) {
    Iterator<Service> it=mServices.values().iterator();
    while (it.hasNext()) {
      callbacks.add(it.next());
    }
  }
synchronized (mProviderMap) {
    if (mLocalProviders.size() > 0) {
      Iterator<ProviderRecord> it=mLocalProviders.values().iterator();
      while (it.hasNext()) {
        callbacks.add(it.next().mLocalProvider);
      }
    }
  }
  final int N=mAllApplications.size();
  for (int i=0; i < N; i++) {
    callbacks.add(mAllApplications.get(i));
  }
  return callbacks;
}
