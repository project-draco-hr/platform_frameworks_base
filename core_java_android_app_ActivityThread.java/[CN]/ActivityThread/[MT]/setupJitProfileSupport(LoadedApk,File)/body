{
  if (!SystemProperties.getBoolean("dalvik.vm.usejitprofiles",false)) {
    return;
  }
  final ApplicationInfo appInfo=loadedApk.getApplicationInfo();
  final List<String> codePaths=new ArrayList<>();
  if ((appInfo.flags & ApplicationInfo.FLAG_HAS_CODE) != 0) {
    codePaths.add(appInfo.sourceDir);
  }
  if (appInfo.splitSourceDirs != null) {
    Collections.addAll(codePaths,appInfo.splitSourceDirs);
  }
  if (codePaths.isEmpty()) {
    return;
  }
  final File profileFile=getPrimaryProfileFile(loadedApk.mPackageName);
  if (!profileFile.exists()) {
    FileDescriptor fd=null;
    try {
      final int permissions=0600;
      fd=Os.open(profileFile.getAbsolutePath(),OsConstants.O_CREAT,permissions);
      Os.fchmod(fd,permissions);
      Os.fchown(fd,appInfo.uid,appInfo.uid);
    }
 catch (    ErrnoException e) {
      Log.v(TAG,"Unable to create jit profile file " + profileFile + ": "+ e.getMessage());
      try {
        Os.unlink(profileFile.getAbsolutePath());
      }
 catch (      ErrnoException unlinkErr) {
        if (unlinkErr.errno != OsConstants.ENOENT) {
          Log.v(TAG,"Unable to unlink jit profile file " + profileFile + ": "+ unlinkErr.getMessage());
        }
      }
      return;
    }
 finally {
      IoUtils.closeQuietly(fd);
    }
  }
  VMRuntime.registerAppInfo(profileFile.getAbsolutePath(),appInfo.dataDir,codePaths.toArray(new String[codePaths.size()]));
}
