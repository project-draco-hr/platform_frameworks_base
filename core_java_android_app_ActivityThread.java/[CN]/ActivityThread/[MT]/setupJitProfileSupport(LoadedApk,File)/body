{
  final ApplicationInfo appInfo=loadedApk.getApplicationInfo();
  if (isSharingRuntime(appInfo)) {
    return;
  }
  final List<String> codePaths=new ArrayList<>();
  if ((appInfo.flags & ApplicationInfo.FLAG_HAS_CODE) != 0) {
    codePaths.add(appInfo.sourceDir);
  }
  if (appInfo.splitSourceDirs != null) {
    Collections.addAll(codePaths,appInfo.splitSourceDirs);
  }
  if (codePaths.isEmpty()) {
    return;
  }
  final String profileExtension=".prof";
  final File profileFile=new File(cacheDir,loadedApk.mPackageName + profileExtension);
  if (!profileFile.exists()) {
    FileDescriptor fd=null;
    try {
      final int permissions=0600;
      fd=Os.open(profileFile.getAbsolutePath(),OsConstants.O_CREAT,permissions);
      Os.fchmod(fd,permissions);
      Os.fchown(fd,appInfo.uid,appInfo.uid);
    }
 catch (    ErrnoException e) {
      Log.w(TAG,"Unable to create jit profile file " + profileFile,e);
      try {
        Os.unlink(profileFile.getAbsolutePath());
      }
 catch (      ErrnoException unlinkErr) {
        Log.v(TAG,"Unable to unlink jit profile file " + profileFile,unlinkErr);
      }
      return;
    }
 finally {
      IoUtils.closeQuietly(fd);
    }
  }
  VMRuntime.registerAppInfo(profileFile.getAbsolutePath(),appInfo.dataDir,codePaths.toArray(new String[codePaths.size()]),null);
}
