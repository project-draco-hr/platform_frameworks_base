{
synchronized (mProviderMap) {
    ProviderRefCount prc=mProviderRefCountMap.get(provider);
    if (prc != null) {
      if (DEBUG_PROVIDER)       Slog.v(TAG,"Cleaning up dead provider " + provider + " "+ prc.holder.info.name);
      mProviderRefCountMap.remove(provider);
      if (prc.client != null && prc.client.mNames != null) {
        for (        String name : prc.client.mNames) {
          ProviderClientRecord pr=mProviderMap.get(name);
          if (pr != null && pr.mProvider.asBinder() == provider) {
            Slog.i(TAG,"Removing dead content provider: " + name);
            mProviderMap.remove(name);
          }
        }
      }
      if (fromClient) {
        try {
          ActivityManagerNative.getDefault().unstableProviderDied(prc.holder.connection);
        }
 catch (        RemoteException e) {
        }
      }
    }
  }
}
