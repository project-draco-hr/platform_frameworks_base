{
  if (localLOGV)   Log.v(TAG,"Performing stop of " + r);
  if (r != null) {
    if (!keepShown && r.stopped) {
      if (r.activity.mFinished) {
        return;
      }
      RuntimeException e=new RuntimeException("Performing stop of activity that is not resumed: " + r.intent.getComponent().toShortString());
      Log.e(TAG,e.getMessage(),e);
    }
    if (info != null) {
      try {
        info.description=r.activity.onCreateDescription();
      }
 catch (      Exception e) {
        if (!mInstrumentation.onException(r.activity,e)) {
          throw new RuntimeException("Unable to save state of activity " + r.intent.getComponent().toShortString() + ": "+ e.toString(),e);
        }
      }
    }
    if (!keepShown) {
      try {
        r.activity.performStop();
      }
 catch (      Exception e) {
        if (!mInstrumentation.onException(r.activity,e)) {
          throw new RuntimeException("Unable to stop activity " + r.intent.getComponent().toShortString() + ": "+ e.toString(),e);
        }
      }
      r.stopped=true;
    }
    r.paused=true;
  }
}
