{
  View v=r.activity.mDecor;
  if (v != null) {
    if (show) {
      if (!r.activity.mVisibleFromServer) {
        r.activity.mVisibleFromServer=true;
        mNumVisibleActivities++;
        if (r.activity.mVisibleFromClient) {
          r.activity.makeVisible();
        }
      }
      if (r.newConfig != null) {
        r.tmpConfig.setTo(r.newConfig);
        if (r.overrideConfig != null) {
          r.tmpConfig.updateFrom(r.overrideConfig);
        }
        if (DEBUG_CONFIGURATION)         Slog.v(TAG,"Updating activity vis " + r.activityInfo.name + " with new config "+ r.tmpConfig);
        performConfigurationChanged(r.activity,r.tmpConfig);
        freeTextLayoutCachesIfNeeded(r.activity.mCurrentConfig.diff(r.tmpConfig));
        r.newConfig=null;
      }
    }
 else {
      if (r.activity.mVisibleFromServer) {
        r.activity.mVisibleFromServer=false;
        mNumVisibleActivities--;
        v.setVisibility(View.INVISIBLE);
      }
    }
  }
}
