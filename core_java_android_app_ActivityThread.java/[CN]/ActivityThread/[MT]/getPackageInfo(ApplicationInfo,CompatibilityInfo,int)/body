{
  boolean includeCode=(flags & Context.CONTEXT_INCLUDE_CODE) != 0;
  boolean securityViolation=includeCode && ai.uid != 0 && ai.uid != Process.SYSTEM_UID && (mBoundApplication != null ? ai.uid != mBoundApplication.appInfo.uid : true);
  if ((flags & (Context.CONTEXT_INCLUDE_CODE | Context.CONTEXT_IGNORE_SECURITY)) == Context.CONTEXT_INCLUDE_CODE) {
    if (securityViolation) {
      String msg="Requesting code from " + ai.packageName + " (with uid "+ ai.uid+ ")";
      if (mBoundApplication != null) {
        msg=msg + " to be run in process " + mBoundApplication.processName+ " (with uid "+ mBoundApplication.appInfo.uid+ ")";
      }
      throw new SecurityException(msg);
    }
  }
  return getPackageInfo(ai,compatInfo,null,securityViolation,includeCode);
}
