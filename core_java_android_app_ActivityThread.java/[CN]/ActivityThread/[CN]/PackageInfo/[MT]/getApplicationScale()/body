{
  if (mApplicationScale > 0.0f) {
    return mApplicationScale;
  }
  DisplayMetrics metrics=mActivityThread.getDisplayMetricsLocked(false);
  try {
    ApplicationInfo ai=getPackageManager().getApplicationInfo(mPackageName,PackageManager.GET_SUPPORTS_DENSITIES);
    float appScale=-1.0f;
    if (ai.supportsDensities != null) {
      int minDiff=Integer.MAX_VALUE;
      for (      int density : ai.supportsDensities) {
        int tmpDiff=(int)Math.abs(DisplayMetrics.DEVICE_DENSITY - density);
        if (tmpDiff == 0) {
          appScale=1.0f;
          break;
        }
        if (tmpDiff < minDiff && appScale < 1.0f) {
          appScale=DisplayMetrics.DEVICE_DENSITY / density;
          minDiff=tmpDiff;
        }
      }
    }
    if (appScale < 0.0f) {
      mApplicationScale=metrics.density;
    }
 else {
      mApplicationScale=appScale;
    }
  }
 catch (  RemoteException e) {
    throw new AssertionError(e);
  }
  if (localLOGV)   Log.v(TAG,"appScale=" + mApplicationScale + ", pkg="+ mPackageName);
  return mApplicationScale;
}
