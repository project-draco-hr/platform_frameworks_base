{
  BroadcastReceiver receiver=mReceiver;
  if (DEBUG_BROADCAST) {
    int seq=mCurIntent.getIntExtra("seq",-1);
    Slog.i(TAG,"Dispatching broadcast " + mCurIntent.getAction() + " seq="+ seq+ " to "+ mReceiver);
    Slog.i(TAG,"  mRegistered=" + mRegistered + " mCurOrdered="+ mCurOrdered);
  }
  IActivityManager mgr=ActivityManagerNative.getDefault();
  Intent intent=mCurIntent;
  mCurIntent=null;
  if (receiver == null) {
    if (mRegistered && mCurOrdered) {
      try {
        if (DEBUG_BROADCAST)         Slog.i(TAG,"Finishing null broadcast to " + mReceiver);
        mgr.finishReceiver(mIIntentReceiver,mCurCode,mCurData,mCurMap,false);
      }
 catch (      RemoteException ex) {
      }
    }
    return;
  }
  try {
    ClassLoader cl=mReceiver.getClass().getClassLoader();
    intent.setExtrasClassLoader(cl);
    if (mCurMap != null) {
      mCurMap.setClassLoader(cl);
    }
    receiver.setOrderedHint(true);
    receiver.setResult(mCurCode,mCurData,mCurMap);
    receiver.clearAbortBroadcast();
    receiver.setOrderedHint(mCurOrdered);
    receiver.setInitialStickyHint(mCurSticky);
    receiver.onReceive(mContext,intent);
  }
 catch (  Exception e) {
    if (mRegistered && mCurOrdered) {
      try {
        if (DEBUG_BROADCAST)         Slog.i(TAG,"Finishing failed broadcast to " + mReceiver);
        mgr.finishReceiver(mIIntentReceiver,mCurCode,mCurData,mCurMap,false);
      }
 catch (      RemoteException ex) {
      }
    }
    if (mInstrumentation == null || !mInstrumentation.onException(mReceiver,e)) {
      throw new RuntimeException("Error receiving broadcast " + intent + " in "+ mReceiver,e);
    }
  }
  if (mRegistered && mCurOrdered) {
    try {
      if (DEBUG_BROADCAST)       Slog.i(TAG,"Finishing broadcast to " + mReceiver);
      mgr.finishReceiver(mIIntentReceiver,receiver.getResultCode(),receiver.getResultData(),receiver.getResultExtras(false),receiver.getAbortBroadcast());
    }
 catch (    RemoteException ex) {
    }
  }
}
