{
  setContentView(R.layout.wallpaper_cropper);
  mCropView=(CropView)findViewById(R.id.cropView);
  Intent cropIntent=getIntent();
  final Uri imageUri=cropIntent.getData();
  if (imageUri == null) {
    Log.e(LOGTAG,"No URI passed in intent, exiting WallpaperCropActivity");
    finish();
    return;
  }
  int rotation=getRotationFromExif(this,imageUri);
  mCropView.setTileSource(new BitmapRegionTileSource(this,imageUri,1024,rotation),null);
  mCropView.setTouchEnabled(true);
  final ActionBar actionBar=getActionBar();
  actionBar.setCustomView(R.layout.actionbar_set_wallpaper);
  actionBar.getCustomView().setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      boolean finishActivityWhenDone=true;
      cropImageAndSetWallpaper(imageUri,null,finishActivityWhenDone);
    }
  }
);
}
