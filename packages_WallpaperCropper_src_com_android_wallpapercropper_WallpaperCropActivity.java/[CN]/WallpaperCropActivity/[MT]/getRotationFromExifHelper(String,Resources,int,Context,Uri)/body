{
  ExifInterface ei=new ExifInterface();
  try {
    if (path != null) {
      ei.readExif(path);
    }
 else     if (uri != null) {
      InputStream is=context.getContentResolver().openInputStream(uri);
      BufferedInputStream bis=new BufferedInputStream(is);
      ei.readExif(bis);
    }
 else {
      InputStream is=res.openRawResource(resId);
      BufferedInputStream bis=new BufferedInputStream(is);
      ei.readExif(bis);
    }
    Integer ori=ei.getTagIntValue(ExifInterface.TAG_ORIENTATION);
    if (ori != null) {
      return ExifInterface.getRotationForOrientationValue(ori.shortValue());
    }
  }
 catch (  IOException e) {
    Log.w(LOGTAG,"Getting exif data failed",e);
  }
  return 0;
}
