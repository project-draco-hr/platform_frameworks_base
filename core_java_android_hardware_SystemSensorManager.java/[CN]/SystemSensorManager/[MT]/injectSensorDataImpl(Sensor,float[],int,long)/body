{
  if (!mHasDataInjectionPermissions) {
    throw new SecurityException("Permission denial. Calling injectSensorData without " + Manifest.permission.HARDWARE_TEST);
  }
synchronized (sSensorModuleLock) {
    if (!mDataInjectionMode) {
      Log.e(TAG,"Data injection mode not activated before calling injectSensorData");
      return false;
    }
    if (mInjectEventQueue == null) {
      mInjectEventQueue=new InjectEventQueue(mMainLooper,this);
    }
    int ret=mInjectEventQueue.injectSensorData(sensor.getHandle(),values,accuracy,timestamp);
    if (ret != 0) {
      mInjectEventQueue.dispose();
      mInjectEventQueue=null;
      mDataInjectionMode=false;
    }
    return ret == 0;
  }
}
