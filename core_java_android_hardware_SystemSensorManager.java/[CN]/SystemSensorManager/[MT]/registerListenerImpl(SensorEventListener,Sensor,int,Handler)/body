{
  if (sensor == null)   throw new NullPointerException("sensor cannot be null");
  boolean result;
synchronized (mSensorEventQueueMap) {
    for (    SensorEventListenerSensorPair l : mListenerDelegates) {
      if (l.isSameListenerSensorPair(listener,sensor)) {
        return true;
      }
    }
    SensorEventQueue queue=mSensorEventQueueMap.get(listener);
    if (queue != null) {
      result=queue.addSensor(sensor,delay);
      if (result) {
        mListenerDelegates.add(new SensorEventListenerSensorPair(listener,sensor));
      }
    }
 else {
      Looper looper=(handler != null) ? handler.getLooper() : mMainLooper;
      queue=new SensorEventQueue(listener,looper.getQueue());
      result=queue.addSensor(sensor,delay);
      if (result) {
        mListenerDelegates.add(new SensorEventListenerSensorPair(listener,sensor));
        mSensorEventQueueMap.put(listener,queue);
      }
 else {
        queue.dispose();
      }
    }
  }
  return result;
}
