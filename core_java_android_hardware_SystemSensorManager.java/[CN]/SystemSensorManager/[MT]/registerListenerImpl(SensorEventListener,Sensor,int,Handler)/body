{
  boolean result=true;
synchronized (sListeners) {
    ListenerDelegate l=null;
    for (    ListenerDelegate i : sListeners) {
      if (i.getListener() == listener) {
        l=i;
        break;
      }
    }
    if (l == null) {
      l=new ListenerDelegate(listener,sensor,handler);
      sListeners.add(l);
      if (!sListeners.isEmpty()) {
        if (sSensorThread.startLocked()) {
          if (!enableSensorLocked(sensor,delay)) {
            sListeners.remove(l);
            result=false;
          }
        }
 else {
          sListeners.remove(l);
          result=false;
        }
      }
 else {
        result=false;
      }
    }
 else     if (!l.hasSensor(sensor)) {
      l.addSensor(sensor);
      if (!enableSensorLocked(sensor,delay)) {
        l.removeSensor(sensor);
        result=false;
      }
    }
  }
  return result;
}
