{
synchronized (mSensorEventQueueMap) {
    final ArrayList<SensorEventListenerSensorPair> copy=new ArrayList<SensorEventListenerSensorPair>(mListenerDelegates);
    int lastIndex=copy.size() - 1;
    for (int i=lastIndex; i >= 0; i--) {
      if (copy.get(i).isSameListenerSensorPair(listener,sensor)) {
        mListenerDelegates.remove(i);
      }
    }
    SensorEventQueue queue=mSensorEventQueueMap.get(listener);
    if (queue != null) {
      if (sensor != null) {
        queue.removeSensor(sensor);
      }
 else {
        queue.removeAllSensors();
      }
      if (!queue.hasSensors()) {
        mSensorEventQueueMap.remove(listener);
        queue.dispose();
      }
    }
  }
}
