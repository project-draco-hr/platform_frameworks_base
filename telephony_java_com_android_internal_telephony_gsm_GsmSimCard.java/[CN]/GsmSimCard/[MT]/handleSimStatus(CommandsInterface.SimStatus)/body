{
  boolean transitionedIntoPinLocked;
  boolean transitionedIntoAbsent;
  boolean transitionedIntoNetworkLocked;
  SimCard.State oldState, newState;
  oldState=getState();
  status=newStatus;
  newState=getState();
  updateStateProperty();
  transitionedIntoPinLocked=((oldState != State.PIN_REQUIRED && newState == State.PIN_REQUIRED) || (oldState != State.PUK_REQUIRED && newState == State.PUK_REQUIRED));
  transitionedIntoAbsent=(oldState != State.ABSENT && newState == State.ABSENT);
  transitionedIntoNetworkLocked=(oldState != State.NETWORK_LOCKED && newState == State.NETWORK_LOCKED);
  if (transitionedIntoPinLocked) {
    if (DBG)     log("Notify SIM pin or puk locked.");
    pinLockedRegistrants.notifyRegistrants();
    broadcastSimStateChangedIntent(SimCard.INTENT_VALUE_SIM_LOCKED,(newState == State.PIN_REQUIRED) ? INTENT_VALUE_LOCKED_ON_PIN : INTENT_VALUE_LOCKED_ON_PUK);
  }
 else   if (transitionedIntoAbsent) {
    if (DBG)     log("Notify SIM missing.");
    absentRegistrants.notifyRegistrants();
    broadcastSimStateChangedIntent(SimCard.INTENT_VALUE_SIM_ABSENT,null);
  }
 else   if (transitionedIntoNetworkLocked) {
    if (DBG)     log("Notify SIM network locked.");
    networkLockedRegistrants.notifyRegistrants();
    broadcastSimStateChangedIntent(SimCard.INTENT_VALUE_SIM_LOCKED,INTENT_VALUE_LOCKED_NETWORK);
  }
}
