{
  mContext.enforceCallingOrSelfPermission(android.Manifest.permission.PACKAGE_USAGE_STATS,null);
synchronized (mStatsLock) {
    Set<String> keys=mStats.keySet();
    int size=keys.size();
    if (size <= 0) {
      return null;
    }
    PkgUsageStats retArr[]=new PkgUsageStats[size];
    int i=0;
    for (    String key : keys) {
      PkgUsageStatsExtended pus=mStats.get(key);
      retArr[i]=new PkgUsageStats(key,pus.mLaunchCount,pus.mUsageTime,pus.mLastResumeTimes);
      i++;
    }
    return retArr;
  }
}
