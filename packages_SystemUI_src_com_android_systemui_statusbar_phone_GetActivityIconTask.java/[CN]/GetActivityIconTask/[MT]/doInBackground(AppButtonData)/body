{
  if (params.length != 1) {
    throw new IllegalArgumentException("Expected one parameter");
  }
  AppButtonData buttonData=params[0];
  AppInfo appInfo=buttonData.appInfo;
  try {
    IPackageManager mPM=AppGlobals.getPackageManager();
    ActivityInfo ai=mPM.getActivityInfo(appInfo.getComponentName(),0,appInfo.getUser().getIdentifier());
    if (ai == null) {
      Slog.w(TAG,"Icon not found for " + appInfo);
      return null;
    }
    Drawable unbadgedIcon=ai.loadIcon(mPackageManager);
    Drawable badgedIcon=mPackageManager.getUserBadgedIcon(unbadgedIcon,appInfo.getUser());
    if (NavigationBarApps.DEBUG) {
      Bitmap bitmap=Bitmap.createBitmap(badgedIcon.getIntrinsicWidth(),badgedIcon.getIntrinsicHeight(),Bitmap.Config.ARGB_8888);
      Canvas canvas=new Canvas(bitmap);
      badgedIcon.setBounds(0,0,badgedIcon.getIntrinsicWidth(),badgedIcon.getIntrinsicHeight());
      badgedIcon.draw(canvas);
      Paint paint=new Paint();
      paint.setStyle(Paint.Style.FILL);
      if (buttonData.pinned) {
        paint.setColor(Color.WHITE);
        canvas.drawCircle(10,10,10,paint);
      }
      if (buttonData.tasks != null && buttonData.tasks.size() > 0) {
        paint.setColor(Color.BLACK);
        canvas.drawCircle(60,30,30,paint);
        paint.setColor(Color.WHITE);
        paint.setTextSize(50);
        paint.setTypeface(Typeface.create("sans-serif",Typeface.BOLD));
        canvas.drawText(Integer.toString(buttonData.tasks.size()),50,50,paint);
      }
      badgedIcon=new BitmapDrawable(null,bitmap);
    }
    return badgedIcon;
  }
 catch (  RemoteException e) {
    Slog.w(TAG,"Icon not found for " + appInfo,e);
    return null;
  }
}
