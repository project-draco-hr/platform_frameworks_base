{
  if (event == null) {
    if (isCancelNeeded()) {
      event=mLastEvent;
      if (event != null) {
        event.setAction(MotionEvent.ACTION_CANCEL);
        mLastEvent=null;
      }
    }
    return event;
  }
switch (event.getActionMasked()) {
case MotionEvent.ACTION_MOVE:
case MotionEvent.ACTION_UP:
case MotionEvent.ACTION_POINTER_DOWN:
case MotionEvent.ACTION_POINTER_UP:
    if (mLastEvent == null || mLastEvent.getAction() == MotionEvent.ACTION_UP) {
      return null;
    }
  updateLastEvent(event);
return event;
case MotionEvent.ACTION_DOWN:
updateLastEvent(event);
return event;
case MotionEvent.ACTION_CANCEL:
if (mLastEvent == null) {
return null;
}
updateLastEvent(null);
return event;
default :
return null;
}
}
