{
  mCurrentDirPath=dirPath;
  final Handler delayedDialogHandler=new Handler(){
    @Override public void handleMessage(    Message msg){
      if (msg.what == MSG_SHOW_PROGRESS_DIALOG) {
        if (sProgressDialog == null) {
          sProgressDialog=new ProgressDialog(DirListActivity.this);
          sProgressDialog.setCancelable(false);
          sProgressDialog.setProgressStyle(ProgressDialog.STYLE_SPINNER);
          sProgressDialog.setTitle(R.string.dialog_progress_title);
          sProgressDialog.setMessage(getText(R.string.dialog_progress_msg));
        }
        sProgressDialog.show();
      }
    }
  }
;
  Message msgShowDialog=delayedDialogHandler.obtainMessage(MSG_SHOW_PROGRESS_DIALOG);
  delayedDialogHandler.sendMessageDelayed(msgShowDialog,PROGRESS_DIALOG_DELAY_MS);
  new LoadListItemsThread(mCurrentDirPath,new Handler(){
    @Override public void handleMessage(    Message msg){
      if (msg.what == MSG_LOADED_ITEMS) {
        setListAdapter(new DirListAdapter(DirListActivity.this,(ListItem[])msg.obj));
        delayedDialogHandler.removeMessages(MSG_SHOW_PROGRESS_DIALOG);
        setTitle(shortenTitle(mCurrentDirPath));
        if (sProgressDialog != null) {
          sProgressDialog.dismiss();
        }
      }
    }
  }
).start();
}
