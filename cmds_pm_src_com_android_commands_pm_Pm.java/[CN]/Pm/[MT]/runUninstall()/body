{
  int unInstallFlags=0;
  int userId=UserHandle.USER_ALL;
  String opt;
  while ((opt=nextOption()) != null) {
    if (opt.equals("-k")) {
      unInstallFlags|=PackageManager.DELETE_KEEP_DATA;
    }
 else     if (opt.equals("--user")) {
      String param=nextArg();
      if (isNumber(param)) {
        userId=Integer.parseInt(param);
      }
 else {
        showUsage();
        System.err.println("Error: Invalid user: " + param);
        return;
      }
    }
 else {
      System.err.println("Error: Unknown option: " + opt);
      return;
    }
  }
  String pkg=nextArg();
  if (pkg == null) {
    System.err.println("Error: no package specified");
    showUsage();
    return;
  }
  if (userId == UserHandle.USER_ALL) {
    userId=UserHandle.USER_OWNER;
    unInstallFlags|=PackageManager.DELETE_ALL_USERS;
  }
 else {
    PackageInfo info;
    try {
      info=mPm.getPackageInfo(pkg,0,userId);
    }
 catch (    RemoteException e) {
      System.err.println(e.toString());
      System.err.println(PM_NOT_RUNNING_ERR);
      return;
    }
    if (info == null) {
      System.err.println("Failure - not installed for " + userId);
      return;
    }
    final boolean isSystem=(info.applicationInfo.flags & ApplicationInfo.FLAG_SYSTEM) != 0;
    if (isSystem) {
      unInstallFlags|=PackageManager.DELETE_SYSTEM_APP;
    }
  }
  boolean result=deletePackage(pkg,unInstallFlags,userId);
  if (result) {
    System.out.println("Success");
  }
 else {
    System.out.println("Failure");
  }
}
