{
  final InstallParams params=makeInstallParams();
  final int sessionId=doCreateSession(params.sessionParams,params.installerPackageName,params.userId);
  try {
    final String inPath=nextArg();
    if (inPath == null && params.sessionParams.sizeBytes == 0) {
      System.err.println("Error: must either specify a package size or an APK file");
      return 1;
    }
    if (doWriteSession(sessionId,inPath,params.sessionParams.sizeBytes,"base.apk",false) != PackageInstaller.STATUS_SUCCESS) {
      return 1;
    }
    if (doCommitSession(sessionId,false) != PackageInstaller.STATUS_SUCCESS) {
      return 1;
    }
    System.out.println("Success");
    return 0;
  }
  finally {
    try {
      mInstaller.abandonSession(sessionId);
    }
 catch (    Exception ignore) {
    }
  }
}
