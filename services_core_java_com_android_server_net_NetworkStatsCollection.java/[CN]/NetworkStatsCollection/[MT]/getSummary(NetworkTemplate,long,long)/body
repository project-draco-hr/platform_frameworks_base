{
  final long now=System.currentTimeMillis();
  final NetworkStats stats=new NetworkStats(end - start,24);
  final NetworkStats.Entry entry=new NetworkStats.Entry();
  NetworkStatsHistory.Entry historyEntry=null;
  if (start == end)   return stats;
  for (  Map.Entry<Key,NetworkStatsHistory> mapEntry : mStats.entrySet()) {
    final Key key=mapEntry.getKey();
    if (templateMatches(template,key.ident)) {
      final NetworkStatsHistory history=mapEntry.getValue();
      historyEntry=history.getValues(start,end,now,historyEntry);
      entry.iface=IFACE_ALL;
      entry.uid=key.uid;
      entry.set=key.set;
      entry.tag=key.tag;
      entry.rxBytes=historyEntry.rxBytes;
      entry.rxPackets=historyEntry.rxPackets;
      entry.txBytes=historyEntry.txBytes;
      entry.txPackets=historyEntry.txPackets;
      entry.operations=historyEntry.operations;
      if (!entry.isEmpty()) {
        stats.combineValues(entry);
      }
    }
  }
  return stats;
}
