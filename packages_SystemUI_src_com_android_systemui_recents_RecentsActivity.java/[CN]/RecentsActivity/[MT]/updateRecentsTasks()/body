{
  RecentsTaskLoader loader=Recents.getTaskLoader();
  RecentsTaskLoadPlan plan=RecentsImpl.consumeInstanceLoadPlan();
  if (plan == null) {
    plan=loader.createLoadPlan(this);
  }
  RecentsConfiguration config=Recents.getConfiguration();
  RecentsActivityLaunchState launchState=config.getLaunchState();
  if (!plan.hasTasks()) {
    loader.preloadTasks(plan,launchState.launchedFromHome);
  }
  RecentsTaskLoadPlan.Options loadOpts=new RecentsTaskLoadPlan.Options();
  loadOpts.runningTaskId=launchState.launchedToTaskId;
  loadOpts.numVisibleTasks=launchState.launchedNumVisibleTasks;
  loadOpts.numVisibleTaskThumbnails=launchState.launchedNumVisibleThumbnails;
  loader.loadTasks(this,plan,loadOpts);
  TaskStack stack=plan.getTaskStack();
  mRecentsView.setTaskStack(stack);
  int launchTaskIndexInStack=0;
  if (launchState.launchedToTaskId != -1) {
    ArrayList<Task> tasks=stack.getStackTasks();
    int taskCount=tasks.size();
    for (int j=0; j < taskCount; j++) {
      Task t=tasks.get(j);
      if (t.key.id == launchState.launchedToTaskId) {
        t.isLaunchTarget=true;
        launchTaskIndexInStack=tasks.size() - j - 1;
        break;
      }
    }
  }
  boolean hasStatusBarScrim=stack.getStackTaskCount() > 0;
  boolean animateStatusBarScrim=launchState.launchedFromHome;
  boolean hasNavBarScrim=(stack.getStackTaskCount() > 0) && !config.hasTransposedNavBar;
  boolean animateNavBarScrim=true;
  mScrimViews.prepareEnterRecentsAnimation(hasStatusBarScrim,animateStatusBarScrim,hasNavBarScrim,animateNavBarScrim);
  if (launchState.launchedWithAltTab) {
    MetricsLogger.count(this,"overview_trigger_alttab",1);
  }
 else {
    MetricsLogger.count(this,"overview_trigger_nav_btn",1);
  }
  if (launchState.launchedFromAppWithThumbnail) {
    MetricsLogger.count(this,"overview_source_app",1);
    MetricsLogger.histogram(this,"overview_source_app_index",launchTaskIndexInStack);
  }
 else {
    MetricsLogger.count(this,"overview_source_home",1);
  }
  int taskCount=stack.getStackTaskCount();
  MetricsLogger.histogram(this,"overview_task_count",taskCount);
}
