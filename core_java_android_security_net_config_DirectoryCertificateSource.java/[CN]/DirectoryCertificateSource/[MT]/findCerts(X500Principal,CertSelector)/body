{
  String hash=getHash(subj);
  Set<X509Certificate> certs=null;
  for (int index=0; index >= 0; index++) {
    String fileName=hash + "." + index;
    if (!new File(mDir,fileName).exists()) {
      break;
    }
    if (isCertMarkedAsRemoved(fileName)) {
      continue;
    }
    X509Certificate cert=readCertificate(fileName);
    if (!subj.equals(cert.getSubjectX500Principal())) {
      continue;
    }
    if (selector.match(cert)) {
      if (certs == null) {
        certs=new ArraySet<X509Certificate>();
      }
      certs.add(cert);
    }
  }
  return certs != null ? certs : Collections.<X509Certificate>emptySet();
}
