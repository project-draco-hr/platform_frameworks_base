{
  height=Math.min(Math.max(height,mQsMinExpansionHeight),mQsMaxExpansionHeight);
  mQsFullyExpanded=height == mQsMaxExpansionHeight;
  if (height > mQsMinExpansionHeight && !mQsExpanded && !mStackScrollerOverscrolling) {
    setQsExpanded(true);
  }
 else   if (height <= mQsMinExpansionHeight && mQsExpanded) {
    setQsExpanded(false);
  }
  mQsExpansionHeight=height;
  mHeader.setExpansion(getHeaderExpansionFraction());
  setQsTranslation(height);
  requestScrollerTopPaddingUpdate(false);
  updateNotificationScrim(height);
  if (mKeyguardShowing) {
    float alpha=getQsExpansionFraction();
    alpha*=2;
    alpha=Math.min(1,alpha);
    alpha=1 - alpha;
    mKeyguardStatusBarTransparent=alpha == 0f;
    updateKeyguardStatusBarVisibility();
    if (!mKeyguardStatusBarTransparent) {
      mKeyguardStatusBar.setAlpha(alpha);
    }
  }
  if (mStatusBarState == StatusBarState.SHADE && mQsExpanded && !mStackScrollerOverscrolling && mQsScrimEnabled) {
    mQsNavbarScrim.setAlpha(getQsExpansionFraction());
  }
}
