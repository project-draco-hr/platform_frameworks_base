{
  int currentAlpha=getBackgroundAlpha(this);
  if (currentAlpha == targetAlpha) {
    return;
  }
  final int r=Color.red(rgb);
  final int g=Color.green(rgb);
  final int b=Color.blue(rgb);
  Object runningAnim=getTag(TAG_KEY_ANIM);
  if (runningAnim instanceof ValueAnimator) {
    ((ValueAnimator)runningAnim).cancel();
  }
  if (!animate) {
    setBackgroundColor(Color.argb(targetAlpha,r,g,b));
    return;
  }
  ValueAnimator anim=ValueAnimator.ofInt(currentAlpha,targetAlpha);
  anim.addUpdateListener(new ValueAnimator.AnimatorUpdateListener(){
    @Override public void onAnimationUpdate(    ValueAnimator animation){
      int value=(int)animation.getAnimatedValue();
      setBackgroundColor(Color.argb(value,r,g,b));
    }
  }
);
  anim.setInterpolator(mDozeAnimationInterpolator);
  anim.setDuration(DOZE_ANIMATION_DURATION);
  anim.addListener(new AnimatorListenerAdapter(){
    @Override public void onAnimationEnd(    Animator animation){
      setTag(TAG_KEY_ANIM,null);
    }
  }
);
  anim.start();
  setTag(TAG_KEY_ANIM,anim);
}
