{
  if (mKeyguardShowing && (mTwoFingerQsExpand || mIsExpanding && mQsExpandedWhenExpandingStarted)) {
    int maxNotifications=mClockPositionResult.stackScrollerPadding - mClockPositionResult.stackScrollerPaddingAdjustment - mNotificationTopPadding;
    int maxQs=getTempQsMaxExpansion();
    int max=mStatusBarState == StatusBarState.KEYGUARD ? Math.max(maxNotifications,maxQs) : maxQs;
    return (int)interpolate(getExpandedFraction(),mQsMinExpansionHeight,max);
  }
 else   if (mKeyguardShowing && mScrollYOverride == -1) {
    return interpolate(getQsExpansionFraction(),mNotificationStackScroller.getIntrinsicPadding() - mNotificationTopPadding,mQsMaxExpansionHeight);
  }
 else {
    return mQsExpansionHeight;
  }
}
