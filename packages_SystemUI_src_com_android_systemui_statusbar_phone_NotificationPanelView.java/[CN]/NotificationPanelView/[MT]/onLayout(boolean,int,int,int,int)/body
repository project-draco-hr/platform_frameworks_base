{
  super.onLayout(changed,left,top,right,bottom);
  mKeyguardStatusView.setPivotX(getWidth() / 2);
  mKeyguardStatusView.setPivotY((FONT_HEIGHT - CAP_HEIGHT) / 2048f * mClockView.getTextSize());
  int oldMaxHeight=mQsMaxExpansionHeight;
  mQsMinExpansionHeight=mKeyguardShowing ? 0 : mHeader.getCollapsedHeight() + mQsPeekHeight;
  mQsMaxExpansionHeight=mHeader.getExpandedHeight() + mQsContainer.getDesiredHeight();
  positionClockAndNotifications();
  if (mQsExpanded && mQsFullyExpanded) {
    mQsExpansionHeight=mQsMaxExpansionHeight;
    requestScrollerTopPaddingUpdate(false);
    requestPanelHeightUpdate();
    if (mQsMaxExpansionHeight != oldMaxHeight) {
      startQsSizeChangeAnimation(oldMaxHeight,mQsMaxExpansionHeight);
    }
  }
 else   if (!mQsExpanded) {
    setQsExpansion(mQsMinExpansionHeight + mLastOverscroll);
  }
  mNotificationStackScroller.setStackHeight(getExpandedHeight());
  updateHeader();
  mNotificationStackScroller.updateIsSmallScreen(mHeader.getCollapsedHeight() + mQsPeekHeight);
  if (mQsSizeChangeAnimator == null) {
    mQsContainer.setHeightOverride(mQsContainer.getDesiredHeight());
  }
  updateMaxHeadsUpTranslation();
}
