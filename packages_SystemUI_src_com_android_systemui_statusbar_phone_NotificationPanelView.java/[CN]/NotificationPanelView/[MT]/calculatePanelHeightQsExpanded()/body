{
  float notificationHeight=mNotificationStackScroller.getHeight() - mNotificationStackScroller.getEmptyBottomMargin() - mNotificationStackScroller.getTopPadding();
  float totalHeight=Math.max(mQsMaxExpansionHeight + mNotificationStackScroller.getNotificationTopPadding(),mClockPositionResult.stackScrollerPadding - mTopPaddingAdjustment) + notificationHeight;
  if (totalHeight > mNotificationStackScroller.getHeight()) {
    float fullyCollapsedHeight=mQsMaxExpansionHeight + mNotificationStackScroller.getMinStackHeight() + mNotificationStackScroller.getNotificationTopPadding() - getScrollViewScrollY();
    totalHeight=Math.max(fullyCollapsedHeight,mNotificationStackScroller.getHeight());
  }
  return (int)totalHeight;
}
