{
  if (mStatusBar.getBarState() != StatusBarState.KEYGUARD && mNotificationStackScroller.getNotGoneChildCount() == 0) {
    return (int)((mQsMinExpansionHeight + getOverExpansionAmount()) * HEADER_RUBBERBAND_FACTOR);
  }
  int emptyBottomMargin=mNotificationStackScroller.getEmptyBottomMargin();
  int maxHeight=mNotificationStackScroller.getHeight() - emptyBottomMargin - mTopPaddingAdjustment;
  maxHeight=Math.max(maxHeight,mStatusBarMinHeight);
  return maxHeight;
}
