{
  if (mPrivateInput == null) {
    mPrivateInput=new PrivateInputStream(this);
  }
  boolean more=true;
  if (mGetOperation) {
    if (!mOperationDone) {
      if (!mGetFinalFlag) {
        mReplyHeader.responseCode=ResponseCodes.OBEX_HTTP_CONTINUE;
        while ((more) && (mReplyHeader.responseCode == ResponseCodes.OBEX_HTTP_CONTINUE)) {
          more=sendRequest(ObexHelper.OBEX_OPCODE_GET);
        }
        if (mReplyHeader.responseCode == ResponseCodes.OBEX_HTTP_CONTINUE) {
          mParent.sendRequest(ObexHelper.OBEX_OPCODE_GET_FINAL,null,mReplyHeader,mPrivateInput,mSrmActive);
        }
        if (mReplyHeader.responseCode != ResponseCodes.OBEX_HTTP_CONTINUE) {
          mOperationDone=true;
        }
 else {
          checkForSrm();
        }
      }
 else {
        more=sendRequest(ObexHelper.OBEX_OPCODE_GET_FINAL);
        if (more) {
          throw new IOException("FINAL_GET forced, data didn't fit into one packet");
        }
        mOperationDone=true;
      }
    }
  }
 else {
    if (!mOperationDone) {
      mReplyHeader.responseCode=ResponseCodes.OBEX_HTTP_CONTINUE;
      while ((more) && (mReplyHeader.responseCode == ResponseCodes.OBEX_HTTP_CONTINUE)) {
        more=sendRequest(ObexHelper.OBEX_OPCODE_PUT);
      }
    }
    if (mReplyHeader.responseCode == ResponseCodes.OBEX_HTTP_CONTINUE) {
      mParent.sendRequest(ObexHelper.OBEX_OPCODE_PUT_FINAL,null,mReplyHeader,mPrivateInput,mSrmActive);
    }
    if (mReplyHeader.responseCode != ResponseCodes.OBEX_HTTP_CONTINUE) {
      mOperationDone=true;
    }
  }
}
