{
  long sent, received;
  long preTxPkts=mTxPkts, preRxPkts=mRxPkts;
  int dataActivity=WifiManager.DATA_ACTIVITY_NONE;
  mTxPkts=TrafficStats.getTxPackets(mInterface);
  mRxPkts=TrafficStats.getRxPackets(mInterface);
  if (preTxPkts > 0 || preRxPkts > 0) {
    sent=mTxPkts - preTxPkts;
    received=mRxPkts - preRxPkts;
    if (sent > 0) {
      dataActivity|=WifiManager.DATA_ACTIVITY_OUT;
    }
    if (received > 0) {
      dataActivity|=WifiManager.DATA_ACTIVITY_IN;
    }
    if (dataActivity != mDataActivity && mScreenOn.get()) {
      mDataActivity=dataActivity;
      for (      Messenger client : mClients) {
        Message msg=Message.obtain();
        msg.what=WifiManager.DATA_ACTIVITY_NOTIFICATION;
        msg.arg1=mDataActivity;
        try {
          client.send(msg);
        }
 catch (        RemoteException e) {
        }
      }
    }
  }
}
