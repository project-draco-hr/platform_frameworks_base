{
  int count=matches.size();
  if (count == 0)   return;
  ResolveInfo defaultRI=null;
  if (count == 1 && defaultPackage == null) {
    ResolveInfo rInfo=matches.get(0);
    if (rInfo.activityInfo != null && rInfo.activityInfo.applicationInfo != null && (rInfo.activityInfo.applicationInfo.flags & ApplicationInfo.FLAG_SYSTEM) != 0) {
      defaultRI=rInfo;
      int uid=rInfo.activityInfo.applicationInfo.uid;
      if (device != null) {
        grantDevicePermission(device,uid);
      }
 else       if (accessory != null) {
        grantAccessoryPermission(accessory,uid);
      }
    }
  }
  if (defaultRI == null && defaultPackage != null) {
    for (int i=0; i < count; i++) {
      ResolveInfo rInfo=matches.get(i);
      if (rInfo.activityInfo != null && defaultPackage.equals(rInfo.activityInfo.packageName)) {
        defaultRI=rInfo;
        break;
      }
    }
  }
  if (defaultRI != null) {
    try {
      intent.setComponent(new ComponentName(defaultRI.activityInfo.packageName,defaultRI.activityInfo.name));
      mContext.startActivity(intent);
    }
 catch (    ActivityNotFoundException e) {
      Log.e(TAG,"startActivity failed",e);
    }
  }
 else {
    long identity=Binder.clearCallingIdentity();
    Intent resolverIntent=new Intent();
    resolverIntent.setClassName("com.android.systemui","com.android.systemui.usb.UsbResolverActivity");
    resolverIntent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
    resolverIntent.putExtra(Intent.EXTRA_INTENT,intent);
    resolverIntent.putParcelableArrayListExtra("rlist",matches);
    try {
      mContext.startActivity(resolverIntent);
    }
 catch (    ActivityNotFoundException e) {
      Log.e(TAG,"unable to start UsbResolverActivity");
    }
 finally {
      Binder.restoreCallingIdentity(identity);
    }
  }
}
