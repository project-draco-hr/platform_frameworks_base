{
  if (DEBUG) {
    Log.d(TAG,"endConfigure called.");
  }
  if (mLegacyDevice.isClosed()) {
    String err="Cannot end configure, device has been closed.";
    Log.e(TAG,err);
    throw new ServiceSpecificException(ICameraService.ERROR_DISCONNECTED,err);
  }
  SparseArray<Surface> surfaces=null;
synchronized (mConfigureLock) {
    if (!mConfiguring) {
      String err="Cannot end configure, no configuration change in progress.";
      Log.e(TAG,err);
      throw new ServiceSpecificException(ICameraService.ERROR_INVALID_OPERATION,err);
    }
    if (mSurfaces != null) {
      surfaces=mSurfaces.clone();
    }
    mConfiguring=false;
  }
  mLegacyDevice.configureOutputs(surfaces);
}
