{
  Context context=getContext();
  mWhichButtonClicked=DialogInterface.BUTTON2;
  mBuilder=new AlertDialog.Builder(context).setTitle(mDialogTitle).setIcon(mDialogIcon).setPositiveButton(mPositiveButtonText,this).setNegativeButton(mNegativeButtonText,this);
  View contentView=onCreateDialogView();
  if (contentView != null) {
    onBindDialogView(contentView);
    mBuilder.setView(contentView);
  }
 else {
    mBuilder.setMessage(mDialogMessage);
  }
  onPrepareDialogBuilder(mBuilder);
  getPreferenceManager().registerOnActivityDestroyListener(this);
  final Dialog dialog=mDialog=mBuilder.create();
  if (state != null) {
    dialog.onRestoreInstanceState(state);
  }
  if (needInputMethod()) {
    requestInputMethod(dialog);
  }
  dialog.setOnDismissListener(this);
  dialog.show();
}
