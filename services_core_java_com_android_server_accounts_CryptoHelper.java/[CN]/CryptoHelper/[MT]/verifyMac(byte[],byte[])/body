{
  if (cipherArray == null || cipherArray.length == 0 || macArray == null || macArray.length == 0) {
    if (Log.isLoggable(TAG,Log.VERBOSE)) {
      Log.v(TAG,"Cipher or MAC is empty!");
    }
    return false;
  }
  Mac mac=Mac.getInstance(MAC_ALGORITHM);
  mac.init(mMacKeySpec);
  mac.update(cipherArray);
  return Arrays.equals(macArray,mac.doFinal());
}
