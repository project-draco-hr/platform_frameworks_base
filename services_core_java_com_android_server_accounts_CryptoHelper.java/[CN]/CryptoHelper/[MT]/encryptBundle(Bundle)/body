{
  Preconditions.checkNotNull(bundle,"Cannot encrypt null bundle.");
  Parcel parcel=Parcel.obtain();
  bundle.writeToParcel(parcel,0);
  byte[] clearBytes=parcel.marshall();
  parcel.recycle();
  Cipher cipher=Cipher.getInstance(CIPHER_ALGORITHM);
  cipher.init(Cipher.ENCRYPT_MODE,mEncryptionKey);
  byte[] encryptedBytes=cipher.doFinal(clearBytes);
  byte[] iv=cipher.getIV();
  byte[] mac=createMac(encryptedBytes,iv);
  Bundle encryptedBundle=new Bundle();
  encryptedBundle.putByteArray(KEY_CIPHER,encryptedBytes);
  encryptedBundle.putByteArray(KEY_MAC,mac);
  encryptedBundle.putByteArray(KEY_IV,iv);
  return encryptedBundle;
}
