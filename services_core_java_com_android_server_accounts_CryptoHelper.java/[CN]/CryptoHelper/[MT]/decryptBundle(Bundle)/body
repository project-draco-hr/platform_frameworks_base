{
  Preconditions.checkNotNull(bundle,"Cannot decrypt null bundle.");
  byte[] iv=bundle.getByteArray(KEY_IV);
  byte[] encryptedBytes=bundle.getByteArray(KEY_CIPHER);
  byte[] mac=bundle.getByteArray(KEY_MAC);
  if (!verifyMac(encryptedBytes,iv,mac)) {
    Log.w(TAG,"Escrow mac mismatched!");
    return null;
  }
  IvParameterSpec ivSpec=new IvParameterSpec(iv);
  Cipher cipher=Cipher.getInstance(CIPHER_ALGORITHM);
  cipher.init(Cipher.DECRYPT_MODE,mEncryptionKey,ivSpec);
  byte[] decryptedBytes=cipher.doFinal(encryptedBytes);
  Parcel decryptedParcel=Parcel.obtain();
  decryptedParcel.unmarshall(decryptedBytes,0,decryptedBytes.length);
  decryptedParcel.setDataPosition(0);
  Bundle decryptedBundle=new Bundle();
  decryptedBundle.readFromParcel(decryptedParcel);
  decryptedParcel.recycle();
  return decryptedBundle;
}
