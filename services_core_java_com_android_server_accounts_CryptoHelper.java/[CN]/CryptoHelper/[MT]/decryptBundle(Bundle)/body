{
  Preconditions.checkNotNull(bundle,"Cannot decrypt null bundle.");
  byte[] cipherArray=bundle.getByteArray(KEY_CIPHER);
  byte[] macArray=bundle.getByteArray(KEY_MAC);
  if (!verifyMac(cipherArray,macArray)) {
    if (Log.isLoggable(TAG,Log.VERBOSE)) {
      Log.v(TAG,"Escrow mac mismatched!");
    }
    return null;
  }
  Cipher cipher=Cipher.getInstance(CIPHER_ALGORITHM);
  cipher.init(Cipher.DECRYPT_MODE,mCipherKeySpec,mIv);
  byte[] decryptedBytes=cipher.doFinal(cipherArray);
  Parcel decryptedParcel=Parcel.obtain();
  decryptedParcel.unmarshall(decryptedBytes,0,decryptedBytes.length);
  decryptedParcel.setDataPosition(0);
  Bundle decryptedBundle=new Bundle();
  decryptedBundle.readFromParcel(decryptedParcel);
  decryptedParcel.recycle();
  return decryptedBundle;
}
