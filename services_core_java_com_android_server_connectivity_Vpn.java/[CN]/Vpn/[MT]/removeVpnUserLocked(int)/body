{
  if (!isRunningLocked()) {
    throw new IllegalStateException("VPN is not active");
  }
  UidRange uidRange=UidRange.createForUser(user);
  if (mNetworkAgent != null) {
    mNetworkAgent.removeUidRanges(new UidRange[]{uidRange});
  }
  mVpnUsers.remove(uidRange);
  hideNotification(user);
}
