{
  if (oldPackage != null && getAppUid(oldPackage,mUserHandle) != mOwnerUID) {
    if (!oldPackage.equals(VpnConfig.LEGACY_VPN) && isVpnUserPreConsented(oldPackage)) {
      prepareInternal(oldPackage);
      return true;
    }
    return false;
  }
  if (newPackage == null || (!newPackage.equals(VpnConfig.LEGACY_VPN) && getAppUid(newPackage,mUserHandle) == mOwnerUID)) {
    return true;
  }
  enforceControlPermission();
  prepareInternal(newPackage);
  return true;
}
