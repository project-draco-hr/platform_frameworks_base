{
  if (mAlwaysOn && !TextUtils.equals(mPackage,newPackage)) {
    return false;
  }
  if (oldPackage != null) {
    if (getAppUid(oldPackage,mUserHandle) != mOwnerUID) {
      if (!oldPackage.equals(VpnConfig.LEGACY_VPN) && isVpnUserPreConsented(oldPackage)) {
        prepareInternal(oldPackage);
        return true;
      }
      return false;
    }
 else     if (!oldPackage.equals(VpnConfig.LEGACY_VPN) && !isVpnUserPreConsented(oldPackage)) {
      prepareInternal(VpnConfig.LEGACY_VPN);
      return false;
    }
  }
  if (newPackage == null || (!newPackage.equals(VpnConfig.LEGACY_VPN) && getAppUid(newPackage,mUserHandle) == mOwnerUID)) {
    return true;
  }
  enforceControlPermission();
  prepareInternal(newPackage);
  return true;
}
