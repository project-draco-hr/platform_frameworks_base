{
  enforceControlPermissionOrInternalCaller();
  prepareInternal(VpnConfig.LEGACY_VPN);
  if (packageName != null) {
    if (!setPackageAuthorization(packageName,true)) {
      return false;
    }
    prepareInternal(packageName);
  }
  mAlwaysOn=(packageName != null);
  mLockdown=(mAlwaysOn && lockdown);
  maybeRegisterPackageChangeReceiverLocked(packageName);
  setVpnForcedLocked(mLockdown);
  return true;
}
