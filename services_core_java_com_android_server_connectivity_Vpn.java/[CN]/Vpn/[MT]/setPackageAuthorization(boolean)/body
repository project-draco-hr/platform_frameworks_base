{
  enforceControlPermission();
  if (mPackage == null || VpnConfig.LEGACY_VPN.equals(mPackage)) {
    return;
  }
  long token=Binder.clearCallingIdentity();
  try {
    AppOpsManager appOps=(AppOpsManager)mContext.getSystemService(Context.APP_OPS_SERVICE);
    appOps.setMode(AppOpsManager.OP_ACTIVATE_VPN,mOwnerUID,mPackage,authorized ? AppOpsManager.MODE_ALLOWED : AppOpsManager.MODE_IGNORED);
  }
 catch (  Exception e) {
    Log.wtf(TAG,"Failed to set app ops for package " + mPackage,e);
  }
 finally {
    Binder.restoreCallingIdentity(token);
  }
}
