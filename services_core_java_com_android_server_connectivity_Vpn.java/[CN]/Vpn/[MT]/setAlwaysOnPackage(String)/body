{
  enforceControlPermissionOrInternalCaller();
  prepareInternal(VpnConfig.LEGACY_VPN);
  if (packageName != null) {
    if (!setPackageAuthorization(packageName,true)) {
      return false;
    }
    prepareInternal(packageName);
  }
  final long token=Binder.clearCallingIdentity();
  try {
    Settings.Secure.putStringForUser(mContext.getContentResolver(),Settings.Secure.ALWAYS_ON_VPN_APP,packageName,mUserHandle);
  }
  finally {
    Binder.restoreCallingIdentity(token);
  }
  return true;
}
