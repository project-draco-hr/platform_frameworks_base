{
  if (state == DetailedState.CONNECTED && ssid == null) {
    if (TextUtils.isEmpty(passpointProvider) == false) {
      String format=context.getString(R.string.connected_via_passpoint);
      return String.format(format,passpointProvider);
    }
 else     if (isEphemeral) {
      return context.getString(R.string.connected_via_wfa);
    }
  }
  final ConnectivityManager cm=(ConnectivityManager)context.getSystemService(Context.CONNECTIVITY_SERVICE);
  if (state == DetailedState.CONNECTED) {
    IWifiManager wifiManager=IWifiManager.Stub.asInterface(ServiceManager.getService(Context.WIFI_SERVICE));
    Network nw;
    try {
      nw=wifiManager.getCurrentNetwork();
    }
 catch (    RemoteException e) {
      nw=null;
    }
    NetworkCapabilities nc=cm.getNetworkCapabilities(nw);
    if (nc != null && !nc.hasCapability(nc.NET_CAPABILITY_VALIDATED)) {
      return context.getString(R.string.wifi_connected_no_internet);
    }
  }
  String[] formats=context.getResources().getStringArray((ssid == null) ? R.array.wifi_status : R.array.wifi_status_with_ssid);
  int index=state.ordinal();
  if (index >= formats.length || formats[index].length() == 0) {
    return null;
  }
  return String.format(formats[index],ssid);
}
