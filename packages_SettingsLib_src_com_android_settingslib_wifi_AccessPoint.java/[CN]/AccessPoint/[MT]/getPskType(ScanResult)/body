{
  boolean wpa=result.capabilities.contains("WPA-PSK");
  boolean wpa2=result.capabilities.contains("WPA2-PSK");
  if (wpa2 && wpa) {
    return PSK_WPA_WPA2;
  }
 else   if (wpa2) {
    return PSK_WPA2;
  }
 else   if (wpa) {
    return PSK_WPA;
  }
 else {
    Log.w(TAG,"Received abnormal flag string: " + result.capabilities);
    return PSK_UNKNOWN;
  }
}
