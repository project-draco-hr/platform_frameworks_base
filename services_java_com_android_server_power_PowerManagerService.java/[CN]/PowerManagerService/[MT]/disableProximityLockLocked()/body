{
  if (DEBUG_PROXIMITY_SENSOR) {
    Slog.d(TAG,"disableProximityLockLocked");
  }
  if (mProximitySensorEnabled) {
    long identity=Binder.clearCallingIdentity();
    try {
      mSensorManager.unregisterListener(mProximityListener);
      mHandler.removeCallbacks(mProximityTask);
      if (mProximityPartialLock.isHeld()) {
        mProximityPartialLock.release();
      }
      mProximitySensorEnabled=false;
    }
  finally {
      Binder.restoreCallingIdentity(identity);
    }
    if (mProximitySensorActive) {
      mProximitySensorActive=false;
      if (DEBUG_PROXIMITY_SENSOR) {
        Slog.d(TAG,"disableProximityLockLocked mProxIgnoredBecauseScreenTurnedOff=" + mProxIgnoredBecauseScreenTurnedOff);
      }
      if (!mProxIgnoredBecauseScreenTurnedOff) {
        forceUserActivityLocked();
      }
    }
  }
}
