{
  boolean changed=false;
  if ((dirty & (DIRTY_WAKE_LOCKS | DIRTY_USER_ACTIVITY | DIRTY_BOOT_COMPLETED| DIRTY_WAKEFULNESS| DIRTY_STAY_ON)) != 0) {
    if (mWakefulness == WAKEFULNESS_AWAKE && isItBedTimeYetLocked()) {
      if (DEBUG_SPEW) {
        Slog.d(TAG,"updateWakefulnessLocked: Nap time...");
      }
      mWakefulness=WAKEFULNESS_NAPPING;
      mDirty|=DIRTY_WAKEFULNESS;
      changed=true;
    }
  }
  return changed;
}
