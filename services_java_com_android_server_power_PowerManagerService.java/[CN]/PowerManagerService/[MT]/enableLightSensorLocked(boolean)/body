{
  if (mDebugLightSensor) {
    Slog.d(TAG,"enableLightSensorLocked enable=" + enable + " mLightSensorEnabled="+ mLightSensorEnabled+ " mAutoBrightessEnabled="+ mAutoBrightessEnabled+ " mWaitingForFirstLightSensor="+ mWaitingForFirstLightSensor);
  }
  if (!mAutoBrightessEnabled) {
    enable=false;
  }
  if (mSensorManager != null && mLightSensorEnabled != enable) {
    mLightSensorEnabled=enable;
    long identity=Binder.clearCallingIdentity();
    try {
      if (enable) {
        mHighestLightSensorValue=-1;
        final int value=(int)mLightSensorValue;
        if (value >= 0) {
          mLightSensorValue=-1;
          handleLightSensorValue(value,true);
        }
        mSensorManager.registerListener(mLightListener,mLightSensor,LIGHT_SENSOR_RATE);
      }
 else {
        mSensorManager.unregisterListener(mLightListener);
        mHandler.removeCallbacks(mAutoBrightnessTask);
        mLightSensorPendingDecrease=false;
        mLightSensorPendingIncrease=false;
      }
    }
  finally {
      Binder.restoreCallingIdentity(identity);
    }
  }
}
