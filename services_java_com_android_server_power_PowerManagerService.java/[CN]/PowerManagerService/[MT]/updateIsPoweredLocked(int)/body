{
  if ((dirty & DIRTY_BATTERY_STATE) != 0) {
    boolean wasPowered=mIsPowered;
    mIsPowered=mBatteryService.isPowered();
    if (wasPowered != mIsPowered) {
      mDirty|=DIRTY_IS_POWERED;
      final long now=SystemClock.uptimeMillis();
      if (mWakeUpWhenPluggedOrUnpluggedConfig) {
        wakeUpNoUpdateLocked(now);
      }
      userActivityNoUpdateLocked(now,PowerManager.USER_ACTIVITY_EVENT_OTHER,0,Process.SYSTEM_UID);
    }
  }
}
