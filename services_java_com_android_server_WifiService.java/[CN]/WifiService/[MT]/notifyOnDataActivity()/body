{
  long sent, received;
  long preTxPkts=mTxPkts, preRxPkts=mRxPkts;
  int dataActivity=WifiManager.DATA_ACTIVITY_NONE;
  mTxPkts=TrafficStats.getTxPackets(mInterfaceName);
  mRxPkts=TrafficStats.getRxPackets(mInterfaceName);
  if (preTxPkts > 0 || preRxPkts > 0) {
    sent=mTxPkts - preTxPkts;
    received=mRxPkts - preRxPkts;
    if (sent > 0) {
      dataActivity|=WifiManager.DATA_ACTIVITY_OUT;
    }
    if (received > 0) {
      dataActivity|=WifiManager.DATA_ACTIVITY_IN;
    }
    if (dataActivity != mDataActivity && !mScreenOff) {
      mDataActivity=dataActivity;
      for (      AsyncChannel client : mClients) {
        client.sendMessage(WifiManager.DATA_ACTIVITY_NOTIFICATION,mDataActivity);
      }
    }
  }
}
