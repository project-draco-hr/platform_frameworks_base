{
  boolean wifiTethered=false;
  boolean wifiAvailable=false;
  IBinder b=ServiceManager.getService(Context.NETWORKMANAGEMENT_SERVICE);
  INetworkManagementService service=INetworkManagementService.Stub.asInterface(b);
  if (mCm == null) {
    mCm=(ConnectivityManager)mContext.getSystemService(Context.CONNECTIVITY_SERVICE);
  }
  mWifiRegexs=mCm.getTetherableWifiRegexs();
  for (  String intf : available) {
    for (    String regex : mWifiRegexs) {
      if (intf.matches(regex)) {
        InterfaceConfiguration ifcg=null;
        try {
          ifcg=service.getInterfaceConfig(intf);
          if (ifcg != null) {
            ifcg.ipAddr=(192 << 24) + (168 << 16) + (43 << 8)+ 1;
            ifcg.netmask=(255 << 24) + (255 << 16) + (255 << 8)+ 0;
            ifcg.interfaceFlags="[up]";
            service.setInterfaceConfig(intf,ifcg);
          }
        }
 catch (        Exception e) {
          Slog.e(TAG,"Error configuring interface " + intf + ", :"+ e);
          setWifiApEnabled(null,false);
          return;
        }
        if (mCm.tether(intf) != ConnectivityManager.TETHER_ERROR_NO_ERROR) {
          Slog.e(TAG,"Error tethering on " + intf);
          setWifiApEnabled(null,false);
          return;
        }
        break;
      }
    }
  }
}
