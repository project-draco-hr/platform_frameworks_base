{
  mContext.enforceCallingOrSelfPermission(android.Manifest.permission.WAKE_LOCK,null);
  if (lockMode != WifiManager.WIFI_MODE_FULL && lockMode != WifiManager.WIFI_MODE_SCAN_ONLY) {
    return false;
  }
  if (ws != null && ws.size() == 0) {
    ws=null;
  }
  if (ws != null) {
    enforceWakeSourcePermission(Binder.getCallingUid(),Binder.getCallingPid());
  }
  if (ws == null) {
    ws=new WorkSource(Binder.getCallingUid());
  }
  WifiLock wifiLock=new WifiLock(lockMode,tag,binder,ws);
synchronized (mLocks) {
    return acquireWifiLockLocked(wifiLock);
  }
}
