{
  enforceAccessPermission();
  DhcpResults dhcpResults=mWifiStateMachine.syncGetDhcpResults();
  if (dhcpResults.linkProperties == null)   return null;
  DhcpInfo info=new DhcpInfo();
  for (  LinkAddress la : dhcpResults.linkProperties.getLinkAddresses()) {
    InetAddress addr=la.getAddress();
    if (addr instanceof Inet4Address) {
      info.ipAddress=NetworkUtils.inetAddressToInt((Inet4Address)addr);
      break;
    }
  }
  for (  RouteInfo r : dhcpResults.linkProperties.getRoutes()) {
    if (r.isDefaultRoute()) {
      InetAddress gateway=r.getGateway();
      if (gateway instanceof Inet4Address) {
        info.gateway=NetworkUtils.inetAddressToInt((Inet4Address)gateway);
      }
    }
 else     if (r.isHostRoute()) {
      LinkAddress dest=r.getDestination();
      if (dest.getAddress() instanceof Inet4Address) {
        info.netmask=NetworkUtils.prefixLengthToNetmaskInt(dest.getNetworkPrefixLength());
      }
    }
  }
  int dnsFound=0;
  for (  InetAddress dns : dhcpResults.linkProperties.getDnses()) {
    if (dns instanceof Inet4Address) {
      if (dnsFound == 0) {
        info.dns1=NetworkUtils.inetAddressToInt((Inet4Address)dns);
      }
 else {
        info.dns2=NetworkUtils.inetAddressToInt((Inet4Address)dns);
      }
      if (++dnsFound > 1)       break;
    }
  }
  InetAddress serverAddress=dhcpResults.serverAddress;
  if (serverAddress instanceof Inet4Address) {
    info.serverAddress=NetworkUtils.inetAddressToInt((Inet4Address)serverAddress);
  }
  info.leaseDuration=dhcpResults.leaseDuration;
  return info;
}
