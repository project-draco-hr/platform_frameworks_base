{
  enforceAccessPermission();
  String listStr;
synchronized (mWifiStateTracker) {
    listStr=WifiNative.listNetworksCommand();
  }
  List<WifiConfiguration> networks=new ArrayList<WifiConfiguration>();
  if (listStr == null)   return networks;
  String[] lines=listStr.split("\n");
  for (int i=1; i < lines.length; i++) {
    String[] result=lines[i].split("\t");
    WifiConfiguration config=new WifiConfiguration();
    try {
      config.networkId=Integer.parseInt(result[0]);
    }
 catch (    NumberFormatException e) {
      continue;
    }
    if (result.length > 3) {
      if (result[3].indexOf("[CURRENT]") != -1)       config.status=WifiConfiguration.Status.CURRENT;
 else       if (result[3].indexOf("[DISABLED]") != -1)       config.status=WifiConfiguration.Status.DISABLED;
 else       config.status=WifiConfiguration.Status.ENABLED;
    }
 else     config.status=WifiConfiguration.Status.ENABLED;
synchronized (mWifiStateTracker) {
      readNetworkVariables(config);
    }
    networks.add(config);
  }
  return networks;
}
