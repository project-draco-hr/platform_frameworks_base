{
  boolean hadLock;
  WifiLock wifiLock=mLocks.removeLock(lock);
  if (DBG)   Slog.d(TAG,"releaseWifiLockLocked: " + wifiLock);
  hadLock=(wifiLock != null);
  if (hadLock) {
    long ident=Binder.clearCallingIdentity();
    try {
      noteAcquireWifiLock(wifiLock);
switch (wifiLock.mMode) {
case WifiManager.WIFI_MODE_FULL:
        ++mFullLocksReleased;
      break;
case WifiManager.WIFI_MODE_FULL_HIGH_PERF:
    ++mFullHighPerfLocksReleased;
  break;
case WifiManager.WIFI_MODE_SCAN_ONLY:
++mScanLocksReleased;
break;
}
}
 catch (RemoteException e) {
}
 finally {
Binder.restoreCallingIdentity(ident);
}
}
updateWifiState();
return hadLock;
}
