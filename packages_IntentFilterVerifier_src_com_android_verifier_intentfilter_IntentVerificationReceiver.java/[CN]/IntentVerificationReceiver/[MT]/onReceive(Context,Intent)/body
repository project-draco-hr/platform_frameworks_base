{
  final String action=intent.getAction();
  if (Intent.ACTION_INTENT_FILTER_NEEDS_VERIFICATION.equals(action)) {
    Bundle extras=intent.getExtras();
    if (extras != null) {
      int verificationId=extras.getInt(PackageManager.EXTRA_INTENT_FILTER_VERIFICATION_ID);
      String hosts=extras.getString(PackageManager.EXTRA_INTENT_FILTER_VERIFICATION_HOSTS);
      Log.d(TAG,"Received IntentFilter verification broadcast with verificationId: " + verificationId);
      if (canDoVerification(context)) {
        Intent serviceIntent=new Intent(context,IntentVerificationService.class);
        serviceIntent.fillIn(intent,0);
        serviceIntent.putExtras(intent.getExtras());
        Slog.d(TAG,"Starting Intent Verification Service.");
        context.startService(serviceIntent);
      }
 else {
        sendVerificationFailure(context,verificationId,hosts);
      }
    }
  }
 else {
    Log.w(TAG,"Unexpected action: " + action);
  }
}
