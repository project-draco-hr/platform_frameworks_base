{
  int[] mins=getMinima();
  int totalDelta=max(0,targetSize - size(mins));
  float[] weights=getWeights();
  float totalWeight=sum(weights);
  if (totalWeight == 0f && weights.length > 0) {
    weights[weights.length - 1]=1;
    totalWeight=1;
  }
  int[] locations=getLocations();
  int cumulativeDelta=0;
  for (int i=0; i < weights.length; i++) {
    float weight=weights[i];
    int delta=(int)(totalDelta * weight / totalWeight);
    cumulativeDelta+=delta;
    locations[i + 1]=mins[i + 1] + cumulativeDelta;
    totalDelta-=delta;
    totalWeight-=weight;
  }
}
