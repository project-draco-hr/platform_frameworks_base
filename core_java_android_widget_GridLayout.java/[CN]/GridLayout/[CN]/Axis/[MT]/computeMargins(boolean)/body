{
  int[] result=new int[getCount() + 1];
  for (int i=0, size=getChildCount(); i < size; i++) {
    View c=getChildAt(i);
    LayoutParams lp=getLayoutParams(c);
    Group g=horizontal ? lp.columnGroup : lp.rowGroup;
    Interval span=g.span;
    int index=leading ? span.min : span.max;
    result[index]=max(result[index],getMargin(c,leading,horizontal));
  }
  return result;
}
