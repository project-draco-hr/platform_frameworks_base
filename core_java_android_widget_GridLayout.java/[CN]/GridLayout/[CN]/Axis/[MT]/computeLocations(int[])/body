{
  if (!hasWeights()) {
    solve(a);
  }
 else {
    solveAndDistributeSpace(a);
  }
  if (!orderPreserved) {
    int a0=a[0];
    for (int i=0, N=a.length; i < N; i++) {
      a[i]=a[i] - a0;
    }
  }
}
