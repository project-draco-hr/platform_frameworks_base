{
  for (int i=0, N=getChildCount(); i < N; i++) {
    View c=getChildAt(i);
    if (c.getVisibility() == View.GONE)     continue;
    LayoutParams lp=getLayoutParams(c);
    if (firstPass) {
      measureChildWithMargins2(c,widthSpec,heightSpec,lp.width,lp.height);
    }
 else {
      boolean horizontal=(mOrientation == HORIZONTAL);
      Spec spec=horizontal ? lp.columnSpec : lp.rowSpec;
      if (spec.alignment == FILL) {
        Interval span=spec.span;
        Axis axis=horizontal ? mHorizontalAxis : mVerticalAxis;
        int[] locations=axis.getLocations();
        int cellSize=locations[span.max] - locations[span.min];
        int viewSize=cellSize - getTotalMargin(c,horizontal);
        if (horizontal) {
          measureChildWithMargins2(c,widthSpec,heightSpec,viewSize,lp.height);
        }
 else {
          measureChildWithMargins2(c,widthSpec,heightSpec,lp.width,viewSize);
        }
      }
    }
  }
}
