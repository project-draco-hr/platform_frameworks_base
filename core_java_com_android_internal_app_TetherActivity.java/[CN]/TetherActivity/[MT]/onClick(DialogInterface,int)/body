{
  int error=ConnectivityManager.TETHER_ERROR_NO_ERROR;
  if (which == POSITIVE_BUTTON) {
    ConnectivityManager cm=(ConnectivityManager)getSystemService(Context.CONNECTIVITY_SERVICE);
    String[] tethered=cm.getTetheredIfaces();
    if (tethered.length == 0) {
      String[] tetherable=cm.getTetherableIfaces();
      String[] usbRegexs=cm.getTetherableUsbRegexs();
      for (      String t : tetherable) {
        for (        String r : usbRegexs) {
          if (t.matches(r)) {
            error=cm.tether(t);
            break;
          }
        }
      }
      showTetheringError(error);
    }
 else {
      for (      String t : tethered) {
        error=cm.untether(t);
      }
      showUnTetheringError(error);
    }
  }
  finish();
}
