{
  checkFocus();
synchronized (mH) {
    if ((mServedView != view && (mServedView == null || !mServedView.checkInputConnectionProxy(view))) || mCurrentTextBoxAttribute == null || mCurMethod == null) {
      return;
    }
    if (DEBUG)     Log.d(TAG,"updateCursor");
    final boolean usesScreenCoordinates=(mCursorRectMonitorMode & CursorAnchorInfoRequest.FLAG_CURSOR_RECT_IN_SCREEN_COORDINATES) != 0;
    if (usesScreenCoordinates) {
      view.getLocationOnScreen(mViewTopLeft);
      final Matrix viewMatrix=view.getMatrix();
      final boolean usesViewMatrix=(viewMatrix != null) && ((mCursorRectMonitorMode & CursorAnchorInfoRequest.FLAG_CURSOR_RECT_WITH_VIEW_MATRIX) != 0);
      if (usesViewMatrix) {
        mTempRectF.set(left,top,right,bottom);
        mViewToScreenMatrix.set(viewMatrix);
        mViewToScreenMatrix.postTranslate(mViewTopLeft[0],mViewTopLeft[1]);
        mViewToScreenMatrix.mapRect(mTempRectF);
        mNextCursorRect.set((int)mTempRectF.left,(int)mTempRectF.top,(int)mTempRectF.right,(int)mTempRectF.bottom);
      }
 else {
        mNextCursorRect.set(left + mViewTopLeft[0],top + mViewTopLeft[1],right + mViewTopLeft[0],bottom + mViewTopLeft[1]);
      }
    }
 else {
      mNextCursorRect.set(left,top,right,bottom);
    }
    if (!Objects.equals(mCursorRect,mNextCursorRect)) {
      if (DEBUG)       Log.v(TAG,"CURSOR CHANGE: " + mNextCursorRect);
      try {
        mCurMethod.updateCursor(mNextCursorRect);
        mCursorRect.set(mNextCursorRect);
      }
 catch (      RemoteException e) {
        Log.w(TAG,"IME died: " + mCurId,e);
      }
    }
  }
}
