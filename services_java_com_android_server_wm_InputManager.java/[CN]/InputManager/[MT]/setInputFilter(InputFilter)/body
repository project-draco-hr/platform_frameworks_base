{
synchronized (mInputFilterLock) {
    final InputFilter oldFilter=mInputFilter;
    if (oldFilter == filter) {
      return;
    }
    if (oldFilter != null) {
      mInputFilter=null;
      mInputFilterHost.disconnectLocked();
      mInputFilterHost=null;
      oldFilter.uninstall();
    }
    if (filter != null) {
      mInputFilter=filter;
      mInputFilterHost=new InputFilterHost();
      filter.install(mInputFilterHost);
    }
    nativeSetInputFilterEnabled(filter != null);
  }
}
