{
  final PowerManager pm=(PowerManager)mContext.getSystemService(Context.POWER_SERVICE);
  mScreenOffTime=pm.isScreenOn() ? -1 : SystemClock.elapsedRealtime();
  mWarnings=new PowerDialogWarnings(mContext);
  ContentObserver obs=new ContentObserver(mHandler){
    @Override public void onChange(    boolean selfChange){
      updateBatteryWarningLevels();
    }
  }
;
  final ContentResolver resolver=mContext.getContentResolver();
  resolver.registerContentObserver(Settings.Global.getUriFor(Settings.Global.LOW_POWER_MODE_TRIGGER_LEVEL),false,obs,UserHandle.USER_ALL);
  updateBatteryWarningLevels();
  IntentFilter filter=new IntentFilter();
  filter.addAction(Intent.ACTION_BATTERY_CHANGED);
  filter.addAction(Intent.ACTION_SCREEN_OFF);
  filter.addAction(Intent.ACTION_SCREEN_ON);
  mContext.registerReceiver(mIntentReceiver,filter,null,mHandler);
}
