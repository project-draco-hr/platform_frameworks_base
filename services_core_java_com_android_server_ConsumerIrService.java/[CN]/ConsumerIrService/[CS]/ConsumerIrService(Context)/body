{
  mContext=context;
  PowerManager pm=(PowerManager)context.getSystemService(Context.POWER_SERVICE);
  mWakeLock=pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK,TAG);
  mWakeLock.setReferenceCounted(true);
  mHal=halOpen();
  if (mContext.getPackageManager().hasSystemFeature(PackageManager.FEATURE_CONSUMER_IR)) {
    if (mHal == 0) {
      throw new RuntimeException("FEATURE_CONSUMER_IR present, but no IR HAL loaded!");
    }
  }
 else   if (mHal != 0) {
    throw new RuntimeException("IR HAL present, but FEATURE_CONSUMER_IR is not set!");
  }
}
