{
  String libname="main";
  ActivityInfo ai;
  getWindow().takeSurface(this);
  getWindow().takeInputQueue(this);
  getWindow().setFormat(PixelFormat.RGB_565);
  try {
    ai=getPackageManager().getActivityInfo(getIntent().getComponent(),PackageManager.GET_META_DATA);
    if (ai.metaData != null) {
      String ln=ai.metaData.getString(META_DATA_LIB_NAME);
      if (ln != null)       libname=ln;
    }
  }
 catch (  PackageManager.NameNotFoundException e) {
    throw new RuntimeException("Error getting activity info",e);
  }
  String path=null;
  if ((ai.applicationInfo.flags & ApplicationInfo.FLAG_HAS_CODE) == 0) {
    path=ai.applicationInfo.dataDir + "/lib/" + System.mapLibraryName(libname);
    if (!(new File(path)).exists()) {
      path=null;
    }
  }
  if (path == null) {
    path=((PathClassLoader)getClassLoader()).findLibrary(libname);
  }
  if (path == null) {
    throw new IllegalArgumentException("Unable to find native library: " + libname);
  }
  mNativeHandle=loadNativeCode(path,Looper.myQueue(),getFilesDir().toString(),Environment.getExternalStorageAppFilesDirectory(ai.packageName).toString(),Build.VERSION.SDK_INT);
  if (mNativeHandle == 0) {
    throw new IllegalArgumentException("Unable to load native library: " + path);
  }
  super.onCreate(savedInstanceState);
}
