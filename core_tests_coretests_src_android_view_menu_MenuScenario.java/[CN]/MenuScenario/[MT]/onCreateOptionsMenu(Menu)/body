{
  mMenu=menu;
  if (!mParams.shouldShowMenu)   return false;
  MenuItem item;
  for (int i=0; i < mParams.numItems; i++) {
    if ((item=onAddMenuItem(menu,i)) == null) {
      CharSequence givenTitle=mParams.itemTitles.get(i);
      item=menu.add(0,0,0,(givenTitle != null) ? givenTitle : ("Item " + i));
    }
    if (item != null) {
      mItems[i]=item;
      if (mParams.listenForClicks) {
        item.setOnMenuItemClickListener(this);
      }
    }
  }
  return true;
}
