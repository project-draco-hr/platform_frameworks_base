{
  Log.d(LOG_TAG,"[DSAC DEB] " + "onRestrictedStateChanged");
  RestrictedState newRs=new RestrictedState();
  Log.d(LOG_TAG,"[DSAC DEB] " + "current rs at enter " + rs);
  if (ar.exception == null) {
    int[] ints=(int[])ar.result;
    int state=ints[0];
    newRs.setCsEmergencyRestricted(((state & RILConstants.RIL_RESTRICTED_STATE_CS_EMERGENCY) != 0) || ((state & RILConstants.RIL_RESTRICTED_STATE_CS_ALL) != 0));
    if (phone.getIccCard().getState() == IccCard.State.READY) {
      newRs.setCsNormalRestricted(((state & RILConstants.RIL_RESTRICTED_STATE_CS_NORMAL) != 0) || ((state & RILConstants.RIL_RESTRICTED_STATE_CS_ALL) != 0));
      newRs.setPsRestricted((state & RILConstants.RIL_RESTRICTED_STATE_PS_ALL) != 0);
    }
    Log.d(LOG_TAG,"[DSAC DEB] " + "new rs " + newRs);
    if (!rs.isPsRestricted() && newRs.isPsRestricted()) {
      psRestrictEnabledRegistrants.notifyRegistrants();
      setNotification(PS_ENABLED);
    }
 else     if (rs.isPsRestricted() && !newRs.isPsRestricted()) {
      psRestrictDisabledRegistrants.notifyRegistrants();
      setNotification(PS_DISABLED);
    }
    if (rs.isCsRestricted()) {
      if (!newRs.isCsRestricted()) {
        setNotification(CS_DISABLED);
      }
 else       if (!newRs.isCsNormalRestricted()) {
        setNotification(CS_EMERGENCY_ENABLED);
      }
 else       if (!newRs.isCsEmergencyRestricted()) {
        setNotification(CS_NORMAL_ENABLED);
      }
    }
 else     if (rs.isCsEmergencyRestricted() && !rs.isCsNormalRestricted()) {
      if (!newRs.isCsRestricted()) {
        setNotification(CS_DISABLED);
      }
 else       if (newRs.isCsRestricted()) {
        setNotification(CS_ENABLED);
      }
 else       if (newRs.isCsNormalRestricted()) {
        setNotification(CS_NORMAL_ENABLED);
      }
    }
 else     if (!rs.isCsEmergencyRestricted() && rs.isCsNormalRestricted()) {
      if (!newRs.isCsRestricted()) {
        setNotification(CS_DISABLED);
      }
 else       if (newRs.isCsRestricted()) {
        setNotification(CS_ENABLED);
      }
 else       if (newRs.isCsEmergencyRestricted()) {
        setNotification(CS_EMERGENCY_ENABLED);
      }
    }
 else {
      if (newRs.isCsRestricted()) {
        setNotification(CS_ENABLED);
      }
 else       if (newRs.isCsEmergencyRestricted()) {
        setNotification(CS_EMERGENCY_ENABLED);
      }
 else       if (newRs.isCsNormalRestricted()) {
        setNotification(CS_NORMAL_ENABLED);
      }
    }
    rs=newRs;
  }
  Log.d(LOG_TAG,"[DSAC DEB] " + "current rs at return " + rs);
}
