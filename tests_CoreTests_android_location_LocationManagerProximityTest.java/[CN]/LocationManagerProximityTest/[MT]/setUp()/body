{
  super.setUp();
  if (Settings.Secure.getInt(getContext().getContentResolver(),Settings.Secure.ALLOW_MOCK_LOCATION,0) == 0) {
    fail("Mock locations are currently disabled in Settings - this test requires " + "mock locations");
  }
  mLocationManager=(LocationManager)getContext().getSystemService(Context.LOCATION_SERVICE);
  if (mLocationManager.getProvider(PROVIDER_NAME) != null) {
    mLocationManager.removeTestProvider(PROVIDER_NAME);
  }
  mLocationManager.addTestProvider(PROVIDER_NAME,true,false,true,false,false,false,false,Criteria.POWER_MEDIUM,Criteria.ACCURACY_FINE);
  mLocationManager.setTestProviderEnabled(PROVIDER_NAME,true);
}
