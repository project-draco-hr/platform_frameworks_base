{
  if (mIsFadingOut) {
    final long now=AnimationUtils.currentAnimationTimeMillis();
    final long duration=now - mFadingStart;
    if (duration > mFadeDuration) {
      if (fireActionPerformed) {
        fireOnGesturePerformed();
      }
      mIsFadingOut=false;
      mFadingHasStarted=false;
      mPath.rewind();
      mCurrentGesture=null;
      setPaintAlpha(255);
    }
 else {
      mFadingHasStarted=true;
      float interpolatedTime=Math.max(0.0f,Math.min(1.0f,duration / (float)mFadeDuration));
      mFadingAlpha=1.0f - mInterpolator.getInterpolation(interpolatedTime);
      setPaintAlpha((int)(255 * mFadingAlpha));
      postDelayed(this,FADE_ANIMATION_RATE);
    }
  }
 else {
    fireOnGesturePerformed();
    mFadingHasStarted=false;
    mPath.rewind();
    mCurrentGesture=null;
    setPaintAlpha(255);
  }
  invalidate();
}
