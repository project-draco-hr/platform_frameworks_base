{
synchronized (mToken) {
    if (ws != null && ws.size() == 0) {
      ws=null;
    }
    final boolean changed;
    if (ws == null) {
      changed=mWorkSource != null;
      mWorkSource=null;
    }
 else     if (mWorkSource == null) {
      changed=true;
      mWorkSource=new WorkSource(ws);
    }
 else {
      changed=mWorkSource.diff(ws);
      if (changed) {
        mWorkSource.set(ws);
      }
    }
    if (changed && mHeld) {
      try {
        mService.updateWakeLockWorkSource(mToken,mWorkSource,mHistoryTag);
      }
 catch (      RemoteException e) {
      }
    }
  }
}
