{
  if (!cm.isCompatibleRaster(raster)) {
    throw new IllegalArgumentException(Messages.getString("awt.4D"));
  }
  this.cm=cm;
  this.raster=raster;
  surfaceType=type;
  data=AwtImageBackdoorAccessor.getInstance().getData(raster.getDataBuffer());
  ColorSpace cs=cm.getColorSpace();
  transparency=cm.getTransparency();
  width=raster.getWidth();
  height=raster.getHeight();
  if (cs == LUTColorConverter.sRGB_CS) {
    csType=sRGB_CS;
  }
 else   if (cs == LUTColorConverter.LINEAR_RGB_CS) {
    csType=Linear_RGB_CS;
  }
 else   if (cs == LUTColorConverter.LINEAR_GRAY_CS) {
    csType=Linear_Gray_CS;
  }
 else {
    csType=Custom_CS;
    nativeDrawable=false;
  }
  if (type == BufferedImage.TYPE_CUSTOM) {
    nativeDrawable=false;
  }
}
