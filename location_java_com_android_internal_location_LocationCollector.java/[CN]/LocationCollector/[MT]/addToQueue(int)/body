{
  long now=SystemClock.elapsedRealtime();
  boolean includeLocation=false;
  if (mLastKnownLocation != null && (now - mLastKnownLocationTime <= MIN_VALID_LOCATION_TIME)) {
    includeLocation=true;
  }
  boolean includeWifi=false;
  if (trigger == GDebugProfile.TRIGGER_WIFI_CHANGE || (mWifiUploadedWithoutLocation && includeLocation && (now - mLastWifiScanElapsedTime < MIN_VALID_LOCATION_TIME))) {
    includeWifi=true;
    mWifiUploadedWithoutLocation=!includeLocation;
  }
  boolean includeCell=false;
  if (mCellState != null && (includeWifi || includeLocation)) {
    includeCell=true;
    if (!includeWifi && includeLocation) {
      if (mCellUploads.contains(mCellState,mLastKnownLocation)) {
        includeCell=false;
      }
    }
  }
  if (!includeLocation && !includeWifi) {
    log("NO UPLOAD: includeLocation=false, includeWifi=false");
    return;
  }
 else   if (!includeCell && trigger == GDebugProfile.TRIGGER_CELL_CHANGE) {
    log("NO UPLOAD: includeCell=false");
    return;
  }
 else {
    log("UPLOAD: includeLocation=" + includeLocation + ", includeWifi="+ includeWifi+ ", includeCell="+ includeCell);
  }
  if (includeLocation) {
    if (mLastUploadedLocation == null) {
      mLastUploadedLocation=new Location(mLastKnownLocation);
    }
 else {
      mLastUploadedLocation.set(mLastKnownLocation);
    }
    mLastUploadedLocationTime=now;
  }
  boolean immediate=false;
  if (trigger == GDebugProfile.TRIGGER_COLLECTION_END_BURST || trigger == GDebugProfile.TRIGGER_COLLECTION_END_BURST_AT_SAME_LOCATION) {
    immediate=true;
  }
  try {
    CellState cell=includeCell ? mCellState : null;
    List<ScanResult> wifi=includeWifi ? mWifiLastScanResults : null;
    Location loc=includeLocation ? mLastUploadedLocation : null;
    mMasfClient.queueCollectionReport(trigger,loc,cell,wifi,mLastWifiScanRealTime,immediate);
  }
 catch (  Exception e) {
    Log.e(TAG,"addToQueue got exception:",e);
  }
}
