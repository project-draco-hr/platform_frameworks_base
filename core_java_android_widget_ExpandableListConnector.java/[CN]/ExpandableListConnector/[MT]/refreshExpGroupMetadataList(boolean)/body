{
  final ArrayList<GroupMetadata> egml=mExpGroupMetadataList;
  final int egmlSize=egml.size();
  int curFlPos=0;
  mTotalExpChildrenCount=0;
  GroupMetadata curGm;
  int gChildrenCount;
  int lastGPos=0;
  for (int i=0; i < egmlSize; i++) {
    curGm=egml.get(i);
    if ((curGm.lastChildFlPos == GroupMetadata.REFRESH) || forceChildrenCountRefresh) {
      gChildrenCount=mExpandableListAdapter.getChildrenCount(curGm.gPos);
    }
 else {
      gChildrenCount=curGm.lastChildFlPos - curGm.flPos;
    }
    mTotalExpChildrenCount+=gChildrenCount;
    curFlPos+=(curGm.gPos - lastGPos);
    lastGPos=curGm.gPos;
    curGm.flPos=curFlPos;
    curFlPos+=gChildrenCount;
    curGm.lastChildFlPos=curFlPos;
  }
}
