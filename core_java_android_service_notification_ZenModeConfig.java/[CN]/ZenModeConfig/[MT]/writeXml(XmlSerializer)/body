{
  out.startTag(null,ZEN_TAG);
  out.attribute(null,ZEN_ATT_VERSION,Integer.toString(XML_VERSION));
  out.attribute(null,ZEN_ATT_USER,Integer.toString(user));
  out.startTag(null,ALLOW_TAG);
  out.attribute(null,ALLOW_ATT_CALLS,Boolean.toString(allowCalls));
  out.attribute(null,ALLOW_ATT_REPEAT_CALLERS,Boolean.toString(allowRepeatCallers));
  out.attribute(null,ALLOW_ATT_MESSAGES,Boolean.toString(allowMessages));
  out.attribute(null,ALLOW_ATT_REMINDERS,Boolean.toString(allowReminders));
  out.attribute(null,ALLOW_ATT_EVENTS,Boolean.toString(allowEvents));
  out.attribute(null,ALLOW_ATT_CALLS_FROM,Integer.toString(allowCallsFrom));
  out.attribute(null,ALLOW_ATT_MESSAGES_FROM,Integer.toString(allowMessagesFrom));
  out.attribute(null,ALLOW_ATT_PEEK,Boolean.toString(allowPeek));
  out.attribute(null,ALLOW_ATT_LIGHTS,Boolean.toString(allowLights));
  out.endTag(null,ALLOW_TAG);
  if (manualRule != null) {
    out.startTag(null,MANUAL_TAG);
    writeRuleXml(manualRule,out);
    out.endTag(null,MANUAL_TAG);
  }
  final int N=automaticRules.size();
  for (int i=0; i < N; i++) {
    final String id=automaticRules.keyAt(i);
    final ZenRule automaticRule=automaticRules.valueAt(i);
    out.startTag(null,AUTOMATIC_TAG);
    out.attribute(null,RULE_ATT_ID,id);
    writeRuleXml(automaticRule,out);
    out.endTag(null,AUTOMATIC_TAG);
  }
  out.endTag(null,ZEN_TAG);
}
