{
  int type=parser.getEventType();
  if (type != XmlPullParser.START_TAG)   return null;
  String tag=parser.getName();
  if (!ZEN_TAG.equals(tag))   return null;
  final ZenModeConfig rt=new ZenModeConfig();
  final int version=Integer.parseInt(parser.getAttributeValue(null,ZEN_ATT_VERSION));
  while ((type=parser.next()) != XmlPullParser.END_DOCUMENT) {
    tag=parser.getName();
    if (type == XmlPullParser.END_TAG && ZEN_TAG.equals(tag))     return rt;
    if (type == XmlPullParser.START_TAG) {
      if (ALLOW_TAG.equals(tag)) {
        rt.allowCalls=safeBoolean(parser,ALLOW_ATT_CALLS,false);
        rt.allowMessages=safeBoolean(parser,ALLOW_ATT_MESSAGES,false);
      }
 else       if (SLEEP_TAG.equals(tag)) {
        final String mode=parser.getAttributeValue(null,SLEEP_ATT_MODE);
        rt.sleepMode=(SLEEP_MODE_NIGHTS.equals(mode) || SLEEP_MODE_WEEKNIGHTS.equals(mode)) ? mode : null;
        final int startHour=safeInt(parser,SLEEP_ATT_START_HR,0);
        final int startMinute=safeInt(parser,SLEEP_ATT_START_MIN,0);
        final int endHour=safeInt(parser,SLEEP_ATT_END_HR,0);
        final int endMinute=safeInt(parser,SLEEP_ATT_END_MIN,0);
        rt.sleepStartHour=isValidHour(startHour) ? startHour : 0;
        rt.sleepStartMinute=isValidMinute(startMinute) ? startMinute : 0;
        rt.sleepEndHour=isValidHour(endHour) ? endHour : 0;
        rt.sleepEndMinute=isValidMinute(endMinute) ? endMinute : 0;
      }
    }
  }
  return rt;
}
