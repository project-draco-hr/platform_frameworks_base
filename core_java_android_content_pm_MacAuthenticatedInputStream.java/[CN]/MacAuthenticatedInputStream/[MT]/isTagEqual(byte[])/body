{
  final byte[] actualTag=mMac.doFinal();
  if (tag == null || actualTag == null || tag.length != actualTag.length) {
    return false;
  }
  int value=0;
  for (int i=0; i < tag.length; i++) {
    value|=tag[i] ^ actualTag[i];
  }
  return value == 0;
}
