{
synchronized (this) {
    final ActiveAdmin admin=getActiveAdminUncheckedLocked(adminReceiver,userHandle);
    if (admin == null) {
      return;
    }
    final DevicePolicyData policy=getUserData(userHandle);
    final boolean doProxyCleanup=admin.info.usesPolicy(DeviceAdminInfo.USES_POLICY_SETS_GLOBAL_PROXY);
    policy.mAdminList.remove(admin);
    policy.mAdminMap.remove(adminReceiver);
    validatePasswordOwnerLocked(policy);
    if (doProxyCleanup) {
      resetGlobalProxyLocked(policy);
    }
    saveSettingsLocked(userHandle);
    updateMaximumTimeToLockLocked(userHandle);
    policy.mRemovingAdmins.remove(adminReceiver);
  }
  pushUserRestrictions(userHandle);
}
