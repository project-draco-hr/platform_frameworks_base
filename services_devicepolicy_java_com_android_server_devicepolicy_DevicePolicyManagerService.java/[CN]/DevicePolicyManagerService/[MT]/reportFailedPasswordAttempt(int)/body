{
  enforceCrossUserPermission(userHandle);
  enforceNotManagedProfile(userHandle,"report failed password attempt");
  mContext.enforceCallingOrSelfPermission(android.Manifest.permission.BIND_DEVICE_ADMIN,null);
synchronized (this) {
    DevicePolicyData policy=getUserData(userHandle);
    long ident=Binder.clearCallingIdentity();
    try {
      policy.mFailedPasswordAttempts++;
      saveSettingsLocked(userHandle);
      if (mHasFeature) {
        ActiveAdmin strictestAdmin=getAdminWithMinimumFailedPasswordsForWipeLocked(userHandle);
        int max=strictestAdmin != null ? strictestAdmin.maximumFailedPasswordsForWipe : 0;
        if (max > 0 && policy.mFailedPasswordAttempts >= max) {
          wipeDeviceOrUserLocked(0,strictestAdmin.getUserHandle().getIdentifier());
        }
        sendAdminCommandToSelfAndProfilesLocked(DeviceAdminReceiver.ACTION_PASSWORD_FAILED,DeviceAdminInfo.USES_POLICY_WATCH_LOGIN,userHandle);
      }
    }
  finally {
      Binder.restoreCallingIdentity(ident);
    }
  }
}
