{
  if (!mHasFeature) {
  }
  enforceFullCrossUsersPermission(userHandle);
  ensureCallerPackage(callerPackage);
  final ApplicationInfo ai;
  try {
    ai=mContext.getPackageManager().getApplicationInfo(callerPackage,0);
  }
 catch (  NameNotFoundException e) {
    throw new SecurityException(e);
  }
  boolean legacyApp=false;
  if (ai.targetSdkVersion <= Build.VERSION_CODES.M) {
    legacyApp=true;
  }
 else   if ("com.google.android.apps.enterprise.dmagent".equals(ai.packageName) && ai.versionCode == 697) {
    legacyApp=true;
  }
  final int rawStatus=getEncryptionStatus();
  if ((rawStatus == DevicePolicyManager.ENCRYPTION_STATUS_ACTIVE_PER_USER) && legacyApp) {
    return DevicePolicyManager.ENCRYPTION_STATUS_ACTIVE;
  }
  return rawStatus;
}
