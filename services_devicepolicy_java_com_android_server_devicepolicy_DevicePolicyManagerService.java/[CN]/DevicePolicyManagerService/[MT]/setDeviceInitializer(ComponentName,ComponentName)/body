{
  if (!mHasFeature) {
    return false;
  }
  if (initializer == null || !DeviceOwner.isInstalled(initializer.getPackageName(),mContext.getPackageManager())) {
    throw new IllegalArgumentException("Invalid component name " + initializer + " for device initializer");
  }
  boolean isInitializerSystemApp;
  try {
    isInitializerSystemApp=isSystemApp(AppGlobals.getPackageManager(),initializer.getPackageName(),Binder.getCallingUserHandle().getIdentifier());
  }
 catch (  RemoteException|IllegalArgumentException e) {
    isInitializerSystemApp=false;
    Slog.e(LOG_TAG,"Fail to check if device initialzer is system app.",e);
  }
  if (!isInitializerSystemApp) {
    throw new IllegalArgumentException("Only system app can be set as device initializer.");
  }
synchronized (this) {
    enforceCanSetDeviceInitializer(who);
    if (mDeviceOwner.hasDeviceInitializer()) {
      throw new IllegalStateException("Trying to set device initializer but device initializer is already set.");
    }
    mDeviceOwner.setDeviceInitializer(initializer);
    addDeviceInitializerToLockTaskPackagesLocked(UserHandle.USER_OWNER);
    mDeviceOwner.writeDeviceOwner();
    return true;
  }
}
