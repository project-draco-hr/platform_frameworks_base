{
  mHandler.removeCallbacks(mRemoteBugreportTimeoutRunnable);
  mRemoteBugreportServiceIsActive.set(false);
  mInjector.getNotificationManager().cancel(LOG_TAG,RemoteBugreportUtils.REMOTE_BUGREPORT_IN_PROGRESS_NOTIFICATION_ID);
  Uri bugreportUri=intent.getData();
  String bugreportUriString=null;
  if (bugreportUri != null) {
    bugreportUriString=bugreportUri.toString();
  }
  String bugreportHash=intent.getStringExtra(RemoteBugreportUtils.EXTRA_REMOTE_BUGREPORT_HASH);
  if (mRemoteBugreportSharingAccepted.get()) {
    shareBugreportWithDeviceOwnerIfExists(bugreportUriString,bugreportHash);
  }
 else {
    setDeviceOwnerRemoteBugreportUriAndHash(bugreportUriString,bugreportHash);
  }
  mContext.unregisterReceiver(mRemoteBugreportFinishedReceiver);
}
