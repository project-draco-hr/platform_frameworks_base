{
  mHandler.removeCallbacks(mRemoteBugreportTimeoutRunnable);
  mRemoteBugreportServiceIsActive.set(false);
  Uri bugreportUri=intent.getData();
  String bugreportUriString=null;
  if (bugreportUri != null) {
    bugreportUriString=bugreportUri.toString();
  }
  String bugreportHash=intent.getStringExtra(RemoteBugreportUtils.EXTRA_REMOTE_BUGREPORT_HASH);
  if (mRemoteBugreportSharingAccepted.get()) {
    shareBugreportWithDeviceOwnerIfExists(bugreportUriString,bugreportHash);
    mInjector.getNotificationManager().cancel(LOG_TAG,RemoteBugreportUtils.NOTIFICATION_ID);
  }
 else {
    setDeviceOwnerRemoteBugreportUriAndHash(bugreportUriString,bugreportHash);
    mInjector.getNotificationManager().notify(LOG_TAG,RemoteBugreportUtils.NOTIFICATION_ID,RemoteBugreportUtils.buildNotification(mContext,RemoteBugreportUtils.NOTIFICATION_BUGREPORT_FINISHED_NOT_ACCEPTED));
  }
  mContext.unregisterReceiver(mRemoteBugreportFinishedReceiver);
}
