{
  PackageManager packageManager=mContext.getPackageManager();
  int granted=packageManager.checkPermission(permission,packageName);
  UserHandle user=Binder.getCallingUserHandle();
synchronized (this) {
    getActiveAdminForCallerLocked(admin,DeviceAdminInfo.USES_POLICY_PROFILE_OWNER);
    long ident=Binder.clearCallingIdentity();
    try {
      int permFlags=packageManager.getPermissionFlags(permission,packageName,user);
      if ((permFlags & PackageManager.FLAG_PERMISSION_POLICY_FIXED) != PackageManager.FLAG_PERMISSION_POLICY_FIXED) {
        return DevicePolicyManager.PERMISSION_GRANT_STATE_DEFAULT;
      }
 else {
        return granted == PackageManager.PERMISSION_GRANTED ? DevicePolicyManager.PERMISSION_GRANT_STATE_GRANTED : DevicePolicyManager.PERMISSION_GRANT_STATE_DENIED;
      }
    }
  finally {
      Binder.restoreCallingIdentity(ident);
    }
  }
}
