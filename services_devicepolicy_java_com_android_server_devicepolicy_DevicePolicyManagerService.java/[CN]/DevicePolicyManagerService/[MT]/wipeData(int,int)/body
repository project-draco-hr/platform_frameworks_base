{
  if (!mHasFeature) {
    return;
  }
  enforceCrossUserPermission(userHandle);
  if ((flags & DevicePolicyManager.WIPE_EXTERNAL_STORAGE) != 0) {
    enforceNotManagedProfile(userHandle,"wipe external storage");
  }
synchronized (this) {
    getActiveAdminForCallerLocked(null,DeviceAdminInfo.USES_POLICY_WIPE_DATA);
    long ident=Binder.clearCallingIdentity();
    try {
      wipeDeviceOrUserLocked(flags,userHandle);
    }
  finally {
      Binder.restoreCallingIdentity(ident);
    }
  }
}
