{
  if (!mHasFeature) {
    return;
  }
  enforceCrossUserPermission(userHandle);
  enforceNotManagedProfile(userHandle,"manage trust agent features");
synchronized (this) {
    if (admin == null) {
      throw new NullPointerException("admin is null");
    }
    if (agent == null) {
      throw new NullPointerException("agent is null");
    }
    ActiveAdmin ap=getActiveAdminForCallerLocked(admin,DeviceAdminInfo.USES_POLICY_DISABLE_KEYGUARD_FEATURES);
    ap.trustAgentFeatures.put(agent.flattenToString(),features);
    saveSettingsLocked(userHandle);
    syncDeviceCapabilitiesLocked(getUserData(userHandle));
  }
}
