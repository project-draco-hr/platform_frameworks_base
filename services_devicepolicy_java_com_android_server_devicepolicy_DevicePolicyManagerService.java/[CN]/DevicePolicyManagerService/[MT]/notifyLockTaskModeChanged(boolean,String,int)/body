{
  if (Binder.getCallingUid() != Process.SYSTEM_UID) {
    throw new SecurityException("notifyLockTaskModeChanged can only be called by system");
  }
synchronized (this) {
    final DevicePolicyData policy=getUserData(userHandle);
    Bundle adminExtras=new Bundle();
    adminExtras.putString(DeviceAdminReceiver.EXTRA_LOCK_TASK_PACKAGE,pkg);
    for (    ActiveAdmin admin : policy.mAdminList) {
      boolean ownsDevice=isDeviceOwner(admin.info.getPackageName());
      boolean ownsProfile=(getProfileOwner(userHandle) != null && getProfileOwner(userHandle).equals(admin.info.getPackageName()));
      if (ownsDevice || ownsProfile) {
        if (isEnabled) {
          sendAdminCommandLocked(admin,DeviceAdminReceiver.ACTION_LOCK_TASK_ENTERING,adminExtras,null);
        }
 else {
          sendAdminCommandLocked(admin,DeviceAdminReceiver.ACTION_LOCK_TASK_EXITING);
        }
      }
    }
  }
}
