{
  UserHandle user=Binder.getCallingUserHandle();
synchronized (this) {
    getActiveAdminForCallerLocked(admin,DeviceAdminInfo.USES_POLICY_DEVICE_OWNER);
    long ident=Binder.clearCallingIdentity();
    try {
      if (granted) {
        mContext.getPackageManager().grantPermission(packageName,permission,user);
      }
 else {
        mContext.getPackageManager().revokePermission(packageName,permission,user);
      }
      return true;
    }
 catch (    SecurityException se) {
      return false;
    }
 finally {
      Binder.restoreCallingIdentity(ident);
    }
  }
}
