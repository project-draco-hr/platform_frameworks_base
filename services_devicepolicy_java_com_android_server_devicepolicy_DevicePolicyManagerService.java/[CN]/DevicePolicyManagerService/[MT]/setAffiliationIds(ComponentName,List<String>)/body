{
  final Set<String> affiliationIds=new ArraySet<String>(ids);
  final int callingUserId=mInjector.userHandleGetCallingUserId();
synchronized (this) {
    getActiveAdminForCallerLocked(admin,DeviceAdminInfo.USES_POLICY_PROFILE_OWNER);
    getUserData(callingUserId).mAffiliationIds=affiliationIds;
    saveSettingsLocked(callingUserId);
    if (callingUserId != UserHandle.USER_SYSTEM && isDeviceOwner(admin,callingUserId)) {
      getUserData(UserHandle.USER_SYSTEM).mAffiliationIds=affiliationIds;
      saveSettingsLocked(UserHandle.USER_SYSTEM);
    }
  }
}
