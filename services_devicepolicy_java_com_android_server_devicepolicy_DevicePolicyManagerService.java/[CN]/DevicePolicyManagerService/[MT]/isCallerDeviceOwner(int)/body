{
synchronized (this) {
    if (!mOwners.hasDeviceOwner()) {
      return false;
    }
    if (UserHandle.getUserId(callerUid) != mOwners.getDeviceOwnerUserId()) {
      return false;
    }
    final String deviceOwnerPackageName=mOwners.getDeviceOwnerComponent().getPackageName();
    final String[] pkgs=mContext.getPackageManager().getPackagesForUid(callerUid);
    for (    String pkg : pkgs) {
      if (deviceOwnerPackageName.equals(pkg)) {
        return true;
      }
    }
  }
  return false;
}
