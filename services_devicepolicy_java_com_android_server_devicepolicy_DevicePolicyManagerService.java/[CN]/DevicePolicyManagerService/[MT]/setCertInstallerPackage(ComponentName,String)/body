{
  int userHandle=UserHandle.getCallingUserId();
synchronized (this) {
    getActiveAdminForCallerLocked(who,DeviceAdminInfo.USES_POLICY_PROFILE_OWNER);
    if (getTargetSdk(who.getPackageName(),userHandle) >= Build.VERSION_CODES.N) {
      if (installerPackage != null && !isPackageInstalledForUser(installerPackage,userHandle)) {
        throw new IllegalArgumentException("Package " + installerPackage + " is not installed on the current user");
      }
    }
    DevicePolicyData policy=getUserData(userHandle);
    policy.mDelegatedCertInstallerPackage=installerPackage;
    saveSettingsLocked(userHandle);
  }
}
