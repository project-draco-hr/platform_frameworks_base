{
  int uid=Binder.getCallingUid();
  String[] packageNames=mContext.getPackageManager().getPackagesForUid(uid);
synchronized (this) {
    for (int i=0; i < packageNames.length; i++) {
      String packageName=packageNames[i];
      int userHandle=UserHandle.getUserId(uid);
      if (isDeviceOwner(packageName)) {
        DevicePolicyData policy=getUserData(userHandle);
        policy.mLockTaskPackages.clear();
        if (packages != null) {
          for (int j=0; j < packages.length; j++) {
            String pkg=packages[j];
            policy.mLockTaskPackages.add(pkg);
          }
        }
        saveSettingsLocked(userHandle);
        return;
      }
    }
  }
  throw new SecurityException();
}
