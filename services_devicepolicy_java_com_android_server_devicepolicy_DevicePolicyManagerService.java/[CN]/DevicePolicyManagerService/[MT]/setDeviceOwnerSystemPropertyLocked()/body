{
  if (mInjector.settingsGlobalGetInt(Settings.Global.DEVICE_PROVISIONED,0) == 0) {
    return;
  }
  if ("encrypted".equals(mInjector.systemPropertiesGet("ro.crypto.state")) && "trigger_restart_min_framework".equals(mInjector.systemPropertiesGet("vold.decrypt"))) {
    return;
  }
  if (!TextUtils.isEmpty(mInjector.systemPropertiesGet(PROPERTY_DEVICE_OWNER_PRESENT))) {
    Slog.wtf(LOG_TAG,"Trying to set ro.device_owner, but it has already been set?");
  }
 else {
    if (mOwners.hasDeviceOwner()) {
      mInjector.systemPropertiesSet(PROPERTY_DEVICE_OWNER_PRESENT,"true");
      disableDeviceLoggingIfNotCompliant();
      if (SecurityLog.getLoggingEnabledProperty()) {
        mSecurityLogMonitor.start();
      }
    }
 else {
      mInjector.systemPropertiesSet(PROPERTY_DEVICE_OWNER_PRESENT,"false");
    }
  }
}
