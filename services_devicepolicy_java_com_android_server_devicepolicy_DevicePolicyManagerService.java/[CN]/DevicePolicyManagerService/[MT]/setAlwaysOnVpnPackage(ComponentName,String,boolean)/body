{
synchronized (this) {
    getActiveAdminForCallerLocked(admin,DeviceAdminInfo.USES_POLICY_PROFILE_OWNER);
  }
  final int userId=mInjector.userHandleGetCallingUserId();
  final long token=mInjector.binderClearCallingIdentity();
  try {
    if (vpnPackage != null && !isPackageInstalledForUser(vpnPackage,userId)) {
      return false;
    }
    ConnectivityManager connectivityManager=(ConnectivityManager)mContext.getSystemService(Context.CONNECTIVITY_SERVICE);
    if (!connectivityManager.setAlwaysOnVpnPackageForUser(userId,vpnPackage,lockdown)) {
      throw new UnsupportedOperationException();
    }
  }
  finally {
    mInjector.binderRestoreCallingIdentity(token);
  }
  return true;
}
