{
  if (!mHasFeature) {
    return false;
  }
  if (ActivityManager.checkComponentPermission(android.Manifest.permission.CREATE_USERS,Binder.getCallingUid(),-1,true) == PackageManager.PERMISSION_DENIED) {
    mContext.enforceCallingOrSelfPermission(android.Manifest.permission.MANAGE_USERS,null);
  }
  UserInfo info=mUserManager.getUserInfo(userHandle);
  if (info == null) {
    throw new IllegalArgumentException("Attempted to set profile owner for invalid userId: " + userHandle);
  }
  if (info.isGuest()) {
    throw new IllegalStateException("Cannot set a profile owner on a guest");
  }
  if (who == null || !DeviceOwner.isInstalledForUser(who.getPackageName(),userHandle)) {
    throw new IllegalArgumentException("Component " + who + " not installed for userId:"+ userHandle);
  }
synchronized (this) {
    if (UserHandle.getAppId(Binder.getCallingUid()) != Process.SYSTEM_UID && hasUserSetupCompleted(userHandle)) {
      throw new IllegalStateException("Trying to set profile owner but user is already set-up.");
    }
    if (mDeviceOwner == null) {
      mDeviceOwner=DeviceOwner.createWithProfileOwner(who,ownerName,userHandle);
      mDeviceOwner.writeOwnerFile();
      return true;
    }
 else {
      mDeviceOwner.setProfileOwner(who,ownerName,userHandle);
      mDeviceOwner.writeOwnerFile();
      return true;
    }
  }
}
