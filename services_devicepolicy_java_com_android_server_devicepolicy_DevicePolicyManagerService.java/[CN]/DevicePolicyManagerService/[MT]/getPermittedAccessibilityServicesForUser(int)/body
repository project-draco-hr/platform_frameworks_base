{
  if (!mHasFeature) {
    return null;
  }
synchronized (this) {
    List<String> result=null;
    List<UserInfo> profiles=mUserManager.getProfiles(userId);
    final int PROFILES_SIZE=profiles.size();
    for (int i=0; i < PROFILES_SIZE; ++i) {
      DevicePolicyData policy=getUserDataUnchecked(profiles.get(i).id);
      final int N=policy.mAdminList.size();
      for (int j=0; j < N; j++) {
        ActiveAdmin admin=policy.mAdminList.get(j);
        List<String> fromAdmin=admin.permittedAccessiblityServices;
        if (fromAdmin != null) {
          if (result == null) {
            result=new ArrayList<String>(fromAdmin);
          }
 else {
            result.retainAll(fromAdmin);
          }
        }
      }
    }
    if (result != null) {
      long id=binderClearCallingIdentity();
      try {
        UserInfo user=mUserManager.getUserInfo(userId);
        if (user.isManagedProfile()) {
          userId=user.profileGroupId;
        }
        AccessibilityManager accessibilityManager=getAccessibilityManagerForUser(userId);
        List<AccessibilityServiceInfo> installedServices=accessibilityManager.getInstalledAccessibilityServiceList();
        IPackageManager pm=getIPackageManager();
        if (installedServices != null) {
          for (          AccessibilityServiceInfo service : installedServices) {
            ServiceInfo serviceInfo=service.getResolveInfo().serviceInfo;
            ApplicationInfo applicationInfo=serviceInfo.applicationInfo;
            if ((applicationInfo.flags & ApplicationInfo.FLAG_SYSTEM) != 0) {
              result.add(serviceInfo.packageName);
            }
          }
        }
      }
  finally {
        binderRestoreCallingIdentity(id);
      }
    }
    return result;
  }
}
