{
  int uid=Binder.getCallingUid();
  String[] packageNames=mContext.getPackageManager().getPackagesForUid(uid);
  for (int i=0; i < packageNames.length; i++) {
    String packageName=packageNames[i];
    int userHandle=UserHandle.getUserId(uid);
    String profileOwnerPackage=getProfileOwner(userHandle);
    if (isDeviceOwner(packageName) || (profileOwnerPackage != null && profileOwnerPackage.equals(packageName))) {
      DevicePolicyData policy=getUserData(userHandle);
      policy.mLockTaskComponents.clear();
      if (components != null) {
        for (int j=0; j < components.length; j++) {
          ComponentName component=components[j];
          policy.mLockTaskComponents.add(component);
        }
      }
      saveSettingsLocked(userHandle);
      return;
    }
  }
  throw new SecurityException();
}
