{
  final int callingUserId=mInjector.userHandleGetCallingUserId();
synchronized (this) {
    if (mOwners.getDeviceOwnerUserId() == callingUserId) {
      return true;
    }
    final ComponentName profileOwner=getProfileOwner(callingUserId);
    if (profileOwner == null || !profileOwner.getPackageName().equals(mOwners.getDeviceOwnerPackageName())) {
      return false;
    }
    final Set<String> userAffiliationIds=getUserData(callingUserId).mAffiliationIds;
    final Set<String> deviceAffiliationIds=getUserData(UserHandle.USER_SYSTEM).mAffiliationIds;
    for (    String id : userAffiliationIds) {
      if (deviceAffiliationIds.contains(id)) {
        return true;
      }
    }
  }
  return false;
}
