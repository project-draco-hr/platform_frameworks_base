{
  if (mOwners.hasDeviceOwner()) {
    return false;
  }
  final int callingUserId=mInjector.userHandleGetCallingUserId();
  if (DevicePolicyManager.ACTION_PROVISION_MANAGED_PROFILE.equals(action)) {
    try {
      if (!mIPackageManager.hasSystemFeature(PackageManager.FEATURE_MANAGED_USERS)) {
        return false;
      }
    }
 catch (    RemoteException e) {
      return false;
    }
    final long ident=mInjector.binderClearCallingIdentity();
    try {
      if (!mUserManager.canAddMoreManagedProfiles(callingUserId,true)) {
        return false;
      }
    }
  finally {
      mInjector.binderRestoreCallingIdentity(ident);
    }
    return true;
  }
 else   if (DevicePolicyManager.ACTION_PROVISION_MANAGED_DEVICE.equals(action)) {
    if (getProfileOwner(callingUserId) != null) {
      return false;
    }
    if (mInjector.settingsGlobalGetInt(Settings.Global.DEVICE_PROVISIONED,0) != 0) {
      return false;
    }
    if (callingUserId != UserHandle.USER_SYSTEM) {
      return false;
    }
    return true;
  }
 else   if (DevicePolicyManager.ACTION_PROVISION_MANAGED_USER.equals(action)) {
    if (hasUserSetupCompleted(callingUserId)) {
      return false;
    }
    return true;
  }
  throw new IllegalArgumentException("Unknown provisioning action " + action);
}
