{
  final UserHandle userHandle=new UserHandle(UserHandle.getCallingUserId());
synchronized (this) {
    if (who == null) {
      throw new NullPointerException("ComponentName is null");
    }
    ActiveAdmin activeAdmin=getActiveAdminForCallerLocked(who,DeviceAdminInfo.USES_POLICY_PROFILE_OWNER);
    boolean isDeviceOwner=isDeviceOwner(activeAdmin.info.getPackageName());
    if (!isDeviceOwner && DEVICE_OWNER_USER_RESTRICTIONS.contains(key)) {
      throw new SecurityException("Profile owners cannot set user restriction " + key);
    }
    long id=Binder.clearCallingIdentity();
    try {
      AudioManager audioManager=(AudioManager)mContext.getSystemService(Context.AUDIO_SERVICE);
      boolean alreadyRestricted=mUserManager.hasUserRestriction(key);
      if (enabled && !alreadyRestricted) {
        if (UserManager.DISALLOW_CONFIG_WIFI.equals(key)) {
          Settings.Secure.putIntForUser(mContext.getContentResolver(),Settings.Secure.WIFI_NETWORKS_AVAILABLE_NOTIFICATION_ON,0,userHandle.getIdentifier());
        }
 else         if (UserManager.DISALLOW_USB_FILE_TRANSFER.equals(key)) {
          UsbManager manager=(UsbManager)mContext.getSystemService(Context.USB_SERVICE);
          manager.setCurrentFunction("none",false);
        }
 else         if (UserManager.DISALLOW_SHARE_LOCATION.equals(key)) {
          Settings.Secure.putIntForUser(mContext.getContentResolver(),Settings.Secure.LOCATION_MODE,Settings.Secure.LOCATION_MODE_OFF,userHandle.getIdentifier());
          Settings.Secure.putStringForUser(mContext.getContentResolver(),Settings.Secure.LOCATION_PROVIDERS_ALLOWED,"",userHandle.getIdentifier());
        }
 else         if (UserManager.DISALLOW_DEBUGGING_FEATURES.equals(key)) {
          Settings.Global.putStringForUser(mContext.getContentResolver(),Settings.Global.ADB_ENABLED,"0",userHandle.getIdentifier());
        }
 else         if (UserManager.ENSURE_VERIFY_APPS.equals(key)) {
          Settings.Global.putStringForUser(mContext.getContentResolver(),Settings.Global.PACKAGE_VERIFIER_ENABLE,"1",userHandle.getIdentifier());
          Settings.Global.putStringForUser(mContext.getContentResolver(),Settings.Global.PACKAGE_VERIFIER_INCLUDE_ADB,"1",userHandle.getIdentifier());
        }
 else         if (UserManager.DISALLOW_INSTALL_UNKNOWN_SOURCES.equals(key)) {
          Settings.Secure.putIntForUser(mContext.getContentResolver(),Settings.Secure.INSTALL_NON_MARKET_APPS,0,userHandle.getIdentifier());
        }
 else         if (UserManager.DISALLOW_UNMUTE_MICROPHONE.equals(key)) {
          audioManager.setMicrophoneMute(true);
        }
 else         if (UserManager.DISALLOW_ADJUST_VOLUME.equals(key)) {
          audioManager.setMasterMute(true);
        }
      }
      mUserManager.setUserRestriction(key,enabled,userHandle);
      if (!enabled && alreadyRestricted) {
        if (UserManager.DISALLOW_UNMUTE_MICROPHONE.equals(key)) {
          audioManager.setMicrophoneMute(false);
        }
 else         if (UserManager.DISALLOW_ADJUST_VOLUME.equals(key)) {
          audioManager.setMasterMute(false);
        }
      }
    }
  finally {
      restoreCallingIdentity(id);
    }
  }
}
