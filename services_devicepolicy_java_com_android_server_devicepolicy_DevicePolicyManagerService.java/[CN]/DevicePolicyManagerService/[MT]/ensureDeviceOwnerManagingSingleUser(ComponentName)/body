{
synchronized (this) {
    getActiveAdminForCallerLocked(who,DeviceAdminInfo.USES_POLICY_DEVICE_OWNER);
  }
  final long callingIdentity=mInjector.binderClearCallingIdentity();
  try {
    if (mInjector.userManagerIsSplitSystemUser()) {
      if (mUserManager.getUserCount() > 2 || mOwners.getDeviceOwnerUserId() == UserHandle.USER_SYSTEM) {
        throw new SecurityException("There should only be one user, managed by Device Owner");
      }
    }
 else     if (mUserManager.getUserCount() > 1) {
      throw new SecurityException("There should only be one user, managed by Device Owner");
    }
  }
  finally {
    mInjector.binderRestoreCallingIdentity(callingIdentity);
  }
}
