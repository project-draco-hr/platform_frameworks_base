{
  if (!mHasFeature) {
    return;
  }
  enforceCrossUserPermission(userHandle);
  if (!LockPatternUtils.isSeparateWorkChallengeEnabled()) {
    enforceNotManagedProfile(userHandle,"set the active password");
  }
  mContext.enforceCallingOrSelfPermission(android.Manifest.permission.BIND_DEVICE_ADMIN,null);
  validateQualityConstant(quality);
  DevicePolicyData policy=getUserData(userHandle);
  long ident=mInjector.binderClearCallingIdentity();
  try {
synchronized (this) {
      policy.mActivePasswordQuality=quality;
      policy.mActivePasswordLength=length;
      policy.mActivePasswordLetters=letters;
      policy.mActivePasswordLowerCase=lowercase;
      policy.mActivePasswordUpperCase=uppercase;
      policy.mActivePasswordNumeric=numbers;
      policy.mActivePasswordSymbols=symbols;
      policy.mActivePasswordNonLetter=nonletter;
      policy.mFailedPasswordAttempts=0;
      saveSettingsLocked(userHandle);
      updatePasswordExpirationsLocked(userHandle);
      setExpirationAlarmCheckLocked(mContext,policy);
      if (LockPatternUtils.isSeparateWorkChallengeEnabled()) {
        sendAdminCommandLocked(DeviceAdminReceiver.ACTION_PASSWORD_CHANGED,DeviceAdminInfo.USES_POLICY_LIMIT_PASSWORD,userHandle);
      }
 else {
        sendAdminCommandToSelfAndProfilesLocked(DeviceAdminReceiver.ACTION_PASSWORD_CHANGED,DeviceAdminInfo.USES_POLICY_LIMIT_PASSWORD,userHandle);
      }
    }
  }
  finally {
    mInjector.binderRestoreCallingIdentity(ident);
  }
}
