{
  int inID=0;
  int outID=0;
  if (b.mIn != null) {
    inID=b.mIn.mID;
  }
  if (b.mOut != null) {
    outID=b.mOut.mID;
  }
  rs.nProgramFragmentBegin(inID,outID,b.mPointSpriteEnable);
  for (int ct=0; ct < MAX_SLOT; ct++) {
    if (b.mSlots[ct].mTexEnable) {
      Slot s=b.mSlots[ct];
      int typeID=0;
      if (s.mType != null) {
        typeID=s.mType.mID;
      }
      rs.nProgramFragmentSetSlot(ct,true,s.mEnv.mID,typeID);
    }
  }
  int id=rs.nProgramFragmentCreate();
  return new ProgramFragment(id,rs);
}
