{
  int inID=0;
  int outID=0;
  if (b.mIn != null) {
    inID=b.mIn.mID;
  }
  if (b.mOut != null) {
    outID=b.mOut.mID;
  }
  rs.nProgramFragmentBegin(inID,outID);
  for (int ct=0; ct < MAX_SLOT; ct++) {
    if (b.mSlots[ct].mTexEnable) {
      Slot s=b.mSlots[ct];
      if (s.mType != null) {
        rs.nProgramFragmentSetType(ct,s.mType.mID);
      }
      rs.nProgramFragmentSetTexEnable(ct,true);
      if (s.mEnv != null) {
        rs.nProgramFragmentSetEnvMode(ct,s.mEnv.mID);
      }
    }
  }
  int id=rs.nProgramFragmentCreate();
  return new ProgramFragment(id,rs);
}
