{
  Arrays.sort(rules);
  StringBuilder pattern=new StringBuilder("(");
  for (int i=0; i < rules.length; ++i) {
    if (i > 0)     pattern.append(")|(");
    pattern.append(RULE_PATTERN.matcher(rules[i].mPrefix).replaceAll("\\\\$0"));
  }
  mPattern=Pattern.compile(pattern.append(")").toString());
  mRules=rules;
}
