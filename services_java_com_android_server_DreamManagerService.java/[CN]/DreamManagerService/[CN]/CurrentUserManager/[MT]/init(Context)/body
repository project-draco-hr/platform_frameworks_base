{
  IntentFilter filter=new IntentFilter();
  filter.addAction(Intent.ACTION_USER_SWITCHED);
  context.registerReceiver(new BroadcastReceiver(){
    @Override public void onReceive(    Context context,    Intent intent){
      String action=intent.getAction();
      if (Intent.ACTION_USER_SWITCHED.equals(action)) {
synchronized (mLock) {
          mCurrentUserId=intent.getIntExtra(Intent.EXTRA_USER_HANDLE,0);
          if (DEBUG)           Slog.v(TAG,"userId " + mCurrentUserId + " is in the house");
        }
      }
    }
  }
,filter);
  try {
synchronized (mLock) {
      mCurrentUserId=ActivityManagerNative.getDefault().getCurrentUser().id;
    }
  }
 catch (  RemoteException e) {
    Slog.w(TAG,"Couldn't get current user ID; guessing it's 0",e);
  }
}
