{
  int ref=++sConcatenatedRef & 0xff;
  for (int i=0, count=parts.size(); i < count; i++) {
    byte[] data=new byte[5];
    data[0]=(byte)SmsHeader.CONCATENATED_8_BIT_REFERENCE;
    data[1]=(byte)3;
    data[2]=(byte)ref;
    data[3]=(byte)count;
    data[4]=(byte)(i + 1);
    PendingIntent sentIntent=null;
    PendingIntent deliveryIntent=null;
    if (sentIntents != null && sentIntents.size() > i) {
      sentIntent=sentIntents.get(i);
    }
    if (deliveryIntents != null && deliveryIntents.size() > i) {
      deliveryIntent=deliveryIntents.get(i);
    }
    SmsMessage.SubmitPdu pdus=SmsMessage.getSubmitPdu(scAddress,destinationAddress,parts.get(i),deliveryIntent != null,data);
    sendRawPdu(pdus.encodedScAddress,pdus.encodedMessage,sentIntent,deliveryIntent);
  }
}
