{
  if (smsb == null) {
    return;
  }
  SmsMessage sms=(SmsMessage)smsb;
  sms.parseSms();
  int teleService=sms.getTeleService();
  boolean handled=false;
  if (sms.getUserData() == null) {
    if (Config.LOGD) {
      Log.d(TAG,"Received SMS without user data");
    }
    handled=true;
  }
  if (handled)   return;
  if (SmsEnvelope.TELESERVICE_WAP == teleService) {
    processCdmaWapPdu(sms.getUserData(),sms.messageRef,sms.getOriginatingAddress());
    return;
  }
 else   if (SmsEnvelope.TELESERVICE_VMN == teleService) {
    int voicemailCount=sms.getNumOfVoicemails();
    Log.d(TAG,"Voicemail count=" + voicemailCount);
    SharedPreferences sp=PreferenceManager.getDefaultSharedPreferences(((CDMAPhone)mPhone).getContext());
    SharedPreferences.Editor editor=sp.edit();
    editor.putInt(CDMAPhone.VM_COUNT_CDMA,voicemailCount);
    editor.commit();
    ((CDMAPhone)mPhone).updateMessageWaitingIndicator(voicemailCount);
    return;
  }
  SmsHeader smsHeader=sms.getUserDataHeader();
  if ((smsHeader == null) || (smsHeader.concatRef == null)) {
    byte[][] pdus=new byte[1][];
    pdus[0]=sms.getPdu();
    if (smsHeader != null && smsHeader.portAddrs != null) {
      if (smsHeader.portAddrs.destPort == SmsHeader.PORT_WAP_PUSH) {
        mWapPush.dispatchWapPdu(sms.getUserData());
      }
      dispatchPortAddressedPdus(pdus,smsHeader.portAddrs.destPort);
    }
 else {
      dispatchPdus(pdus);
    }
  }
 else {
    processMessagePart(sms,smsHeader.concatRef,smsHeader.portAddrs);
  }
}
