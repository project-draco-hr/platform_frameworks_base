{
  if (smsb == null) {
    return;
  }
  SmsMessage sms=(SmsMessage)smsb;
  sms.parseSms();
  int teleService=sms.getTeleService();
  boolean handled=false;
  if ((teleService == SmsEnvelope.TELESERVICE_WMT) || (teleService == SmsEnvelope.TELESERVICE_WEMT) || (teleService == SmsEnvelope.TELESERVICE_VMN)) {
    if (sms.isMWISetMessage()) {
      mCdmaPhone.updateMessageWaitingIndicator(true);
      handled|=sms.isMwiDontStore();
      if (Config.LOGD) {
        Log.d(TAG,"Received voice mail indicator set SMS shouldStore=" + !handled);
      }
    }
 else     if (sms.isMWIClearMessage()) {
      mCdmaPhone.updateMessageWaitingIndicator(false);
      handled|=sms.isMwiDontStore();
      if (Config.LOGD) {
        Log.d(TAG,"Received voice mail indicator clear SMS shouldStore=" + !handled);
      }
    }
  }
  if (sms.getUserData() == null) {
    if (Config.LOGD) {
      Log.d(TAG,"Received SMS without user data");
    }
    handled=true;
  }
  if (handled)   return;
  if (SmsEnvelope.TELESERVICE_WAP == teleService) {
    processCdmaWapPdu(sms.getUserData(),sms.messageRef,sms.getOriginatingAddress());
    return;
  }
  SmsHeader smsHeader=sms.getUserDataHeader();
  if ((smsHeader == null) || (smsHeader.concatRef == null)) {
    byte[][] pdus=new byte[1][];
    pdus[0]=sms.getPdu();
    if (smsHeader != null && smsHeader.portAddrs != null) {
      if (smsHeader.portAddrs.destPort == SmsHeader.PORT_WAP_PUSH) {
        mWapPush.dispatchWapPdu(sms.getUserData());
      }
      dispatchPortAddressedPdus(pdus,smsHeader.portAddrs.destPort);
    }
 else {
      dispatchPdus(pdus);
    }
  }
 else {
    processMessagePart(sms,smsHeader.concatRef,smsHeader.portAddrs);
  }
}
