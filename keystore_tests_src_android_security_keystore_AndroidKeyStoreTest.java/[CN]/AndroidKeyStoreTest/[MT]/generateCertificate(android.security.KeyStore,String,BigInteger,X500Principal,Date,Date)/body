{
  final String privateKeyAlias=Credentials.USER_PRIVATE_KEY + alias;
  KeyPair keyPair=AndroidKeyStoreProvider.loadAndroidKeyStoreKeyPairFromKeystore(keyStore,privateKeyAlias,KeyStore.UID_SELF);
  final X509V3CertificateGenerator certGen=new X509V3CertificateGenerator();
  certGen.setPublicKey(keyPair.getPublic());
  certGen.setSerialNumber(serialNumber);
  certGen.setSubjectDN(subjectDN);
  certGen.setIssuerDN(subjectDN);
  certGen.setNotBefore(notBefore);
  certGen.setNotAfter(notAfter);
  certGen.setSignatureAlgorithm("sha1WithRSA");
  final X509Certificate cert=certGen.generate(keyPair.getPrivate());
  return cert;
}
