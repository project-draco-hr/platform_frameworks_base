{
  final String directory=mFile.getName();
  final Activity activity=getActivity();
  final OnClickListener listener=new OnClickListener(){
    @Override public void onClick(    DialogInterface dialog,    int which){
      Intent intent=null;
      if (which == DialogInterface.BUTTON_POSITIVE) {
        intent=createGrantedUriPermissionsIntent(mActivity,mActivity.getExternalStorageClient(),mFile);
      }
      if (which == DialogInterface.BUTTON_NEGATIVE || intent == null) {
        logValidScopedAccessRequest(activity,directory,SCOPED_DIRECTORY_ACCESS_DENIED);
        activity.setResult(RESULT_CANCELED);
      }
 else {
        logValidScopedAccessRequest(activity,directory,SCOPED_DIRECTORY_ACCESS_GRANTED);
        activity.setResult(RESULT_OK,intent);
      }
      activity.finish();
    }
  }
;
  final CharSequence message=TextUtils.expandTemplate(getText(R.string.open_external_dialog_request),mAppLabel,directory,mVolumeLabel);
  return new AlertDialog.Builder(activity,R.style.AlertDialogTheme).setMessage(message).setPositiveButton(R.string.allow,listener).setNegativeButton(R.string.deny,listener).create();
}
