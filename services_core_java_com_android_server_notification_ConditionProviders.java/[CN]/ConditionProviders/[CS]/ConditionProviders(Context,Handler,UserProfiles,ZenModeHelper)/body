{
  super(context,handler,new Object(),userProfiles);
  mZenModeHelper=zenModeHelper;
  mZenModeHelper.addCallback(new ZenModeHelperCallback());
  mSystemConditionProviders=safeSet(PropConfig.getStringArray(mContext,"system.condition.providers",R.array.config_system_condition_providers));
  final boolean countdown=mSystemConditionProviders.contains(ZenModeConfig.COUNTDOWN_PATH);
  final boolean downtime=mSystemConditionProviders.contains(ZenModeConfig.DOWNTIME_PATH);
  final boolean nextAlarm=mSystemConditionProviders.contains(ZenModeConfig.NEXT_ALARM_PATH);
  mNextAlarmTracker=(downtime || nextAlarm) ? new NextAlarmTracker(mContext) : null;
  mCountdown=countdown ? new CountdownConditionProvider() : null;
  mDowntime=downtime ? new DowntimeConditionProvider(this,mNextAlarmTracker,mZenModeHelper) : null;
  mNextAlarm=nextAlarm ? new NextAlarmConditionProvider(mNextAlarmTracker) : null;
  loadZenConfig();
}
