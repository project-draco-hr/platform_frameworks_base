{
  ZenModeConfig config=mZenModeHelper.getConfig();
  if (config == null)   return;
  config=config.copy();
  final ArrayList<ConditionRecord> automatic=new ArrayList<ConditionRecord>();
  final int automaticN=mRecords.size();
  for (int i=0; i < automaticN; i++) {
    final ConditionRecord r=mRecords.get(i);
    if (r.isAutomatic) {
      automatic.add(r);
    }
  }
  if (automatic.isEmpty()) {
    config.conditionComponents=null;
    config.conditionIds=null;
  }
 else {
    final int N=automatic.size();
    config.conditionComponents=new ComponentName[N];
    config.conditionIds=new Uri[N];
    for (int i=0; i < N; i++) {
      final ConditionRecord r=automatic.get(i);
      config.conditionComponents[i]=r.component;
      config.conditionIds[i]=r.id;
    }
  }
  config.exitConditionId=mExitConditionId;
  config.exitConditionComponent=mExitConditionComponent;
  if (DEBUG)   Slog.d(TAG,"Setting zen config to: " + config);
  mZenModeHelper.setConfig(config);
}
