{
  final ZenModeConfig config=mZenModeHelper.getConfig();
  if (config == null) {
    if (DEBUG)     Slog.d(TAG,"loadZenConfig: no config");
    return;
  }
synchronized (mMutex) {
    final boolean changingExit=!Objects.equals(mExitCondition,config.exitCondition);
    mExitCondition=config.exitCondition;
    mExitConditionComponent=config.exitConditionComponent;
    if (changingExit) {
      ZenLog.traceExitCondition(mExitCondition,mExitConditionComponent,"config");
    }
    if (mDowntime != null) {
      mDowntime.setConfig(config);
    }
    if (config.conditionComponents == null || config.conditionIds == null || config.conditionComponents.length != config.conditionIds.length) {
      if (DEBUG)       Slog.d(TAG,"loadZenConfig: no conditions");
      setAutomaticZenModeConditions(null,false);
      return;
    }
    final ArraySet<Uri> newIds=new ArraySet<Uri>();
    final int N=config.conditionComponents.length;
    for (int i=0; i < N; i++) {
      final ComponentName component=config.conditionComponents[i];
      final Uri id=config.conditionIds[i];
      if (component != null && id != null) {
        getRecordLocked(id,component);
        newIds.add(id);
      }
    }
    if (DEBUG)     Slog.d(TAG,"loadZenConfig: N=" + N);
    setAutomaticZenModeConditions(newIds.toArray(new Uri[newIds.size()]),false);
  }
}
