{
  if (DEBUG)   Slog.d(TAG,"setZenModeCondition " + conditionId);
synchronized (mMutex) {
    ComponentName conditionComponent=null;
    if (ZenModeConfig.isValidCountdownConditionId(conditionId)) {
      final ConditionRecord r=getRecordLocked(conditionId,CountdownConditionProvider.COMPONENT);
      if (r.info == null) {
        r.info=checkServiceTokenLocked(mCountdown.asInterface());
      }
    }
    final int N=mRecords.size();
    for (int i=0; i < N; i++) {
      final ConditionRecord r=mRecords.get(i);
      final boolean idEqual=r.id.equals(conditionId);
      if (r.isManual && !idEqual) {
        unsubscribeLocked(r);
        r.isManual=false;
      }
 else       if (idEqual && !r.isManual) {
        subscribeLocked(r);
        r.isManual=true;
      }
      if (idEqual) {
        conditionComponent=r.component;
      }
    }
    if (!Objects.equals(mExitConditionId,conditionId)) {
      mExitConditionId=conditionId;
      mExitConditionComponent=conditionComponent;
      saveZenConfigLocked();
    }
  }
}
