{
  if (mChunkedStreamer == null) {
    throw new IllegalStateException("Not initialized");
  }
  byte[] result;
  try {
    result=mChunkedStreamer.doFinal(null,0,0);
  }
 catch (  KeymasterException e) {
    throw KeymasterUtils.getCryptoOperationException(e);
  }
  engineReset();
  return result;
}
