{
  super(context,attrs,defStyle);
  final Resources res=context.getResources();
  TypedArray levels=res.obtainTypedArray(R.array.batterymeter_color_levels);
  TypedArray colors=res.obtainTypedArray(R.array.batterymeter_color_values);
  final int N=levels.length();
  mColors=new int[2 * N];
  for (int i=0; i < N; i++) {
    mColors[2 * i]=levels.getInt(i,0);
    mColors[2 * i + 1]=colors.getColor(i,0);
  }
  levels.recycle();
  colors.recycle();
  mShowPercent=ENABLE_PERCENT && 0 != Settings.System.getInt(context.getContentResolver(),"status_bar_show_battery_percent",0);
  mWarningString=context.getString(R.string.battery_meter_very_low_overlay_symbol);
  mFramePaint=new Paint(Paint.ANTI_ALIAS_FLAG);
  mFramePaint.setColor(res.getColor(R.color.batterymeter_frame_color));
  mFramePaint.setDither(true);
  mFramePaint.setStrokeWidth(0);
  mFramePaint.setStyle(Paint.Style.FILL_AND_STROKE);
  mFramePaint.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.DST_ATOP));
  mBatteryPaint=new Paint(Paint.ANTI_ALIAS_FLAG);
  mBatteryPaint.setDither(true);
  mBatteryPaint.setStrokeWidth(0);
  mBatteryPaint.setStyle(Paint.Style.FILL_AND_STROKE);
  mTextPaint=new Paint(Paint.ANTI_ALIAS_FLAG);
  mTextPaint.setColor(0xFFFFFFFF);
  Typeface font=Typeface.create("sans-serif-condensed",Typeface.NORMAL);
  mTextPaint.setTypeface(font);
  mTextPaint.setTextAlign(Paint.Align.CENTER);
  mWarningTextPaint=new Paint(Paint.ANTI_ALIAS_FLAG);
  mWarningTextPaint.setColor(mColors[1]);
  font=Typeface.create("sans-serif",Typeface.BOLD);
  mWarningTextPaint.setTypeface(font);
  mWarningTextPaint.setTextAlign(Paint.Align.CENTER);
  mChargeColor=getResources().getColor(R.color.batterymeter_charge_color);
  mBoltPaint=new Paint();
  mBoltPaint.setAntiAlias(true);
  mBoltPaint.setColor(res.getColor(R.color.batterymeter_bolt_color));
  mBoltPoints=loadBoltPoints(res);
  setLayerType(View.LAYER_TYPE_SOFTWARE,null);
}
