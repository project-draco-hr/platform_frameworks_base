{
  if (!isCurrentUserOrProfile(UserHandle.getCallingUserId())) {
    Slog.w(TAG,"Can't authenticate non-current user");
    return;
  }
  if (!canUseFingerprint(opPackageName)) {
    Slog.w(TAG,"Calling not granted permission to use fingerprint");
    return;
  }
  final boolean restricted=isRestricted();
  mHandler.post(new Runnable(){
    @Override public void run(){
      mIsKeyguard=KEYGUARD_PACKAGE.equals(opPackageName);
      startAuthentication(token,opId,groupId,receiver,flags,restricted);
    }
  }
);
}
