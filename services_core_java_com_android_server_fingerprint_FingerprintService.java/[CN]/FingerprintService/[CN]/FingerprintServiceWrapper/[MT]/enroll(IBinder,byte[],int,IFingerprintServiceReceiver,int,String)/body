{
  checkPermission(MANAGE_FINGERPRINT);
  final int limit=mContext.getResources().getInteger(com.android.internal.R.integer.config_fingerprintMaxTemplatesPerUser);
  final int callingUserId=UserHandle.getCallingUserId();
  final int enrolled=FingerprintService.this.getEnrolledFingerprints(callingUserId).size();
  if (enrolled >= limit) {
    Slog.w(TAG,"Too many fingerprints registered");
    return;
  }
  if (!isCurrentUserOrProfile(groupId)) {
    return;
  }
  final boolean restricted=isRestricted();
  mHandler.post(new Runnable(){
    @Override public void run(){
      startEnrollment(token,cryptoToken,callingUserId,groupId,receiver,flags,restricted,opPackageName);
    }
  }
);
}
