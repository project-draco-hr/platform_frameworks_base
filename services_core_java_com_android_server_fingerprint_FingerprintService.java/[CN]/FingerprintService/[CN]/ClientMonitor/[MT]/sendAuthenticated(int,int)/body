{
  boolean result=false;
  boolean authenticated=fpId != 0;
  if (receiver != null) {
    try {
      MetricsLogger.action(mContext,MetricsEvent.ACTION_FINGERPRINT_AUTH,authenticated);
      if (!authenticated) {
        receiver.onAuthenticationFailed(mHalDeviceId);
      }
 else {
        if (DEBUG) {
          Slog.v(TAG,"onAuthenticated(owner=" + mAuthClient.owner + ", id="+ fpId+ ", gp="+ groupId+ ")");
        }
        Fingerprint fp=!restricted ? new Fingerprint("",groupId,fpId,mHalDeviceId) : null;
        receiver.onAuthenticationSucceeded(mHalDeviceId,fp);
      }
    }
 catch (    RemoteException e) {
      Slog.w(TAG,"Failed to notify Authenticated:",e);
      result=true;
    }
  }
 else {
    result=true;
  }
  if (fpId == 0) {
    if (receiver != null) {
      FingerprintUtils.vibrateFingerprintError(getContext());
    }
    result|=handleFailedAttempt(this);
  }
 else {
    if (receiver != null) {
      FingerprintUtils.vibrateFingerprintSuccess(getContext());
    }
    result|=true;
    resetFailedAttempts();
  }
  return result;
}
