{
  long startTime=SystemClock.uptimeMillis();
  while (true) {
    NetworkInfo ni=mCm.getActiveNetworkInfo();
    String niString=ni == null ? "null" : ni.toString();
    if (ni != null && ni.isConnected()) {
      return true;
    }
    if ((SystemClock.uptimeMillis() - startTime) > timeout) {
      log("waitForActiveNetworkConnection timeout: " + niString);
      return false;
    }
    log("waitForActiveNetworkConnection interim: " + niString);
    SystemClock.sleep(SHORT_TIMEOUT);
  }
}
