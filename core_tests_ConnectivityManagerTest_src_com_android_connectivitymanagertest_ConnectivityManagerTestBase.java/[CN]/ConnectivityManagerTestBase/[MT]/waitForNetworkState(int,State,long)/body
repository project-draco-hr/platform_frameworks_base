{
  long startTime=System.currentTimeMillis();
  while (true) {
    if ((System.currentTimeMillis() - startTime) > timeout) {
      log("waitForNetworkState time out, the state of network type " + networkType + " is: "+ mCM.getNetworkInfo(networkType).getState());
      if (mCM.getNetworkInfo(networkType).getState() != expectedState) {
        return false;
      }
 else {
        log("networktype: " + networkType + " state: "+ mCM.getNetworkInfo(networkType));
        return true;
      }
    }
    log("Wait for the connectivity state for network: " + networkType + " to be "+ expectedState.toString());
synchronized (connectivityObject) {
      try {
        connectivityObject.wait(SHORT_TIMEOUT);
      }
 catch (      InterruptedException e) {
        e.printStackTrace();
      }
      if ((mNetworkInfo.getType() != networkType) || (mNetworkInfo.getState() != expectedState)) {
        log("network state for " + mNetworkInfo.getType() + "is: "+ mNetworkInfo.getState());
        continue;
      }
      return true;
    }
  }
}
