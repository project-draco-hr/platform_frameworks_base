{
  this.nativeHandle=nativeOpenJarFile(fileName);
  this.raf=new RandomAccessFile(fileName,"r");
  try {
    HashMap<String,byte[]> metaEntries=getMetaEntries();
    this.manifest=new StrictJarManifest(metaEntries.get(JarFile.MANIFEST_NAME),true);
    this.verifier=new StrictJarVerifier(fileName,manifest,metaEntries);
    Set<String> files=manifest.getEntries().keySet();
    for (    String file : files) {
      if (findEntry(file) == null) {
        throw new SecurityException(fileName + ": File " + file+ " in manifest does not exist");
      }
    }
    isSigned=verifier.readCertificates() && verifier.isSignedJar();
  }
 catch (  IOException|SecurityException e) {
    nativeClose(this.nativeHandle);
    IoUtils.closeQuietly(this.raf);
    throw e;
  }
  guard.open("close");
}
