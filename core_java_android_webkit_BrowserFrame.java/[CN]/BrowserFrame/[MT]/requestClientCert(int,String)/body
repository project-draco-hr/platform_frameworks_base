{
  SslClientCertLookupTable table=SslClientCertLookupTable.getInstance();
  if (table.IsAllowed(hostAndPort)) {
    PrivateKey pkey=table.PrivateKey(hostAndPort);
    if (pkey instanceof OpenSSLKeyHolder) {
      OpenSSLKey sslKey=((OpenSSLKeyHolder)pkey).getOpenSSLKey();
      nativeSslClientCert(handle,sslKey.getPkeyContext(),table.CertificateChain(hostAndPort));
    }
 else {
      nativeSslClientCert(handle,pkey.getEncoded(),table.CertificateChain(hostAndPort));
    }
  }
 else   if (table.IsDenied(hostAndPort)) {
    nativeSslClientCert(handle,0,null);
  }
 else {
    mCallbackProxy.onReceivedClientCertRequest(new ClientCertRequestHandler(this,handle,hostAndPort,table),hostAndPort);
  }
}
