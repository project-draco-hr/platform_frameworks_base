{
  SslClientCertLookupTable table=SslClientCertLookupTable.getInstance();
  if (table.IsAllowed(hostAndPort)) {
    PrivateKey pkey=table.PrivateKey(hostAndPort);
    if (pkey instanceof OpenSSLRSAPrivateKey) {
      nativeSslClientCert(handle,((OpenSSLRSAPrivateKey)pkey).getPkeyContext(),table.CertificateChain(hostAndPort));
    }
 else     if (pkey instanceof OpenSSLDSAPrivateKey) {
      nativeSslClientCert(handle,((OpenSSLDSAPrivateKey)pkey).getPkeyContext(),table.CertificateChain(hostAndPort));
    }
 else {
      nativeSslClientCert(handle,pkey.getEncoded(),table.CertificateChain(hostAndPort));
    }
  }
 else   if (table.IsDenied(hostAndPort)) {
    nativeSslClientCert(handle,0,null);
  }
 else {
    mCallbackProxy.onReceivedClientCertRequest(new ClientCertRequestHandler(this,handle,hostAndPort,table),hostAndPort);
  }
}
