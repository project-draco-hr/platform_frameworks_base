{
  checkLock();
  try {
    long current=System.currentTimeMillis();
    if (mViewRoot == null) {
      return new SceneResult("Layout has not been inflated!");
    }
    int w_spec, h_spec;
    int renderScreenWidth=mParams.getScreenWidth();
    int renderScreenHeight=mParams.getScreenHeight();
    RenderingMode renderingMode=mParams.getRenderingMode();
    if (renderingMode != RenderingMode.NORMAL) {
      w_spec=MeasureSpec.makeMeasureSpec(renderScreenWidth,renderingMode.isHorizExpand() ? MeasureSpec.UNSPECIFIED : MeasureSpec.EXACTLY);
      h_spec=MeasureSpec.makeMeasureSpec(renderScreenHeight - mScreenOffset,renderingMode.isVertExpand() ? MeasureSpec.UNSPECIFIED : MeasureSpec.EXACTLY);
      mViewRoot.measure(w_spec,h_spec);
      if (renderingMode.isHorizExpand()) {
        int neededWidth=mViewRoot.getChildAt(0).getMeasuredWidth();
        if (neededWidth > renderScreenWidth) {
          renderScreenWidth=neededWidth;
        }
      }
      if (renderingMode.isVertExpand()) {
        int neededHeight=mViewRoot.getChildAt(0).getMeasuredHeight();
        if (neededHeight > renderScreenHeight - mScreenOffset) {
          renderScreenHeight=neededHeight + mScreenOffset;
        }
      }
    }
    w_spec=MeasureSpec.makeMeasureSpec(renderScreenWidth,MeasureSpec.EXACTLY);
    h_spec=MeasureSpec.makeMeasureSpec(renderScreenHeight - mScreenOffset,MeasureSpec.EXACTLY);
    mViewRoot.measure(w_spec,h_spec);
    mViewRoot.layout(0,mScreenOffset,renderScreenWidth,renderScreenHeight);
    if (mParams.getImageFactory() != null) {
      mImage=mParams.getImageFactory().getImage(renderScreenWidth,renderScreenHeight - mScreenOffset);
    }
 else {
      mImage=new BufferedImage(renderScreenWidth,renderScreenHeight - mScreenOffset,BufferedImage.TYPE_INT_ARGB);
    }
    if (mParams.isCustomBackgroundEnabled()) {
      Graphics2D gc=mImage.createGraphics();
      gc.setColor(new Color(mParams.getCustomBackgroundColor(),true));
      gc.fillRect(0,0,renderScreenWidth,renderScreenHeight - mScreenOffset);
      gc.dispose();
    }
    Bitmap bitmap=Bitmap_Delegate.createBitmap(mImage,true,Density.getEnum(mParams.getDensity()));
    Canvas canvas=new Canvas(bitmap);
    canvas.setDensity(mParams.getDensity());
    Canvas_Delegate canvasDelegate=Canvas_Delegate.getDelegate(canvas);
    canvasDelegate.setLogger(mParams.getLogger());
    mViewRoot.draw(canvas);
    canvasDelegate.dispose();
    mViewInfo=visit(((ViewGroup)mViewRoot).getChildAt(0),mContext);
    System.out.println("rendering (ms): " + (System.currentTimeMillis() - current));
    return SceneResult.SUCCESS;
  }
 catch (  Throwable e) {
    Throwable t=e;
    while (t.getCause() != null) {
      t=t.getCause();
    }
    mParams.getLogger().error(t);
    return new SceneResult("Unknown error during rendering.",t);
  }
}
