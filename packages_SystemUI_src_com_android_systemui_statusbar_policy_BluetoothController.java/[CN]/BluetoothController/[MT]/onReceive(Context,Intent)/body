{
  final String action=intent.getAction();
  if (action.equals(BluetoothAdapter.ACTION_STATE_CHANGED)) {
    handleAdapterStateChange(intent.getIntExtra(BluetoothAdapter.EXTRA_STATE,BluetoothAdapter.ERROR));
  }
 else   if (action.equals(BluetoothAdapter.ACTION_CONNECTION_STATE_CHANGED)) {
    handleConnectionStateChange(intent.getIntExtra(BluetoothAdapter.EXTRA_CONNECTION_STATE,BluetoothAdapter.STATE_DISCONNECTED));
  }
  refreshViews();
}
