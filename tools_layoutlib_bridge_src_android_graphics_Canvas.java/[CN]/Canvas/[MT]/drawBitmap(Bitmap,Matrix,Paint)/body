{
  boolean needsRestore=false;
  if (matrix.isIdentity() == false) {
    save();
    needsRestore=true;
    Graphics2D g=getGraphics2d();
    AffineTransform currentTx=g.getTransform();
    AffineTransform matrixTx=matrix.getTransform();
    currentTx.preConcatenate(matrixTx);
    g.setTransform(currentTx);
  }
  drawBitmap(bitmap,0,0,paint);
  if (needsRestore) {
    restore();
  }
}
