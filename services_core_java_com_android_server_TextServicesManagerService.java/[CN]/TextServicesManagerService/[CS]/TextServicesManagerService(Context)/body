{
  mSystemReady=false;
  mContext=context;
  final IntentFilter broadcastFilter=new IntentFilter();
  broadcastFilter.addAction(Intent.ACTION_USER_ADDED);
  broadcastFilter.addAction(Intent.ACTION_USER_REMOVED);
  mContext.registerReceiver(new TextServicesBroadcastReceiver(),broadcastFilter);
  int userId=UserHandle.USER_SYSTEM;
  try {
    userId=ActivityManagerNative.getDefault().getCurrentUser().id;
  }
 catch (  RemoteException e) {
    Slog.w(TAG,"Couldn't get current user ID; guessing it's 0",e);
  }
  mMonitor=new TextServicesMonitor();
  mMonitor.register(context,null,true);
  mSettings=new TextServicesSettings(context.getContentResolver(),userId);
  switchUserLocked(userId);
}
