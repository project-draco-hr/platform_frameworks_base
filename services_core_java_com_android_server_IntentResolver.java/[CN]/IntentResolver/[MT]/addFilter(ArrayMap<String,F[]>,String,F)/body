{
  F[] array=map.get(name);
  if (array == null) {
    array=newArray(2);
    map.put(name,array);
    array[0]=filter;
  }
 else {
    final int N=array.length;
    int i=N;
    while (i > 0 && array[i - 1] == null) {
      i--;
    }
    if (i < N) {
      array[i]=filter;
    }
 else {
      F[] newa=newArray((N * 3) / 2);
      System.arraycopy(array,0,newa,0,N);
      newa[N]=filter;
      map.put(name,newa);
    }
  }
}
