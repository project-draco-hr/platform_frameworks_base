{
  int serverSyncIdColumn=diffsCursor.getColumnIndexOrThrow(_SYNC_ID);
  final boolean deleteBySyncId=!diffsCursor.isNull(serverSyncIdColumn);
  final String[] selectionArgs;
  Cursor c=null;
  try {
    if (deleteBySyncId) {
      selectionArgs=new String[]{diffsCursor.getString(serverSyncIdColumn),account};
      c=mDb.query(mTable,new String[]{BaseColumns._ID},SELECT_BY_SYNC_ID_AND_ACCOUNT,selectionArgs,null,null,null);
    }
 else {
      int serverSyncLocalIdColumn=diffsCursor.getColumnIndexOrThrow(_SYNC_LOCAL_ID);
      selectionArgs=new String[]{diffsCursor.getString(serverSyncLocalIdColumn)};
      c=mDb.query(mTable,new String[]{BaseColumns._ID},SELECT_BY_ID,selectionArgs,null,null,null);
    }
    c.moveToFirst();
    while (!c.isAfterLast()) {
      deleteRow(c);
      syncResult.stats.numDeletes++;
    }
  }
  finally {
    if (c != null)     c.close();
  }
  if (deleteBySyncId && mDeletedTable != null) {
    mDb.delete(mDeletedTable,SELECT_BY_SYNC_ID_AND_ACCOUNT,selectionArgs);
  }
}
