{
  if (DEBUG)   Log.d(TAG,"show(); mKeyguardView==" + mKeyguardView);
  Resources res=mContext.getResources();
  boolean enableScreenRotation=SystemProperties.getBoolean("lockscreen.rot_override",false) || res.getBoolean(R.bool.config_enableLockScreenRotation);
  if (mKeyguardHost == null) {
    if (DEBUG)     Log.d(TAG,"keyguard host is null, creating it...");
    mKeyguardHost=new KeyguardViewHost(mContext,mCallback);
    final int stretch=ViewGroup.LayoutParams.MATCH_PARENT;
    int flags=WindowManager.LayoutParams.FLAG_FORCE_NOT_FULLSCREEN | WindowManager.LayoutParams.FLAG_SHOW_WALLPAPER | WindowManager.LayoutParams.FLAG_SLIPPERY;
    if (!mNeedsInput) {
      flags|=WindowManager.LayoutParams.FLAG_ALT_FOCUSABLE_IM;
    }
    if (ActivityManager.isHighEndGfx(((WindowManager)mContext.getSystemService(Context.WINDOW_SERVICE)).getDefaultDisplay())) {
      flags|=WindowManager.LayoutParams.FLAG_HARDWARE_ACCELERATED;
    }
    WindowManager.LayoutParams lp=new WindowManager.LayoutParams(stretch,stretch,WindowManager.LayoutParams.TYPE_KEYGUARD,flags,PixelFormat.TRANSLUCENT);
    lp.softInputMode=WindowManager.LayoutParams.SOFT_INPUT_ADJUST_RESIZE;
    lp.windowAnimations=com.android.internal.R.style.Animation_LockScreen;
    if (ActivityManager.isHighEndGfx(((WindowManager)mContext.getSystemService(Context.WINDOW_SERVICE)).getDefaultDisplay())) {
      lp.flags|=WindowManager.LayoutParams.FLAG_HARDWARE_ACCELERATED;
      lp.privateFlags|=WindowManager.LayoutParams.PRIVATE_FLAG_FORCE_HARDWARE_ACCELERATED;
    }
    lp.privateFlags|=WindowManager.LayoutParams.PRIVATE_FLAG_SET_NEEDS_MENU_KEY;
    lp.setTitle("Keyguard");
    mWindowLayoutParams=lp;
    mViewManager.addView(mKeyguardHost,lp);
  }
  if (enableScreenRotation) {
    if (DEBUG)     Log.d(TAG,"Rotation sensor for lock screen On!");
    mWindowLayoutParams.screenOrientation=ActivityInfo.SCREEN_ORIENTATION_SENSOR;
  }
 else {
    if (DEBUG)     Log.d(TAG,"Rotation sensor for lock screen Off!");
    mWindowLayoutParams.screenOrientation=ActivityInfo.SCREEN_ORIENTATION_NOSENSOR;
  }
  mViewManager.updateViewLayout(mKeyguardHost,mWindowLayoutParams);
  if (mKeyguardView == null) {
    if (DEBUG)     Log.d(TAG,"keyguard view is null, creating it...");
    mKeyguardView=mKeyguardViewProperties.createKeyguardView(mContext,mCallback,mUpdateMonitor,this);
    mKeyguardView.setId(R.id.lock_screen);
    final ViewGroup.LayoutParams lp=new FrameLayout.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT,ViewGroup.LayoutParams.MATCH_PARENT);
    mKeyguardHost.addView(mKeyguardView,lp);
    if (mScreenOn) {
      mKeyguardView.show();
    }
  }
  int visFlags=(View.STATUS_BAR_DISABLE_BACK | View.STATUS_BAR_DISABLE_HOME);
  Log.v(TAG,"KGVM: Set visibility on " + mKeyguardHost + " to "+ visFlags);
  mKeyguardHost.setSystemUiVisibility(visFlags);
  mViewManager.updateViewLayout(mKeyguardHost,mWindowLayoutParams);
  mKeyguardHost.setVisibility(View.VISIBLE);
  mKeyguardView.requestFocus();
}
