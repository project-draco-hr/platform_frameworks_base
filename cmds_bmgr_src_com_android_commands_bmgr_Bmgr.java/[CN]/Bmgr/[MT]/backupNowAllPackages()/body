{
  int userId=UserHandle.USER_SYSTEM;
  IPackageManager mPm=IPackageManager.Stub.asInterface(ServiceManager.getService("package"));
  if (mPm == null) {
    System.err.println(PM_NOT_RUNNING_ERR);
    return;
  }
  List<PackageInfo> installedPackages=null;
  try {
    installedPackages=mPm.getInstalledPackages(0,userId).getList();
  }
 catch (  RemoteException e) {
    System.err.println(e.toString());
    System.err.println(PM_NOT_RUNNING_ERR);
  }
  if (installedPackages != null) {
    List<String> packages=new ArrayList<>();
    for (    PackageInfo pi : installedPackages) {
      try {
        if (mBmgr.isAppEligibleForBackup(pi.packageName)) {
          packages.add(pi.packageName);
        }
      }
 catch (      RemoteException e) {
        System.err.println(e.toString());
        System.err.println(BMGR_NOT_RUNNING_ERR);
      }
    }
    backupNowPackages(packages);
  }
}
