{
  mContext=context;
  mService=service;
  mSignalStrength=new SignalStrength();
  mBatteryStats=BatteryStatsService.getService();
  mStorageManager=(StorageManager)context.getSystemService(Context.STORAGE_SERVICE);
  mStorageManager.registerListener(new com.android.server.status.StorageNotification(context));
  service.setIcon("battery",null,com.android.internal.R.drawable.stat_sys_battery_unknown,0);
  mPhone=(TelephonyManager)context.getSystemService(Context.TELEPHONY_SERVICE);
  mPhoneSignalIconId=com.android.internal.R.drawable.stat_sys_signal_null;
  service.setIcon("phone_signal",null,mPhoneSignalIconId,0);
  ((TelephonyManager)mContext.getSystemService(Context.TELEPHONY_SERVICE)).listen(mPhoneStateListener,PhoneStateListener.LISTEN_SERVICE_STATE | PhoneStateListener.LISTEN_SIGNAL_STRENGTHS | PhoneStateListener.LISTEN_CALL_STATE| PhoneStateListener.LISTEN_DATA_CONNECTION_STATE| PhoneStateListener.LISTEN_DATA_ACTIVITY);
  service.setIcon("data_connection",null,com.android.internal.R.drawable.stat_sys_data_connected_g,0);
  service.setIconVisibility("data_connection",false);
  service.setIcon("wifi",null,sWifiSignalImages[0],0);
  service.setIconVisibility("wifi",false);
  service.setIcon("tty",null,com.android.internal.R.drawable.stat_sys_tty_mode,0);
  service.setIconVisibility("tty",false);
  service.setIcon("cdma_eri",null,com.android.internal.R.drawable.stat_sys_roaming_cdma_0,0);
  service.setIconVisibility("cdma_eri",false);
  service.setIcon("bluetooth",null,com.android.internal.R.drawable.stat_sys_data_bluetooth,0);
  BluetoothAdapter adapter=BluetoothAdapter.getDefaultAdapter();
  if (adapter != null) {
    mBluetoothEnabled=adapter.isEnabled();
  }
 else {
    mBluetoothEnabled=false;
  }
  mBluetoothA2dpConnected=false;
  mBluetoothHeadsetState=BluetoothHeadset.STATE_DISCONNECTED;
  mBluetoothPbapState=BluetoothPbap.STATE_DISCONNECTED;
  mService.setIconVisibility("bluetooth",mBluetoothEnabled);
  service.setIcon("gps",null,com.android.internal.R.drawable.stat_sys_gps_acquiring_anim,0);
  service.setIconVisibility("gps",false);
  service.setIcon("alarm_clock",null,com.android.internal.R.drawable.stat_notify_alarm,0);
  service.setIconVisibility("alarm_clock",false);
  service.setIcon("sync_active",null,R.drawable.stat_notify_sync_anim0,0);
  service.setIcon("sync_failing",null,R.drawable.stat_notify_sync_error,0);
  service.setIconVisibility("sync_active",false);
  service.setIconVisibility("sync_failing",false);
  service.setIcon("volume",null,com.android.internal.R.drawable.stat_sys_ringer_silent,0);
  service.setIconVisibility("volume",false);
  updateVolume();
  IntentFilter filter=new IntentFilter();
  filter.addAction(Intent.ACTION_BATTERY_CHANGED);
  filter.addAction(Intent.ACTION_BATTERY_LOW);
  filter.addAction(Intent.ACTION_BATTERY_OKAY);
  filter.addAction(Intent.ACTION_POWER_CONNECTED);
  filter.addAction(Intent.ACTION_ALARM_CHANGED);
  filter.addAction(Intent.ACTION_SYNC_STATE_CHANGED);
  filter.addAction(AudioManager.RINGER_MODE_CHANGED_ACTION);
  filter.addAction(AudioManager.VIBRATE_SETTING_CHANGED_ACTION);
  filter.addAction(BluetoothAdapter.ACTION_STATE_CHANGED);
  filter.addAction(BluetoothHeadset.ACTION_STATE_CHANGED);
  filter.addAction(BluetoothA2dp.ACTION_SINK_STATE_CHANGED);
  filter.addAction(BluetoothPbap.PBAP_STATE_CHANGED_ACTION);
  filter.addAction(WifiManager.WIFI_STATE_CHANGED_ACTION);
  filter.addAction(WifiManager.SUPPLICANT_CONNECTION_CHANGE_ACTION);
  filter.addAction(WifiManager.NETWORK_STATE_CHANGED_ACTION);
  filter.addAction(WifiManager.RSSI_CHANGED_ACTION);
  filter.addAction(LocationManager.GPS_ENABLED_CHANGE_ACTION);
  filter.addAction(LocationManager.GPS_FIX_CHANGE_ACTION);
  filter.addAction(TelephonyIntents.ACTION_SIM_STATE_CHANGED);
  filter.addAction(TtyIntent.TTY_ENABLED_CHANGE_ACTION);
  mContext.registerReceiver(mIntentReceiver,filter,null,mHandler);
  try {
    mHspaDataDistinguishable=mContext.getResources().getBoolean(com.android.internal.R.bool.config_hspa_data_distinguishable);
  }
 catch (  Exception e) {
    mHspaDataDistinguishable=false;
  }
}
