{
  boolean visible=false;
  if (intent == null) {
    BluetoothDevice bluetooth=(BluetoothDevice)mContext.getSystemService(Context.BLUETOOTH_SERVICE);
    if (bluetooth != null) {
      visible=bluetooth.isEnabled();
    }
    mService.setIconVisibility(mBluetoothIcon,visible);
    return;
  }
  int iconId=com.android.internal.R.drawable.stat_sys_data_bluetooth;
  String action=intent.getAction();
  if (action.equals(BluetoothIntent.DISABLED_ACTION)) {
    visible=false;
  }
 else   if (action.equals(BluetoothIntent.ENABLED_ACTION)) {
    visible=true;
  }
 else   if (action.equals(BluetoothIntent.HEADSET_STATE_CHANGED_ACTION)) {
    visible=true;
    mBluetoothHeadsetState=intent.getIntExtra(BluetoothIntent.HEADSET_STATE,BluetoothHeadset.STATE_ERROR);
  }
 else   if (action.equals(BluetoothA2dp.SINK_STATE_CHANGED_ACTION)) {
    visible=true;
    mBluetoothA2dpState=intent.getIntExtra(BluetoothA2dp.SINK_STATE,BluetoothA2dp.STATE_DISCONNECTED);
  }
 else {
    return;
  }
  if (mBluetoothHeadsetState == BluetoothHeadset.STATE_CONNECTED || mBluetoothA2dpState == BluetoothA2dp.STATE_CONNECTED || mBluetoothA2dpState == BluetoothA2dp.STATE_PLAYING) {
    iconId=com.android.internal.R.drawable.stat_sys_data_bluetooth_connected;
  }
  mBluetoothData.iconId=iconId;
  mService.updateIcon(mBluetoothIcon,mBluetoothData,null);
  mService.setIconVisibility(mBluetoothIcon,visible);
}
