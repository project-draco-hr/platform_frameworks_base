{
  int iconId;
  boolean visible=true;
  if (mSimState == IccCard.State.READY || mSimState == IccCard.State.UNKNOWN) {
    int data=mDataState;
    int[] list=mDataIconList;
    ServiceState ss=mServiceState;
    boolean hasService=false;
    if (ss != null) {
      hasService=(ss.getState() == ServiceState.STATE_IN_SERVICE);
    }
    if (hasService && data == TelephonyManager.DATA_CONNECTED) {
switch (mDataActivity) {
case TelephonyManager.DATA_ACTIVITY_IN:
        iconId=list[1];
      break;
case TelephonyManager.DATA_ACTIVITY_OUT:
    iconId=list[2];
  break;
case TelephonyManager.DATA_ACTIVITY_INOUT:
iconId=list[3];
break;
default :
iconId=list[0];
break;
}
mDataData.iconId=iconId;
mService.updateIcon(mDataIcon,mDataData,null);
}
 else {
visible=false;
}
}
 else {
mDataData.iconId=com.android.internal.R.drawable.stat_sys_no_sim;
mService.updateIcon(mDataIcon,mDataData,null);
}
long ident=Binder.clearCallingIdentity();
try {
mBatteryStats.notePhoneDataConnectionState(mPhone.getNetworkType(),visible);
}
 catch (RemoteException e) {
}
 finally {
Binder.restoreCallingIdentity(ident);
}
if (mDataIconVisible != visible) {
mService.setIconVisibility(mDataIcon,visible);
mDataIconVisible=visible;
}
}
