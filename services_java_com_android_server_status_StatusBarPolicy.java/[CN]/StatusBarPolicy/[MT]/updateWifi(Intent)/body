{
  final String action=intent.getAction();
  if (action.equals(WifiManager.WIFI_STATE_CHANGED_ACTION)) {
    final boolean enabled=intent.getIntExtra(WifiManager.EXTRA_WIFI_STATE,WifiManager.WIFI_STATE_UNKNOWN) == WifiManager.WIFI_STATE_ENABLED;
    if (!enabled) {
      mService.setIconVisibility(mWifiIcon,false);
    }
  }
 else   if (action.equals(WifiManager.NETWORK_STATE_CHANGED_ACTION)) {
    final NetworkInfo networkInfo=(NetworkInfo)intent.getParcelableExtra(WifiManager.EXTRA_NETWORK_INFO);
    int iconId;
    if (networkInfo != null && networkInfo.isConnected()) {
      mIsWifiConnected=true;
      if (mLastWifiSignalLevel == -1) {
        iconId=sWifiSignalImages[0];
      }
 else {
        iconId=sWifiSignalImages[mLastWifiSignalLevel];
      }
      mService.setIconVisibility(mWifiIcon,true);
    }
 else {
      mLastWifiSignalLevel=-1;
      mIsWifiConnected=false;
      iconId=sWifiSignalImages[0];
      mService.setIconVisibility(mWifiIcon,false);
    }
    mWifiData.iconId=iconId;
    mService.updateIcon(mWifiIcon,mWifiData,null);
  }
 else   if (action.equals(WifiManager.RSSI_CHANGED_ACTION)) {
    final int newRssi=intent.getIntExtra(WifiManager.EXTRA_NEW_RSSI,-200);
    int newSignalLevel=WifiManager.calculateSignalLevel(newRssi,sWifiSignalImages.length);
    if (newSignalLevel != mLastWifiSignalLevel) {
      mLastWifiSignalLevel=newSignalLevel;
      if (mIsWifiConnected) {
        mWifiData.iconId=sWifiSignalImages[newSignalLevel];
      }
 else {
        mWifiData.iconId=sWifiTemporarilyNotConnectedImage;
      }
      mService.updateIcon(mWifiIcon,mWifiData,null);
    }
  }
}
