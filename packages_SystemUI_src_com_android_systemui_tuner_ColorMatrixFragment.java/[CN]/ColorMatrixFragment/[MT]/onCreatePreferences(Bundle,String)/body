{
  final Context context=getPreferenceManager().getContext();
  setPreferenceScreen(getPreferenceManager().createPreferenceScreen(context));
  mSelectPreference=new DropDownPreference(context);
  mSelectPreference.setTitle(R.string.color_transform);
  mSelectPreference.setSummary("%s");
  mSelectPreference.setOnPreferenceChangeListener(new Preference.OnPreferenceChangeListener(){
    @Override public boolean onPreferenceChange(    Preference preference,    Object newValue){
      int index=Integer.parseInt((String)newValue);
      Settings.Secure.putString(context.getContentResolver(),Settings.Secure.ACCESSIBILITY_DISPLAY_COLOR_MATRIX,getValues()[index]);
      return true;
    }
  }
);
  getPreferenceScreen().addPreference(mSelectPreference);
  mShowQs=new SwitchPreference(context);
  mShowQs.setTitle(R.string.color_matrix_show_qs);
  mShowQs.setOnPreferenceChangeListener(new Preference.OnPreferenceChangeListener(){
    @Override public boolean onPreferenceChange(    Preference preference,    Object newValue){
      boolean showTile=(Boolean)newValue;
      String newTiles;
      if (showTile) {
        newTiles=mTiles != null ? mTiles + "," + ColorMatrixTile.COLOR_MATRIX_SPEC : "default," + ColorMatrixTile.COLOR_MATRIX_SPEC;
      }
 else {
        newTiles=mTiles.replace(mTiles.contains(ColorMatrixTile.COLOR_MATRIX_SPEC + ",") ? ColorMatrixTile.COLOR_MATRIX_SPEC + "," : "," + ColorMatrixTile.COLOR_MATRIX_SPEC,"");
      }
      Settings.Secure.putString(context.getContentResolver(),QSTileHost.TILES_SETTING,newTiles);
      return true;
    }
  }
);
  getPreferenceScreen().addPreference(mShowQs);
  mEnableCustomPreference=new SwitchPreference(context);
  mEnableCustomPreference.setTitle(R.string.color_enable_custom);
  mEnableCustomPreference.setOnPreferenceChangeListener(new Preference.OnPreferenceChangeListener(){
    @Override public boolean onPreferenceChange(    Preference preference,    Object newValue){
      boolean enabled=(Boolean)newValue;
      Settings.Secure.putInt(context.getContentResolver(),ColorMatrixTile.COLOR_MATRIX_CUSTOM_ENABLED,enabled ? 1 : 0);
      return true;
    }
  }
);
  getPreferenceScreen().addPreference(mEnableCustomPreference);
  mCustomPreference=new MatrixPreference(context);
  getPreferenceScreen().addPreference(mCustomPreference);
}
