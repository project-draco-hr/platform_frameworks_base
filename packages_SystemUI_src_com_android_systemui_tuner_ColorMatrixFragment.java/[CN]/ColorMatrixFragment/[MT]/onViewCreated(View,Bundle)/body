{
  super.onViewCreated(view,savedInstanceState);
  View switchBar=view.findViewById(R.id.switch_bar);
  mSwitch=(Switch)switchBar.findViewById(android.R.id.switch_widget);
  mSwitch.setChecked(mState != DisplayController.COLOR_STATE_DISABLED);
  switchBar.setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      int newState=mState != DisplayController.COLOR_STATE_DISABLED ? DisplayController.COLOR_STATE_DISABLED : DisplayController.COLOR_STATE_ENABLED;
      ContentResolver contentResolver=getContext().getContentResolver();
      if (newState == DisplayController.COLOR_STATE_DISABLED) {
        String tiles=Settings.Secure.getString(contentResolver,QSTileHost.TILES_SETTING);
        if (tiles != null) {
          if (tiles.contains(",colors")) {
            tiles=tiles.replace(",colors","");
          }
 else           if (tiles.contains("colors,")) {
            tiles=tiles.replace("colors,","");
          }
          Settings.Secure.putString(contentResolver,QSTileHost.TILES_SETTING,tiles);
        }
      }
      Settings.Secure.putInt(contentResolver,DisplayController.COLOR_STATE,newState);
    }
  }
);
}
