{
  if (mDescriptor != -1) {
    long alarmSeconds, alarmNanoseconds;
    if (alarm.when < 0) {
      alarmSeconds=0;
      alarmNanoseconds=0;
    }
 else {
      alarmSeconds=alarm.when / 1000;
      alarmNanoseconds=(alarm.when % 1000) * 1000 * 1000;
    }
    set(mDescriptor,alarm.type,alarmSeconds,alarmNanoseconds);
  }
 else {
    Message msg=Message.obtain();
    msg.what=ALARM_EVENT;
    mHandler.removeMessages(ALARM_EVENT);
    mHandler.sendMessageAtTime(msg,alarm.when);
  }
}
