{
switch (mode) {
case UiModeManager.MODE_NIGHT_NO:
case UiModeManager.MODE_NIGHT_YES:
case UiModeManager.MODE_NIGHT_AUTO:
    break;
default :
  throw new IllegalArgumentException("Unknown mode: " + mode);
}
final long ident=Binder.clearCallingIdentity();
try {
synchronized (mLock) {
  if (isDoingNightModeLocked() && mNightMode != mode) {
    Settings.Secure.putInt(mContext.getContentResolver(),Settings.Secure.UI_NIGHT_MODE,mode);
    mNightMode=mode;
    updateLocked(0,0);
  }
}
}
  finally {
Binder.restoreCallingIdentity(ident);
}
}
