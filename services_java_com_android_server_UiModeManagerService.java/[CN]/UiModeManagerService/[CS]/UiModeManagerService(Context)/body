{
  mContext=context;
  ServiceManager.addService(Context.UI_MODE_SERVICE,this);
  mAlarmManager=(AlarmManager)mContext.getSystemService(Context.ALARM_SERVICE);
  mLocationManager=(LocationManager)mContext.getSystemService(Context.LOCATION_SERVICE);
  mContext.registerReceiver(mTwilightUpdateReceiver,new IntentFilter(ACTION_UPDATE_NIGHT_MODE));
  mContext.registerReceiver(mDockModeReceiver,new IntentFilter(Intent.ACTION_DOCK_EVENT));
  mContext.registerReceiver(mBatteryReceiver,new IntentFilter(Intent.ACTION_BATTERY_CHANGED));
  IntentFilter filter=new IntentFilter(Intent.ACTION_AIRPLANE_MODE_CHANGED);
  filter.addAction(Intent.ACTION_TIMEZONE_CHANGED);
  mContext.registerReceiver(mUpdateLocationReceiver,filter);
  PowerManager powerManager=(PowerManager)context.getSystemService(Context.POWER_SERVICE);
  mWakeLock=powerManager.newWakeLock(PowerManager.FULL_WAKE_LOCK,TAG);
  mConfiguration.setToDefaults();
  mDefaultUiModeType=context.getResources().getInteger(com.android.internal.R.integer.config_defaultUiModeType);
  mCarModeKeepsScreenOn=(context.getResources().getInteger(com.android.internal.R.integer.config_carDockKeepsScreenOn) == 1);
  mDeskModeKeepsScreenOn=(context.getResources().getInteger(com.android.internal.R.integer.config_deskDockKeepsScreenOn) == 1);
  mTelevision=context.getPackageManager().hasSystemFeature(PackageManager.FEATURE_TELEVISION);
  mNightMode=Settings.Secure.getInt(mContext.getContentResolver(),Settings.Secure.UI_NIGHT_MODE,UiModeManager.MODE_NIGHT_AUTO);
}
