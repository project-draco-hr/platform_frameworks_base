{
  if (DEBUG) {
    Log.d(TAG,"computeMinMaxScroll");
  }
  mTaskProgressMap.clear();
  if (tasks.isEmpty()) {
    mMinScrollP=mMaxScrollP=mMaxStackScrollP=0;
    mNumStackTasks=mNumFreeformTasks=0;
    return;
  }
  ArrayList<Task> freeformTasks=new ArrayList<>();
  ArrayList<Task> stackTasks=new ArrayList<>();
  for (int i=0; i < tasks.size(); i++) {
    Task task=tasks.get(i);
    if (task.isFreeformTask()) {
      freeformTasks.add(task);
    }
 else {
      stackTasks.add(task);
    }
  }
  mNumStackTasks=stackTasks.size();
  mNumFreeformTasks=freeformTasks.size();
  if (!stackTasks.isEmpty()) {
    float pAtBackMostTaskTop=0;
    float pAtFrontMostTaskTop=pAtBackMostTaskTop;
    int taskCount=stackTasks.size();
    for (int i=0; i < taskCount; i++) {
      Task task=stackTasks.get(i);
      mTaskProgressMap.put(task.key,pAtFrontMostTaskTop);
      if (i < (taskCount - 1)) {
        float pPeek=task.group.isFrontMostTask(task) ? mBetweenAffiliationPOffset : mWithinAffiliationPOffset;
        pAtFrontMostTaskTop+=pPeek;
      }
    }
    mFrontMostTaskP=pAtFrontMostTaskTop;
    mMaxStackScrollP=getBottomAlignedScrollProgress(pAtFrontMostTaskTop,mTaskBottomPOffset + mTaskHeightPOffset);
    mMinScrollP=getBottomAlignedScrollProgress(pAtBackMostTaskTop,mTaskBottomPOffset + mTaskHeightPOffset);
  }
  if (!freeformTasks.isEmpty()) {
    mFreeformCellXCount=Math.max(2,(int)Math.ceil(Math.sqrt(mNumFreeformTasks)));
    mFreeformCellYCount=Math.max(2,(int)Math.ceil((float)mNumFreeformTasks / mFreeformCellXCount));
    mFreeformCellWidth=mFreeformRect.width() / mFreeformCellXCount;
    mFreeformCellHeight=mFreeformRect.height() / mFreeformCellYCount;
    int taskCount=freeformTasks.size();
    for (int i=0; i < taskCount; i++) {
      Task task=freeformTasks.get(i);
      mTaskProgressMap.put(task.key,(mFrontMostTaskP + 1) + i);
    }
    mMaxScrollP=mMaxStackScrollP + mFreeformWorkspacePOffset;
    mInitialScrollP=mMaxScrollP;
  }
 else {
    mMaxScrollP=mMaxStackScrollP;
    mInitialScrollP=Math.max(mMinScrollP,mMaxStackScrollP - mTaskHalfHeightPOffset);
  }
  if (DEBUG) {
    Log.d(TAG,"mNumStackTasks: " + mNumStackTasks);
    Log.d(TAG,"mNumFreeformTasks: " + mNumFreeformTasks);
    Log.d(TAG,"mMinScrollP: " + mMinScrollP);
    Log.d(TAG,"mMaxStackScrollP: " + mMaxStackScrollP);
    Log.d(TAG,"mMaxScrollP: " + mMaxScrollP);
  }
}
