{
  WifiMonitor m=mIfaceMap.get(iface);
  if (m == null) {
    Log.e(TAG,"startMonitor called with unknown iface=" + iface);
    return;
  }
  Log.d(TAG,"startMonitoring(" + iface + ") with mConnected = "+ mConnected);
  if (mConnected) {
    m.mMonitoring=true;
    m.mWifiStateMachine.sendMessage(SUP_CONNECTION_EVENT);
  }
 else {
    if (DBG)     Log.d(TAG,"connecting to supplicant");
    int connectTries=0;
    while (true) {
      if (mWifiNative.connectToSupplicant()) {
        m.mMonitoring=true;
        m.mWifiStateMachine.sendMessage(SUP_CONNECTION_EVENT);
        new MonitorThread(mWifiNative,this).start();
        mConnected=true;
        break;
      }
      if (connectTries++ < 5) {
        try {
          Thread.sleep(1000);
        }
 catch (        InterruptedException ignore) {
        }
      }
 else {
        mIfaceMap.remove(iface);
        m.mWifiStateMachine.sendMessage(SUP_DISCONNECTION_EVENT);
        break;
      }
    }
  }
}
