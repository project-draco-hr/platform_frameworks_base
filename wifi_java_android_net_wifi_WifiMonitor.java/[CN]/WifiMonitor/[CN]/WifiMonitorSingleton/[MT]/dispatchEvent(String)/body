{
  String iface;
  if (eventStr.startsWith("IFNAME=")) {
    int space=eventStr.indexOf(' ');
    if (space != -1) {
      iface=eventStr.substring(7,space);
      if (!mIfaceMap.containsKey(iface) && iface.startsWith("p2p-")) {
        iface="p2p0";
      }
      eventStr=eventStr.substring(space + 1);
    }
 else {
      Log.e(TAG,"Dropping malformed event (unparsable iface): " + eventStr);
      return false;
    }
  }
 else {
    iface="p2p0";
  }
  if (DBG)   Log.d(TAG,"Dispatching event to interface: " + iface);
  WifiMonitor m=mIfaceMap.get(iface);
  if (m != null) {
    if (m.mMonitoring) {
      if (m.dispatchEvent(eventStr)) {
        mConnected=false;
        return true;
      }
      return false;
    }
 else {
      if (DBG)       Log.d(TAG,"Dropping event because (" + iface + ") is stopped");
      return false;
    }
  }
 else {
    if (DBG)     Log.d(TAG,"Sending to all monitors because there's no matching iface");
    boolean done=false;
    for (    WifiMonitor monitor : mIfaceMap.values()) {
      if (monitor.mMonitoring && monitor.dispatchEvent(eventStr)) {
        done=true;
      }
    }
    if (done) {
      mConnected=false;
    }
    return done;
  }
}
