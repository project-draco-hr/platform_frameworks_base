{
  if (enforceSecurity && !url.getProtocol().equalsIgnoreCase(SecureHTTP)) {
    throw new IOException("Protocol '" + url.getProtocol() + "' is not secure");
  }
  return new OSUSocketFactory(ks,homeSP,flowType,network,url,km);
}
