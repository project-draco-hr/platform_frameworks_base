{
  if (mAllowStacking) {
    final int widthSize=MeasureSpec.getSize(widthMeasureSpec);
    if (widthSize > mLastWidthSize && mStacked) {
      setStacked(false);
    }
    mLastWidthSize=widthSize;
  }
  super.onMeasure(widthMeasureSpec,heightMeasureSpec);
  if (mAllowStacking && !mStacked) {
    final int measuredWidth=getMeasuredWidthAndState();
    final int measuredWidthState=measuredWidth & MEASURED_STATE_MASK;
    if (measuredWidthState == MEASURED_STATE_TOO_SMALL) {
      setStacked(true);
      super.onMeasure(widthMeasureSpec,heightMeasureSpec);
    }
  }
}
