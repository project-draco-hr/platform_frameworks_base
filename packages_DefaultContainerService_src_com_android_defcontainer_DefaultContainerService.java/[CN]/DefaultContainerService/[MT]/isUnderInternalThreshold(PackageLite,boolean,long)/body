{
  long sizeBytes=0;
  for (  String codePath : pkg.getAllCodePaths()) {
    sizeBytes+=new File(codePath).length();
    if (isForwardLocked) {
      sizeBytes+=PackageHelper.extractPublicFiles(codePath,null);
    }
  }
  final StatFs stat=new StatFs(Environment.getDataDirectory().getPath());
  final long availBytes=stat.getAvailableBytes();
  return (availBytes - sizeBytes) > threshold;
}
