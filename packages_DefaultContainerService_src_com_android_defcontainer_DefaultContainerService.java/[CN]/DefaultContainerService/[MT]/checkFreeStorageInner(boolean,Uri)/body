{
  File apkFile=new File(packageURI.getPath());
  long size=apkFile.length();
  if (external) {
    String status=Environment.getExternalStorageState();
    long availSDSize=-1;
    if (status.equals(Environment.MEDIA_MOUNTED)) {
      StatFs sdStats=new StatFs(Environment.getExternalStorageDirectory().getPath());
      availSDSize=(long)sdStats.getAvailableBlocks() * (long)sdStats.getBlockSize();
    }
    return availSDSize > size;
  }
  StatFs internalStats=new StatFs(Environment.getDataDirectory().getPath());
  long totalInternalSize=(long)internalStats.getBlockCount() * (long)internalStats.getBlockSize();
  long availInternalSize=(long)internalStats.getAvailableBlocks() * (long)internalStats.getBlockSize();
  double pctNandFree=(double)availInternalSize / (double)totalInternalSize;
  long reqInstallSize=size;
  long reqInternalSize=0;
  boolean intThresholdOk=(pctNandFree >= LOW_NAND_FLASH_TRESHOLD);
  boolean intAvailOk=((reqInstallSize + reqInternalSize) < availInternalSize);
  return intThresholdOk && intAvailOk;
}
