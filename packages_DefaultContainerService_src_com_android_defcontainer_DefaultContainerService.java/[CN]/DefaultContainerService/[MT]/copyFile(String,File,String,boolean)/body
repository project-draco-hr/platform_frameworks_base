{
  final File sourceFile=new File(sourcePath);
  final File targetFile=new File(targetDir,targetName);
  Slog.d(TAG,"Copying " + sourceFile + " to "+ targetFile);
  if (!FileUtils.copyFile(sourceFile,targetFile)) {
    throw new IOException("Failed to copy " + sourceFile + " to "+ targetFile);
  }
  if (isForwardLocked) {
    final String publicTargetName=PackageHelper.replaceEnd(targetName,".apk",".zip");
    final File publicTargetFile=new File(targetDir,publicTargetName);
    PackageHelper.extractPublicFiles(sourceFile,publicTargetFile);
    Os.chmod(targetFile.getAbsolutePath(),0640);
    Os.chmod(publicTargetFile.getAbsolutePath(),0644);
  }
 else {
    Os.chmod(targetFile.getAbsolutePath(),0644);
  }
}
