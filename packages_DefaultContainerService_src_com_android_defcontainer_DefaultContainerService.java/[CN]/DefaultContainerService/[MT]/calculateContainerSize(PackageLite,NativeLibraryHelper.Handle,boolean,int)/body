{
  long sizeBytes=0;
  for (  String codePath : pkg.getAllCodePaths()) {
    sizeBytes+=new File(codePath).length();
    if (isForwardLocked) {
      sizeBytes+=PackageHelper.extractPublicFiles(codePath,null);
    }
  }
  if (abiIndex >= 0) {
    sizeBytes+=NativeLibraryHelper.sumNativeBinariesLI(handle,Build.SUPPORTED_ABIS[abiIndex]);
  }
  int sizeMb=(int)(sizeBytes >> 20);
  if ((sizeBytes - (sizeMb * 1024 * 1024)) > 0) {
    sizeMb++;
  }
  sizeMb++;
  return sizeMb;
}
