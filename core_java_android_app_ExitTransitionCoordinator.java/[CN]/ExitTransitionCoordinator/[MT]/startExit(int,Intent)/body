{
  if (!mIsExitStarted) {
    mIsExitStarted=true;
    pauseInput();
    ViewGroup decorView=getDecor();
    if (decorView != null) {
      decorView.suppressLayout(true);
    }
    mHandler=new Handler(){
      @Override public void handleMessage(      Message msg){
        mIsCanceled=true;
        finish();
      }
    }
;
    delayCancel();
    moveSharedElementsToOverlay();
    if (decorView != null && decorView.getBackground() == null) {
      getWindow().setBackgroundDrawable(new ColorDrawable(Color.BLACK));
    }
    final boolean targetsM=decorView == null || decorView.getContext().getApplicationInfo().targetSdkVersion >= VERSION_CODES.M;
    ArrayList<String> sharedElementNames=targetsM ? mSharedElementNames : mAllSharedElementNames;
    ActivityOptions options=ActivityOptions.makeSceneTransitionAnimation(mActivity,this,sharedElementNames,resultCode,data);
    mActivity.convertToTranslucent(new Activity.TranslucentConversionListener(){
      @Override public void onTranslucentConversionComplete(      boolean drawComplete){
        if (!mIsCanceled) {
          fadeOutBackground();
        }
      }
    }
,options);
    startTransition(new Runnable(){
      @Override public void run(){
        startExitTransition();
      }
    }
);
  }
}
