{
  Transition transition=getSharedElementExitTransition();
  transition.addListener(new Transition.TransitionListenerAdapter(){
    @Override public void onTransitionEnd(    Transition transition){
      transition.removeListener(this);
      if (mExitComplete) {
        delayCancel();
      }
    }
  }
);
  final ArrayList<View> sharedElementSnapshots=createSnapshots(mExitSharedElementBundle,mSharedElementNames);
  decorView.getViewTreeObserver().addOnPreDrawListener(new ViewTreeObserver.OnPreDrawListener(){
    @Override public boolean onPreDraw(){
      decorView.getViewTreeObserver().removeOnPreDrawListener(this);
      setSharedElementState(mExitSharedElementBundle,sharedElementSnapshots);
      return true;
    }
  }
);
  setGhostVisibility(View.INVISIBLE);
  scheduleGhostVisibilityChange(View.INVISIBLE);
  if (mListener != null) {
    mListener.onSharedElementEnd(mSharedElementNames,mSharedElements,sharedElementSnapshots);
  }
  TransitionManager.beginDelayedTransition(decorView,transition);
  scheduleGhostVisibilityChange(View.VISIBLE);
  setGhostVisibility(View.VISIBLE);
  decorView.invalidate();
}
