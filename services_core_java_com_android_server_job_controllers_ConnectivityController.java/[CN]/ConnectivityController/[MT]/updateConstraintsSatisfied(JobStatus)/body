{
  final boolean ignoreBlocked=(jobStatus.getFlags() & JobInfo.FLAG_WILL_BE_FOREGROUND) != 0;
  final NetworkInfo info=mConnManager.getActiveNetworkInfoForUid(jobStatus.getSourceUid(),ignoreBlocked);
  final boolean connected=(info != null) && info.isConnected();
  final boolean unmetered=connected && !info.isMetered();
  final boolean notRoaming=connected && !info.isRoaming();
  boolean changed=false;
  changed|=jobStatus.setConnectivityConstraintSatisfied(connected);
  changed|=jobStatus.setUnmeteredConstraintSatisfied(unmetered);
  changed|=jobStatus.setNotRoamingConstraintSatisfied(notRoaming);
  return changed;
}
