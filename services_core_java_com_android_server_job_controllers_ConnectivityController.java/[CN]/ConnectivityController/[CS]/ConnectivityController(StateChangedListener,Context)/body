{
  super(stateChangedListener,context);
  IntentFilter intentFilter=new IntentFilter();
  intentFilter.addAction(ConnectivityManager.CONNECTIVITY_ACTION);
  mContext.registerReceiverAsUser(mConnectivityChangedReceiver,UserHandle.ALL,intentFilter,null,BackgroundThread.getHandler());
  ConnectivityService cs=(ConnectivityService)ServiceManager.getService(Context.CONNECTIVITY_SERVICE);
  if (cs != null) {
    if (cs.getActiveNetworkInfo() != null) {
      mNetworkConnected=cs.getActiveNetworkInfo().isConnected();
    }
    mNetworkUnmetered=mNetworkConnected && !cs.isActiveNetworkMetered();
  }
}
