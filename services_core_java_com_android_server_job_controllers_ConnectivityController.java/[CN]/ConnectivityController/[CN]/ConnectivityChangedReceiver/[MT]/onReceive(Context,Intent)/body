{
  if (DEBUG) {
    Slog.d(TAG,"Received connectivity event: " + intent.getAction() + " u"+ context.getUserId());
  }
  final String action=intent.getAction();
  if (action.equals(ConnectivityManager.CONNECTIVITY_ACTION)) {
    final int networkType=intent.getIntExtra(ConnectivityManager.EXTRA_NETWORK_TYPE,ConnectivityManager.TYPE_NONE);
    final ConnectivityManager connManager=(ConnectivityManager)context.getSystemService(Context.CONNECTIVITY_SERVICE);
    final NetworkInfo activeNetwork=connManager.getActiveNetworkInfo();
    final int userid=context.getUserId();
    if (activeNetwork == null) {
      mNetworkUnmetered=false;
      mNetworkConnected=false;
      updateTrackedJobs(userid);
    }
 else     if (activeNetwork.getType() == networkType) {
      mNetworkUnmetered=false;
      mNetworkConnected=!intent.getBooleanExtra(ConnectivityManager.EXTRA_NO_CONNECTIVITY,false);
      if (mNetworkConnected) {
        mNetworkUnmetered=!connManager.isActiveNetworkMetered();
      }
      updateTrackedJobs(userid);
    }
  }
 else {
    if (DEBUG) {
      Slog.d(TAG,"Unrecognised action in intent: " + action);
    }
  }
}
