{
  Bitmap b=null;
  if (addHeaderBitmap) {
    float scale=transform.scale;
    int fromHeaderWidth=(int)(transform.rect.width());
    int fromHeaderHeight=(int)(taskView.mHeaderView.getMeasuredHeight() * scale);
    b=Bitmap.createBitmap(fromHeaderWidth,fromHeaderHeight,Bitmap.Config.ARGB_8888);
    if (RecentsDebugFlags.Static.EnableTransitionThumbnailDebugMode) {
      b.eraseColor(0xFFff0000);
    }
 else {
      Canvas c=new Canvas(b);
      c.scale(scale,scale);
      taskView.mHeaderView.draw(c);
      c.setBitmap(null);
    }
    b=b.createAshmemBitmap();
  }
  Rect taskRect=new Rect();
  transform.rect.round(taskRect);
  if (stackView.getStack().getStackFrontMostTask(false) != taskView.getTask()) {
    taskRect.bottom=2 * Recents.getSystemServices().getDisplayRect().height();
  }
  return new AppTransitionAnimationSpec(taskView.getTask().key.id,b,taskRect);
}
