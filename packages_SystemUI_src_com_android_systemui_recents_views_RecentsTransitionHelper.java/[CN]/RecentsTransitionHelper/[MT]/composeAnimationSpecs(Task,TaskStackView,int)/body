{
  final int targetStackId=destinationStack != INVALID_STACK_ID ? destinationStack : task.key.stackId;
  if (!StackId.useAnimationSpecForAppTransition(targetStackId)) {
    return null;
  }
  float stackScroll=stackView.getScroller().getStackScroll();
  TaskView taskView=stackView.getChildViewForTask(task);
  TaskStackLayoutAlgorithm layoutAlgorithm=stackView.getStackAlgorithm();
  Rect offscreenTaskRect=new Rect(layoutAlgorithm.mTaskRect);
  offscreenTaskRect.offsetTo(offscreenTaskRect.left,layoutAlgorithm.mCurrentStackRect.bottom);
  List<AppTransitionAnimationSpec> specs=new ArrayList<>();
  if (targetStackId == FULLSCREEN_WORKSPACE_STACK_ID) {
    if (taskView == null) {
      specs.add(composeOffscreenAnimationSpec(task,offscreenTaskRect));
    }
 else {
      layoutAlgorithm.getStackTransform(task,stackScroll,mTmpTransform,null);
      specs.add(composeAnimationSpec(taskView,mTmpTransform,true));
    }
    return specs;
  }
  TaskStack stack=stackView.getStack();
  ArrayList<Task> tasks=stack.getTasks();
  int taskCount=tasks.size();
  for (int i=taskCount - 1; i >= 0; i--) {
    Task t=tasks.get(i);
    if (t.isFreeformTask() || targetStackId == FREEFORM_WORKSPACE_STACK_ID) {
      TaskView tv=stackView.getChildViewForTask(t);
      if (tv == null) {
        specs.add(composeOffscreenAnimationSpec(t,offscreenTaskRect));
      }
 else {
        layoutAlgorithm.getStackTransform(task,stackScroll,mTmpTransform,null);
        specs.add(composeAnimationSpec(tv,mTmpTransform,true));
      }
    }
  }
  return specs;
}
