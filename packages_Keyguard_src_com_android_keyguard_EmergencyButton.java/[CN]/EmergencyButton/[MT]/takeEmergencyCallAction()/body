{
  mPowerManager.userActivity(SystemClock.uptimeMillis(),true);
  if (mLockPatternUtils.isInCall()) {
    mLockPatternUtils.resumeCall();
    if (mEmergencyButtonCallback != null) {
      mEmergencyButtonCallback.onEmergencyButtonClickedWhenInCall();
    }
  }
 else {
    final boolean bypassHandler=true;
    KeyguardUpdateMonitor.getInstance(mContext).reportEmergencyCallAction(bypassHandler);
    Intent intent=new Intent(ACTION_EMERGENCY_DIAL);
    intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS);
    getContext().startActivityAsUser(intent,new UserHandle(mLockPatternUtils.getCurrentUser()));
  }
}
