{
  if (leafs == null) {
    leafs=new ArrayList<BiTree>();
  }
  leafs.clear();
  getLeafs(leafs,1);
  double r=log2(leafs.size());
  if (Math.ceil(r) == Math.floor(r)) {
    return leafs.get(leafs.size() - 1);
  }
  int treeDepth=depth();
  for (int i=leafs.size() - 1; i >= 0; i--) {
    BiTree n=leafs.get(i);
    if (n.nodeDepth < treeDepth) {
      return n;
    }
  }
  return null;
}
