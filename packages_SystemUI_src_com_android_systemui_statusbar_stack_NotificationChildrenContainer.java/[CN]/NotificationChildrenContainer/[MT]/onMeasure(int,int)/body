{
  int ownMaxHeight=mMaxNotificationHeight;
  int heightMode=MeasureSpec.getMode(heightMeasureSpec);
  boolean hasFixedHeight=heightMode == MeasureSpec.EXACTLY;
  boolean isHeightLimited=heightMode == MeasureSpec.AT_MOST;
  if (hasFixedHeight || isHeightLimited) {
    int size=MeasureSpec.getSize(heightMeasureSpec);
    ownMaxHeight=Math.min(ownMaxHeight,size);
  }
  int newHeightSpec=MeasureSpec.makeMeasureSpec(ownMaxHeight,MeasureSpec.AT_MOST);
  int dividerHeightSpec=MeasureSpec.makeMeasureSpec(mDividerHeight,MeasureSpec.EXACTLY);
  int collapseButtonHeightSpec=MeasureSpec.makeMeasureSpec(mCollapseButtonHeight,MeasureSpec.EXACTLY);
  mCollapseButton.measure(widthMeasureSpec,collapseButtonHeightSpec);
  mCollapseDivider.measure(widthMeasureSpec,dividerHeightSpec);
  int height=mCollapseButtonHeight;
  int childCount=mChildren.size();
  boolean firstChild=true;
  for (int i=0; i < childCount; i++) {
    View child=mChildren.get(i);
    if (child.getVisibility() == View.GONE) {
      continue;
    }
    child.measure(widthMeasureSpec,newHeightSpec);
    height+=child.getMeasuredHeight();
    if (!firstChild) {
      View divider=mDividers.get(i - 1);
      divider.measure(widthMeasureSpec,dividerHeightSpec);
      height+=mChildPadding;
    }
 else {
      firstChild=false;
    }
  }
  int width=MeasureSpec.getSize(widthMeasureSpec);
  height=hasFixedHeight ? ownMaxHeight : isHeightLimited ? Math.min(ownMaxHeight,height) : height;
  setMeasuredDimension(width,height);
}
