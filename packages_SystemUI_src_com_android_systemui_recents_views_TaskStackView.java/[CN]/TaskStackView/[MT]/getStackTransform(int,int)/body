{
  TaskViewTransform transform=new TaskViewTransform();
  if (indexInStack < 0)   return transform;
  int numPeekCards=Constants.Values.TaskStackView.StackPeekNumCards;
  float overlapHeight=Constants.Values.TaskStackView.StackOverlapPct * mTaskRect.height();
  float peekHeight=Constants.Values.TaskStackView.StackPeekHeightPct * mStackRect.height();
  float t=((indexInStack * overlapHeight) - stackScroll) / overlapHeight;
  float boundedT=Math.max(t,-(numPeekCards + 1));
  int numFrontScaledCards=3;
  float minScale=Constants.Values.TaskStackView.StackPeekMinScale;
  float scaleRange=1f - minScale;
  float scaleInc=scaleRange / (numPeekCards + numFrontScaledCards);
  float scale=Math.max(minScale,Math.min(1f,minScale + ((boundedT + (numPeekCards + 1)) * scaleInc)));
  float scaleYOffset=((1f - scale) * mTaskRect.height()) / 2;
  transform.scale=scale;
  if (boundedT < 0f) {
    transform.translationY=(int)((Math.max(-numPeekCards,boundedT) / numPeekCards) * peekHeight - scaleYOffset);
  }
 else {
    transform.translationY=(int)(boundedT * overlapHeight - scaleYOffset);
  }
  RecentsConfiguration config=RecentsConfiguration.getInstance();
  int minZ=config.taskViewTranslationZMinPx;
  int incZ=config.taskViewTranslationZIncrementPx;
  transform.translationZ=(int)Math.max(minZ,minZ + ((boundedT + numPeekCards) * incZ));
  transform.dismissAlpha=Math.max(-1f,Math.min(0f,t + 1)) + 1f;
  transform.rect.set(mTaskRect);
  if (t < -(numPeekCards + 1)) {
    transform.visible=false;
  }
 else {
    transform.rect.offset(0,transform.translationY);
    Utilities.scaleRectAboutCenter(transform.rect,transform.scale);
    transform.visible=Rect.intersects(mRect,transform.rect);
  }
  transform.t=t;
  return transform;
}
