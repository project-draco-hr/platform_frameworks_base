{
  if (event.dropTarget instanceof TaskStack.DockState) {
    mLayoutAlgorithm.clearUnfocusedTaskOverrides();
    return;
  }
  boolean isFreeformTask=event.task.isFreeformTask();
  boolean hasChangedStacks=(!isFreeformTask && event.dropTarget == mFreeformWorkspaceDropTarget) || (isFreeformTask && event.dropTarget == mStackDropTarget);
  if (hasChangedStacks) {
    if (event.dropTarget == mFreeformWorkspaceDropTarget) {
      mStack.moveTaskToStack(event.task,FREEFORM_WORKSPACE_STACK_ID);
    }
 else     if (event.dropTarget == mStackDropTarget) {
      mStack.moveTaskToStack(event.task,FULLSCREEN_WORKSPACE_STACK_ID);
    }
    updateLayoutAlgorithm(true);
    event.addPostAnimationCallback(new Runnable(){
      @Override public void run(){
        SystemServicesProxy ssp=Recents.getSystemServices();
        ssp.moveTaskToStack(event.task.key.id,event.task.key.stackId);
      }
    }
);
  }
  int x=(int)event.taskView.getTranslationX();
  int y=(int)event.taskView.getTranslationY();
  Rect taskViewRect=new Rect(event.taskView.getLeft(),event.taskView.getTop(),event.taskView.getRight(),event.taskView.getBottom());
  taskViewRect.offset(x,y);
  event.taskView.setTranslationX(0);
  event.taskView.setTranslationY(0);
  event.taskView.setLeftTopRightBottom(taskViewRect.left,taskViewRect.top,taskViewRect.right,taskViewRect.bottom);
  mLayoutAlgorithm.getStackTransform(event.task,getScroller().getStackScroll(),mTmpTransform,null);
  event.getAnimationTrigger().increment();
  relayoutTaskViews(new AnimationProps(DEFAULT_SYNC_STACK_DURATION,Interpolators.FAST_OUT_SLOW_IN));
  updateTaskViewToTransform(event.taskView,mTmpTransform,new AnimationProps(DEFAULT_SYNC_STACK_DURATION,Interpolators.FAST_OUT_SLOW_IN,event.getAnimationTrigger().decrementOnAnimationEnd()));
  removeIgnoreTask(event.task);
}
