{
  if (Console.Enabled) {
    Console.log(Constants.Log.UI.Focus,"[TaskStackView|focusTask]","" + taskIndex);
  }
  if (0 <= taskIndex && taskIndex < mStack.getTaskCount()) {
    mFocusedTaskIndex=taskIndex;
    Task t=mStack.getTasks().get(taskIndex);
    TaskView tv=getChildViewForTask(t);
    Runnable postScrollRunnable=null;
    if (tv != null) {
      tv.setFocusedTask();
      if (Console.Enabled) {
        Console.log(Constants.Log.UI.Focus,"[TaskStackView|focusTask]","Requesting focus");
      }
    }
 else {
      postScrollRunnable=new Runnable(){
        @Override public void run(){
          Task t=mStack.getTasks().get(mFocusedTaskIndex);
          TaskView tv=getChildViewForTask(t);
          if (tv != null) {
            tv.setFocusedTask();
            if (Console.Enabled) {
              Console.log(Constants.Log.UI.Focus,"[TaskStackView|focusTask]","Requesting focus after scroll animation");
            }
          }
        }
      }
;
    }
    if (scrollToNewPosition) {
      int newScroll=Math.max(mMinScroll,Math.min(mMaxScroll,getStackScrollForTaskIndex(taskIndex)));
      animateScroll(getStackScroll(),newScroll,postScrollRunnable);
    }
 else {
      if (postScrollRunnable != null) {
        postScrollRunnable.run();
      }
    }
  }
}
