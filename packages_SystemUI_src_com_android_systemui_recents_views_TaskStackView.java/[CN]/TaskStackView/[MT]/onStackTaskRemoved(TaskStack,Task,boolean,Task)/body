{
  if (mFocusedTask == removedTask) {
    resetFocusedTask(removedTask);
  }
  if (!removedTask.isFreeformTask()) {
    TaskView tv=getChildViewForTask(removedTask);
    if (tv != null) {
      mViewPool.returnViewToPool(tv);
    }
    Task anchorTask=mStack.getStackFrontMostTask();
    float prevAnchorTaskScroll=0;
    if (anchorTask != null) {
      prevAnchorTaskScroll=mLayoutAlgorithm.getStackScrollForTask(anchorTask);
    }
    updateLayout(true);
    if (wasFrontMostTask) {
      mStackScroller.setStackScroll(mLayoutAlgorithm.mMaxScrollP);
    }
 else     if (anchorTask != null) {
      float anchorTaskScroll=mLayoutAlgorithm.getStackScrollForTask(anchorTask);
      float stackScrollOffset=(anchorTaskScroll - prevAnchorTaskScroll);
      if (mLayoutAlgorithm.getFocusState() != TaskStackLayoutAlgorithm.STATE_FOCUSED) {
        stackScrollOffset/=2;
      }
      mStackScroller.setStackScroll(mStackScroller.getStackScroll() + stackScrollOffset);
      mStackScroller.boundScroll();
    }
  }
 else {
    TaskView tv=getChildViewForTask(removedTask);
    if (tv != null) {
      mViewPool.returnViewToPool(tv);
    }
    updateLayout(true);
  }
  updateTaskViewsToLayout(new TaskViewAnimation(DEFAULT_SYNC_STACK_DURATION,mFastOutSlowInInterpolator));
  if (mScreenPinningEnabled && newFrontMostTask != null) {
    TaskView frontTv=getChildViewForTask(newFrontMostTask);
    if (frontTv != null) {
      frontTv.showActionButton(true,DEFAULT_SYNC_STACK_DURATION);
    }
  }
  if (mStack.getTaskCount() == 0) {
    EventBus.getDefault().send(new AllTaskViewsDismissedEvent());
  }
}
