{
  int offscreenY=mLayoutAlgorithm.mStackRect.bottom;
  Task launchTargetTask=null;
  List<TaskView> taskViews=getTaskViews();
  int taskViewCount=taskViews.size();
  for (int i=taskViewCount - 1; i >= 0; i--) {
    TaskView tv=taskViews.get(i);
    Task task=tv.getTask();
    if (task.isLaunchTarget) {
      launchTargetTask=task;
      break;
    }
  }
  for (int i=taskViewCount - 1; i >= 0; i--) {
    TaskView tv=taskViews.get(i);
    Task task=tv.getTask();
    boolean occludesLaunchTarget=(launchTargetTask != null) && launchTargetTask.group.isTaskAboveTask(task,launchTargetTask);
    tv.prepareEnterRecentsAnimation(task.isLaunchTarget,occludesLaunchTarget,offscreenY);
  }
  if (mStartEnterAnimationRequestedAfterLayout) {
    startEnterRecentsAnimation(mStartEnterAnimationContext);
    mStartEnterAnimationRequestedAfterLayout=false;
    mStartEnterAnimationContext=null;
  }
  if (!Constants.DebugFlags.App.EnableFastToggleRecents && launchTargetTask != null) {
    setFocusedTask(mStack.indexOfTask(launchTargetTask),false,false,false);
  }
 else {
    RecentsConfiguration config=Recents.getConfiguration();
    RecentsActivityLaunchState launchState=config.getLaunchState();
    int taskOffset=launchState.launchedFromHome ? -1 : -2;
    setFocusedTask(mStack.getTaskCount() + taskOffset,false,false,false);
  }
  mUIDozeTrigger.startDozing();
}
