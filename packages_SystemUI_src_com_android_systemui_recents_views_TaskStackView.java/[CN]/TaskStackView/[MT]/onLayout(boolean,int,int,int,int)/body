{
  if (Console.Enabled) {
    Console.log(Constants.Log.UI.MeasureAndLayout,"[TaskStackView|layout]","" + new Rect(left,top,right,bottom),Console.AnsiGreen);
  }
  if (Constants.Log.UI.MeasureAndLayout) {
    Console.log("  [TaskStack|fullRect] " + mRect);
    Console.log("  [TaskStack|stackRect] " + mStackRect);
    Console.log("  [TaskStack|stackRectSansPeek] " + mStackRectSansPeek);
    Console.log("  [TaskStack|taskRect] " + mTaskRect);
  }
  int childCount=getChildCount();
  for (int i=0; i < childCount; i++) {
    TaskView t=(TaskView)getChildAt(i);
    t.layout(mTaskRect.left,mStackRectSansPeek.top,mTaskRect.right,mStackRectSansPeek.top + mTaskRect.height());
  }
  if (mAwaitingFirstLayout) {
    mAwaitingFirstLayout=false;
    int offsetTopAlign=-mTaskRect.top;
    int offscreenY=mRect.bottom - (mTaskRect.top - mRect.top);
    for (int i=childCount - 1; i >= 0; i--) {
      TaskView tv=(TaskView)getChildAt(i);
      tv.prepareAnimateEnterRecents((i == (getChildCount() - 1)),offsetTopAlign,offscreenY,mTaskRect);
    }
    if (mStartEnterAnimationRequestedAfterLayout) {
      startOnEnterAnimation(mStartEnterAnimationContext);
      mStartEnterAnimationRequestedAfterLayout=false;
      mStartEnterAnimationContext=null;
    }
    if (mConfig.launchedWithAltTab) {
      focusTask(Math.max(0,mStack.getTaskCount() - 2),false);
    }
  }
}
