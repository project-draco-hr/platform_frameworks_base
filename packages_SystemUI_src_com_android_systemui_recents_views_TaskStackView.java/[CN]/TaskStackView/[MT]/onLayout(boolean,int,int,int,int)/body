{
  int childCount=getChildCount();
  for (int i=0; i < childCount; i++) {
    TaskView t=(TaskView)getChildAt(i);
    t.layout(mStackAlgorithm.mTaskRect.left,mStackAlgorithm.mStackRectSansPeek.top,mStackAlgorithm.mTaskRect.right,mStackAlgorithm.mStackRectSansPeek.top + mStackAlgorithm.mTaskRect.height() + mConfig.taskViewLockToAppButtonHeight);
  }
  if (mAwaitingFirstLayout) {
    mAwaitingFirstLayout=false;
    ArrayList<Task> tasks=mStack.getTasks();
    Task targetTask=null;
    int targetTaskId=mConfig.launchedToTaskId;
    if (targetTaskId != -1) {
      int taskCount=tasks.size();
      for (int i=0; i < taskCount; i++) {
        Task t=tasks.get(i);
        if (t.key.id == targetTaskId) {
          targetTask=t;
          break;
        }
      }
    }
    int offsetTopAlign=-mStackAlgorithm.mTaskRect.top;
    int offscreenY=mStackAlgorithm.mRect.bottom - (mStackAlgorithm.mTaskRect.top - mStackAlgorithm.mRect.top);
    for (int i=childCount - 1; i >= 0; i--) {
      TaskView tv=(TaskView)getChildAt(i);
      tv.prepareEnterRecentsAnimation(tv.getTask() == targetTask,offsetTopAlign,offscreenY);
    }
    if (mStartEnterAnimationRequestedAfterLayout) {
      startEnterRecentsAnimation(mStartEnterAnimationContext);
      mStartEnterAnimationRequestedAfterLayout=false;
      mStartEnterAnimationContext=null;
    }
    if (mConfig.launchedWithAltTab) {
      focusTask(Math.max(0,mStack.getTaskCount() - 2),false);
    }
  }
}
