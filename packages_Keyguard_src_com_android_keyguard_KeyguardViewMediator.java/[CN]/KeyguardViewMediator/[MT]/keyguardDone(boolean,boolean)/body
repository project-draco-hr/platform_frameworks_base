{
  mKeyguardDonePending=false;
synchronized (this) {
    EventLog.writeEvent(70000,2);
    if (DEBUG)     Log.d(TAG,"keyguardDone(" + authenticated + ")");
    Message msg=mHandler.obtainMessage(KEYGUARD_DONE);
    msg.arg1=wakeup ? 1 : 0;
    mHandler.sendMessage(msg);
    if (authenticated) {
      mUpdateMonitor.clearFailedUnlockAttempts();
    }
    if (mExitSecureCallback != null) {
      try {
        mExitSecureCallback.onKeyguardExitResult(authenticated);
      }
 catch (      RemoteException e) {
        Slog.w(TAG,"Failed to call onKeyguardExitResult(" + authenticated + ")",e);
      }
      mExitSecureCallback=null;
      if (authenticated) {
        mExternallyEnabled=true;
        mNeedToReshowWhenReenabled=false;
      }
    }
  }
}
