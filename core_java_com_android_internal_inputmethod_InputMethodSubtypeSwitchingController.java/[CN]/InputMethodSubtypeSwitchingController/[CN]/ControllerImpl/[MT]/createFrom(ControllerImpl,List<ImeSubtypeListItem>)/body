{
  DynamicRotationList switchingAwareRotationList=null;
{
    final List<ImeSubtypeListItem> switchingAwareImeSubtypes=filterImeSubtypeList(sortedEnabledItems,true);
    if (currentInstance != null && currentInstance.mSwitchingAwareRotationList != null && Objects.equals(currentInstance.mSwitchingAwareRotationList.mImeSubtypeList,switchingAwareImeSubtypes)) {
      switchingAwareRotationList=currentInstance.mSwitchingAwareRotationList;
    }
    if (switchingAwareRotationList == null) {
      switchingAwareRotationList=new DynamicRotationList(switchingAwareImeSubtypes);
    }
  }
  StaticRotationList switchingUnawareRotationList=null;
{
    final List<ImeSubtypeListItem> switchingUnawareImeSubtypes=filterImeSubtypeList(sortedEnabledItems,false);
    if (currentInstance != null && currentInstance.mSwitchingUnawareRotationList != null && Objects.equals(currentInstance.mSwitchingUnawareRotationList.mImeSubtypeList,switchingUnawareImeSubtypes)) {
      switchingUnawareRotationList=currentInstance.mSwitchingUnawareRotationList;
    }
    if (switchingUnawareRotationList == null) {
      switchingUnawareRotationList=new StaticRotationList(switchingUnawareImeSubtypes);
    }
  }
  return new ControllerImpl(switchingAwareRotationList,switchingUnawareRotationList);
}
