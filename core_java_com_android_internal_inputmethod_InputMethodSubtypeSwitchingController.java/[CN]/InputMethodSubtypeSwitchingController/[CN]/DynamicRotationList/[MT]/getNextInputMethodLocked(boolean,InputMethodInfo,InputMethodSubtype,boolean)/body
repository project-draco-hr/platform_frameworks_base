{
  int currentUsageRank=getUsageRank(imi,subtype);
  if (currentUsageRank < 0) {
    if (DEBUG) {
      Slog.d(TAG,"IME/subtype is not found: " + imi.getId() + ", "+ subtype);
    }
    return null;
  }
  final int N=mUsageHistoryOfSubtypeListItemIndex.length;
  for (int i=1; i < N; i++) {
    final int offset=forward ? i : N - i;
    final int subtypeListItemRank=(currentUsageRank + offset) % N;
    final int subtypeListItemIndex=mUsageHistoryOfSubtypeListItemIndex[subtypeListItemRank];
    final ImeSubtypeListItem subtypeListItem=mImeSubtypeList.get(subtypeListItemIndex);
    if (onlyCurrentIme && !imi.equals(subtypeListItem.mImi)) {
      continue;
    }
    return subtypeListItem;
  }
  return null;
}
