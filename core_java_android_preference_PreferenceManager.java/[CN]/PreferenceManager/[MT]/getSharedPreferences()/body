{
  if (mSharedPreferences == null) {
    final Context storageContext;
switch (mStorage) {
case STORAGE_DEVICE_ENCRYPTED:
      storageContext=mContext.createDeviceEncryptedStorageContext();
    break;
case STORAGE_CREDENTIAL_ENCRYPTED:
  storageContext=mContext.createCredentialEncryptedStorageContext();
break;
default :
storageContext=mContext;
break;
}
mSharedPreferences=storageContext.getSharedPreferences(mSharedPreferencesName,mSharedPreferencesMode);
}
return mSharedPreferences;
}
