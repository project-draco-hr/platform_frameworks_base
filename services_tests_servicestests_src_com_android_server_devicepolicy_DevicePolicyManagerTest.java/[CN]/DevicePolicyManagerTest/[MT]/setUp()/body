{
  super.setUp();
  mContext=getContext();
  when(mContext.packageManager.hasSystemFeature(eq(PackageManager.FEATURE_DEVICE_ADMIN))).thenReturn(true);
  LocalServices.removeServiceForTest(DevicePolicyManagerInternal.class);
  dpms=new DevicePolicyManagerServiceTestable(mContext,dataDir);
  dpm=new DevicePolicyManagerTestable(mContext,dpms);
  admin1=new ComponentName(mRealTestContext,DummyDeviceAdmins.Admin1.class);
  admin2=new ComponentName(mRealTestContext,DummyDeviceAdmins.Admin2.class);
  admin3=new ComponentName(mRealTestContext,DummyDeviceAdmins.Admin3.class);
  setUpPackageManagerForAdmin(admin1,DpmMockContext.CALLER_UID);
  setUpPackageManagerForAdmin(admin2,DpmMockContext.CALLER_UID);
  setUpPackageManagerForAdmin(admin3,DpmMockContext.CALLER_UID);
  setUpApplicationInfo(PackageManager.COMPONENT_ENABLED_STATE_DISABLED_UNTIL_USED,DpmMockContext.CALLER_UID);
  setUpPackageInfo();
  setUpUserManager();
}
