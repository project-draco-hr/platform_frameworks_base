{
  when(mContext.ipackageManager.hasSystemFeature(PackageManager.FEATURE_MANAGED_USERS,0)).thenReturn(true);
  when(mContext.userManagerForMock.isSplitSystemUser()).thenReturn(false);
  when(mContext.userManager.canAddMoreManagedProfiles(UserHandle.USER_SYSTEM,true)).thenReturn(true);
  setUserSetupCompleteForUser(false,UserHandle.USER_SYSTEM);
  mContext.binder.callingUid=DpmMockContext.CALLER_SYSTEM_USER_UID;
  assertProvisioningAllowed(DevicePolicyManager.ACTION_PROVISION_MANAGED_DEVICE,true);
  assertProvisioningAllowed(DevicePolicyManager.ACTION_PROVISION_MANAGED_PROFILE,true);
  assertProvisioningAllowed(DevicePolicyManager.ACTION_PROVISION_MANAGED_SHAREABLE_DEVICE,false);
  assertProvisioningAllowed(DevicePolicyManager.ACTION_PROVISION_MANAGED_USER,false);
}
