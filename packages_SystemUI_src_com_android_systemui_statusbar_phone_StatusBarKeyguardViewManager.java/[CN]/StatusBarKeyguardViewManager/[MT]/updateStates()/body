{
  int vis=mContainer.getSystemUiVisibility();
  boolean showing=mShowing;
  boolean occluded=mOccluded;
  boolean bouncerShowing=mBouncer.isShowing();
  boolean bouncerDismissible=!mBouncer.isFullscreenBouncer();
  boolean deferScrimFadeOut=mDeferScrimFadeOut;
  if ((bouncerDismissible || !showing) != (mLastBouncerDismissible || !mLastShowing) || mFirstUpdate) {
    if (bouncerDismissible || !showing) {
      mContainer.setSystemUiVisibility(vis & ~View.STATUS_BAR_DISABLE_BACK);
    }
 else {
      mContainer.setSystemUiVisibility(vis | View.STATUS_BAR_DISABLE_BACK);
    }
  }
  boolean navBarVisible=!deferScrimFadeOut && (!(showing && !occluded) || bouncerShowing);
  boolean lastNavBarVisible=!mLastDeferScrimFadeOut && (!(mLastShowing && !mLastOccluded) || mLastBouncerShowing);
  if (navBarVisible != lastNavBarVisible || mFirstUpdate) {
    if (mPhoneStatusBar.getNavigationBarView() != null) {
      if (navBarVisible) {
        long delay=getNavBarShowDelay();
        if (delay == 0) {
          mMakeNavigationBarVisibleRunnable.run();
        }
 else {
          mContainer.postOnAnimationDelayed(mMakeNavigationBarVisibleRunnable,delay);
        }
      }
 else {
        mContainer.removeCallbacks(mMakeNavigationBarVisibleRunnable);
        mPhoneStatusBar.getNavigationBarView().setVisibility(View.GONE);
      }
    }
  }
  if (bouncerShowing != mLastBouncerShowing || mFirstUpdate) {
    mStatusBarWindowManager.setBouncerShowing(bouncerShowing);
    mPhoneStatusBar.setBouncerShowing(bouncerShowing);
    mScrimController.setBouncerShowing(bouncerShowing);
  }
  KeyguardUpdateMonitor updateMonitor=KeyguardUpdateMonitor.getInstance(mContext);
  if ((showing && !occluded) != (mLastShowing && !mLastOccluded) || mFirstUpdate) {
    updateMonitor.sendKeyguardVisibilityChanged(showing && !occluded);
  }
  if (bouncerShowing != mLastBouncerShowing || mFirstUpdate) {
    updateMonitor.sendKeyguardBouncerChanged(bouncerShowing);
  }
  mFirstUpdate=false;
  mLastShowing=showing;
  mLastOccluded=occluded;
  mLastDeferScrimFadeOut=deferScrimFadeOut;
  mLastBouncerShowing=bouncerShowing;
  mLastBouncerDismissible=bouncerDismissible;
  mPhoneStatusBar.onKeyguardViewManagerStatesUpdated();
}
