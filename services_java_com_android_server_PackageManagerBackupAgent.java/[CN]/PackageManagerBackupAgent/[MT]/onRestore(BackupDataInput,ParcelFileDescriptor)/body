{
  List<ApplicationInfo> restoredApps=new ArrayList<ApplicationInfo>();
  HashMap<String,Signature[]> sigMap=new HashMap<String,Signature[]>();
  while (data.readNextHeader()) {
    int dataSize=data.getDataSize();
    byte[] buf=new byte[dataSize];
    data.readEntityData(buf,0,dataSize);
    Signature[] sigs=unflattenSignatureArray(buf);
    String pkg=data.getKey();
    if (DEBUG) {
      CRC32 crc=new CRC32();
      crc.update(buf);
      Log.i(TAG,"- unflat sig array for " + pkg + " : "+ crc.getValue());
    }
    ApplicationInfo app=new ApplicationInfo();
    app.packageName=pkg;
    restoredApps.add(app);
    sigMap.put(pkg,sigs);
  }
  mRestoredSignatures=sigMap;
}
