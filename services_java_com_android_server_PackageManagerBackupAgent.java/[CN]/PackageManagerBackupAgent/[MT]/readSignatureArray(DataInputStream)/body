{
  try {
    int num;
    try {
      num=in.readInt();
    }
 catch (    EOFException e) {
      Slog.w(TAG,"Read empty signature block");
      return null;
    }
    if (DEBUG)     Slog.v(TAG," ... unflatten read " + num);
    if (num > 20) {
      Slog.e(TAG,"Suspiciously large sig count in restore data; aborting");
      throw new IllegalStateException("Bad restore state");
    }
    Signature[] sigs=new Signature[num];
    for (int i=0; i < num; i++) {
      int len=in.readInt();
      byte[] flatSig=new byte[len];
      in.read(flatSig);
      sigs[i]=new Signature(flatSig);
    }
    return sigs;
  }
 catch (  IOException e) {
    Slog.e(TAG,"Unable to read signatures");
    return null;
  }
}
