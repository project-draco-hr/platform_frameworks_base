{
  Signature[] sigs=null;
  try {
    int num=in.readInt();
    Log.v(TAG," ... unflatten read " + num);
    if (num > 20) {
      Log.e(TAG,"Suspiciously large sig count in restore data; aborting");
      throw new IllegalStateException("Bad restore state");
    }
    sigs=new Signature[num];
    for (int i=0; i < num; i++) {
      int len=in.readInt();
      byte[] flatSig=new byte[len];
      in.read(flatSig);
      sigs[i]=new Signature(flatSig);
    }
  }
 catch (  EOFException e) {
    if (sigs == null) {
      Log.w(TAG,"Empty signature block found");
    }
  }
catch (  IOException e) {
    Log.d(TAG,"Unable to unflatten sigs");
    return null;
  }
  return sigs;
}
