{
  reset();
  if (!(key instanceof KeyStoreSecretKey)) {
    throw new InvalidKeyException("Unsupported key: " + ((key != null) ? key.getClass().getName() : "null"));
  }
  mKey=(KeyStoreSecretKey)key;
  mRng=random;
  mIv=null;
  mFirstOperationInitiated=false;
  if ((opmode != Cipher.ENCRYPT_MODE) && (opmode != Cipher.DECRYPT_MODE)) {
    throw new UnsupportedOperationException("Only ENCRYPT and DECRYPT modes supported. Mode: " + opmode);
  }
  mEncrypting=opmode == Cipher.ENCRYPT_MODE;
}
