{
  ensureKeystoreOperationInitialized();
  if (inputLen == 0) {
    return null;
  }
  byte[] output;
  try {
    output=mMainDataStreamer.update(input,inputOffset,inputLen);
  }
 catch (  KeymasterException e) {
    throw new CryptoOperationException("Keystore operation failed",e);
  }
  if (output.length == 0) {
    return null;
  }
  return output;
}
