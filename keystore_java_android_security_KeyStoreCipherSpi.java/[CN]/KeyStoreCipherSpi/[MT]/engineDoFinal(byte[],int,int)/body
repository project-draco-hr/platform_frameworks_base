{
  if (mCachedException != null) {
    throw (IllegalBlockSizeException)new IllegalBlockSizeException().initCause(mCachedException);
  }
  try {
    ensureKeystoreOperationInitialized();
  }
 catch (  InvalidKeyException|InvalidAlgorithmParameterException e) {
    throw (IllegalBlockSizeException)new IllegalBlockSizeException().initCause(e);
  }
  byte[] output;
  try {
    output=mMainDataStreamer.doFinal(input,inputOffset,inputLen);
  }
 catch (  KeyStoreException e) {
switch (e.getErrorCode()) {
case KeymasterDefs.KM_ERROR_INVALID_INPUT_LENGTH:
      throw new IllegalBlockSizeException();
case KeymasterDefs.KM_ERROR_INVALID_ARGUMENT:
    throw new BadPaddingException();
case KeymasterDefs.KM_ERROR_VERIFICATION_FAILED:
  throw new AEADBadTagException();
default :
throw (IllegalBlockSizeException)new IllegalBlockSizeException().initCause(e);
}
}
resetWhilePreservingInitState();
return output;
}
