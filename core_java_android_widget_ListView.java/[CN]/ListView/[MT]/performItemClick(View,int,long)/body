{
  boolean handled=false;
  if (mChoiceMode != CHOICE_MODE_NONE) {
    handled=true;
    if (mChoiceMode == CHOICE_MODE_MULTIPLE) {
      boolean newValue=!mCheckStates.get(position,false);
      mCheckStates.put(position,newValue);
      if (mCheckedIdStates != null && mAdapter.hasStableIds()) {
        if (newValue) {
          mCheckedIdStates.put(mAdapter.getItemId(position),Boolean.TRUE);
        }
 else {
          mCheckedIdStates.delete(mAdapter.getItemId(position));
        }
      }
    }
 else {
      boolean newValue=!mCheckStates.get(position,false);
      if (newValue) {
        mCheckStates.clear();
        mCheckStates.put(position,true);
        if (mCheckedIdStates != null && mAdapter.hasStableIds()) {
          mCheckedIdStates.clear();
          mCheckedIdStates.put(mAdapter.getItemId(position),Boolean.TRUE);
        }
      }
    }
    mDataChanged=true;
    rememberSyncState();
    requestLayout();
  }
  handled|=super.performItemClick(view,position,id);
  return handled;
}
