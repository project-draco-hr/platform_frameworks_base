{
  SQLiteDatabase db=mOpenHelper.getWritableDatabase();
  StringBuilder where=new StringBuilder();
  where.append(Sync.Stats.ACCOUNT + "= ?");
  where.append(" and " + Sync.Stats.ACCOUNT_TYPE + "= ?");
  where.append(" and " + Sync.Stats.AUTHORITY + "= ?");
  Cursor cursor=query(Sync.Stats.CONTENT_URI,Sync.Stats.SYNC_STATS_PROJECTION,where.toString(),new String[]{account.mName,account.mType,authority},null);
  try {
    long id;
    if (cursor.moveToFirst()) {
      id=cursor.getLong(cursor.getColumnIndexOrThrow(Sync.Stats._ID));
    }
 else {
      ContentValues values=new ContentValues();
      values.put(Sync.Stats.ACCOUNT,account.mName);
      values.put(Sync.Stats.ACCOUNT_TYPE,account.mType);
      values.put(Sync.Stats.AUTHORITY,authority);
      id=db.insert("stats",null,values);
    }
    return id;
  }
  finally {
    cursor.close();
  }
}
