{
  SQLiteDatabase db=mOpenHelper.getWritableDatabase();
  db.beginTransaction();
  try {
    Account account;
    String authority;
    Cursor c=db.query("pending",new String[]{Sync.Pending.ACCOUNT,Sync.Pending.ACCOUNT_TYPE,Sync.Pending.AUTHORITY},"_id=" + rowId,null,null,null,null);
    try {
      if (c.getCount() != 1) {
        return 0;
      }
      c.moveToNext();
      String accountName=c.getString(0);
      String accountType=c.getString(1);
      account=new Account(accountName,accountType);
      authority=c.getString(2);
    }
  finally {
      c.close();
    }
    db.delete("pending","_id=" + rowId,null);
    final String[] accountAuthorityWhereArgs=new String[]{account.mName,account.mType,authority};
    boolean isPending=0 < DatabaseUtils.longForQuery(db,"SELECT COUNT(*)" + " FROM PENDING" + " WHERE account=? AND account_type=? AND authority=?",accountAuthorityWhereArgs);
    if (!isPending) {
      long statsId=createStatsRowIfNecessary(account,authority);
      db.execSQL("UPDATE status SET pending=0 WHERE stats_id=" + statsId);
    }
    db.setTransactionSuccessful();
    mContext.getContentResolver().notifyChange(Sync.Pending.CONTENT_URI,null);
    if (!isPending) {
      mContext.getContentResolver().notifyChange(Sync.Status.CONTENT_URI,null);
    }
    return 1;
  }
  finally {
    db.endTransaction();
  }
}
