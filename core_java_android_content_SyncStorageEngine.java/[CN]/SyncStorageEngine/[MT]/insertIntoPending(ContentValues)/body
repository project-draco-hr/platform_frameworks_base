{
  SQLiteDatabase db=mOpenHelper.getWritableDatabase();
  try {
    db.beginTransaction();
    long rowId=db.insert("pending",Sync.Pending.ACCOUNT,values);
    if (rowId < 0)     return null;
    String account=values.getAsString(Sync.Pending.ACCOUNT);
    String authority=values.getAsString(Sync.Pending.AUTHORITY);
    long statsId=createStatsRowIfNecessary(account,authority);
    createStatusRowIfNecessary(statsId);
    values.clear();
    values.put(Sync.Status.PENDING,1);
    int numUpdatesStatus=db.update("status",values,"stats_id=" + statsId,null);
    db.setTransactionSuccessful();
    mContext.getContentResolver().notifyChange(Sync.Pending.CONTENT_URI,null);
    if (numUpdatesStatus > 0) {
      mContext.getContentResolver().notifyChange(Sync.Status.CONTENT_URI,null);
    }
    return ContentUris.withAppendedId(Sync.Pending.CONTENT_URI,rowId);
  }
  finally {
    db.endTransaction();
  }
}
