{
  BaseNetworkObserver observer=mock(BaseNetworkObserver.class);
  doReturn(new Binder()).when(observer).asBinder();
  mNMService.registerObserver(observer);
  reset(observer);
  sendMessage("600 Iface added rmnet12");
  expectSoon(observer).interfaceAdded("rmnet12");
  sendMessage("600 Iface removed eth1");
  expectSoon(observer).interfaceRemoved("eth1");
  sendMessage("607 Iface removed eth1");
  sendMessage("600 Iface borked lo down");
  sendMessage("600 Iface changed clat4 up again");
  sendMessage("600 Iface changed clat4 up");
  expectSoon(observer).interfaceStatusChanged("clat4",true);
  sendMessage("600 Iface linkstate rmnet0 down");
  expectSoon(observer).interfaceLinkStateChanged("rmnet0",false);
  sendMessage("600 IFACE linkstate clat4 up");
  sendMessage("601 limit alert data rmnet_usb0");
  expectSoon(observer).limitReached("data","rmnet_usb0");
  sendMessage("601 invalid alert data rmnet0");
  sendMessage("601 limit increased data rmnet0");
  sendMessage("613 IfaceClass active rmnet0");
  expectSoon(observer).interfaceClassDataActivityChanged("rmnet0",true,0);
  sendMessage("613 IfaceClass active rmnet0 1234");
  expectSoon(observer).interfaceClassDataActivityChanged("rmnet0",true,1234);
  sendMessage("613 IfaceClass idle eth0");
  expectSoon(observer).interfaceClassDataActivityChanged("eth0",false,0);
  sendMessage("613 IfaceClass idle eth0 1234");
  expectSoon(observer).interfaceClassDataActivityChanged("eth0",false,1234);
  sendMessage("613 IfaceClass reallyactive rmnet0 1234");
  expectSoon(observer).interfaceClassDataActivityChanged("rmnet0",false,1234);
  sendMessage("613 InterfaceClass reallyactive rmnet0");
  sendMessage("614 Address updated fe80::1/64 wlan0 128 253");
  expectSoon(observer).addressUpdated("wlan0",new LinkAddress("fe80::1/64",128,253));
  sendMessage("614 Address added fe80::1/64 wlan0 128 253");
  expectSoon(observer).addressRemoved("wlan0",new LinkAddress("fe80::1/64",128,253));
  sendMessage("614 Address removed 2001:db8::1/64 wlan0 1 0");
  expectSoon(observer).addressRemoved("wlan0",new LinkAddress("2001:db8::1/64",1,0));
  sendMessage("614 Address removed 2001:db8::1/64 wlan0 1");
  sendMessage("666 Address removed 2001:db8::1/64 wlan0 1 0");
  sendMessage("615 DnsInfo servers rmnet_usb0 3600 2001:db8::1");
  expectSoon(observer).interfaceDnsServerInfo("rmnet_usb0",3600,new String[]{"2001:db8::1"});
  sendMessage("615 DnsInfo servers wlan0 14400 2001:db8::1,2001:db8::2");
  expectSoon(observer).interfaceDnsServerInfo("wlan0",14400,new String[]{"2001:db8::1","2001:db8::2"});
  sendMessage("615 DnsInfo servers wlan0 -3600 ::1");
  expectSoon(observer).interfaceDnsServerInfo("wlan0",-3600,new String[]{"::1"});
  sendMessage("615 DnsInfo servers wlan0 SIXHUNDRED ::1");
  sendMessage("615 DnsInfo servers wlan0 2001:db8::1");
  sendMessage("615 DnsInfo servers wlan0 3600");
  sendMessage("615 DnsInfo servers 3600 wlan0 2001:db8::1,2001:db8::2");
  sendMessage("615 DnsInfo wlan0 7200 2001:db8::1,2001:db8::2");
  sendMessage("666 DnsInfo servers wlan0 5400 2001:db8::1");
  sendMessage("615 DnsInfo servers wlan0 600 ,::,,foo,::1,");
  expectSoon(observer).interfaceDnsServerInfo("wlan0",600,new String[]{"","::","","foo","::1"});
  verifyNoMoreInteractions(observer);
}
