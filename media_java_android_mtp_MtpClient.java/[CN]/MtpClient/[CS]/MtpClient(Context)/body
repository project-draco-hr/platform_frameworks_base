{
  mContext=context;
  mUsbManager=(UsbManager)context.getSystemService(Context.USB_SERVICE);
  IntentFilter filter=new IntentFilter();
  filter.addAction(UsbManager.ACTION_USB_DEVICE_ATTACHED);
  filter.addAction(UsbManager.ACTION_USB_DEVICE_DETACHED);
  context.registerReceiver(mUsbReceiver,filter);
  for (  UsbDevice usbDevice : mUsbManager.getDeviceList().values()) {
    MtpDevice mtpDevice=getDeviceLocked(usbDevice.getDeviceName());
    if (mtpDevice == null) {
      mtpDevice=openDevice(usbDevice);
    }
    if (mtpDevice != null) {
      mDeviceList.add(mtpDevice);
    }
  }
}
