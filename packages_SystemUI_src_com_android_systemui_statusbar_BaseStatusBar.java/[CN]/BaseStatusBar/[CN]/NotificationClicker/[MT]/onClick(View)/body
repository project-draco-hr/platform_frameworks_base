{
  final boolean keyguardShowing=mStatusBarKeyguardViewManager.isShowing();
  dismissKeyguardThenExecute(new OnDismissAction(){
    public boolean onDismiss(){
      if (mIsHeadsUp) {
        mHeadsUpNotificationView.clear();
      }
      AsyncTask.execute(new Runnable(){
        @Override public void run(){
          if (keyguardShowing) {
            try {
              ActivityManagerNative.getDefault().keyguardWaitingForActivityDrawn();
              ActivityManagerNative.getDefault().resumeAppSwitches();
            }
 catch (            RemoteException e) {
            }
          }
          if (mIntent != null) {
            try {
              mIntent.send();
            }
 catch (            PendingIntent.CanceledException e) {
              Log.w(TAG,"Sending contentIntent failed: " + e);
            }
            if (mIntent.isActivity()) {
              overrideActivityPendingAppTransition(keyguardShowing);
            }
          }
          try {
            mBarService.onNotificationClick(mNotificationKey);
          }
 catch (          RemoteException ex) {
          }
        }
      }
);
      animateCollapsePanels(CommandQueue.FLAG_EXCLUDE_NONE,true);
      visibilityChanged(false);
      return mIntent != null && mIntent.isActivity();
    }
  }
);
}
