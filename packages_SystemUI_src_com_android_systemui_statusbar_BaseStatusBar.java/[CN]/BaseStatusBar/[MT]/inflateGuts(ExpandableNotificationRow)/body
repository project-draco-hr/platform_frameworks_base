{
  ViewStub stub=(ViewStub)row.findViewById(R.id.notification_guts_stub);
  if (stub != null) {
    stub.inflate();
  }
  final StatusBarNotification sbn=row.getStatusBarNotification();
  PackageManager pmUser=getPackageManagerForUser(sbn.getUser().getIdentifier());
  row.setTag(sbn.getPackageName());
  final View guts=row.findViewById(R.id.notification_guts);
  final String pkg=sbn.getPackageName();
  String appname=pkg;
  Drawable pkgicon=null;
  int appUid=-1;
  try {
    final ApplicationInfo info=pmUser.getApplicationInfo(pkg,PackageManager.GET_UNINSTALLED_PACKAGES | PackageManager.GET_DISABLED_COMPONENTS);
    if (info != null) {
      appname=String.valueOf(pmUser.getApplicationLabel(info));
      pkgicon=pmUser.getApplicationIcon(info);
      appUid=info.uid;
    }
  }
 catch (  NameNotFoundException e) {
    pkgicon=pmUser.getDefaultActivityIcon();
  }
  ((ImageView)row.findViewById(android.R.id.icon)).setImageDrawable(pkgicon);
  ((DateTimeView)row.findViewById(R.id.timestamp)).setTime(sbn.getPostTime());
  ((TextView)row.findViewById(R.id.pkgname)).setText(appname);
  final View settingsButton=guts.findViewById(R.id.notification_inspect_item);
  final View appSettingsButton=guts.findViewById(R.id.notification_inspect_app_provided_settings);
  if (appUid >= 0) {
    final int appUidF=appUid;
    settingsButton.setOnClickListener(new View.OnClickListener(){
      public void onClick(      View v){
        startAppNotificationSettingsActivity(pkg,appUidF);
      }
    }
);
    final Intent appSettingsQueryIntent=new Intent(Intent.ACTION_MAIN).addCategory(Notification.INTENT_CATEGORY_NOTIFICATION_PREFERENCES).setPackage(pkg);
    List<ResolveInfo> infos=pmUser.queryIntentActivities(appSettingsQueryIntent,0);
    if (infos.size() > 0) {
      appSettingsButton.setVisibility(View.VISIBLE);
      appSettingsButton.setContentDescription(mContext.getResources().getString(R.string.status_bar_notification_app_settings_title,appname));
      final Intent appSettingsLaunchIntent=new Intent(appSettingsQueryIntent).setClassName(pkg,infos.get(0).activityInfo.name);
      appSettingsButton.setOnClickListener(new View.OnClickListener(){
        public void onClick(        View v){
          startAppOwnNotificationSettingsActivity(appSettingsLaunchIntent,sbn.getId(),sbn.getTag(),appUidF);
        }
      }
);
    }
 else {
      appSettingsButton.setVisibility(View.GONE);
    }
  }
 else {
    settingsButton.setVisibility(View.GONE);
    appSettingsButton.setVisibility(View.GONE);
  }
}
