{
  if (!mUseHeadsUp || isDeviceInVrMode()) {
    return false;
  }
  if (mNotificationData.shouldFilterOut(sbn)) {
    if (DEBUG)     Log.d(TAG,"No peeking: filtered notification: " + sbn.getKey());
    return false;
  }
  boolean inUse=mPowerManager.isScreenOn() && (!mStatusBarKeyguardViewManager.isShowing() || mStatusBarKeyguardViewManager.isOccluded()) && !mStatusBarKeyguardViewManager.isInputRestricted();
  try {
    inUse=inUse && !mDreamManager.isDreaming();
  }
 catch (  RemoteException e) {
    Log.d(TAG,"failed to query dream manager",e);
  }
  if (!inUse) {
    if (DEBUG) {
      Log.d(TAG,"No peeking: not in use: " + sbn.getKey());
    }
    return false;
  }
  if (mNotificationData.shouldSuppressScreenOn(sbn.getKey())) {
    if (DEBUG)     Log.d(TAG,"No peeking: suppressed by DND: " + sbn.getKey());
    return false;
  }
  if (entry.hasJustLaunchedFullScreenIntent()) {
    if (DEBUG)     Log.d(TAG,"No peeking: recent fullscreen: " + sbn.getKey());
    return false;
  }
  if (isSnoozedPackage(sbn)) {
    if (DEBUG)     Log.d(TAG,"No peeking: snoozed package: " + sbn.getKey());
    return false;
  }
  if (mNotificationData.getImportance(sbn.getKey()) < IMPORTANCE_HIGH) {
    if (DEBUG)     Log.d(TAG,"No peeking: unimportant notification: " + sbn.getKey());
    return false;
  }
  if (sbn.getNotification().fullScreenIntent != null) {
    if (mAccessibilityManager.isTouchExplorationEnabled()) {
      if (DEBUG)       Log.d(TAG,"No peeking: accessible fullscreen: " + sbn.getKey());
      return false;
    }
 else {
      return true;
    }
  }
  return true;
}
