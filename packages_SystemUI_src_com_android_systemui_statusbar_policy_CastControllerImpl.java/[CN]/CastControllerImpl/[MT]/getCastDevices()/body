{
  final ArraySet<CastDevice> devices=new ArraySet<CastDevice>();
synchronized (mProjectionLock) {
    if (mProjection != null) {
      final CastDevice device=new CastDevice();
      device.id=mProjection.getPackageName();
      device.name=getAppName(mProjection.getPackageName());
      device.description=mContext.getString(R.string.quick_settings_casting);
      device.state=CastDevice.STATE_CONNECTED;
      device.tag=mProjection;
      devices.add(device);
      return devices;
    }
  }
synchronized (mRoutes) {
    for (    RouteInfo route : mRoutes.values()) {
      final CastDevice device=new CastDevice();
      device.id=route.getTag().toString();
      final CharSequence name=route.getName(mContext);
      device.name=name != null ? name.toString() : null;
      final CharSequence description=route.getDescription();
      device.description=description != null ? description.toString() : null;
      device.state=route.isConnecting() ? CastDevice.STATE_CONNECTING : route.isSelected() ? CastDevice.STATE_CONNECTED : CastDevice.STATE_DISCONNECTED;
      device.tag=route;
      devices.add(device);
    }
  }
  return devices;
}
