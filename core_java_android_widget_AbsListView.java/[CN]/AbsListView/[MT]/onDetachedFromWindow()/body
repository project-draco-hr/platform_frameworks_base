{
  super.onDetachedFromWindow();
  dismissPopup();
  mRecycler.clear();
  final ViewTreeObserver treeObserver=getViewTreeObserver();
  if (treeObserver != null) {
    treeObserver.removeOnTouchModeChangeListener(this);
    if (mTextFilterEnabled && mPopup != null) {
      treeObserver.removeGlobalOnLayoutListener(this);
      mGlobalLayoutListenerAddedFilter=false;
    }
  }
  if (mAdapter != null) {
    mAdapter.unregisterDataSetObserver(mDataSetObserver);
    mDataSetObserver=null;
  }
  if (mScrollStrictSpan != null) {
    mScrollStrictSpan.finish();
    mScrollStrictSpan=null;
  }
  if (mFlingStrictSpan != null) {
    mFlingStrictSpan.finish();
    mFlingStrictSpan=null;
  }
}
