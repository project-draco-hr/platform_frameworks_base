{
  int remainingOffset=offset;
  int targetHeight=getHeightForRow(targetRow);
  if (offset < 0) {
    while (targetRow > 0 && remainingOffset < 0) {
      remainingOffset+=targetHeight;
      targetRow--;
      targetHeight=getHeightForRow(targetRow);
    }
  }
 else   if (offset > 0) {
    while (targetRow < getCount() - 1 && remainingOffset > targetHeight) {
      remainingOffset-=targetHeight;
      targetRow++;
      targetHeight=getHeightForRow(targetRow);
    }
  }
  final float targetOffsetRatio;
  if (remainingOffset < 0 || targetHeight == 0) {
    targetOffsetRatio=0;
  }
 else {
    targetOffsetRatio=remainingOffset / (float)targetHeight;
  }
  return targetRow + targetOffsetRatio;
}
