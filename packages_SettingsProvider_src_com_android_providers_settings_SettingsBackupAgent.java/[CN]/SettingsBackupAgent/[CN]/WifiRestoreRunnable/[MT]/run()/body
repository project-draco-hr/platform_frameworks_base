{
  if (restoredSupplicantData != null || restoredWifiConfigFile != null) {
    if (DEBUG_BACKUP) {
      Log.v(TAG,"Starting deferred restore of wifi data");
    }
    final int retainedWifiState=enableWifi(false);
    if (restoredSupplicantData != null) {
      restoreWifiSupplicant(FILE_WIFI_SUPPLICANT,restoredSupplicantData,restoredSupplicantData.length);
      FileUtils.setPermissions(FILE_WIFI_SUPPLICANT,FileUtils.S_IRUSR | FileUtils.S_IWUSR | FileUtils.S_IRGRP| FileUtils.S_IWGRP,Process.myUid(),Process.WIFI_UID);
    }
    if (restoredWifiConfigFile != null) {
      restoreFileData(mWifiConfigFile,restoredWifiConfigFile,restoredWifiConfigFile.length);
    }
    enableWifi(retainedWifiState == WifiManager.WIFI_STATE_ENABLED || retainedWifiState == WifiManager.WIFI_STATE_ENABLING);
  }
}
