{
  while (data.readNextHeader()) {
    final String key=data.getKey();
    final int size=data.getDataSize();
    if (KEY_SYSTEM.equals(key)) {
      restoreSettings(data,Settings.System.CONTENT_URI);
      mSettingsHelper.applyAudioSettings();
    }
 else     if (KEY_SECURE.equals(key)) {
      restoreSettings(data,Settings.Secure.CONTENT_URI);
    }
 else     if (KEY_WIFI_SUPPLICANT.equals(key)) {
      int retainedWifiState=enableWifi(false);
      restoreWifiSupplicant(FILE_WIFI_SUPPLICANT,data);
      FileUtils.setPermissions(FILE_WIFI_SUPPLICANT,FileUtils.S_IRUSR | FileUtils.S_IWUSR | FileUtils.S_IRGRP| FileUtils.S_IWGRP,Process.myUid(),Process.WIFI_UID);
      enableWifi(retainedWifiState == WifiManager.WIFI_STATE_ENABLED || retainedWifiState == WifiManager.WIFI_STATE_ENABLING);
    }
 else     if (KEY_LOCALE.equals(key)) {
      byte[] localeData=new byte[size];
      data.readEntityData(localeData,0,size);
      mSettingsHelper.setLocaleData(localeData);
    }
 else     if (KEY_WIFI_CONFIG.equals(key)) {
      restoreFileData(mWifiConfigFile,data);
    }
 else {
      data.skipEntityData();
    }
  }
}
