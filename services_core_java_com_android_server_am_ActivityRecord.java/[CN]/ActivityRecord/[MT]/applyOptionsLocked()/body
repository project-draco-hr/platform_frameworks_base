{
  if (pendingOptions != null && pendingOptions.getAnimationType() != ActivityOptions.ANIM_SCENE_TRANSITION) {
    final int animationType=pendingOptions.getAnimationType();
switch (animationType) {
case ActivityOptions.ANIM_CUSTOM:
      service.mWindowManager.overridePendingAppTransition(pendingOptions.getPackageName(),pendingOptions.getCustomEnterResId(),pendingOptions.getCustomExitResId(),pendingOptions.getOnAnimationStartListener());
    break;
case ActivityOptions.ANIM_CLIP_REVEAL:
  service.mWindowManager.overridePendingAppTransitionClipReveal(pendingOptions.getStartX(),pendingOptions.getStartY(),pendingOptions.getWidth(),pendingOptions.getHeight());
if (intent.getSourceBounds() == null) {
  intent.setSourceBounds(new Rect(pendingOptions.getStartX(),pendingOptions.getStartY(),pendingOptions.getStartX() + pendingOptions.getWidth(),pendingOptions.getStartY() + pendingOptions.getHeight()));
}
break;
case ActivityOptions.ANIM_SCALE_UP:
service.mWindowManager.overridePendingAppTransitionScaleUp(pendingOptions.getStartX(),pendingOptions.getStartY(),pendingOptions.getWidth(),pendingOptions.getHeight());
if (intent.getSourceBounds() == null) {
intent.setSourceBounds(new Rect(pendingOptions.getStartX(),pendingOptions.getStartY(),pendingOptions.getStartX() + pendingOptions.getWidth(),pendingOptions.getStartY() + pendingOptions.getHeight()));
}
break;
case ActivityOptions.ANIM_THUMBNAIL_SCALE_UP:
case ActivityOptions.ANIM_THUMBNAIL_SCALE_DOWN:
boolean scaleUp=(animationType == ActivityOptions.ANIM_THUMBNAIL_SCALE_UP);
service.mWindowManager.overridePendingAppTransitionThumb(pendingOptions.getThumbnail(),pendingOptions.getStartX(),pendingOptions.getStartY(),pendingOptions.getOnAnimationStartListener(),scaleUp);
if (intent.getSourceBounds() == null) {
intent.setSourceBounds(new Rect(pendingOptions.getStartX(),pendingOptions.getStartY(),pendingOptions.getStartX() + pendingOptions.getThumbnail().getWidth(),pendingOptions.getStartY() + pendingOptions.getThumbnail().getHeight()));
}
break;
case ActivityOptions.ANIM_THUMBNAIL_ASPECT_SCALE_UP:
case ActivityOptions.ANIM_THUMBNAIL_ASPECT_SCALE_DOWN:
final AppTransitionAnimationSpec[] specs=pendingOptions.getAnimSpecs();
if (animationType == ActivityOptions.ANIM_THUMBNAIL_ASPECT_SCALE_DOWN && specs != null) {
service.mWindowManager.overridePendingAppTransitionMultiThumb(specs,pendingOptions.getOnAnimationStartListener(),false);
}
 else {
service.mWindowManager.overridePendingAppTransitionAspectScaledThumb(pendingOptions.getThumbnail(),pendingOptions.getStartX(),pendingOptions.getStartY(),pendingOptions.getWidth(),pendingOptions.getHeight(),pendingOptions.getOnAnimationStartListener(),(animationType == ActivityOptions.ANIM_THUMBNAIL_ASPECT_SCALE_UP));
if (intent.getSourceBounds() == null) {
intent.setSourceBounds(new Rect(pendingOptions.getStartX(),pendingOptions.getStartY(),pendingOptions.getStartX() + pendingOptions.getWidth(),pendingOptions.getStartY() + pendingOptions.getHeight()));
}
}
break;
default :
Slog.e(TAG,"applyOptionsLocked: Unknown animationType=" + animationType);
break;
}
pendingOptions=null;
}
}
