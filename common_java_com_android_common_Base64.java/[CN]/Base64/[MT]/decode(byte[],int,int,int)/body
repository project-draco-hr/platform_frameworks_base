{
  DecoderState state=new DecoderState(flags,new byte[len * 3 / 4]);
  if (!decodeInternal(input,offset,len,state,true)) {
    throw new IllegalArgumentException("bad base-64");
  }
  if (state.op == state.output.length) {
    return state.output;
  }
  byte[] temp=new byte[state.op];
  System.arraycopy(state.output,0,temp,0,state.op);
  return temp;
}
