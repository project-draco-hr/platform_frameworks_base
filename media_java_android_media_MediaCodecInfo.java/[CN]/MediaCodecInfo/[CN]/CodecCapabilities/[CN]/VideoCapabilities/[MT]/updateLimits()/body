{
  mHorizontalBlockRange=mHorizontalBlockRange.intersect(Utils.factorRange(mWidthRange,mBlockWidth));
  mHorizontalBlockRange=mHorizontalBlockRange.intersect(Range.create(mBlockCountRange.getLower() / mVerticalBlockRange.getUpper(),mBlockCountRange.getUpper() / mVerticalBlockRange.getLower()));
  mVerticalBlockRange=mVerticalBlockRange.intersect(Utils.factorRange(mHeightRange,mBlockHeight));
  mVerticalBlockRange=mVerticalBlockRange.intersect(Range.create(mBlockCountRange.getLower() / mHorizontalBlockRange.getUpper(),mBlockCountRange.getUpper() / mHorizontalBlockRange.getLower()));
  mBlockCountRange=mBlockCountRange.intersect(Range.create(mHorizontalBlockRange.getLower() * mVerticalBlockRange.getLower(),mHorizontalBlockRange.getUpper() * mVerticalBlockRange.getUpper()));
  mBlockAspectRatioRange=mBlockAspectRatioRange.intersect(new Rational(mHorizontalBlockRange.getLower(),mVerticalBlockRange.getUpper()),new Rational(mHorizontalBlockRange.getUpper(),mVerticalBlockRange.getLower()));
  mWidthRange=mWidthRange.intersect((mHorizontalBlockRange.getLower() - 1) * mBlockWidth + mWidthAlignment,mHorizontalBlockRange.getUpper() * mBlockWidth);
  mHeightRange=mHeightRange.intersect((mVerticalBlockRange.getLower() - 1) * mBlockHeight + mHeightAlignment,mVerticalBlockRange.getUpper() * mBlockHeight);
  mAspectRatioRange=mAspectRatioRange.intersect(new Rational(mWidthRange.getLower(),mHeightRange.getUpper()),new Rational(mWidthRange.getUpper(),mHeightRange.getLower()));
  mSmallerDimensionUpperLimit=Math.min(mSmallerDimensionUpperLimit,Math.min(mWidthRange.getUpper(),mHeightRange.getUpper()));
  mBlocksPerSecondRange=mBlocksPerSecondRange.intersect(mBlockCountRange.getLower() * (long)mFrameRateRange.getLower(),mBlockCountRange.getUpper() * (long)mFrameRateRange.getUpper());
  mFrameRateRange=mFrameRateRange.intersect((int)(mBlocksPerSecondRange.getLower() / mBlockCountRange.getUpper()),(int)(mBlocksPerSecondRange.getUpper() / (double)mBlockCountRange.getLower()));
}
