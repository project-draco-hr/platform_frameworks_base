{
  final Map<String,Object> map=info.getMap();
  Size blockSize=new Size(mBlockWidth,mBlockHeight);
  Size alignment=new Size(mWidthAlignment,mHeightAlignment);
  Range<Integer> counts=null, widths=null, heights=null;
  Range<Integer> frameRates=null;
  Range<Long> blockRates=null;
  Range<Rational> ratios=null, blockRatios=null;
  blockSize=Utils.parseSize(map.get("block-size"),blockSize);
  alignment=Utils.parseSize(map.get("alignment"),alignment);
  counts=Utils.parseIntRange(map.get("block-count-range"),null);
  blockRates=Utils.parseLongRange(map.get("blocks-per-second-range"),null);
{
    Object o=map.get("size-range");
    Pair<Size,Size> sizeRange=Utils.parseSizeRange(o);
    if (sizeRange != null) {
      try {
        widths=Range.create(sizeRange.first.getWidth(),sizeRange.second.getWidth());
        heights=Range.create(sizeRange.first.getHeight(),sizeRange.second.getHeight());
      }
 catch (      IllegalArgumentException e) {
        Log.w(TAG,"could not parse size range '" + o + "'");
        widths=null;
        heights=null;
      }
    }
  }
  ratios=Utils.parseRationalRange(map.get("block-aspect-ratio-range"),null);
  blockRatios=Utils.parseRationalRange(map.get("pixel-aspect-ratio-range"),null);
  frameRates=Utils.parseIntRange(map.get("frame-rate-range"),null);
  if (frameRates != null) {
    try {
      frameRates=frameRates.intersect(FRAME_RATE_RANGE);
    }
 catch (    IllegalArgumentException e) {
      Log.w(TAG,"frame rate range (" + frameRates + ") is out of limits: "+ FRAME_RATE_RANGE);
      frameRates=null;
    }
  }
  checkPowerOfTwo(blockSize.getWidth(),"block-size width must be power of two");
  checkPowerOfTwo(blockSize.getHeight(),"block-size height must be power of two");
  checkPowerOfTwo(alignment.getWidth(),"alignment width must be power of two");
  checkPowerOfTwo(alignment.getHeight(),"alignment height must be power of two");
  applyMacroBlockLimits(Integer.MAX_VALUE,Integer.MAX_VALUE,Integer.MAX_VALUE,Long.MAX_VALUE,blockSize.getWidth(),blockSize.getHeight(),alignment.getWidth(),alignment.getHeight());
  if ((mParent.mError & ERROR_UNSUPPORTED) != 0) {
    if (widths != null) {
      mWidthRange=mWidthRange.extend(widths);
    }
    if (heights != null) {
      mHeightRange=mHeightRange.extend(heights);
    }
    if (counts != null) {
      mBlockCountRange=mBlockCountRange.extend(Utils.factorRange(counts,mBlockWidth * mBlockHeight / blockSize.getWidth() / blockSize.getHeight()));
    }
    if (blockRates != null) {
      mBlocksPerSecondRange=mBlocksPerSecondRange.extend(Utils.factorRange(blockRates,mBlockWidth * mBlockHeight / blockSize.getWidth() / blockSize.getHeight()));
    }
    if (blockRatios != null) {
      mBlockAspectRatioRange=mBlockAspectRatioRange.extend(Utils.scaleRange(blockRatios,mBlockHeight / blockSize.getHeight(),mBlockWidth / blockSize.getWidth()));
    }
    if (ratios != null) {
      mAspectRatioRange=mAspectRatioRange.extend(ratios);
    }
    if (frameRates != null) {
      mFrameRateRange=mFrameRateRange.extend(frameRates);
    }
  }
 else {
    if (widths != null) {
      mWidthRange=mWidthRange.intersect(widths);
    }
    if (heights != null) {
      mHeightRange=mHeightRange.intersect(heights);
    }
    if (counts != null) {
      mBlockCountRange=mBlockCountRange.intersect(Utils.factorRange(counts,mBlockWidth * mBlockHeight / blockSize.getWidth() / blockSize.getHeight()));
    }
    if (blockRates != null) {
      mBlocksPerSecondRange=mBlocksPerSecondRange.intersect(Utils.factorRange(blockRates,mBlockWidth * mBlockHeight / blockSize.getWidth() / blockSize.getHeight()));
    }
    if (blockRatios != null) {
      mBlockAspectRatioRange=mBlockAspectRatioRange.intersect(Utils.scaleRange(blockRatios,mBlockHeight / blockSize.getHeight(),mBlockWidth / blockSize.getWidth()));
    }
    if (ratios != null) {
      mAspectRatioRange=mAspectRatioRange.intersect(ratios);
    }
    if (frameRates != null) {
      mFrameRateRange=mFrameRateRange.intersect(frameRates);
    }
  }
  updateLimits();
}
