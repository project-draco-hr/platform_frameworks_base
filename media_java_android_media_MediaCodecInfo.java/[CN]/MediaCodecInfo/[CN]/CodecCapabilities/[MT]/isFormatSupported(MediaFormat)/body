{
  final Map<String,Object> map=format.getMap();
  final String mime=(String)map.get(MediaFormat.KEY_MIME);
  if (mime != null && !mMime.equalsIgnoreCase(mime)) {
    return false;
  }
  for (  Feature feat : getValidFeatures()) {
    Integer yesNo=(Integer)map.get(MediaFormat.KEY_FEATURE_ + feat.mName);
    if (yesNo == null) {
      continue;
    }
    if ((yesNo == 1 && !isFeatureSupported(feat.mName)) || (yesNo == 0 && isFeatureRequired(feat.mName))) {
      return false;
    }
  }
  if (mAudioCaps != null && !mAudioCaps.supportsFormat(format)) {
    return false;
  }
  if (mVideoCaps != null && !mVideoCaps.supportsFormat(format)) {
    return false;
  }
  if (mEncoderCaps != null && !mEncoderCaps.supportsFormat(format)) {
    return false;
  }
  return true;
}
