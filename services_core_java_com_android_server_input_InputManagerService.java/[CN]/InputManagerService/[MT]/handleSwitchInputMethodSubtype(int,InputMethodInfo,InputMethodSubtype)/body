{
  if (DEBUG) {
    Slog.i(TAG,"InputMethodSubtype changed: userId=" + userId + " ime="+ inputMethodInfo+ " subtype="+ subtype);
  }
  if (inputMethodInfo == null) {
    Slog.d(TAG,"No InputMethod is running, ignoring change");
    return;
  }
  if (subtype != null && !"keyboard".equals(subtype.getMode())) {
    Slog.d(TAG,"InputMethodSubtype changed to non-keyboard subtype, ignoring change");
    return;
  }
  InputMethodSubtypeHandle handle=new InputMethodSubtypeHandle(inputMethodInfo,subtype);
  if (!handle.equals(mCurrentImeHandle)) {
    mCurrentImeHandle=handle;
    handleSwitchKeyboardLayout(null,handle);
  }
}
