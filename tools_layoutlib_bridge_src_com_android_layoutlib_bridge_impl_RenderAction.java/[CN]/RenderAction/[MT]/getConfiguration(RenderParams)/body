{
  Configuration config=new Configuration();
  HardwareConfig hardwareConfig=params.getHardwareConfig();
  ScreenSize screenSize=hardwareConfig.getScreenSize();
  if (screenSize != null) {
switch (screenSize) {
case SMALL:
      config.screenLayout|=Configuration.SCREENLAYOUT_SIZE_SMALL;
    break;
case NORMAL:
  config.screenLayout|=Configuration.SCREENLAYOUT_SIZE_NORMAL;
break;
case LARGE:
config.screenLayout|=Configuration.SCREENLAYOUT_SIZE_LARGE;
break;
case XLARGE:
config.screenLayout|=Configuration.SCREENLAYOUT_SIZE_XLARGE;
break;
}
}
Density density=hardwareConfig.getDensity();
if (density == null) {
density=Density.MEDIUM;
}
config.screenWidthDp=hardwareConfig.getScreenWidth() / density.getDpiValue();
config.screenHeightDp=hardwareConfig.getScreenHeight() / density.getDpiValue();
if (config.screenHeightDp < config.screenWidthDp) {
config.smallestScreenWidthDp=config.screenHeightDp;
}
 else {
config.smallestScreenWidthDp=config.screenWidthDp;
}
config.densityDpi=density.getDpiValue();
config.compatScreenWidthDp=config.screenWidthDp;
config.compatScreenHeightDp=config.screenHeightDp;
ScreenOrientation orientation=hardwareConfig.getOrientation();
if (orientation != null) {
switch (orientation) {
case PORTRAIT:
config.orientation=Configuration.ORIENTATION_PORTRAIT;
break;
case LANDSCAPE:
config.orientation=Configuration.ORIENTATION_LANDSCAPE;
break;
case SQUARE:
config.orientation=Configuration.ORIENTATION_SQUARE;
break;
}
}
 else {
config.orientation=Configuration.ORIENTATION_UNDEFINED;
}
ScreenRound roundness=hardwareConfig.getScreenRoundness();
if (roundness != null) {
switch (roundness) {
case ROUND:
config.screenLayout|=Configuration.SCREENLAYOUT_ROUND_YES;
break;
case NOTROUND:
config.screenLayout|=Configuration.SCREENLAYOUT_ROUND_NO;
}
}
 else {
config.screenLayout|=Configuration.SCREENLAYOUT_ROUND_UNDEFINED;
}
String locale=params.getLocale();
if (locale != null && !locale.isEmpty()) config.locale=new Locale(locale);
return config;
}
