{
  LinearLayout ll=new LinearLayout(getActivity());
  ll.setLayoutDirection(View.LAYOUT_DIRECTION_RTL);
  TextView tv=new TextView(getActivity());
  ll.addView(tv);
  tv.setTextDirection(View.TEXT_DIRECTION_CHAR_COUNT);
  tv.setText("this is a test");
  assertEquals(View.TEXT_DIRECTION_LTR,tv.getResolvedTextDirection());
  tv.setTextDirection(View.TEXT_DIRECTION_LTR);
  tv.setTextDirection(View.TEXT_DIRECTION_CHAR_COUNT);
  tv.setText("\u05DD\u05DE");
  assertEquals(View.TEXT_DIRECTION_RTL,tv.getResolvedTextDirection());
  tv.setTextDirection(View.TEXT_DIRECTION_LTR);
  tv.setTextDirection(View.TEXT_DIRECTION_CHAR_COUNT);
  tv.setText("this is a test \u05DD\u05DE");
  assertEquals(View.TEXT_DIRECTION_LTR,tv.getResolvedTextDirection());
  tv.setTextDirection(View.TEXT_DIRECTION_LTR);
  tv.setTextDirection(View.TEXT_DIRECTION_CHAR_COUNT);
  tv.setText("t \u05DD\u05DE");
  assertEquals(View.TEXT_DIRECTION_RTL,tv.getResolvedTextDirection());
  tv.setTextDirection(View.TEXT_DIRECTION_LTR);
  tv.setTextDirection(View.TEXT_DIRECTION_CHAR_COUNT);
  tv.setText("ab \u05DD\u05DE");
  assertEquals(View.TEXT_DIRECTION_RTL,tv.getResolvedTextDirection());
}
