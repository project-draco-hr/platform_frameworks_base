{
  final int screenHeight=WindowManagerImpl.getDefault().getDefaultDisplay().getHeight() - STATUS_BAR_HEIGHT;
  final int[] anchorPos=mDrawingLocation;
  anchor.getLocationOnScreen(anchorPos);
  anchorPos[1]-=STATUS_BAR_HEIGHT;
  final int distanceFromAnchorToBottom=screenHeight - (anchorPos[1] + anchor.getHeight());
  int returnedHeight=Math.max(anchorPos[1],distanceFromAnchorToBottom);
  if (mBackground != null) {
    mBackground.getPadding(mTempRect);
    returnedHeight-=mTempRect.top + mTempRect.bottom;
  }
  return returnedHeight;
}
