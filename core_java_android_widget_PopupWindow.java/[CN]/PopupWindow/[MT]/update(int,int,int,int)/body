{
  if (width != -1) {
    setWidth(width);
  }
  if (height != -1) {
    setHeight(height);
  }
  if (!isShowing() || mContentView == null) {
    return;
  }
  WindowManager.LayoutParams p=(WindowManager.LayoutParams)mPopupView.getLayoutParams();
  boolean update=false;
  final int finalWidth=mWidthMode < 0 ? mWidthMode : p.width;
  if (width != -1 && p.width != finalWidth) {
    p.width=finalWidth;
    update=true;
  }
  final int finalHeight=mHeightMode < 0 ? mHeightMode : p.height;
  if (height != -1 && p.height != finalHeight) {
    p.height=finalHeight;
    update=true;
  }
  if (p.x != x) {
    p.x=x;
    update=true;
  }
  if (p.y != y) {
    p.y=y;
    update=true;
  }
  final int newAnim=computeAnimationResource();
  if (newAnim != p.windowAnimations) {
    p.windowAnimations=newAnim;
    update=true;
  }
  final int newFlags=computeFlags(p.flags);
  if (newFlags != p.flags) {
    p.flags=newFlags;
    update=true;
  }
  if (update) {
    if (mPopupView != mContentView) {
      final View popupViewContainer=mPopupView;
      if (p.height >= 0) {
        p.height+=popupViewContainer.getPaddingTop() + popupViewContainer.getPaddingBottom();
      }
      if (p.width >= 0) {
        p.width+=popupViewContainer.getPaddingLeft() + popupViewContainer.getPaddingRight();
      }
    }
    mWindowManager.updateViewLayout(mPopupView,p);
  }
}
