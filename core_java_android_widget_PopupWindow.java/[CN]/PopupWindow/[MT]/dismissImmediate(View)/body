{
  if (mDecorView == null || mBackgroundView == null) {
    throw new RuntimeException("Popup window already dismissed");
  }
  try {
    if (mDecorView.isAttachedToWindow()) {
      mWindowManager.removeViewImmediate(mDecorView);
    }
  }
  finally {
    mDecorView.removeView(mBackgroundView);
    mDecorView=null;
    if (mBackgroundView != contentView) {
      ((ViewGroup)mBackgroundView).removeView(contentView);
    }
    mBackgroundView=null;
  }
}
