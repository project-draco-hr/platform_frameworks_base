{
  final WindowManager.LayoutParams p=new WindowManager.LayoutParams();
  p.gravity=computeGravity();
  p.flags=computeFlags(p.flags);
  p.type=mWindowLayoutType;
  p.token=token;
  p.softInputMode=mSoftInputMode;
  p.windowAnimations=computeAnimationResource();
  if (mBackground != null) {
    p.format=mBackground.getOpacity();
  }
 else {
    p.format=PixelFormat.TRANSLUCENT;
  }
  if (mHeightMode < 0) {
    p.height=mLastHeight=mHeightMode;
  }
 else {
    p.height=mLastHeight=mHeight;
  }
  if (mWidthMode < 0) {
    p.width=mLastWidth=mWidthMode;
  }
 else {
    p.width=mLastWidth=mWidth;
  }
  p.privateFlags=PRIVATE_FLAG_WILL_NOT_REPLACE_ON_RELAUNCH | PRIVATE_FLAG_LAYOUT_CHILD_WINDOW_IN_PARENT_FRAME;
  p.setTitle("PopupWindow:" + Integer.toHexString(hashCode()));
  return p;
}
