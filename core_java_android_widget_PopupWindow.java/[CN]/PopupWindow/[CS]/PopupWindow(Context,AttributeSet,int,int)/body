{
  mContext=context;
  mWindowManager=(WindowManager)context.getSystemService(Context.WINDOW_SERVICE);
  final TypedArray a=context.obtainStyledAttributes(attrs,R.styleable.PopupWindow,defStyleAttr,defStyleRes);
  final Drawable bg=a.getDrawable(R.styleable.PopupWindow_popupBackground);
  mElevation=a.getDimension(R.styleable.PopupWindow_popupElevation,0);
  mOverlapAnchor=a.getBoolean(R.styleable.PopupWindow_overlapAnchor,false);
  final int animStyle=a.getResourceId(R.styleable.PopupWindow_popupAnimationStyle,-1);
  mAnimationStyle=animStyle == R.style.Animation_PopupWindow ? -1 : animStyle;
  a.recycle();
  setBackgroundDrawable(bg);
}
