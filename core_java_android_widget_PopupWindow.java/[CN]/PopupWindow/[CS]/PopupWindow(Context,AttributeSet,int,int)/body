{
  mContext=context;
  mWindowManager=(WindowManager)context.getSystemService(Context.WINDOW_SERVICE);
  final TypedArray a=context.obtainStyledAttributes(attrs,R.styleable.PopupWindow,defStyleAttr,defStyleRes);
  final Drawable bg=a.getDrawable(R.styleable.PopupWindow_popupBackground);
  mElevation=a.getDimension(R.styleable.PopupWindow_popupElevation,0);
  mOverlapAnchor=a.getBoolean(R.styleable.PopupWindow_overlapAnchor,false);
  if (a.hasValueOrEmpty(R.styleable.PopupWindow_popupAnimationStyle)) {
    final int animStyle=a.getResourceId(R.styleable.PopupWindow_popupAnimationStyle,0);
    if (animStyle == R.style.Animation_PopupWindow) {
      mAnimationStyle=ANIMATION_STYLE_DEFAULT;
    }
 else {
      mAnimationStyle=animStyle;
    }
  }
 else {
    mAnimationStyle=ANIMATION_STYLE_DEFAULT;
  }
  final Transition enterTransition=getTransition(a.getResourceId(R.styleable.PopupWindow_popupEnterTransition,0));
  final Transition exitTransition;
  if (a.hasValueOrEmpty(R.styleable.PopupWindow_popupExitTransition)) {
    exitTransition=getTransition(a.getResourceId(R.styleable.PopupWindow_popupExitTransition,0));
  }
 else {
    exitTransition=enterTransition == null ? null : enterTransition.clone();
  }
  a.recycle();
  setEnterTransition(enterTransition);
  setExitTransition(exitTransition);
  setBackgroundDrawable(bg);
}
