{
  final int width=getWidth();
  View indicatorHost=null;
  int ypos=mTopOffset;
  int leftEdge=getPaddingLeft();
  int rightEdge=width - getPaddingRight();
  final int childCount=getChildCount();
  for (int i=0; i < childCount; i++) {
    final View child=getChildAt(i);
    final LayoutParams lp=(LayoutParams)child.getLayoutParams();
    if (lp.hasNestedScrollIndicator) {
      indicatorHost=child;
    }
    if (child.getVisibility() == GONE) {
      continue;
    }
    int top=ypos + lp.topMargin;
    if (lp.ignoreOffset) {
      top-=mCollapseOffset;
    }
    final int bottom=top + child.getMeasuredHeight();
    final int childWidth=child.getMeasuredWidth();
    final int widthAvailable=rightEdge - leftEdge;
    final int left=leftEdge + (widthAvailable - childWidth) / 2;
    final int right=left + childWidth;
    child.layout(left,top,right,bottom);
    ypos=bottom + lp.bottomMargin;
  }
  if (mScrollIndicatorDrawable != null) {
    if (indicatorHost != null) {
      final int left=indicatorHost.getLeft();
      final int right=indicatorHost.getRight();
      final int bottom=indicatorHost.getTop();
      final int top=bottom - mScrollIndicatorDrawable.getIntrinsicHeight();
      mScrollIndicatorDrawable.setBounds(left,top,right,bottom);
      setWillNotDraw(!isCollapsed());
    }
 else {
      mScrollIndicatorDrawable=null;
      setWillNotDraw(true);
    }
  }
}
