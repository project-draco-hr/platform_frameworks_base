{
  mRecentLightSamples+=1;
  if (mRecentLightSamples == 1) {
    mRecentShortTermAverageLux=lux;
    mRecentLongTermAverageLux=lux;
  }
 else {
    final long timeDelta=time - mLastObservedLuxTime;
    mRecentShortTermAverageLux+=(lux - mRecentShortTermAverageLux) * timeDelta / (SHORT_TERM_AVERAGE_LIGHT_TIME_CONSTANT + timeDelta);
    mRecentLongTermAverageLux+=(lux - mRecentLongTermAverageLux) * timeDelta / (LONG_TERM_AVERAGE_LIGHT_TIME_CONSTANT + timeDelta);
  }
  mLastObservedLux=lux;
  mLastObservedLuxTime=time;
  mHandler.removeMessages(MSG_LIGHT_SENSOR_DEBOUNCED);
  updateAmbientLux(time);
}
