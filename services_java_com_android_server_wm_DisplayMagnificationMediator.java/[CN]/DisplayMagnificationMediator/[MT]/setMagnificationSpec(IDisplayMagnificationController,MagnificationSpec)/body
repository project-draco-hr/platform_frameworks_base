{
  enforceCallingPermission(Manifest.permission.MAGNIFY_DISPLAY,METHOD_SIGNATURE_SET_MAGNIFICATION_SPEC);
synchronized (mWindowManagerService.mWindowMap) {
    DisplayState displayState=null;
    final int displayStateCount=mDisplayStates.size();
    for (int i=0; i < displayStateCount; i++) {
      DisplayState candidate=mDisplayStates.valueAt(i);
      if (candidate.mClient.asBinder() == controller.asBinder()) {
        displayState=candidate;
        break;
      }
    }
    if (displayState == null) {
      Slog.e(LOG_TAG,"Setting magnification spec for unregistered controller " + controller);
      return;
    }
    displayState.mMagnificationSpec.initialize(spec.scale,spec.offsetX,spec.offsetY);
    spec.recycle();
    mWindowManagerService.scheduleAnimationLocked();
  }
}
