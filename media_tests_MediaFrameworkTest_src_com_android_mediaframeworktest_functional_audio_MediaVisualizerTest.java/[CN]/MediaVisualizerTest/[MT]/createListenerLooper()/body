{
  new Thread(){
    @Override public void run(){
      Looper.prepare();
      mLooper=Looper.myLooper();
      if (mVisualizer != null) {
        mVisualizer.setDataCaptureListener(new Visualizer.OnDataCaptureListener(){
          public void onWaveFormDataCapture(          Visualizer visualizer,          byte[] waveform,          int samplingRate){
synchronized (lock) {
              if (visualizer == mVisualizer) {
                if (mCaptureWaveform) {
                  mWaveform=waveform;
                  lock.notify();
                }
              }
            }
          }
          public void onFftDataCapture(          Visualizer visualizer,          byte[] fft,          int samplingRate){
synchronized (lock) {
              if (visualizer == mVisualizer) {
                if (mCaptureFft) {
                  mFft=fft;
                  lock.notify();
                }
              }
            }
          }
        }
,10000,true,true);
      }
synchronized (lock) {
        mInitialized=true;
        lock.notify();
      }
      Looper.loop();
    }
  }
.start();
}
