{
  FrameLayout content=new FrameLayout(context);
  content.setBackground(d);
  AttachInfo_Accessor.setAttachInfo(content);
  int w=d.getIntrinsicWidth();
  int h=d.getIntrinsicHeight();
  final int screenWidth=hardwareConfig.getScreenWidth();
  final int screenHeight=hardwareConfig.getScreenHeight();
  if (w == -1 || h == -1) {
    w=screenWidth;
    h=screenHeight;
  }
 else   if (w > screenWidth || h > screenHeight) {
    double scale=Math.min((double)screenWidth / w,(double)screenHeight / h);
    w=(int)Math.floor(scale * w);
    h=(int)Math.floor(scale * h);
  }
  int w_spec=MeasureSpec.makeMeasureSpec(w,MeasureSpec.EXACTLY);
  int h_spec=MeasureSpec.makeMeasureSpec(h,MeasureSpec.EXACTLY);
  content.measure(w_spec,h_spec);
  content.layout(0,0,w,h);
  AttachInfo_Accessor.dispatchOnPreDraw(content);
  BufferedImage image=getImage(w,h);
  Bitmap bitmap=Bitmap_Delegate.createBitmap(image,true,hardwareConfig.getDensity());
  Canvas canvas=new Canvas(bitmap);
  canvas.setDensity(hardwareConfig.getDensity().getDpiValue());
  content.draw(canvas);
  return image;
}
