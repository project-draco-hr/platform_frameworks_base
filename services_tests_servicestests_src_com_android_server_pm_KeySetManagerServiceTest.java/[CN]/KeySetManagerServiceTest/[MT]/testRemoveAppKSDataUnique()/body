{
  PackageSetting ps=generateFakePackageSetting("packageA");
  mPackagesMap.put(ps.name,ps);
  ArraySet<PublicKey> signingKeys=new ArraySet<PublicKey>();
  PublicKey keyA=PackageParser.parsePublicKey(KeySetStrings.ctsKeySetPublicKeyA);
  signingKeys.add(keyA);
  mKsms.addSigningKeySetToPackageLPw(ps.name,signingKeys);
  mKsms.removeAppKeySetDataLPw(ps.name);
  assertEquals(0,getKeySetRefCount(1));
  assertEquals(0,getPubKeyRefCount(1));
  LongSparseArray<ArraySet<Long>> ksMapping=getKeySetMapping();
  assertEquals(0,ksMapping.size());
  assertEquals(PackageKeySetData.KEYSET_UNASSIGNED,ps.keySetData.getProperSigningKeySet());
}
