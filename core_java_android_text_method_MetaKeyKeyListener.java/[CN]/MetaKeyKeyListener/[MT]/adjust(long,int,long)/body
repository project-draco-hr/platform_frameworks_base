{
  if ((state & (((long)what) << PRESSED_SHIFT)) != 0)   return (state & ~mask) | what | ((long)what) << USED_SHIFT;
 else   if ((state & (((long)what) << RELEASED_SHIFT)) != 0)   return state & ~mask;
  return state;
}
