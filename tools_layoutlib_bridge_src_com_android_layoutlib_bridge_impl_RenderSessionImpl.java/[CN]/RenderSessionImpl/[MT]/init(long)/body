{
  Result result=acquireLock(timeout);
  if (result != null) {
    return result;
  }
  DisplayMetrics metrics=new DisplayMetrics();
  metrics.densityDpi=mParams.getDensity();
  metrics.density=mParams.getDensity() / (float)DisplayMetrics.DENSITY_DEFAULT;
  metrics.scaledDensity=metrics.density;
  metrics.widthPixels=mParams.getScreenWidth();
  metrics.heightPixels=mParams.getScreenHeight();
  metrics.xdpi=mParams.getXdpi();
  metrics.ydpi=mParams.getYdpi();
  RenderResources resources=mParams.getResources();
  mContext=new BridgeContext(mParams.getProjectKey(),metrics,resources,mParams.getProjectCallback(),mParams.getTargetSdkVersion());
  setUp();
  mWindowBackground=null;
  mScreenOffset=0;
  StyleResourceValue theme=resources.getTheme();
  if (theme != null && mParams.isBgColorOverridden() == false) {
    mWindowBackground=resources.findItemInTheme("windowBackground");
    mWindowBackground=resources.resolveResValue(mWindowBackground);
    mScreenOffset=getScreenOffset(resources,metrics);
  }
  mInflater=new BridgeInflater(mContext,mParams.getProjectCallback());
  mContext.setBridgeInflater(mInflater);
  mInflater.setFactory2(mContext);
  mBlockParser=new BridgeXmlBlockParser(mParams.getLayoutDescription(),mContext,false);
  return SUCCESS.createResult();
}
