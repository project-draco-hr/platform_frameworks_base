{
  checkLock();
  try {
    SessionParams params=getParams();
    BridgeContext context=getContext();
    ViewGroup backgroundView=null;
    if (mWindowIsFloating || params.isForceNoDecor()) {
      backgroundView=mViewRoot=mContentRoot=new FrameLayout(context);
    }
 else {
      LinearLayout topLayout=new LinearLayout(context);
      mViewRoot=topLayout;
      topLayout.setOrientation(LinearLayout.VERTICAL);
      if (mStatusBarSize > 0) {
        try {
          PhoneSystemBar systemBar=new PhoneSystemBar(context,params.getDensity());
          systemBar.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.MATCH_PARENT,mStatusBarSize));
          topLayout.addView(systemBar);
        }
 catch (        XmlPullParserException e) {
        }
      }
      LinearLayout backgroundLayout=new LinearLayout(context);
      backgroundView=backgroundLayout;
      backgroundLayout.setOrientation(LinearLayout.VERTICAL);
      LinearLayout.LayoutParams layoutParams=new LinearLayout.LayoutParams(LayoutParams.MATCH_PARENT,LayoutParams.WRAP_CONTENT);
      layoutParams.weight=1;
      backgroundLayout.setLayoutParams(layoutParams);
      topLayout.addView(backgroundLayout);
      if (mTitleBarSize > 0) {
        try {
          TitleBar titleBar=new TitleBar(context,params.getDensity(),params.getAppLabel());
          titleBar.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.MATCH_PARENT,mTitleBarSize));
          backgroundLayout.addView(titleBar);
        }
 catch (        XmlPullParserException e) {
        }
      }
      mContentRoot=new FrameLayout(context);
      layoutParams=new LinearLayout.LayoutParams(LayoutParams.MATCH_PARENT,LayoutParams.WRAP_CONTENT);
      layoutParams.weight=1;
      mContentRoot.setLayoutParams(layoutParams);
      backgroundLayout.addView(mContentRoot);
    }
    View view=mInflater.inflate(mBlockParser,mContentRoot);
    context.popParser();
    AttachInfo info=new AttachInfo(new BridgeWindowSession(),new BridgeWindow(),new Handler(),null);
    info.mHasWindowFocus=true;
    info.mWindowVisibility=View.VISIBLE;
    info.mInTouchMode=false;
    mViewRoot.dispatchAttachedToWindow(info,0);
    postInflateProcess(view,params.getProjectCallback());
    if (mWindowBackground != null && backgroundView != null) {
      Drawable d=ResourceHelper.getDrawable(mWindowBackground,context);
      backgroundView.setBackgroundDrawable(d);
    }
    return SUCCESS.createResult();
  }
 catch (  PostInflateException e) {
    return ERROR_INFLATION.createResult(e.getMessage(),e);
  }
catch (  Throwable e) {
    Throwable t=e;
    while (t.getCause() != null) {
      t=t.getCause();
    }
    return ERROR_INFLATION.createResult(t.getMessage(),t);
  }
}
