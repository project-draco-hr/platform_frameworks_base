{
  checkLock();
  try {
    if (mViewRoot == null) {
      return ERROR_NOT_INFLATED.createResult();
    }
    int w_spec, h_spec;
    RenderingMode renderingMode=mParams.getRenderingMode();
    boolean newRenderSize=false;
    if (mMeasuredScreenWidth == -1) {
      newRenderSize=true;
      mMeasuredScreenWidth=mParams.getScreenWidth();
      mMeasuredScreenHeight=mParams.getScreenHeight();
      if (renderingMode != RenderingMode.NORMAL) {
        w_spec=MeasureSpec.makeMeasureSpec(mMeasuredScreenWidth,renderingMode.isHorizExpand() ? MeasureSpec.UNSPECIFIED : MeasureSpec.EXACTLY);
        h_spec=MeasureSpec.makeMeasureSpec(mMeasuredScreenHeight - mScreenOffset,renderingMode.isVertExpand() ? MeasureSpec.UNSPECIFIED : MeasureSpec.EXACTLY);
        mViewRoot.measure(w_spec,h_spec);
        if (renderingMode.isHorizExpand()) {
          int neededWidth=mViewRoot.getChildAt(0).getMeasuredWidth();
          if (neededWidth > mMeasuredScreenWidth) {
            mMeasuredScreenWidth=neededWidth;
          }
        }
        if (renderingMode.isVertExpand()) {
          int neededHeight=mViewRoot.getChildAt(0).getMeasuredHeight();
          if (neededHeight > mMeasuredScreenHeight - mScreenOffset) {
            mMeasuredScreenHeight=neededHeight + mScreenOffset;
          }
        }
      }
    }
    w_spec=MeasureSpec.makeMeasureSpec(mMeasuredScreenWidth,MeasureSpec.EXACTLY);
    h_spec=MeasureSpec.makeMeasureSpec(mMeasuredScreenHeight - mScreenOffset,MeasureSpec.EXACTLY);
    mViewRoot.measure(w_spec,h_spec);
    mViewRoot.layout(0,mScreenOffset,mMeasuredScreenWidth,mMeasuredScreenHeight);
    if (newRenderSize || mCanvas == null) {
      if (mParams.getImageFactory() != null) {
        mImage=mParams.getImageFactory().getImage(mMeasuredScreenWidth,mMeasuredScreenHeight - mScreenOffset);
      }
 else {
        mImage=new BufferedImage(mMeasuredScreenWidth,mMeasuredScreenHeight - mScreenOffset,BufferedImage.TYPE_INT_ARGB);
      }
      if (mParams.isBgColorOverridden()) {
        Graphics2D gc=mImage.createGraphics();
        gc.setColor(new Color(mParams.getOverrideBgColor(),true));
        gc.fillRect(0,0,mMeasuredScreenWidth,mMeasuredScreenHeight - mScreenOffset);
        gc.dispose();
      }
      Bitmap bitmap=Bitmap_Delegate.createBitmap(mImage,true,ResourceDensity.getEnum(mParams.getDensity()));
      mCanvas=new Canvas(bitmap);
      mCanvas.setDensity(mParams.getDensity());
    }
    mViewRoot.draw(mCanvas);
    mViewInfo=visit(((ViewGroup)mViewRoot).getChildAt(0),mContext);
    return SUCCESS.createResult();
  }
 catch (  Throwable e) {
    Throwable t=e;
    while (t.getCause() != null) {
      t=t.getCause();
    }
    mParams.getLog().error(null,"Scene Render failed",t);
    return ERROR_UNKNOWN.createResult(t.getMessage(),t);
  }
}
