{
  g=(Graphics2D)g.create();
  g.setColor(new Color(paint.getColor()));
  int alpha=paint.getAlpha();
  float falpha=alpha / 255.f;
  Xfermode xfermode=paint.getXfermode();
  if (xfermode instanceof PorterDuffXfermode) {
    PorterDuff.Mode mode=((PorterDuffXfermode)xfermode).getMode();
    setModeInGraphics(mode,g,falpha);
  }
 else {
    if (mLogger != null && xfermode != null) {
      mLogger.warning(String.format("Xfermode '%1$s' is not supported in the Layout Editor.",xfermode.getClass().getCanonicalName()));
    }
    g.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_OVER,falpha));
  }
  Shader shader=paint.getShader();
  if (shader instanceof LinearGradient) {
    g.setPaint(((LinearGradient)shader).getPaint());
  }
 else {
    if (mLogger != null && shader != null) {
      mLogger.warning(String.format("Shader '%1$s' is not supported in the Layout Editor.",shader.getClass().getCanonicalName()));
    }
  }
  return g;
}
