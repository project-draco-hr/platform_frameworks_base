{
  Future<?> nextConnBroadcast;
  mMobile.info.setDetailedState(DetailedState.CONNECTED,null,null);
  mMobile.link.setInterfaceName(MOBILE_IFACE);
  mMobile.link.addRoute(MOBILE_ROUTE_V4);
  mMobile.link.addRoute(MOBILE_ROUTE_V6);
  mMobile.doReturnDefaults();
  nextConnBroadcast=mServiceContext.nextBroadcastIntent(CONNECTIVITY_ACTION_IMMEDIATE);
  mTrackerHandler.obtainMessage(EVENT_STATE_CHANGED,mMobile.info).sendToTarget();
  nextConnBroadcast.get();
  int mobileNetId=mMobile.tracker.getNetwork().netId;
  verify(mNetManager).addRoute(eq(mobileNetId),eq(MOBILE_ROUTE_V4));
  verify(mNetManager).addRoute(eq(mobileNetId),eq(MOBILE_ROUTE_V6));
}
