{
  final int type=transportToLegacyType(transport);
  final String typeName=ConnectivityManager.getNetworkTypeName(type);
  mNetworkInfo=new NetworkInfo(type,0,typeName,"Mock");
  mNetworkCapabilities=new NetworkCapabilities();
  mNetworkCapabilities.addTransportType(transport);
switch (transport) {
case TRANSPORT_WIFI:
    mScore=60;
  break;
case TRANSPORT_CELLULAR:
mScore=50;
break;
default :
throw new UnsupportedOperationException("unimplemented network type");
}
mHandlerThread=new IdleableHandlerThread("Mock-" + typeName);
mHandlerThread.start();
mNetworkAgent=new NetworkAgent(mHandlerThread.getLooper(),mServiceContext,"Mock-" + typeName,mNetworkInfo,mNetworkCapabilities,new LinkProperties(),mScore,new NetworkMisc()){
public void unwanted(){
mDisconnected.open();
}
}
;
mService.waitForIdle();
mWrappedNetworkMonitor=mService.getLastCreatedWrappedNetworkMonitor();
}
