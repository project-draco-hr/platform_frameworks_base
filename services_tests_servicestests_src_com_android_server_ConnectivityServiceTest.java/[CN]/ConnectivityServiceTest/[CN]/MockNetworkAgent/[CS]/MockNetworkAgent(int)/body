{
  final int type=transportToLegacyType(transport);
  final String typeName=ConnectivityManager.getNetworkTypeName(type);
  mNetworkInfo=new NetworkInfo(type,0,typeName,"Mock");
  mNetworkCapabilities=new NetworkCapabilities();
  mNetworkCapabilities.addTransportType(transport);
switch (transport) {
case TRANSPORT_WIFI:
    mScore=60;
  break;
case TRANSPORT_CELLULAR:
mScore=50;
break;
default :
throw new UnsupportedOperationException("unimplemented network type");
}
final ConditionVariable initComplete=new ConditionVariable();
mThread=new Thread(){
public void run(){
Looper.prepare();
mNetworkAgent=new NetworkAgent(Looper.myLooper(),mServiceContext,"Mock" + typeName,mNetworkInfo,mNetworkCapabilities,new LinkProperties(),mScore,new NetworkMisc()){
public void unwanted(){
mDisconnected.open();
}
}
;
initComplete.open();
Looper.loop();
}
}
;
mThread.start();
waitFor(initComplete);
}
