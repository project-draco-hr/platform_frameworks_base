{
  int comp=(pixel & componentMasks[idx]) >> offsets[idx];
  if (isAlphaPremultiplied) {
    float factor=((1 << LINEAR_RGB_Length) - 1);
    int alpha=(pixel & componentMasks[3]) >> offsets[3];
    comp=alpha == 0 ? 0 : (int)(scales[idx] * comp * factor / (scales[3] * alpha) + 0.5f);
  }
 else   if (bits[idx] != LINEAR_RGB_Length) {
    comp=colorLUTs[idx][comp] & 0xff;
  }
 else {
    comp=from_LINEAR_RGB_LUT[comp] & 0xff;
  }
  return comp;
}
