{
  mContext.enforceCallingPermission(android.Manifest.permission.BACKUP,"fullTransportBackup");
  final int callingUserHandle=UserHandle.getCallingUserId();
  if (callingUserHandle != UserHandle.USER_SYSTEM) {
    throw new IllegalStateException("Restore supported only for the device owner");
  }
  if (!fullBackupAllowable(getTransport(mCurrentTransport))) {
    Slog.i(TAG,"Full backup not currently possible -- key/value backup not yet run?");
  }
 else {
    if (DEBUG) {
      Slog.d(TAG,"fullTransportBackup()");
    }
    CountDownLatch latch=new CountDownLatch(1);
    PerformFullTransportBackupTask task=new PerformFullTransportBackupTask(null,pkgNames,false,null,latch);
    (new Thread(task,"full-transport-master")).start();
    do {
      try {
        latch.await();
        break;
      }
 catch (      InterruptedException e) {
      }
    }
 while (true);
    final long now=System.currentTimeMillis();
    for (    String pkg : pkgNames) {
      enqueueFullBackup(pkg,now);
    }
  }
  if (DEBUG) {
    Slog.d(TAG,"Done with full transport backup.");
  }
}
