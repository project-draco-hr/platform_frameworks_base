{
  File base=new File(Environment.getDataDirectory(),"backup");
  File enableFile=new File(base,BACKUP_ENABLE_FILE);
  File stage=new File(base,BACKUP_ENABLE_FILE + "-stage");
  FileOutputStream fout=null;
  try {
    fout=new FileOutputStream(stage);
    fout.write(enable ? 1 : 0);
    fout.close();
    stage.renameTo(enableFile);
  }
 catch (  IOException|RuntimeException e) {
    Slog.e(TAG,"Unable to record backup enable state; reverting to disabled: " + e.getMessage());
    final ContentResolver r=sInstance.mContext.getContentResolver();
    Settings.Secure.putStringForUser(r,Settings.Secure.BACKUP_ENABLED,null,userId);
    enableFile.delete();
    stage.delete();
  }
 finally {
    IoUtils.closeQuietly(fout);
  }
}
