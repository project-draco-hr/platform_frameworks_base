{
  if (MORE_DEBUG) {
    Slog.i(TAG,"operationComplete() during restore: target=" + mCurrentPackage.packageName + " state="+ mState);
  }
  final UnifiedRestoreState nextState;
switch (mState) {
case RESTORE_KEYVALUE:
case RESTORE_FULL:
{
      nextState=UnifiedRestoreState.RESTORE_FINISHED;
      break;
    }
case RESTORE_FINISHED:
{
    int size=(int)mBackupDataName.length();
    EventLog.writeEvent(EventLogTags.RESTORE_PACKAGE,mCurrentPackage.packageName,size);
    keyValueAgentCleanup();
    if (mWidgetData != null) {
      restoreWidgetData(mCurrentPackage.packageName,mWidgetData);
    }
    nextState=UnifiedRestoreState.RUNNING_QUEUE;
    break;
  }
default :
{
  Slog.e(TAG,"Unexpected restore callback into state " + mState);
  keyValueAgentErrorCleanup();
  nextState=UnifiedRestoreState.FINAL;
  break;
}
}
executeNextState(nextState);
}
