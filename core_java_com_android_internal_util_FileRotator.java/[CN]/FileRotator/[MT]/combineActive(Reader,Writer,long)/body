{
  final String activeName=getActiveName(currentTimeMillis);
  final File file=new File(mBasePath,activeName);
  final File backupFile;
  if (file.exists()) {
    readFile(file,reader);
    backupFile=new File(mBasePath,activeName + SUFFIX_BACKUP);
    file.renameTo(backupFile);
    try {
      writeFile(file,writer);
      backupFile.delete();
    }
 catch (    IOException e) {
      file.delete();
      backupFile.renameTo(file);
      throw e;
    }
  }
 else {
    backupFile=new File(mBasePath,activeName + SUFFIX_NO_BACKUP);
    backupFile.createNewFile();
    try {
      writeFile(file,writer);
      backupFile.delete();
    }
 catch (    IOException e) {
      file.delete();
      backupFile.delete();
      throw e;
    }
  }
}
