{
switch (mode) {
case KeymasterDefs.KM_MODE_ECB:
    return ECB;
case KeymasterDefs.KM_MODE_CBC:
  return CBC;
case KeymasterDefs.KM_MODE_CTR:
return CTR;
case KeymasterDefs.KM_MODE_GCM:
return GCM;
default :
throw new IllegalArgumentException("Unknown block mode: " + mode);
}
}
