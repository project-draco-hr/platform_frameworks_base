{
  String algorithmLower=algorithm.toLowerCase(Locale.US);
  if (algorithmLower.startsWith("hmac")) {
    String digestLower=algorithmLower.substring("hmac".length());
    if ("md5".equals(digestLower)) {
      return MD5;
    }
 else     if ("sha1".equals(digestLower)) {
      return SHA1;
    }
 else     if ("sha224".equals(digestLower)) {
      return SHA224;
    }
 else     if ("sha256".equals(digestLower)) {
      return SHA256;
    }
 else     if ("sha384".equals(digestLower)) {
      return SHA384;
    }
 else     if ("sha512".equals(digestLower)) {
      return SHA512;
    }
 else {
      throw new IllegalArgumentException("Unsupported digest: " + digestLower);
    }
  }
 else {
    return null;
  }
}
