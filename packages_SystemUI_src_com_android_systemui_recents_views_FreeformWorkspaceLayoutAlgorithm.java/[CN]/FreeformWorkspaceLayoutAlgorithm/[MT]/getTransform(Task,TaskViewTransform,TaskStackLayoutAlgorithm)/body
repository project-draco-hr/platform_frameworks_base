{
  if (mTaskRectMap.containsKey(task.key)) {
    Rect taskRect=stackLayout.mTaskRect;
    RectF ffRect=mTaskRectMap.get(task.key);
    float scale=Math.max(ffRect.width() / taskRect.width(),ffRect.height() / taskRect.height());
    int topOffset=(stackLayout.mFreeformRect.top - taskRect.top);
    int scaleXOffset=(int)(((1f - scale) * taskRect.width()) / 2);
    int scaleYOffset=(int)(((1f - scale) * taskRect.height()) / 2);
    transformOut.scale=scale * 0.95f;
    transformOut.translationX=(int)(ffRect.left - scaleXOffset);
    transformOut.translationY=(int)(topOffset + ffRect.top - scaleYOffset);
    transformOut.translationZ=stackLayout.mMaxTranslationZ;
    transformOut.clipBottom=(int)(taskRect.height() - (ffRect.height() / scale));
    transformOut.clipRight=(int)(taskRect.width() - (ffRect.width() / scale));
    if (task.thumbnail != null) {
      transformOut.thumbnailScale=Math.min(((float)taskRect.width() - transformOut.clipRight) / task.thumbnail.getWidth(),((float)taskRect.height() - transformOut.clipBottom) / task.thumbnail.getHeight());
    }
 else {
      transformOut.thumbnailScale=1f;
    }
    transformOut.rect.set(taskRect);
    transformOut.rect.offset(transformOut.translationX,transformOut.translationY);
    Utilities.scaleRectAboutCenter(transformOut.rect,transformOut.scale);
    transformOut.rect.right-=transformOut.clipRight * scale;
    transformOut.rect.bottom-=transformOut.clipBottom * scale;
    transformOut.visible=true;
    transformOut.p=1f;
    if (DEBUG) {
      Log.d(TAG,"getTransform: " + task.key + ", "+ transformOut);
    }
    return transformOut;
  }
  return null;
}
