{
  final String action=intent.getAction();
  if (action.equals(Intent.ACTION_BATTERY_CHANGED)) {
    mLevel=intent.getIntExtra(BatteryManager.EXTRA_LEVEL,0);
    mPluggedIn=intent.getIntExtra(BatteryManager.EXTRA_PLUGGED,0) != 0;
    final int status=intent.getIntExtra(BatteryManager.EXTRA_STATUS,BatteryManager.BATTERY_STATUS_UNKNOWN);
    mCharged=status == BatteryManager.BATTERY_STATUS_FULL;
    mCharging=mCharged || status == BatteryManager.BATTERY_STATUS_CHARGING;
    updateStatusBarHeaderView();
    for (    BatteryStateChangeCallback cb : mChangeCallbacks) {
      cb.onBatteryLevelChanged(mLevel,mPluggedIn,mCharging);
    }
  }
}
