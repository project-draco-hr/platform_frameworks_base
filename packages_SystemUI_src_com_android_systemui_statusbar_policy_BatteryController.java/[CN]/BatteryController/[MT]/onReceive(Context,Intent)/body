{
  final String action=intent.getAction();
  if (action.equals(Intent.ACTION_BATTERY_CHANGED)) {
    final int level=intent.getIntExtra(BatteryManager.EXTRA_LEVEL,0);
    final int status=intent.getIntExtra(BatteryManager.EXTRA_STATUS,BatteryManager.BATTERY_STATUS_UNKNOWN);
    boolean plugged=false;
switch (status) {
case BatteryManager.BATTERY_STATUS_CHARGING:
case BatteryManager.BATTERY_STATUS_FULL:
      plugged=true;
    break;
}
for (BatteryStateChangeCallback cb : mChangeCallbacks) {
  cb.onBatteryLevelChanged(level,plugged);
}
}
}
