{
  ArraySet<Long> deletableKeySets=getOriginalKeySetsByPackageNameLPr(packageName);
  ArraySet<Long> deletableKeys=new ArraySet<Long>();
  ArraySet<Long> knownKeys=null;
  for (  Long ks : deletableKeySets) {
    knownKeys=mKeySetMapping.get(ks);
    if (knownKeys != null) {
      deletableKeys.addAll(knownKeys);
    }
  }
  for (  String pkgName : mPackages.keySet()) {
    if (pkgName.equals(packageName)) {
      continue;
    }
    ArraySet<Long> knownKeySets=getOriginalKeySetsByPackageNameLPr(pkgName);
    deletableKeySets.removeAll(knownKeySets);
    knownKeys=new ArraySet<Long>();
    for (    Long ks : knownKeySets) {
      knownKeys=mKeySetMapping.get(ks);
      if (knownKeys != null) {
        deletableKeys.removeAll(knownKeys);
      }
    }
  }
  for (  Long ks : deletableKeySets) {
    mKeySets.delete(ks);
    mKeySetMapping.delete(ks);
  }
  for (  Long keyId : deletableKeys) {
    mPublicKeys.delete(keyId);
  }
  for (  String pkgName : mPackages.keySet()) {
    PackageSetting p=mPackages.get(pkgName);
    for (    Long ks : deletableKeySets) {
      p.keySetData.removeSigningKeySet(ks);
    }
  }
  PackageSetting p=mPackages.get(packageName);
  clearPackageKeySetDataLPw(p);
}
