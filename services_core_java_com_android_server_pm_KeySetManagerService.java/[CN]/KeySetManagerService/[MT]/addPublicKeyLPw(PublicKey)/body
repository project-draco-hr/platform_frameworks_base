{
  Preconditions.checkNotNull(key,"Cannot add null public key!");
  long id=getIdForPublicKeyLPr(key);
  if (id != PUBLIC_KEY_NOT_FOUND) {
    mPublicKeys.get(id).incrRefCountLPw();
    return id;
  }
  id=getFreePublicKeyIdLPw();
  mPublicKeys.put(id,new PublicKeyHandle(id,key));
  return id;
}
