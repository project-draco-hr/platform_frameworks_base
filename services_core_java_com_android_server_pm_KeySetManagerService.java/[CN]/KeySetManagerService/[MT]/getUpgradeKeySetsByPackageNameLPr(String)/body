{
  ArraySet<KeySetHandle> upgradeKeySets=new ArraySet<KeySetHandle>();
  PackageSetting p=mPackages.get(packageName);
  if (p == null) {
    throw new NullPointerException("Unknown package");
  }
  if (p.keySetData == null) {
    throw new IllegalArgumentException("Package has no keySet data");
  }
  if (p.keySetData.isUsingUpgradeKeySets()) {
    for (    long l : p.keySetData.getUpgradeKeySets()) {
      upgradeKeySets.add(mKeySets.get(l));
    }
  }
  return upgradeKeySets;
}
