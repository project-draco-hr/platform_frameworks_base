{
  if ((packageName == null) || (signingKeys == null)) {
    Slog.w(TAG,"Got null argument for a signing keyset, ignoring!");
    return;
  }
  KeySetHandle ks=addKeySetLPw(signingKeys);
  long id=getIdByKeySetLPr(ks);
  ArraySet<Long> publicKeyIds=mKeySetMapping.get(id);
  if (publicKeyIds == null) {
    throw new NullPointerException("Got invalid KeySet id");
  }
  PackageSetting pkg=mPackages.get(packageName);
  if (pkg == null) {
    throw new NullPointerException("No such package!");
  }
  pkg.keySetData.setProperSigningKeySet(id);
  for (int keySetIndex=0; keySetIndex < mKeySets.size(); keySetIndex++) {
    long keySetID=mKeySets.keyAt(keySetIndex);
    ArraySet<Long> definedKeys=mKeySetMapping.get(keySetID);
    if (publicKeyIds.containsAll(definedKeys)) {
      pkg.keySetData.addSigningKeySet(keySetID);
    }
  }
}
