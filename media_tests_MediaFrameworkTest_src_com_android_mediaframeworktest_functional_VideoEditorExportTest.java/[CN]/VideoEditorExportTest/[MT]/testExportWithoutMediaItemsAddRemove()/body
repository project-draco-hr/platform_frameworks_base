{
  final String videoItemFilename1=INPUT_FILE_PATH + "H263_profile0_176x144_15fps_256kbps_AACLC_32kHz_128kbps_s_1_17.3gp";
  final String imageItemFilename1=INPUT_FILE_PATH + "IMG_640x480.jpg";
  final String maskFilename=INPUT_FILE_PATH + "TransitionSpiral_QVGA.jpg";
  boolean flagForException=false;
  final MediaVideoItem mediaItem1=mVideoEditorHelper.createMediaItem(mVideoEditor,"m1",videoItemFilename1,MediaItem.RENDERING_MODE_BLACK_BORDER);
  mediaItem1.setExtractBoundaries(0,15000);
  mVideoEditor.addMediaItem(mediaItem1);
  final MediaImageItem mediaItem2=mVideoEditorHelper.createMediaItem(mVideoEditor,"m2",imageItemFilename1,15000,MediaItem.RENDERING_MODE_BLACK_BORDER);
  mVideoEditor.addMediaItem(mediaItem2);
  final TransitionAlpha transition1=mVideoEditorHelper.createTAlpha("transition1",mediaItem1,mediaItem2,3000,Transition.BEHAVIOR_LINEAR,maskFilename,50,false);
  mVideoEditor.addTransition(transition1);
  final EffectColor effectColor=mVideoEditorHelper.createEffectItem(mediaItem2,"effect",12000,3000,EffectColor.TYPE_COLOR,EffectColor.PINK);
  mediaItem2.addEffect(effectColor);
  mVideoEditor.removeMediaItem(mediaItem1.getId());
  mVideoEditor.removeMediaItem(mediaItem2.getId());
  try {
    final int[] progressUpdate=new int[100];
    mVideoEditor.export("/sdcard/Test.3gp",MediaProperties.HEIGHT_720,MediaProperties.BITRATE_800K,new ExportProgressListener(){
      int i=0;
      public void onProgress(      VideoEditor ve,      String outFileName,      int progress){
        progressUpdate[i++]=progress;
      }
    }
);
    mVideoEditorHelper.checkProgressCBValues(progressUpdate);
  }
 catch (  IllegalStateException e) {
    flagForException=true;
  }
  assertTrue("Export with MediaItem added and removed",flagForException);
}
