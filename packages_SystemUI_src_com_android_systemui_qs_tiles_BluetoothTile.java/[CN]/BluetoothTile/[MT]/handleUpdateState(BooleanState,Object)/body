{
  final boolean supported=mController.isBluetoothSupported();
  final boolean enabled=mController.isBluetoothEnabled();
  final boolean connected=mController.isBluetoothConnected();
  final boolean connecting=mController.isBluetoothConnecting();
  state.visible=supported;
  state.value=enabled;
  final String stateContentDescription;
  if (enabled) {
    state.label=null;
    if (connected) {
      state.iconId=R.drawable.ic_qs_bluetooth_connected;
      stateContentDescription=mContext.getString(R.string.accessibility_desc_connected);
      state.label=mController.getLastDeviceName();
    }
 else     if (connecting) {
      state.iconId=R.drawable.ic_qs_bluetooth_connecting;
      stateContentDescription=mContext.getString(R.string.accessibility_desc_connecting);
      state.label=mController.getLastDeviceName();
    }
 else {
      state.iconId=R.drawable.ic_qs_bluetooth_on;
      stateContentDescription=mContext.getString(R.string.accessibility_desc_on);
    }
    if (TextUtils.isEmpty(state.label)) {
      state.label=mContext.getString(R.string.quick_settings_bluetooth_label);
    }
  }
 else {
    state.iconId=R.drawable.ic_qs_bluetooth_off;
    state.label=mContext.getString(R.string.quick_settings_bluetooth_off_label);
    stateContentDescription=mContext.getString(R.string.accessibility_desc_off);
  }
  state.contentDescription=mContext.getString(R.string.accessibility_quick_settings_bluetooth,stateContentDescription);
}
