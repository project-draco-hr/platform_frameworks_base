{
  mUserInfo=user;
  mUserSelector=userSelector;
  mUserImage=(ImageView)findViewById(R.id.keyguard_user_avatar);
  mUserName=(TextView)findViewById(R.id.keyguard_user_name);
  Bitmap icon=mUserManager.getUserIcon(user.id);
  if (icon == null) {
    if (DEBUG)     Log.w(TAG,"Couldn't get user icon for user id " + user.id);
    icon=BitmapFactory.decodeResource(mContext.getResources(),R.drawable.ic_contact_picture);
  }
  mFramed=(KeyguardCircleFramedDrawable)KeyguardViewMediator.getAvatarCache().get(user.id);
  if (mFramed == null || !mFramed.verifyParams(mIconSize,mFrameColor,mStroke,mFrameShadowColor,mShadowRadius,mHighlightColor)) {
    Bitmap icon=null;
    try {
      icon=BitmapFactory.decodeFile(rewriteIconPath(user.iconPath));
    }
 catch (    Exception e) {
      if (DEBUG)       Log.d(TAG,"failed to open profile icon " + user.iconPath,e);
    }
    if (icon == null) {
      icon=BitmapFactory.decodeResource(mContext.getResources(),com.android.internal.R.drawable.ic_contact_picture);
    }
    mFramed=new KeyguardCircleFramedDrawable(icon,(int)mIconSize,mFrameColor,mStroke,mFrameShadowColor,mShadowRadius,mHighlightColor);
    KeyguardViewMediator.getAvatarCache().put(user.id,mFramed);
  }
  mFramed.reset();
  mUserImage.setImageDrawable(mFramed);
  mUserName.setText(mUserInfo.name);
  setOnClickListener(mUserSelector);
  mInit=false;
}
