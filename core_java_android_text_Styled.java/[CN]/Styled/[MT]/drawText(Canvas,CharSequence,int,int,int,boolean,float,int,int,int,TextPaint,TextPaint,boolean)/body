{
  if ((direction == Layout.DIR_RIGHT_TO_LEFT && !reverse) || (reverse && direction == Layout.DIR_LEFT_TO_RIGHT)) {
    float ch=foreach(null,text,start,end,Layout.DIR_LEFT_TO_RIGHT,false,0,0,0,0,null,paint,workPaint,true);
    ch*=direction;
    foreach(canvas,text,start,end,-direction,reverse,x + ch,top,y,bottom,null,paint,workPaint,true);
    return ch;
  }
  return foreach(canvas,text,start,end,direction,reverse,x,top,y,bottom,null,paint,workPaint,needWidth);
}
