{
  if ((dir == Layout.DIR_RIGHT_TO_LEFT && !reverse) || (reverse && dir == Layout.DIR_LEFT_TO_RIGHT)) {
    float ch=foreach(null,text,start,end,Layout.DIR_LEFT_TO_RIGHT,false,0,0,0,0,null,paint,workPaint,true);
    ch*=dir;
    foreach(canvas,text,start,end,-dir,reverse,x + ch,top,y,bottom,null,paint,workPaint,true);
    return ch;
  }
  return foreach(canvas,text,start,end,dir,reverse,x,top,y,bottom,null,paint,workPaint,needwid);
}
