{
  if (!(event instanceof MotionEvent) || (event.getSource() & InputDevice.SOURCE_CLASS_POINTER) == 0) {
    return;
  }
  final MotionEvent motionEvent=(MotionEvent)event;
  boolean handled=false;
  try {
    boolean endDrag=false;
    final float newX=motionEvent.getRawX();
    final float newY=motionEvent.getRawY();
switch (motionEvent.getAction()) {
case MotionEvent.ACTION_DOWN:
{
        if (DEBUG_TASK_POSITIONING) {
          Slog.w(TAG,"ACTION_DOWN @ {" + newX + ", "+ newY+ "}");
        }
      }
    break;
case MotionEvent.ACTION_MOVE:
{
    if (DEBUG_TASK_POSITIONING) {
      Slog.w(TAG,"ACTION_MOVE @ {" + newX + ", "+ newY+ "}");
    }
synchronized (mService.mWindowMap) {
      endDrag=notifyMoveLocked(newX,newY);
    }
    try {
      mService.mActivityManager.resizeTask(mTask.mTaskId,mWindowDragBounds,RESIZE_MODE_USER);
    }
 catch (    RemoteException e) {
    }
  }
break;
case MotionEvent.ACTION_UP:
{
if (DEBUG_TASK_POSITIONING) {
  Slog.w(TAG,"ACTION_UP @ {" + newX + ", "+ newY+ "}");
}
endDrag=true;
}
break;
case MotionEvent.ACTION_CANCEL:
{
if (DEBUG_TASK_POSITIONING) {
Slog.w(TAG,"ACTION_CANCEL @ {" + newX + ", "+ newY+ "}");
}
endDrag=true;
}
break;
}
if (endDrag) {
synchronized (mService.mWindowMap) {
endDragLocked();
}
try {
if (mResizing) {
mService.mActivityManager.resizeTask(mTask.mTaskId,mWindowDragBounds,RESIZE_MODE_FORCED);
}
if (mCurrentDimSide != CTRL_NONE) {
final int createMode=mCurrentDimSide == CTRL_LEFT ? DOCKED_STACK_CREATE_MODE_TOP_OR_LEFT : DOCKED_STACK_CREATE_MODE_BOTTOM_OR_RIGHT;
mService.mActivityManager.moveTaskToDockedStack(mTask.mTaskId,createMode,true);
}
}
 catch (RemoteException e) {
}
mService.mH.sendEmptyMessage(H.FINISH_TASK_POSITIONING);
}
handled=true;
}
 catch (Exception e) {
Slog.e(TAG,"Exception caught by drag handleMotion",e);
}
 finally {
finishInputEvent(event,handled);
}
}
