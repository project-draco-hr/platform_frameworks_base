{
  final boolean copying=(transferMode == TRANSFER_MODE_COPY);
  mJobId=String.valueOf(SystemClock.elapsedRealtime());
  mIsCancelled=false;
  final Context context=getApplicationContext();
  final Intent navigateIntent=new Intent(context,FilesActivity.class);
  navigateIntent.putExtra(EXTRA_STACK,(Parcelable)stack);
  final String contentTitle=getString(copying ? R.string.copy_notification_title : R.string.move_notification_title);
  mProgressBuilder=new Notification.Builder(this).setContentTitle(contentTitle).setContentIntent(PendingIntent.getActivity(context,0,navigateIntent,0)).setCategory(Notification.CATEGORY_PROGRESS).setSmallIcon(R.drawable.ic_menu_copy).setOngoing(true);
  final Intent cancelIntent=new Intent(this,CopyService.class);
  cancelIntent.putExtra(EXTRA_CANCEL,mJobId);
  mProgressBuilder.addAction(R.drawable.ic_cab_cancel,getString(android.R.string.cancel),PendingIntent.getService(this,0,cancelIntent,PendingIntent.FLAG_ONE_SHOT | PendingIntent.FLAG_CANCEL_CURRENT));
  final String contentText=getString(copying ? R.string.copy_preparing : R.string.move_preparing);
  mProgressBuilder.setProgress(0,0,true);
  mProgressBuilder.setContentText(contentText);
  mNotificationManager.notify(mJobId,0,mProgressBuilder.build());
  mFailedFiles.clear();
  mBatchSize=calculateFileSizes(srcs);
  mBytesCopied=0;
  mStartTime=SystemClock.elapsedRealtime();
  mLastNotificationTime=0;
  mBytesCopiedSample=0;
  mSampleTime=0;
  mSpeed=0;
  mRemainingTime=0;
}
