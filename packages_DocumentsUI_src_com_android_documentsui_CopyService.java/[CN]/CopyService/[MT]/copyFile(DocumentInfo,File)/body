{
  final Context context=getApplicationContext();
  final ContentResolver resolver=context.getContentResolver();
  final File destinationFile=new File(destinationDir,srcInfo.displayName);
  final Uri destinationUri=Uri.fromFile(destinationFile);
  InputStream source=null;
  OutputStream destination=null;
  boolean errorOccurred=false;
  try {
    source=resolver.openInputStream(srcInfo.derivedUri);
    destination=resolver.openOutputStream(destinationUri);
    byte[] buffer=new byte[8192];
    int len;
    while (!mIsCancelled && ((len=source.read(buffer)) != -1)) {
      destination.write(buffer,0,len);
      makeProgress(len);
    }
  }
 catch (  IOException e) {
    errorOccurred=true;
    Log.e(TAG,"Error while copying " + srcInfo.displayName,e);
  }
 finally {
    IoUtils.closeQuietly(source);
    IoUtils.closeQuietly(destination);
  }
  if (errorOccurred || mIsCancelled) {
    if (!destinationFile.delete()) {
      Log.w(TAG,"Failed to clean up partially copied file " + srcInfo.displayName);
    }
  }
}
