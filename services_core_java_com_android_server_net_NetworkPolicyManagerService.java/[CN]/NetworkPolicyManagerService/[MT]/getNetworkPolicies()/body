{
  mContext.enforceCallingOrSelfPermission(MANAGE_NETWORK_POLICY,TAG);
  mContext.enforceCallingOrSelfPermission(READ_PHONE_STATE,TAG);
synchronized (mRulesLock) {
    final int size=mNetworkPolicy.size();
    final NetworkPolicy[] policies=new NetworkPolicy[size];
    for (int i=0; i < size; i++) {
      policies[i]=mNetworkPolicy.valueAt(i);
    }
    return policies;
  }
}
