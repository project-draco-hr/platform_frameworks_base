{
  mContext.enforceCallingOrSelfPermission(MANAGE_NETWORK_POLICY,TAG);
  maybeRefreshTrustedTime();
synchronized (mRulesLock) {
    mNetworkPolicy.clear();
    for (    NetworkPolicy policy : policies) {
      mNetworkPolicy.put(policy.template,policy);
    }
    updateNetworkEnabledLocked();
    updateNetworkRulesLocked();
    updateNotificationsLocked();
    writePolicyLocked();
  }
}
