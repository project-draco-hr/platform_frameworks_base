{
  mContext.enforceCallingOrSelfPermission(MANAGE_NETWORK_POLICY,TAG);
  final long token=Binder.clearCallingIdentity();
  try {
    maybeRefreshTrustedTime();
synchronized (mRulesLock) {
      normalizePoliciesLocked(policies);
      updateNetworkEnabledLocked();
      updateNetworkRulesLocked();
      updateNotificationsLocked();
      writePolicyLocked();
    }
  }
  finally {
    Binder.restoreCallingIdentity(token);
  }
}
