{
  final int oldUidState=mUidState.get(uid,ActivityManager.PROCESS_STATE_CACHED_EMPTY);
  if (oldUidState != uidState) {
    mUidState.put(uid,uidState);
    updateRulesForUidStateChangeLocked(uid,oldUidState,uidState);
    if (mDeviceIdleMode && isProcStateAllowedWhileIdle(oldUidState) != isProcStateAllowedWhileIdle(uidState)) {
      updateRuleForDeviceIdleLocked(uid);
    }
  }
}
