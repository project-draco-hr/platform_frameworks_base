{
  if (mStatusBarManager == null) {
    mStatusBarManager=(StatusBarManager)mContext.getSystemService(Context.STATUS_BAR_SERVICE);
  }
  if (mStatusBarManager == null) {
    Log.w(TAG,"Could not get status bar manager");
  }
 else {
    if (mShowLockIcon) {
      if (mShowing && isSecure()) {
        if (!mShowingLockIcon) {
          String contentDescription=mContext.getString(com.android.internal.R.string.status_bar_device_locked);
          mStatusBarManager.setIcon("secure",com.android.internal.R.drawable.stat_sys_secure,0,contentDescription);
          mShowingLockIcon=true;
        }
      }
 else {
        if (mShowingLockIcon) {
          mStatusBarManager.removeIcon("secure");
          mShowingLockIcon=false;
        }
      }
    }
    int flags=StatusBarManager.DISABLE_NONE;
    if (mShowing) {
      flags|=StatusBarManager.DISABLE_RECENT;
      if (isSecure() || !ENABLE_INSECURE_STATUS_BAR_EXPAND) {
        flags|=StatusBarManager.DISABLE_EXPAND;
      }
      if (isSecure()) {
        flags|=StatusBarManager.DISABLE_NOTIFICATION_TICKER;
      }
    }
    if (DEBUG) {
      Log.d(TAG,"adjustStatusBarLocked: mShowing=" + mShowing + " mHidden="+ mHidden+ " isSecure="+ isSecure()+ " --> flags=0x"+ Integer.toHexString(flags));
    }
    mStatusBarManager.disable(flags);
  }
}
