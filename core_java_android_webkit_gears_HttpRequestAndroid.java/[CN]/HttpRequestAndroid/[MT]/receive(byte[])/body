{
  if (inputStream == null) {
    try {
      inputStream=connection.getInputStream();
    }
 catch (    IOException inputException) {
      log("Failed to connect InputStream: " + inputException);
      inputStream=connection.getErrorStream();
      if (inputStream == null) {
        log("No InputStream");
        return 0;
      }
    }
  }
synchronized (this) {
    inBlockingOperation=true;
  }
  int ret;
  try {
    int got=inputStream.read(buf);
    if (got > 0) {
      ret=got;
    }
 else {
      inputStream.close();
      ret=0;
    }
  }
 catch (  IOException e) {
    log("Got IOException in inputStream.read(): " + e.toString());
    ret=-1;
  }
 finally {
synchronized (this) {
      inBlockingOperation=false;
    }
  }
  return ret;
}
