{
  int roamInd=getServiceState().getCdmaRoamingIndicator();
  int defRoamInd=getServiceState().getCdmaDefaultRoamingIndicator();
  int ret=-1;
switch (roamInd) {
case EriInfo.ROAMING_INDICATOR_ON:
case EriInfo.ROAMING_INDICATOR_OFF:
    Log.d(LOG_TAG,"Using Standard Roaming Indicator (non-ERI): normal");
  ret=EriInfo.ROAMING_ICON_MODE_NORMAL;
break;
case EriInfo.ROAMING_INDICATOR_FLASH:
Log.d(LOG_TAG,"Using Standard Roaming Indicator (non-ERI): flashing");
ret=EriInfo.ROAMING_ICON_MODE_FLASH;
break;
default :
if (!mEriManager.isEriFileLoaded()) {
if (defRoamInd > 2) {
Log.d(LOG_TAG,"ERI File not loaded, defRoamInd > 2, flashing");
ret=EriInfo.ROAMING_ICON_MODE_FLASH;
}
 else {
switch (defRoamInd) {
case EriInfo.ROAMING_INDICATOR_ON:
case EriInfo.ROAMING_INDICATOR_OFF:
Log.d(LOG_TAG,"ERI File not loaded, normal");
ret=EriInfo.ROAMING_ICON_MODE_NORMAL;
break;
case EriInfo.ROAMING_INDICATOR_FLASH:
Log.d(LOG_TAG,"ERI File not loaded, normal");
ret=EriInfo.ROAMING_ICON_MODE_FLASH;
break;
}
}
}
 else if (mEriManager.getEriInfo(roamInd) == null) {
if (mEriManager.getEriInfo(defRoamInd) == null) {
Log.e(LOG_TAG,"Error: defRoamInd not defined in ERI file, normal");
ret=EriInfo.ROAMING_ICON_MODE_NORMAL;
}
 else {
int mode=mEriManager.getEriInfo(defRoamInd).mIconMode;
Log.d(LOG_TAG,"ERI entry " + roamInd + " not present, icon  mode: "+ mode);
ret=mode;
}
}
 else {
int mode=mEriManager.getEriInfo(roamInd).mIconMode;
Log.d(LOG_TAG,"Using ERI icon mode: " + mode);
ret=mode;
}
break;
}
return ret;
}
