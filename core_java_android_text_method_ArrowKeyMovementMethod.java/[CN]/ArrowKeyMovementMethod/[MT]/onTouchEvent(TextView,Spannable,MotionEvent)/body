{
  boolean handled=Touch.onTouchEvent(widget,buffer,event);
  if (widget.isFocused() && !widget.didTouchFocusSelect()) {
    if (event.getAction() == MotionEvent.ACTION_UP) {
      int x=(int)event.getX();
      int y=(int)event.getY();
      x-=widget.getTotalPaddingLeft();
      y-=widget.getTotalPaddingTop();
      x+=widget.getScrollX();
      y+=widget.getScrollY();
      Layout layout=widget.getLayout();
      int line=layout.getLineForVertical(y);
      int off=layout.getOffsetForHorizontal(line,x);
      boolean cap=(MetaKeyKeyListener.getMetaState(buffer,KeyEvent.META_SHIFT_ON) == 1) || (MetaKeyKeyListener.getMetaState(buffer,MetaKeyKeyListener.META_SELECTING) != 0);
      if (cap) {
        Selection.extendSelection(buffer,off);
      }
 else {
        Selection.setSelection(buffer,off);
      }
      MetaKeyKeyListener.adjustMetaAfterKeypress(buffer);
      MetaKeyKeyListener.resetLockedMeta(buffer);
      return true;
    }
  }
  return handled;
}
