{
  if ((dir & (View.FOCUS_FORWARD | View.FOCUS_DOWN)) != 0) {
    Layout layout=view.getLayout();
    if (layout == null) {
      Selection.setSelection(text,text.length());
    }
 else {
      if (layout.getLineCount() == 1) {
        Selection.setSelection(text,text.length());
      }
 else {
        Selection.setSelection(text,layout.getLineStart(1) - 1);
      }
    }
  }
 else {
    Selection.setSelection(text,text.length());
  }
}
