{
synchronized (mGadgetIds) {
    GadgetId id=lookupGadgetIdLocked(gadgetId);
    if (id == null) {
      throw new IllegalArgumentException("bad gadgetId");
    }
    if (id.info != null) {
      throw new IllegalArgumentException("gadgetId " + gadgetId + " already bound to "+ id.info.provider);
    }
    GadgetInfo info=lookupGadgetInfoLocked(provider);
    if (info == null) {
      throw new IllegalArgumentException("not a gadget provider: " + provider);
    }
    id.info=info;
  }
}
