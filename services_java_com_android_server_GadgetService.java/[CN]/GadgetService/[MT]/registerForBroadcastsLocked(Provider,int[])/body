{
  if (p.info.updatePeriodMillis > 0) {
    boolean alreadyRegistered=p.broadcast != null;
    int instancesSize=p.instances.size();
    Intent intent=new Intent(GadgetManager.GADGET_UPDATE_ACTION);
    intent.putExtra(GadgetManager.EXTRA_GADGET_IDS,gadgetIds);
    intent.setComponent(p.info.provider);
    long token=Binder.clearCallingIdentity();
    try {
      p.broadcast=PendingIntent.getBroadcast(mContext,1,intent,PendingIntent.FLAG_UPDATE_CURRENT);
    }
  finally {
      Binder.restoreCallingIdentity(token);
    }
    if (!alreadyRegistered) {
      mAlarmManager.setInexactRepeating(AlarmManager.ELAPSED_REALTIME_WAKEUP,SystemClock.elapsedRealtime() + p.info.updatePeriodMillis,p.info.updatePeriodMillis,p.broadcast);
    }
  }
}
