{
  if (mAnimateScreenLights) {
synchronized (mLocks) {
      long now=SystemClock.uptimeMillis();
      boolean more=mScreenBrightness.stepLocked();
      if (more) {
        mScreenOffHandler.postAtTime(this,now + (1000 / 60));
      }
    }
  }
 else {
synchronized (mLocks) {
      final boolean animate=animating && targetValue == Power.BRIGHTNESS_OFF && !mHeadless;
      if (animate) {
        nativeStartSurfaceFlingerAnimation(mScreenOffReason == WindowManagerPolicy.OFF_BECAUSE_OF_PROX_SENSOR ? 0 : mAnimationSetting);
      }
      mScreenBrightness.jumpToTargetLocked();
    }
  }
}
