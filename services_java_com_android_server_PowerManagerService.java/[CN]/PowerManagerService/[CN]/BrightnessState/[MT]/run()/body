{
  if (mAnimateScreenLights) {
synchronized (mLocks) {
      long now=SystemClock.uptimeMillis();
      boolean more=mScreenBrightness.stepLocked();
      if (more) {
        mScreenOffHandler.postAtTime(this,now + (1000 / 60));
      }
    }
  }
 else {
    boolean animate;
    boolean jump;
synchronized (mLocks) {
      jump=animating;
      animate=jump && targetValue == Power.BRIGHTNESS_OFF;
    }
    if (animate) {
      nativeStartSurfaceFlingerAnimation(mScreenOffReason == WindowManagerPolicy.OFF_BECAUSE_OF_PROX_SENSOR ? 0 : mAnimationSetting);
    }
    mScreenBrightness.jumpToTarget();
  }
}
