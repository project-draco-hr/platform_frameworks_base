{
synchronized (mLocks) {
    boolean wasPowered=mIsPowered;
    mIsPowered=mBatteryService.isPowered();
    if (mIsPowered != wasPowered) {
      updateWakeLockLocked();
synchronized (mLocks) {
        boolean savedActivityAllowed=mUserActivityAllowed;
        mUserActivityAllowed=true;
        userActivity(SystemClock.uptimeMillis(),false);
        mUserActivityAllowed=savedActivityAllowed;
      }
    }
  }
}
