{
synchronized (this) {
    startValue=currentValue;
    endValue=target;
    currentMask=mask;
    duration=(int)(mWindowScaleAnimation * animationDuration);
    startTimeMillis=SystemClock.elapsedRealtime();
    mInitialAnimation=currentValue == 0 && target > 0;
    if (mDebugLightAnimation) {
      Log.v(TAG,"animateTo(target=" + target + ", mask="+ mask+ ", duration="+ animationDuration+ ")"+ ", currentValue="+ currentValue+ ", startTime="+ startTimeMillis);
    }
    if (target != currentValue) {
      final boolean doScreenAnim=(mask & (SCREEN_BRIGHT_BIT | SCREEN_ON_BIT)) != 0;
      final boolean turningOff=endValue == Power.BRIGHTNESS_OFF;
      if (turningOff && doScreenAnim) {
        mScreenBrightnessHandler.removeCallbacksAndMessages(null);
        screenOffFinishedAnimatingLocked(mScreenOffReason);
        duration=200;
      }
      if (doScreenAnim) {
        animateInternal(mask,turningOff,0);
      }
    }
  }
}
