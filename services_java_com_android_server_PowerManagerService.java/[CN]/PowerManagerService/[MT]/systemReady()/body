{
  mSensorManager=new SensorManager(mHandlerThread.getLooper());
  mProximitySensor=mSensorManager.getDefaultSensor(Sensor.TYPE_PROXIMITY);
  if (mUseSoftwareAutoBrightness) {
    mLightSensor=mSensorManager.getDefaultSensor(Sensor.TYPE_LIGHT);
  }
  if (mUseSoftwareAutoBrightness) {
    setPowerState(SCREEN_BRIGHT);
  }
 else {
    setPowerState(ALL_BRIGHT);
  }
synchronized (mLocks) {
    Slog.d(TAG,"system ready!");
    mDoneBooting=true;
    enableLightSensorLocked(mUseSoftwareAutoBrightness && mAutoBrightessEnabled);
    long identity=Binder.clearCallingIdentity();
    try {
      mBatteryStats.noteScreenBrightness(getPreferredBrightness());
      mBatteryStats.noteScreenOn();
    }
 catch (    RemoteException e) {
    }
 finally {
      Binder.restoreCallingIdentity(identity);
    }
  }
}
