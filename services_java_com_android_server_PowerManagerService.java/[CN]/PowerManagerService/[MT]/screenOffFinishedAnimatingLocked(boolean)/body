{
  EventLog.writeEvent(LOG_POWER_SCREEN_STATE,0,becauseOfUser ? 1 : 0,mTotalTouchDownTime,mTouchCycles);
  mLastTouchDown=0;
  int err=setScreenStateLocked(false);
  mAnimatingScreenOff=false;
  if (mScreenOnStartTime != 0) {
    mScreenOnTime+=SystemClock.elapsedRealtime() - mScreenOnStartTime;
    mScreenOnStartTime=0;
  }
  if (err == 0) {
    int why=becauseOfUser ? WindowManagerPolicy.OFF_BECAUSE_OF_USER : WindowManagerPolicy.OFF_BECAUSE_OF_TIMEOUT;
    sendNotificationLocked(false,why);
  }
  return err;
}
