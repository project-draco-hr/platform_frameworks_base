{
  if (((mPokey & POKE_LOCK_IGNORE_CHEEK_EVENTS) != 0) && (eventType == CHEEK_EVENT || eventType == TOUCH_EVENT)) {
    if (false) {
      Log.d(TAG,"dropping cheek or short event mPokey=0x" + Integer.toHexString(mPokey));
    }
    return;
  }
  if (((mPokey & POKE_LOCK_IGNORE_TOUCH_AND_CHEEK_EVENTS) != 0) && (eventType == TOUCH_EVENT || eventType == TOUCH_UP_EVENT || eventType == LONG_TOUCH_EVENT || eventType == CHEEK_EVENT)) {
    if (false) {
      Log.d(TAG,"dropping touch mPokey=0x" + Integer.toHexString(mPokey));
    }
    return;
  }
  if (false) {
    if (((mPokey & POKE_LOCK_IGNORE_CHEEK_EVENTS) != 0)) {
      Log.d(TAG,"userActivity !!!");
    }
 else {
      Log.d(TAG,"mPokey=0x" + Integer.toHexString(mPokey));
    }
  }
synchronized (mLocks) {
    if (mSpew) {
      Log.d(TAG,"userActivity mLastEventTime=" + mLastEventTime + " time="+ time+ " mUserActivityAllowed="+ mUserActivityAllowed+ " mUserState=0x"+ Integer.toHexString(mUserState)+ " mWakeLockState=0x"+ Integer.toHexString(mWakeLockState)+ " mProximitySensorActive="+ mProximitySensorActive+ " force="+ force);
    }
    if (mScreenBrightness.animating && mScreenBrightness.targetValue == 0) {
      Log.d(TAG,"ignoring user activity while turning off screen");
      return;
    }
    if (mLastEventTime <= time || force) {
      mLastEventTime=time;
      if ((mUserActivityAllowed && !mProximitySensorActive) || force) {
        if (eventType == BUTTON_EVENT && !mUseSoftwareAutoBrightness) {
          mUserState=(mKeyboardVisible ? ALL_BRIGHT : SCREEN_BUTTON_BRIGHT);
        }
 else {
          mUserState|=SCREEN_BRIGHT;
        }
        int uid=Binder.getCallingUid();
        long ident=Binder.clearCallingIdentity();
        try {
          mBatteryStats.noteUserActivity(uid,eventType);
        }
 catch (        RemoteException e) {
        }
 finally {
          Binder.restoreCallingIdentity(ident);
        }
        mWakeLockState=mLocks.reactivateScreenLocksLocked();
        setPowerState(mUserState | mWakeLockState,noChangeLights,true);
        setTimeoutLocked(time,SCREEN_BRIGHT);
      }
    }
  }
}
