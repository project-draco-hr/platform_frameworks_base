{
  boolean enabled=(mode == SCREEN_BRIGHTNESS_MODE_AUTOMATIC);
  if (mAutoBrightessEnabled != enabled) {
    mAutoBrightessEnabled=enabled;
    if (mUseHardwareAutoBrightness) {
      mHardware.setAutoBrightness_UNCHECKED(enabled);
      if (screenIsOn()) {
        setBacklightBrightness((int)mScreenBrightness.curValue);
      }
    }
 else     if (mUseSoftwareAutoBrightness && screenIsOn()) {
      if (mLightSensorValue >= 0) {
        int value=(int)mLightSensorValue;
        mLightSensorValue=-1;
        lightSensorChangedLocked(value);
      }
    }
  }
}
