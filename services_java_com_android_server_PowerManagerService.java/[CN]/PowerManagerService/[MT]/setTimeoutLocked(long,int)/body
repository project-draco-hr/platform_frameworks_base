{
  if (mDoneBooting) {
    mHandler.removeCallbacks(mTimeoutTask);
    mTimeoutTask.nextState=nextState;
    long when=now;
switch (nextState) {
case SCREEN_BRIGHT:
      when+=mKeylightDelay;
    break;
case SCREEN_DIM:
  if (mDimDelay >= 0) {
    when+=mDimDelay;
    break;
  }
 else {
    Log.w(TAG,"mDimDelay=" + mDimDelay + " while trying to dim");
  }
case SCREEN_OFF:
synchronized (mLocks) {
  when+=mScreenOffDelay;
}
break;
}
if (mSpew) {
Log.d(TAG,"setTimeoutLocked now=" + now + " nextState="+ nextState+ " when="+ when);
}
mHandler.postAtTime(mTimeoutTask,when);
mNextTimeout=when;
}
}
