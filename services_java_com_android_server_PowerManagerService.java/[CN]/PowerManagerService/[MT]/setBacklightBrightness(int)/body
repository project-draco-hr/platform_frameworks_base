{
  mContext.enforceCallingOrSelfPermission(android.Manifest.permission.DEVICE_POWER,null);
synchronized (mLocks) {
    brightness=Math.max(brightness,mScreenBrightnessDim);
    mLcdLight.setBrightness(brightness);
    mKeyboardLight.setBrightness(mKeyboardVisible ? brightness : 0);
    mButtonLight.setBrightness(brightness);
    long identity=Binder.clearCallingIdentity();
    try {
      mBatteryStats.noteScreenBrightness(brightness);
    }
 catch (    RemoteException e) {
      Slog.w(TAG,"RemoteException calling noteScreenBrightness on BatteryStatsService",e);
    }
 finally {
      Binder.restoreCallingIdentity(identity);
    }
    mScreenBrightnessAnimator.animateTo(brightness,SCREEN_BRIGHT_BIT,0);
  }
}
