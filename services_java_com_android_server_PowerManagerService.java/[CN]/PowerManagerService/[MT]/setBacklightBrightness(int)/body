{
  mContext.enforceCallingOrSelfPermission(android.Manifest.permission.DEVICE_POWER,null);
  brightness=Math.max(brightness,Power.BRIGHTNESS_DIM);
  mLcdLight.setBrightness(brightness);
  mKeyboardLight.setBrightness(mKeyboardVisible ? brightness : 0);
  mButtonLight.setBrightness(brightness);
  long identity=Binder.clearCallingIdentity();
  try {
    mBatteryStats.noteScreenBrightness(brightness);
  }
 catch (  RemoteException e) {
    Log.w(TAG,"RemoteException calling noteScreenBrightness on BatteryStatsService",e);
  }
 finally {
    Binder.restoreCallingIdentity(identity);
  }
  if (ANIMATE_SCREEN_LIGHTS) {
    mScreenBrightness.curValue=brightness;
    mScreenBrightness.animating=false;
    mScreenBrightness.targetValue=-1;
  }
  if (ANIMATE_KEYBOARD_LIGHTS) {
    mKeyboardBrightness.curValue=brightness;
    mKeyboardBrightness.animating=false;
    mKeyboardBrightness.targetValue=-1;
  }
  if (ANIMATE_BUTTON_LIGHTS) {
    mButtonBrightness.curValue=brightness;
    mButtonBrightness.animating=false;
    mButtonBrightness.targetValue=-1;
  }
}
