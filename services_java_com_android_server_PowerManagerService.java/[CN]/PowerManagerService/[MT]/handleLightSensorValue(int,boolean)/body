{
  long milliseconds=SystemClock.elapsedRealtime();
  if (mLightSensorValue == -1 || milliseconds < mLastScreenOnTime + mLightSensorWarmupTime || mWaitingForFirstLightSensor) {
    mHandler.removeCallbacks(mAutoBrightnessTask);
    mLightSensorPendingDecrease=false;
    mLightSensorPendingIncrease=false;
    lightSensorChangedLocked(value,immediate);
  }
 else {
    if ((value > mLightSensorValue && mLightSensorPendingDecrease) || (value < mLightSensorValue && mLightSensorPendingIncrease) || (value == mLightSensorValue)|| (!mLightSensorPendingDecrease && !mLightSensorPendingIncrease)) {
      mHandler.removeCallbacks(mAutoBrightnessTask);
      mLightSensorPendingDecrease=(value < mLightSensorValue);
      mLightSensorPendingIncrease=(value > mLightSensorValue);
      if (mLightSensorPendingDecrease || mLightSensorPendingIncrease) {
        mLightSensorPendingValue=value;
        mHandler.postDelayed(mAutoBrightnessTask,LIGHT_SENSOR_DELAY);
      }
    }
 else {
      mLightSensorPendingValue=value;
    }
  }
}
