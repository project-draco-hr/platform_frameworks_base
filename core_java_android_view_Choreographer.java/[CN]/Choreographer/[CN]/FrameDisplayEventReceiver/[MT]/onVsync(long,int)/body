{
  if (mHavePendingVsync) {
    if (DEBUG) {
      Log.d(TAG,"Already have a pending vsync event.  There should only be " + "one at a time but they can double up when a fake vsync " + "is handled in place of a real one.");
    }
    mHandler.removeCallbacks(this);
  }
 else {
    mHavePendingVsync=true;
  }
  long now=System.nanoTime();
  if (timestampNanos > now) {
    Log.w(TAG,"Frame time is " + ((timestampNanos - now) * 0.000001f) + " ms in the future!  Check that graphics HAL is generating vsync "+ "timestamps using the correct timebase.");
    timestampNanos=now;
  }
  mHandler.removeMessages(MSG_FAKE_VSYNC);
  mTimestampNanos=timestampNanos;
  mFrame=frame;
  Message msg=Message.obtain(mHandler,this);
  msg.setAsynchronous(true);
  mHandler.sendMessageAtTime(msg,timestampNanos / NANOS_PER_MS);
}
