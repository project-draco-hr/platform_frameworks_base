{
  if (action == null) {
    throw new IllegalArgumentException("action must not be null");
  }
  if (callbackType < 0 || callbackType > CALLBACK_LAST) {
    throw new IllegalArgumentException("callbackType is invalid");
  }
  if (DEBUG) {
    Log.d(TAG,"PostCallback: type=" + callbackType + ", action="+ action+ ", token="+ token+ ", delayMillis="+ delayMillis);
  }
synchronized (mLock) {
    final long now=SystemClock.uptimeMillis();
    final long dueTime=now + delayMillis;
    mCallbackQueues[callbackType].addCallbackLocked(dueTime,action,token);
    if (dueTime <= now) {
      scheduleFrameLocked(now);
    }
 else {
      Message msg=mHandler.obtainMessage(MSG_DO_SCHEDULE_CALLBACK,action);
      msg.arg1=callbackType;
      msg.setAsynchronous(true);
      mHandler.sendMessageAtTime(msg,dueTime);
    }
  }
}
