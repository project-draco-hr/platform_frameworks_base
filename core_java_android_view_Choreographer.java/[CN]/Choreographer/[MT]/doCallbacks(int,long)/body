{
  CallbackRecord callbacks;
synchronized (mLock) {
    final long now=SystemClock.uptimeMillis();
    callbacks=mCallbackQueues[callbackType].extractDueCallbacksLocked(now);
    if (callbacks == null) {
      return;
    }
    mCallbacksRunning=true;
  }
  try {
    for (CallbackRecord c=callbacks; c != null; c=c.next) {
      if (DEBUG) {
        Log.d(TAG,"RunCallback: type=" + callbackType + ", action="+ c.action+ ", token="+ c.token+ ", latencyMillis="+ (SystemClock.uptimeMillis() - c.dueTime));
      }
      c.run(frameTimeNanos);
    }
  }
  finally {
synchronized (mLock) {
      mCallbacksRunning=false;
      do {
        final CallbackRecord next=callbacks.next;
        recycleCallbackLocked(callbacks);
        callbacks=next;
      }
 while (callbacks != null);
    }
  }
}
