{
  if (mUserExpanding) {
    int expandedVisualType=getVisualTypeForHeight(mContainingNotification.getMaxExpandHeight());
    int collapsedVisualType=getVisualTypeForHeight(mContainingNotification.getMinExpandHeight());
    return mTransformationStartVisibleType == collapsedVisualType ? expandedVisualType : collapsedVisualType;
  }
  int viewHeight=Math.min(mContentHeight,mContainingNotification.getIntrinsicHeight());
  return getVisualTypeForHeight(viewHeight);
}
