{
  if (mContractedChild == null) {
    return;
  }
  if (mUserExpanding) {
    updateContentTransformation();
  }
 else {
    int visibleType=calculateVisibleType();
    if (visibleType != mVisibleType || force) {
      View visibleView=getViewForVisibleType(visibleType);
      if (visibleView != null) {
        visibleView.setVisibility(VISIBLE);
        transferRemoteInputFocus(visibleType);
      }
      if (animate && ((visibleType == VISIBLE_TYPE_EXPANDED && mExpandedChild != null) || (visibleType == VISIBLE_TYPE_HEADSUP && mHeadsUpChild != null) || (visibleType == VISIBLE_TYPE_SINGLELINE && mSingleLineView != null)|| visibleType == VISIBLE_TYPE_CONTRACTED)) {
        animateToVisibleType(visibleType);
      }
 else {
        updateViewVisibilities(visibleType);
      }
      mVisibleType=visibleType;
      updateBackgroundColor(animate);
    }
  }
  if (mForceSelectNextLayout) {
    forceUpdateVisibilities();
  }
}
