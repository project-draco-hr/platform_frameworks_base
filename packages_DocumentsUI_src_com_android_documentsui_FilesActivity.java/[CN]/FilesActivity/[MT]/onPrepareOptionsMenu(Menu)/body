{
  boolean shown=super.onPrepareOptionsMenu(menu);
  menu.findItem(R.id.menu_file_size).setVisible(true);
  menu.findItem(R.id.menu_advanced).setVisible(true);
  final MenuItem createDir=menu.findItem(R.id.menu_create_dir);
  final MenuItem newWindow=menu.findItem(R.id.menu_new_window);
  final MenuItem pasteFromCb=menu.findItem(R.id.menu_paste_from_clipboard);
  boolean canCreateDir=canCreateDirectory();
  createDir.setShowAsAction(MenuItem.SHOW_AS_ACTION_NEVER);
  createDir.setVisible(canCreateDir);
  createDir.setEnabled(canCreateDir);
  newWindow.setShowAsAction(MenuItem.SHOW_AS_ACTION_NEVER);
  newWindow.setVisible(mProductivityDevice);
  newWindow.setEnabled(mProductivityDevice);
  pasteFromCb.setShowAsAction(MenuItem.SHOW_AS_ACTION_NEVER);
  pasteFromCb.setVisible(true);
  pasteFromCb.setEnabled(mClipper.hasItemsToPaste());
  return shown;
}
