{
  if (type == BluetoothSocket.TYPE_RFCOMM && uuid == null && fd == -1) {
    if (port < 1 || port > MAX_RFCOMM_CHANNEL) {
      throw new IOException("Invalid RFCOMM channel: " + port);
    }
  }
  mUuid=uuid;
  mType=type;
  mAuth=auth;
  mEncrypt=encrypt;
  mDevice=device;
  mPort=port;
  mFd=fd;
  mSocketState=SocketState.INIT;
  if (device == null) {
    mAddress=BluetoothAdapter.getDefaultAdapter().getAddress();
  }
 else {
    mAddress=device.getAddress();
  }
  mInputStream=new BluetoothInputStream(this);
  mOutputStream=new BluetoothOutputStream(this);
  if (sBluetoothProxy == null) {
synchronized (BluetoothSocket.class) {
      if (sBluetoothProxy == null) {
        IBinder b=ServiceManager.getService(BluetoothAdapter.BLUETOOTH_SERVICE);
        if (b == null)         throw new RuntimeException("Bluetooth service not available");
        sBluetoothProxy=IBluetooth.Stub.asInterface(b);
      }
    }
  }
}
