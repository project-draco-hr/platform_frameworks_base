{
  boolean rt=super.onTouchEvent(event);
  if (DEBUG)   logTouchEvent("onTouchEvent",rt,event);
  if (!isApplicable() || !mPeekable) {
    return rt;
  }
  if (event.getAction() == MotionEvent.ACTION_DOWN) {
    mDownY=event.getY();
    if (DEBUG)     log("  mDownY=" + mDownY);
    mDownBottom=mBottom;
    return true;
  }
 else   if (event.getAction() == MotionEvent.ACTION_MOVE) {
    final float dy=event.getY() - mDownY;
    if (!mPopped) {
      mPopped=true;
      AsyncTask.execute(mPopVibration);
    }
    setPeeked(mDownBottom + (int)dy,getExpandedBottom(),false);
  }
 else   if (event.getAction() == MotionEvent.ACTION_UP || event.getAction() == MotionEvent.ACTION_CANCEL) {
    final float dy=event.getY() - mDownY;
    setPeeked(mDownBottom + (int)dy,getExpandedBottom(),true);
    if (mPeekable) {
      close();
    }
  }
  return rt;
}
