{
  super(context,attrs);
  if (DEBUG)   log("new %s()",getClass().getSimpleName());
  mContext=context;
  final int iconSize=mContext.getResources().getDimensionPixelSize(com.android.internal.R.dimen.notification_large_icon_width);
  final int topRowSize=iconSize * 2 / 3;
  final int p=topRowSize / 7;
  mPathPaint=new Paint(Paint.ANTI_ALIAS_FLAG);
  mPathPaint.setStyle(Paint.Style.STROKE);
  mPathPaint.setColor(GRAY);
  mPathPaint.setStrokeWidth(p / 2);
  mSettingsButton=new ImageView(mContext);
  mSettingsButton.setPadding(p,p,p,p);
  mSettingsButton.setImageResource(R.drawable.ic_notify_settings_normal);
  LayoutParams lp=new LayoutParams(topRowSize,topRowSize);
  lp.topMargin=p;
  lp.leftMargin=p;
  addView(mSettingsButton,lp);
  mSettingsButton.setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      if (mAdapter != null && mAdapter.getMode() == Adapter.MODE_LIMITED) {
        mAdapter.configure();
      }
      bounce(mSettingsButton,null);
    }
  }
);
  mModeSpinner=new ModeSpinner(mContext);
  mModeSpinner.setId(android.R.id.title);
  lp=new LayoutParams(LayoutParams.WRAP_CONTENT,topRowSize);
  lp.topMargin=p;
  lp.addRule(CENTER_HORIZONTAL);
  addView(mModeSpinner,lp);
  mActionButton=new TextView(mContext);
  mActionButton.setTextColor(GRAY);
  mActionButton.setTypeface(CONDENSED);
  mActionButton.setTextSize(TypedValue.COMPLEX_UNIT_PX,mActionButton.getTextSize() * 1.2f);
  mActionButton.setAllCaps(true);
  mActionButton.setGravity(Gravity.CENTER);
  mActionButton.setPadding(p,0,p * 2,0);
  lp=new LayoutParams(LayoutParams.WRAP_CONTENT,topRowSize);
  lp.topMargin=p;
  lp.addRule(ALIGN_PARENT_RIGHT);
  lp.addRule(ALIGN_BASELINE,mModeSpinner.getId());
  addView(mActionButton,lp);
  mActionButton.setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      bounce(v,null);
      beginOrEnd();
    }
  }
);
  mDivider=new View(mContext);
  mDivider.setId(android.R.id.empty);
  mDivider.setBackgroundColor(GRAY);
  lp=new LayoutParams(LayoutParams.MATCH_PARENT,2);
  lp.addRule(BELOW,mModeSpinner.getId());
  lp.topMargin=p;
  lp.bottomMargin=p;
  addView(mDivider,lp);
  mUntilPager=new UntilPager(mContext,mPathPaint,iconSize * 3 / 4);
  mUntilPager.setId(android.R.id.tabhost);
  lp=new LayoutParams(LayoutParams.MATCH_PARENT,LayoutParams.WRAP_CONTENT);
  lp.addRule(BELOW,mDivider.getId());
  addView(mUntilPager,lp);
  mAlarmWarning=new AlarmWarning(mContext);
  lp=new LayoutParams(LayoutParams.WRAP_CONTENT,LayoutParams.WRAP_CONTENT);
  lp.addRule(CENTER_HORIZONTAL);
  lp.addRule(BELOW,mUntilPager.getId());
  lp.bottomMargin=p;
  addView(mAlarmWarning,lp);
}
