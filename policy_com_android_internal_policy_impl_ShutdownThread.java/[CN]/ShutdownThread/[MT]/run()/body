{
  boolean bluetoothOff;
  boolean radioOff;
  try {
    bluetoothOff=sBluetooth == null || sBluetooth.getBluetoothState() == BluetoothDevice.BLUETOOTH_STATE_OFF;
    if (!bluetoothOff) {
      sBluetooth.disable(false);
    }
  }
 catch (  RemoteException ex) {
    Log.e(TAG,"RemoteException during bluetooth shutdown",ex);
    bluetoothOff=true;
  }
  try {
    radioOff=sPhone == null || !sPhone.isRadioOn();
    if (!radioOff) {
      sPhone.setRadio(false);
    }
  }
 catch (  RemoteException ex) {
    Log.e(TAG,"RemoteException during radio shutdown",ex);
    radioOff=true;
  }
  for (int i=0; i < MAX_NUM_PHONE_STATE_READS; i++) {
    if (!bluetoothOff) {
      try {
        bluetoothOff=sBluetooth.getBluetoothState() == BluetoothDevice.BLUETOOTH_STATE_OFF;
      }
 catch (      RemoteException ex) {
        Log.e(TAG,"RemoteException during bluetooth shutdown",ex);
        bluetoothOff=true;
      }
    }
    if (!radioOff) {
      try {
        radioOff=!sPhone.isRadioOn();
      }
 catch (      RemoteException ex) {
        Log.e(TAG,"RemoteException during radio shutdown",ex);
        radioOff=true;
      }
    }
    if (radioOff && bluetoothOff) {
      Log.d(TAG,"Radio and Bluetooth shutdown complete.");
      break;
    }
    SystemClock.sleep(PHONE_STATE_POLL_SLEEP_MSEC);
  }
  Log.d(TAG,"Shutting down power.");
  Power.shutdown();
}
