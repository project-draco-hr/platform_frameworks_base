{
synchronized (this) {
    if (mImpl == null) {
      Slog.w(TAG,"startVoiceActivity without running voice interaction service");
      return ActivityManager.START_CANCELED;
    }
    final int callingPid=Binder.getCallingPid();
    final int callingUid=Binder.getCallingUid();
    final long caller=Binder.clearCallingIdentity();
    if (!SystemProperties.getBoolean("persist.test.voice_interaction",false)) {
      throw new SecurityException("Voice interaction not supported");
    }
    try {
      return mImpl.startVoiceActivityLocked(callingPid,callingUid,token,intent,resolvedType);
    }
  finally {
      Binder.restoreCallingIdentity(caller);
    }
  }
}
