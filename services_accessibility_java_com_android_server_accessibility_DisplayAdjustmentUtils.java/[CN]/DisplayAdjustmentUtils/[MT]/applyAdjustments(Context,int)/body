{
  final ContentResolver cr=context.getContentResolver();
  float[] colorMatrix=null;
  if (Settings.Secure.getIntForUser(cr,Settings.Secure.ACCESSIBILITY_DISPLAY_INVERSION_ENABLED,0,userId) != 0) {
    colorMatrix=multiply(colorMatrix,INVERSION_MATRIX_VALUE_ONLY);
  }
  if (Settings.Secure.getIntForUser(cr,Settings.Secure.ACCESSIBILITY_DISPLAY_DALTONIZER_ENABLED,0,userId) != 0) {
    final int daltonizerMode=Settings.Secure.getIntForUser(cr,Settings.Secure.ACCESSIBILITY_DISPLAY_DALTONIZER,DEFAULT_DISPLAY_DALTONIZER,userId);
    if (daltonizerMode == AccessibilityManager.DALTONIZER_SIMULATE_MONOCHROMACY) {
      colorMatrix=multiply(colorMatrix,GRAYSCALE_MATRIX);
      setDaltonizerMode(AccessibilityManager.DALTONIZER_DISABLED);
    }
 else {
      setDaltonizerMode(daltonizerMode);
    }
  }
 else {
    setDaltonizerMode(AccessibilityManager.DALTONIZER_DISABLED);
  }
  String matrix=Settings.Secure.getStringForUser(cr,Settings.Secure.ACCESSIBILITY_DISPLAY_COLOR_MATRIX,userId);
  if (matrix != null) {
    final float[] userMatrix=get4x4Matrix(matrix);
    if (userMatrix != null) {
      colorMatrix=multiply(colorMatrix,userMatrix);
    }
  }
  setColorTransform(colorMatrix);
}
