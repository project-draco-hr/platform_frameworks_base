{
  StringBuilder out=new StringBuilder();
  int len=text.length();
  int next;
  for (int i=0; i < text.length(); i=next) {
    next=text.nextSpanTransition(i,len,QuoteSpan.class);
    QuoteSpan[] quotes=text.getSpans(i,next,QuoteSpan.class);
    for (    QuoteSpan quote : quotes) {
      out.append("<blockquote>");
    }
    withinBlockquote(out,text,i,next);
    for (    QuoteSpan quote : quotes) {
      out.append("</blockquote>\n");
    }
  }
  return out.toString();
}
