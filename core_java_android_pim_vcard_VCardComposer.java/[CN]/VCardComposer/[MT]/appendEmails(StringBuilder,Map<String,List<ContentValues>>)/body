{
  final List<ContentValues> contentValuesList=contentValuesListMap.get(Email.CONTENT_ITEM_TYPE);
  boolean emailAddressExists=false;
  if (contentValuesList != null) {
    Set<String> addressSet=new HashSet<String>();
    for (    ContentValues contentValues : contentValuesList) {
      Integer typeAsObject=contentValues.getAsInteger(Email.TYPE);
      final int type=(typeAsObject != null ? typeAsObject : Email.TYPE_OTHER);
      final String label=contentValues.getAsString(Email.LABEL);
      String emailAddress=contentValues.getAsString(Email.DATA);
      if (emailAddress != null) {
        emailAddress=emailAddress.trim();
      }
      if (TextUtils.isEmpty(emailAddress)) {
        continue;
      }
      emailAddressExists=true;
      if (!addressSet.contains(emailAddress)) {
        addressSet.add(emailAddress);
        appendVCardEmailLine(builder,type,label,emailAddress);
      }
    }
  }
  if (!emailAddressExists && mIsDoCoMo) {
    appendVCardEmailLine(builder,Email.TYPE_HOME,"","");
  }
}
