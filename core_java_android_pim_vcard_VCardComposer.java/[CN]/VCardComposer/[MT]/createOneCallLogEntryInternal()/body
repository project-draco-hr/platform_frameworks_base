{
  final StringBuilder builder=new StringBuilder();
  appendVCardLine(builder,Constants.PROPERTY_BEGIN,VCARD_DATA_VCARD);
  if (mIsV30) {
    appendVCardLine(builder,Constants.PROPERTY_VERSION,Constants.VERSION_V30);
  }
 else {
    appendVCardLine(builder,Constants.PROPERTY_VERSION,Constants.VERSION_V21);
  }
  String name=mCursor.getString(CALLER_NAME_COLUMN_INDEX);
  if (TextUtils.isEmpty(name)) {
    name=mCursor.getString(NUMBER_COLUMN_INDEX);
  }
  final boolean needCharset=!(VCardUtils.containsOnlyPrintableAscii(name));
  appendVCardLine(builder,Constants.PROPERTY_FN,name,needCharset,false);
  appendVCardLine(builder,Constants.PROPERTY_N,name,needCharset,false);
  String number=mCursor.getString(NUMBER_COLUMN_INDEX);
  int type=mCursor.getInt(CALLER_NUMBERTYPE_COLUMN_INDEX);
  String label=mCursor.getString(CALLER_NUMBERLABEL_COLUMN_INDEX);
  if (TextUtils.isEmpty(label)) {
    label=Integer.toString(type);
  }
  appendVCardTelephoneLine(builder,type,label,number);
  tryAppendCallHistoryTimeStampField(builder);
  appendVCardLine(builder,Constants.PROPERTY_END,VCARD_DATA_VCARD);
  return builder.toString();
}
