{
  if (mDbg)   Log.d(TAG,"SmHandler.handleMessage E");
  if (mDestState != null) {
    if (mDbg)     Log.d(TAG,"SmHandler.handleMessage; new destation call enter");
    mCurrentState=mDestState;
    mDestState=null;
    mCurrentState.enter(msg);
  }
  if (mCurrentState != null) {
    if (mDbg)     Log.d(TAG,"SmHandler.handleMessage; call processMessage");
    mCurrentState.processMessage(msg);
  }
 else {
    Log.e(TAG,"handleMessage: no current state, did you call setInitialState");
  }
  if (mDestState != null) {
    if (mDbg)     Log.d(TAG,"SmHandler.handleMessage; new destination call exit");
    mCurrentState.exit(msg);
    while (mDeferredMessages != null) {
      Message cur=mDeferredMessages;
      mDeferredMessages=mDeferredMessages.next;
      cur.when=0;
      if (mDbg)       Log.d(TAG,"SmHandler.handleMessage; queue deferred message what=" + cur.what + " target="+ cur.target);
      sendMessageAtFrontOfQueue(cur);
    }
    if (mDbg)     Log.d(TAG,"SmHandler.handleMessage X");
  }
}
