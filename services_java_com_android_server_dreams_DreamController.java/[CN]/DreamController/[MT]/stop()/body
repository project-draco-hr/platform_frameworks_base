{
  if (DEBUG)   Slog.v(TAG,"stop()");
  if (mCurrentDream != null) {
    unlinkDeathRecipient(mCurrentDream.asBinder());
    if (DEBUG)     Slog.v(TAG,"Unbinding: " + mCurrentDreamComponent + " service: "+ mCurrentDream);
    mContext.unbindService(mServiceConnection);
  }
  if (mCurrentDreamToken != null) {
    removeWindowToken(mCurrentDreamToken);
  }
  final boolean wasTest=mCurrentDreamIsTest;
  mCurrentDream=null;
  mCurrentDreamToken=null;
  mCurrentDreamComponent=null;
  mCurrentDreamIsTest=false;
  if (mListener != null && mHandler != null) {
    mHandler.post(new Runnable(){
      @Override public void run(){
        mListener.onDreamStopped(wasTest);
      }
    }
);
  }
}
