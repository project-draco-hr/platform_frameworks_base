{
  if (DEBUG) {
    Slog.d(TAG,"prepare: mode=" + mode);
  }
  mMode=mode;
  mDisplay.getDisplayInfo(mDisplayInfo);
  mDisplayLayerStack=mDisplay.getLayerStack();
  mDisplayRotation=mDisplayInfo.rotation;
  if (mDisplayRotation == Surface.ROTATION_90 || mDisplayRotation == Surface.ROTATION_270) {
    mDisplayWidth=mDisplayInfo.logicalHeight;
    mDisplayHeight=mDisplayInfo.logicalWidth;
  }
 else {
    mDisplayWidth=mDisplayInfo.logicalWidth;
    mDisplayHeight=mDisplayInfo.logicalHeight;
  }
  if (!tryPrepare()) {
    dismiss();
    return false;
  }
  mPrepared=true;
  if (mode == MODE_COOL_DOWN) {
    for (int i=0; i < DEJANK_FRAMES; i++) {
      draw(1.0f);
    }
  }
  return true;
}
