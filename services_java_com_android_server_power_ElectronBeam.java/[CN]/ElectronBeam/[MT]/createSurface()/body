{
  if (mSurfaceSession == null) {
    mSurfaceSession=new SurfaceSession();
  }
  Surface.openTransaction();
  try {
    if (mSurface == null) {
      try {
        int flags;
        if (mMode == MODE_FADE) {
          flags=Surface.FX_SURFACE_DIM | Surface.HIDDEN;
        }
 else {
          flags=Surface.OPAQUE | Surface.HIDDEN;
        }
        mSurface=new Surface(mSurfaceSession,"ElectronBeam",mDisplayWidth,mDisplayHeight,PixelFormat.OPAQUE,flags);
      }
 catch (      Surface.OutOfResourcesException ex) {
        Slog.e(TAG,"Unable to create surface.",ex);
        return false;
      }
    }
    mSurface.setLayerStack(mDisplayLayerStack);
    mSurface.setSize(mDisplayWidth,mDisplayHeight);
    mSurfaceLayout=new NaturalSurfaceLayout(mDisplayManager,mSurface);
    mSurfaceLayout.onDisplayTransaction();
  }
  finally {
    Surface.closeTransaction();
  }
  return true;
}
