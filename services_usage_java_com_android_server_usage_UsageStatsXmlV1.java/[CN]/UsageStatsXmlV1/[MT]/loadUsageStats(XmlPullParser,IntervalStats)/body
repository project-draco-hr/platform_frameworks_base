{
  final String pkg=parser.getAttributeValue(null,PACKAGE_ATTR);
  if (pkg == null) {
    throw new ProtocolException("no " + PACKAGE_ATTR + " attribute present");
  }
  final UsageStats stats=statsOut.getOrCreateUsageStats(pkg);
  stats.mLastTimeUsed=statsOut.beginTime + XmlUtils.readLongAttribute(parser,LAST_TIME_ACTIVE_ATTR);
  final String beginIdleTime=parser.getAttributeValue(null,BEGIN_IDLE_TIME_ATTR);
  if (!TextUtils.isEmpty(beginIdleTime)) {
    stats.mBeginIdleTime=Long.parseLong(beginIdleTime);
  }
  stats.mTotalTimeInForeground=XmlUtils.readLongAttribute(parser,TOTAL_TIME_ACTIVE_ATTR);
  stats.mLastEvent=XmlUtils.readIntAttribute(parser,LAST_EVENT_ATTR);
}
