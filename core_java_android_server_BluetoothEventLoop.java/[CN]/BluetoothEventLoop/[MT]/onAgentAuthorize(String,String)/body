{
  String address=mBluetoothService.getAddressFromObjectPath(objectPath);
  if (address == null) {
    Log.e(TAG,"Unable to get device address in onAuthAgentAuthorize");
    return false;
  }
  boolean authorized=false;
  ParcelUuid uuid=ParcelUuid.fromString(deviceUuid);
  if (mBluetoothService.isEnabled() && (BluetoothUuid.isAudioSource(uuid) || BluetoothUuid.isAvrcpTarget(uuid) || BluetoothUuid.isAdvAudioDist(uuid))) {
    BluetoothA2dp a2dp=new BluetoothA2dp(mContext);
    BluetoothDevice device=mAdapter.getRemoteDevice(address);
    authorized=a2dp.getSinkPriority(device) > BluetoothA2dp.PRIORITY_OFF;
    if (authorized) {
      Log.i(TAG,"Allowing incoming A2DP / AVRCP connection from " + address);
    }
 else {
      Log.i(TAG,"Rejecting incoming A2DP / AVRCP connection from " + address);
    }
  }
 else {
    Log.i(TAG,"Rejecting incoming " + deviceUuid + " connection from "+ address);
  }
  log("onAgentAuthorize(" + objectPath + ", "+ deviceUuid+ ") = "+ authorized);
  return authorized;
}
