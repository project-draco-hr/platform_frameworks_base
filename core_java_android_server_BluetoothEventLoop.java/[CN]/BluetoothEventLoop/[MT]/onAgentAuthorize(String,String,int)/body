{
  if (!mBluetoothService.isEnabled())   return;
  String address=mBluetoothService.getAddressFromObjectPath(objectPath);
  if (address == null) {
    Log.e(TAG,"Unable to get device address in onAuthAgentAuthorize");
    return;
  }
  boolean authorized=false;
  ParcelUuid uuid=ParcelUuid.fromString(deviceUuid);
  BluetoothDevice device=mAdapter.getRemoteDevice(address);
  mAuthorizationAgentRequestData.put(address,new Integer(nativeData));
  if (mA2dp != null && (BluetoothUuid.isAudioSource(uuid) || BluetoothUuid.isAvrcpTarget(uuid) || BluetoothUuid.isAdvAudioDist(uuid)) && !isOtherSinkInNonDisconnectedState(address)) {
    authorized=mA2dp.getPriority(device) > BluetoothProfile.PRIORITY_OFF;
    if (authorized && !BluetoothUuid.isAvrcpTarget(uuid)) {
      Log.i(TAG,"First check pass for incoming A2DP / AVRCP connection from " + address);
      mBluetoothService.notifyIncomingA2dpConnection(address);
    }
 else {
      Log.i(TAG,"" + authorized + "Incoming A2DP / AVRCP connection from "+ address);
      mA2dp.allowIncomingConnect(device,authorized);
    }
  }
 else   if (mInputDevice != null && BluetoothUuid.isInputDevice(uuid)) {
    authorized=mInputDevice.getPriority(device) > BluetoothInputDevice.PRIORITY_OFF;
    if (authorized) {
      Log.i(TAG,"First check pass for incoming HID connection from " + address);
      mBluetoothService.notifyIncomingHidConnection(address);
    }
 else {
      Log.i(TAG,"Rejecting incoming HID connection from " + address);
      mBluetoothService.allowIncomingHidConnect(device,authorized);
    }
  }
 else   if (BluetoothUuid.isBnep(uuid) && mBluetoothService.allowIncomingTethering()) {
    authorized=true;
  }
 else {
    Log.i(TAG,"Rejecting incoming " + deviceUuid + " connection from "+ address);
  }
  log("onAgentAuthorize(" + objectPath + ", "+ deviceUuid+ ") = "+ authorized);
}
