{
  final int unspecifiedWidth=MeasureSpec.makeMeasureSpec(0,MeasureSpec.UNSPECIFIED);
  super.measureHorizontal(unspecifiedWidth,heightMeasureSpec);
  final int count=getChildCount();
  int totalWidth=0;
  int totalCount=0;
  for (int i=0; i < count; i++) {
    final View child=getChildAt(i);
    if (child.getVisibility() == GONE) {
      continue;
    }
    final int childWidth=child.getMeasuredWidth();
    totalWidth+=childWidth;
    totalCount++;
  }
  final int width=MeasureSpec.getSize(widthMeasureSpec);
  if (totalWidth > width && totalCount > 0) {
    int extraWidth=totalWidth - width;
    for (int i=0; i < count; i++) {
      final View child=getChildAt(i);
      if (child.getVisibility() == GONE) {
        continue;
      }
      final int childWidth=child.getMeasuredWidth();
      final int delta=extraWidth / totalCount;
      final int tabWidth=Math.max(0,childWidth - delta);
      final int tabWidthMeasureSpec=MeasureSpec.makeMeasureSpec(tabWidth,MeasureSpec.EXACTLY);
      final int tabHeightMeasureSpec=MeasureSpec.makeMeasureSpec(child.getMeasuredHeight(),MeasureSpec.EXACTLY);
      child.measure(tabWidthMeasureSpec,tabHeightMeasureSpec);
      extraWidth-=delta;
      totalCount--;
    }
    setMeasuredDimension(width,getMeasuredHeight());
  }
}
