{
  boolean newDbExists=ceDatabaseFile.exists();
  if (Log.isLoggable(TAG,Log.VERBOSE)) {
    Log.v(TAG,"CeDatabaseHelper.create userId=" + userId + " oldDbExists="+ preNDatabaseFile.exists()+ " newDbExists="+ newDbExists);
  }
  boolean removeOldDb=false;
  if (!newDbExists && preNDatabaseFile.exists()) {
    removeOldDb=migratePreNDbToCe(preNDatabaseFile,ceDatabaseFile);
  }
  CeDatabaseHelper ceHelper=new CeDatabaseHelper(context,ceDatabaseFile.getPath());
  ceHelper.getWritableDatabase();
  ceHelper.close();
  if (removeOldDb) {
    Log.i(TAG,"Migration complete - creating backup of old db " + preNDatabaseFile);
    renameToBakFile(preNDatabaseFile);
  }
  return ceHelper;
}
