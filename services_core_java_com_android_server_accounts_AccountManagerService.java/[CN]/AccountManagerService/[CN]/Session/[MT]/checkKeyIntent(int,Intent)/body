{
  long bid=Binder.clearCallingIdentity();
  try {
    PackageManager pm=mContext.getPackageManager();
    ResolveInfo resolveInfo=pm.resolveActivityAsUser(intent,0,mAccounts.userId);
    ActivityInfo targetActivityInfo=resolveInfo.activityInfo;
    int targetUid=targetActivityInfo.applicationInfo.uid;
    if (PackageManager.SIGNATURE_MATCH != pm.checkSignatures(authUid,targetUid)) {
      String pkgName=targetActivityInfo.packageName;
      String activityName=targetActivityInfo.name;
      String tmpl="KEY_INTENT resolved to an Activity (%s) in a package (%s) that " + "does not share a signature with the supplying authenticator (%s).";
      throw new SecurityException(String.format(tmpl,activityName,pkgName,mAccountType));
    }
  }
  finally {
    Binder.restoreCallingIdentity(bid);
  }
}
