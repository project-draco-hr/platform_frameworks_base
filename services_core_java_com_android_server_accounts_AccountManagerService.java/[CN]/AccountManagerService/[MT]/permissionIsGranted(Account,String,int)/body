{
  final boolean isPrivileged=isPrivileged(callerUid);
  final boolean fromAuthenticator=account != null && isAccountManagedByCaller(account.type,callerUid);
  final boolean hasExplicitGrants=account != null && hasExplicitlyGrantedPermission(account,authTokenType,callerUid);
  if (Log.isLoggable(TAG,Log.VERBOSE)) {
    Log.v(TAG,"checkGrantsOrCallingUidAgainstAuthenticator: caller uid " + callerUid + ", "+ account+ ": is authenticator? "+ fromAuthenticator+ ", has explicit permission? "+ hasExplicitGrants);
  }
  return fromAuthenticator || hasExplicitGrants || isPrivileged;
}
