{
  userId=handleIncomingUser(userId);
  UserAccounts accounts=getUserAccounts(userId);
  ArrayList<Account> accountList=new ArrayList<>();
  Cursor cursor=null;
  try {
    cursor=accounts.openHelper.getReadableDatabase().query(TABLE_SHARED_ACCOUNTS,new String[]{ACCOUNTS_NAME,ACCOUNTS_TYPE},null,null,null,null,null);
    if (cursor != null && cursor.moveToFirst()) {
      int nameIndex=cursor.getColumnIndex(ACCOUNTS_NAME);
      int typeIndex=cursor.getColumnIndex(ACCOUNTS_TYPE);
      do {
        accountList.add(new Account(cursor.getString(nameIndex),cursor.getString(typeIndex)));
      }
 while (cursor.moveToNext());
    }
  }
  finally {
    if (cursor != null) {
      cursor.close();
    }
  }
  Account[] accountArray=new Account[accountList.size()];
  accountList.toArray(accountArray);
  return accountArray;
}
