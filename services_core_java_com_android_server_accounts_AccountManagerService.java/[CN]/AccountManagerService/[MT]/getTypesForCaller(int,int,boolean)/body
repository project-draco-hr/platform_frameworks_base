{
  List<String> managedAccountTypes=new ArrayList<>();
  long identityToken=Binder.clearCallingIdentity();
  Collection<RegisteredServicesCache.ServiceInfo<AuthenticatorDescription>> serviceInfos;
  try {
    serviceInfos=mAuthenticatorCache.getAllServices(userId);
  }
  finally {
    Binder.restoreCallingIdentity(identityToken);
  }
  for (  RegisteredServicesCache.ServiceInfo<AuthenticatorDescription> serviceInfo : serviceInfos) {
    final int sigChk=mPackageManager.checkSignatures(serviceInfo.uid,callingUid);
    if (isOtherwisePermitted || sigChk == PackageManager.SIGNATURE_MATCH) {
      managedAccountTypes.add(serviceInfo.type.type);
    }
  }
  if (managedAccountTypes.isEmpty()) {
    throw new SecurityException("The calling uid " + callingUid + " is not permitted access any types of accounts!");
  }
  return managedAccountTypes;
}
