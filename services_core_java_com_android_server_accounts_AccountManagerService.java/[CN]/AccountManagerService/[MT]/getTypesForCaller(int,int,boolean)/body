{
  List<String> managedAccountTypes=new ArrayList<>();
  for (  RegisteredServicesCache.ServiceInfo<AuthenticatorDescription> serviceInfo : mAuthenticatorCache.getAllServices(userId)) {
    final int sigChk=mPackageManager.checkSignatures(serviceInfo.uid,callingUid);
    if (isOtherwisePermitted || sigChk == PackageManager.SIGNATURE_MATCH) {
      managedAccountTypes.add(serviceInfo.type.type);
    }
  }
  return managedAccountTypes;
}
