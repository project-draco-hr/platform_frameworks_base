{
  if (account == null || authTokenType == null) {
    Log.e(TAG,"grantAppPermission: called with invalid arguments",new Exception());
    return;
  }
  UserAccounts accounts=getUserAccounts(UserHandle.getUserId(uid));
synchronized (accounts.cacheLock) {
    final SQLiteDatabase db=accounts.openHelper.getWritableDatabase();
    db.beginTransaction();
    try {
      long accountId=getAccountIdLocked(db,account);
      if (accountId >= 0) {
        ContentValues values=new ContentValues();
        values.put(GRANTS_ACCOUNTS_ID,accountId);
        values.put(GRANTS_AUTH_TOKEN_TYPE,authTokenType);
        values.put(GRANTS_GRANTEE_UID,uid);
        db.insert(TABLE_GRANTS,GRANTS_ACCOUNTS_ID,values);
        db.setTransactionSuccessful();
      }
    }
  finally {
      db.endTransaction();
    }
    cancelNotification(getCredentialPermissionNotificationId(account,authTokenType,uid),new UserHandle(accounts.userId));
  }
}
