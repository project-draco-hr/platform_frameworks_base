{
  if (account == null) {
    return;
  }
synchronized (accounts.cacheLock) {
    final SQLiteDatabase db=accounts.openHelper.getWritableDatabase();
    db.beginTransaction();
    try {
      final ContentValues values=new ContentValues();
      values.put(ACCOUNTS_PASSWORD,password);
      long time=0;
      if (password != null) {
        time=System.currentTimeMillis();
      }
      values.put(ACCOUNTS_LAST_AUTHENTICATE_TIME_EPOCH_MILLIS,time);
      final long accountId=getAccountIdLocked(db,account);
      if (accountId >= 0) {
        final String[] argsAccountId={String.valueOf(accountId)};
        db.update(TABLE_ACCOUNTS,values,ACCOUNTS_ID + "=?",argsAccountId);
        db.delete(TABLE_AUTHTOKENS,AUTHTOKENS_ACCOUNTS_ID + "=?",argsAccountId);
        accounts.authTokenCache.remove(account);
        accounts.accountTokenCaches.remove(account);
        db.setTransactionSuccessful();
        String action=(password == null || password.length() == 0) ? DebugDbHelper.ACTION_CLEAR_PASSWORD : DebugDbHelper.ACTION_SET_PASSWORD;
        logRecord(db,action,TABLE_ACCOUNTS,accountId,accounts,callingUid);
      }
    }
  finally {
      db.endTransaction();
    }
    sendAccountsChangedBroadcast(accounts.userId);
  }
}
