{
  if (mEnterAnimation == null && mExitAnimation == null) {
    return false;
  }
  if (!mStarted) {
    mEnterAnimation.setStartTime(now);
    mExitAnimation.setStartTime(now);
    mStarted=true;
  }
  mExitTransformation.clear();
  boolean moreExit=false;
  if (mExitAnimation != null) {
    moreExit=mExitAnimation.getTransformation(now,mExitTransformation);
    if (DEBUG)     Slog.v(TAG,"Stepped exit: " + mExitTransformation);
    if (!moreExit) {
      if (DEBUG)       Slog.v(TAG,"Exit animation done!");
      mExitAnimation.cancel();
      mExitAnimation=null;
      mExitTransformation.clear();
      if (mSurface != null) {
        mSurface.hide();
      }
    }
  }
  mEnterTransformation.clear();
  boolean moreEnter=false;
  if (mEnterAnimation != null) {
    moreEnter=mEnterAnimation.getTransformation(now,mEnterTransformation);
    if (!moreEnter) {
      mEnterAnimation.cancel();
      mEnterAnimation=null;
      mEnterTransformation.clear();
      if (mBlackSurfaces != null) {
        for (int i=0; i < mBlackSurfaces.length; i++) {
          if (mBlackSurfaces[i] != null) {
            mBlackSurfaces[i].surface.hide();
          }
        }
      }
    }
 else {
      if (mBlackSurfaces != null) {
        for (int i=0; i < mBlackSurfaces.length; i++) {
          if (mBlackSurfaces[i] != null) {
            mBlackSurfaces[i].setMatrix(mEnterTransformation.getMatrix());
          }
        }
      }
    }
  }
  mSnapshotFinalMatrix.setConcat(mExitTransformation.getMatrix(),mSnapshotInitialMatrix);
  setSnapshotTransform(mSnapshotFinalMatrix,mExitTransformation.getAlpha());
  return moreEnter || moreExit;
}
