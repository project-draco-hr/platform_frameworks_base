{
  final int launchStackId=(aOptions != null) ? aOptions.getLaunchStackId() : INVALID_STACK_ID;
  if (isValidLaunchStackId(launchStackId,r)) {
    return mSupervisor.getStack(launchStackId,CREATE_IF_NEEDED,ON_TOP);
  }
 else   if (launchStackId == DOCKED_STACK_ID) {
    return mSupervisor.getStack(FULLSCREEN_WORKSPACE_STACK_ID,CREATE_IF_NEEDED,ON_TOP);
  }
  if (!launchToSideAllowed || (launchFlags & FLAG_ACTIVITY_LAUNCH_TO_SIDE) == 0) {
    return null;
  }
  final ActivityStack parentStack=task != null ? task.stack : r.mInitialActivityContainer != null ? r.mInitialActivityContainer.mStack : mSupervisor.mFocusedStack;
  if (parentStack != null && parentStack.mStackId == DOCKED_STACK_ID) {
    return mSupervisor.getStack(FULLSCREEN_WORKSPACE_STACK_ID,CREATE_IF_NEEDED,ON_TOP);
  }
 else {
    final ActivityStack stack=mSupervisor.getStack(DOCKED_STACK_ID);
    if (stack != null && stack.getStackVisibilityLocked() == STACK_INVISIBLE) {
      return null;
    }
 else {
      return stack;
    }
  }
}
