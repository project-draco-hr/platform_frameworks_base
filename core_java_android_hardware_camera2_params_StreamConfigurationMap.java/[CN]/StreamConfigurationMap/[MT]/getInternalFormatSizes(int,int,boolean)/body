{
  HashMap<Integer,Integer> formatsMap=(dataspace == HAL_DATASPACE_DEPTH) ? mDepthOutputFormats : getFormatsMap(output);
  Integer sizesCount=formatsMap.get(format);
  if (sizesCount == null) {
    throw new IllegalArgumentException("format not available");
  }
  int len=sizesCount;
  Size[] sizes=new Size[len];
  int sizeIndex=0;
  StreamConfiguration[] configurations=(dataspace == HAL_DATASPACE_DEPTH) ? mDepthConfigurations : mConfigurations;
  for (  StreamConfiguration config : configurations) {
    if (config.getFormat() == format && config.isOutput() == output) {
      sizes[sizeIndex++]=config.getSize();
    }
  }
  if (sizeIndex != len) {
    throw new AssertionError("Too few sizes (expected " + len + ", actual "+ sizeIndex+ ")");
  }
  return sizes;
}
