{
  final WindowState w=mWin;
  int width=w.mFrame.width();
  int height=w.mFrame.height();
  int left=w.mXOffset + w.mFrame.left;
  int top=w.mYOffset + w.mFrame.top;
  final WindowManager.LayoutParams attrs=w.mAttrs;
  width+=attrs.shadowInsets.left + attrs.shadowInsets.right;
  height+=attrs.shadowInsets.top + attrs.shadowInsets.bottom;
  left-=attrs.shadowInsets.left;
  top-=attrs.shadowInsets.top;
  w.mSystemDecorRect.set(0,0,width,height);
  w.mSystemDecorRect.intersect(decorRect.left - left,decorRect.top - top,decorRect.right - left,decorRect.bottom - top);
  if (w.mEnforceSizeCompat && w.mInvGlobalScale != 1.0f) {
    final float scale=w.mInvGlobalScale;
    w.mSystemDecorRect.left=(int)(w.mSystemDecorRect.left * scale - 0.5f);
    w.mSystemDecorRect.top=(int)(w.mSystemDecorRect.top * scale - 0.5f);
    w.mSystemDecorRect.right=(int)((w.mSystemDecorRect.right + 1) * scale - 0.5f);
    w.mSystemDecorRect.bottom=(int)((w.mSystemDecorRect.bottom + 1) * scale - 0.5f);
  }
}
