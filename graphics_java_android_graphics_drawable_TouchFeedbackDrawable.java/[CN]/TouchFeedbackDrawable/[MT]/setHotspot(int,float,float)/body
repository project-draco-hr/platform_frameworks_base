{
  if (mTouchedRipples == null) {
    mTouchedRipples=new SparseArray<Ripple>();
    mActiveRipples=new Ripple[MAX_RIPPLES];
  }
  if (mActiveRipplesCount >= MAX_RIPPLES) {
    Log.e(LOG_TAG,"Max ripple count exceeded",new RuntimeException());
    return;
  }
  final Ripple ripple=mTouchedRipples.get(id);
  if (ripple == null) {
    final Rect padding=mPaddingRect;
    getPadding(padding);
    final Rect bounds=mHotspotBounds;
    if (mState.mPinned) {
      x=bounds.exactCenterX();
      y=bounds.exactCenterY();
    }
    final boolean pulse=(id != R.attr.state_focused);
    final Ripple newRipple=new Ripple(bounds,padding,x,y,mDensity,pulse);
    newRipple.animate().enter();
    mActiveRipples[mActiveRipplesCount++]=newRipple;
    mTouchedRipples.put(id,newRipple);
  }
 else   if (mState.mPinned) {
    final Rect bounds=mHotspotBounds;
    x=bounds.exactCenterX();
    y=bounds.exactCenterY();
    ripple.move(x,y);
  }
 else {
    ripple.move(x,y);
  }
  scheduleAnimation();
}
