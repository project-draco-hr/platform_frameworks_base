{
  super.onResume();
  final AccountManager accountManager=AccountManager.get(this);
  mAccounts=getAcceptableAccountChoices(accountManager);
  if (mPendingRequest == REQUEST_NULL) {
    if (mAccounts.isEmpty()) {
      if (mDisallowAddAccounts) {
        setContentView(R.layout.app_not_authorized);
        setTitle(R.string.error_message_title);
        return;
      }
      if (mSetOfRelevantAccountTypes.size() == 1) {
        runAddAccountForAuthenticator(mSetOfRelevantAccountTypes.iterator().next());
      }
 else {
        startChooseAccountTypeActivity();
      }
      return;
    }
    if (!mAlwaysPromptForAccount && mAccounts.size() == 1) {
      Account account=mAccounts.get(0);
      setResultAndFinish(account.name,account.type);
      return;
    }
  }
  String[] listItems=getListOfDisplayableOptions(mAccounts);
  mSelectedItemIndex=getItemIndexToSelect(mAccounts,mSelectedAccountName,mSelectedAddNewAccount);
  setContentView(R.layout.choose_type_and_account);
  overrideDescriptionIfSupplied(mDescriptionOverride);
  populateUIAccountList(listItems);
  mOkButton=(Button)findViewById(android.R.id.button2);
  mOkButton.setEnabled(mSelectedItemIndex != SELECTED_ITEM_NONE);
}
