{
synchronized (VolumeStreamState.class) {
    if (mUseFixedVolume || mUseMasterVolume) {
      mIndex.put(AudioSystem.DEVICE_OUT_DEFAULT,mIndexMax);
      return;
    }
    if ((mStreamType == AudioSystem.STREAM_SYSTEM) || (mStreamType == AudioSystem.STREAM_SYSTEM_ENFORCED)) {
      int index=10 * DEFAULT_STREAM_VOLUME[mStreamType];
synchronized (mCameraSoundForced) {
        if (mCameraSoundForced) {
          index=mIndexMax;
        }
      }
      mIndex.put(AudioSystem.DEVICE_OUT_DEFAULT,index);
      return;
    }
    int remainingDevices=AudioSystem.DEVICE_OUT_ALL;
    for (int i=0; remainingDevices != 0; i++) {
      int device=(1 << i);
      if ((device & remainingDevices) == 0) {
        continue;
      }
      remainingDevices&=~device;
      String name=getSettingNameForDevice(device);
      int defaultIndex=(device == AudioSystem.DEVICE_OUT_DEFAULT) ? DEFAULT_STREAM_VOLUME[mStreamType] : -1;
      int index=Settings.System.getIntForUser(mContentResolver,name,defaultIndex,UserHandle.USER_CURRENT);
      if (index == -1) {
        continue;
      }
      mIndex.put(device,getValidIndex(10 * index));
    }
  }
}
