{
synchronized (mDeathHandlers) {
    if (state) {
      if (mMuteCount == 0) {
        try {
          if (mICallback != null) {
            mICallback.linkToDeath(this,0);
          }
          mDeathHandlers.add(this);
          if (muteCount() == 0) {
            Set set=mIndex.entrySet();
            Iterator i=set.iterator();
            while (i.hasNext()) {
              Map.Entry entry=(Map.Entry)i.next();
              int device=((Integer)entry.getKey()).intValue();
              setIndex(0,device,false);
            }
            sendMsg(mAudioHandler,MSG_SET_ALL_VOLUMES,SENDMSG_NOOP,0,0,VolumeStreamState.this,0);
          }
        }
 catch (        RemoteException e) {
          binderDied();
          mDeathHandlers.notify();
          return;
        }
      }
 else {
        Log.w(TAG,"stream: " + mStreamType + " was already muted by this client");
      }
      mMuteCount++;
    }
 else {
      if (mMuteCount == 0) {
        Log.e(TAG,"unexpected unmute for stream: " + mStreamType);
      }
 else {
        mMuteCount--;
        if (mMuteCount == 0) {
          mDeathHandlers.remove(this);
          if (mICallback != null) {
            mICallback.unlinkToDeath(this,0);
          }
          if (muteCount() == 0) {
            if (!isStreamAffectedByRingerMode(mStreamType) || mRingerMode == AudioManager.RINGER_MODE_NORMAL) {
              Set set=mIndex.entrySet();
              Iterator i=set.iterator();
              while (i.hasNext()) {
                Map.Entry entry=(Map.Entry)i.next();
                int device=((Integer)entry.getKey()).intValue();
                setIndex(getIndex(device,true),device,false);
              }
              sendMsg(mAudioHandler,MSG_SET_ALL_VOLUMES,SENDMSG_NOOP,0,0,VolumeStreamState.this,0);
            }
          }
        }
      }
    }
    mDeathHandlers.notify();
  }
}
