{
  if (!checkAudioSettingsPermission("setMode()")) {
    return;
  }
synchronized (mSettingsLock) {
    if (mode != mMode) {
      AudioSystem.setMode(mode);
      mMode=mode;
    }
    int streamType=getActiveStreamType(AudioManager.USE_DEFAULT_STREAM_TYPE);
    int index=mStreamStates[streamType].mIndex;
    syncRingerAndNotificationStreamVolume(streamType,index,true);
    setStreamVolumeInt(streamType,index,true);
  }
}
