{
  ensureValidDirection(direction);
  int volume=Math.round(AudioSystem.getMasterVolume() * MAX_MASTER_VOLUME);
  int delta=0;
  for (int i=0; i < mMasterVolumeRamp.length; i+=2) {
    int testVolume=mMasterVolumeRamp[i];
    int testDelta=mMasterVolumeRamp[i + 1];
    if (direction == AudioManager.ADJUST_RAISE) {
      if (volume >= testVolume) {
        delta=testDelta;
      }
 else {
        break;
      }
    }
 else     if (direction == AudioManager.ADJUST_LOWER) {
      if (volume - testDelta >= testVolume) {
        delta=-testDelta;
      }
 else {
        break;
      }
    }
  }
  setMasterVolume(volume + delta,flags);
}
