{
  readPersistedSettings();
  int numStreamTypes=AudioSystem.getNumStreamTypes();
  for (int streamType=0; streamType < numStreamTypes; streamType++) {
    VolumeStreamState streamState=mStreamStates[streamType];
    if (userSwitch && mStreamVolumeAlias[streamType] == AudioSystem.STREAM_MUSIC) {
      continue;
    }
synchronized (streamState) {
      streamState.readSettings();
      if (streamState.muteCount() != 0 && !isStreamAffectedByMute(streamType)) {
        int size=streamState.mDeathHandlers.size();
        for (int i=0; i < size; i++) {
          streamState.mDeathHandlers.get(i).mMuteCount=1;
          streamState.mDeathHandlers.get(i).mute(false);
        }
      }
    }
  }
  checkAllAliasStreamVolumes();
synchronized (mSafeMediaVolumeState) {
    if (mSafeMediaVolumeState == SAFE_MEDIA_VOLUME_ACTIVE) {
      enforceSafeMediaVolume();
    }
  }
  setRingerModeInt(getRingerMode(),false);
}
