{
  if (DEBUG_CERTS) {
    Log.v(TAG,"java side verify for " + numcerts + " certificates ("+ chain.length+ " bytes"+ ")for "+ domain+ "/"+ authType);
  }
  byte[][] certChain=new byte[numcerts][];
  ByteBuffer buf=ByteBuffer.wrap(chain);
  for (int i=0; i < numcerts; i++) {
    int certlen=buf.getInt();
    if (DEBUG_CERTS) {
      Log.i(TAG,"cert " + i + ": "+ certlen);
    }
    certChain[i]=new byte[certlen];
    buf.get(certChain[i]);
  }
  try {
    SslError err=CertificateChainValidator.verifyServerCertificates(certChain,domain,authType);
    if (DEBUG_CERTS) {
      Log.i(TAG,"verified: " + err);
    }
    if (err == null) {
      return -1;
    }
 else {
      return err.getPrimaryError();
    }
  }
 catch (  Exception e) {
    Log.e(TAG,"failed to verify chain: " + e);
  }
  return SslError.SSL_INVALID;
}
