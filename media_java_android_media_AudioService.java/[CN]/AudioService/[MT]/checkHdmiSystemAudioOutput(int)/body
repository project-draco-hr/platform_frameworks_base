{
  if ((device & AudioSystem.DEVICE_OUT_ALL_HDMI_SYSTEM_AUDIO) == 0) {
    Log.w(TAG,"Unsupported Hdmi-Cec system audio output:" + device);
    return false;
  }
  int streamDevice=AudioSystem.getDevicesForStream(AudioSystem.STREAM_MUSIC);
  if ((streamDevice & ~AudioSystem.DEVICE_ALL_HDMI_SYSTEM_AUDIO_AND_SPEAKER) != 0) {
    Log.w(TAG,"Should turn off other devices before starting system audio:" + streamDevice);
    return false;
  }
  if (AudioSystem.getDeviceConnectionState(device,"") != AudioSystem.DEVICE_STATE_AVAILABLE) {
    Log.w(TAG,"Output device is not connected:" + device);
    return false;
  }
  return true;
}
