{
  boolean hasPermissionForPolicy=(PackageManager.PERMISSION_GRANTED == mContext.checkCallingOrSelfPermission(android.Manifest.permission.MODIFY_AUDIO_ROUTING));
  if (!hasPermissionForPolicy) {
    Slog.w(TAG,"Can't register audio policy for pid " + Binder.getCallingPid() + " / uid "+ Binder.getCallingUid()+ ", need MODIFY_AUDIO_ROUTING");
    return false;
  }
synchronized (mAudioPolicies) {
    AudioPolicyProxy app=new AudioPolicyProxy(policyConfig,cb);
    try {
      cb.linkToDeath(app,0);
      mAudioPolicies.put(cb,app);
    }
 catch (    RemoteException e) {
      Slog.w(TAG,"Audio policy registration failed, could not link to " + cb + " binder death",e);
      return false;
    }
  }
  return true;
}
