{
  if (!isValidMediaKeyEvent(keyEvent)) {
    Log.e(TAG,"not dispatching invalid media key event " + keyEvent);
    return;
  }
synchronized (mRingingLock) {
synchronized (mRCStack) {
      if ((mMediaReceiverForCalls != null) && (mIsRinging || (getMode() == AudioSystem.MODE_IN_CALL))) {
        dispatchMediaKeyEventForCalls(keyEvent,needWakeLock);
        return;
      }
    }
  }
  if (isValidVoiceInputKeyCode(keyEvent.getKeyCode())) {
    filterVoiceInputKeyEvent(keyEvent,needWakeLock);
  }
 else {
    dispatchMediaKeyEvent(keyEvent,needWakeLock);
  }
}
