{
  Intent voiceIntent=null;
  PowerManager pm=(PowerManager)mContext.getSystemService(Context.POWER_SERVICE);
  boolean isLocked=mKeyguardManager != null && mKeyguardManager.isKeyguardLocked();
  if (!isLocked && pm.isScreenOn()) {
    voiceIntent=new Intent(android.speech.RecognizerIntent.ACTION_WEB_SEARCH);
  }
 else {
    voiceIntent=new Intent(RecognizerIntent.ACTION_VOICE_SEARCH_HANDS_FREE);
    voiceIntent.putExtra(RecognizerIntent.EXTRA_SECURE,isLocked && mKeyguardManager.isKeyguardSecure());
  }
  if (needWakeLock) {
    mMediaEventWakeLock.acquire();
  }
  try {
    if (voiceIntent != null) {
      voiceIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS);
      mContext.startActivity(voiceIntent);
    }
  }
 catch (  ActivityNotFoundException e) {
    Log.w(TAG,"No activity for search: " + e);
  }
 finally {
    if (needWakeLock) {
      mMediaEventWakeLock.release();
    }
  }
}
