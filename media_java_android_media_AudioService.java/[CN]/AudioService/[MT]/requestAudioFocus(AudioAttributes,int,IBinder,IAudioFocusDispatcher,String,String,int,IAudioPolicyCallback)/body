{
  if ((flags & AudioManager.AUDIOFOCUS_FLAG_LOCK) == AudioManager.AUDIOFOCUS_FLAG_LOCK) {
    if (mMediaFocusControl.IN_VOICE_COMM_FOCUS_ID.equals(clientId)) {
      if (PackageManager.PERMISSION_GRANTED != mContext.checkCallingOrSelfPermission(android.Manifest.permission.MODIFY_PHONE_STATE)) {
        Log.e(TAG,"Invalid permission to (un)lock audio focus",new Exception());
        return AudioManager.AUDIOFOCUS_REQUEST_FAILED;
      }
    }
 else {
synchronized (mAudioPolicies) {
        if (!mAudioPolicies.containsKey(pcb.asBinder())) {
          Log.e(TAG,"Invalid unregistered AudioPolicy to (un)lock audio focus");
          return AudioManager.AUDIOFOCUS_REQUEST_FAILED;
        }
      }
    }
  }
  return mMediaFocusControl.requestAudioFocus(aa,durationHint,cb,fd,clientId,callingPackageName,flags);
}
