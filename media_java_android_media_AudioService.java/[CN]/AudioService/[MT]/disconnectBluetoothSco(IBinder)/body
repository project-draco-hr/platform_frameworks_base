{
synchronized (mScoClients) {
    checkScoAudioState();
    if (mScoAudioState == SCO_STATE_ACTIVE_EXTERNAL || mScoAudioState == SCO_STATE_DEACTIVATE_EXT_REQ) {
      if (mBluetoothHeadsetDevice != null) {
        if (mBluetoothHeadset != null) {
          if (!mBluetoothHeadset.stopVoiceRecognition(mBluetoothHeadsetDevice) || !mBluetoothHeadset.stopScoUsingVirtualVoiceCall(mBluetoothHeadsetDevice)) {
            sendMsg(mAudioHandler,MSG_BT_HEADSET_CNCT_FAILED,0,SENDMSG_REPLACE,0,0,null,0);
          }
        }
 else         if (mScoAudioState == SCO_STATE_ACTIVE_EXTERNAL && getBluetoothHeadset()) {
          mScoAudioState=SCO_STATE_DEACTIVATE_EXT_REQ;
        }
      }
    }
 else {
      clearAllScoClients(exceptBinder,true);
    }
  }
}
