{
  MediaMetadataRetriever retriever=new MediaMetadataRetriever();
  Log.v(TAG,"Thumbnail processing starts");
  long startedAt=System.currentTimeMillis();
  for (int i=0, n=MediaNames.THUMBNAIL_CAPTURE_TEST_FILES.length; i < n; ++i) {
    try {
      Log.v(TAG,"File " + i + ": "+ MediaNames.THUMBNAIL_CAPTURE_TEST_FILES[i]);
      retriever.setDataSource(MediaNames.THUMBNAIL_CAPTURE_TEST_FILES[i]);
      Bitmap bitmap=retriever.captureFrame();
      assertTrue(bitmap != null);
      try {
        java.io.OutputStream stream=new FileOutputStream(MediaNames.THUMBNAIL_CAPTURE_TEST_FILES[i] + ".jpg");
        bitmap.compress(Bitmap.CompressFormat.JPEG,75,stream);
        stream.close();
      }
 catch (      Exception e) {
        throw new Exception("Fails to convert the bitmap to a JPEG file for " + MediaNames.THUMBNAIL_CAPTURE_TEST_FILES[i],e);
      }
    }
 catch (    Exception e) {
      throw new Exception("Fails to setDataSource for file " + MediaNames.THUMBNAIL_CAPTURE_TEST_FILES[i],e);
    }
    Thread.yield();
  }
  long endedAt=System.currentTimeMillis();
  Log.v(TAG,"Average processing time per thumbnail: " + (endedAt - startedAt) / MediaNames.THUMBNAIL_CAPTURE_TEST_FILES.length + " ms");
  retriever.release();
}
