{
  Log.v(TAG,"testAlbumArt starts.");
  MediaMetadataRetriever retriever=new MediaMetadataRetriever();
  boolean supportWMA=MediaProfileReader.getWMAEnable();
  boolean hasFailed=false;
  boolean supportWMV=MediaProfileReader.getWMVEnable();
  retriever.setMode(MediaMetadataRetriever.MODE_GET_METADATA_ONLY);
  for (int i=0, n=MediaNames.ALBUMART_TEST_FILES.length; i < n; ++i) {
    try {
      Log.v(TAG,"File " + i + ": "+ MediaNames.ALBUMART_TEST_FILES[i]);
      if ((MediaNames.ALBUMART_TEST_FILES[i].endsWith(".wma") && !supportWMA) || (MediaNames.ALBUMART_TEST_FILES[i].endsWith(".wmv") && !supportWMV)) {
        Log.v(TAG,"windows media is not supported and thus we will skip the test for this file");
        continue;
      }
      retriever.setDataSource(MediaNames.ALBUMART_TEST_FILES[i]);
      byte[] albumArt=retriever.extractAlbumArt();
      if (albumArt == null) {
        Log.e(TAG,"Fails to extract album art for " + MediaNames.ALBUMART_TEST_FILES[i]);
        hasFailed=true;
      }
    }
 catch (    Exception e) {
      Log.e(TAG,"Fails to setDataSource for " + MediaNames.ALBUMART_TEST_FILES[i]);
      hasFailed=true;
    }
    Thread.yield();
  }
  retriever.release();
  Log.v(TAG,"testAlbumArt completes.");
  assertTrue(!hasFailed);
}
