{
  final ParcelFileDescriptor pfd=ParcelFileDescriptor.open(file,ParcelFileDescriptor.MODE_READ_ONLY);
  Bundle extras=null;
  try {
    final ExifInterface exif=new ExifInterface(file.getAbsolutePath());
switch (exif.getAttributeInt(ExifInterface.TAG_ORIENTATION,-1)) {
case ExifInterface.ORIENTATION_ROTATE_90:
      extras=new Bundle(1);
    extras.putInt(EXTRA_ORIENTATION,90);
  break;
case ExifInterface.ORIENTATION_ROTATE_180:
extras=new Bundle(1);
extras.putInt(EXTRA_ORIENTATION,180);
break;
case ExifInterface.ORIENTATION_ROTATE_270:
extras=new Bundle(1);
extras.putInt(EXTRA_ORIENTATION,270);
break;
}
final long[] thumb=exif.getThumbnailRange();
if (thumb != null) {
return new AssetFileDescriptor(pfd,thumb[0],thumb[1],extras);
}
}
 catch (IOException e) {
}
return new AssetFileDescriptor(pfd,0,AssetFileDescriptor.UNKNOWN_LENGTH,extras);
}
