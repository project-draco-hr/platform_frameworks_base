{
  super.onCreate(savedInstanceState);
  if (mStorageManager == null) {
    mStorageManager=(StorageManager)getSystemService(Context.STORAGE_SERVICE);
    if (mStorageManager == null) {
      Log.w(TAG,"Failed to get StorageManager");
    }
    mStorageManager.registerListener(mStorageListener);
  }
  setTitle(getString(com.android.internal.R.string.usb_storage_activity_title));
  setContentView(com.android.internal.R.layout.usb_storage_activity);
  mIcon=(ImageView)findViewById(com.android.internal.R.id.icon);
  mBanner=(TextView)findViewById(com.android.internal.R.id.banner);
  mMessage=(TextView)findViewById(com.android.internal.R.id.message);
  mMountButton=(Button)findViewById(com.android.internal.R.id.mount_button);
  mMountButton.setOnClickListener(new View.OnClickListener(){
    public void onClick(    View v){
      int rc=mStorageManager.enableUsbMassStorage();
      if (rc != StorageResultCode.OperationSucceeded) {
        Log.e(TAG,String.format("UMS enable failed (%d)",rc));
        showSharingError();
      }
    }
  }
);
  mUnmountButton=(Button)findViewById(com.android.internal.R.id.unmount_button);
  mUnmountButton.setOnClickListener(new View.OnClickListener(){
    public void onClick(    View v){
      int rc=mStorageManager.disableUsbMassStorage();
      if (rc != StorageResultCode.OperationSucceeded) {
        Log.e(TAG,String.format("UMS disable failed (%d)",rc));
        showStoppingError();
      }
    }
  }
);
}
