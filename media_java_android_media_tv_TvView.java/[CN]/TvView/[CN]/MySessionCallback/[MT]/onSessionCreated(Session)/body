{
  if (DEBUG) {
    Log.d(TAG,"onSessionCreated()");
  }
  if (this != mSessionCallback) {
    Log.w(TAG,"onSessionCreated - session already created");
    if (session != null) {
      session.release();
    }
    return;
  }
  mSession=session;
  if (session != null) {
    for (    Pair<String,Bundle> command : mPendingAppPrivateCommands) {
      mSession.sendAppPrivateCommand(command.first,command.second);
    }
    mPendingAppPrivateCommands.clear();
synchronized (sMainTvViewLock) {
      if (hasWindowFocus() && TvView.this == sMainTvView.get()) {
        mSession.setMain();
      }
    }
    if (mSurface != null) {
      setSessionSurface(mSurface);
      if (mSurfaceChanged) {
        dispatchSurfaceChanged(mSurfaceFormat,mSurfaceWidth,mSurfaceHeight);
      }
    }
    createSessionOverlayView();
    if (mStreamVolume != null) {
      mSession.setStreamVolume(mStreamVolume);
    }
    if (mCaptionEnabled != null) {
      mSession.setCaptionEnabled(mCaptionEnabled);
    }
    if (mChannelUri != null) {
      mSession.tune(mChannelUri,mTuneParams);
    }
 else {
      mSession.timeShiftPlay(mRecordedProgramUri);
    }
    ensurePositionTracking();
  }
 else {
    mSessionCallback=null;
    if (mCallback != null) {
      mCallback.onConnectionFailed(mInputId);
    }
  }
}
