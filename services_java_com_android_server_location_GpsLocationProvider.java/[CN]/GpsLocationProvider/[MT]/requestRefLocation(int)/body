{
  TelephonyManager phone=(TelephonyManager)mContext.getSystemService(Context.TELEPHONY_SERVICE);
  final int phoneType=phone.getPhoneType();
  if (phoneType == TelephonyManager.PHONE_TYPE_GSM) {
    GsmCellLocation gsm_cell=(GsmCellLocation)phone.getCellLocation();
    if ((gsm_cell != null) && (phone.getNetworkOperator() != null) && (phone.getNetworkOperator().length() > 3)) {
      int type;
      int mcc=Integer.parseInt(phone.getNetworkOperator().substring(0,3));
      int mnc=Integer.parseInt(phone.getNetworkOperator().substring(3));
      int networkType=phone.getNetworkType();
      if (networkType == TelephonyManager.NETWORK_TYPE_UMTS || networkType == TelephonyManager.NETWORK_TYPE_HSDPA || networkType == TelephonyManager.NETWORK_TYPE_HSUPA || networkType == TelephonyManager.NETWORK_TYPE_HSPA) {
        type=AGPS_REF_LOCATION_TYPE_UMTS_CELLID;
      }
 else {
        type=AGPS_REF_LOCATION_TYPE_GSM_CELLID;
      }
      native_agps_set_ref_location_cellid(type,mcc,mnc,gsm_cell.getLac(),gsm_cell.getCid());
    }
 else {
      Log.e(TAG,"Error getting cell location info.");
    }
  }
 else   if (phoneType == TelephonyManager.PHONE_TYPE_CDMA) {
    Log.e(TAG,"CDMA not supported.");
  }
}
