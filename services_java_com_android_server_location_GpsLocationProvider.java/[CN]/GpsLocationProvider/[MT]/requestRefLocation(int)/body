{
  TelephonyManager phone=(TelephonyManager)mContext.getSystemService(Context.TELEPHONY_SERVICE);
  if (phone.getPhoneType() == TelephonyManager.PHONE_TYPE_GSM) {
    GsmCellLocation gsm_cell=(GsmCellLocation)phone.getCellLocation();
    if ((gsm_cell != null) && (phone.getPhoneType() == TelephonyManager.PHONE_TYPE_GSM) && (phone.getNetworkOperator().length() > 3)) {
      int type;
      int mcc=Integer.parseInt(phone.getNetworkOperator().substring(0,3));
      int mnc=Integer.parseInt(phone.getNetworkOperator().substring(3));
      if (phone.getNetworkType() == TelephonyManager.NETWORK_TYPE_UMTS)       type=AGPS_REF_LOCATION_TYPE_UMTS_CELLID;
 else       type=AGPS_REF_LOCATION_TYPE_GSM_CELLID;
      native_agps_set_ref_location_cellid(type,mcc,mnc,gsm_cell.getLac(),gsm_cell.getCid());
    }
 else     Log.e(TAG,"Error getting cell location info.");
  }
 else   Log.e(TAG,"CDMA not supported.");
}
