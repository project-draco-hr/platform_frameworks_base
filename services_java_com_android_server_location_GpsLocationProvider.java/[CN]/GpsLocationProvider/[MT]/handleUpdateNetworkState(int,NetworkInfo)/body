{
  mNetworkAvailable=(state == LocationProvider.AVAILABLE);
  if (DEBUG) {
    Log.d(TAG,"updateNetworkState " + (mNetworkAvailable ? "available" : "unavailable") + " info: "+ info);
  }
  if (info != null && info.getType() == ConnectivityManager.TYPE_MOBILE_SUPL && mAGpsDataConnectionState == AGPS_DATA_CONNECTION_OPENING) {
    String apnName=info.getExtraInfo();
    if (mNetworkAvailable && apnName != null && apnName.length() > 0) {
      mAGpsApn=apnName;
      if (DEBUG)       Log.d(TAG,"call native_agps_data_conn_open");
      native_agps_data_conn_open(apnName);
      mAGpsDataConnectionState=AGPS_DATA_CONNECTION_OPEN;
    }
 else {
      if (DEBUG)       Log.d(TAG,"call native_agps_data_conn_failed");
      mAGpsApn=null;
      mAGpsDataConnectionState=AGPS_DATA_CONNECTION_CLOSED;
      native_agps_data_conn_failed();
    }
  }
  if (mNetworkAvailable) {
    if (mInjectNtpTimePending) {
      mHandler.removeMessages(INJECT_NTP_TIME);
      mHandler.sendMessage(Message.obtain(mHandler,INJECT_NTP_TIME));
    }
    if (mDownloadXtraDataPending) {
      mHandler.removeMessages(DOWNLOAD_XTRA_DATA);
      mHandler.sendMessage(Message.obtain(mHandler,DOWNLOAD_XTRA_DATA));
    }
  }
}
