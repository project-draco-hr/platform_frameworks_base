{
  Map<PrinterId,PrinterRecord> recordMap=new ArrayMap<PrinterId,PrinterRecord>();
  float currentWeight=1.0f;
  final int printerCount=printers.size();
  for (int i=printerCount - 1; i >= 0; i--) {
    PrinterInfo printer=printers.get(i);
    PrinterRecord record=recordMap.get(printer.getId());
    if (record == null) {
      record=new PrinterRecord(printer);
      recordMap.put(printer.getId(),record);
    }
    record.weight+=currentWeight;
    currentWeight*=WEIGHT_DECAY_COEFFICIENT;
  }
  List<PrinterRecord> favoriteRecords=new ArrayList<PrinterRecord>(recordMap.values());
  Collections.sort(favoriteRecords);
  final int favoriteCount=favoriteRecords.size();
  List<PrinterInfo> favoritePrinters=new ArrayList<PrinterInfo>(favoriteCount);
  for (int i=0; i < favoriteCount; i++) {
    PrinterInfo printer=favoriteRecords.get(i).printer;
    favoritePrinters.add(printer);
  }
  return favoritePrinters;
}
