{
  try {
    ServerSocket server=new ServerSocket(8182);
    Socket socket=server.accept();
    InputStream input=socket.getInputStream();
    BufferedReader reader=new BufferedReader(new InputStreamReader(input));
    try {
      for (int i=0; i < keepAliveCount; i++) {
        String header=reader.readLine();
        while (header != null && header.length() != 0) {
          header=reader.readLine();
        }
        OutputStream output=socket.getOutputStream();
        PrintWriter writer=new PrintWriter(output);
        try {
          writer.println("HTTP/1.1 200 OK");
          String body="Hello, Android world #" + i + "!";
          writer.println("Content-Length: " + body.length());
          writer.println("");
          writer.print(body);
          writer.flush();
        }
  finally {
          writer.close();
        }
      }
    }
  finally {
      reader.close();
    }
    socket.close();
    server.close();
  }
 catch (  Exception ex) {
    throw new RuntimeException(ex);
  }
}
