{
  try {
    ServerSocket server=new ServerSocket(8182);
    Socket socket=server.accept();
    InputStream input=socket.getInputStream();
    BufferedReader reader=new BufferedReader(new InputStreamReader(input));
    try {
      for (int i=0; i < keepAliveCount; i++) {
        reader.readLine();
        headers.clear();
        while (true) {
          String header=reader.readLine();
          if (header.length() == 0) {
            break;
          }
          int colon=header.indexOf(":");
          String key=header.substring(0,colon);
          String value=header.substring(colon + 1).trim();
          headers.put(key,value);
        }
        OutputStream output=socket.getOutputStream();
        PrintWriter writer=new PrintWriter(output);
        try {
          writer.println("HTTP/1.1 200 OK");
          String body="Hello, Android world #" + i + "!";
          writer.println("Content-Length: " + body.length());
          writer.println("");
          writer.print(body);
          writer.flush();
        }
  finally {
          writer.close();
        }
      }
    }
  finally {
      reader.close();
    }
    socket.close();
    server.close();
  }
 catch (  Exception ex) {
    throw new RuntimeException(ex);
  }
}
