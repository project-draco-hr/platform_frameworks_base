{
synchronized (mLock) {
    if (mConfigSource != null) {
      return mConfigSource;
    }
    ApplicationInfo info;
    try {
      info=mContext.getPackageManager().getApplicationInfo(mContext.getPackageName(),PackageManager.GET_META_DATA);
    }
 catch (    PackageManager.NameNotFoundException e) {
      throw new RuntimeException("Failed to look up ApplicationInfo",e);
    }
    int targetSdkVersion=info.targetSdkVersion;
    int configResourceId=0;
    if (info != null && info.metaData != null) {
      configResourceId=info.metaData.getInt(META_DATA_NETWORK_SECURITY_CONFIG);
    }
    ConfigSource source;
    if (configResourceId != 0) {
      boolean debugBuild=(info.flags & ApplicationInfo.FLAG_DEBUGGABLE) != 0;
      if (DBG) {
        Log.d(LOG_TAG,"Using Network Security Config from resource " + mContext.getResources().getResourceEntryName(configResourceId) + " debugBuild: "+ debugBuild);
      }
      source=new XmlConfigSource(mContext,configResourceId,debugBuild,targetSdkVersion);
    }
 else {
      if (DBG) {
        Log.d(LOG_TAG,"No Network Security Config specified, using platform default");
      }
      boolean usesCleartextTraffic=(info.flags & ApplicationInfo.FLAG_USES_CLEARTEXT_TRAFFIC) != 0;
      source=new DefaultConfigSource(usesCleartextTraffic,targetSdkVersion);
    }
    mConfigSource=source;
    return mConfigSource;
  }
}
