{
  if (DBG)   Log.d(TAG,"getConnectionState()");
  if (mService == null)   return STATE_DISCONNECTED;
  List<BluetoothDevice> connectedDevices=getConnectedDevices();
  for (  BluetoothDevice connectedDevice : connectedDevices) {
    if (device.equals(connectedDevice)) {
      return STATE_CONNECTED;
    }
  }
  return STATE_DISCONNECTED;
}
