{
switch (blockMode) {
case KeymasterDefs.KM_MODE_ECB:
    return BLOCK_MODE_ECB;
case KeymasterDefs.KM_MODE_CBC:
  return BLOCK_MODE_CBC;
case KeymasterDefs.KM_MODE_CTR:
return BLOCK_MODE_CTR;
case KeymasterDefs.KM_MODE_GCM:
return BLOCK_MODE_GCM;
default :
throw new IllegalArgumentException("Unsupported block mode: " + blockMode);
}
}
