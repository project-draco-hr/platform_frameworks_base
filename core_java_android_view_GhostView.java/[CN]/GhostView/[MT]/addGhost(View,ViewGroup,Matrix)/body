{
  if (!(view.getParent() instanceof ViewGroup)) {
    throw new IllegalArgumentException("Ghosted views must be parented by a ViewGroup");
  }
  ViewGroupOverlay overlay=viewGroup.getOverlay();
  ViewOverlay.OverlayViewGroup overlayViewGroup=overlay.mOverlayViewGroup;
  GhostView ghostView=view.mGhostView;
  if (ghostView != null) {
    ViewGroup oldParent=(ViewGroup)ghostView.getParent();
    if (oldParent != overlayViewGroup) {
      oldParent.removeView(ghostView);
      ghostView=null;
    }
  }
  if (ghostView == null) {
    if (matrix == null) {
      matrix=new Matrix();
      calculateMatrix(view,viewGroup,matrix);
    }
    ghostView=new GhostView(view,(ViewGroup)overlayViewGroup.mHostView,matrix);
    overlay.add(ghostView);
  }
  return ghostView;
}
