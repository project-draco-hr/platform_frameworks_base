{
  String cpuAbi=Build.CPU_ABI;
  int result=listPackageSharedLibsForAbiLI(zipFile,cpuAbi,nativeFiles);
  if (result == PACKAGE_INSTALL_NATIVE_ABI_MISMATCH) {
    final String cpuAbi2=SystemProperties.get("ro.product.cpu.abi2",null);
    if (cpuAbi2 != null) {
      result=listPackageSharedLibsForAbiLI(zipFile,cpuAbi2,nativeFiles);
    }
    if (result == PACKAGE_INSTALL_NATIVE_ABI_MISMATCH) {
      Slog.w(TAG,"Native ABI mismatch from package file");
      return PackageManager.INSTALL_FAILED_INVALID_APK;
    }
    if (result == PACKAGE_INSTALL_NATIVE_FOUND_LIBRARIES) {
      cpuAbi=cpuAbi2;
    }
  }
  if (result == PACKAGE_INSTALL_NATIVE_FOUND_LIBRARIES) {
    listPackageGdbServerLI(zipFile,cpuAbi,nativeFiles);
  }
  return PackageManager.INSTALL_SUCCEEDED;
}
