{
  ZipFile zipFile;
  try {
    zipFile=new ZipFile(scanFile);
    List<Pair<ZipEntry,String>> nativeFiles=new LinkedList<Pair<ZipEntry,String>>();
    NativeLibraryHelper.listPackageNativeBinariesLI(zipFile,nativeFiles);
    final int N=nativeFiles.size();
    for (int i=0; i < N; i++) {
      final Pair<ZipEntry,String> entry=nativeFiles.get(i);
      File destFile=new File(sharedLibraryDir,entry.second);
      copyNativeBinaryLI(zipFile,entry.first,sharedLibraryDir,destFile);
    }
    zipFile.close();
  }
 catch (  ZipException e) {
    Slog.w(TAG,"Failed to extract data from package file",e);
    return PackageManager.INSTALL_FAILED_INVALID_APK;
  }
catch (  IOException e) {
    Slog.w(TAG,"Failed to cache package shared libs",e);
    return PackageManager.INSTALL_FAILED_INSUFFICIENT_STORAGE;
  }
  return PackageManager.INSTALL_SUCCEEDED;
}
