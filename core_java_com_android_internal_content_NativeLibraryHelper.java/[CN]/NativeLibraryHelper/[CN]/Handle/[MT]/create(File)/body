{
  final PackageLite lite;
  try {
    lite=PackageParser.parsePackageLite(packageFile,0);
  }
 catch (  PackageParserException e) {
    throw new IOException("Failed to parse package: " + packageFile,e);
  }
  final List<String> codePaths=lite.getAllCodePaths();
  final int size=codePaths.size();
  final long[] apkHandles=new long[size];
  for (int i=0; i < size; i++) {
    final String path=codePaths.get(i);
    apkHandles[i]=nativeOpenApk(path);
    if (apkHandles[i] == 0) {
      for (int j=0; j < i; j++) {
        nativeClose(apkHandles[j]);
      }
      throw new IOException("Unable to open APK: " + path);
    }
  }
  return new Handle(apkHandles);
}
