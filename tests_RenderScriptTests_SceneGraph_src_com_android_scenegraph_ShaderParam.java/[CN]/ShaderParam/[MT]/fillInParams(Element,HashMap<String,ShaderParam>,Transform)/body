{
  RenderScriptGL rs=SceneManager.getRS();
  ArrayList<ScriptField_ShaderParam_s.Item> paramList;
  paramList=new ArrayList<ScriptField_ShaderParam_s.Item>();
  int subElemCount=constantElem.getSubElementCount();
  for (int i=0; i < subElemCount; i++) {
    String inputName=constantElem.getSubElementName(i);
    int offset=constantElem.getSubElementOffsetBytes(i);
    ShaderParam matchingParam=sourceParams.get(inputName);
    Element subElem=constantElem.getSubElement(i);
    if (matchingParam == null) {
      if (subElem.getDataType() == Element.DataType.FLOAT_32) {
        matchingParam=new Float4Param(inputName,0.5f,0.5f,0.5f,0.5f);
      }
 else       if (subElem.getDataType() == Element.DataType.MATRIX_4X4) {
        TransformParam trParam=new TransformParam(inputName);
        trParam.setTransform(transform);
        matchingParam=trParam;
      }
    }
    ScriptField_ShaderParam_s.Item paramRS=new ScriptField_ShaderParam_s.Item();
    paramRS.bufferOffset=offset;
    paramRS.transformTimestamp=0;
    paramRS.dataTimestamp=0;
    paramRS.data=matchingParam.getRSData().getAllocation();
    if (subElem.getDataType() == Element.DataType.FLOAT_32) {
      paramRS.float_vecSize=subElem.getVectorSize();
    }
    paramList.add(paramRS);
  }
  ScriptField_ShaderParam_s rsParams=null;
  int paramCount=paramList.size();
  if (paramCount != 0) {
    rsParams=new ScriptField_ShaderParam_s(rs,paramCount);
    for (int i=0; i < paramCount; i++) {
      rsParams.set(paramList.get(i),i,false);
    }
    rsParams.copyAll();
  }
  return rsParams;
}
