{
  if (getContext() instanceof BridgeContext) {
    BridgeContext bc=(BridgeContext)getContext();
    if (attrs instanceof BridgeXmlBlockParser) {
      BridgeXmlBlockParser parser=(BridgeXmlBlockParser)attrs;
      Object viewKey=parser.getViewCookie();
      if (viewKey == null) {
        int currentDepth=parser.getDepth();
        BridgeXmlBlockParser previousParser=bc.getPreviousParser();
        if (previousParser != null) {
          int testDepth=mIsInMerge ? 2 : 1;
          if (currentDepth == testDepth) {
            viewKey=previousParser.getViewCookie();
            if (viewKey != null && mIsInMerge) {
              viewKey=new MergeCookie(viewKey);
            }
          }
        }
 else         if (mResourceReference != null && currentDepth == 1) {
          viewKey=mResourceReference;
        }
      }
      if (viewKey != null) {
        bc.addViewKey(view,viewKey);
      }
    }
  }
}
