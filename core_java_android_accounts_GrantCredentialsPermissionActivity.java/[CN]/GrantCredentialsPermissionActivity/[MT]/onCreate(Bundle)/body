{
  super.onCreate(savedInstanceState);
  getWindow().setContentView(R.layout.grant_credentials_permission);
  mAccount=getIntent().getExtras().getParcelable(EXTRAS_ACCOUNT);
  mAuthTokenType=getIntent().getExtras().getString(EXTRAS_AUTH_TOKEN_TYPE);
  mUid=getIntent().getExtras().getInt(EXTRAS_REQUESTING_UID);
  final String accountTypeLabel=getIntent().getExtras().getString(EXTRAS_ACCOUNT_TYPE_LABEL);
  final String[] packages=getIntent().getExtras().getStringArray(EXTRAS_PACKAGES);
  findViewById(R.id.allow).setOnClickListener(this);
  findViewById(R.id.deny).setOnClickListener(this);
  TextView messageView=(TextView)getWindow().findViewById(R.id.message);
  String authTokenLabel=getIntent().getExtras().getString(EXTRAS_AUTH_TOKEN_LABEL);
  if (authTokenLabel.length() == 0) {
    CharSequence grantCredentialsPermissionFormat=getResources().getText(R.string.grant_credentials_permission_message_desc);
    messageView.setText(String.format(grantCredentialsPermissionFormat.toString(),mAccount.name,accountTypeLabel));
  }
 else {
    CharSequence grantCredentialsPermissionFormat=getResources().getText(R.string.grant_credentials_permission_message_with_authtokenlabel_desc);
    messageView.setText(String.format(grantCredentialsPermissionFormat.toString(),authTokenLabel,mAccount.name,accountTypeLabel));
  }
  String[] packageLabels=new String[packages.length];
  final PackageManager pm=getPackageManager();
  for (int i=0; i < packages.length; i++) {
    try {
      packageLabels[i]=pm.getApplicationLabel(pm.getApplicationInfo(packages[i],0)).toString();
    }
 catch (    PackageManager.NameNotFoundException e) {
      packageLabels[i]=packages[i];
    }
  }
  ((ListView)findViewById(R.id.packages_list)).setAdapter(new PackagesArrayAdapter(this,packageLabels));
}
