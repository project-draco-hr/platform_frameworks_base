{
  String platformDir=System.getProperty(PLATFORM_DIR_PROPERTY);
  if (platformDir != null && !platformDir.isEmpty() && new File(platformDir).isDirectory()) {
    return platformDir;
  }
  String androidHostOut=System.getenv("ANDROID_HOST_OUT");
  if (androidHostOut != null) {
    platformDir=getPlatformDirFromHostOut(new File(androidHostOut));
    if (platformDir != null) {
      return platformDir;
    }
  }
  String workingDirString=System.getProperty("user.dir");
  File workingDir=new File(workingDirString);
  platformDir=getPlatformDirFromRoot(workingDir);
  if (platformDir != null) {
    return platformDir;
  }
  File currentDir=workingDir;
  for (int i=0; i < 4; i++) {
    if (currentDir != null) {
      currentDir=currentDir.getParentFile();
    }
  }
  return currentDir == null ? null : getPlatformDirFromRoot(currentDir);
}
