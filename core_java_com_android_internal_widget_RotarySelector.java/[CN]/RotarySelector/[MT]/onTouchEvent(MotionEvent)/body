{
  if (mAnimating) {
    return true;
  }
  final int eventX=(int)event.getX();
  final int hitWindow=mDimpleWidth;
  final int action=event.getAction();
switch (action) {
case MotionEvent.ACTION_DOWN:
    if (DBG)     log("touch-down");
  mTriggered=false;
if (mGrabbedState != NOTHING_GRABBED) {
  reset();
  invalidate();
}
if (eventX < mLeftHandleX + hitWindow) {
mTouchDragOffset=eventX - mLeftHandleX;
mGrabbedState=LEFT_HANDLE_GRABBED;
invalidate();
vibrate(VIBRATE_SHORT);
}
 else if (eventX > mRightHandleX - hitWindow) {
mTouchDragOffset=eventX - mRightHandleX;
mGrabbedState=RIGHT_HANDLE_GRABBED;
invalidate();
vibrate(VIBRATE_SHORT);
}
break;
case MotionEvent.ACTION_MOVE:
if (DBG) log("touch-move");
if (mGrabbedState == LEFT_HANDLE_GRABBED) {
mTouchDragOffset=eventX - mLeftHandleX;
invalidate();
if (eventX >= getRight() - mEdgeTriggerThresh && !mTriggered) {
mTriggered=true;
dispatchTriggerEvent(OnDialTriggerListener.LEFT_HANDLE);
mAnimating=true;
mAnimationEndTime=currentAnimationTimeMillis() + ANIMATION_DURATION_MILLIS;
mAnimatingDelta=-mBackgroundWidth;
mTouchDragOffset=0;
mGrabbedState=NOTHING_GRABBED;
invalidate();
}
}
 else if (mGrabbedState == RIGHT_HANDLE_GRABBED) {
mTouchDragOffset=eventX - mRightHandleX;
invalidate();
if (eventX <= mEdgeTriggerThresh && !mTriggered) {
mTriggered=true;
dispatchTriggerEvent(OnDialTriggerListener.RIGHT_HANDLE);
mAnimating=true;
mAnimationEndTime=currentAnimationTimeMillis() + ANIMATION_DURATION_MILLIS;
mAnimatingDelta=mBackgroundWidth;
mTouchDragOffset=0;
mGrabbedState=NOTHING_GRABBED;
invalidate();
}
}
break;
case MotionEvent.ACTION_UP:
if (DBG) log("touch-up");
if (mGrabbedState == LEFT_HANDLE_GRABBED && Math.abs(eventX - mLeftHandleX) > 5) {
mAnimating=true;
mAnimationEndTime=currentAnimationTimeMillis() + ANIMATION_DURATION_MILLIS;
mAnimatingDelta=eventX - mLeftHandleX;
}
 else if (mGrabbedState == RIGHT_HANDLE_GRABBED && Math.abs(eventX - mRightHandleX) > 5) {
mAnimating=true;
mAnimationEndTime=currentAnimationTimeMillis() + ANIMATION_DURATION_MILLIS;
mAnimatingDelta=eventX - mRightHandleX;
}
mTouchDragOffset=0;
mGrabbedState=NOTHING_GRABBED;
invalidate();
break;
case MotionEvent.ACTION_CANCEL:
if (DBG) log("touch-cancel");
reset();
invalidate();
break;
}
return true;
}
