{
  final Resources res=mContext.getResources();
  int height=-1;
  if (mPlugged) {
    final DisplayMetrics metrics=new DisplayMetrics();
    Display display=mWindowManager.getDefaultDisplay();
    display.getRealMetrics(metrics);
    final int shortSide=Math.min(metrics.widthPixels,metrics.heightPixels);
    final int externalShortSide=Math.min(display.getRawExternalWidth(),display.getRawExternalHeight());
    height=shortSide - externalShortSide;
  }
  final int minHeight=res.getDimensionPixelSize(com.android.internal.R.dimen.status_bar_height);
  if (height < minHeight) {
    height=minHeight;
  }
  Slog.i(TAG,"Resizing status bar plugged=" + mPlugged + " height="+ height+ " old="+ mHeight);
  mHeight=height;
  final int N=mListeners.size();
  for (int i=0; i < N; i++) {
    mListeners.get(i).onBarHeightChanged(height);
  }
}
