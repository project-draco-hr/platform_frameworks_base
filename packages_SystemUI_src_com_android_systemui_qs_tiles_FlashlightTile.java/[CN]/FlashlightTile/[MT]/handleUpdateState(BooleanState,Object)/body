{
  if (state.value) {
    mWasLastOn=SystemClock.uptimeMillis();
  }
  if (arg instanceof Boolean) {
    state.value=(Boolean)arg;
  }
  if (!state.value && mWasLastOn != 0) {
    if (SystemClock.uptimeMillis() > mWasLastOn + RECENTLY_ON_DURATION_MILLIS) {
      mWasLastOn=0;
    }
 else {
      mHandler.removeCallbacks(mRecentlyOnTimeout);
      mHandler.postAtTime(mRecentlyOnTimeout,mWasLastOn + RECENTLY_ON_DURATION_MILLIS);
    }
  }
  state.visible=mWasLastOn != 0 || mFlashlightController.isAvailable();
  state.label=mHost.getContext().getString(R.string.quick_settings_flashlight_label);
  state.iconId=state.value ? R.drawable.ic_qs_flashlight_on : R.drawable.ic_qs_flashlight_off;
  int onOrOffId=state.value ? R.string.accessibility_quick_settings_flashlight_on : R.string.accessibility_quick_settings_flashlight_off;
  state.contentDescription=mContext.getString(onOrOffId);
}
