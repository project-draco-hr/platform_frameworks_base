{
  long stopRecordingTime=SystemClock.elapsedRealtime();
  if (useMediaRecorder) {
    stopCameraStreaming();
    mMediaRecorder.stop();
    mMediaRecorder.reset();
  }
 else {
  }
  if (mPersistentSurface == null && mRecordingSurface != null) {
    mRecordingSurface.release();
    mRecordingSurface=null;
  }
  return (int)(stopRecordingTime - mRecordingStartTime);
}
