{
  int type=attrs.type;
  outAppOp[0]=AppOpsManager.OP_NONE;
  if (type < WindowManager.LayoutParams.FIRST_SYSTEM_WINDOW || type > WindowManager.LayoutParams.LAST_SYSTEM_WINDOW) {
    return WindowManagerGlobal.ADD_OKAY;
  }
  String permission=null;
switch (type) {
case TYPE_TOAST:
    outAppOp[0]=AppOpsManager.OP_TOAST_WINDOW;
  break;
case TYPE_DREAM:
case TYPE_INPUT_METHOD:
case TYPE_WALLPAPER:
case TYPE_PRIVATE_PRESENTATION:
case TYPE_VOICE_INTERACTION:
break;
case TYPE_PHONE:
case TYPE_PRIORITY_PHONE:
case TYPE_SYSTEM_ALERT:
case TYPE_SYSTEM_ERROR:
case TYPE_SYSTEM_OVERLAY:
permission=android.Manifest.permission.SYSTEM_ALERT_WINDOW;
outAppOp[0]=AppOpsManager.OP_SYSTEM_ALERT_WINDOW;
break;
default :
permission=android.Manifest.permission.INTERNAL_SYSTEM_WINDOW;
}
if (permission != null) {
if (mContext.checkCallingOrSelfPermission(permission) != PackageManager.PERMISSION_GRANTED) {
return WindowManagerGlobal.ADD_PERMISSION_DENIED;
}
}
return WindowManagerGlobal.ADD_OKAY;
}
