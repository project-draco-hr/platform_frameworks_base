{
  mDisplay=display;
  int shortSize, longSize;
  if (width > height) {
    shortSize=height;
    longSize=width;
    mLandscapeRotation=Surface.ROTATION_0;
    mSeascapeRotation=Surface.ROTATION_180;
    if (mContext.getResources().getBoolean(com.android.internal.R.bool.config_reverseDefaultRotation)) {
      mPortraitRotation=Surface.ROTATION_90;
      mUpsideDownRotation=Surface.ROTATION_270;
    }
 else {
      mPortraitRotation=Surface.ROTATION_270;
      mUpsideDownRotation=Surface.ROTATION_90;
    }
  }
 else {
    shortSize=width;
    longSize=height;
    mPortraitRotation=Surface.ROTATION_0;
    mUpsideDownRotation=Surface.ROTATION_180;
    if (mContext.getResources().getBoolean(com.android.internal.R.bool.config_reverseDefaultRotation)) {
      mLandscapeRotation=Surface.ROTATION_270;
      mSeascapeRotation=Surface.ROTATION_90;
    }
 else {
      mLandscapeRotation=Surface.ROTATION_90;
      mSeascapeRotation=Surface.ROTATION_270;
    }
  }
  mExternalDisplayWidth=mDisplay.getRawExternalWidth();
  mExternalDisplayHeight=mDisplay.getRawExternalHeight();
  mStatusBarHeight=mContext.getResources().getDimensionPixelSize(com.android.internal.R.dimen.status_bar_height);
  mNavigationBarHeightForRotation[mPortraitRotation]=mNavigationBarHeightForRotation[mUpsideDownRotation]=mContext.getResources().getDimensionPixelSize(com.android.internal.R.dimen.navigation_bar_height);
  mNavigationBarHeightForRotation[mLandscapeRotation]=mNavigationBarHeightForRotation[mSeascapeRotation]=mContext.getResources().getDimensionPixelSize(com.android.internal.R.dimen.navigation_bar_height_landscape);
  mNavigationBarWidthForRotation[mPortraitRotation]=mNavigationBarWidthForRotation[mUpsideDownRotation]=mNavigationBarWidthForRotation[mLandscapeRotation]=mNavigationBarWidthForRotation[mSeascapeRotation]=mContext.getResources().getDimensionPixelSize(com.android.internal.R.dimen.navigation_bar_width);
  int shortSizeDp=shortSize * DisplayMetrics.DENSITY_DEFAULT / DisplayMetrics.DENSITY_DEVICE;
  if (shortSizeDp < 600) {
    mHasSystemNavBar=false;
    mNavigationBarCanMove=true;
  }
 else   if (shortSizeDp < 720) {
    mHasSystemNavBar=false;
    mNavigationBarCanMove=false;
  }
  if (!mHasSystemNavBar) {
    mHasNavigationBar=mContext.getResources().getBoolean(com.android.internal.R.bool.config_showNavigationBar);
    String navBarOverride=SystemProperties.get("qemu.hw.mainkeys");
    if (!"".equals(navBarOverride)) {
      if (navBarOverride.equals("1"))       mHasNavigationBar=false;
 else       if (navBarOverride.equals("0"))       mHasNavigationBar=true;
    }
  }
 else {
    mHasNavigationBar=false;
  }
  if (mHasSystemNavBar) {
    int longSizeDp=longSize * DisplayMetrics.DENSITY_DEFAULT / DisplayMetrics.DENSITY_DEVICE;
    int barHeightDp=mNavigationBarHeightForRotation[mLandscapeRotation] * DisplayMetrics.DENSITY_DEFAULT / DisplayMetrics.DENSITY_DEVICE;
    int aspect=((shortSizeDp - barHeightDp) * 16) / longSizeDp;
    mCanHideNavigationBar=aspect < 9;
  }
 else   if (mHasNavigationBar) {
    mCanHideNavigationBar=true;
  }
 else {
    mCanHideNavigationBar=false;
  }
  if ("portrait".equals(SystemProperties.get("persist.demo.hdmirotation"))) {
    mHdmiRotation=mPortraitRotation;
  }
 else {
    mHdmiRotation=mLandscapeRotation;
  }
}
