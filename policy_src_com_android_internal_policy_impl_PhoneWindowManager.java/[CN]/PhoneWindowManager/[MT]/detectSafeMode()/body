{
  try {
    int menuState=mWindowManager.getKeycodeState(KeyEvent.KEYCODE_MENU);
    int sState=mWindowManager.getKeycodeState(KeyEvent.KEYCODE_S);
    int dpadState=mWindowManager.getDPadKeycodeState(KeyEvent.KEYCODE_DPAD_CENTER);
    int trackballState=mWindowManager.getTrackballScancodeState(BTN_MOUSE);
    int volumeDownState=mWindowManager.getKeycodeState(KeyEvent.KEYCODE_VOLUME_DOWN);
    mSafeMode=menuState > 0 || sState > 0 || dpadState > 0 || trackballState > 0 || volumeDownState > 0;
    performHapticFeedbackLw(null,mSafeMode ? HapticFeedbackConstants.SAFE_MODE_ENABLED : HapticFeedbackConstants.SAFE_MODE_DISABLED,true);
    if (mSafeMode) {
      Log.i(TAG,"SAFE MODE ENABLED (menu=" + menuState + " s="+ sState+ " dpad="+ dpadState+ " trackball="+ trackballState+ ")");
    }
 else {
      Log.i(TAG,"SAFE MODE not enabled");
    }
    return mSafeMode;
  }
 catch (  RemoteException e) {
    throw new RuntimeException("window manager dead");
  }
}
