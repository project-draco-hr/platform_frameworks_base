{
  if (mHeadless)   return;
  final int newLidState=lidOpen ? LID_OPEN : LID_CLOSED;
  if (newLidState == mLidState) {
    return;
  }
  mLidState=newLidState;
  applyLidSwitchState();
  updateRotation(true);
  if (lidOpen) {
    if (keyguardIsShowingTq()) {
      mKeyguardMediator.onWakeKeyWhenKeyguardShowingTq(KeyEvent.KEYCODE_POWER,mDockMode != Intent.EXTRA_DOCK_STATE_UNDOCKED);
    }
 else {
      mPowerManager.userActivity(SystemClock.uptimeMillis(),false,PowerManager.USER_ACTIVITY_EVENT_BUTTON);
    }
  }
 else   if (!mLidControlsSleep) {
    mPowerManager.userActivity(SystemClock.uptimeMillis(),false,PowerManager.USER_ACTIVITY_EVENT_OTHER);
  }
}
