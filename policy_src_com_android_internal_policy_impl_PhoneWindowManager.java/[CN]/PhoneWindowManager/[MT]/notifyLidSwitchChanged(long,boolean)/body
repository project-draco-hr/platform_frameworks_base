{
  if (mHeadless)   return;
  final int newLidState=lidOpen ? LID_OPEN : LID_CLOSED;
  if (newLidState == mLidState) {
    return;
  }
  mLidState=newLidState;
  applyLidSwitchState();
  updateRotation(true);
  if (lidOpen) {
    if (keyguardIsShowingTq()) {
      mKeyguardDelegate.onWakeKeyWhenKeyguardShowingTq(KeyEvent.KEYCODE_POWER);
    }
 else {
      mPowerManager.wakeUp(SystemClock.uptimeMillis());
    }
  }
 else   if (!mLidControlsSleep) {
    mPowerManager.userActivity(SystemClock.uptimeMillis(),false);
  }
}
