{
  if (mHeadless)   return;
  mLidState=lidOpen ? LID_OPEN : LID_CLOSED;
  updateKeyboardVisibility();
  boolean awakeNow=mKeyguardMediator.doLidChangeTq(lidOpen);
  updateRotation(true);
  if (awakeNow) {
    mKeyguardMediator.pokeWakelock();
  }
 else   if (keyguardIsShowingTq()) {
    if (lidOpen) {
      mKeyguardMediator.onWakeKeyWhenKeyguardShowingTq(KeyEvent.KEYCODE_POWER,mDockMode != Intent.EXTRA_DOCK_STATE_UNDOCKED);
    }
  }
 else {
    if (lidOpen) {
      mPowerManager.userActivity(SystemClock.uptimeMillis(),false,LocalPowerManager.BUTTON_EVENT);
    }
 else {
      mPowerManager.userActivity(SystemClock.uptimeMillis(),false,LocalPowerManager.OTHER_EVENT);
    }
  }
}
