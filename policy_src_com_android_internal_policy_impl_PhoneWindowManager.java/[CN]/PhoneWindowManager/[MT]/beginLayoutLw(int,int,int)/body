{
  mUnrestrictedScreenLeft=mUnrestrictedScreenTop=0;
  mUnrestrictedScreenWidth=displayWidth;
  mUnrestrictedScreenHeight=displayHeight;
  mRestrictedScreenLeft=mRestrictedScreenTop=0;
  mRestrictedScreenWidth=displayWidth;
  mRestrictedScreenHeight=displayHeight;
  mDockLeft=mContentLeft=mStableLeft=mStableFullscreenLeft=mSystemLeft=mCurLeft=0;
  mDockTop=mContentTop=mStableTop=mStableFullscreenTop=mSystemTop=mCurTop=0;
  mDockRight=mContentRight=mStableRight=mStableFullscreenRight=mSystemRight=mCurRight=displayWidth;
  mDockBottom=mContentBottom=mStableBottom=mStableFullscreenBottom=mSystemBottom=mCurBottom=displayHeight;
  mDockLayer=0x10000000;
  mStatusBarLayer=-1;
  final Rect pf=mTmpParentFrame;
  final Rect df=mTmpDisplayFrame;
  final Rect vf=mTmpVisibleFrame;
  pf.left=df.left=vf.left=mDockLeft;
  pf.top=df.top=vf.top=mDockTop;
  pf.right=df.right=vf.right=mDockRight;
  pf.bottom=df.bottom=vf.bottom=mDockBottom;
  boolean navVisible=(mLastSystemUiFlags & View.SYSTEM_UI_FLAG_HIDE_NAVIGATION) == 0;
  if (navVisible) {
    if (mHideNavFakeWindow != null) {
      mHideNavFakeWindow.dismiss();
      mHideNavFakeWindow=null;
    }
  }
 else   if (mHideNavFakeWindow == null) {
    mHideNavFakeWindow=mWindowManagerFuncs.addFakeWindow(mHandler.getLooper(),mHideNavInputEventReceiverFactory,"hidden nav",WindowManager.LayoutParams.TYPE_HIDDEN_NAV_CONSUMER,0,false,false,true);
  }
  navVisible|=!mCanHideNavigationBar;
  if (mNavigationBar != null) {
    mNavigationBarOnBottom=(!mNavigationBarCanMove || displayWidth < displayHeight);
    if (mNavigationBarOnBottom) {
      int top=displayHeight - mNavigationBarHeightForRotation[displayRotation];
      if (mHdmiPlugged) {
        if (top > mExternalDisplayHeight) {
          top=mExternalDisplayHeight;
        }
      }
      mTmpNavigationFrame.set(0,top,displayWidth,displayHeight);
      mStableBottom=mStableFullscreenBottom=mTmpNavigationFrame.top;
      if (navVisible) {
        mNavigationBar.showLw(true);
        mDockBottom=mTmpNavigationFrame.top;
        mRestrictedScreenHeight=mDockBottom - mDockTop;
      }
 else {
        mNavigationBar.hideLw(true);
      }
      if (navVisible && !mNavigationBar.isAnimatingLw()) {
        mSystemBottom=mTmpNavigationFrame.top;
      }
    }
 else {
      int left=displayWidth - mNavigationBarWidthForRotation[displayRotation];
      if (mHdmiPlugged) {
        if (left > mExternalDisplayWidth) {
          left=mExternalDisplayWidth;
        }
      }
      mTmpNavigationFrame.set(left,0,displayWidth,displayHeight);
      mStableRight=mStableFullscreenRight=mTmpNavigationFrame.left;
      if (navVisible) {
        mNavigationBar.showLw(true);
        mDockRight=mTmpNavigationFrame.left;
        mRestrictedScreenWidth=mDockRight - mDockLeft;
      }
 else {
        mNavigationBar.hideLw(true);
      }
      if (navVisible && !mNavigationBar.isAnimatingLw()) {
        mSystemRight=mTmpNavigationFrame.left;
      }
    }
    mContentTop=mCurTop=mDockTop;
    mContentBottom=mCurBottom=mDockBottom;
    mContentLeft=mCurLeft=mDockLeft;
    mContentRight=mCurRight=mDockRight;
    mStatusBarLayer=mNavigationBar.getSurfaceLayer();
    mNavigationBar.computeFrameLw(mTmpNavigationFrame,mTmpNavigationFrame,mTmpNavigationFrame,mTmpNavigationFrame);
    if (DEBUG_LAYOUT)     Log.i(TAG,"mNavigationBar frame: " + mTmpNavigationFrame);
  }
  if (DEBUG_LAYOUT)   Log.i(TAG,String.format("mDock rect: (%d,%d - %d,%d)",mDockLeft,mDockTop,mDockRight,mDockBottom));
  if (mStatusBar != null) {
    pf.left=df.left=mUnrestrictedScreenLeft;
    pf.top=df.top=mUnrestrictedScreenTop;
    pf.right=df.right=mUnrestrictedScreenWidth - mUnrestrictedScreenLeft;
    pf.bottom=df.bottom=mUnrestrictedScreenHeight - mUnrestrictedScreenTop;
    vf.left=mStableLeft;
    vf.top=mStableTop;
    vf.right=mStableRight;
    vf.bottom=mStableBottom;
    mStatusBarLayer=mStatusBar.getSurfaceLayer();
    mStatusBar.computeFrameLw(pf,df,vf,vf);
    mStableTop=mUnrestrictedScreenTop + mStatusBarHeight;
    if (mStatusBar.isVisibleLw()) {
      mDockTop=mUnrestrictedScreenTop + mStatusBarHeight;
      mContentTop=mCurTop=mDockTop;
      mContentBottom=mCurBottom=mDockBottom;
      mContentLeft=mCurLeft=mDockLeft;
      mContentRight=mCurRight=mDockRight;
      if (DEBUG_LAYOUT)       Log.v(TAG,"Status bar: " + String.format("dock=[%d,%d][%d,%d] content=[%d,%d][%d,%d] cur=[%d,%d][%d,%d]",mDockLeft,mDockTop,mDockRight,mDockBottom,mContentLeft,mContentTop,mContentRight,mContentBottom,mCurLeft,mCurTop,mCurRight,mCurBottom));
    }
    if (mStatusBar.isVisibleLw() && !mStatusBar.isAnimatingLw()) {
      mSystemTop=mUnrestrictedScreenTop + mStatusBarHeight;
    }
  }
}
