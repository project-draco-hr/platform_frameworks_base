{
  mConnectedTransports.clear();
  mValidatedTransports.clear();
  for (  NetworkCapabilities nc : mConnectivityManager.getDefaultNetworkCapabilitiesForUser(mCurrentUserId)) {
    for (    int transportType : nc.getTransportTypes()) {
      mConnectedTransports.set(transportType);
      if (nc.hasCapability(NET_CAPABILITY_VALIDATED)) {
        mValidatedTransports.set(transportType);
      }
    }
  }
  if (CHATTY) {
    Log.d(TAG,"updateConnectivity: mConnectedTransports=" + mConnectedTransports);
    Log.d(TAG,"updateConnectivity: mValidatedTransports=" + mValidatedTransports);
  }
  mConnected=!mConnectedTransports.isEmpty();
  mInetCondition=!mValidatedTransports.isEmpty();
  mBluetoothTethered=mConnectedTransports.get(TRANSPORT_BLUETOOTH);
  mEthernetConnected=mConnectedTransports.get(TRANSPORT_ETHERNET);
  pushConnectivityToSignals();
}
