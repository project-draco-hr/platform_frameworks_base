{
  Context context=mContext;
  int combinedSignalIconId=0;
  String combinedLabel="";
  String wifiLabel="";
  String mobileLabel="";
  int N;
  final boolean emergencyOnly=isEmergencyOnly();
  if (!mHasMobileDataFeature) {
    mDataSignalIconId=mPhoneSignalIconId=0;
    mQSPhoneSignalIconId=0;
    mobileLabel="";
  }
 else {
    if (mDataConnected) {
      mobileLabel=mNetworkName;
    }
 else     if (mConnected || emergencyOnly) {
      if (hasService() || emergencyOnly) {
        mobileLabel=mNetworkName;
      }
 else {
        mobileLabel="";
      }
    }
 else {
      mobileLabel=context.getString(R.string.status_bar_settings_signal_meter_disconnected);
    }
    if (mDataConnected) {
      combinedSignalIconId=mDataSignalIconId;
      combinedLabel=mobileLabel;
      combinedSignalIconId=mDataSignalIconId;
      mContentDescriptionCombinedSignal=mContentDescriptionDataType;
    }
  }
  if (mWifiConnected) {
    if (mWifiSsid == null) {
      wifiLabel=context.getString(R.string.status_bar_settings_signal_meter_wifi_nossid);
    }
 else {
      wifiLabel=mWifiSsid;
      if (DEBUG) {
        wifiLabel+="xxxxXXXXxxxxXXXX";
      }
    }
    combinedLabel=wifiLabel;
    combinedSignalIconId=mWifiIconId;
    mContentDescriptionCombinedSignal=mContentDescriptionWifi;
  }
 else {
    if (mHasMobileDataFeature) {
      wifiLabel="";
    }
 else {
      wifiLabel=context.getString(R.string.status_bar_settings_signal_meter_disconnected);
    }
  }
  if (mBluetoothTethered) {
    combinedLabel=mContext.getString(R.string.bluetooth_tethered);
    combinedSignalIconId=mBluetoothTetherIconId;
    mContentDescriptionCombinedSignal=mContext.getString(R.string.accessibility_bluetooth_tether);
  }
  final boolean ethernetConnected=(mConnectedNetworkType == ConnectivityManager.TYPE_ETHERNET);
  if (ethernetConnected) {
    combinedLabel=context.getString(R.string.ethernet_label);
  }
  if (mAirplaneMode && (mServiceState == null || (!hasService() && !mServiceState.isEmergencyOnly()))) {
    mContentDescriptionPhoneSignal=mContext.getString(R.string.accessibility_airplane_mode);
    mAirplaneIconId=FLIGHT_MODE_ICON;
    mPhoneSignalIconId=mDataSignalIconId=mDataTypeIconId=mQSDataTypeIconId=0;
    mQSPhoneSignalIconId=0;
    if (mWifiConnected) {
      mobileLabel="";
    }
 else {
      if (mHasMobileDataFeature) {
        wifiLabel="";
      }
 else {
        wifiLabel=context.getString(R.string.status_bar_settings_signal_meter_disconnected);
        combinedLabel=wifiLabel;
      }
      mContentDescriptionCombinedSignal=mContentDescriptionPhoneSignal;
      combinedSignalIconId=mDataSignalIconId;
    }
  }
 else   if (!mDataConnected && !mWifiConnected && !mBluetoothTethered&& !mWimaxConnected&& !ethernetConnected) {
    combinedLabel=context.getString(R.string.status_bar_settings_signal_meter_disconnected);
    combinedSignalIconId=mHasMobileDataFeature ? mDataSignalIconId : mWifiIconId;
    mContentDescriptionCombinedSignal=mHasMobileDataFeature ? mContentDescriptionDataType : mContentDescriptionWifi;
    mDataTypeIconId=0;
    mQSDataTypeIconId=0;
    if (isCdma()) {
      if (isCdmaEri()) {
        mDataTypeIconId=R.drawable.stat_sys_data_fully_connected_roam;
        mQSDataTypeIconId=TelephonyIcons.QS_DATA_R[mInetCondition];
      }
    }
 else     if (mPhone.isNetworkRoaming()) {
      mDataTypeIconId=R.drawable.stat_sys_data_fully_connected_roam;
      mQSDataTypeIconId=TelephonyIcons.QS_DATA_R[mInetCondition];
    }
  }
  if (DEBUG) {
    Log.d(TAG,"refreshViews connected={" + (mWifiConnected ? " wifi" : "") + (mDataConnected ? " data" : "")+ " } level="+ ((mSignalStrength == null) ? "??" : Integer.toString(mSignalStrength.getLevel()))+ " combinedSignalIconId=0x"+ Integer.toHexString(combinedSignalIconId)+ "/"+ getResourceName(combinedSignalIconId)+ " mobileLabel="+ mobileLabel+ " wifiLabel="+ wifiLabel+ " emergencyOnly="+ emergencyOnly+ " combinedLabel="+ combinedLabel+ " mAirplaneMode="+ mAirplaneMode+ " mDataActivity="+ mDataActivity+ " mPhoneSignalIconId=0x"+ Integer.toHexString(mPhoneSignalIconId)+ " mQSPhoneSignalIconId=0x"+ Integer.toHexString(mQSPhoneSignalIconId)+ " mDataDirectionIconId=0x"+ Integer.toHexString(mDataDirectionIconId)+ " mDataSignalIconId=0x"+ Integer.toHexString(mDataSignalIconId)+ " mDataTypeIconId=0x"+ Integer.toHexString(mDataTypeIconId)+ " mQSDataTypeIconId=0x"+ Integer.toHexString(mQSDataTypeIconId)+ " mWifiIconId=0x"+ Integer.toHexString(mWifiIconId)+ " mQSWifiIconId=0x"+ Integer.toHexString(mQSWifiIconId)+ " mBluetoothTetherIconId=0x"+ Integer.toHexString(mBluetoothTetherIconId));
  }
  for (  NetworkSignalChangedCallback cb : mSignalsChangedCallbacks) {
    notifySignalsChangedCallbacks(cb);
  }
  if (mLastPhoneSignalIconId != mPhoneSignalIconId || mLastWifiIconId != mWifiIconId || mLastInetCondition != mInetCondition || mLastWimaxIconId != mWimaxIconId || mLastDataTypeIconId != mDataTypeIconId || mLastAirplaneMode != mAirplaneMode || mLastLocale != mLocale) {
    for (    SignalCluster cluster : mSignalClusters) {
      refreshSignalCluster(cluster);
    }
  }
  if (mLastAirplaneMode != mAirplaneMode) {
    mLastAirplaneMode=mAirplaneMode;
  }
  if (mLastLocale != mLocale) {
    mLastLocale=mLocale;
  }
  if (mLastPhoneSignalIconId != mPhoneSignalIconId) {
    mLastPhoneSignalIconId=mPhoneSignalIconId;
  }
  if (mLastDataDirectionIconId != mDataDirectionIconId) {
    mLastDataDirectionIconId=mDataDirectionIconId;
  }
  if (mLastWifiIconId != mWifiIconId) {
    mLastWifiIconId=mWifiIconId;
  }
  if (mLastInetCondition != mInetCondition) {
    mLastInetCondition=mInetCondition;
  }
  if (mLastWimaxIconId != mWimaxIconId) {
    mLastWimaxIconId=mWimaxIconId;
  }
  if (mLastCombinedSignalIconId != combinedSignalIconId) {
    mLastCombinedSignalIconId=combinedSignalIconId;
  }
  if (mLastDataTypeIconId != mDataTypeIconId) {
    mLastDataTypeIconId=mDataTypeIconId;
  }
  if (!mLastCombinedLabel.equals(combinedLabel)) {
    mLastCombinedLabel=combinedLabel;
    N=mCombinedLabelViews.size();
    for (int i=0; i < N; i++) {
      TextView v=mCombinedLabelViews.get(i);
      v.setText(combinedLabel);
    }
  }
  N=mWifiLabelViews.size();
  for (int i=0; i < N; i++) {
    TextView v=mWifiLabelViews.get(i);
    v.setText(wifiLabel);
    if ("".equals(wifiLabel)) {
      v.setVisibility(View.GONE);
    }
 else {
      v.setVisibility(View.VISIBLE);
    }
  }
  N=mMobileLabelViews.size();
  for (int i=0; i < N; i++) {
    TextView v=mMobileLabelViews.get(i);
    v.setText(mobileLabel);
    if ("".equals(mobileLabel)) {
      v.setVisibility(View.GONE);
    }
 else {
      v.setVisibility(View.VISIBLE);
    }
  }
  N=mEmergencyViews.size();
  for (int i=0; i < N; i++) {
    StatusBarHeaderView v=mEmergencyViews.get(i);
    v.setShowEmergencyCallsOnly(emergencyOnly);
  }
}
