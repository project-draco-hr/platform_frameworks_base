{
  super.onCreate(icicle);
  final Intent intent=getIntent();
  final String action=intent.getAction();
  final int layoutId;
  if (action.equals(FullBackup.FULL_BACKUP_INTENT_ACTION)) {
    layoutId=R.layout.confirm_backup;
  }
 else   if (action.equals(FullBackup.FULL_RESTORE_INTENT_ACTION)) {
    layoutId=R.layout.confirm_restore;
  }
 else {
    Slog.w(TAG,"Backup/restore confirmation activity launched with invalid action!");
    finish();
    return;
  }
  mToken=intent.getIntExtra(FullBackup.CONF_TOKEN_INTENT_EXTRA,-1);
  if (mToken < 0) {
    Slog.e(TAG,"Backup/restore confirmation requested but no token passed!");
    finish();
    return;
  }
  mBackupManager=IBackupManager.Stub.asInterface(ServiceManager.getService(Context.BACKUP_SERVICE));
  mHandler=new ObserverHandler(getApplicationContext());
  mObserver=new FullObserver();
  setContentView(layoutId);
  mStatusView=(TextView)findViewById(R.id.package_name);
  mAllowButton=(Button)findViewById(R.id.button_allow);
  mDenyButton=(Button)findViewById(R.id.button_deny);
  if (layoutId == R.layout.confirm_backup) {
    TextView pwDesc=(TextView)findViewById(R.id.password_desc);
    try {
      if (mBackupManager.hasBackupPassword()) {
        pwDesc.setText(R.string.backup_password_text);
      }
 else {
        pwDesc.setText(R.string.backup_password_optional);
      }
    }
 catch (    RemoteException e) {
    }
  }
  mAllowButton.setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      sendAcknowledgement(mToken,true,mObserver);
      mAllowButton.setEnabled(false);
      mDenyButton.setEnabled(false);
    }
  }
);
  mDenyButton.setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      sendAcknowledgement(mToken,false,mObserver);
      mAllowButton.setEnabled(false);
      mDenyButton.setEnabled(false);
    }
  }
);
}
