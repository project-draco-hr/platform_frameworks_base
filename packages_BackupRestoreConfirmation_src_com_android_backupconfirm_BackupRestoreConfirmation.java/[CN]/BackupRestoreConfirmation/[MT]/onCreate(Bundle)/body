{
  super.onCreate(icicle);
  final Intent intent=getIntent();
  final String action=intent.getAction();
  int layoutId;
  if (action.equals(FullBackup.FULL_BACKUP_INTENT_ACTION)) {
    layoutId=R.layout.confirm_backup;
  }
 else   if (action.equals(FullBackup.FULL_RESTORE_INTENT_ACTION)) {
    layoutId=R.layout.confirm_restore;
  }
 else {
    Slog.w(TAG,"Backup/restore confirmation activity launched with invalid action!");
    finish();
    return;
  }
  mToken=intent.getIntExtra(FullBackup.CONF_TOKEN_INTENT_EXTRA,-1);
  if (mToken < 0) {
    Slog.e(TAG,"Backup/restore confirmation requested but no token passed!");
    finish();
    return;
  }
  mBackupManager=IBackupManager.Stub.asInterface(ServiceManager.getService(Context.BACKUP_SERVICE));
  mHandler=new ObserverHandler(getApplicationContext());
  mObserver=new FullObserver();
  setContentView(layoutId);
  mStatusView=(TextView)findViewById(R.id.package_name);
  mAllowButton=(Button)findViewById(R.id.button_allow);
  mDenyButton=(Button)findViewById(R.id.button_deny);
  mAllowButton.setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      try {
        mBackupManager.acknowledgeFullBackupOrRestore(mToken,true,mObserver);
      }
 catch (      RemoteException e) {
      }
      mAllowButton.setEnabled(false);
      mDenyButton.setEnabled(false);
    }
  }
);
  mDenyButton.setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      try {
        mBackupManager.acknowledgeFullBackupOrRestore(mToken,false,mObserver);
      }
 catch (      RemoteException e) {
      }
      mAllowButton.setEnabled(false);
      mDenyButton.setEnabled(false);
    }
  }
);
}
