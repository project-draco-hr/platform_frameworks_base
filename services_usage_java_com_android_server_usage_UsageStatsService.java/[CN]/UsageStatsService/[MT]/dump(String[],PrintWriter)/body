{
synchronized (mLock) {
    final long screenOnTime=getScreenOnTimeLocked(checkAndGetTimeLocked());
    IndentingPrintWriter idpw=new IndentingPrintWriter(pw,"  ");
    ArraySet<String> argSet=new ArraySet<>();
    argSet.addAll(Arrays.asList(args));
    final int userCount=mUserState.size();
    for (int i=0; i < userCount; i++) {
      idpw.printPair("user",mUserState.keyAt(i));
      idpw.println();
      idpw.increaseIndent();
      if (argSet.contains("--checkin")) {
        mUserState.valueAt(i).checkin(idpw,screenOnTime);
      }
 else {
        mUserState.valueAt(i).dump(idpw,screenOnTime);
        idpw.println();
        if (args.length > 0 && "history".equals(args[0])) {
          mAppIdleHistory.dump(idpw,mUserState.keyAt(i));
        }
      }
      idpw.decreaseIndent();
    }
    pw.write("Screen On Timebase:" + mScreenOnTime + "\n");
  }
}
