{
synchronized (mLock) {
    final long screenOnTime=getScreenOnTimeLocked(checkAndGetTimeLocked());
    IndentingPrintWriter idpw=new IndentingPrintWriter(pw,"  ");
    ArraySet<String> argSet=new ArraySet<>();
    argSet.addAll(Arrays.asList(args));
    final int userCount=mUserState.size();
    for (int i=0; i < userCount; i++) {
      idpw.printPair("user",mUserState.keyAt(i));
      idpw.println();
      idpw.increaseIndent();
      if (argSet.contains("--checkin")) {
        mUserState.valueAt(i).checkin(idpw,screenOnTime);
      }
 else {
        mUserState.valueAt(i).dump(idpw,screenOnTime);
        idpw.println();
        if (args.length > 0 && "history".equals(args[0])) {
          mAppIdleHistory.dump(idpw,mUserState.keyAt(i));
        }
      }
      idpw.decreaseIndent();
    }
    pw.println("Screen On Timebase:" + mScreenOnTime);
    pw.println();
    pw.println("Settings:");
    pw.print("  mAppIdleDurationMillis=");
    TimeUtils.formatDuration(mAppIdleDurationMillis,pw);
    pw.println();
    pw.print("  mAppIdleWallclockThresholdMillis=");
    TimeUtils.formatDuration(mAppIdleWallclockThresholdMillis,pw);
    pw.println();
    pw.print("  mCheckIdleIntervalMillis=");
    TimeUtils.formatDuration(mCheckIdleIntervalMillis,pw);
    pw.println();
    pw.print("  mAppIdleParoleIntervalMillis=");
    TimeUtils.formatDuration(mAppIdleParoleIntervalMillis,pw);
    pw.println();
    pw.print("  mAppIdleParoleDurationMillis=");
    TimeUtils.formatDuration(mAppIdleParoleDurationMillis,pw);
    pw.println();
  }
}
