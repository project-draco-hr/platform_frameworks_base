{
  if (phase == PHASE_SYSTEM_SERVICES_READY) {
    new SettingsObserver(mHandler).registerObserver();
    mAppWidgetManager=getContext().getSystemService(AppWidgetManager.class);
    mDeviceIdleController=IDeviceIdleController.Stub.asInterface(ServiceManager.getService(DeviceIdleController.SERVICE_NAME));
    mDisplayManager=(DisplayManager)getContext().getSystemService(Context.DISPLAY_SERVICE);
    mScreenOnSystemTimeSnapshot=System.currentTimeMillis();
synchronized (this) {
      mScreenOnTime=readScreenOnTimeLocked();
    }
    mDisplayManager.registerDisplayListener(mDisplayListener,null);
synchronized (this) {
      updateDisplayLocked();
    }
  }
 else   if (phase == PHASE_BOOT_COMPLETED) {
    setAppIdleParoled(getContext().getSystemService(BatteryManager.class).isCharging());
  }
}
