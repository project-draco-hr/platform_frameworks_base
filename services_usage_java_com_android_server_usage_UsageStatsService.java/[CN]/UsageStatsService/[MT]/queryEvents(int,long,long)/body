{
  final long timeNow=System.currentTimeMillis();
  endTime=Math.min(endTime,timeNow - END_TIME_DELAY);
  if (beginTime > endTime) {
    return null;
  }
synchronized (mLock) {
    UserUsageStatsService service=getUserDataAndInitializeIfNeededLocked(userId);
    return service.queryEvents(beginTime,endTime);
  }
}
