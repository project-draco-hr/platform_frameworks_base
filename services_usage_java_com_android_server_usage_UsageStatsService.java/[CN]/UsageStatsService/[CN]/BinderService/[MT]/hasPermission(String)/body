{
  final int callingUid=Binder.getCallingUid();
  if (callingUid == Process.SYSTEM_UID) {
    return true;
  }
  final int mode=mAppOps.checkOp(AppOpsManager.OP_GET_USAGE_STATS,callingUid,callingPackage);
  if (mode == AppOpsManager.MODE_DEFAULT) {
    return getContext().checkCallingPermission(Manifest.permission.PACKAGE_USAGE_STATS) == PackageManager.PERMISSION_GRANTED;
  }
  return mode == AppOpsManager.MODE_ALLOWED;
}
