{
  PowerManager pm=(PowerManager)context.getSystemService(Context.POWER_SERVICE);
  mWakeLock=pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK,"WiredAccessoryManager");
  mWakeLock.setReferenceCounted(false);
  mAudioManager=(AudioManager)context.getSystemService(Context.AUDIO_SERVICE);
  mInputManager=inputManager;
  mUseDevInputEventForAudioJack=context.getResources().getBoolean(R.bool.config_useDevInputEventForAudioJack);
  mObserver=new WiredAccessoryObserver();
  IntentFilter filter=new IntentFilter(Intent.ACTION_BOOT_COMPLETED);
  filter.setPriority(IntentFilter.SYSTEM_HIGH_PRIORITY);
  context.registerReceiver(new BroadcastReceiver(){
    @Override public void onReceive(    Context ctx,    Intent intent){
      bootCompleted();
    }
  }
,filter,null,null);
}
