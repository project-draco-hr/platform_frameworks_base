{
  Graphics2D originalGraphics=layer.getGraphics();
  if (paint == null) {
    drawOnGraphics((Graphics2D)originalGraphics.create(),drawable,null,layer);
  }
 else {
    ColorFilter_Delegate filter=paint.getColorFilter();
    if (filter == null || !filter.isSupported()) {
      Graphics2D configuredGraphics=createCustomGraphics(originalGraphics,paint,compositeOnly,forceMode);
      drawOnGraphics(configuredGraphics,drawable,paint,layer);
      return;
    }
    int x=0;
    int y=0;
    int width;
    int height;
    Rectangle clipBounds=originalGraphics.getClipBounds();
    if (clipBounds != null) {
      if (clipBounds.width == 0 || clipBounds.height == 0) {
        return;
      }
      x=clipBounds.x;
      y=clipBounds.y;
      width=clipBounds.width;
      height=clipBounds.height;
    }
 else {
      width=layer.getImage().getWidth();
      height=layer.getImage().getHeight();
    }
    BufferedImage image=new BufferedImage(width,height,BufferedImage.TYPE_INT_ARGB);
    Graphics2D imageBaseGraphics=(Graphics2D)image.getGraphics();
    Graphics2D imageGraphics=createCustomGraphics(imageBaseGraphics,paint,compositeOnly,AlphaComposite.SRC_OVER);
    Graphics2D configuredGraphics=createCustomGraphics(originalGraphics,paint,true,forceMode);
    try {
      imageGraphics.translate(-x,-y);
      drawable.draw(imageGraphics,paint);
      imageGraphics.translate(x,y);
      filter.applyFilter(imageGraphics,width,height);
      configuredGraphics.drawImage(image,x,y,null);
      layer.change();
    }
  finally {
      imageGraphics.dispose();
      imageBaseGraphics.dispose();
      configuredGraphics.dispose();
    }
  }
}
