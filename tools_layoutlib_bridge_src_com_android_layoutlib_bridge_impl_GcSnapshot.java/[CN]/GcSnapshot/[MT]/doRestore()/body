{
  if (mPrevious != null) {
    if (mLocalLayer != null) {
      int i=mLayers.size() - 1;
      int flags;
      do {
        Layer dstLayer=mLayers.get(i - 1);
        restoreLayer(dstLayer);
        flags=dstLayer.getFlags();
        i--;
      }
 while (i > 0 && (flags & Canvas.CLIP_TO_LAYER_SAVE_FLAG) == 0);
    }
    if ((mFlags & Canvas.MATRIX_SAVE_FLAG) == 0) {
      AffineTransform mtx=getTransform();
      for (      Layer layer : mPrevious.mLayers) {
        layer.getGraphics().setTransform(mtx);
      }
    }
    if ((mFlags & Canvas.CLIP_SAVE_FLAG) == 0) {
      Shape clip=getClip();
      for (      Layer layer : mPrevious.mLayers) {
        layer.getGraphics().setClip(clip);
      }
    }
  }
  for (  Layer layer : mLayers) {
    layer.getGraphics().dispose();
  }
  return mPrevious;
}
