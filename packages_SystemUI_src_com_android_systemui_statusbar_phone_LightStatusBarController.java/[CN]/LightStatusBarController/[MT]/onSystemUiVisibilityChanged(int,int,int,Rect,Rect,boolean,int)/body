{
  int oldFullscreen=mFullscreenStackVisibility;
  int newFullscreen=(oldFullscreen & ~mask) | (fullscreenStackVis & mask);
  int diffFullscreen=newFullscreen ^ oldFullscreen;
  int oldDocked=mDockedStackVisibility;
  int newDocked=(oldDocked & ~mask) | (dockedStackVis & mask);
  int diffDocked=newDocked ^ oldDocked;
  if ((diffFullscreen & View.SYSTEM_UI_FLAG_LIGHT_STATUS_BAR) != 0 || (diffDocked & View.SYSTEM_UI_FLAG_LIGHT_STATUS_BAR) != 0 || sbModeChanged || !mLastFullscreenBounds.equals(fullscreenStackBounds) || !mLastDockedBounds.equals(dockedStackBounds)) {
    mFullscreenLight=isLight(newFullscreen,statusBarMode);
    mDockedLight=isLight(newDocked,statusBarMode);
    update(fullscreenStackBounds,dockedStackBounds);
  }
  mFullscreenStackVisibility=newFullscreen;
  mDockedStackVisibility=newDocked;
  mLastFullscreenBounds.set(fullscreenStackBounds);
  mLastDockedBounds.set(dockedStackBounds);
}
