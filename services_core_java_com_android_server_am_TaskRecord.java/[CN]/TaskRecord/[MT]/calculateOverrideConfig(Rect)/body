{
  final Configuration serviceConfig=mService.mConfiguration;
  final Configuration config=new Configuration(Configuration.EMPTY);
  final float density=serviceConfig.densityDpi * DisplayMetrics.DENSITY_DEFAULT_SCALE;
  config.screenWidthDp=Math.min((int)(bounds.width() / density),serviceConfig.screenWidthDp);
  config.screenHeightDp=Math.min((int)(bounds.height() / density),serviceConfig.screenHeightDp);
  config.smallestScreenWidthDp=Math.min(config.screenWidthDp,config.screenHeightDp);
  config.orientation=(config.screenWidthDp <= config.screenHeightDp) ? Configuration.ORIENTATION_PORTRAIT : Configuration.ORIENTATION_LANDSCAPE;
  final int sl=Configuration.resetScreenLayout(serviceConfig.screenLayout);
  int longSize=Math.max(config.screenWidthDp,config.screenHeightDp);
  int shortSize=Math.min(config.screenWidthDp,config.screenHeightDp);
  config.screenLayout=Configuration.reduceScreenLayout(sl,longSize,shortSize);
  return config;
}
