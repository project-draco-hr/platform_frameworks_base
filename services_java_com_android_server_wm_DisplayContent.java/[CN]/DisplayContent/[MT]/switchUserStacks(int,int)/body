{
  final WindowList windows=getWindowList();
  for (int i=0; i < windows.size(); i++) {
    final WindowState win=windows.get(i);
    if (win.isHiddenFromUserLocked()) {
      if (DEBUG_VISIBILITY)       Slog.w(TAG,"user changing " + newUserId + " hiding "+ win+ ", attrs="+ win.mAttrs.type+ ", belonging to "+ win.mOwnerUid);
      win.hideLw(false);
    }
  }
  mUserStacks.put(oldUserId,new UserStacks());
  UserStacks userStacks=mUserStacks.get(newUserId);
  if (userStacks != null) {
    userStacks.restore();
    mUserStacks.delete(newUserId);
  }
}
