{
  HdmiCecLocalDeviceTv tv=mSource;
  ActiveSource activeSource=tv.getActiveSource();
  if (activeSource.equals(newActive)) {
    invokeCallback(HdmiControlManager.RESULT_SUCCESS);
    return;
  }
  HdmiDeviceInfo device=mService.getDeviceInfo(newActive.logicalAddress);
  if (device == null) {
    tv.startNewDeviceAction(newActive,deviceType);
  }
  if (!tv.isProhibitMode()) {
    tv.updateActiveSource(newActive);
    boolean notifyInputChange=(mCallback == null);
    tv.updateActiveInput(newActive.physicalAddress,notifyInputChange);
    invokeCallback(HdmiControlManager.RESULT_SUCCESS);
  }
 else {
    ActiveSource current=tv.getActiveSource();
    if (current.logicalAddress == getSourceAddress()) {
      HdmiCecMessage activeSourceCommand=HdmiCecMessageBuilder.buildActiveSource(current.logicalAddress,current.physicalAddress);
      mService.sendCecCommand(activeSourceCommand);
      tv.updateActiveSource(current);
      invokeCallback(HdmiControlManager.RESULT_SUCCESS);
    }
 else {
      tv.startRoutingControl(newActive.physicalAddress,current.physicalAddress,true,mCallback);
    }
  }
}
