{
  Log.e(TAG,"recoverBluetoothServiceFromError");
synchronized (mConnection) {
    if (mBluetooth != null) {
      try {
        mBluetooth.unregisterCallback(mBluetoothCallback);
      }
 catch (      RemoteException re) {
        Log.e(TAG,"Unable to unregister",re);
      }
    }
  }
  SystemClock.sleep(500);
  handleDisable();
  waitForOnOff(false,true);
  sendBluetoothServiceDownCallback();
synchronized (mConnection) {
    if (mBluetooth != null) {
      mBluetooth=null;
      mContext.unbindService(mConnection);
    }
    mBluetoothGatt=null;
  }
  mHandler.removeMessages(MESSAGE_BLUETOOTH_STATE_CHANGE);
  mState=BluetoothAdapter.STATE_OFF;
  mEnable=false;
  if (mErrorRecoveryRetryCounter++ < MAX_ERROR_RESTART_RETRIES) {
    Message restartMsg=mHandler.obtainMessage(MESSAGE_RESTART_BLUETOOTH_SERVICE);
    mHandler.sendMessageDelayed(restartMsg,ERROR_RESTART_TIME_MS);
  }
 else {
  }
}
