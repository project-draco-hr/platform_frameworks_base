{
  if (DBG) {
    Slog.d(TAG,"unbindAndFinish(): " + mBluetooth + " mBinding = "+ mBinding);
  }
  try {
    mBluetoothLock.writeLock().lock();
    if (mUnbinding)     return;
    mUnbinding=true;
    mHandler.removeMessages(MESSAGE_BLUETOOTH_STATE_CHANGE);
    mHandler.removeMessages(MESSAGE_BIND_PROFILE_SERVICE);
    if (mBluetooth != null) {
      try {
        mBluetooth.unregisterCallback(mBluetoothCallback);
      }
 catch (      RemoteException re) {
        Slog.e(TAG,"Unable to unregister BluetoothCallback",re);
      }
      if (DBG)       Slog.d(TAG,"Sending unbind request.");
      mBluetoothBinder=null;
      mBluetooth=null;
      mContext.unbindService(mConnection);
      mUnbinding=false;
      mBinding=false;
    }
 else {
      mUnbinding=false;
    }
    mBluetoothGatt=null;
  }
  finally {
    mBluetoothLock.writeLock().unlock();
  }
}
