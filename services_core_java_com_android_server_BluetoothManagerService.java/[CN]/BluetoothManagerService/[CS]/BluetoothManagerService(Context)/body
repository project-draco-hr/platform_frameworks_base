{
  mHandler=new BluetoothHandler(IoThread.get().getLooper());
  mContext=context;
  mBluetooth=null;
  mBluetoothBinder=null;
  mBluetoothGatt=null;
  mBinding=false;
  mUnbinding=false;
  mEnable=false;
  mState=BluetoothAdapter.STATE_OFF;
  mQuietEnableExternal=false;
  mEnableExternal=false;
  mAddress=null;
  mName=null;
  mErrorRecoveryRetryCounter=0;
  mContentResolver=context.getContentResolver();
  registerForBleScanModeChange();
  mCallbacks=new RemoteCallbackList<IBluetoothManagerCallback>();
  mStateChangeCallbacks=new RemoteCallbackList<IBluetoothStateChangeCallback>();
  IntentFilter filter=new IntentFilter(BluetoothAdapter.ACTION_LOCAL_NAME_CHANGED);
  registerForAirplaneMode(filter);
  filter.setPriority(IntentFilter.SYSTEM_HIGH_PRIORITY);
  mContext.registerReceiver(mReceiver,filter);
  loadStoredNameAndAddress();
  if (isBluetoothPersistedStateOn()) {
    mEnableExternal=true;
  }
  int sysUiUid=-1;
  try {
    sysUiUid=mContext.getPackageManager().getPackageUid("com.android.systemui",UserHandle.USER_OWNER);
  }
 catch (  PackageManager.NameNotFoundException e) {
    Log.w(TAG,"Unable to resolve SystemUI's UID.",e);
  }
  mSystemUiUid=sysUiUid;
}
