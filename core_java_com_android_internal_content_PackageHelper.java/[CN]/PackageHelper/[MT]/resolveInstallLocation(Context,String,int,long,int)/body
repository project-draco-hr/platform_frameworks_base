{
  ApplicationInfo existingInfo=null;
  try {
    existingInfo=context.getPackageManager().getApplicationInfo(packageName,PackageManager.GET_UNINSTALLED_PACKAGES);
  }
 catch (  NameNotFoundException ignored) {
  }
  final int prefer;
  final boolean checkBoth;
  boolean ephemeral=false;
  if ((installFlags & PackageManager.INSTALL_EPHEMERAL) != 0) {
    prefer=RECOMMEND_INSTALL_INTERNAL;
    ephemeral=true;
    checkBoth=false;
  }
 else   if ((installFlags & PackageManager.INSTALL_INTERNAL) != 0) {
    prefer=RECOMMEND_INSTALL_INTERNAL;
    checkBoth=false;
  }
 else   if ((installFlags & PackageManager.INSTALL_EXTERNAL) != 0) {
    prefer=RECOMMEND_INSTALL_EXTERNAL;
    checkBoth=false;
  }
 else   if (installLocation == PackageInfo.INSTALL_LOCATION_INTERNAL_ONLY) {
    prefer=RECOMMEND_INSTALL_INTERNAL;
    checkBoth=false;
  }
 else   if (installLocation == PackageInfo.INSTALL_LOCATION_PREFER_EXTERNAL) {
    prefer=RECOMMEND_INSTALL_EXTERNAL;
    checkBoth=true;
  }
 else   if (installLocation == PackageInfo.INSTALL_LOCATION_AUTO) {
    if (existingInfo != null) {
      if ((existingInfo.flags & ApplicationInfo.FLAG_EXTERNAL_STORAGE) != 0) {
        prefer=RECOMMEND_INSTALL_EXTERNAL;
      }
 else {
        prefer=RECOMMEND_INSTALL_INTERNAL;
      }
    }
 else {
      prefer=RECOMMEND_INSTALL_INTERNAL;
    }
    checkBoth=true;
  }
 else {
    prefer=RECOMMEND_INSTALL_INTERNAL;
    checkBoth=false;
  }
  boolean fitsOnInternal=false;
  if (checkBoth || prefer == RECOMMEND_INSTALL_INTERNAL) {
    fitsOnInternal=fitsOnInternal(context,sizeBytes);
  }
  boolean fitsOnExternal=false;
  if (checkBoth || prefer == RECOMMEND_INSTALL_EXTERNAL) {
    fitsOnExternal=fitsOnExternal(context,sizeBytes);
  }
  if (prefer == RECOMMEND_INSTALL_INTERNAL) {
    if (fitsOnInternal) {
      return (ephemeral) ? PackageHelper.RECOMMEND_INSTALL_EPHEMERAL : PackageHelper.RECOMMEND_INSTALL_INTERNAL;
    }
  }
 else   if (prefer == RECOMMEND_INSTALL_EXTERNAL) {
    if (fitsOnExternal) {
      return PackageHelper.RECOMMEND_INSTALL_EXTERNAL;
    }
  }
  if (checkBoth) {
    if (fitsOnInternal) {
      return PackageHelper.RECOMMEND_INSTALL_INTERNAL;
    }
 else     if (fitsOnExternal) {
      return PackageHelper.RECOMMEND_INSTALL_EXTERNAL;
    }
  }
  return PackageHelper.RECOMMEND_FAILED_INSUFFICIENT_STORAGE;
}
