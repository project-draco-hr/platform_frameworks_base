{
synchronized (this) {
    if (task != null) {
      int queueNdx;
      for (queueNdx=mWriteQueue.size() - 1; queueNdx >= 0; --queueNdx) {
        final WriteQueueItem item=mWriteQueue.get(queueNdx);
        if (item instanceof TaskWriteQueueItem && ((TaskWriteQueueItem)item).mTask == task) {
          break;
        }
      }
      if (queueNdx < 0) {
        mWriteQueue.add(new TaskWriteQueueItem(task));
      }
    }
 else {
      mWriteQueue.add(new WriteQueueItem());
    }
    if (flush) {
      mNextWriteTime=-1;
    }
 else     if (mNextWriteTime == 0) {
      mNextWriteTime=SystemClock.uptimeMillis() + PRE_TASK_DELAY_MS;
    }
    if (DEBUG)     Slog.d(TAG,"wakeup: task=" + task + " flush="+ flush+ " mNextWriteTime="+ mNextWriteTime+ " Callers="+ Debug.getCallers(4));
    notifyAll();
  }
}
