{
  mMidiManager=midiManager;
  mInputPortReceivers=inputPortReceivers;
  mInputPortCount=inputPortReceivers.length;
  mOutputPortCount=numOutputPorts;
  mCallback=callback;
  mInputPortOutputPorts=new MidiOutputPort[mInputPortCount];
  mOutputPortDispatchers=new MidiDispatcher[numOutputPorts];
  for (int i=0; i < numOutputPorts; i++) {
    mOutputPortDispatchers[i]=new MidiDispatcher(mInputPortFailureHandler);
  }
  mInputPortOpen=new boolean[mInputPortCount];
  mOutputPortOpenCount=new int[numOutputPorts];
  mGuard.open("close");
}
