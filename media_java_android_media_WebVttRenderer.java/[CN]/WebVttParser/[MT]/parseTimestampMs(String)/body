{
  if (!s.matches("(\\d+:)?[0-5]\\d:[0-5]\\d\\.\\d{3}")) {
    throw new NumberFormatException("has invalid format");
  }
  String[] parts=s.split("\\.",2);
  long value=0;
  for (  String group : parts[0].split(":")) {
    value=value * 60 + Long.parseLong(group);
  }
  return value * 1000 + Long.parseLong(parts[1]);
}
