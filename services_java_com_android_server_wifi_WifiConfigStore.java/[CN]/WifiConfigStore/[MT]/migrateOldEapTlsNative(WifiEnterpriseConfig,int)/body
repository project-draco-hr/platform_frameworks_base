{
  String oldPrivateKey=mWifiNative.getNetworkVariable(netId,OLD_PRIVATE_KEY_NAME);
  if (TextUtils.isEmpty(oldPrivateKey)) {
    return false;
  }
 else {
    oldPrivateKey=removeDoubleQuotes(oldPrivateKey);
    if (TextUtils.isEmpty(oldPrivateKey)) {
      return false;
    }
  }
  config.setFieldValue(WifiEnterpriseConfig.ENGINE_KEY,WifiEnterpriseConfig.ENGINE_ENABLE);
  config.setFieldValue(WifiEnterpriseConfig.ENGINE_ID_KEY,WifiEnterpriseConfig.ENGINE_ID_KEYSTORE);
  final String keyName;
  if (oldPrivateKey.startsWith(WifiEnterpriseConfig.KEYSTORE_URI)) {
    keyName=new String(oldPrivateKey.substring(WifiEnterpriseConfig.KEYSTORE_URI.length()));
  }
 else {
    keyName=oldPrivateKey;
  }
  config.setFieldValue(WifiEnterpriseConfig.PRIVATE_KEY_ID_KEY,keyName);
  mWifiNative.setNetworkVariable(netId,WifiEnterpriseConfig.ENGINE_KEY,config.getFieldValue(WifiEnterpriseConfig.ENGINE_KEY,""));
  mWifiNative.setNetworkVariable(netId,WifiEnterpriseConfig.ENGINE_ID_KEY,config.getFieldValue(WifiEnterpriseConfig.ENGINE_ID_KEY,""));
  mWifiNative.setNetworkVariable(netId,WifiEnterpriseConfig.PRIVATE_KEY_ID_KEY,config.getFieldValue(WifiEnterpriseConfig.PRIVATE_KEY_ID_KEY,""));
  mWifiNative.setNetworkVariable(netId,OLD_PRIVATE_KEY_NAME,EMPTY_VALUE);
  return true;
}
