{
  final ArrayMap<String,Long> state=new ArrayMap<String,Long>();
  FileInputStream fis=new FileInputStream(oldStateFd.getFileDescriptor());
  BufferedInputStream bis=new BufferedInputStream(fis);
  DataInputStream in=new DataInputStream(bis);
  try {
    int version=in.readInt();
    if (version <= mCurrentBlobVersion) {
      final int numKeys=in.readInt();
      for (int i=0; i < numKeys; i++) {
        String key=in.readUTF();
        long checksum=in.readLong();
        state.put(key,checksum);
      }
    }
 else {
      Log.w(TAG,"Prior state from unrecognized version " + version);
    }
  }
 catch (  EOFException e) {
    state.clear();
  }
catch (  Exception e) {
    Log.e(TAG,"Error examining prior backup state " + e.getMessage());
    state.clear();
  }
  return state;
}
