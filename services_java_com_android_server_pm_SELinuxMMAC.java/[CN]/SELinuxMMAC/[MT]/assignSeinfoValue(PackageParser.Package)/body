{
  if (((pkg.applicationInfo.flags & ApplicationInfo.FLAG_SYSTEM) != 0) || ((pkg.applicationInfo.flags & ApplicationInfo.FLAG_UPDATED_SYSTEM_APP) != 0)) {
    for (    Signature s : pkg.mSignatures) {
      if (s == null)       continue;
      if (sSigSeinfo.containsKey(s)) {
        String seinfo=pkg.applicationInfo.seinfo=sSigSeinfo.get(s);
        if (DEBUG_POLICY_INSTALL)         Slog.i(TAG,"package (" + pkg.packageName + ") labeled with seinfo="+ seinfo);
        return;
      }
    }
    if (sPackageSeinfo.containsKey(pkg.packageName)) {
      String seinfo=pkg.applicationInfo.seinfo=sPackageSeinfo.get(pkg.packageName);
      if (DEBUG_POLICY_INSTALL)       Slog.i(TAG,"package (" + pkg.packageName + ") labeled with seinfo="+ seinfo);
      return;
    }
  }
  String seinfo=pkg.applicationInfo.seinfo=sSigSeinfo.get(null);
  if (DEBUG_POLICY_INSTALL)   Slog.i(TAG,"package (" + pkg.packageName + ") labeled with seinfo="+ (seinfo == null ? "null" : seinfo));
}
