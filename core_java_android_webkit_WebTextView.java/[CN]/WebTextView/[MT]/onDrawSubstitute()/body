{
  if (!willNotDraw()) {
    return;
  }
  InputMethodManager imm=InputMethodManager.peekInstance();
  if (imm != null && imm.isActive(this)) {
    Spannable sp=(Spannable)getText();
    int selStart=Selection.getSelectionStart(sp);
    int selEnd=Selection.getSelectionEnd(sp);
    int candStart=EditableInputConnection.getComposingSpanStart(sp);
    int candEnd=EditableInputConnection.getComposingSpanEnd(sp);
    imm.updateSelection(this,selStart,selEnd,candStart,candEnd);
  }
  updateCursorControllerPositions();
}
