{
  ArrayList<String> rsp=doCommand(cmd);
  String[] rdata=new String[rsp.size() - 1];
  int idx=0;
  for (int i=0; i < rsp.size(); i++) {
    String line=rsp.get(i);
    try {
      String[] tok=line.split(" ");
      int code=Integer.parseInt(tok[0]);
      if (code == expectedResponseCode) {
        rdata[idx++]=line.substring(tok[0].length() + 1);
      }
 else       if (code == NativeDaemonConnector.ResponseCode.CommandOkay) {
        if (LOCAL_LOGD)         Slog.d(TAG,String.format("List terminated with {%s}",line));
        int last=rsp.size() - 1;
        if (i != last) {
          Slog.w(TAG,String.format("Recv'd %d lines after end of list {%s}",(last - i),cmd));
          for (int j=i; j <= last; j++) {
            Slog.w(TAG,String.format("ExtraData <%s>",rsp.get(i)));
          }
        }
        return rdata;
      }
 else {
        throw new NativeDaemonConnectorException(String.format("Expected list response %d, but got %d",expectedResponseCode,code));
      }
    }
 catch (    NumberFormatException nfe) {
      throw new NativeDaemonConnectorException(String.format("Error reading code '%s'",line));
    }
  }
  throw new NativeDaemonConnectorException("Got an empty response");
}
