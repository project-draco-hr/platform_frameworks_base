{
  mResponseQueue.clear();
  sendCommand(cmd);
  ArrayList<String> response=new ArrayList<String>();
  boolean complete=false;
  int code=-1;
  while (!complete) {
    try {
      String line=mResponseQueue.take();
      if (LOCAL_LOGD)       Slog.d(TAG,String.format("RSP <- {%s}",line));
      String[] tokens=line.split(" ");
      try {
        code=Integer.parseInt(tokens[0]);
      }
 catch (      NumberFormatException nfe) {
        throw new NativeDaemonConnectorException(String.format("Invalid response from daemon (%s)",line));
      }
      if ((code >= 200) && (code < 600)) {
        complete=true;
      }
      response.add(line);
    }
 catch (    InterruptedException ex) {
      Slog.e(TAG,"Failed to process response",ex);
    }
  }
  if (code >= ResponseCode.FailedRangeStart && code <= ResponseCode.FailedRangeEnd) {
    throw new NativeDaemonConnectorException(code,cmd,response.get(response.size() - 1).substring(4));
  }
  return response;
}
