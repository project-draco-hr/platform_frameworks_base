{
  sendCommand(cmd);
  ArrayList<String> response=new ArrayList<String>();
  boolean complete=false;
  int code=-1;
  while (!complete) {
    try {
      String line=mResponseQueue.take();
      String[] tokens=line.split(" ");
      try {
        code=Integer.parseInt(tokens[0]);
      }
 catch (      NumberFormatException nfe) {
        throw new IllegalStateException(String.format("Invalid response from daemon (%s)",line));
      }
      if ((code >= 200) && (code < 600))       complete=true;
      response.add(line);
    }
 catch (    InterruptedException ex) {
      Log.e(TAG,"InterruptedException");
    }
  }
  if (code >= ResponseCode.FailedRangeStart && code <= ResponseCode.FailedRangeEnd) {
    throw new IllegalStateException(String.format("Command %s failed with code %d",cmd,code));
  }
  return response;
}
