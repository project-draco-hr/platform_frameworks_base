{
  if (cmd.indexOf('\0') >= 0) {
    throw new IllegalArgumentException("unexpected command: " + cmd);
  }
  final StringBuilder builder=new StringBuilder(cmd);
  for (  Object arg : args) {
    final String argString=String.valueOf(arg);
    if (argString.indexOf('\0') >= 0) {
      throw new IllegalArgumentException("unexpected argument: " + arg);
    }
    builder.append(' ');
    appendEscaped(builder,argString);
  }
  final String unterminated=builder.toString();
  if (LOGD)   Slog.d(TAG,"SND -> " + unterminated);
  builder.append('\0');
  if (mOutputStream == null) {
    throw new NativeDaemonConnectorException("missing output stream");
  }
 else {
    try {
      mOutputStream.write(builder.toString().getBytes(Charsets.UTF_8));
    }
 catch (    IOException e) {
      throw new NativeDaemonConnectorException("problem sending command",e);
    }
  }
  return unterminated;
}
