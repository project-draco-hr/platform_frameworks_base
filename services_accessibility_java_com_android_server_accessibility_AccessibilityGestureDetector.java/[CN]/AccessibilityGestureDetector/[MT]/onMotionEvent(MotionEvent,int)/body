{
  final float x=event.getX();
  final float y=event.getY();
  mPolicyFlags=policyFlags;
switch (event.getActionMasked()) {
case MotionEvent.ACTION_DOWN:
    mDoubleTapDetected=false;
  mRecognizingGesture=true;
mPreviousX=x;
mPreviousY=y;
mStrokeBuffer.clear();
mStrokeBuffer.add(new GesturePoint(x,y,event.getEventTime()));
break;
case MotionEvent.ACTION_MOVE:
if (mRecognizingGesture) {
final float dX=Math.abs(x - mPreviousX);
final float dY=Math.abs(y - mPreviousY);
if (dX >= TOUCH_TOLERANCE || dY >= TOUCH_TOLERANCE) {
mPreviousX=x;
mPreviousY=y;
mStrokeBuffer.add(new GesturePoint(x,y,event.getEventTime()));
}
}
break;
case MotionEvent.ACTION_UP:
if (maybeFinishDoubleTap(event,policyFlags)) {
return true;
}
if (mRecognizingGesture) {
mStrokeBuffer.add(new GesturePoint(x,y,event.getEventTime()));
if (recognizeGesture()) {
return true;
}
}
break;
}
if (!mRecognizingGesture) {
return false;
}
return mGestureDetector.onTouchEvent(event);
}
