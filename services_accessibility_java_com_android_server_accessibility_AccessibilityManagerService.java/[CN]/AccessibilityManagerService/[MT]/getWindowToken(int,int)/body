{
  mSecurityPolicy.enforceCallingPermission(Manifest.permission.RETRIEVE_WINDOW_TOKEN,GET_WINDOW_TOKEN);
synchronized (mLock) {
    final int resolvedUserId=mSecurityPolicy.resolveCallingUserIdEnforcingPermissionsLocked(userId);
    if (resolvedUserId != mCurrentUserId) {
      return null;
    }
    if (mSecurityPolicy.findWindowById(windowId) == null) {
      return null;
    }
    IBinder token=mGlobalWindowTokens.get(windowId);
    if (token != null) {
      return token;
    }
    return getCurrentUserStateLocked().mWindowTokens.get(windowId);
  }
}
