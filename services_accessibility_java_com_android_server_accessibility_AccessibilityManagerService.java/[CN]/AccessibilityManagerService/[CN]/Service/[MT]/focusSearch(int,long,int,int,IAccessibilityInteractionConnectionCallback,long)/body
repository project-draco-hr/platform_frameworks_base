{
  final int resolvedWindowId;
  IAccessibilityInteractionConnection connection=null;
  Region partialInteractiveRegion=mTempRegion;
synchronized (mLock) {
    final int resolvedUserId=mSecurityPolicy.resolveCallingUserIdEnforcingPermissionsLocked(UserHandle.USER_CURRENT);
    if (resolvedUserId != mCurrentUserId) {
      return false;
    }
    resolvedWindowId=resolveAccessibilityWindowIdLocked(accessibilityWindowId);
    final boolean permissionGranted=mSecurityPolicy.canGetAccessibilityNodeInfoLocked(this,resolvedWindowId);
    if (!permissionGranted) {
      return false;
    }
 else {
      connection=getConnectionLocked(resolvedWindowId);
      if (connection == null) {
        return false;
      }
    }
    if (!mSecurityPolicy.computePartialInteractiveRegionForWindowLocked(resolvedWindowId,partialInteractiveRegion)) {
      partialInteractiveRegion=null;
    }
  }
  final int interrogatingPid=Binder.getCallingPid();
  final long identityToken=Binder.clearCallingIdentity();
  MagnificationSpec spec=getCompatibleMagnificationSpecLocked(resolvedWindowId);
  try {
    connection.focusSearch(accessibilityNodeId,direction,partialInteractiveRegion,interactionId,callback,mFetchFlags,interrogatingPid,interrogatingTid,spec);
    return true;
  }
 catch (  RemoteException re) {
    if (DEBUG) {
      Slog.e(LOG_TAG,"Error calling accessibilityFocusSearch()");
    }
  }
 finally {
    Binder.restoreCallingIdentity(identityToken);
  }
  return false;
}
