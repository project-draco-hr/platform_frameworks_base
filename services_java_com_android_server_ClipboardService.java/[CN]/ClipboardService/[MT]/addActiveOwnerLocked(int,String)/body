{
  PackageInfo pi;
  try {
    pi=mPm.getPackageInfo(pkg,0);
    if (pi.applicationInfo.uid != uid) {
      throw new SecurityException("Calling uid " + uid + " does not own package "+ pkg);
    }
  }
 catch (  NameNotFoundException e) {
    throw new IllegalArgumentException("Unknown package " + pkg,e);
  }
  if (mPrimaryClip != null && !mActivePermissionOwners.contains(pkg)) {
    final int N=mPrimaryClip.getItemCount();
    for (int i=0; i < N; i++) {
      grantItemLocked(mPrimaryClip.getItem(i),pkg);
    }
    mActivePermissionOwners.add(pkg);
  }
}
