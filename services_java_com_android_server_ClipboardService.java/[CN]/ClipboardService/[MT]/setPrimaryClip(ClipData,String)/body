{
synchronized (this) {
    if (clip != null && clip.getItemCount() <= 0) {
      throw new IllegalArgumentException("No items");
    }
    if (mAppOps.noteOp(AppOpsManager.OP_WRITE_CLIPBOARD,Binder.getCallingUid(),callingPackage) != AppOpsManager.MODE_ALLOWED) {
      return;
    }
    checkDataOwnerLocked(clip,Binder.getCallingUid());
    clearActiveOwnersLocked();
    PerUserClipboard clipboard=getClipboard();
    clipboard.primaryClip=clip;
    final int n=clipboard.primaryClipListeners.beginBroadcast();
    for (int i=0; i < n; i++) {
      try {
        ListenerInfo li=(ListenerInfo)clipboard.primaryClipListeners.getBroadcastCookie(i);
        if (mAppOps.checkOpNoThrow(AppOpsManager.OP_READ_CLIPBOARD,li.mUid,li.mPackageName) == AppOpsManager.MODE_ALLOWED) {
          clipboard.primaryClipListeners.getBroadcastItem(i).dispatchPrimaryClipChanged();
        }
      }
 catch (      RemoteException e) {
      }
    }
    clipboard.primaryClipListeners.finishBroadcast();
  }
}
