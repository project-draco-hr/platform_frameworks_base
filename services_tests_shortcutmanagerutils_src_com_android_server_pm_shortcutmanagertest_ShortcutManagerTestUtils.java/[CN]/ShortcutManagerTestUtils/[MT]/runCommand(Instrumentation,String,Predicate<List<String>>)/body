{
  Log.d(TAG,"Running command: " + command);
  final List<String> result;
  try {
    result=readAll(instrumentation.getUiAutomation().executeShellCommand(command));
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
  if (resultAsserter != null && !resultAsserter.test(result)) {
    fail("Command '" + command + "' failed, output was:\n"+ concatResult(result));
  }
  return result;
}
