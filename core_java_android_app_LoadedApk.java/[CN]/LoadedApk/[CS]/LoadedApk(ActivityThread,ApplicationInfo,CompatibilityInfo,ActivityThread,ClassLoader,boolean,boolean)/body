{
  mActivityThread=activityThread;
  mApplicationInfo=aInfo;
  mPackageName=aInfo.packageName;
  mAppDir=aInfo.sourceDir;
  final int myUid=Process.myUid();
  mResDir=aInfo.uid == myUid ? aInfo.sourceDir : aInfo.publicSourceDir;
  if (!UserHandle.isSameUser(aInfo.uid,myUid) && !Process.isIsolated()) {
    aInfo.dataDir=PackageManager.getDataDirForUser(UserHandle.getUserId(myUid),mPackageName);
  }
  mSharedLibraries=aInfo.sharedLibraryFiles;
  mDataDir=aInfo.dataDir;
  mDataDirFile=mDataDir != null ? new File(mDataDir) : null;
  mLibDir=aInfo.nativeLibraryDir;
  mBaseClassLoader=baseLoader;
  mSecurityViolation=securityViolation;
  mIncludeCode=includeCode;
  mCompatibilityInfo.set(compatInfo);
  if (mAppDir == null) {
    if (ActivityThread.mSystemContext == null) {
      ActivityThread.mSystemContext=ContextImpl.createSystemContext(mainThread);
      ActivityThread.mSystemContext.getResources().updateConfiguration(mainThread.getConfiguration(),mainThread.getDisplayMetricsLocked(Display.DEFAULT_DISPLAY,compatInfo),compatInfo);
    }
    mClassLoader=ActivityThread.mSystemContext.getClassLoader();
    mResources=ActivityThread.mSystemContext.getResources();
  }
}
