{
  if (!isOpen()) {
    throw new IllegalStateException("database not open");
  }
  SQLiteStatement prog=null;
  lock();
  try {
    prog=new SQLiteStatement(this,"PRAGMA user_version;");
    long version=prog.simpleQueryForLong();
    return (int)version;
  }
  finally {
    if (prog != null)     prog.close();
    unlock();
  }
}
