{
  SQLiteDatabase sqliteDatabase=new SQLiteDatabase(path,factory,flags,errorHandler);
  try {
    sqliteDatabase.openDatabase(path,flags);
    if (SQLiteDebug.DEBUG_SQL_STATEMENTS) {
      sqliteDatabase.enableSqlTracing(path);
    }
    if (SQLiteDebug.DEBUG_SQL_TIME) {
      sqliteDatabase.enableSqlProfiling(path);
    }
  }
 catch (  SQLiteDatabaseCorruptException e) {
    errorHandler.onCorruption(sqliteDatabase);
    sqliteDatabase=new SQLiteDatabase(path,factory,flags,errorHandler);
  }
  if (sBlockSize == 0) {
    sBlockSize=new StatFs("/data").getBlockSize();
  }
  sqliteDatabase.setPageSize(sBlockSize);
  String s=DatabaseUtils.stringForQuery(sqliteDatabase,"PRAGMA journal_mode=TRUNCATE",null);
  if (!s.equalsIgnoreCase("TRUNCATE")) {
    Log.e(TAG,"setting journal_mode to TRUNCATE failed");
  }
  ActiveDatabases.addActiveDatabase(sqliteDatabase);
  return sqliteDatabase;
}
