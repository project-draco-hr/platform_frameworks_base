{
  if (!isOpen()) {
    throw new IllegalStateException("database not open");
  }
  SQLiteStatement prog=null;
  lock();
  try {
    long pageSize=getPageSize();
    long numPages=numBytes / pageSize;
    if ((numBytes % pageSize) != 0) {
      numPages++;
    }
    prog=new SQLiteStatement(this,"PRAGMA max_page_count = " + numPages);
    long newPageCount=prog.simpleQueryForLong();
    return newPageCount * pageSize;
  }
  finally {
    if (prog != null)     prog.close();
    unlock();
  }
}
