{
  if (!isOpen()) {
    throw new IllegalStateException("database: " + getPath() + " is NOT open");
  }
  ArrayList<Pair<String,String>> attachedDbs=getAttachedDbs();
  if (attachedDbs == null) {
    throw new IllegalStateException("databaselist for: " + getPath() + " couldn't "+ "be retrieved. probably because the database is closed");
  }
  boolean isDatabaseCorrupt=false;
  for (int i=0; i < attachedDbs.size(); i++) {
    Pair<String,String> p=attachedDbs.get(i);
    SQLiteStatement prog=null;
    try {
      prog=compileStatement("PRAGMA " + p.first + ".integrity_check(1);");
      String rslt=prog.simpleQueryForString();
      if (!rslt.equalsIgnoreCase("ok")) {
        isDatabaseCorrupt=true;
        Log.e(TAG,"PRAGMA integrity_check on " + p.second + " returned: "+ rslt);
      }
    }
  finally {
      if (prog != null)       prog.close();
    }
  }
  return isDatabaseCorrupt;
}
