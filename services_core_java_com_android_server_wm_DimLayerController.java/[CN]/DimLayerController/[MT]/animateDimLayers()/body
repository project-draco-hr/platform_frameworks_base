{
  int fullScreen=-1;
  int fullScreenAndDimming=-1;
  boolean result=false;
  for (int i=mState.size() - 1; i >= 0; i--) {
    DimLayer.DimLayerUser user=mState.keyAt(i);
    DimLayerState state=mState.valueAt(i);
    if (user.isFullscreen() && state.dimLayer == mSharedFullScreenDimLayer) {
      fullScreen=i;
      if (mState.valueAt(i).continueDimming) {
        fullScreenAndDimming=i;
      }
    }
 else {
      result|=animateDimLayers(user);
    }
  }
  if (fullScreenAndDimming != -1) {
    result|=animateDimLayers(mState.keyAt(fullScreenAndDimming));
  }
 else   if (fullScreen != -1) {
    result|=animateDimLayers(mState.keyAt(fullScreen));
  }
  return result;
}
