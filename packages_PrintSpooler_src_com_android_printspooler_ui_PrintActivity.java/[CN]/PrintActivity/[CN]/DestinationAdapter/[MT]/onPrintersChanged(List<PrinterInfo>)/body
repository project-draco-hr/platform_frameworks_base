{
  mHistoricalPrintersLoaded=mPrinterRegistry.areHistoricalPrintersLoaded();
  if (mPrinterHolders.isEmpty()) {
    addPrinters(mPrinterHolders,printers);
    notifyDataSetChanged();
    return;
  }
  ArrayMap<PrinterId,PrinterInfo> newPrintersMap=new ArrayMap<>();
  final int printerCount=printers.size();
  for (int i=0; i < printerCount; i++) {
    PrinterInfo printer=printers.get(i);
    newPrintersMap.put(printer.getId(),printer);
  }
  List<PrinterHolder> newPrinterHolders=new ArrayList<>();
  final int oldPrinterCount=mPrinterHolders.size();
  for (int i=0; i < oldPrinterCount; i++) {
    PrinterHolder printerHolder=mPrinterHolders.get(i);
    PrinterId oldPrinterId=printerHolder.printer.getId();
    PrinterInfo updatedPrinter=newPrintersMap.remove(oldPrinterId);
    if (updatedPrinter != null) {
      printerHolder.printer=updatedPrinter;
      printerHolder.removed=false;
      onPrinterAvailable(printerHolder.printer);
      newPrinterHolders.add(printerHolder);
    }
 else     if (mCurrentPrinter != null && mCurrentPrinter.getId().equals(oldPrinterId)) {
      printerHolder.removed=true;
      onPrinterUnavailable(printerHolder.printer);
      newPrinterHolders.add(printerHolder);
    }
  }
  addPrinters(newPrinterHolders,newPrintersMap.values());
  mPrinterHolders.clear();
  mPrinterHolders.addAll(newPrinterHolders);
  notifyDataSetChanged();
}
