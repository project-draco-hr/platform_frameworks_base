{
  if (mPrintedDocument != null && mPrintedDocument.isUpdating()) {
    return;
  }
  if (mIsFinishing) {
    return;
  }
  mIsFinishing=true;
  if (mPrinterRegistry != null) {
    mPrinterRegistry.setTrackedPrinter(null);
  }
  if (mPrintersObserver != null) {
    mDestinationSpinnerAdapter.unregisterDataSetObserver(mPrintersObserver);
  }
  if (mSpoolerProvider != null) {
    mSpoolerProvider.destroy();
  }
  if (mState != STATE_INITIALIZING) {
    mProgressMessageController.cancel();
    mPrintedDocument.finish();
    mPrintedDocument.destroy();
    mPrintPreviewController.destroy(new Runnable(){
      @Override public void run(){
        finish();
      }
    }
);
  }
 else {
    finish();
  }
}
