{
  if (mPrinterRegistry != null) {
    mPrinterRegistry.setTrackedPrinter(null);
  }
  if (mState != STATE_INITIALIZING) {
    mProgressMessageController.cancel();
    mSpoolerProvider.destroy();
    mPrintedDocument.finish();
    mPrintedDocument.destroy();
    mPrintPreviewController.destroy(new Runnable(){
      @Override public void run(){
        finish();
      }
    }
);
  }
 else {
    finish();
  }
}
