{
  setTitle(R.string.print_dialog);
  setContentView(R.layout.print_activity);
  final MutexFileProvider fileProvider;
  try {
    fileProvider=new MutexFileProvider(PrintSpoolerService.generateFileForPrintJob(PrintActivity.this,mPrintJob.getId()));
  }
 catch (  IOException ioe) {
    throw new IllegalStateException("Cannot create print job file",ioe);
  }
  mPrintPreviewController=new PrintPreviewController(PrintActivity.this,fileProvider);
  mPrintedDocument=new RemotePrintDocument(PrintActivity.this,IPrintDocumentAdapter.Stub.asInterface(documentAdapter),fileProvider,new RemotePrintDocument.DocumentObserver(){
    @Override public void onDestroy(){
      finish();
    }
  }
,PrintActivity.this);
  mProgressMessageController=new ProgressMessageController(PrintActivity.this);
  mMediaSizeComparator=new MediaSizeComparator(PrintActivity.this);
  mDestinationSpinnerAdapter=new DestinationAdapter();
  bindUi();
  updateOptionsUi();
  mOptionsContent.setVisibility(View.VISIBLE);
  mSelectedPages=computeSelectedPages();
  mPrintedDocument.start();
  ensurePreviewUiShown();
  setState(STATE_CONFIGURING);
}
