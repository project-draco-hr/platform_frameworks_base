{
  if (resultCode != RESULT_OK || data == null) {
    return;
  }
  PrintJobInfo printJobInfo=data.getParcelableExtra(PrintService.EXTRA_PRINT_JOB_INFO);
  if (printJobInfo == null) {
    return;
  }
  mPrintJob.setAdvancedOptions(printJobInfo.getAdvancedOptions());
  mCopiesEditText.setText(String.valueOf(printJobInfo.getCopies()));
  mPrintJob.setCopies(printJobInfo.getCopies());
  PrintAttributes currAttributes=mPrintJob.getAttributes();
  PrintAttributes newAttributes=printJobInfo.getAttributes();
  MediaSize oldMediaSize=currAttributes.getMediaSize();
  MediaSize newMediaSize=newAttributes.getMediaSize();
  if (!oldMediaSize.equals(newMediaSize)) {
    final int mediaSizeCount=mMediaSizeSpinnerAdapter.getCount();
    MediaSize newMediaSizePortrait=newAttributes.getMediaSize().asPortrait();
    for (int i=0; i < mediaSizeCount; i++) {
      MediaSize supportedSizePortrait=mMediaSizeSpinnerAdapter.getItem(i).value.asPortrait();
      if (supportedSizePortrait.equals(newMediaSizePortrait)) {
        currAttributes.setMediaSize(newMediaSize);
        mMediaSizeSpinner.setSelection(i);
        if (currAttributes.getMediaSize().isPortrait()) {
          if (mOrientationSpinner.getSelectedItemPosition() != 0) {
            mOrientationSpinner.setSelection(0);
          }
        }
 else {
          if (mOrientationSpinner.getSelectedItemPosition() != 1) {
            mOrientationSpinner.setSelection(1);
          }
        }
        break;
      }
    }
  }
  final int currColorMode=currAttributes.getColorMode();
  final int newColorMode=newAttributes.getColorMode();
  if (currColorMode != newColorMode) {
    final int colorModeCount=mColorModeSpinner.getCount();
    for (int i=0; i < colorModeCount; i++) {
      final int supportedColorMode=mColorModeSpinnerAdapter.getItem(i).value;
      if (supportedColorMode == newColorMode) {
        currAttributes.setColorMode(newColorMode);
        mColorModeSpinner.setSelection(i);
        break;
      }
    }
  }
  PrintDocumentInfo info=mPrintedDocument.getDocumentInfo().info;
  final int pageCount=(info != null) ? getAdjustedPageCount(info) : 0;
  PageRange[] pageRanges=printJobInfo.getPages();
  updateSelectedPages(pageRanges,pageCount);
  if (canUpdateDocument()) {
    updateDocument(false);
  }
}
