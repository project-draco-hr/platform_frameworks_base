{
  mProgressMessageController.cancel();
  ensurePreviewUiShown();
  PrintDocumentInfo info=document.info;
  if (info == null) {
    return;
  }
  final int pageCount=PageRangeUtils.getNormalizedPageCount(document.writtenPages,info.getPageCount());
  PrintDocumentInfo adjustedInfo=new PrintDocumentInfo.Builder(info.getName()).setContentType(info.getContentType()).setPageCount(pageCount).build();
  mPrintJob.setDocumentInfo(adjustedInfo);
  mPrintJob.setPages(document.printedPages);
  finishIfConfirmedOrCanceled();
  updateOptionsUi();
}
