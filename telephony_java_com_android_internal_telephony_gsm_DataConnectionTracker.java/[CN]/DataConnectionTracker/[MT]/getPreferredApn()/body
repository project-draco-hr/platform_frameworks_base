{
  if (allApns.isEmpty()) {
    return null;
  }
  Cursor cursor=phone.getContext().getContentResolver().query(PREFERAPN_URI,new String[]{"_id","name","apn"},null,null,Telephony.Carriers.DEFAULT_SORT_ORDER);
  if (cursor != null) {
    canSetPreferApn=true;
  }
 else {
    canSetPreferApn=false;
  }
  if (canSetPreferApn && cursor.getCount() > 0) {
    int pos;
    cursor.moveToFirst();
    pos=cursor.getInt(cursor.getColumnIndexOrThrow(Telephony.Carriers._ID));
    for (    ApnSetting p : allApns) {
      if (p.id == pos && p.canHandleType(mRequestedApnType)) {
        cursor.close();
        return p;
      }
    }
  }
  if (cursor != null) {
    cursor.close();
  }
  return null;
}
