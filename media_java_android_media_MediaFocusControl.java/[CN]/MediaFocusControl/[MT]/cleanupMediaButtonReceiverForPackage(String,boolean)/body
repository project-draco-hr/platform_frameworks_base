{
synchronized (mPRStack) {
    if (mPRStack.empty()) {
      return;
    }
 else {
      final PackageManager pm=mContext.getPackageManager();
      PlayerRecord oldTop=mPRStack.peek();
      Iterator<PlayerRecord> stackIterator=mPRStack.iterator();
      while (stackIterator.hasNext()) {
        PlayerRecord prse=stackIterator.next();
        if (removeAll && packageName.equals(prse.getMediaButtonIntent().getCreatorPackage())) {
          stackIterator.remove();
          prse.destroy();
        }
 else         if (prse.getMediaButtonReceiver() != null) {
          try {
            pm.getReceiverInfo(prse.getMediaButtonReceiver(),0);
          }
 catch (          PackageManager.NameNotFoundException e) {
            stackIterator.remove();
            prse.destroy();
          }
        }
      }
      if (mPRStack.empty()) {
        mEventHandler.sendMessage(mEventHandler.obtainMessage(MSG_PERSIST_MEDIABUTTONRECEIVER,0,0,null));
      }
 else       if (oldTop != mPRStack.peek()) {
        PlayerRecord prse=mPRStack.peek();
        if (prse.getMediaButtonReceiver() != null) {
          mEventHandler.sendMessage(mEventHandler.obtainMessage(MSG_PERSIST_MEDIABUTTONRECEIVER,0,0,prse.getMediaButtonReceiver()));
        }
      }
    }
  }
}
