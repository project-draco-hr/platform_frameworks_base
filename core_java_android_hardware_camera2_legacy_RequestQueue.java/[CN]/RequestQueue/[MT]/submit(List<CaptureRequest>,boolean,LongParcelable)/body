{
  int requestId=mCurrentRequestId++;
  BurstHolder burst=new BurstHolder(requestId,repeating,requests);
  long ret=INVALID_FRAME;
  if (burst.isRepeating()) {
    if (mRepeatingRequest != null) {
      ret=(mCurrentRepeatingFrameNumber == INVALID_FRAME) ? INVALID_FRAME : mCurrentRepeatingFrameNumber - 1;
    }
    mCurrentRepeatingFrameNumber=INVALID_FRAME;
    mRepeatingRequest=burst;
  }
 else {
    mRequestQueue.offer(burst);
    ret=calculateLastFrame(burst.getRequestId());
  }
  frameNumber.setNumber(ret);
  return requestId;
}
