{
  AccountAndUser au=new AccountAndUser(accountName,userId);
  AccountInfo account=mAccounts.get(au);
  if (account == null) {
    account=new AccountInfo(au);
    mAccounts.put(au,account);
  }
  AuthorityInfo authority=account.authorities.get(authorityName);
  if (authority == null) {
    if (ident < 0) {
      ident=mNextAuthorityId;
      mNextAuthorityId++;
      doWrite=true;
    }
    if (DEBUG) {
      Log.v(TAG,"created a new AuthorityInfo for " + accountName + ", user "+ userId+ ", provider "+ authorityName);
    }
    authority=new AuthorityInfo(accountName,userId,authorityName,ident);
    account.authorities.put(authorityName,authority);
    mAuthorities.put(ident,authority);
    if (doWrite) {
      writeAccountInfoLocked();
    }
  }
  return authority;
}
