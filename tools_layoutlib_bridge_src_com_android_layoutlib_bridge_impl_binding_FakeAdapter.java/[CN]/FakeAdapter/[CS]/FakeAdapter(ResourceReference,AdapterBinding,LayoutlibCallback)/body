{
  mAdapterRef=adapterRef;
  mCallback=callback;
  final int repeatCount=binding.getRepeatCount();
  final int itemCount=binding.getItemCount();
  int[] typeCount=new int[itemCount];
  for (int r=0; r < repeatCount; r++) {
    for (    DataBindingItem dataBindingItem : binding) {
      ResourceReference viewRef=dataBindingItem.getViewReference();
      int typeIndex=mTypes.indexOf(viewRef);
      if (typeIndex == -1) {
        typeIndex=mTypes.size();
        mTypes.add(viewRef);
      }
      int count=dataBindingItem.getCount();
      int index=typeCount[typeIndex];
      typeCount[typeIndex]+=count;
      for (int k=0; k < count; k++) {
        mItems.add(new AdapterItem(dataBindingItem,typeIndex,mItems.size(),index++));
      }
    }
  }
}
