{
  mExpecting=expected;
  long endTime=System.currentTimeMillis() + timeoutMs;
  boolean timeout=false;
synchronized (this) {
    while (!mFinished) {
      long delay=endTime - System.currentTimeMillis();
      if (delay < 0) {
        timeout=true;
        break;
      }
      try {
        wait(delay);
      }
 catch (      java.lang.InterruptedException e) {
      }
    }
  }
  mFinished=false;
  if (timeout) {
    mResultCode=Activity.RESULT_CANCELED;
    onTimeout();
  }
  return mResultCode;
}
