{
  if (Binder.getCallingUid() != uid) {
    mContext.enforceCallingOrSelfPermission(ACCESS_NETWORK_STATE,TAG);
  }
  assertBandwidthControlEnabled();
  final long token=Binder.clearCallingIdentity();
  final NetworkStats networkLayer;
  try {
    networkLayer=mNetworkManager.getNetworkStatsUidDetail(uid);
  }
  finally {
    Binder.restoreCallingIdentity(token);
  }
  networkLayer.spliceOperationsFrom(mUidOperations);
  final NetworkStats dataLayer=new NetworkStats(networkLayer.getElapsedRealtime(),networkLayer.size());
  NetworkStats.Entry entry=null;
  for (int i=0; i < networkLayer.size(); i++) {
    entry=networkLayer.getValues(i,entry);
    entry.iface=IFACE_ALL;
    dataLayer.combineValues(entry);
  }
  return dataLayer;
}
