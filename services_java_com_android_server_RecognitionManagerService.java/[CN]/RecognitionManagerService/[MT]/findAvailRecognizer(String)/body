{
  List<ResolveInfo> available=mContext.getPackageManager().queryIntentServices(new Intent(RecognitionService.SERVICE_INTERFACE),0);
  int numAvailable=available.size();
  if (numAvailable == 0) {
    Slog.w(TAG,"no available voice recognition services found");
    return null;
  }
 else {
    if (prefPackage != null) {
      for (int i=0; i < numAvailable; i++) {
        ServiceInfo serviceInfo=available.get(i).serviceInfo;
        if (prefPackage.equals(serviceInfo.packageName)) {
          return new ComponentName(serviceInfo.packageName,serviceInfo.name);
        }
      }
    }
    if (numAvailable > 1) {
      Slog.w(TAG,"more than one voice recognition service found, picking first");
    }
    ServiceInfo serviceInfo=available.get(0).serviceInfo;
    return new ComponentName(serviceInfo.packageName,serviceInfo.name);
  }
}
