{
  int start=getLineStart(line);
  int end;
  if (full) {
    end=getLineEnd(line);
  }
 else {
    end=getLineVisibleEnd(line);
  }
  boolean tab=getLineContainsTab(line);
  if (tabs == null && tab && mText instanceof Spanned) {
    tabs=((Spanned)mText).getSpans(start,end,TabStopSpan.class);
  }
  return measureText(mPaint,mWorkPaint,mText,start,end,null,tab,tabs);
}
