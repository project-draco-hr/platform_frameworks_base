{
  final UnlockMode unlockMode=getUnlockMode();
  final boolean backupIsTimedOut=(mUpdateMonitor.getFailedAttempts() >= LockPatternUtils.FAILED_ATTEMPTS_BEFORE_TIMEOUT);
  return (mLockPatternUtils.usingBiometricWeak() && mLockPatternUtils.isBiometricWeakInstalled() && !mUpdateMonitor.getMaxBiometricUnlockAttemptsReached()&& !backupIsTimedOut&& (unlockMode == UnlockMode.Pattern || unlockMode == UnlockMode.Password));
}
