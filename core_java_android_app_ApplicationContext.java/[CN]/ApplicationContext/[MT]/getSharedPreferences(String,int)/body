{
  File f;
  f=makeFilename(getPreferencesDir(),name + ".xml");
  SharedPreferencesImpl sp;
synchronized (sSharedPrefs) {
    sp=sSharedPrefs.get(f);
    if (sp != null && !sp.hasFileChanged()) {
      return sp;
    }
  }
  Map map=null;
  try {
    FileInputStream str=new FileInputStream(f);
    map=XmlUtils.readMapXml(str);
    str.close();
  }
 catch (  org.xmlpull.v1.XmlPullParserException e) {
  }
catch (  java.io.FileNotFoundException e) {
  }
catch (  java.io.IOException e) {
  }
synchronized (sSharedPrefs) {
    if (sp != null) {
      sp.replace(map);
    }
 else {
      sp=sSharedPrefs.get(f);
      if (sp == null) {
        sp=new SharedPreferencesImpl(f,mode,map);
        sSharedPrefs.put(f,sp);
      }
    }
    return sp;
  }
}
