{
  if (packageName.equals("system") || packageName.equals("android")) {
    return new ApplicationContext(mMainThread.getSystemContext());
  }
  ActivityThread.PackageInfo pi=mMainThread.getPackageInfo(packageName,flags);
  if (pi != null) {
    ApplicationContext c=new ApplicationContext();
    c.mRestricted=(flags & CONTEXT_RESTRICTED) == CONTEXT_RESTRICTED;
    c.init(pi,null,mMainThread);
    if (c.mResources != null) {
      Resources newRes=c.mResources;
      if (mResources.getCompatibilityInfo().applicationScale != newRes.getCompatibilityInfo().applicationScale) {
        DisplayMetrics dm=mMainThread.getDisplayMetricsLocked(false);
        c.mResources=new Resources(newRes.getAssets(),dm,newRes.getConfiguration(),mResources.getCompatibilityInfo().copy());
        if (DEBUG) {
          Log.d(TAG,"loaded context has different scaling. Using container's" + " compatiblity info:" + mResources.getDisplayMetrics());
        }
      }
      return c;
    }
  }
  throw new PackageManager.NameNotFoundException("Application package " + packageName + " not found");
}
