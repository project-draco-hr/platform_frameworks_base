{
  Context currentUserContext=null;
  UserInfo userInfo=null;
  try {
    userInfo=ActivityManagerNative.getDefault().getCurrentUser();
    currentUserContext=mContext.createPackageContextAsUser("android",0,new UserHandle(userInfo.id));
  }
 catch (  NameNotFoundException e) {
    Log.e(TAG,"Couldn't create user context",e);
    throw new RuntimeException(e);
  }
catch (  RemoteException e) {
    Log.e(TAG,"Couldn't get user info",e);
  }
  final int userId=userInfo.id;
  final String userName=userInfo.name;
  final Context context=currentUserContext;
  mUserInfoTask=new AsyncTask<Void,Void,Pair<String,Drawable>>(){
    @Override protected Pair<String,Drawable> doInBackground(    Void... params){
      final UserManager um=(UserManager)mContext.getSystemService(Context.USER_SERVICE);
      String name=userName;
      Drawable avatar=null;
      Bitmap rawAvatar=um.getUserIcon(userId);
      if (rawAvatar != null) {
        avatar=new BitmapDrawable(mContext.getResources(),rawAvatar);
      }
 else {
        avatar=mContext.getResources().getDrawable(R.drawable.ic_qs_default_user);
      }
      if (um.getUsers().size() <= 1) {
        final Cursor cursor=context.getContentResolver().query(Profile.CONTENT_URI,new String[]{Phone._ID,Phone.DISPLAY_NAME},null,null,null);
        if (cursor != null) {
          try {
            if (cursor.moveToFirst()) {
              name=cursor.getString(cursor.getColumnIndex(Phone.DISPLAY_NAME));
            }
          }
  finally {
            cursor.close();
          }
        }
      }
      return new Pair<String,Drawable>(name,avatar);
    }
    @Override protected void onPostExecute(    Pair<String,Drawable> result){
      super.onPostExecute(result);
      mModel.setUserTileInfo(result.first,result.second);
      mUserInfoTask=null;
    }
  }
;
  mUserInfoTask.execute();
}
