{
  mDisplayManager=(DisplayManager)context.getSystemService(Context.DISPLAY_SERVICE);
  mContext=context;
  mContainerView=container;
  mModel=new QuickSettingsModel(context);
  mWifiDisplayStatus=new WifiDisplayStatus();
  mBluetoothState=new QuickSettingsModel.BluetoothState();
  mBluetoothAdapter=BluetoothAdapter.getDefaultAdapter();
  mWifiManager=(WifiManager)context.getSystemService(Context.WIFI_SERVICE);
  mHandler=new Handler();
  Resources r=mContext.getResources();
  mBatteryLevels=(LevelListDrawable)r.getDrawable(R.drawable.qs_sys_battery);
  mChargingBatteryLevels=(LevelListDrawable)r.getDrawable(R.drawable.qs_sys_battery_charging);
  mBrightnessDialogLongTimeout=r.getInteger(R.integer.quick_settings_brightness_dialog_long_timeout);
  mBrightnessDialogShortTimeout=r.getInteger(R.integer.quick_settings_brightness_dialog_short_timeout);
  IntentFilter filter=new IntentFilter();
  filter.addAction(DisplayManager.ACTION_WIFI_DISPLAY_STATUS_CHANGED);
  filter.addAction(BluetoothAdapter.ACTION_CONNECTION_STATE_CHANGED);
  filter.addAction(BluetoothAdapter.ACTION_STATE_CHANGED);
  filter.addAction(Intent.ACTION_USER_SWITCHED);
  mContext.registerReceiver(mReceiver,filter);
  IntentFilter profileFilter=new IntentFilter();
  profileFilter.addAction(ContactsContract.Intents.ACTION_PROFILE_CHANGED);
  profileFilter.addAction(Intent.ACTION_USER_INFO_CHANGED);
  mContext.registerReceiverAsUser(mProfileReceiver,UserHandle.ALL,profileFilter,null,null);
}
