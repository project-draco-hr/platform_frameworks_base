{
  mContext.enforceCallingOrSelfPermission(BLUETOOTH_ADMIN_PERM,"Need BLUETOOTH_ADMIN permission");
  if (pin == null || pin.length <= 0 || pin.length > 16 || !BluetoothDevice.checkBluetoothAddress(address)) {
    return false;
  }
  Integer data=mEventLoop.getPasskeyAgentRequestData().remove(address);
  if (data == null) {
    Log.w(TAG,"setPin(" + address + ") called but no native data available, "+ "ignoring. Maybe the PasskeyAgent Request was cancelled by the remote device"+ " or by bluez.\n");
    return false;
  }
  String pinString;
  try {
    pinString=new String(pin,"UTF8");
  }
 catch (  UnsupportedEncodingException uee) {
    Log.e(TAG,"UTF8 not supported?!?");
    return false;
  }
  return setPinNative(address,pinString,data.intValue());
}
