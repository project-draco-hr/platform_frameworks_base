{
  if (state == mBluetoothState) {
    return;
  }
  if (DBG)   log("Bluetooth state " + mBluetoothState + " -> "+ state);
  Intent intent=new Intent(BluetoothIntent.BLUETOOTH_STATE_CHANGED_ACTION);
  intent.putExtra(BluetoothIntent.BLUETOOTH_PREVIOUS_STATE,mBluetoothState);
  intent.putExtra(BluetoothIntent.BLUETOOTH_STATE,state);
  intent.addFlags(Intent.FLAG_RECEIVER_REGISTERED_ONLY_BEFORE_BOOT);
  mBluetoothState=state;
  mContext.sendBroadcast(intent,BLUETOOTH_PERM);
}
