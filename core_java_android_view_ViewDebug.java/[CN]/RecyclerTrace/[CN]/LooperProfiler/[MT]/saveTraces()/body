{
  FileOutputStream fos=new FileOutputStream(mFileDescriptor.getFileDescriptor());
  DataOutputStream out=new DataOutputStream(new BufferedOutputStream(fos));
  try {
    writeHeader(out,mTraceWallStart,mTraceNames,mTraces);
    out.flush();
    writeTraces(fos,out.size(),mTraceWallStart,mTraceThreadStart,mTraces);
    Log.d(LOG_TAG,"Looper traces ready: " + mPath);
  }
 catch (  IOException e) {
    Log.e(LOG_TAG,"Could not write trace file " + mPath,e);
  }
 finally {
    try {
      out.close();
    }
 catch (    IOException e) {
      Log.e(LOG_TAG,"Could not write trace file " + mPath,e);
    }
    try {
      mFileDescriptor.close();
    }
 catch (    IOException e) {
      Log.e(LOG_TAG,"Could not write trace file " + mPath,e);
    }
  }
}
