{
  if (sFieldsForClasses == null) {
    sFieldsForClasses=new HashMap<Class<?>,Field[]>();
  }
  if (sAnnotations == null) {
    sAnnotations=new HashMap<AccessibleObject,ExportedProperty>(512);
  }
  final HashMap<Class<?>,Field[]> map=sFieldsForClasses;
  Field[] fields=map.get(klass);
  if (fields != null) {
    return fields;
  }
  final ArrayList<Field> foundFields=new ArrayList<Field>();
  fields=klass.getDeclaredFields();
  int count=fields.length;
  for (int i=0; i < count; i++) {
    final Field field=fields[i];
    if (field.isAnnotationPresent(ExportedProperty.class)) {
      field.setAccessible(true);
      foundFields.add(field);
      sAnnotations.put(field,field.getAnnotation(ExportedProperty.class));
    }
  }
  fields=foundFields.toArray(new Field[foundFields.size()]);
  map.put(klass,fields);
  return fields;
}
