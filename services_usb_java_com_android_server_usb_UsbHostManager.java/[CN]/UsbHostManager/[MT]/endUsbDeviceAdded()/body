{
  if (DEBUG) {
    Slog.d(TAG,"usb:UsbHostManager.endUsbDeviceAdded()");
  }
  if (mNewInterface != null) {
    mNewInterface.setEndpoints(mNewEndpoints.toArray(new UsbEndpoint[mNewEndpoints.size()]));
  }
  if (mNewConfiguration != null) {
    mNewConfiguration.setInterfaces(mNewInterfaces.toArray(new UsbInterface[mNewInterfaces.size()]));
  }
synchronized (mLock) {
    if (mNewDevice != null) {
      mNewDevice.setConfigurations(mNewConfigurations.toArray(new UsbConfiguration[mNewConfigurations.size()]));
      mDevices.put(mNewDevice.getDeviceName(),mNewDevice);
      Slog.d(TAG,"Added device " + mNewDevice);
      getCurrentSettings().deviceAttached(mNewDevice);
      mUsbAlsaManager.deviceAdded(mNewDevice);
    }
 else {
      Slog.e(TAG,"mNewDevice is null in endUsbDeviceAdded");
    }
    mNewDevice=null;
    mNewConfigurations=null;
    mNewInterfaces=null;
    mNewEndpoints=null;
  }
}
