{
synchronized (this) {
    if (mReceiver == null) {
synchronized (this) {
        mReceiver=new BroadcastReceiver(){
          @Override public void onReceive(          Context context,          Intent intent){
            mServices=generateServicesMap();
            RegisteredServicesCacheListener listener=mListener;
            if (listener != null) {
              listener.onRegisteredServicesCacheChanged();
            }
          }
        }
;
      }
      IntentFilter intentFilter=new IntentFilter();
      intentFilter.addAction(Intent.ACTION_PACKAGE_ADDED);
      intentFilter.addAction(Intent.ACTION_PACKAGE_CHANGED);
      intentFilter.addAction(Intent.ACTION_PACKAGE_REMOVED);
      intentFilter.addDataScheme("package");
      mContext.registerReceiver(mReceiver,intentFilter);
      return true;
    }
    return false;
  }
}
