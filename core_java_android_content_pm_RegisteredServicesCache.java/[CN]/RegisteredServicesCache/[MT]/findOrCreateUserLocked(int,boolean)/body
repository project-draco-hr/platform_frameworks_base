{
  UserServices<V> services=mUserServices.get(userId);
  if (services == null) {
    services=new UserServices<V>();
    mUserServices.put(userId,services);
    if (loadFromFileIfNew && mSerializerAndParser != null) {
      UserInfo user=getUser(userId);
      if (user != null) {
        AtomicFile file=createFileForUser(user.id);
        if (file.getBaseFile().exists()) {
          if (DEBUG) {
            Slog.i(TAG,String.format("Loading u%s data from %s",user.id,file));
          }
          InputStream is=null;
          try {
            is=file.openRead();
            readPersistentServicesLocked(is);
          }
 catch (          Exception e) {
            Log.w(TAG,"Error reading persistent services for user " + user.id,e);
          }
 finally {
            IoUtils.closeQuietly(is);
          }
        }
      }
    }
  }
  return services;
}
