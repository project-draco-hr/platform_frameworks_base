{
  mContext=context;
  mCast=cast;
  mHotspot=hotspot;
  mBluetooth=bluetooth;
  mBluetooth.addStateChangedCallback(this);
  mService=(StatusBarManager)context.getSystemService(Context.STATUS_BAR_SERVICE);
  mNextAlarm=nextAlarm;
  mAlarmManager=(AlarmManager)context.getSystemService(Context.ALARM_SERVICE);
  mUserInfoController=userInfoController;
  IntentFilter filter=new IntentFilter();
  filter.addAction(AudioManager.RINGER_MODE_CHANGED_ACTION);
  filter.addAction(AudioManager.INTERNAL_RINGER_MODE_CHANGED_ACTION);
  filter.addAction(TelephonyIntents.ACTION_SIM_STATE_CHANGED);
  filter.addAction(TelecomManager.ACTION_CURRENT_TTY_MODE_CHANGED);
  mContext.registerReceiver(mIntentReceiver,filter,null,mHandler);
  try {
    ActivityManagerNative.getDefault().registerUserSwitchObserver(mUserSwitchListener);
  }
 catch (  RemoteException e) {
  }
  mService.setIcon(SLOT_TTY,R.drawable.stat_sys_tty_mode,0,null);
  mService.setIconVisibility(SLOT_TTY,false);
  updateBluetooth();
  mService.setIcon(SLOT_ALARM_CLOCK,R.drawable.stat_sys_alarm,0,null);
  mService.setIconVisibility(SLOT_ALARM_CLOCK,false);
  mNextAlarm.addStateChangedCallback(mNextAlarmCallback);
  mService.setIcon(SLOT_ZEN,R.drawable.stat_sys_zen_important,0,null);
  mService.setIconVisibility(SLOT_ZEN,false);
  mService.setIcon(SLOT_VOLUME,R.drawable.stat_sys_ringer_vibrate,0,null);
  mService.setIconVisibility(SLOT_VOLUME,false);
  updateVolumeZen();
  mService.setIcon(SLOT_CAST,R.drawable.stat_sys_cast,0,null);
  mService.setIconVisibility(SLOT_CAST,false);
  mCast.addCallback(mCastCallback);
  mService.setIcon(SLOT_HOTSPOT,R.drawable.stat_sys_hotspot,0,mContext.getString(R.string.accessibility_status_bar_hotspot));
  mService.setIconVisibility(SLOT_HOTSPOT,mHotspot.isHotspotEnabled());
  mHotspot.addCallback(mHotspotCallback);
  mService.setIcon(SLOT_MANAGED_PROFILE,R.drawable.stat_sys_managed_profile_status,0,mContext.getString(R.string.accessibility_managed_profile));
  mService.setIconVisibility(SLOT_MANAGED_PROFILE,false);
}
