{
  mContext=context;
  mCast=cast;
  mService=(StatusBarManager)context.getSystemService(Context.STATUS_BAR_SERVICE);
  IntentFilter filter=new IntentFilter();
  filter.addAction(AlarmManager.ACTION_NEXT_ALARM_CLOCK_CHANGED);
  filter.addAction(Intent.ACTION_SYNC_STATE_CHANGED);
  filter.addAction(AudioManager.RINGER_MODE_CHANGED_ACTION);
  filter.addAction(BluetoothAdapter.ACTION_STATE_CHANGED);
  filter.addAction(BluetoothAdapter.ACTION_CONNECTION_STATE_CHANGED);
  filter.addAction(TelephonyIntents.ACTION_SIM_STATE_CHANGED);
  filter.addAction(TelecomManager.ACTION_CURRENT_TTY_MODE_CHANGED);
  filter.addAction(Intent.ACTION_USER_SWITCHED);
  mContext.registerReceiver(mIntentReceiver,filter,null,mHandler);
  mService.setIcon(SLOT_TTY,R.drawable.stat_sys_tty_mode,0,null);
  mService.setIconVisibility(SLOT_TTY,false);
  mService.setIcon(SLOT_CDMA_ERI,R.drawable.stat_sys_roaming_cdma_0,0,null);
  mService.setIconVisibility(SLOT_CDMA_ERI,false);
  BluetoothAdapter adapter=BluetoothAdapter.getDefaultAdapter();
  int bluetoothIcon=R.drawable.stat_sys_data_bluetooth;
  if (adapter != null) {
    mBluetoothEnabled=(adapter.getState() == BluetoothAdapter.STATE_ON);
    if (adapter.getConnectionState() == BluetoothAdapter.STATE_CONNECTED) {
      bluetoothIcon=R.drawable.stat_sys_data_bluetooth_connected;
    }
  }
  mService.setIcon(SLOT_BLUETOOTH,bluetoothIcon,0,null);
  mService.setIconVisibility(SLOT_BLUETOOTH,mBluetoothEnabled);
  mService.setIcon(SLOT_ALARM_CLOCK,R.drawable.stat_sys_alarm,0,null);
  mService.setIconVisibility(SLOT_ALARM_CLOCK,false);
  mService.setIcon(SLOT_SYNC_ACTIVE,R.drawable.stat_sys_sync,0,null);
  mService.setIconVisibility(SLOT_SYNC_ACTIVE,false);
  mService.setIcon(SLOT_ZEN,R.drawable.stat_sys_zen_important,0,null);
  mService.setIconVisibility(SLOT_ZEN,false);
  mService.setIcon(SLOT_VOLUME,R.drawable.stat_sys_ringer_vibrate,0,null);
  mService.setIconVisibility(SLOT_VOLUME,false);
  updateVolumeZen();
  mService.setIcon(SLOT_CAST,R.drawable.stat_sys_cast,0,null);
  mService.setIconVisibility(SLOT_CAST,false);
  mCast.addCallback(mCastCallback);
}
