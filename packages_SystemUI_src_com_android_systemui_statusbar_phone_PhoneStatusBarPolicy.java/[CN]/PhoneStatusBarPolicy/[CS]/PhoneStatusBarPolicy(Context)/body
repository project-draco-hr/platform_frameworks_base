{
  mContext=context;
  mService=(StatusBarManager)context.getSystemService(Context.STATUS_BAR_SERVICE);
  mStorageManager=(StorageManager)context.getSystemService(Context.STORAGE_SERVICE);
  mStorageManager.registerListener(new com.android.systemui.usb.StorageNotification(context));
  mService.setIcon("tty",R.drawable.stat_sys_tty_mode,0,null);
  mService.setIconVisibility("tty",false);
  mService.setIcon("cdma_eri",R.drawable.stat_sys_roaming_cdma_0,0,null);
  mService.setIconVisibility("cdma_eri",false);
  mService.setIcon("bluetooth",R.drawable.stat_sys_data_bluetooth,0,null);
  BluetoothAdapter adapter=BluetoothAdapter.getDefaultAdapter();
  if (adapter != null) {
    mBluetoothEnabled=adapter.isEnabled();
  }
 else {
    mBluetoothEnabled=false;
  }
  mService.setIconVisibility("bluetooth",mBluetoothEnabled);
  mService.setIcon("alarm_clock",R.drawable.stat_sys_alarm,0,null);
  mService.setIconVisibility("alarm_clock",false);
  mService.setIcon("sync_active",R.drawable.stat_sys_sync,0,null);
  mService.setIcon("sync_failing",R.drawable.stat_sys_sync_error,0,null);
  mService.setIconVisibility("sync_active",false);
  mService.setIconVisibility("sync_failing",false);
  mService.setIcon("volume",R.drawable.stat_sys_ringer_silent,0,null);
  mService.setIconVisibility("volume",false);
  updateVolume();
  IntentFilter filter=new IntentFilter();
  filter.addAction(Intent.ACTION_ALARM_CHANGED);
  filter.addAction(Intent.ACTION_SYNC_STATE_CHANGED);
  filter.addAction(AudioManager.RINGER_MODE_CHANGED_ACTION);
  filter.addAction(AudioManager.VIBRATE_SETTING_CHANGED_ACTION);
  filter.addAction(BluetoothAdapter.ACTION_STATE_CHANGED);
  filter.addAction(BluetoothAdapter.ACTION_CONNECTION_STATE_CHANGED);
  filter.addAction(TelephonyIntents.ACTION_SIM_STATE_CHANGED);
  filter.addAction(TtyIntent.TTY_ENABLED_CHANGE_ACTION);
  mContext.registerReceiver(mIntentReceiver,filter,null,mHandler);
}
