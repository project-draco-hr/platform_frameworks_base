{
  if (DEBUG) {
    Slog.d(TAG,"onServiceConnected(component=" + component + ")");
  }
synchronized (mLock) {
    UserState userState=getUserStateLocked(mUserId);
    ServiceState serviceState=userState.serviceStateMap.get(mComponent);
    serviceState.mService=ITvInputService.Stub.asInterface(service);
    if (serviceState.mIsHardware && serviceState.mCallback == null) {
      serviceState.mCallback=new ServiceCallback(mComponent,mUserId);
      try {
        serviceState.mService.registerCallback(serviceState.mCallback);
      }
 catch (      RemoteException e) {
        Slog.e(TAG,"error in registerCallback",e);
      }
    }
    for (    IBinder sessionToken : serviceState.mSessionTokens) {
      createSessionInternalLocked(serviceState.mService,sessionToken,mUserId);
    }
    for (    TvInputState inputState : userState.inputMap.values()) {
      if (inputState.mInfo.getComponent().equals(component) && inputState.mState != INPUT_STATE_DISCONNECTED) {
        notifyInputStateChangedLocked(userState,inputState.mInfo.getId(),inputState.mState,null);
      }
    }
    if (serviceState.mIsHardware) {
      List<TvInputHardwareInfo> hardwareInfoList=mTvInputHardwareManager.getHardwareList();
      for (      TvInputHardwareInfo hardwareInfo : hardwareInfoList) {
        try {
          serviceState.mService.notifyHardwareAdded(hardwareInfo);
        }
 catch (        RemoteException e) {
          Slog.e(TAG,"error in notifyHardwareAdded",e);
        }
      }
      List<HdmiCecDeviceInfo> cecDeviceInfoList=mTvInputHardwareManager.getHdmiCecInputDeviceList();
      for (      HdmiCecDeviceInfo cecDeviceInfo : cecDeviceInfoList) {
        try {
          serviceState.mService.notifyHdmiCecDeviceAdded(cecDeviceInfo);
        }
 catch (        RemoteException e) {
          Slog.e(TAG,"error in notifyHdmiCecDeviceAdded",e);
        }
      }
    }
  }
}
