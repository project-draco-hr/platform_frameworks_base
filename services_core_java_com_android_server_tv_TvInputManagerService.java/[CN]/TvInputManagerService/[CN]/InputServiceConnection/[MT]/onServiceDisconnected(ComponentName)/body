{
  if (DEBUG) {
    Slog.d(TAG,"onServiceDisconnected(inputId=" + mTvInputInfo.getId() + ")");
  }
  if (!mTvInputInfo.getComponent().equals(name)) {
    throw new IllegalArgumentException("Mismatched ComponentName: " + mTvInputInfo.getComponent() + " (expected), "+ name+ " (actual).");
  }
synchronized (mLock) {
    UserState userState=getUserStateLocked(mUserId);
    ServiceState serviceState=userState.serviceStateMap.get(mTvInputInfo.getId());
    if (serviceState != null) {
      serviceState.mReconnecting=true;
      serviceState.mBound=false;
      serviceState.mService=null;
      serviceState.mCallback=null;
      for (      IBinder sessionToken : serviceState.mSessionTokens) {
        SessionState sessionState=userState.sessionStateMap.get(sessionToken);
        if (sessionState.mSession == null) {
          removeSessionStateLocked(sessionToken,sessionState.mUserId);
          sendSessionTokenToClientLocked(sessionState.mClient,sessionState.mInputId,null,null,sessionState.mSeq,sessionState.mUserId);
        }
      }
      if (serviceState.mAvailable) {
        serviceState.mAvailable=false;
        broadcastServiceAvailabilityChangedLocked(serviceState);
      }
      updateServiceConnectionLocked(mTvInputInfo.getId(),mUserId);
    }
  }
}
