{
  if (DEBUG) {
    Slog.d(TAG,"onServiceDisconnected(name=" + name + ")");
  }
  if (!mName.equals(name)) {
    throw new IllegalArgumentException("Mismatched ComponentName: " + mName + " (expected), "+ name+ " (actual).");
  }
synchronized (mLock) {
    UserState userState=getUserStateLocked(mUserId);
    ServiceState serviceState=userState.serviceStateMap.get(mName);
    if (serviceState != null) {
      serviceState.mReconnecting=true;
      serviceState.mBound=false;
      serviceState.mService=null;
      serviceState.mCallback=null;
      for (      IBinder sessionToken : serviceState.mSessionTokens) {
        SessionState sessionState=userState.sessionStateMap.get(sessionToken);
        if (sessionState.mSession == null) {
          removeSessionStateLocked(sessionToken,sessionState.mUserId);
          sendSessionTokenToClientLocked(sessionState.mClient,sessionState.mInfo.getId(),null,null,sessionState.mSeq);
        }
      }
      for (      TvInputState inputState : userState.inputMap.values()) {
        if (inputState.mInfo.getComponent().equals(name)) {
          String inputId=inputState.mInfo.getId();
          notifyInputStateChangedLocked(userState,inputId,INPUT_STATE_DISCONNECTED,null);
          userState.wrappedInputMap.remove(inputId);
        }
      }
      updateServiceConnectionLocked(mName,mUserId);
    }
  }
}
