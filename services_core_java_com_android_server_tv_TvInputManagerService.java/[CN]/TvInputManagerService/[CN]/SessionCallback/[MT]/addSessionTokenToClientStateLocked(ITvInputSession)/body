{
  try {
    session.asBinder().linkToDeath(mSessionState,0);
  }
 catch (  RemoteException e) {
    Slog.e(TAG,"session process has already died",e);
    return false;
  }
  IBinder clientToken=mSessionState.client.asBinder();
  UserState userState=getOrCreateUserStateLocked(mSessionState.userId);
  ClientState clientState=userState.clientStateMap.get(clientToken);
  if (clientState == null) {
    clientState=new ClientState(clientToken,mSessionState.userId);
    try {
      clientToken.linkToDeath(clientState,0);
    }
 catch (    RemoteException e) {
      Slog.e(TAG,"client process has already died",e);
      return false;
    }
    userState.clientStateMap.put(clientToken,clientState);
  }
  clientState.sessionTokens.add(mSessionState.sessionToken);
  return true;
}
