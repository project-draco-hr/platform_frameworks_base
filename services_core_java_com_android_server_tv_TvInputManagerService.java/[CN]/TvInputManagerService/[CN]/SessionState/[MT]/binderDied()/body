{
synchronized (mLock) {
    mSession=null;
    if (mClient != null) {
      try {
        mClient.onSessionReleased(mSeq);
      }
 catch (      RemoteException e) {
        Slog.e(TAG,"error in onSessionReleased",e);
      }
    }
    UserState userState=getUserStateLocked(mUserId);
    for (    SessionState sessionState : userState.sessionStateMap.values()) {
      if (mSession != null && mSession == sessionState.mHardwareSessionToken) {
        try {
          sessionState.mSession.release();
        }
 catch (        RemoteException e) {
          Slog.e(TAG,"error in release",e);
        }
        try {
          sessionState.mClient.onSessionReleased(sessionState.mSeq);
        }
 catch (        RemoteException e) {
          Slog.e(TAG,"error in onSessionReleased",e);
        }
      }
    }
    removeSessionStateLocked(mSessionToken,mUserId);
  }
}
