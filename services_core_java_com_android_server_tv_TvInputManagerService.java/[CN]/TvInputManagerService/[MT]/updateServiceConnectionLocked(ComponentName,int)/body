{
  UserState userState=getUserStateLocked(userId);
  ServiceState serviceState=userState.serviceStateMap.get(component);
  if (serviceState == null) {
    return;
  }
  if (serviceState.mReconnecting) {
    if (!serviceState.mSessionTokens.isEmpty()) {
      return;
    }
    serviceState.mReconnecting=false;
  }
  boolean maintainConnection=shouldMaintainConnection(serviceState);
  if (serviceState.mService == null && maintainConnection && userId == mCurrentUserId) {
    if (serviceState.mBound) {
      return;
    }
    if (DEBUG) {
      Slog.d(TAG,"bindServiceAsUser(service=" + component + ", userId="+ userId+ ")");
    }
    Intent i=new Intent(TvInputService.SERVICE_INTERFACE).setComponent(component);
    serviceState.mBound=mContext.bindServiceAsUser(i,serviceState.mConnection,Context.BIND_AUTO_CREATE,new UserHandle(userId));
  }
 else   if (serviceState.mService != null && !maintainConnection) {
    if (DEBUG) {
      Slog.d(TAG,"unbindService(service=" + component + ")");
    }
    mContext.unbindService(serviceState.mConnection);
    userState.serviceStateMap.remove(component);
  }
}
