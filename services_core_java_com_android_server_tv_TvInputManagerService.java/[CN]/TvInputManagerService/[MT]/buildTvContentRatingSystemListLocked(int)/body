{
  UserState userState=getOrCreateUserStateLocked(userId);
  userState.contentRatingSystemList.clear();
  final PackageManager pm=mContext.getPackageManager();
  Intent intent=new Intent(TvInputManager.ACTION_QUERY_CONTENT_RATING_SYSTEMS);
  for (  ResolveInfo resolveInfo : pm.queryBroadcastReceivers(intent,PackageManager.GET_META_DATA)) {
    ActivityInfo receiver=resolveInfo.activityInfo;
    Bundle metaData=receiver.metaData;
    if (metaData == null) {
      continue;
    }
    int xmlResId=metaData.getInt(TvInputManager.META_DATA_CONTENT_RATING_SYSTEMS);
    if (xmlResId == 0) {
      Slog.w(TAG,"Missing meta-data '" + TvInputManager.META_DATA_CONTENT_RATING_SYSTEMS + "' on receiver "+ receiver.packageName+ "/"+ receiver.name);
      continue;
    }
    userState.contentRatingSystemList.add(TvContentRatingSystemInfo.createTvContentRatingSystemInfo(xmlResId,receiver.applicationInfo));
  }
}
