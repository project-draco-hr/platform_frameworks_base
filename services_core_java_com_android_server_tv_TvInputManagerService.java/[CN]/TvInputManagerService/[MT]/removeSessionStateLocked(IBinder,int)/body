{
  UserState userState=getUserStateLocked(userId);
  SessionState sessionState=userState.sessionStateMap.remove(sessionToken);
  ServiceState serviceState=userState.serviceStateMap.get(sessionState.name);
  if (serviceState != null) {
    serviceState.sessionTokens.remove(sessionToken);
  }
  updateServiceConnectionLocked(sessionState.name,userId);
}
