{
  UserState userState=getOrCreateUserStateLocked(userId);
  List<SessionState> sessionsToAbort=new ArrayList<>();
  for (  IBinder sessionToken : serviceState.sessionTokens) {
    SessionState sessionState=userState.sessionStateMap.get(sessionToken);
    if (sessionState.session == null && (inputId == null || sessionState.inputId.equals(inputId))) {
      sessionsToAbort.add(sessionState);
    }
  }
  for (  SessionState sessionState : sessionsToAbort) {
    removeSessionStateLocked(sessionState.sessionToken,sessionState.userId);
    sendSessionTokenToClientLocked(sessionState.client,sessionState.inputId,null,null,sessionState.seq);
  }
  updateServiceConnectionLocked(serviceState.component,userId);
}
