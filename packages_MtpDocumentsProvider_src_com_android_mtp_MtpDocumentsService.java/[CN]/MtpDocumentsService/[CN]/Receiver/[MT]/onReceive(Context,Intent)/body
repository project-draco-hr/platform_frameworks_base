{
  if (UsbManager.ACTION_USB_DEVICE_DETACHED.equals(intent.getAction())) {
    final UsbDevice device=(UsbDevice)intent.getParcelableExtra(UsbManager.EXTRA_DEVICE);
    final MtpDocumentsProvider provider=MtpDocumentsProvider.getInstance();
    try {
      provider.closeDevice(device.getDeviceId());
    }
 catch (    IOException|InterruptedException error) {
      Log.e(MtpDocumentsProvider.TAG,error.getMessage());
    }
    stopSelfIfNeeded();
  }
}
