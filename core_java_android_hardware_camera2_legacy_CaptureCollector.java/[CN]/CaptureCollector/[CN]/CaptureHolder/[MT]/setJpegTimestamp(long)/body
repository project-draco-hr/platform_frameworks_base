{
  if (DEBUG) {
    Log.d(TAG,"setJpegTimestamp - called for request " + mRequest.getRequestId());
  }
  if (!needsJpeg) {
    throw new IllegalStateException("setJpegTimestamp called for capture with no jpeg targets.");
  }
  if (isCompleted()) {
    throw new IllegalStateException("setJpegTimestamp called on already completed request.");
  }
  mReceivedFlags|=FLAG_RECEIVED_JPEG_TS;
  if (mTimestamp == 0) {
    mTimestamp=timestamp;
  }
  if (!mHasStarted) {
    mHasStarted=true;
    CaptureCollector.this.mDeviceState.setCaptureStart(mRequest,mTimestamp,CameraDeviceState.NO_CAPTURE_ERROR);
  }
  tryComplete();
}
