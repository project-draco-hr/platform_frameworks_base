{
  mTheme=Resources.selectSystemTheme(mTheme,getApplicationInfo().targetSdkVersion,android.R.style.Theme_InputMethod,android.R.style.Theme_Holo_InputMethod,android.R.style.Theme_DeviceDefault_InputMethod,android.R.style.Theme_DeviceDefault_InputMethod);
  super.setTheme(mTheme);
  super.onCreate();
  mImm=(InputMethodManager)getSystemService(INPUT_METHOD_SERVICE);
  mSettingsObserver=SettingsObserver.createAndRegister(this);
  mShouldClearInsetOfPreviousIme=(mImm.getInputMethodWindowVisibleHeight() > 0);
  mInflater=(LayoutInflater)getSystemService(Context.LAYOUT_INFLATER_SERVICE);
  mWindow=new SoftInputWindow(this,"InputMethod",mTheme,null,null,mDispatcherState,WindowManager.LayoutParams.TYPE_INPUT_METHOD,Gravity.BOTTOM,false);
  if (mHardwareAccelerated) {
    mWindow.getWindow().addFlags(WindowManager.LayoutParams.FLAG_HARDWARE_ACCELERATED);
  }
  initViews();
  mWindow.getWindow().setLayout(MATCH_PARENT,WRAP_CONTENT);
}
