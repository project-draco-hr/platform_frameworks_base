{
  if (DEBUG)   Log.v(TAG,"Showing window: showInput=" + showInput + " mShowInputRequested="+ mShowInputRequested+ " mWindowAdded="+ mWindowAdded+ " mWindowCreated="+ mWindowCreated+ " mWindowVisible="+ mWindowVisible+ " mInputStarted="+ mInputStarted);
  boolean doShowInput=false;
  boolean wasVisible=mWindowVisible;
  mWindowVisible=true;
  if (!mShowInputRequested) {
    doShowInput=true;
    mShowInputRequested=true;
  }
 else {
    showInput=true;
  }
  if (doShowInput) {
    if (DEBUG)     Log.v(TAG,"showWindow: updating UI");
    updateFullscreenMode();
    updateInputViewShown();
  }
  if (!mWindowAdded || !mWindowCreated) {
    mWindowAdded=true;
    mWindowCreated=true;
    View v=onCreateCandidatesView();
    if (DEBUG)     Log.v(TAG,"showWindow: candidates=" + v);
    if (v != null) {
      setCandidatesView(v);
    }
  }
  if (doShowInput) {
    if (mInputStarted) {
      if (DEBUG)       Log.v(TAG,"showWindow: starting input view");
      onStartInputView(mInputInfo,false);
    }
    startExtractingText();
  }
  if (!wasVisible) {
    if (DEBUG)     Log.v(TAG,"showWindow: showing!");
    mWindow.show();
    if (mInputConnection != null) {
      mInputConnection.showStatusIcon(getPackageName(),mStatusIcon);
    }
  }
}
