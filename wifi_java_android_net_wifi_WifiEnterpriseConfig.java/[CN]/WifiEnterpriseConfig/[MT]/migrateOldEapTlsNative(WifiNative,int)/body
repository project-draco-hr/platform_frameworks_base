{
  String oldPrivateKey=wifiNative.getNetworkVariable(netId,OLD_PRIVATE_KEY_NAME);
  if (TextUtils.isEmpty(oldPrivateKey)) {
    return false;
  }
 else {
    oldPrivateKey=removeDoubleQuotes(oldPrivateKey);
    if (TextUtils.isEmpty(oldPrivateKey)) {
      return false;
    }
  }
  mFields.put(ENGINE_KEY,ENGINE_ENABLE);
  mFields.put(ENGINE_ID_KEY,convertToQuotedString(ENGINE_ID_KEYSTORE));
  final String keyName;
  if (oldPrivateKey.startsWith(KEYSTORE_URI)) {
    keyName=new String(oldPrivateKey.substring(KEYSTORE_URI.length()));
  }
 else {
    keyName=oldPrivateKey;
  }
  mFields.put(PRIVATE_KEY_ID_KEY,convertToQuotedString(keyName));
  wifiNative.setNetworkVariable(netId,ENGINE_KEY,mFields.get(ENGINE_KEY));
  wifiNative.setNetworkVariable(netId,ENGINE_ID_KEY,mFields.get(ENGINE_ID_KEY));
  wifiNative.setNetworkVariable(netId,PRIVATE_KEY_ID_KEY,mFields.get(PRIVATE_KEY_ID_KEY));
  wifiNative.setNetworkVariable(netId,OLD_PRIVATE_KEY_NAME,EMPTY_VALUE);
  return true;
}
