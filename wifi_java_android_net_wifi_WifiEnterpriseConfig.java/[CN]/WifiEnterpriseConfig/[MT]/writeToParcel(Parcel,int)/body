{
  dest.writeInt(mFields.size());
  for (  Map.Entry<String,String> entry : mFields.entrySet()) {
    dest.writeString(entry.getKey());
    dest.writeString(entry.getValue());
  }
  dest.writeInt(mEapMethod);
  dest.writeInt(mPhase2Method);
  writeCertificates(dest,mCaCerts);
  if (mClientPrivateKey != null) {
    String algorithm=mClientPrivateKey.getAlgorithm();
    byte[] userKeyBytes=mClientPrivateKey.getEncoded();
    dest.writeInt(userKeyBytes.length);
    dest.writeByteArray(userKeyBytes);
    dest.writeString(algorithm);
  }
 else {
    dest.writeInt(0);
  }
  writeCertificate(dest,mClientCertificate);
}
