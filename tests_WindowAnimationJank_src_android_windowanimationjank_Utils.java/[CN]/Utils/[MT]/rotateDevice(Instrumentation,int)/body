{
  try {
    UiDevice device=UiDevice.getInstance(instrumentation);
    long startTime=System.currentTimeMillis();
switch (rotationMode) {
case ROTATION_MODE_NATURAL:
      device.setOrientationNatural();
    break;
case ROTATION_MODE_LEFT:
  device.setOrientationLeft();
break;
case ROTATION_MODE_RIGHT:
device.setOrientationRight();
break;
default :
throw new RuntimeException("Unsupported rotation mode: " + rotationMode);
}
long toSleep=ROTATION_ANIMATION_TIME_FULL_SCREEN_MS - (System.currentTimeMillis() - startTime);
if (toSleep > 0) {
SystemClock.sleep(toSleep);
}
}
 catch (Exception e) {
throw new RuntimeException(e);
}
}
