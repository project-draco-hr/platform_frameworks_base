{
  if (display == null) {
    throw new IllegalArgumentException("display must not be null");
  }
  int displayId=display.getDisplayId();
  CompatibilityInfo ci=CompatibilityInfo.DEFAULT_COMPATIBILITY_INFO;
  CompatibilityInfoHolder cih=getCompatibilityInfo(displayId);
  if (cih != null) {
    ci=cih.get();
  }
  ContextImpl context=new ContextImpl();
  context.init(mPackageInfo,null,mMainThread);
  context.mDisplay=display;
  context.mResources=mMainThread.getTopLevelResources(mPackageInfo.getResDir(),displayId,null,ci);
  return context;
}
