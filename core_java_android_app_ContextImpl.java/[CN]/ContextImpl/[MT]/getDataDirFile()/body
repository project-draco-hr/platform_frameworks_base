{
  if (mPackageInfo != null) {
    if (isCredentialEncrypted()) {
      return mPackageInfo.getCredentialEncryptedDataDirFile();
    }
 else     if (isDeviceEncrypted()) {
      return mPackageInfo.getDeviceEncryptedDataDirFile();
    }
 else {
      throw new RuntimeException("Storage location is neither credential nor device encrypted");
    }
  }
  throw new RuntimeException("Not supported in system context");
}
