{
  mPackageInfo=packageInfo;
  mBasePackageName=basePackageName != null ? basePackageName : packageInfo.mPackageName;
  mResources=mPackageInfo.getResources(mainThread);
  CompatibilityInfo compatInfo=container == null ? null : container.getCompatibilityInfo();
  if (mResources != null && ((compatInfo != null && compatInfo.applicationScale != mResources.getCompatibilityInfo().applicationScale) || activityToken != null)) {
    if (DEBUG) {
      Log.d(TAG,"loaded context has different scaling. Using container's" + " compatiblity info:" + container.getDisplayMetrics());
    }
    if (compatInfo == null) {
      compatInfo=CompatibilityInfo.DEFAULT_COMPATIBILITY_INFO;
    }
    mDisplayAdjustments.setCompatibilityInfo(compatInfo);
    mDisplayAdjustments.setActivityToken(activityToken);
    mResources=mainThread.getTopLevelResources(mPackageInfo.getResDir(),Display.DEFAULT_DISPLAY,null,compatInfo,activityToken);
  }
 else {
    mDisplayAdjustments.setCompatibilityInfo(packageInfo.getCompatibilityInfo());
    mDisplayAdjustments.setActivityToken(activityToken);
  }
  mMainThread=mainThread;
  mActivityToken=activityToken;
  mContentResolver=new ApplicationContentResolver(this,mainThread,user);
  mUser=user;
}
