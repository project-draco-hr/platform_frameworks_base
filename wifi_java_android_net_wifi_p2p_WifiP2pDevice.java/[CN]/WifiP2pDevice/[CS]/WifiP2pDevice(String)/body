{
  String[] tokens=string.split("[ \n]");
  Matcher match;
  if (tokens.length < 1) {
    throw new IllegalArgumentException("Malformed supplicant event");
  }
switch (tokens.length) {
case 1:
    deviceAddress=string;
  return;
case 2:
match=twoTokenPattern.matcher(string);
if (!match.find()) {
throw new IllegalArgumentException("Malformed supplicant event");
}
deviceAddress=match.group(2);
return;
case 3:
match=threeTokenPattern.matcher(string);
if (!match.find()) {
throw new IllegalArgumentException("Malformed supplicant event");
}
deviceAddress=match.group(1);
return;
default :
match=detailedDevicePattern.matcher(string);
if (!match.find()) {
throw new IllegalArgumentException("Malformed supplicant event");
}
deviceAddress=match.group(3);
primaryDeviceType=match.group(4);
deviceName=match.group(5);
wpsConfigMethodsSupported=parseHex(match.group(6));
deviceCapability=parseHex(match.group(7));
groupCapability=parseHex(match.group(8));
if (match.group(9) != null) {
String str=match.group(10);
wfdInfo=new WifiP2pWfdInfo(parseHex(str.substring(0,4)),parseHex(str.substring(4,8)),parseHex(str.substring(8,12)));
}
break;
}
if (tokens[0].startsWith("P2P-DEVICE-FOUND")) {
status=AVAILABLE;
}
}
