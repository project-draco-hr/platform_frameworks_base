{
  FileReader bookmarksReader;
  final File favFile=new File(Environment.getRootDirectory(),subPath);
  try {
    bookmarksReader=new FileReader(favFile);
  }
 catch (  FileNotFoundException e) {
    if (!quiet) {
      Log.e(TAG,"Couldn't find or open bookmarks file " + favFile);
    }
    return 0;
  }
  Intent intent=new Intent(Intent.ACTION_MAIN,null);
  intent.addCategory(Intent.CATEGORY_LAUNCHER);
  ContentValues values=new ContentValues();
  PackageManager packageManager=mContext.getPackageManager();
  ActivityInfo info;
  int i=startingIndex;
  try {
    XmlPullParser parser=Xml.newPullParser();
    parser.setInput(bookmarksReader);
    XmlUtils.beginDocument(parser,"bookmarks");
    while (true) {
      XmlUtils.nextElement(parser);
      String name=parser.getName();
      if (!"bookmark".equals(name)) {
        break;
      }
      String pkg=parser.getAttributeValue(null,"package");
      String cls=parser.getAttributeValue(null,"class");
      String shortcutStr=parser.getAttributeValue(null,"shortcut");
      int shortcutValue=(int)shortcutStr.charAt(0);
      if (TextUtils.isEmpty(shortcutStr)) {
        Log.w(TAG,"Unable to get shortcut for: " + pkg + "/"+ cls);
      }
      try {
        ComponentName cn=new ComponentName(pkg,cls);
        info=packageManager.getActivityInfo(cn,0);
        intent.setComponent(cn);
        intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        values.put(Settings.Bookmarks.INTENT,intent.toURI());
        values.put(Settings.Bookmarks.TITLE,info.loadLabel(packageManager).toString());
        values.put(Settings.Bookmarks.SHORTCUT,shortcutValue);
        db.insert("bookmarks",null,values);
        i++;
      }
 catch (      PackageManager.NameNotFoundException e) {
        Log.w(TAG,"Unable to add bookmark: " + pkg + "/"+ cls,e);
      }
    }
  }
 catch (  XmlPullParserException e) {
    Log.w(TAG,"Got execption parsing bookmarks.",e);
  }
catch (  IOException e) {
    Log.w(TAG,"Got execption parsing bookmarks.",e);
  }
  return i;
}
