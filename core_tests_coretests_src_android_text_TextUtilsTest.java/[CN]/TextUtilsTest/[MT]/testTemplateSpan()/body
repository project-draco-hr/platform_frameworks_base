{
  SpannableString template;
  Spanned result;
  String[] spans;
  template=new SpannableString("a^1b");
  template.setSpan("before",0,1,Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);
  template.setSpan("during",1,3,Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);
  template.setSpan("after",3,4,Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);
  template.setSpan("during+after",1,4,Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);
  result=(Spanned)TextUtils.expandTemplate(template,"foo");
  assertEquals(5,result.length());
  spans=result.getSpans(0,result.length(),String.class);
  assertEquals(4,spans.length);
  checkContains(result,spans,"before",0,1);
  checkContains(result,spans,"during",1,4);
  checkContains(result,spans,"after",4,5);
  checkContains(result,spans,"during+after",1,5);
  result=(Spanned)TextUtils.expandTemplate(template,"");
  assertEquals(2,result.length());
  spans=result.getSpans(0,result.length(),String.class);
  assertEquals(3,spans.length);
  checkContains(result,spans,"before",0,1);
  checkContains(result,spans,"after",1,2);
  checkContains(result,spans,"during+after",1,2);
}
