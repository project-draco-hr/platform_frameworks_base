{
  MockPerformanceResultsWriter writer=new MockPerformanceResultsWriter();
  mPerfCollector.setPerformanceResultsWriter(writer);
  mPerfCollector.beginSnapshot("testSimpleSequence");
  mPerfCollector.startTiming("testSimpleSequenceTiming");
  sleepForRandomTinyPeriod();
  mPerfCollector.addIteration("iteration1");
  sleepForRandomTinyPeriod();
  mPerfCollector.addIteration("iteration2");
  sleepForRandomTinyPeriod();
  mPerfCollector.addIteration("iteration3");
  sleepForRandomTinyPeriod();
  mPerfCollector.addIteration("iteration4");
  sleepForRandomShortPeriod();
  Bundle timing=mPerfCollector.stopTiming("iteration5");
  sleepForRandomLongPeriod();
  Bundle snapshot1=mPerfCollector.endSnapshot();
  Bundle snapshot2=writer.snapshotResults;
  assertTrue(snapshot1.equals(snapshot2));
  verifySnapshotBundle(snapshot1);
  ArrayList<String> labels=new ArrayList<String>();
  labels.add("iteration1");
  labels.add("iteration2");
  labels.add("iteration3");
  labels.add("iteration4");
  labels.add("iteration5");
  verifyTimingBundle(timing,labels);
}
