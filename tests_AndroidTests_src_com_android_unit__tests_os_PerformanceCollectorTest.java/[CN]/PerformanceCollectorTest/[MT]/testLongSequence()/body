{
  MockPerformanceResultsWriter writer=new MockPerformanceResultsWriter();
  mPerfCollector.setPerformanceResultsWriter(writer);
  mPerfCollector.beginSnapshot("testLongSequence");
  mPerfCollector.startTiming("testLongSequenceTiming1");
  sleepForRandomTinyPeriod();
  mPerfCollector.addIteration("iteration1");
  sleepForRandomTinyPeriod();
  mPerfCollector.addIteration("iteration2");
  sleepForRandomShortPeriod();
  Bundle timing1=mPerfCollector.stopTiming("iteration3");
  sleepForRandomLongPeriod();
  mPerfCollector.startTiming("testLongSequenceTiming2");
  sleepForRandomTinyPeriod();
  mPerfCollector.addIteration("iteration4");
  sleepForRandomTinyPeriod();
  mPerfCollector.addIteration("iteration5");
  sleepForRandomShortPeriod();
  Bundle timing2=mPerfCollector.stopTiming("iteration6");
  sleepForRandomLongPeriod();
  mPerfCollector.startTiming("testLongSequenceTiming3");
  sleepForRandomTinyPeriod();
  mPerfCollector.addIteration("iteration7");
  sleepForRandomTinyPeriod();
  mPerfCollector.addIteration("iteration8");
  sleepForRandomShortPeriod();
  Bundle timing3=mPerfCollector.stopTiming("iteration9");
  sleepForRandomLongPeriod();
  mPerfCollector.startTiming("testLongSequenceTiming4");
  sleepForRandomTinyPeriod();
  mPerfCollector.addIteration("iteration10");
  sleepForRandomTinyPeriod();
  mPerfCollector.addIteration("iteration11");
  sleepForRandomShortPeriod();
  Bundle timing4=mPerfCollector.stopTiming("iteration12");
  sleepForRandomLongPeriod();
  mPerfCollector.startTiming("testLongSequenceTiming5");
  sleepForRandomTinyPeriod();
  mPerfCollector.addIteration("iteration13");
  sleepForRandomTinyPeriod();
  mPerfCollector.addIteration("iteration14");
  sleepForRandomShortPeriod();
  Bundle timing5=mPerfCollector.stopTiming("iteration15");
  sleepForRandomLongPeriod();
  Bundle snapshot1=mPerfCollector.endSnapshot();
  Bundle snapshot2=writer.snapshotResults;
  assertTrue(snapshot1.equals(snapshot2));
  verifySnapshotBundle(snapshot1);
  ArrayList<String> labels1=new ArrayList<String>();
  labels1.add("iteration1");
  labels1.add("iteration2");
  labels1.add("iteration3");
  verifyTimingBundle(timing1,labels1);
  ArrayList<String> labels2=new ArrayList<String>();
  labels2.add("iteration4");
  labels2.add("iteration5");
  labels2.add("iteration6");
  verifyTimingBundle(timing2,labels2);
  ArrayList<String> labels3=new ArrayList<String>();
  labels3.add("iteration7");
  labels3.add("iteration8");
  labels3.add("iteration9");
  verifyTimingBundle(timing3,labels3);
  ArrayList<String> labels4=new ArrayList<String>();
  labels4.add("iteration10");
  labels4.add("iteration11");
  labels4.add("iteration12");
  verifyTimingBundle(timing4,labels4);
  ArrayList<String> labels5=new ArrayList<String>();
  labels5.add("iteration13");
  labels5.add("iteration14");
  labels5.add("iteration15");
  verifyTimingBundle(timing5,labels5);
}
