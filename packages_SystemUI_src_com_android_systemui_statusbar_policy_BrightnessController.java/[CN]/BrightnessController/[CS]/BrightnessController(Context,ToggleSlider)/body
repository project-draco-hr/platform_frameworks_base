{
  mContext=context;
  mControl=control;
  PowerManager pm=(PowerManager)context.getSystemService(Context.POWER_SERVICE);
  mMinimumBacklight=pm.getMinimumScreenBrightnessSetting();
  mMaximumBacklight=pm.getMaximumScreenBrightnessSetting();
  boolean automaticAvailable=context.getResources().getBoolean(com.android.internal.R.bool.config_automatic_brightness_available);
  mPower=IPowerManager.Stub.asInterface(ServiceManager.getService("power"));
  if (automaticAvailable) {
    int automatic;
    try {
      automatic=Settings.System.getInt(mContext.getContentResolver(),Settings.System.SCREEN_BRIGHTNESS_MODE);
    }
 catch (    SettingNotFoundException snfe) {
      automatic=0;
    }
    control.setChecked(automatic != 0);
  }
 else {
    control.setChecked(false);
  }
  int value;
  try {
    value=Settings.System.getInt(mContext.getContentResolver(),Settings.System.SCREEN_BRIGHTNESS);
  }
 catch (  SettingNotFoundException ex) {
    value=mMaximumBacklight;
  }
  control.setMax(mMaximumBacklight - mMinimumBacklight);
  control.setValue(value - mMinimumBacklight);
  control.setOnChangedListener(this);
}
