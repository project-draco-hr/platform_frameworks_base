{
  resetProperties();
  sendBugreportStarted(1000);
  waitForScreenshotButtonEnabled(true);
  final NumberFormat nf=NumberFormat.getPercentInstance();
  nf.setMinimumFractionDigits(2);
  nf.setMaximumFractionDigits(2);
  assertProgressNotification(NAME,nf.format(0));
  SystemProperties.set(PROGRESS_PROPERTY,"108");
  assertProgressNotification(NAME,nf.format(0.108));
  SystemProperties.set(PROGRESS_PROPERTY,"500");
  assertProgressNotification(NAME,nf.format(0.50));
  SystemProperties.set(PROGRESS_PROPERTY,"950");
  assertProgressNotification(NAME,nf.format(0.95));
  SystemProperties.set(MAX_PROPERTY,"2000");
  Thread.sleep(POLLING_FREQUENCY + DateUtils.SECOND_IN_MILLIS);
  assertProgressNotification(NAME,nf.format(0.95));
  SystemProperties.set(PROGRESS_PROPERTY,"1000");
  assertProgressNotification(NAME,nf.format(0.95));
  SystemProperties.set(PROGRESS_PROPERTY,"1902");
  assertProgressNotification(NAME,nf.format(0.9510));
  SystemProperties.set(PROGRESS_PROPERTY,"1960");
  assertProgressNotification(NAME,nf.format(0.98));
  SystemProperties.set(PROGRESS_PROPERTY,"2000");
  assertProgressNotification(NAME,nf.format(0.99));
  SystemProperties.set(PROGRESS_PROPERTY,"3000");
  assertProgressNotification(NAME,nf.format(0.99));
  Bundle extras=sendBugreportFinishedAndGetSharedIntent(ID,mPlainTextPath,mScreenshotPath);
  assertActionSendMultiple(extras,BUGREPORT_CONTENT,SCREENSHOT_CONTENT,ID,PID,ZIP_FILE,NAME,NO_TITLE,NO_DESCRIPTION,1,RENAMED_SCREENSHOTS);
  assertServiceNotRunning();
}
