{
  resetProperties();
  sendBugreportStarted(1000);
  waitForScreenshotButtonEnabled(true);
  takeScreenshot();
  assertScreenshotButtonEnabled(false);
  waitForScreenshotButtonEnabled(true);
  sendBugreportFinished(PID,mPlainTextPath,mScreenshotPath);
  if (serviceDies) {
    waitShareNotification(PID);
    killService();
  }
  Bundle extras=acceptBugreportAndGetSharedIntent(PID);
  assertActionSendMultiple(extras,BUGREPORT_CONTENT,SCREENSHOT_CONTENT,PID,ZIP_FILE,NAME,NO_TITLE,NO_DESCRIPTION,2,RENAMED_SCREENSHOTS);
  assertServiceNotRunning();
}
