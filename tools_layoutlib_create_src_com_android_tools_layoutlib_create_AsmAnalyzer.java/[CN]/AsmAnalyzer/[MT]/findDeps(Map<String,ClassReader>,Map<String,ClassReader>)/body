{
  TreeMap<String,ClassReader> deps=new TreeMap<String,ClassReader>();
  TreeMap<String,ClassReader> new_deps=new TreeMap<String,ClassReader>();
  TreeMap<String,ClassReader> new_keep=new TreeMap<String,ClassReader>();
  TreeMap<String,ClassReader> temp=new TreeMap<String,ClassReader>();
  DependencyVisitor visitor=getVisitor(zipClasses,inOutKeepClasses,new_keep,deps,new_deps);
  for (  ClassReader cr : inOutKeepClasses.values()) {
    visitor.setClassName(cr.getClassName());
    cr.accept(visitor,0);
  }
  while (new_deps.size() > 0 || new_keep.size() > 0) {
    deps.putAll(new_deps);
    inOutKeepClasses.putAll(new_keep);
    temp.clear();
    temp.putAll(new_deps);
    temp.putAll(new_keep);
    new_deps.clear();
    new_keep.clear();
    mLog.debug("Found %1$d to keep, %2$d dependencies.",inOutKeepClasses.size(),deps.size());
    for (    ClassReader cr : temp.values()) {
      visitor.setClassName(cr.getClassName());
      cr.accept(visitor,0);
    }
  }
  mLog.info("Found %1$d classes to keep, %2$d class dependencies.",inOutKeepClasses.size(),deps.size());
  return deps;
}
