{
  if (mIsRaw) {
    throw new UnsupportedOperationException("ExifInterface does not support saving attributes on RAW formats.");
  }
  StringBuilder sb=new StringBuilder();
  int size=mAttributes.size();
  if (mAttributes.containsKey(TAG_HAS_THUMBNAIL)) {
    --size;
  }
  sb.append(size).append(" ");
  for (  Map.Entry<String,String> entry : mAttributes.entrySet()) {
    String key=entry.getKey();
    if (key.equals(TAG_HAS_THUMBNAIL)) {
      continue;
    }
    String val=entry.getValue();
    sb.append(key).append("=");
    sb.append(val.length()).append(" ");
    sb.append(val);
  }
  String s=sb.toString();
synchronized (sLock) {
    saveAttributesNative(mFilename,s);
    commitChangesNative(mFilename);
  }
}
