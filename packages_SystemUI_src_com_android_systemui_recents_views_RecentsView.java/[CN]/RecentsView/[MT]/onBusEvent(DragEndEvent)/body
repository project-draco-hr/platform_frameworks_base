{
  if (event.dropTarget instanceof TaskStack.DockState) {
    final TaskStack.DockState dockState=(TaskStack.DockState)event.dropTarget;
    updateVisibleDockRegions(null,false,-1,false,false);
    TaskStackLayoutAlgorithm stackLayout=mTaskStackView.getStackAlgorithm();
    TaskStackViewScroller stackScroller=mTaskStackView.getScroller();
    TaskViewTransform tmpTransform=new TaskViewTransform();
    int x=(int)event.taskView.getTranslationX();
    int y=(int)event.taskView.getTranslationY();
    Rect taskViewRect=new Rect(event.taskView.getLeft(),event.taskView.getTop(),event.taskView.getRight(),event.taskView.getBottom());
    taskViewRect.offset(x,y);
    event.taskView.setTranslationX(0);
    event.taskView.setTranslationY(0);
    event.taskView.setLeftTopRightBottom(taskViewRect.left,taskViewRect.top,taskViewRect.right,taskViewRect.bottom);
    mTaskStackView.updateLayoutAlgorithm(false);
    stackLayout.getStackTransform(event.task,stackScroller.getStackScroll(),tmpTransform,null);
    tmpTransform.alpha=0;
    tmpTransform.scale=1f;
    tmpTransform.rect.set(taskViewRect);
    mTaskStackView.updateTaskViewToTransform(event.taskView,tmpTransform,new AnimationProps(125,Interpolators.ALPHA_OUT,new AnimatorListenerAdapter(){
      @Override public void onAnimationEnd(      Animator animation){
        SystemServicesProxy ssp=Recents.getSystemServices();
        ssp.startTaskInDockedMode(getContext(),event.taskView,event.task.key.id,dockState.createMode);
        AnimationProps stackAnim=new AnimationProps(TaskStackView.DEFAULT_SYNC_STACK_DURATION,Interpolators.FAST_OUT_SLOW_IN);
        mTaskStackView.getStack().removeTask(event.task,stackAnim,true);
      }
    }
));
    MetricsLogger.action(mContext,MetricsEvent.ACTION_WINDOW_DOCK_DRAG_DROP);
  }
 else {
    updateVisibleDockRegions(null,true,-1,true,false);
  }
}
