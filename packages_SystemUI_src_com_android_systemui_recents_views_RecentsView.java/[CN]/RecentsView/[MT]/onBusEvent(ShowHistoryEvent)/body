{
  if (mHistoryView == null) {
    LayoutInflater inflater=LayoutInflater.from(getContext());
    mHistoryView=(RecentsHistoryView)inflater.inflate(R.layout.recents_history,this,false);
    addView(mHistoryView);
    final float cornerRadius=getResources().getDimensionPixelSize(R.dimen.recents_task_view_rounded_corners_radius);
    mHistoryClearAllButton=(TextView)inflater.inflate(R.layout.recents_history_clear_all_button,this,false);
    mHistoryClearAllButton.setOnClickListener(new View.OnClickListener(){
      @Override public void onClick(      View v){
        EventBus.getDefault().send(new ClearHistoryEvent());
      }
    }
);
    mHistoryClearAllButton.setClipToOutline(true);
    mHistoryClearAllButton.setOutlineProvider(new ViewOutlineProvider(){
      @Override public void getOutline(      View view,      Outline outline){
        outline.setRoundRect(0,0,view.getWidth(),view.getHeight(),cornerRadius);
      }
    }
);
    addView(mHistoryClearAllButton);
    mHistoryView.setSystemInsets(mSystemInsets);
    mHistoryView.setHeaderHeight(mHistoryButton.getMeasuredHeight());
    mHistoryButton.bringToFront();
    mHistoryClearAllButton.bringToFront();
  }
  Rect stackRect=mTaskStackView.mLayoutAlgorithm.mStackRect;
  if (mEmptyView.getVisibility() == View.VISIBLE) {
    int historyTransitionDuration=getResources().getInteger(R.integer.recents_history_transition_duration);
    mEmptyView.animate().alpha(0f).translationY(stackRect.height() / 2).setDuration(historyTransitionDuration).setInterpolator(mFastOutSlowInInterpolator).withEndAction(new Runnable(){
      @Override public void run(){
        mEmptyView.setVisibility(View.INVISIBLE);
      }
    }
).start();
  }
  mHistoryView.show(mStack,stackRect.height(),mHistoryClearAllButton);
}
