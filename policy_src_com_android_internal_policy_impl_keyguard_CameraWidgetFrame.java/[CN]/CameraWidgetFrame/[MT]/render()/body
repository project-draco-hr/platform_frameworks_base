{
  final View root=getRootView();
  final int width=root.getWidth();
  final int height=root.getHeight();
  if (mRenderedSize.x == width && mRenderedSize.y == height) {
    if (DEBUG)     Log.d(TAG,String.format("Already rendered at size=%sx%s",width,height));
    return;
  }
  if (width == 0 || height == 0) {
    return;
  }
  mPreview.width=width;
  mPreview.height=height;
  mPreview.requestLayout();
  final int thisWidth=getWidth() - getPaddingLeft() - getPaddingRight();
  final int thisHeight=getHeight() - getPaddingTop() - getPaddingBottom();
  final float pvScaleX=(float)thisWidth / width;
  final float pvScaleY=(float)thisHeight / height;
  final float pvScale=Math.min(pvScaleX,pvScaleY);
  final int pvWidth=(int)(pvScale * width);
  final int pvHeight=(int)(pvScale * height);
  final float pvTransX=pvWidth < thisWidth ? (thisWidth - pvWidth) / 2 : 0;
  final float pvTransY=pvHeight < thisHeight ? (thisHeight - pvHeight) / 2 : 0;
  mPreview.setPivotX(0);
  mPreview.setPivotY(0);
  mPreview.setScaleX(pvScale);
  mPreview.setScaleY(pvScale);
  mPreview.setTranslationX(pvTransX);
  mPreview.setTranslationY(pvTransY);
  mRenderedSize.set(width,height);
  if (DEBUG)   Log.d(TAG,String.format("Rendered camera widget size=%sx%s instance=%s",width,height,instanceId()));
}
