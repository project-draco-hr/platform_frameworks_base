{
  String insSpan="<span class=\"ins\">";
  String eqlSpan="<span class=\"eql\">";
  String line="";
  int i=1;
  for (  diff_match_patch.Diff diff : diffs) {
switch (diff.operation) {
case INSERT:
      line=processDiff(diff,lineNums,lines,line,i,insSpan);
    if (line.equals("")) {
      i++;
    }
  break;
case DELETE:
if (diff.text.endsWith("\n")) {
  lineNums.add(DONT_PRINT_LINE_NUMBER);
  lines.add("");
}
break;
case EQUAL:
line=processDiff(diff,lineNums,lines,line,i,eqlSpan);
if (line.equals("")) {
i++;
}
break;
}
}
if (!line.isEmpty()) {
lines.add(line);
lineNums.add(i);
}
}
