{
  assertTrue("MockAccessibilityService not ready",sIsAccessibilityServiceReady);
  long incrementStep=TIMEOUT_WAIT_FOR_SELECTION_STRING / 5;
  long start=SystemClock.uptimeMillis();
  while (SystemClock.uptimeMillis() - start < TIMEOUT_WAIT_FOR_SELECTION_STRING && sReceivedSelectionString == SELECTION_STRING_UNKNOWN) {
synchronized (sTestLock) {
      try {
        sTestLock.wait(incrementStep);
      }
 catch (      InterruptedException ie) {
      }
    }
  }
  try {
    if (sReceivedSelectionString == SELECTION_STRING_UNKNOWN) {
      fail("No selection string received. Expected: " + expectedSelectionString);
    }
    assertEquals(expectedSelectionString,sReceivedSelectionString);
  }
  finally {
    sReceivedSelectionString=SELECTION_STRING_UNKNOWN;
  }
}
