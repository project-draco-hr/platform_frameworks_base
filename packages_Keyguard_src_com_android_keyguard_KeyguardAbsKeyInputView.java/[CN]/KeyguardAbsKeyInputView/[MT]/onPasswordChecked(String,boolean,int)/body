{
  if (matched) {
    mCallback.reportUnlockAttempt(true,0);
    mCallback.dismiss(true);
  }
 else {
    mCallback.reportUnlockAttempt(false,timeoutMs);
    int attempts=KeyguardUpdateMonitor.getInstance(mContext).getFailedUnlockAttempts();
    if (timeoutMs > 0) {
      long deadline=mLockPatternUtils.setLockoutAttemptDeadline(KeyguardUpdateMonitor.getCurrentUser(),timeoutMs);
      handleAttemptLockout(deadline);
    }
    mSecurityMessageDisplay.setMessage(getWrongPasswordStringId(),true);
  }
  resetPasswordText(true);
}
