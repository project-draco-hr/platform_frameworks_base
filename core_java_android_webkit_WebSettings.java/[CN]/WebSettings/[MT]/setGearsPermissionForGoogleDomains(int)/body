{
  int gearsPermission=(systemPermission == 1 ? 1 : 2);
  File file=new File(mPluginsPath).getParentFile();
  if (file == null) {
    return;
  }
  file=new File(file.getAbsolutePath() + File.separator + GEARS_DATABASE_DIR+ File.separator+ GEARS_DATABASE_FILE);
  boolean needToCreateTables=!file.exists();
  SQLiteDatabase permissions;
  try {
    permissions=SQLiteDatabase.openOrCreateDatabase(file,null);
  }
 catch (  SQLiteException e) {
    if (LOGV_ENABLED) {
      Log.v(LOGTAG,"Could not open Gears permission DB: " + e.getMessage());
    }
    return;
  }
  permissions.beginTransaction();
  try {
    if (needToCreateTables) {
      SQLiteStatement statement=permissions.compileStatement("CREATE TABLE IF NOT EXISTS " + GEARS_STORAGE_ACCESS_TABLE_NAME + " (Name TEXT UNIQUE, Value)");
      statement.execute();
      statement=permissions.compileStatement("CREATE TABLE IF NOT EXISTS " + GEARS_LOCATION_ACCESS_TABLE_NAME + " (Name TEXT UNIQUE, Value)");
      statement.execute();
      statement=permissions.compileStatement("CREATE TABLE IF NOT EXISTS " + GEARS_SCHEMA_VERSION_TABLE_NAME + " (Name TEXT UNIQUE, Value)");
      statement.execute();
      ContentValues schema=new ContentValues();
      schema.put("Name","Version");
      schema.put("Value",2);
      permissions.insert(GEARS_SCHEMA_VERSION_TABLE_NAME,null,schema);
    }
    ContentValues permissionValues=new ContentValues();
    for (    String url : sGearsWhiteList) {
      permissionValues.put("Name",url);
      permissionValues.put("Value",gearsPermission);
      permissions.replace(GEARS_LOCATION_ACCESS_TABLE_NAME,null,permissionValues);
      permissionValues.clear();
    }
    permissions.setTransactionSuccessful();
  }
 catch (  SQLiteException e) {
    if (LOGV_ENABLED) {
      Log.v(LOGTAG,"Could not set the Gears permissions: " + e.getMessage());
    }
  }
 finally {
    permissions.endTransaction();
    permissions.close();
  }
}
