{
  final IccCard.State simState=mUpdateMonitor.getSimState();
  if (stuckOnLockScreenBecauseSimMissing() || (simState == IccCard.State.PUK_REQUIRED)) {
    return Mode.LockScreen;
  }
 else {
    final boolean usingLockPattern=mLockPatternUtils.getKeyguardStoredPasswordQuality() == DevicePolicyManager.PASSWORD_QUALITY_SOMETHING;
    if (isSecure() && usingLockPattern) {
      return Mode.UnlockScreen;
    }
 else {
      return Mode.LockScreen;
    }
  }
}
