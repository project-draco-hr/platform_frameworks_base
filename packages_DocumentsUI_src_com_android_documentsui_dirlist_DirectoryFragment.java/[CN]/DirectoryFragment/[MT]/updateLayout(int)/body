{
  final LayoutManager layout;
switch (mode) {
case MODE_GRID:
    if (mGridLayout == null) {
      mGridLayout=new GridLayoutManager(getContext(),mColumnCount);
      SpanSizeLookup lookup=mAdapter.createSpanSizeLookup();
      if (lookup != null) {
        mGridLayout.setSpanSizeLookup(lookup);
      }
    }
  layout=mGridLayout;
break;
case MODE_LIST:
if (mListLayout == null) {
mListLayout=new LinearLayoutManager(getContext());
}
layout=mListLayout;
break;
case MODE_UNKNOWN:
default :
throw new IllegalArgumentException("Unsupported layout mode: " + mode);
}
int pad=getDirectoryPadding(mode);
mRecView.setPadding(pad,pad,pad,pad);
mRecView.setLayoutManager(layout);
mSelectionManager.handleLayoutChanged();
mIconHelper.setMode(mode);
}
