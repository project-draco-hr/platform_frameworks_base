{
  byte bits[];
  byte digest[];
  int index;
  int length;
  bits=MD5Encode(count,8);
  index=((count[0] >>> 3) & 0x3f);
  length=(index < 56) ? (56 - index) : (120 - index);
  if (length > 0) {
    byte padding[]=new byte[length];
    padding[0]=(byte)0x80;
    for (int i=1; i < length; i++) {
      padding[i]=0;
    }
    MD5Update(padding,0,length);
  }
  MD5Update(bits,0,8);
  digest=MD5Encode(state,16);
  return digest;
}
