{
  Bitmap b=null;
  try {
    if (pfd == null)     pfd=makeInputStream(uri,cr);
    if (pfd == null)     return null;
    if (options == null)     options=new BitmapFactory.Options();
    FileDescriptor fd=pfd.getFileDescriptor();
    options.inSampleSize=1;
    options.inJustDecodeBounds=true;
    BitmapFactory.decodeFileDescriptor(fd,null,options);
    if (options.mCancel || options.outWidth == -1 || options.outHeight == -1) {
      return null;
    }
    options.inSampleSize=computeSampleSize(options,minSideLength,maxNumOfPixels);
    options.inJustDecodeBounds=false;
    options.inDither=false;
    options.inPreferredConfig=Bitmap.Config.ARGB_8888;
    b=BitmapFactory.decodeFileDescriptor(fd,null,options);
  }
 catch (  OutOfMemoryError ex) {
    Log.e(TAG,"Got oom exception ",ex);
    return null;
  }
 finally {
    closeSilently(pfd);
  }
  return b;
}
