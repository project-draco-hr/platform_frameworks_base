{
  if (entry == null) {
    throw new KeyStoreException("entry == null");
  }
  if (engineContainsAlias(alias)) {
    engineDeleteEntry(alias);
  }
  if (entry instanceof KeyStore.TrustedCertificateEntry) {
    KeyStore.TrustedCertificateEntry trE=(KeyStore.TrustedCertificateEntry)entry;
    engineSetCertificateEntry(alias,trE.getTrustedCertificate());
    return;
  }
  if (param != null && !(param instanceof KeyStoreParameter)) {
    throw new KeyStoreException("protParam should be android.security.KeyStoreParameter; was: " + param.getClass().getName());
  }
  if (entry instanceof PrivateKeyEntry) {
    PrivateKeyEntry prE=(PrivateKeyEntry)entry;
    setPrivateKeyEntry(alias,prE.getPrivateKey(),prE.getCertificateChain(),(KeyStoreParameter)param);
  }
 else   if (entry instanceof SecretKeyEntry) {
    SecretKeyEntry secE=(SecretKeyEntry)entry;
    setSecretKeyEntry(alias,secE.getSecretKey(),(KeyStoreParameter)param);
  }
 else {
    throw new KeyStoreException("Entry must be a PrivateKeyEntry, SecretKeyEntry or TrustedCertificateEntry" + "; was " + entry);
  }
}
