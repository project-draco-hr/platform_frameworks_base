{
  if (cert == null) {
    return null;
  }
  final Set<String> nonCaEntries=new HashSet<String>();
  final String[] certAliases=mKeyStore.saw(Credentials.USER_CERTIFICATE);
  for (  String alias : certAliases) {
    final byte[] certBytes=mKeyStore.get(Credentials.USER_CERTIFICATE + alias);
    if (certBytes == null) {
      continue;
    }
    final Certificate c=toCertificate(certBytes);
    nonCaEntries.add(alias);
    if (cert.equals(c)) {
      return alias;
    }
  }
  final String[] caAliases=mKeyStore.saw(Credentials.CA_CERTIFICATE);
  for (  String alias : caAliases) {
    if (nonCaEntries.contains(alias)) {
      continue;
    }
    final byte[] certBytes=mKeyStore.get(Credentials.CA_CERTIFICATE + alias);
    if (certBytes == null) {
      continue;
    }
    final Certificate c=toCertificate(mKeyStore.get(Credentials.CA_CERTIFICATE + alias));
    if (cert.equals(c)) {
      return alias;
    }
  }
  return null;
}
