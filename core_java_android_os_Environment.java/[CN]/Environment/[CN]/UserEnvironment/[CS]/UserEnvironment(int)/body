{
  String rawExternalStorage=System.getenv(ENV_EXTERNAL_STORAGE);
  String rawEmulatedStorageTarget=System.getenv(ENV_EMULATED_STORAGE_TARGET);
  String rawMediaStorage=System.getenv(ENV_MEDIA_STORAGE);
  if (TextUtils.isEmpty(rawMediaStorage)) {
    rawMediaStorage="/data/media";
  }
  if (!TextUtils.isEmpty(rawEmulatedStorageTarget)) {
    final String rawUserId=Integer.toString(userId);
    final File emulatedBase=new File(rawEmulatedStorageTarget);
    final File mediaBase=new File(rawMediaStorage);
    mExternalDirs=new File[]{buildPath(emulatedBase,rawUserId)};
    mMediaDir=buildPath(mediaBase,rawUserId);
  }
 else {
    if (TextUtils.isEmpty(rawExternalStorage)) {
      Log.w(TAG,"EXTERNAL_STORAGE undefined; falling back to default");
      rawExternalStorage="/storage/sdcard0";
    }
    mExternalDirs=new File[]{new File(rawExternalStorage)};
    mMediaDir=new File(rawMediaStorage);
  }
}
