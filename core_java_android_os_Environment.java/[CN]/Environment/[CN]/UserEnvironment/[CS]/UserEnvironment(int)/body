{
  String rawExternalStorage=System.getenv(ENV_EXTERNAL_STORAGE);
  String rawEmulatedStorageTarget=System.getenv(ENV_EMULATED_STORAGE_TARGET);
  if (!TextUtils.isEmpty(rawEmulatedStorageTarget)) {
    final File emulatedBase=new File(rawEmulatedStorageTarget);
    mExternalStorage=buildPath(emulatedBase,Integer.toString(userId));
    mExternalStorageAndroidObb=buildPath(emulatedBase,"obb");
  }
 else {
    if (TextUtils.isEmpty(rawExternalStorage)) {
      Log.w(TAG,"EXTERNAL_STORAGE undefined; falling back to default");
      rawExternalStorage="/storage/sdcard0";
    }
    mExternalStorage=new File(rawExternalStorage);
    mExternalStorageAndroidObb=buildPath(mExternalStorage,"Android","obb");
  }
  mExternalStorageAndroidData=buildPath(mExternalStorage,"Android","data");
  mExternalStorageAndroidMedia=buildPath(mExternalStorage,"Android","media");
}
