{
  String rawExternalStorage=System.getenv(ENV_EXTERNAL_STORAGE);
  String rawEmulatedStorageTarget=System.getenv(ENV_EMULATED_STORAGE_TARGET);
  String rawMediaStorage=System.getenv(ENV_MEDIA_STORAGE);
  if (TextUtils.isEmpty(rawMediaStorage)) {
    rawMediaStorage="/data/media";
  }
  if (!TextUtils.isEmpty(rawEmulatedStorageTarget)) {
    final String rawUserId=Integer.toString(userId);
    final File emulatedBase=new File(rawEmulatedStorageTarget);
    final File mediaBase=new File(rawMediaStorage);
    mExternalStorage=buildPath(emulatedBase,rawUserId);
    mExternalStorageAndroidObb=buildPath(emulatedBase,"obb");
    mMediaStorage=buildPath(mediaBase,rawUserId);
  }
 else {
    if (TextUtils.isEmpty(rawExternalStorage)) {
      Log.w(TAG,"EXTERNAL_STORAGE undefined; falling back to default");
      rawExternalStorage="/storage/sdcard0";
    }
    mExternalStorage=new File(rawExternalStorage);
    mExternalStorageAndroidObb=buildPath(mExternalStorage,DIRECTORY_ANDROID,"obb");
    mMediaStorage=new File(rawMediaStorage);
  }
  mExternalStorageAndroidData=buildPath(mExternalStorage,DIRECTORY_ANDROID,"data");
  mExternalStorageAndroidMedia=buildPath(mExternalStorage,DIRECTORY_ANDROID,"media");
}
