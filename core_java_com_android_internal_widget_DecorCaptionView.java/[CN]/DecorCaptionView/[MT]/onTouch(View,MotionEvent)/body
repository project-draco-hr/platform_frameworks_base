{
  final int x=(int)e.getX();
  final int y=(int)e.getY();
switch (e.getActionMasked()) {
case MotionEvent.ACTION_DOWN:
    if (!mShow) {
      return false;
    }
  if (((e.getToolType(e.getActionIndex()) != MotionEvent.TOOL_TYPE_MOUSE || (e.getButtonState() & MotionEvent.BUTTON_PRIMARY) != 0))) {
    mCheckForDragging=true;
    mTouchDownX=x;
    mTouchDownY=y;
  }
break;
case MotionEvent.ACTION_MOVE:
if (!mDragging && mCheckForDragging && passedSlop(x,y)) {
mCheckForDragging=false;
mDragging=true;
mLeftMouseButtonReleased=false;
startMovingTask(e.getRawX(),e.getRawY());
}
 else if (mDragging && !mLeftMouseButtonReleased) {
if (e.getToolType(e.getActionIndex()) == MotionEvent.TOOL_TYPE_MOUSE && (e.getButtonState() & MotionEvent.BUTTON_PRIMARY) == 0) {
  mLeftMouseButtonReleased=true;
  break;
}
}
break;
case MotionEvent.ACTION_UP:
case MotionEvent.ACTION_CANCEL:
if (!mDragging) {
break;
}
mDragging=false;
return !mCheckForDragging;
}
return mDragging || mCheckForDragging;
}
