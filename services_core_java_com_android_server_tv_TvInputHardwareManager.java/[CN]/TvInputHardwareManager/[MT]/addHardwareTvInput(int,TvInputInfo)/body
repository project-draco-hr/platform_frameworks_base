{
  if (info.getType() == TvInputInfo.TYPE_VIRTUAL) {
    throw new IllegalArgumentException("info (" + info + ") has virtual type.");
  }
synchronized (mLock) {
    String oldInputId=mHardwareInputIdMap.get(deviceId);
    if (oldInputId != null) {
      Slog.w(TAG,"Trying to override previous registration: old = " + mInputMap.get(oldInputId) + ":"+ deviceId+ ", new = "+ info+ ":"+ deviceId);
    }
    mHardwareInputIdMap.put(deviceId,info.getId());
    mInputMap.put(info.getId(),info);
    for (int i=0; i < mHdmiStateMap.size(); ++i) {
      String inputId=findInputIdForHdmiPortLocked(mHdmiStateMap.keyAt(i));
      if (inputId != null && inputId.equals(info.getId())) {
        mHandler.obtainMessage(ListenerHandler.STATE_CHANGED,convertConnectedToState(mHdmiStateMap.valueAt(i)),0,inputId).sendToTarget();
      }
    }
  }
}
