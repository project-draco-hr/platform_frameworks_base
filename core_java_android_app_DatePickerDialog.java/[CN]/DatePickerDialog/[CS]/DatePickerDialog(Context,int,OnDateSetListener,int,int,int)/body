{
  super(context,resolveDialogTheme(context,theme));
  mDateSetListener=listener;
  mCalendar=Calendar.getInstance();
  Context themeContext=getContext();
  LayoutInflater inflater=(LayoutInflater)themeContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
  View view=inflater.inflate(R.layout.date_picker_dialog,null);
  setView(view);
  setButtonPanelLayoutHint(LAYOUT_HINT_SIDE);
  mDatePicker=(DatePicker)view.findViewById(R.id.datePicker);
  mDatePicker.setLegacyMode(false,null);
  mDatePicker.setShowDoneButton(true);
  mDatePicker.setDismissCallback(new DatePicker.DatePickerDismissCallback(){
    @Override public void dismiss(    DatePicker view,    boolean isCancel,    int year,    int month,    int dayOfMonth){
      mIsCanceled=isCancel;
      if (!isCancel) {
        mDateSetListener.onDateSet(view,year,month,dayOfMonth);
      }
      DatePickerDialog.this.dismiss();
    }
  }
);
  mDatePicker.init(year,monthOfYear,dayOfMonth,this);
}
