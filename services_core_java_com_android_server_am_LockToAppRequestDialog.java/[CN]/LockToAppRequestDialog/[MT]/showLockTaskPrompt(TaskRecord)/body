{
  if (mDialog != null) {
    mDialog.dismiss();
    mDialog=null;
  }
  mRequestedTask=task;
  final int unlockStringId=getLockString(task.userId);
  final Resources r=Resources.getSystem();
  final String description=r.getString(R.string.lock_to_app_description);
  AlertDialog.Builder builder=new AlertDialog.Builder(mContext).setTitle(r.getString(R.string.lock_to_app_title)).setMessage(description).setPositiveButton(r.getString(R.string.lock_to_app_positive),this).setNegativeButton(r.getString(R.string.lock_to_app_negative),this);
  if (unlockStringId != 0) {
    builder.setView(R.layout.lock_to_app_checkbox);
  }
  mDialog=builder.create();
  mDialog.getWindow().setType(WindowManager.LayoutParams.TYPE_SYSTEM_ALERT);
  mDialog.show();
  if (unlockStringId != 0) {
    String unlockString=mContext.getString(unlockStringId);
    mCheckbox=(CheckBox)mDialog.findViewById(R.id.lock_to_app_checkbox);
    mCheckbox.setText(mContext.getString(R.string.lock_to_app_use_screen_lock,unlockString));
    try {
      boolean useLock=Settings.System.getInt(mContext.getContentResolver(),Settings.System.LOCK_TO_APP_EXIT_LOCKED) != 0;
      mCheckbox.setChecked(useLock);
    }
 catch (    SettingNotFoundException e) {
    }
  }
 else {
    mCheckbox=null;
  }
}
