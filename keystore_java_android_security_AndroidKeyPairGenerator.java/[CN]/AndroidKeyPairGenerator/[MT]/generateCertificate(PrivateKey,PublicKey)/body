{
  final X509V3CertificateGenerator certGen=new X509V3CertificateGenerator();
  certGen.setPublicKey(publicKey);
  certGen.setSerialNumber(mSpec.getSerialNumber());
  certGen.setSubjectDN(mSpec.getSubjectDN());
  certGen.setIssuerDN(mSpec.getSubjectDN());
  certGen.setNotBefore(mSpec.getStartDate());
  certGen.setNotAfter(mSpec.getEndDate());
  certGen.setSignatureAlgorithm(getDefaultSignatureAlgorithmForKeyAlgorithm(mKeyAlgorithm));
  return certGen.generate(privateKey);
}
