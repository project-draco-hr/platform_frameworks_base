{
  final X509V3CertificateGenerator certGen=new X509V3CertificateGenerator();
  certGen.setPublicKey(publicKey);
  certGen.setSerialNumber(mSpec.getCertificateSerialNumber());
  certGen.setSubjectDN(mSpec.getCertificateSubject());
  certGen.setIssuerDN(mSpec.getCertificateSubject());
  certGen.setNotBefore(mSpec.getCertificateNotBefore());
  certGen.setNotAfter(mSpec.getCertificateNotAfter());
  certGen.setSignatureAlgorithm(getDefaultSignatureAlgorithmForKeyAlgorithm(mKeyAlgorithm));
  return certGen.generate(privateKey);
}
