{
  if (keyType == NativeConstants.EVP_PKEY_EC) {
    if (keySize < EC_MIN_KEY_SIZE || keySize > EC_MAX_KEY_SIZE) {
      throw new InvalidAlgorithmParameterException("EC keys must be >= " + EC_MIN_KEY_SIZE + " and <= "+ EC_MAX_KEY_SIZE);
    }
  }
 else   if (keyType == NativeConstants.EVP_PKEY_RSA) {
    if (keySize < RSA_MIN_KEY_SIZE || keySize > RSA_MAX_KEY_SIZE) {
      throw new InvalidAlgorithmParameterException("RSA keys must be >= " + RSA_MIN_KEY_SIZE + " and <= "+ RSA_MAX_KEY_SIZE);
    }
  }
 else {
    throw new InvalidAlgorithmParameterException("Unsupported key algorithm: " + keyAlgorithm);
  }
}
