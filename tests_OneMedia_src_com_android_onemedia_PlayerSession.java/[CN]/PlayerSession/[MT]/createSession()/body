{
  releaseSession();
  MediaSessionManager man=(MediaSessionManager)mContext.getSystemService(Context.MEDIA_SESSION_SERVICE);
  Log.d(TAG,"Creating session for package " + mContext.getBasePackageName());
  mRouter=new MediaRouter(mContext);
  mRouter.addSelector(new MediaRouteSelector.Builder().addRequiredProtocol(MediaPlayerProtocol.class).build());
  mRouter.addSelector(new MediaRouteSelector.Builder().setRequiredFeatures(MediaRouter.ROUTE_FEATURE_LIVE_AUDIO).setOptionalFeatures(MediaRouter.ROUTE_FEATURE_LIVE_VIDEO).build());
  mRouter.setRoutingCallback(new RoutingCallback(),null);
  mSession=man.createSession("OneMedia");
  mSession.addCallback(mCallback);
  mSession.addTransportControlsCallback(new TransportCallback());
  mSession.setPlaybackState(mPlaybackState);
  mSession.setFlags(MediaSession.FLAG_HANDLES_TRANSPORT_CONTROLS);
  mSession.setMediaRouter(mRouter);
  mSession.setActive(true);
}
