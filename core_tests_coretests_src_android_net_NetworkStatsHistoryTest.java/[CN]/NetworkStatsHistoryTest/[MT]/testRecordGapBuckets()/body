{
  final long BUCKET_SIZE=HOUR_IN_MILLIS;
  stats=new NetworkStatsHistory(BUCKET_SIZE);
  final long firstStart=TEST_START;
  final long lastStart=TEST_START + WEEK_IN_MILLIS;
  stats.recordData(firstStart,firstStart + SECOND_IN_MILLIS,128L,256L);
  stats.recordData(lastStart,lastStart + SECOND_IN_MILLIS,64L,512L);
  assertEquals(2,stats.bucketCount);
  assertBucket(stats,0,128L,256L);
  assertBucket(stats,1,64L,512L);
  final long middleStart=TEST_START + DAY_IN_MILLIS;
  final long middleEnd=middleStart + (HOUR_IN_MILLIS * 2);
  stats.recordData(middleStart,middleEnd,2048L,2048L);
  assertEquals(4,stats.bucketCount);
  assertBucket(stats,0,128L,256L);
  assertBucket(stats,1,1024L,1024L);
  assertBucket(stats,2,1024L,1024L);
  assertBucket(stats,3,64L,512L);
}
