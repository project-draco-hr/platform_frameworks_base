{
  if (keySpecClass == null) {
    throw new InvalidKeySpecException("keySpecClass == null");
  }
  if (!(key instanceof AndroidKeyStorePrivateKey)) {
    throw new InvalidKeySpecException("Only Android KeyStore private keys supported: " + ((key != null) ? key.getClass().getName() : "null"));
  }
  if (PKCS8EncodedKeySpec.class.isAssignableFrom(keySpecClass)) {
    throw new InvalidKeySpecException("Key material export of Android KeyStore keys is not supported");
  }
  if (!KeyInfo.class.equals(keySpecClass)) {
    throw new InvalidKeySpecException("Unsupported key spec: " + keySpecClass.getName());
  }
  String keyAliasInKeystore=((AndroidKeyStoreKey)key).getAlias();
  String entryAlias;
  if (keyAliasInKeystore.startsWith(Credentials.USER_PRIVATE_KEY)) {
    entryAlias=keyAliasInKeystore.substring(Credentials.USER_PRIVATE_KEY.length());
  }
 else {
    throw new InvalidKeySpecException("Invalid key alias: " + keyAliasInKeystore);
  }
  @SuppressWarnings("unchecked") T result=(T)AndroidKeyStoreSecretKeyFactorySpi.getKeyInfo(mKeyStore,entryAlias,keyAliasInKeystore);
  return result;
}
