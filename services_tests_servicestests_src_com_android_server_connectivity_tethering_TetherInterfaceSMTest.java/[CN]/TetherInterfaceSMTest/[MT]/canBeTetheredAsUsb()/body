{
  initStateMachine(true);
  when(mNMService.getInterfaceConfig(IFACE_NAME)).thenReturn(mInterfaceConfiguration);
  dispatchCommand(TetherInterfaceSM.CMD_TETHER_REQUESTED);
  InOrder inOrder=inOrder(mTetherHelper,mNMService);
  inOrder.verify(mTetherHelper).notifyInterfaceTetheringReadiness(true,mTestedSm);
  inOrder.verify(mNMService).getInterfaceConfig(IFACE_NAME);
  inOrder.verify(mNMService).setInterfaceConfig(IFACE_NAME,mInterfaceConfiguration);
  inOrder.verify(mTetherHelper).sendTetherStateChangedBroadcast();
  inOrder.verify(mNMService).tetherInterface(IFACE_NAME);
  inOrder.verify(mTetherHelper).sendTetherStateChangedBroadcast();
  verifyNoMoreInteractions(mNMService,mStatsService,mTetherHelper);
  assertFalse("Should not be tetherable when tethered",mTestedSm.isAvailable());
  assertTrue("Should be in a tethered state",mTestedSm.isTethered());
  assertFalse("Should have no errors when tethered",mTestedSm.isErrored());
}
