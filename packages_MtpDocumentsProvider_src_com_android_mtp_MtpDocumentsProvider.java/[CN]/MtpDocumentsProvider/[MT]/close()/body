{
  boolean closed=false;
  for (  int deviceId : mMtpManager.getOpenedDeviceIds()) {
    try {
      mDatabase.removeDeviceRows(deviceId);
      mMtpManager.closeDevice(deviceId);
      getDeviceToolkit(deviceId).mDocumentLoader.clearTasks();
      closed=true;
    }
 catch (    IOException d) {
      Log.d(TAG,"Failed to close the MTP device: " + deviceId);
    }
  }
  if (closed) {
    mRootScanner.notifyChange();
  }
  mRootScanner.close();
  mDatabase.close();
}
