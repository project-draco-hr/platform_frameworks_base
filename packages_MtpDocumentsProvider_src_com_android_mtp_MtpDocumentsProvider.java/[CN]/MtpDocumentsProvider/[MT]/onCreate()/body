{
  sSingleton=this;
  mResources=getContext().getResources();
  mMtpManager=new MtpManager(getContext());
  mResolver=getContext().getContentResolver();
  mDeviceToolkits=new HashMap<Integer,DeviceToolkit>();
  mDatabase=new MtpDatabase(getContext(),MtpDatabaseConstants.FLAG_DATABASE_IN_FILE);
  mRootScanner=new RootScanner(mResolver,mMtpManager,mDatabase);
  mAppFuse=new AppFuse(TAG,new AppFuseCallback());
  mIntentSender=new ServiceIntentSender(getContext());
  try {
    mAppFuse.mount(getContext().getSystemService(StorageManager.class));
  }
 catch (  IOException e) {
    Log.e(TAG,"Failed to start app fuse.",e);
    return false;
  }
  resume();
  return true;
}
