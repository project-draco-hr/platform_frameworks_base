{
  SQLiteDatabase db=mHelper.getReadableDatabase();
  long midnight=getMidnightMs();
  String q=String.format(STATS_QUERY,midnight,filter.since);
  Cursor cursor=db.rawQuery(q,null);
  try {
    for (cursor.moveToFirst(); !cursor.isAfterLast(); cursor.moveToNext()) {
      int userId=cursor.getInt(0);
      String pkg=cursor.getString(1);
      if (filter != null && !filter.matches(pkg))       continue;
      int day=cursor.getInt(2);
      int count=cursor.getInt(3);
      int muted=cursor.getInt(4);
      int noisy=cursor.getInt(5);
      int demoted=cursor.getInt(6);
      pw.println(indent + "post_frequency{user_id=" + userId+ ",pkg="+ pkg+ ",day="+ day+ ",count="+ count+ ",muted="+ muted+ "/"+ noisy+ ",demoted="+ demoted+ "}");
    }
  }
  finally {
    cursor.close();
  }
}
