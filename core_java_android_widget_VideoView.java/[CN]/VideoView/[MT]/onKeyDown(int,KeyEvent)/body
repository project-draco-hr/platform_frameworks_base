{
  if (mIsPrepared && keyCode != KeyEvent.KEYCODE_BACK && keyCode != KeyEvent.KEYCODE_VOLUME_UP && keyCode != KeyEvent.KEYCODE_VOLUME_DOWN && keyCode != KeyEvent.KEYCODE_MENU && keyCode != KeyEvent.KEYCODE_CALL && keyCode != KeyEvent.KEYCODE_ENDCALL && mMediaPlayer != null && mMediaController != null) {
    if (keyCode == KeyEvent.KEYCODE_HEADSETHOOK || keyCode == KeyEvent.KEYCODE_PLAYPAUSE) {
      if (mMediaPlayer.isPlaying()) {
        pause();
        mMediaController.show();
      }
 else {
        start();
        mMediaController.hide();
      }
      return true;
    }
 else     if (keyCode == KeyEvent.KEYCODE_STOP && mMediaPlayer.isPlaying()) {
      pause();
      mMediaController.show();
    }
 else {
      toggleMediaControlsVisiblity();
    }
  }
  return super.onKeyDown(keyCode,event);
}
