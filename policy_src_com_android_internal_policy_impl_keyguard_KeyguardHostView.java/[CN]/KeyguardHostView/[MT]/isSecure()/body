{
  SecurityMode mode=mSecurityModel.getSecurityMode();
switch (mode) {
case Pattern:
    return mLockPatternUtils.isLockPatternEnabled();
case Password:
  return mLockPatternUtils.isLockPasswordEnabled();
case SimPin:
case SimPuk:
case Account:
return true;
case None:
return false;
default :
throw new IllegalStateException("Unknown security mode " + mode);
}
}
