{
  boolean finish=false;
  if (SECURITY_SELECTOR_ID == mCurrentSecurityId) {
    SecurityMode securityMode=mSecurityModel.getSecurityMode();
    int realSecurityId=getSecurityViewIdForMode(securityMode);
    if (SECURITY_SELECTOR_ID == realSecurityId) {
      finish=true;
    }
 else {
      showSecurityScreen(realSecurityId);
    }
  }
 else   if (authenticated) {
switch (mCurrentSecurityId) {
case SECURITY_PATTERN_ID:
case SECURITY_PASSWORD_ID:
case SECURITY_ACCOUNT_ID:
case SECURITY_BIOMETRIC_ID:
      finish=true;
    break;
case SECURITY_SIM_PIN_ID:
case SECURITY_SIM_PUK_ID:
  SecurityMode securityMode=mSecurityModel.getSecurityMode();
if (securityMode != SecurityMode.None) {
  showSecurityScreen(getSecurityViewIdForMode(securityMode));
}
 else {
  finish=true;
}
break;
default :
showSecurityScreen(SECURITY_SELECTOR_ID);
break;
}
}
 else {
showSecurityScreen(SECURITY_SELECTOR_ID);
}
if (finish) {
if (mLaunchRunnable != null) {
mLaunchRunnable.run();
mViewFlipper.setDisplayedChild(0);
mLaunchRunnable=null;
}
mViewMediatorCallback.keyguardDone(true);
}
}
