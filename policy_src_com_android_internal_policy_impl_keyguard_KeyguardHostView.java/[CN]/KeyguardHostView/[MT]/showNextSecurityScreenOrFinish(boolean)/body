{
  boolean finish=false;
  if (SECURITY_SELECTOR_ID == mCurrentSecurityId) {
    SecurityMode securityMode=mSecurityModel.getSecurityMode();
    int realSecurityId=getSecurityViewIdForMode(securityMode);
    if (SECURITY_SELECTOR_ID == realSecurityId) {
      finish=true;
    }
 else {
      showSecurityScreen(realSecurityId);
    }
  }
 else   if (authenticated) {
    if (mCurrentSecurityId == SECURITY_PATTERN_ID || mCurrentSecurityId == SECURITY_PASSWORD_ID || mCurrentSecurityId == SECURITY_ACCOUNT_ID || mCurrentSecurityId == SECURITY_BIOMETRIC_ID) {
      finish=true;
    }
  }
 else {
    showSecurityScreen(SECURITY_SELECTOR_ID);
  }
  if (finish) {
    if (mLaunchRunnable != null) {
      mLaunchRunnable.run();
      mViewFlipper.setDisplayedChild(0);
      mLaunchRunnable=null;
    }
    mViewMediatorCallback.keyguardDone(true);
  }
}
