{
  boolean finish=false;
  if (SecurityMode.None == mCurrentSecuritySelection) {
    SecurityMode securityMode=mSecurityModel.getSecurityMode();
    securityMode=mSecurityModel.getAlternateFor(securityMode);
    if (SecurityMode.None == securityMode) {
      finish=true;
    }
 else {
      showSecurityScreen(securityMode);
    }
  }
 else   if (authenticated) {
switch (mCurrentSecuritySelection) {
case Pattern:
case Password:
case Account:
case Biometric:
      finish=true;
    break;
case SimPin:
case SimPuk:
  SecurityMode securityMode=mSecurityModel.getSecurityMode();
if (securityMode != SecurityMode.None) {
  showSecurityScreen(securityMode);
}
 else {
  finish=true;
}
break;
default :
showSecurityScreen(SecurityMode.None);
break;
}
}
 else {
showSecurityScreen(SecurityMode.None);
}
if (finish) {
if (mLaunchRunnable != null) {
mLaunchRunnable.run();
mLaunchRunnable=null;
}
mViewMediatorCallback.keyguardDone(true);
}
}
