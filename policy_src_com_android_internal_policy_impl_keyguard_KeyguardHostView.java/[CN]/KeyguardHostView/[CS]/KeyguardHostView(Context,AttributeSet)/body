{
  super(context,attrs);
  mLockPatternUtils=new LockPatternUtils(context);
  mAppWidgetHost=new AppWidgetHost(context,APPWIDGET_HOST_ID,mOnClickHandler,Looper.myLooper());
  mAppWidgetManager=AppWidgetManager.getInstance(mContext);
  mSecurityModel=new KeyguardSecurityModel(context);
  mViewStateManager=new KeyguardViewStateManager(this);
  DevicePolicyManager dpm=(DevicePolicyManager)mContext.getSystemService(Context.DEVICE_POLICY_SERVICE);
  if (dpm != null) {
    mDisabledFeatures=getDisabledFeatures(dpm);
    mCameraDisabled=dpm.getCameraDisabled(null);
  }
  mSafeModeEnabled=LockPatternUtils.isSafeModeEnabled();
  if (mSafeModeEnabled) {
    Log.v(TAG,"Keyguard widgets disabled by safe mode");
  }
  if ((mDisabledFeatures & DevicePolicyManager.KEYGUARD_DISABLE_WIDGETS_ALL) != 0) {
    Log.v(TAG,"Keyguard widgets disabled by DPM");
  }
  if ((mDisabledFeatures & DevicePolicyManager.KEYGUARD_DISABLE_SECURE_CAMERA) != 0) {
    Log.v(TAG,"Keyguard secure camera disabled by DPM");
  }
}
