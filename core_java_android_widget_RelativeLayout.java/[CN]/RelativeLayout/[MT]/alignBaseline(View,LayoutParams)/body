{
  final int layoutDirection=getLayoutDirection();
  int[] rules=params.getRules(layoutDirection);
  int anchorBaseline=getRelatedViewBaseline(rules,ALIGN_BASELINE);
  if (anchorBaseline != -1) {
    LayoutParams anchorParams=getRelatedViewParams(rules,ALIGN_BASELINE);
    if (anchorParams != null) {
      int offset=anchorParams.mTop + anchorBaseline;
      int baseline=child.getBaseline();
      if (baseline != -1) {
        offset-=baseline;
      }
      int height=params.mBottom - params.mTop;
      params.mTop=offset;
      params.mBottom=params.mTop + height;
    }
  }
  if (mBaselineView == null) {
    mBaselineView=child;
  }
 else {
    LayoutParams lp=(LayoutParams)mBaselineView.getLayoutParams();
    if (params.mTop < lp.mTop || (params.mTop == lp.mTop && params.mLeft < lp.mLeft)) {
      mBaselineView=child;
    }
  }
}
