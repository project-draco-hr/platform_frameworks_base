{
  int childSpecMode=0;
  int childSpecSize=0;
  if (mySize < 0 && !mAllowBrokenMeasureSpecs) {
    if (childSize >= 0) {
      childSpecSize=childSize;
      childSpecMode=MeasureSpec.EXACTLY;
    }
 else     if (childStart >= 0 && childEnd >= 0) {
      childSpecSize=Math.max(0,childEnd - childStart);
      childSpecMode=MeasureSpec.EXACTLY;
    }
 else {
      childSpecSize=0;
      childSpecMode=MeasureSpec.UNSPECIFIED;
    }
    return MeasureSpec.makeMeasureSpec(childSpecSize,childSpecMode);
  }
  int tempStart=childStart;
  int tempEnd=childEnd;
  if (tempStart < 0) {
    tempStart=startPadding + startMargin;
  }
  if (tempEnd < 0) {
    tempEnd=mySize - endPadding - endMargin;
  }
  int maxAvailable=tempEnd - tempStart;
  if (childStart >= 0 && childEnd >= 0) {
    childSpecMode=MeasureSpec.EXACTLY;
    childSpecSize=maxAvailable;
  }
 else {
    if (childSize >= 0) {
      childSpecMode=MeasureSpec.EXACTLY;
      if (maxAvailable >= 0) {
        childSpecSize=Math.min(maxAvailable,childSize);
      }
 else {
        childSpecSize=childSize;
      }
    }
 else     if (childSize == LayoutParams.MATCH_PARENT) {
      childSpecMode=MeasureSpec.EXACTLY;
      childSpecSize=maxAvailable;
    }
 else     if (childSize == LayoutParams.WRAP_CONTENT) {
      if (maxAvailable >= 0) {
        childSpecMode=MeasureSpec.AT_MOST;
        childSpecSize=maxAvailable;
      }
 else {
        childSpecMode=MeasureSpec.UNSPECIFIED;
        childSpecSize=0;
      }
    }
  }
  return MeasureSpec.makeMeasureSpec(childSpecSize,childSpecMode);
}
