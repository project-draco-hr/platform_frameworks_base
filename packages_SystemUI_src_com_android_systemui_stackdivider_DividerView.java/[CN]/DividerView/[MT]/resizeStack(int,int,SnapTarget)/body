{
  calculateBoundsForPosition(position,mDockSide,mDockedRect);
  if (mDockedRect.equals(mLastResizeRect) && !mEntranceAnimationRunning) {
    return;
  }
  if (mBackground.getZ() > 0f) {
    mBackground.invalidate();
  }
  mLastResizeRect.set(mDockedRect);
  if (mEntranceAnimationRunning && taskPosition != TASK_POSITION_SAME) {
    if (mCurrentAnimator != null) {
      calculateBoundsForPosition(taskPosition,mDockSide,mDockedTaskRect);
    }
 else {
      calculateBoundsForPosition(isHorizontalDivision() ? mDisplayHeight : mDisplayWidth,mDockSide,mDockedTaskRect);
    }
    calculateBoundsForPosition(taskPosition,DockedDividerUtils.invertDockSide(mDockSide),mOtherTaskRect);
    mWindowManagerProxy.resizeDockedStack(mDockedRect,mDockedTaskRect,null,mOtherTaskRect,null);
  }
 else   if (mExitAnimationRunning && taskPosition != TASK_POSITION_SAME) {
    calculateBoundsForPosition(taskPosition,mDockSide,mDockedTaskRect);
    calculateBoundsForPosition(mExitStartPosition,DockedDividerUtils.invertDockSide(mDockSide),mOtherTaskRect);
    mOtherInsetRect.set(mOtherTaskRect);
    applyExitAnimationParallax(mOtherTaskRect,position);
    mWindowManagerProxy.resizeDockedStack(mDockedRect,mDockedTaskRect,null,mOtherTaskRect,mOtherInsetRect);
  }
 else   if (taskPosition != TASK_POSITION_SAME) {
    calculateBoundsForPosition(position,DockedDividerUtils.invertDockSide(mDockSide),mOtherRect);
    int dockSideInverted=DockedDividerUtils.invertDockSide(mDockSide);
    int taskPositionDocked=restrictDismissingTaskPosition(taskPosition,mDockSide,taskSnapTarget);
    int taskPositionOther=restrictDismissingTaskPosition(taskPosition,dockSideInverted,taskSnapTarget);
    calculateBoundsForPosition(taskPositionDocked,mDockSide,mDockedTaskRect);
    calculateBoundsForPosition(taskPositionOther,dockSideInverted,mOtherTaskRect);
    mDisplayRect.set(0,0,mDisplayWidth,mDisplayHeight);
    alignTopLeft(mDockedRect,mDockedTaskRect);
    alignTopLeft(mOtherRect,mOtherTaskRect);
    mDockedInsetRect.set(mDockedTaskRect);
    mOtherInsetRect.set(mOtherTaskRect);
    if (dockSideTopLeft(mDockSide)) {
      alignTopLeft(mDisplayRect,mDockedInsetRect);
      alignBottomRight(mDisplayRect,mOtherInsetRect);
    }
 else {
      alignBottomRight(mDisplayRect,mDockedInsetRect);
      alignTopLeft(mDisplayRect,mOtherInsetRect);
    }
    applyDismissingParallax(mDockedTaskRect,mDockSide,taskSnapTarget,position,taskPositionDocked);
    applyDismissingParallax(mOtherTaskRect,dockSideInverted,taskSnapTarget,position,taskPositionOther);
    mWindowManagerProxy.resizeDockedStack(mDockedRect,mDockedTaskRect,mDockedInsetRect,mOtherTaskRect,mOtherInsetRect);
  }
 else {
    mWindowManagerProxy.resizeDockedStack(mDockedRect,null,null,null,null);
  }
  SnapTarget closestDismissTarget=mSnapAlgorithm.getClosestDismissTarget(position);
  float dimFraction=getDimFraction(position,closestDismissTarget);
  mWindowManagerProxy.setResizeDimLayer(dimFraction != 0f,getStackIdForDismissTarget(closestDismissTarget),dimFraction);
}
