{
  final String action=intent.getAction();
  if (action.equals(WifiManager.WIFI_STATE_CHANGED_ACTION)) {
    mWifiEnabled=intent.getIntExtra(WifiManager.EXTRA_WIFI_STATE,WifiManager.WIFI_STATE_UNKNOWN) == WifiManager.WIFI_STATE_ENABLED;
  }
 else   if (action.equals(WifiManager.NETWORK_STATE_CHANGED_ACTION) || action.equals(WifiManager.SUPPLICANT_STATE_CHANGED_ACTION)) {
    final NetworkInfo networkInfo=(NetworkInfo)intent.getParcelableExtra(WifiManager.EXTRA_NETWORK_INFO);
    boolean wasConnected=mWifiConnected;
    mWifiConnected=networkInfo != null && networkInfo.isConnected();
    if (mWifiConnected && !wasConnected) {
      WifiInfo info=mWifiManager.getConnectionInfo();
      if (info != null) {
        mWifiLevel=WifiManager.calculateSignalLevel(info.getRssi(),WifiIcons.WIFI_LEVEL_COUNT);
        mWifiSsid=huntForSsid(info);
      }
 else {
        mWifiLevel=0;
        mWifiSsid=null;
      }
    }
 else     if (!mWifiConnected) {
      mWifiLevel=0;
      mWifiSsid=null;
    }
  }
 else   if (action.equals(WifiManager.RSSI_CHANGED_ACTION)) {
    if (mWifiConnected) {
      final int newRssi=intent.getIntExtra(WifiManager.EXTRA_NEW_RSSI,-200);
      mWifiLevel=WifiManager.calculateSignalLevel(newRssi,WifiIcons.WIFI_LEVEL_COUNT);
    }
  }
  updateWifiIcons();
}
