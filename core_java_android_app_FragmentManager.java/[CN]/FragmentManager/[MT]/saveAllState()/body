{
  mSavedFragments=null;
  mSaveStateSeq++;
  if (mFragments == null) {
    return null;
  }
  int[] added=null;
  BackStackState[] backStack=null;
  int N=mFragments.size();
  if (N > 0) {
    added=new int[N];
    for (int i=0; i < N; i++) {
      added[i]=saveFragment(mFragments.get(i)).mSavedStateId;
    }
  }
  if (mBackStack != null) {
    N=mBackStack.size();
    if (N > 0) {
      backStack=new BackStackState[N];
      for (int i=0; i < N; i++) {
        backStack[i]=new BackStackState(this,mBackStack.get(i));
      }
    }
  }
  if (mSavedFragments == null) {
    return null;
  }
  N=mSavedFragments.size();
  if (N <= 0) {
    return null;
  }
  FragmentManagerState fms=new FragmentManagerState();
  fms.mFragments=new FragmentState[N];
  int i=0;
  for (  FragmentState fs : mSavedFragments.values()) {
    fms.mFragments[i]=fs;
    i++;
  }
  fms.mAdded=added;
  fms.mBackStack=backStack;
  return fms;
}
