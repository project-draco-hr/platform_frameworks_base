{
  ArrayList<Fragment> fragments=null;
  if (mFragments != null) {
    for (int i=0; i < mFragments.size(); i++) {
      Fragment f=mFragments.get(i);
      if (f.mBackStackNesting <= 0 && f.mRetainInstance && f.mTag != null) {
        if (fragments == null) {
          fragments=new ArrayList<Fragment>();
        }
        fragments.add(f);
        f.mRetaining=true;
      }
    }
  }
  return fragments;
}
