{
  if (PhoneStatusBar.DEBUG_EMPTY_KEYGUARD && mStatusBar.getBarState() == StatusBarState.KEYGUARD) {
    Log.i(PhoneStatusBar.TAG,"Panel collapsed! Stacktrace: " + Log.getStackTraceString(new Throwable()));
  }
  if (DEBUG)   logf("collapse: " + this);
  if (mPeekPending || mPeekAnimator != null) {
    mCollapseAfterPeek=true;
    if (mPeekPending) {
      removeCallbacks(mPeekRunnable);
      mPeekRunnable.run();
    }
  }
 else   if (!isFullyCollapsed() && !mTracking && !mClosing) {
    cancelHeightAnimator();
    mClosing=true;
    notifyExpandingStarted();
    if (delayed) {
      mNextCollapseSpeedUpFactor=speedUpFactor;
      postDelayed(mFlingCollapseRunnable,120);
    }
 else {
      fling(0,false,speedUpFactor,false);
    }
  }
}
