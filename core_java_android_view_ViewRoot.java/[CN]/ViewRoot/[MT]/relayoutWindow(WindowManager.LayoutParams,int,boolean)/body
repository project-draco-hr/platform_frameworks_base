{
  float appScale=mAttachInfo.mApplicationScale;
  boolean restore=false;
  if (params != null && mTranslator != null) {
    restore=true;
    params.backup();
    mTranslator.translateWindowLayout(params);
  }
  if (params != null) {
    if (DBG)     Log.d(TAG,"WindowLayout in layoutWindow:" + params);
  }
  int relayoutResult=sWindowSession.relayout(mWindow,params,(int)(mView.mMeasuredWidth * appScale),(int)(mView.mMeasuredHeight * appScale),viewVisibility,insetsPending,mWinFrame,mPendingContentInsets,mPendingVisibleInsets,mSurface);
  if (restore) {
    params.restore();
  }
  if (mTranslator != null) {
    mTranslator.translateRectInScreenToAppWinFrame(mWinFrame);
    mTranslator.translateRectInScreenToAppWindow(mPendingContentInsets);
    mTranslator.translateRectInScreenToAppWindow(mPendingVisibleInsets);
  }
  return relayoutResult;
}
