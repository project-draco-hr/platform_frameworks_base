{
  final KeyEvent event=(KeyEvent)retrievePendingEvent(seq);
  if (DEBUG_IMF)   Log.v(TAG,"IME finished event: seq=" + seq + " handled="+ handled+ " event="+ event);
  if (event != null) {
    final boolean sendDone=seq >= 0;
    if (handled) {
      finishKeyEvent(event,sendDone,true);
    }
 else {
      deliverKeyEventPostIme(event,sendDone);
    }
  }
}
