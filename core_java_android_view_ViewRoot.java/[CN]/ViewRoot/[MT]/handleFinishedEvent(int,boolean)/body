{
  final KeyEvent event=(KeyEvent)retrievePendingEvent(seq);
  if (DEBUG_IMF)   Log.v(TAG,"IME finished event: seq=" + seq + " handled="+ handled+ " event="+ event);
  if (event != null) {
    final boolean sendDone=seq >= 0;
    if (!handled) {
      deliverKeyEventToViewHierarchy(event,sendDone);
    }
 else     if (sendDone) {
      if (LOCAL_LOGV)       Log.v("ViewRoot","Telling window manager key is finished");
      finishKeyEvent(event);
    }
 else {
      Log.w("ViewRoot","handleFinishedEvent(seq=" + seq + " handled="+ handled+ " ev="+ event+ ") neither delivering nor finishing key");
    }
  }
}
