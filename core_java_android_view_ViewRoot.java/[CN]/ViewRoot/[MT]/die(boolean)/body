{
  checkThread();
  if (Config.LOGV)   Log.v("ViewRoot","DIE in " + this + " of "+ mSurface);
synchronized (this) {
    if (mAdded && !mFirst) {
      int viewVisibility=mView.getVisibility();
      boolean viewVisibilityChanged=mViewVisibility != viewVisibility;
      if (mWindowAttributesChanged || viewVisibilityChanged) {
        try {
          if ((sWindowSession.relayout(mWindow,mWindowAttributes,mView.mMeasuredWidth,mView.mMeasuredHeight,viewVisibility,false,mWinFrame,mPendingContentInsets,mPendingVisibleInsets,mSurface) & WindowManagerImpl.RELAYOUT_FIRST_TIME) != 0) {
            sWindowSession.finishDrawing(mWindow);
          }
        }
 catch (        RemoteException e) {
        }
      }
      mSurface=null;
    }
    if (mAdded) {
      mAdded=false;
      try {
        sWindowSession.remove(mWindow);
      }
 catch (      RemoteException e) {
      }
      if (immediate) {
        dispatchDetachedFromWindow();
      }
 else       if (mView != null) {
        sendEmptyMessage(DIE);
      }
    }
  }
}
