{
  mAttachInfo.mHardwareAccelerated=false;
  mAttachInfo.mHardwareAccelerationRequested=false;
  final boolean hardwareAccelerated=(attrs.flags & WindowManager.LayoutParams.FLAG_HARDWARE_ACCELERATED) != 0;
  if (attrs != null && hardwareAccelerated) {
    final boolean systemHwAccelerated=(attrs.flags & WindowManager.LayoutParams.FLAG_HARDWARE_ACCELERATED_SYSTEM) != 0;
    if (!HardwareRenderer.sRendererDisabled || systemHwAccelerated) {
      if (!systemHwAccelerated && Looper.getMainLooper() != Looper.myLooper()) {
        Log.w(HardwareRenderer.LOG_TAG,"Attempting to initialize hardware " + "acceleration outside of the main thread, aborting");
        return;
      }
      final boolean translucent=attrs.format != PixelFormat.OPAQUE;
      if (mAttachInfo.mHardwareRenderer != null) {
        mAttachInfo.mHardwareRenderer.destroy(true);
      }
      mAttachInfo.mHardwareRenderer=HardwareRenderer.createGlRenderer(2,translucent);
      mAttachInfo.mHardwareAccelerated=mAttachInfo.mHardwareAccelerationRequested=mAttachInfo.mHardwareRenderer != null;
    }
 else     if (HardwareRenderer.isAvailable()) {
      mAttachInfo.mHardwareAccelerationRequested=true;
    }
  }
}
