{
  boolean handled=false;
  handled=mView.dispatchKeyEventPreIme(event);
  if (handled) {
    if (sendDone) {
      if (LOCAL_LOGV)       Log.v("ViewRoot","Telling window manager key is finished");
      try {
        sWindowSession.finishKey(mWindow);
      }
 catch (      RemoteException e) {
      }
    }
    return;
  }
  InputMethodManager imm=InputMethodManager.peekInstance();
  if (imm != null && mView != null && imm.isActive()) {
    int seq=enqueuePendingEvent(event,sendDone);
    if (DEBUG_IMF)     Log.v(TAG,"Sending key event to IME: seq=" + seq + " event="+ event);
    imm.dispatchKeyEvent(mView.getContext(),seq,event,mInputMethodCallback);
    return;
  }
  deliverKeyEventToViewHierarchy(event,sendDone);
}
