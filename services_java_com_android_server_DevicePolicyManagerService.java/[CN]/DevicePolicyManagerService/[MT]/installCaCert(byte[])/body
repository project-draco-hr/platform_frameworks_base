{
  mContext.enforceCallingOrSelfPermission(MANAGE_CA_CERTIFICATES,null);
  KeyChainConnection keyChainConnection=null;
  byte[] pemCert;
  try {
    X509Certificate cert=parseCert(certBuffer);
    pemCert=Credentials.convertToPem(cert);
  }
 catch (  CertificateException ce) {
    Log.e(TAG,"Problem converting cert",ce);
    return false;
  }
catch (  IOException ioe) {
    Log.e(TAG,"Problem reading cert",ioe);
    return false;
  }
  try {
    keyChainConnection=KeyChain.bind(mContext);
    try {
      keyChainConnection.getService().installCaCertificate(pemCert);
      return true;
    }
  finally {
      if (keyChainConnection != null) {
        keyChainConnection.close();
        keyChainConnection=null;
      }
    }
  }
 catch (  InterruptedException e1) {
    Log.w(TAG,"installCaCertsToKeyChain(): ",e1);
    Thread.currentThread().interrupt();
  }
  return false;
}
