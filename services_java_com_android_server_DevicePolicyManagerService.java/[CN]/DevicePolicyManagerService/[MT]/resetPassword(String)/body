{
  int quality;
synchronized (this) {
    getActiveAdminForCallerLocked(null,DeviceAdminInfo.USES_POLICY_RESET_PASSWORD);
    quality=getPasswordQuality(null);
    if (quality != DevicePolicyManager.PASSWORD_QUALITY_UNSPECIFIED) {
      int adjQuality=LockPatternUtils.adjustPasswordMode(password,quality);
      if (adjQuality == DevicePolicyManager.PASSWORD_QUALITY_UNSPECIFIED) {
        Log.w(TAG,"resetPassword: password does not meet quality " + quality);
        return false;
      }
      quality=adjQuality;
    }
    int length=getPasswordMinimumLength(null);
    if (password.length() < length) {
      Log.w(TAG,"resetPassword: password does not meet length " + length);
      return false;
    }
  }
  long ident=Binder.clearCallingIdentity();
  try {
    LockPatternUtils utils=new LockPatternUtils(mContext);
    utils.saveLockPassword(password,quality);
  }
  finally {
    Binder.restoreCallingIdentity(ident);
  }
  return true;
}
