{
  if (mActiveAdmin != null && mActiveAdmin.getUid() == Binder.getCallingUid()) {
    if (who != null) {
      if (!who.getPackageName().equals(mActiveAdmin.info.getActivityInfo().packageName) || !who.getClassName().equals(mActiveAdmin.info.getActivityInfo().name)) {
        throw new SecurityException("Current admin is not " + who);
      }
    }
    if (!mActiveAdmin.info.usesPolicy(reqPolicy)) {
      throw new SecurityException("Admin " + mActiveAdmin.info.getComponent() + " did not specify uses-policy for: "+ mActiveAdmin.info.getTagForPolicy(reqPolicy));
    }
    return mActiveAdmin;
  }
  throw new SecurityException("Current admin is not owned by uid " + Binder.getCallingUid());
}
