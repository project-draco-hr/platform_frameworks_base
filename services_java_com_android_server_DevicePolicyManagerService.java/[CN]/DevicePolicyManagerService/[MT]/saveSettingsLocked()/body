{
  JournaledFile journal=makeJournaledFile();
  FileOutputStream stream=null;
  try {
    stream=new FileOutputStream(journal.chooseForWrite(),false);
    XmlSerializer out=new FastXmlSerializer();
    out.setOutput(stream,"utf-8");
    out.startDocument(null,true);
    out.startTag(null,"policies");
    ActiveAdmin ap=mActiveAdmin;
    if (ap != null) {
      out.startTag(null,"admin");
      out.attribute(null,"name",ap.info.getComponent().flattenToString());
      ap.writeToXml(out);
      out.endTag(null,"admin");
    }
    out.endTag(null,"policies");
    if (mFailedPasswordAttempts != 0) {
      out.startTag(null,"failed-password-attempts");
      out.attribute(null,"value",Integer.toString(mFailedPasswordAttempts));
      out.endTag(null,"failed-password-attempts");
    }
    out.endDocument();
    stream.close();
    journal.commit();
  }
 catch (  IOException e) {
    try {
      if (stream != null) {
        stream.close();
      }
    }
 catch (    IOException ex) {
    }
    journal.rollback();
  }
}
