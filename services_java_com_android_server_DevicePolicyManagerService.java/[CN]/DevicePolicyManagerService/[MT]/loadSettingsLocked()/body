{
  JournaledFile journal=makeJournaledFile();
  FileInputStream stream=null;
  File file=journal.chooseForRead();
  try {
    stream=new FileInputStream(file);
    XmlPullParser parser=Xml.newPullParser();
    parser.setInput(stream,null);
    int type;
    while ((type=parser.next()) != XmlPullParser.END_DOCUMENT && type != XmlPullParser.START_TAG) {
    }
    String tag=parser.getName();
    if (!"policies".equals(tag)) {
      throw new XmlPullParserException("Settings do not start with policies tag: found " + tag);
    }
    type=parser.next();
    int outerDepth=parser.getDepth();
    while ((type=parser.next()) != XmlPullParser.END_DOCUMENT && (type != XmlPullParser.END_TAG || parser.getDepth() > outerDepth)) {
      if (type == XmlPullParser.END_TAG || type == XmlPullParser.TEXT) {
        continue;
      }
      tag=parser.getName();
      if ("admin".equals(tag)) {
        String name=parser.getAttributeValue(null,"name");
        try {
          DeviceAdminInfo dai=findAdmin(ComponentName.unflattenFromString(name));
          if (dai != null) {
            ActiveAdmin ap=new ActiveAdmin(dai);
            ap.readFromXml(parser);
            mAdminMap.put(ap.info.getComponent(),ap);
            mAdminList.add(ap);
          }
        }
 catch (        RuntimeException e) {
          Slog.w(TAG,"Failed loading admin " + name,e);
        }
      }
 else       if ("failed-password-attempts".equals(tag)) {
        mFailedPasswordAttempts=Integer.parseInt(parser.getAttributeValue(null,"value"));
        XmlUtils.skipCurrentTag(parser);
      }
 else       if ("password-owner".equals(tag)) {
        mPasswordOwner=Integer.parseInt(parser.getAttributeValue(null,"value"));
        XmlUtils.skipCurrentTag(parser);
      }
 else       if ("active-password".equals(tag)) {
        mActivePasswordQuality=Integer.parseInt(parser.getAttributeValue(null,"quality"));
        mActivePasswordLength=Integer.parseInt(parser.getAttributeValue(null,"length"));
        mActivePasswordUpperCase=Integer.parseInt(parser.getAttributeValue(null,"uppercase"));
        mActivePasswordLowerCase=Integer.parseInt(parser.getAttributeValue(null,"lowercase"));
        mActivePasswordLetters=Integer.parseInt(parser.getAttributeValue(null,"letters"));
        mActivePasswordNumeric=Integer.parseInt(parser.getAttributeValue(null,"numeric"));
        mActivePasswordSymbols=Integer.parseInt(parser.getAttributeValue(null,"symbols"));
        mActivePasswordNonLetter=Integer.parseInt(parser.getAttributeValue(null,"nonletter"));
        XmlUtils.skipCurrentTag(parser);
      }
 else {
        Slog.w(TAG,"Unknown tag: " + tag);
        XmlUtils.skipCurrentTag(parser);
      }
    }
  }
 catch (  NullPointerException e) {
    Slog.w(TAG,"failed parsing " + file + " "+ e);
  }
catch (  NumberFormatException e) {
    Slog.w(TAG,"failed parsing " + file + " "+ e);
  }
catch (  XmlPullParserException e) {
    Slog.w(TAG,"failed parsing " + file + " "+ e);
  }
catch (  FileNotFoundException e) {
  }
catch (  IOException e) {
    Slog.w(TAG,"failed parsing " + file + " "+ e);
  }
catch (  IndexOutOfBoundsException e) {
    Slog.w(TAG,"failed parsing " + file + " "+ e);
  }
  try {
    if (stream != null) {
      stream.close();
    }
  }
 catch (  IOException e) {
  }
  LockPatternUtils utils=new LockPatternUtils(mContext);
  if (utils.getActivePasswordQuality() < mActivePasswordQuality) {
    Slog.w(TAG,"Active password quality 0x" + Integer.toHexString(mActivePasswordQuality) + " does not match actual quality 0x"+ Integer.toHexString(utils.getActivePasswordQuality()));
    mActivePasswordQuality=DevicePolicyManager.PASSWORD_QUALITY_UNSPECIFIED;
    mActivePasswordLength=0;
    mActivePasswordUpperCase=0;
    mActivePasswordLowerCase=0;
    mActivePasswordLetters=0;
    mActivePasswordNumeric=0;
    mActivePasswordSymbols=0;
    mActivePasswordNonLetter=0;
  }
  validatePasswordOwnerLocked();
  syncDeviceCapabilitiesLocked();
  long timeMs=getMaximumTimeToLock(null);
  if (timeMs <= 0) {
    timeMs=Integer.MAX_VALUE;
  }
  try {
    getIPowerManager().setMaximumScreenOffTimeount((int)timeMs);
  }
 catch (  RemoteException e) {
    Slog.w(TAG,"Failure talking with power manager",e);
  }
}
