{
synchronized (this) {
    if (who == null) {
      throw new NullPointerException("ComponentName is null");
    }
    ActiveAdmin ap=getActiveAdminForCallerLocked(who,DeviceAdminInfo.USES_ENCRYPTED_STORAGE);
    if (!isEncryptionSupported()) {
      return DevicePolicyManager.ENCRYPTION_STATUS_UNSUPPORTED;
    }
    if (ap.encryptionRequested != encrypt) {
      ap.encryptionRequested=encrypt;
      saveSettingsLocked();
    }
    boolean newRequested=false;
    final int N=mAdminList.size();
    for (int i=0; i < N; i++) {
      newRequested|=mAdminList.get(i).encryptionRequested;
    }
    setEncryptionRequested(newRequested);
    return newRequested ? DevicePolicyManager.ENCRYPTION_STATUS_ACTIVE : DevicePolicyManager.ENCRYPTION_STATUS_INACTIVE;
  }
}
