{
  mContext.enforceCallingOrSelfPermission(android.Manifest.permission.BIND_DEVICE_ADMIN,null);
  DeviceAdminInfo info=findAdmin(adminReceiver);
  if (info == null) {
    throw new IllegalArgumentException("Bad admin: " + adminReceiver);
  }
synchronized (this) {
    long ident=Binder.clearCallingIdentity();
    try {
      ComponentName cur=getActiveAdminLocked();
      if (cur != null && cur.equals(adminReceiver)) {
        throw new IllegalStateException("An admin is already set");
      }
      if (cur != null) {
        removeActiveAdminLocked(adminReceiver);
      }
      mActiveAdmin=new ActiveAdmin(info);
      saveSettingsLocked();
      sendAdminCommandLocked(mActiveAdmin,DeviceAdmin.ACTION_DEVICE_ADMIN_ENABLED);
    }
  finally {
      Binder.restoreCallingIdentity(ident);
    }
  }
}
