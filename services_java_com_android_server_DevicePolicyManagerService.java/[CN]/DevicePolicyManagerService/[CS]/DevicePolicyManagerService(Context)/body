{
  mContext=context;
  mHasFeature=context.getPackageManager().hasSystemFeature(PackageManager.FEATURE_DEVICE_ADMIN);
  mWakeLock=((PowerManager)context.getSystemService(Context.POWER_SERVICE)).newWakeLock(PowerManager.PARTIAL_WAKE_LOCK,"DPM");
  if (!mHasFeature) {
    return;
  }
  IntentFilter filter=new IntentFilter();
  filter.addAction(Intent.ACTION_BOOT_COMPLETED);
  filter.addAction(ACTION_EXPIRED_PASSWORD_NOTIFICATION);
  filter.addAction(Intent.ACTION_USER_REMOVED);
  filter.addAction(Intent.ACTION_USER_STARTED);
  filter.addAction(KeyChain.ACTION_STORAGE_CHANGED);
  context.registerReceiverAsUser(mReceiver,UserHandle.ALL,filter,null,mHandler);
  filter=new IntentFilter();
  filter.addAction(Intent.ACTION_PACKAGE_CHANGED);
  filter.addAction(Intent.ACTION_PACKAGE_REMOVED);
  filter.addAction(Intent.ACTION_EXTERNAL_APPLICATIONS_UNAVAILABLE);
  filter.addAction(Intent.ACTION_PACKAGE_ADDED);
  filter.addDataScheme("package");
  context.registerReceiverAsUser(mReceiver,UserHandle.ALL,filter,null,mHandler);
}
