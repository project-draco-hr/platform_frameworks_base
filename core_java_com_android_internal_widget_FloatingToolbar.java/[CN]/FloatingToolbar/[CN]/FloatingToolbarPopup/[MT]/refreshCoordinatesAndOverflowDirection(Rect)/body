{
  int x=contentRect.centerX() - getWidth() / 2;
  int y;
  if (contentRect.top - getHeight() > mViewPort.top) {
    y=contentRect.top - getHeight();
    mOverflowDirection=FloatingToolbarPopup.OVERFLOW_DIRECTION_UP;
  }
 else   if (contentRect.top - getToolbarHeightWithVerticalMargin() > mViewPort.top) {
    y=contentRect.top - getToolbarHeightWithVerticalMargin();
    mOverflowDirection=FloatingToolbarPopup.OVERFLOW_DIRECTION_DOWN;
  }
 else {
    y=contentRect.bottom;
    mOverflowDirection=FloatingToolbarPopup.OVERFLOW_DIRECTION_DOWN;
  }
  x=Math.max(0,Math.min(x,mViewPort.right - getWidth()));
  mCoords.set(x,y);
  if (mOverflowPanel != null) {
    mOverflowPanel.setOverflowDirection(mOverflowDirection);
  }
}
