{
  if (hasOverflow()) {
    final int maxItemSize=(suggestedHeight - mOverflowButtonSize.getHeight()) / getLineHeight(mContext);
    final int newHeight=calculateOverflowHeight(maxItemSize);
    if (mOverflowPanelSize.getHeight() != newHeight) {
      mOverflowPanelSize=new Size(mOverflowPanelSize.getWidth(),newHeight);
    }
    setSize(mOverflowPanel,mOverflowPanelSize);
    if (mIsOverflowOpen) {
      setSize(mContentContainer,mOverflowPanelSize);
      if (mOpenOverflowUpwards) {
        final int deltaHeight=mOverflowPanelSize.getHeight() - newHeight;
        mContentContainer.setY(mContentContainer.getY() + deltaHeight);
        mOverflowButton.setY(mOverflowButton.getY() - deltaHeight);
      }
    }
 else {
      setSize(mContentContainer,mMainPanelSize);
    }
    updatePopupSize();
  }
}
