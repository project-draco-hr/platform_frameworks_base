{
  Preconditions.checkNotNull(menuItems);
  mContentContainer.removeAllViews();
  if (mMainPanel == null) {
    mMainPanel=new FloatingToolbarMainPanel(mParent.getContext(),mOpenOverflow);
  }
  List<MenuItem> overflowMenuItems=mMainPanel.layoutMenuItems(menuItems,getToolbarWidth(suggestedWidth));
  mMainPanel.setOnMenuItemClickListener(menuItemClickListener);
  if (!overflowMenuItems.isEmpty()) {
    if (mOverflowPanel == null) {
      mOverflowPanel=new FloatingToolbarOverflowPanel(mParent.getContext(),mCloseOverflow);
    }
    mOverflowPanel.setMenuItems(overflowMenuItems);
    mOverflowPanel.setOnMenuItemClickListener(menuItemClickListener);
  }
  updatePopupSize();
}
