{
  if ((flags & PackageManager.INSTALL_EXTERNAL) != 0) {
    return INSTALL_LOC_SD;
  }
 else   if ((flags & PackageManager.INSTALL_INTERNAL) != 0) {
    return INSTALL_LOC_INT;
  }
  if (expInstallLocation == PackageInfo.INSTALL_LOCATION_PREFER_EXTERNAL) {
    if (checkSd(pkgLen)) {
      return INSTALL_LOC_SD;
    }
    if (checkInt(pkgLen)) {
      return INSTALL_LOC_INT;
    }
    return INSTALL_LOC_ERR;
  }
  if (expInstallLocation == PackageInfo.INSTALL_LOCATION_INTERNAL_ONLY) {
    if (checkInt(pkgLen)) {
      return INSTALL_LOC_INT;
    }
    return INSTALL_LOC_ERR;
  }
  if (expInstallLocation == PackageInfo.INSTALL_LOCATION_AUTO) {
    if (checkInt(pkgLen)) {
      return INSTALL_LOC_INT;
    }
    if (checkSd(pkgLen)) {
      return INSTALL_LOC_SD;
    }
    return INSTALL_LOC_ERR;
  }
  boolean checkSd=false;
  int userPref=getDefaultInstallLoc();
  if (userPref == APP_INSTALL_DEVICE) {
    if (checkInt(pkgLen)) {
      return INSTALL_LOC_INT;
    }
    return INSTALL_LOC_ERR;
  }
 else   if (userPref == APP_INSTALL_SDCARD) {
    if (checkSd(pkgLen)) {
      return INSTALL_LOC_SD;
    }
    return INSTALL_LOC_ERR;
  }
  if (checkInt(pkgLen)) {
    return INSTALL_LOC_INT;
  }
  return INSTALL_LOC_ERR;
}
