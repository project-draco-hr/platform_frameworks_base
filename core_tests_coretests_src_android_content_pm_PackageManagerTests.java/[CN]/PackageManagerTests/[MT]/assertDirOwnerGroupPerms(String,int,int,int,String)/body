{
  final StructStat stat;
  try {
    stat=Libcore.os.lstat(path);
  }
 catch (  ErrnoException e) {
    throw new AssertionError(reason + "\n" + "Got: "+ path+ " does not exist");
  }
  StringBuilder sb=new StringBuilder();
  if (!S_ISDIR(stat.st_mode)) {
    sb.append("\nExpected type: ");
    sb.append(S_IFDIR);
    sb.append("\ngot type: ");
    sb.append((stat.st_mode & S_IFMT));
  }
  if (stat.st_uid != uid) {
    sb.append("\nExpected owner: ");
    sb.append(uid);
    sb.append("\nGot owner: ");
    sb.append(stat.st_uid);
  }
  if (stat.st_gid != gid) {
    sb.append("\nExpected group: ");
    sb.append(gid);
    sb.append("\nGot group: ");
    sb.append(stat.st_gid);
  }
  if ((stat.st_mode & ~S_IFMT) != perms) {
    sb.append("\nExpected permissions: ");
    sb.append(Integer.toOctalString(perms));
    sb.append("\nGot permissions: ");
    sb.append(Integer.toOctalString(stat.st_mode & ~S_IFMT));
  }
  if (sb.length() > 0) {
    throw new AssertionError(reason + sb.toString());
  }
}
