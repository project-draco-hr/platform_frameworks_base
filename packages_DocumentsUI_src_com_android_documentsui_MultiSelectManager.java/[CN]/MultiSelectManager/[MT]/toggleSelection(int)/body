{
  if (position == RecyclerView.NO_POSITION) {
    if (DEBUG)     Log.d(TAG,"Ignoring toggle for element with no position.");
    return;
  }
  boolean changed=false;
  if (mSelection.contains(position)) {
    changed=attemptDeselect(position);
  }
 else {
    boolean canSelect=notifyBeforeItemStateChange(position,true);
    if (!canSelect) {
      return;
    }
    if (mSingleSelect && !mSelection.isEmpty()) {
      clearSelectionQuietly();
    }
    selectAndNotify(position);
    setSelectionFocusBegin(position);
    changed=true;
  }
  if (changed) {
    notifySelectionChanged();
  }
}
