{
  super.onMeasure(widthMeasureSpec,heightMeasureSpec);
  int nonTabHeight=0;
  final int count=getChildCount();
  for (int i=0; i < count; i++) {
    final View child=getChildAt(i);
    if (child == mTabContainer)     continue;
    final LayoutParams lp=(LayoutParams)child.getLayoutParams();
    nonTabHeight=Math.max(nonTabHeight,child.getMeasuredHeight() + lp.topMargin + lp.bottomMargin);
  }
  if (mTabContainer != null && mTabContainer.getVisibility() != GONE) {
    final int mode=MeasureSpec.getMode(heightMeasureSpec);
    if (mode == MeasureSpec.AT_MOST) {
      final int maxHeight=MeasureSpec.getSize(heightMeasureSpec);
      setMeasuredDimension(getMeasuredWidth(),Math.min(nonTabHeight + mTabContainer.getMeasuredHeight(),maxHeight));
    }
  }
}
