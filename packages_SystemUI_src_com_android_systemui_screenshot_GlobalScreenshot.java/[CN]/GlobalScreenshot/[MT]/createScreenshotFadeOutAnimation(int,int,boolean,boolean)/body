{
  ValueAnimator anim=ValueAnimator.ofFloat(0f,1f);
  anim.setInterpolator(new DecelerateInterpolator(0.5f));
  anim.setStartDelay(SCREENSHOT_FADE_OUT_DELAY);
  anim.addListener(new AnimatorListenerAdapter(){
    @Override public void onAnimationEnd(    Animator animation){
      mBackgroundView.setVisibility(View.GONE);
      mScreenshotContainerView.setVisibility(View.GONE);
      mScreenshotContainerView.setLayerType(View.LAYER_TYPE_NONE,null);
    }
  }
);
  if (!statusBarVisible || !navBarVisible) {
    anim.setDuration(SCREENSHOT_FAST_FADE_OUT_DURATION);
    anim.addUpdateListener(new AnimatorUpdateListener(){
      @Override public void onAnimationUpdate(      ValueAnimator animation){
        float t=((Float)animation.getAnimatedValue()).floatValue();
        float scaleT=(SCREENSHOT_FADE_OUT_MIN_SCALE) + (float)(1f - t) * (SCREENSHOT_SCALE - SCREENSHOT_FADE_OUT_MIN_SCALE);
        mBackgroundView.setAlpha((1f - t) * BACKGROUND_ALPHA);
        mScreenshotContainerView.setAlpha((1f - t) * BACKGROUND_ALPHA);
        mScreenshotContainerView.setScaleX(scaleT);
        mScreenshotContainerView.setScaleY(scaleT);
      }
    }
);
  }
 else {
    float halfScreenWidth=(w - 2f * mBgPadding) / 2f;
    float halfScreenHeight=(h - 2f * mBgPadding) / 2f;
    final RectF finalBounds=new RectF(mDropOffsetX,mDropOffsetY,mDropOffsetX + mStatusBarIconSize,mDropOffsetY + mStatusBarIconSize);
    final PointF currentPos=new PointF(0f,0f);
    final PointF finalPos=new PointF(-halfScreenWidth + finalBounds.centerX(),-halfScreenHeight + finalBounds.centerY());
    final DecelerateInterpolator d=new DecelerateInterpolator(2f);
    float tmpMinScale=0f;
    if (w > h) {
      tmpMinScale=finalBounds.width() / (2f * w);
    }
 else {
      tmpMinScale=finalBounds.height() / (2f * h);
    }
    final float minScale=tmpMinScale;
    anim.setDuration(SCREENSHOT_FADE_OUT_DURATION);
    anim.addUpdateListener(new AnimatorUpdateListener(){
      @Override public void onAnimationUpdate(      ValueAnimator animation){
        float t=((Float)animation.getAnimatedValue()).floatValue();
        float scaleT=minScale + (float)(1f - t) * (SCREENSHOT_SCALE - minScale - mBgPaddingScale) + mBgPaddingScale;
        mScreenshotContainerView.setAlpha(d.getInterpolation(1f - t));
        mScreenshotContainerView.setTranslationX(d.getInterpolation(t) * finalPos.x);
        mScreenshotContainerView.setTranslationY(d.getInterpolation(t) * finalPos.y);
        mScreenshotContainerView.setScaleX(scaleT);
        mScreenshotContainerView.setScaleY(scaleT);
        mBackgroundView.setAlpha((1f - t) * BACKGROUND_ALPHA);
      }
    }
);
  }
  return anim;
}
