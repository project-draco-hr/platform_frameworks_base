{
  if (DEBUG)   Slog.d(TAG,"Performing write to " + mFile.getBaseFile());
  Parcel data;
  AtomicFile file;
synchronized (mPendingWriteLock) {
    data=mPendingWrite;
    file=mPendingWriteFile;
    mPendingWriteCommitted=false;
    if (data == null) {
      return;
    }
    mPendingWrite=null;
    mPendingWriteFile=null;
    mWriteLock.lock();
  }
  FileOutputStream stream=null;
  try {
    stream=file.startWrite();
    stream.write(data.marshall());
    stream.flush();
    file.finishWrite(stream);
    if (DEBUG)     Slog.d(TAG,"Write completed successfully!");
  }
 catch (  IOException e) {
    Slog.w(TAG,"Error writing process statistics",e);
    file.failWrite(stream);
  }
 finally {
    data.recycle();
    trimHistoricStatesWriteLocked();
    mWriteLock.unlock();
  }
}
