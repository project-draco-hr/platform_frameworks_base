{
  mCurrentScrollState=mNewState;
  if (Log.isLoggable(TAG,Log.DEBUG)) {
    Log.d(TAG,"new scroll state: " + mNewState + " old state: "+ mPreviousScrollState);
  }
  if (mNewState == OnScrollListener.SCROLL_STATE_IDLE && mPreviousScrollState != OnScrollListener.SCROLL_STATE_IDLE && mPreviousScrollState != OnScrollListener.SCROLL_STATE_TOUCH_SCROLL) {
    mPreviousScrollState=mNewState;
    int i=0;
    View child=getChildAt(i);
    while (child != null && child.getBottom() <= 0) {
      child=getChildAt(++i);
    }
    if (child == null) {
      return;
    }
    int firstPosition=getFirstVisiblePosition();
    int lastPosition=getLastVisiblePosition();
    boolean scroll=firstPosition != 0 && lastPosition != getCount() - 1;
    final int top=child.getTop();
    final int bottom=child.getBottom();
    final int midpoint=getHeight() / 2;
    if (scroll && top < LIST_TOP_OFFSET) {
      if (bottom > midpoint) {
        smoothScrollBy(top,GOTO_SCROLL_DURATION);
      }
 else {
        smoothScrollBy(bottom,GOTO_SCROLL_DURATION);
      }
    }
  }
 else {
    mPreviousScrollState=mNewState;
  }
}
