{
  if (mExpectedLifecycle == null)   return;
  if (mNextLifecycle >= mExpectedLifecycle.length) {
    finishBad("Activity lifecycle incorrect: received " + where + " but don't expect any more calls");
    mExpectedLifecycle=null;
    return;
  }
  if (!mExpectedLifecycle[mNextLifecycle].equals(where)) {
    finishBad("Activity lifecycle incorrect: received " + where + " but expected "+ mExpectedLifecycle[mNextLifecycle]+ " at "+ mNextLifecycle);
    mExpectedLifecycle=null;
    return;
  }
  mNextLifecycle++;
  if (mNextLifecycle >= mExpectedLifecycle.length) {
    setTestResult(RESULT_OK,null);
    return;
  }
  String next=mExpectedLifecycle[mNextLifecycle];
  if (where.equals(ON_DESTROY)) {
    finishBad("Activity lifecycle incorrect: received " + where + " but expected more actions (next is "+ next+ ")");
    mExpectedLifecycle=null;
    return;
  }
 else   if (next.equals(DO_FINISH)) {
    mNextLifecycle++;
    if (mNextLifecycle >= mExpectedLifecycle.length) {
      setTestResult(RESULT_OK,null);
    }
    if (!isFinishing()) {
      finish();
    }
  }
 else   if (next.equals(DO_LOCAL_SCREEN)) {
    mNextLifecycle++;
    Intent intent=new Intent(TestedScreen.WAIT_BEFORE_FINISH);
    intent.setClass(this,LocalScreen.class);
    startActivity(intent);
  }
 else   if (next.equals(DO_LOCAL_DIALOG)) {
    mNextLifecycle++;
    Intent intent=new Intent(TestedScreen.WAIT_BEFORE_FINISH);
    intent.setClass(this,LocalDialog.class);
    startActivity(intent);
  }
}
