{
switch (msg.what) {
case AsyncChannel.CMD_CHANNEL_HALF_CONNECTED:
    if (msg.arg1 == AsyncChannel.STATUS_SUCCESSFUL) {
      sAsyncChannel.sendMessage(AsyncChannel.CMD_CHANNEL_FULL_CONNECTION);
    }
 else {
      Log.e(TAG,"Failed to set up channel connection");
      sAsyncChannel=null;
    }
  sConnected.countDown();
return;
case AsyncChannel.CMD_CHANNEL_FULLY_CONNECTED:
return;
case AsyncChannel.CMD_CHANNEL_DISCONNECTED:
Log.e(TAG,"Channel connection lost");
sAsyncChannel=null;
getLooper().quit();
return;
}
Object listener=getListener(msg.arg2);
if (DBG) Log.d(TAG,"listener key = " + msg.arg2);
switch (msg.what) {
case CMD_OP_SUCCEEDED:
((ActionListener)listener).onSuccess(msg.obj);
break;
case CMD_OP_FAILED:
((ActionListener)listener).onFailure(msg.arg1,msg.obj);
break;
case CMD_SCAN_RESULT:
((ScanListener)listener).onResults(((ParcelableScanResults)msg.obj).getResults());
return;
case CMD_FULL_SCAN_RESULT:
FullScanResult result=(FullScanResult)msg.obj;
((ScanListener)listener).onFullResult(result);
return;
case CMD_AP_FOUND:
((HotlistListener)listener).onFound(((ParcelableScanResults)msg.obj).getResults());
return;
case CMD_WIFI_CHANGE_DETECTED:
((SignificantWifiChangeListener)listener).onChanging(((ParcelableScanResults)msg.obj).getResults());
return;
case CMD_WIFI_CHANGES_STABILIZED:
((SignificantWifiChangeListener)listener).onQuiescence(((ParcelableScanResults)msg.obj).getResults());
return;
default :
if (DBG) Log.d(TAG,"Ignoring message " + msg.what);
return;
}
}
