{
  if (inputLength > 0) {
    mInputBuffer.write(input,inputOffset,inputLength);
  }
  byte[] bufferedInput=mInputBuffer.toByteArray();
  mInputBuffer.reset();
  byte[] paddedInput;
  if (bufferedInput.length < mModulusSizeBytes) {
    paddedInput=new byte[mModulusSizeBytes];
    System.arraycopy(bufferedInput,0,paddedInput,paddedInput.length - bufferedInput.length,bufferedInput.length);
  }
 else {
    paddedInput=bufferedInput;
  }
  return mDelegate.doFinal(paddedInput,0,paddedInput.length);
}
