{
  ArrayList<SharedElementOriginalState> originalImageState=new ArrayList<SharedElementOriginalState>();
  if (sharedElementState != null) {
    int[] tempLoc=new int[2];
    for (int i=0; i < mSharedElementNames.size(); i++) {
      View sharedElement=mSharedElements.get(i);
      String name=mSharedElementNames.get(i);
      SharedElementOriginalState originalState=getOldSharedElementState(sharedElement,name,sharedElementState);
      originalImageState.add(originalState);
      View parent=(View)sharedElement.getParent();
      parent.getLocationOnScreen(tempLoc);
      setSharedElementState(sharedElement,name,sharedElementState,tempLoc);
    }
  }
  mListener.setSharedElementStart(mSharedElementNames,mSharedElements,snapshots);
  getDecor().getViewTreeObserver().addOnPreDrawListener(new ViewTreeObserver.OnPreDrawListener(){
    @Override public boolean onPreDraw(){
      getDecor().getViewTreeObserver().removeOnPreDrawListener(this);
      mListener.setSharedElementEnd(mSharedElementNames,mSharedElements,snapshots);
      return true;
    }
  }
);
  return originalImageState;
}
