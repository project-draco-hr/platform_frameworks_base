{
  View actionView=item.getActionView();
  if (actionView == null || item.hasCollapsibleActionView()) {
    actionView=super.getItemView(item,null,parent);
  }
  actionView.setVisibility(item.isActionViewExpanded() ? View.GONE : View.VISIBLE);
  if (item.hasSubMenu()) {
    actionView.setOnTouchListener(new ForwardingListener(actionView){
      @Override public ListPopupWindow getPopup(){
        return mActionButtonPopup != null ? mActionButtonPopup.getPopup() : null;
      }
      @Override protected boolean onForwardingStarted(){
        return onSubMenuSelected((SubMenuBuilder)item.getSubMenu());
      }
      @Override protected boolean onForwardingStopped(){
        return dismissPopupMenus();
      }
    }
);
  }
 else {
    actionView.setOnTouchListener(null);
  }
  final ActionMenuView menuParent=(ActionMenuView)parent;
  final ViewGroup.LayoutParams lp=actionView.getLayoutParams();
  if (!menuParent.checkLayoutParams(lp)) {
    actionView.setLayoutParams(menuParent.generateLayoutParams(lp));
  }
  return actionView;
}
