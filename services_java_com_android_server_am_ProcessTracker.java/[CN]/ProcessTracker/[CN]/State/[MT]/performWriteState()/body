{
  if (DEBUG)   Slog.d(TAG,"Performing write to " + mFile.getBaseFile());
  Parcel data;
synchronized (mPendingWriteLock) {
    data=mPendingWrite;
    mPendingWriteCommitted=false;
    if (data == null) {
      return;
    }
    mPendingWrite=null;
    if (mProcessTracker != null) {
      mProcessTracker.mWriteLock.lock();
    }
  }
  FileOutputStream stream=null;
  try {
    stream=mFile.startWrite();
    stream.write(data.marshall());
    stream.flush();
    mFile.finishWrite(stream);
    if (DEBUG)     Slog.d(TAG,"Write completed successfully!");
  }
 catch (  IOException e) {
    Slog.w(TAG,"Error writing process statistics",e);
    mFile.failWrite(stream);
  }
 finally {
    data.recycle();
    if (mProcessTracker != null) {
      mProcessTracker.trimHistoricStatesWriteLocked();
      mProcessTracker.mWriteLock.unlock();
    }
  }
}
