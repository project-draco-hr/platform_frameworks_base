{
  Intent intent=new Intent();
  intent.setAction(Intent.ACTION_RUN);
  intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
  intent.addFlags(Intent.FLAG_ACTIVITY_MULTIPLE_TASK);
  String packageName=getDefaultPackageNameForTestRunner();
  String className="";
  String testName="";
  if (shouldAllTestsBeRun(position)) {
    testName=mTestSuite.getName();
    className=TEST_RUNNER_ACTIVITY_CLASS_NAME;
  }
 else {
    Test test=TestCaseUtil.getTestAtIndex(mTestSuite,position - 1);
    if (TestSuite.class.isAssignableFrom(test.getClass())) {
      TestSuite testSuite=(TestSuite)test;
      testName=testSuite.getName();
      className=mTargetBrowserActivityClassName;
      packageName=mTargetPackageName;
    }
 else     if (TestCase.class.isAssignableFrom(test.getClass())) {
      TestCase testCase=(TestCase)test;
      testName=testCase.getClass().getName();
      className=TEST_RUNNER_ACTIVITY_CLASS_NAME;
      String testMethodName=testCase.getName();
      intent.putExtra(BUNDLE_EXTRA_TEST_METHOD_NAME,testMethodName);
    }
  }
  intent.setClassName(packageName,className);
  intent.setData(Uri.parse(testName));
  return intent;
}
