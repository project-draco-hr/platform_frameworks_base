{
synchronized (mDeviceConnections) {
    mDeviceConnections.remove(connection);
    if (mDeviceConnections.size() == 0 && mServiceConnection != null) {
      mContext.unbindService(mServiceConnection);
      mServiceConnection=null;
      if (mBluetoothDevice != null) {
synchronized (mDevicesByInfo) {
          closeLocked();
        }
      }
 else {
        setDeviceServer(null);
      }
    }
  }
}
