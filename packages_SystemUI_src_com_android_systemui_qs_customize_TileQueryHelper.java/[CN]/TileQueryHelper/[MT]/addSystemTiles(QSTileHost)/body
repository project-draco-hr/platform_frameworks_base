{
  boolean hasColorMod=host.getNightModeController().isEnabled();
  String possible=mContext.getString(R.string.quick_settings_tiles_default) + ",hotspot,inversion,saver,work,cast" + (hasColorMod ? ",night" : "");
  String[] possibleTiles=possible.split(",");
  final Handler qsHandler=new Handler(host.getLooper());
  final Handler mainHandler=new Handler(Looper.getMainLooper());
  for (int i=0; i < possibleTiles.length; i++) {
    final String spec=possibleTiles[i];
    final QSTile<?> tile=host.createTile(spec);
    if (tile == null || !tile.isAvailable()) {
      continue;
    }
    tile.setListening(true);
    tile.clearState();
    tile.refreshState();
    tile.setListening(false);
    qsHandler.post(new Runnable(){
      @Override public void run(){
        final QSTile.State state=tile.newTileState();
        tile.getState().copyTo(state);
        mainHandler.post(new Runnable(){
          @Override public void run(){
            addTile(spec,state);
            mListener.onTilesChanged(mTiles);
          }
        }
);
      }
    }
);
  }
  qsHandler.post(new Runnable(){
    @Override public void run(){
      new QueryTilesTask().execute();
    }
  }
);
}
