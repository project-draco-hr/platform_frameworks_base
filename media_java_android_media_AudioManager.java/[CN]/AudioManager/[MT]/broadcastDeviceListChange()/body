{
  int status;
  ArrayList<AudioDevicePort> previous_ports=new ArrayList<AudioDevicePort>();
  status=AudioManager.listPreviousAudioDevicePorts(previous_ports);
  if (status != AudioManager.SUCCESS) {
    return;
  }
  ArrayList<AudioDevicePort> current_ports=new ArrayList<AudioDevicePort>();
  status=AudioManager.listAudioDevicePorts(current_ports);
  if (status != AudioManager.SUCCESS) {
    return;
  }
  AudioDeviceInfo[] added_devices=calcListDeltas(previous_ports,current_ports,GET_DEVICES_ALL);
  AudioDeviceInfo[] removed_devices=calcListDeltas(current_ports,previous_ports,GET_DEVICES_ALL);
  if (added_devices.length != 0 || removed_devices.length != 0) {
    Collection<NativeEventHandlerDelegate> values;
synchronized (mDeviceCallbacks) {
      values=mDeviceCallbacks.values();
    }
    for (    NativeEventHandlerDelegate delegate : values) {
      Handler handler=delegate.getHandler();
      if (handler != null) {
        if (added_devices.length != 0) {
          handler.sendMessage(Message.obtain(handler,MSG_DEVICES_DEVICES_ADDED,added_devices));
        }
        if (removed_devices.length != 0) {
          handler.sendMessage(Message.obtain(handler,MSG_DEVICES_DEVICES_REMOVED,removed_devices));
        }
      }
    }
  }
}
