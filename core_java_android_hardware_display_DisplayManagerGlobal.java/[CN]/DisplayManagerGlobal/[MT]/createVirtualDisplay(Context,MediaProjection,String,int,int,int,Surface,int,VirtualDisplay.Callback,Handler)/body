{
  if (TextUtils.isEmpty(name)) {
    throw new IllegalArgumentException("name must be non-null and non-empty");
  }
  if (width <= 0 || height <= 0 || densityDpi <= 0) {
    throw new IllegalArgumentException("width, height, and densityDpi must be " + "greater than 0");
  }
  VirtualDisplayCallback callbackWrapper=new VirtualDisplayCallback(callback,handler);
  IMediaProjection projectionToken=projection != null ? projection.getProjection() : null;
  int displayId;
  try {
    displayId=mDm.createVirtualDisplay(callbackWrapper,projectionToken,context.getPackageName(),name,width,height,densityDpi,surface,flags);
  }
 catch (  RemoteException ex) {
    throw ex.rethrowFromSystemServer();
  }
  if (displayId < 0) {
    Log.e(TAG,"Could not create virtual display: " + name);
    return null;
  }
  Display display=getRealDisplay(displayId);
  if (display == null) {
    Log.wtf(TAG,"Could not obtain display info for newly created " + "virtual display: " + name);
    try {
      mDm.releaseVirtualDisplay(callbackWrapper);
    }
 catch (    RemoteException ex) {
      throw ex.rethrowFromSystemServer();
    }
    return null;
  }
  return new VirtualDisplay(this,display,callbackWrapper,surface);
}
