{
  if (nativeBitmap == 0) {
    throw new RuntimeException("internal error: native bitmap is 0");
  }
  mWidth=width;
  mHeight=height;
  mIsMutable=isMutable;
  mRequestPremultiplied=requestPremultiplied;
  mBuffer=buffer;
  mNinePatchChunk=ninePatchChunk;
  mNinePatchInsets=ninePatchInsets;
  if (density >= 0) {
    mDensity=density;
  }
  mNativePtr=nativeBitmap;
  long nativeSize=NATIVE_ALLOCATION_SIZE;
  if (buffer == null) {
    nativeSize+=getByteCount();
  }
  NativeAllocationRegistry registry=new NativeAllocationRegistry(Bitmap.class.getClassLoader(),nativeGetNativeFinalizer(),nativeSize);
  registry.registerNativeAllocation(this,nativeBitmap);
}
