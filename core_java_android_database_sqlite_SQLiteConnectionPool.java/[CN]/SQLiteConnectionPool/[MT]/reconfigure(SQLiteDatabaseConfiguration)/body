{
  if (configuration == null) {
    throw new IllegalArgumentException("configuration must not be null.");
  }
synchronized (mLock) {
    throwIfClosedLocked();
    if (mConfiguration.openFlags != configuration.openFlags) {
      SQLiteConnection newPrimaryConnection=openConnectionLocked(configuration,true);
      closeAvailableConnectionsAndLogExceptionsLocked();
      discardAcquiredConnectionsLocked();
      mAvailablePrimaryConnection=newPrimaryConnection;
      mConfiguration.updateParametersFrom(configuration);
    }
 else {
      mConfiguration.updateParametersFrom(configuration);
      closeExcessConnectionsAndLogExceptionsLocked();
      reconfigureAllConnectionsLocked();
    }
    wakeConnectionWaitersLocked();
  }
}
