{
  final boolean result=super.onTouchEvent(ev);
switch (ev.getActionMasked()) {
case MotionEvent.ACTION_DOWN:
    mDownPositionX=ev.getRawX();
  mDownPositionY=ev.getRawY();
break;
case MotionEvent.ACTION_UP:
final float deltaX=mDownPositionX - ev.getRawX();
final float deltaY=mDownPositionY - ev.getRawY();
final float distanceSquared=deltaX * deltaX + deltaY * deltaY;
if (distanceSquared < mSquaredTouchSlopDistance) {
if (mActionPopupWindow != null && mActionPopupWindow.isShowing()) {
mActionPopupWindow.hide();
}
 else {
show(0);
}
}
hideAfterDelay();
break;
case MotionEvent.ACTION_CANCEL:
hideAfterDelay();
break;
default :
break;
}
return result;
}
