{
  if (isFocused() && isTextEditable() && mIsVisible) {
switch (event.getActionMasked()) {
case MotionEvent.ACTION_DOWN:
{
        final float x=event.getX();
        final float y=event.getY();
        if (mHandle.hasFingerOn(x,y)) {
          show();
          if (mMovement instanceof ArrowKeyMovementMethod) {
            ((ArrowKeyMovementMethod)mMovement).setCursorController(this);
          }
          if (mParent != null) {
            mParent.requestDisallowInterceptTouchEvent(true);
          }
          final Rect bounds=mHandle.mDrawable.getBounds();
          mOffsetX=(bounds.left + bounds.right) / 2.0f - x;
          mOffsetY=mHandle.mHotSpotVerticalPosition - y;
          mOnDownTimerStart=event.getEventTime();
        }
        break;
      }
case MotionEvent.ACTION_UP:
{
      int time=(int)(event.getEventTime() - mOnDownTimerStart);
      if (time <= ViewConfiguration.getTapTimeout()) {
        int offset=getOffset((int)event.getX(),(int)event.getY());
        Selection.setSelection((Spannable)mText,offset);
        mScrolled=false;
      }
      break;
    }
}
}
}
