{
  if (isFocused() && isTextEditable() && mIsVisible) {
switch (event.getActionMasked()) {
case MotionEvent.ACTION_DOWN:
{
        final float x=event.getX();
        final float y=event.getY();
        if (fingerIsOnDrawable(x,y,mDrawable)) {
          show();
          if (mMovement instanceof ArrowKeyMovementMethod) {
            ((ArrowKeyMovementMethod)mMovement).setCursorController(this);
          }
          if (mParent != null) {
            mParent.requestDisallowInterceptTouchEvent(true);
            final Rect bounds=mDrawable.getBounds();
            mOffsetX=(bounds.left + bounds.right) / 2.0f - x;
            mOffsetY=bounds.top - mCursorControllerVerticalOffset - y;
            mOnDownTimerStart=System.currentTimeMillis();
          }
        }
        break;
      }
case MotionEvent.ACTION_UP:
{
      int time=(int)(System.currentTimeMillis() - mOnDownTimerStart);
      if (time <= ViewConfiguration.getTapTimeout()) {
        int offset=getOffset((int)event.getX(),(int)event.getY());
        Selection.setSelection((Spannable)mText,offset);
        mScrolled=false;
      }
      break;
    }
}
}
}
