{
switch (ev.getActionMasked()) {
case MotionEvent.ACTION_DOWN:
    mOffsetX=(int)(ev.getX() - mDrawable.getIntrinsicWidth() / 2.f + 0.5f);
  mOffsetY=(int)(ev.getY() - mDrawable.getIntrinsicHeight() / 2.f + 0.5f);
mIsDragging=true;
break;
case MotionEvent.ACTION_MOVE:
final float rawX=ev.getRawX();
final float rawY=ev.getRawY();
final int[] coords=mTempCoords;
TextView.this.getLocationOnScreen(coords);
final int x=(int)(rawX - coords[0] + 0.5f) - mOffsetX;
final int y=(int)(rawY - coords[1] + 0.5f) - (int)(mDrawable.getIntrinsicHeight() * 0.8f) - mOffsetY;
mController.updatePosition(this,x,y);
break;
case MotionEvent.ACTION_UP:
case MotionEvent.ACTION_CANCEL:
mIsDragging=false;
}
return true;
}
