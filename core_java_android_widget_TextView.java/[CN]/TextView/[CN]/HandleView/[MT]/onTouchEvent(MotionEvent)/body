{
switch (ev.getActionMasked()) {
case MotionEvent.ACTION_DOWN:
{
      final float rawX=ev.getRawX();
      final float rawY=ev.getRawY();
      mOffsetX=rawX - mPositionX;
      mOffsetY=rawY - mPositionY;
      final int[] coords=mTempCoords;
      TextView.this.getLocationInWindow(coords);
      mLastParentX=coords[0];
      mLastParentY=coords[1];
      mIsDragging=true;
      break;
    }
case MotionEvent.ACTION_MOVE:
{
    final float rawX=ev.getRawX();
    final float rawY=ev.getRawY();
    final float newPosX=rawX - mOffsetX + mHotspotX;
    final float newPosY=rawY - mOffsetY + mHotspotY;
    mController.updatePosition(this,(int)Math.round(newPosX),(int)Math.round(newPosY));
    break;
  }
case MotionEvent.ACTION_UP:
case MotionEvent.ACTION_CANCEL:
mIsDragging=false;
}
return true;
}
