{
  if (resultCode == InputMethodManager.RESULT_SHOWN) {
    final int len=mText.length();
    int start=Math.min(len,mPrevStart);
    int end=Math.min(len,mPrevEnd);
    Selection.setSelection((Spannable)mText,start,end);
    boolean selectAllGotFocus=mSelectAllOnFocus && mTouchFocusSelected;
    if (hasSelection() && !selectAllGotFocus) {
      startSelectionActionMode();
    }
  }
}
