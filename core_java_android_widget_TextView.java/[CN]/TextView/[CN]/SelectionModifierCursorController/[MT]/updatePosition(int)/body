{
  int selectionStart=getSelectionStart();
  int selectionEnd=getSelectionEnd();
  if (mStartIsDragged) {
    if (offset <= selectionEnd) {
      if (selectionStart == offset) {
        return;
      }
      selectionStart=offset;
    }
 else {
      selectionStart=selectionEnd;
      selectionEnd=offset;
      mStartIsDragged=false;
    }
  }
 else {
    if (offset >= selectionStart) {
      if (selectionEnd == offset) {
        return;
      }
      selectionEnd=offset;
    }
 else {
      selectionEnd=selectionStart;
      selectionStart=offset;
      mStartIsDragged=true;
    }
  }
  Selection.setSelection((Spannable)mText,selectionStart,selectionEnd);
  updateDrawablesPositions();
}
