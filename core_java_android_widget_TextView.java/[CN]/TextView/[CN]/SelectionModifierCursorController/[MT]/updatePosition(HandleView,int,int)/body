{
  int selectionStart=getSelectionStart();
  int selectionEnd=getSelectionEnd();
  final int previousOffset=handle == mStartHandle ? selectionStart : selectionEnd;
  int offset=getHysteresisOffset(x,y,previousOffset);
  if (handle == mStartHandle) {
    if (selectionStart == offset || offset > selectionEnd) {
      return;
    }
    if (offset == selectionEnd) {
      offset=selectionEnd - 1;
    }
    selectionStart=offset;
  }
 else {
    if (selectionEnd == offset || offset < selectionStart) {
      return;
    }
    if (offset == selectionStart) {
      offset=selectionStart + 1;
    }
    selectionEnd=offset;
  }
  Selection.setSelection((Spannable)mText,selectionStart,selectionEnd);
  updatePosition();
  hideDelayed();
}
