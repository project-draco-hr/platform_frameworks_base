{
  setInputType(type,false);
  final int variation=type & (EditorInfo.TYPE_MASK_CLASS | EditorInfo.TYPE_MASK_VARIATION);
  final boolean isPassword=variation == (EditorInfo.TYPE_CLASS_TEXT | EditorInfo.TYPE_TEXT_VARIATION_PASSWORD);
  boolean forceUpdate=false;
  if (isPassword) {
    setTransformationMethod(PasswordTransformationMethod.getInstance());
    setTypefaceByIndex(MONOSPACE,0);
  }
 else   if (mTransformation == PasswordTransformationMethod.getInstance()) {
    if (variation != (EditorInfo.TYPE_CLASS_TEXT | EditorInfo.TYPE_TEXT_VARIATION_VISIBLE_PASSWORD)) {
      setTypefaceByIndex(-1,-1);
    }
    forceUpdate=true;
  }
 else   if (variation == (EditorInfo.TYPE_CLASS_TEXT | EditorInfo.TYPE_TEXT_VARIATION_VISIBLE_PASSWORD)) {
    setTypefaceByIndex(MONOSPACE,0);
  }
  boolean multiLine=(type & (EditorInfo.TYPE_MASK_CLASS | EditorInfo.TYPE_TEXT_FLAG_MULTI_LINE)) == (EditorInfo.TYPE_CLASS_TEXT | EditorInfo.TYPE_TEXT_FLAG_MULTI_LINE);
  if (mSingleLine == multiLine || forceUpdate) {
    applySingleLine(!multiLine,!isPassword);
  }
  InputMethodManager imm=InputMethodManager.peekInstance();
  if (imm != null)   imm.restartInput(this);
}
