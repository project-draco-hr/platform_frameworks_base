{
  super.onCreateContextMenu(menu);
  if (!isFocused()) {
    return;
  }
  MenuHandler handler=new MenuHandler();
  if (canSelectAll()) {
    menu.add(0,ID_SELECT_ALL,0,com.android.internal.R.string.selectAll).setOnMenuItemClickListener(handler).setAlphabeticShortcut('a');
  }
  boolean selection=getSelectionStart() != getSelectionEnd();
  if (canCut()) {
    int name;
    if (selection) {
      name=com.android.internal.R.string.cut;
    }
 else {
      name=com.android.internal.R.string.cutAll;
    }
    menu.add(0,ID_CUT,0,name).setOnMenuItemClickListener(handler).setAlphabeticShortcut('x');
  }
  if (canCopy()) {
    int name;
    if (selection) {
      name=com.android.internal.R.string.copy;
    }
 else {
      name=com.android.internal.R.string.copyAll;
    }
    menu.add(0,ID_COPY,0,name).setOnMenuItemClickListener(handler).setAlphabeticShortcut('c');
  }
  if (canPaste()) {
    menu.add(0,ID_PASTE,0,com.android.internal.R.string.paste).setOnMenuItemClickListener(handler).setAlphabeticShortcut('v');
  }
  if (mText instanceof Spanned) {
    int selStart=getSelectionStart();
    int selEnd=getSelectionEnd();
    int min=Math.min(selStart,selEnd);
    int max=Math.max(selStart,selEnd);
    URLSpan[] urls=((Spanned)mText).getSpans(min,max,URLSpan.class);
    if (urls.length == 1) {
      menu.add(0,ID_COPY_URL,0,com.android.internal.R.string.copyUrl).setOnMenuItemClickListener(handler);
    }
  }
}
