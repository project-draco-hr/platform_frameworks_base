{
  Locale locale=Locale.getDefault();
  final InputMethodManager imm=InputMethodManager.peekInstance();
  if (imm != null) {
    final InputMethodSubtype currentInputMethodSubtype=imm.getCurrentInputMethodSubtype();
    if (currentInputMethodSubtype != null) {
      String localeString=currentInputMethodSubtype.getLocale();
      if (!TextUtils.isEmpty(localeString)) {
        locale=new Locale(localeString);
      }
    }
  }
  return locale;
}
