{
  int selStart=getSelectionStart();
  int selEnd=getSelectionEnd();
  if (!isFocused()) {
    selStart=0;
    selEnd=mText.length();
  }
  int min=Math.max(0,Math.min(selStart,selEnd));
  int max=Math.max(0,Math.max(selStart,selEnd));
  ClipboardManager clip=(ClipboardManager)getContext().getSystemService(Context.CLIPBOARD_SERVICE);
switch (id) {
case ID_COPY_URL:
    MetaKeyKeyListener.stopSelecting(this,(Spannable)mText);
  URLSpan[] urls=((Spanned)mText).getSpans(min,max,URLSpan.class);
if (urls.length == 1) {
  clip.setText(urls[0].getURL());
}
return true;
case ID_SELECTION_MODE:
startSelectionActionMode();
return true;
}
return false;
}
