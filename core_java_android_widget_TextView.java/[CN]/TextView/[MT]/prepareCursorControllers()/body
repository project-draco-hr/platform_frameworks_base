{
  if (mEditor == null)   return;
  boolean windowSupportsHandles=false;
  ViewGroup.LayoutParams params=getRootView().getLayoutParams();
  if (params instanceof WindowManager.LayoutParams) {
    WindowManager.LayoutParams windowParams=(WindowManager.LayoutParams)params;
    windowSupportsHandles=windowParams.type < WindowManager.LayoutParams.FIRST_SUB_WINDOW || windowParams.type > WindowManager.LayoutParams.LAST_SUB_WINDOW;
  }
  getEditor().mInsertionControllerEnabled=windowSupportsHandles && isCursorVisible() && mLayout != null;
  getEditor().mSelectionControllerEnabled=windowSupportsHandles && textCanBeSelected() && mLayout != null;
  if (!getEditor().mInsertionControllerEnabled) {
    hideInsertionPointCursorController();
    if (getEditor().mInsertionPointCursorController != null) {
      getEditor().mInsertionPointCursorController.onDetached();
      getEditor().mInsertionPointCursorController=null;
    }
  }
  if (!getEditor().mSelectionControllerEnabled) {
    stopSelectionActionMode();
    if (getEditor().mSelectionModifierCursorController != null) {
      getEditor().mSelectionModifierCursorController.onDetached();
      getEditor().mSelectionModifierCursorController=null;
    }
  }
}
