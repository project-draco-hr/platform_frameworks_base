{
switch (event.getAction()) {
case DragEvent.ACTION_DRAG_STARTED:
    return mInsertionPointCursorController != null;
case DragEvent.ACTION_DRAG_ENTERED:
  TextView.this.requestFocus();
return true;
case DragEvent.ACTION_DRAG_LOCATION:
{
final int offset=getOffset((int)event.getX(),(int)event.getY());
Selection.setSelection((Spannable)mText,offset);
return true;
}
case DragEvent.ACTION_DROP:
{
StringBuilder content=new StringBuilder("");
ClipData clipData=event.getClipData();
final int itemCount=clipData.getItemCount();
for (int i=0; i < itemCount; i++) {
Item item=clipData.getItem(i);
content.append(item.coerceToText(TextView.this.mContext));
}
final int offset=getOffset((int)event.getX(),(int)event.getY());
long minMax=prepareSpacesAroundPaste(offset,offset,content);
int min=extractRangeStartFromLong(minMax);
int max=extractRangeEndFromLong(minMax);
Selection.setSelection((Spannable)mText,max);
((Editable)mText).replace(min,max,content);
return true;
}
case DragEvent.ACTION_DRAG_EXITED:
case DragEvent.ACTION_DRAG_ENDED:
default :
return true;
}
}
