{
  if (undoManager != null) {
    createEditorIfNeeded();
    mEditor.mUndoManager=undoManager;
    mEditor.mUndoOwner=undoManager.getOwner(tag,this);
    mEditor.mUndoInputFilter=new Editor.UndoInputFilter(mEditor);
    if (!(mText instanceof Editable)) {
      setText(mText,BufferType.EDITABLE);
    }
    setFilters((Editable)mText,mFilters);
  }
 else   if (mEditor != null) {
    mEditor.mUndoManager=null;
    mEditor.mUndoOwner=null;
    mEditor.mUndoInputFilter=null;
  }
}
