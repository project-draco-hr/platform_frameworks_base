{
  if ((opmode != Cipher.ENCRYPT_MODE) && (opmode != Cipher.DECRYPT_MODE)) {
    throw new UnsupportedOperationException("Only ENCRYPT and DECRYPT modes supported. Mode: " + opmode);
  }
  mEncrypting=opmode == Cipher.ENCRYPT_MODE;
  initKey(opmode,key);
  if (mKey == null) {
    throw new ProviderException("initKey did not initialize the key");
  }
  mRng=random;
}
