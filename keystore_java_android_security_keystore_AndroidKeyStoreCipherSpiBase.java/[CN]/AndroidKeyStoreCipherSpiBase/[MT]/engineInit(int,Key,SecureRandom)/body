{
  resetAll();
  boolean success=false;
  try {
    init(opmode,key,random);
    initAlgorithmSpecificParameters();
    try {
      ensureKeystoreOperationInitialized();
    }
 catch (    InvalidAlgorithmParameterException e) {
      throw new InvalidKeyException(e);
    }
    success=true;
  }
  finally {
    if (!success) {
      resetAll();
    }
  }
}
