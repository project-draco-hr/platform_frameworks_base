{
  if (keyEvent == null) {
    Log.w(TAG,"Tried to send a null key event. Ignoring.");
    return;
  }
  boolean down=keyEvent.getAction() == KeyEvent.ACTION_DOWN;
  boolean up=keyEvent.getAction() == KeyEvent.ACTION_UP;
  int direction=0;
switch (keyEvent.getKeyCode()) {
case KeyEvent.KEYCODE_VOLUME_UP:
    direction=AudioManager.ADJUST_RAISE;
  break;
case KeyEvent.KEYCODE_VOLUME_DOWN:
direction=AudioManager.ADJUST_LOWER;
break;
case KeyEvent.KEYCODE_VOLUME_MUTE:
break;
}
if ((down || up) && direction != 0) {
int flags;
if (up) {
direction=0;
}
if (musicOnly) {
flags=AudioManager.FLAG_ACTIVE_MEDIA_ONLY;
}
 else {
if (up) {
flags=AudioManager.FLAG_PLAY_SOUND | AudioManager.FLAG_VIBRATE;
}
 else {
flags=AudioManager.FLAG_SHOW_UI;
}
}
mSessionManager.dispatchAdjustVolumeBy(AudioManager.USE_DEFAULT_STREAM_TYPE,direction,flags);
}
}
