{
  super.onAttachedToWindow();
  mStackScrollLayout=(NotificationStackScrollLayout)findViewById(R.id.notification_stack_scroller);
  mNotificationPanel=(NotificationPanelView)findViewById(R.id.notification_panel);
  mDragDownHelper=new DragDownHelper(getContext(),this,mStackScrollLayout,mService);
  mBrightnessMirror=findViewById(R.id.brightness_mirror);
  final ViewRootImpl root=getViewRootImpl();
  if (root != null) {
    root.setDrawDuringWindowsAnimating(true);
  }
  IBinder windowToken=getWindowToken();
  WindowManager.LayoutParams lp=(WindowManager.LayoutParams)getLayoutParams();
  lp.token=windowToken;
  setLayoutParams(lp);
  WindowManagerGlobal.getInstance().changeCanvasOpacity(windowToken,true);
}
