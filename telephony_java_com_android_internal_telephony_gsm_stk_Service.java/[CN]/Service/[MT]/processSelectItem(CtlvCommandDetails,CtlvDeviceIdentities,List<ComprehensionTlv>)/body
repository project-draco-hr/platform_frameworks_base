{
  if (Config.LOGD) {
    Log.d(TAG,"processSelectItem begins");
  }
  Menu menu=new Menu();
  IconId titleIconId=null;
  ItemsIconId itemsIconId=null;
  int iconLoadState=SelectItemParams.LOAD_NO_ICON;
  PresentationType presentType=PresentationType.NOT_SPECIFIED;
  Iterator<ComprehensionTlv> iter=ctlvs.iterator();
  ComprehensionTlv ctlv=searchForTag(ComprehensionTlvTag.ALPHA_ID,ctlvs);
  if (ctlv != null) {
    menu.title=retrieveAlphaId(ctlv);
  }
  ctlv=searchForTag(ComprehensionTlvTag.TEXT_ATTRIBUTE,ctlvs);
  if (ctlv != null) {
    menu.titleAttrs=retrieveTextAttribute(ctlv);
  }
  while (true) {
    ctlv=searchForNextTag(ComprehensionTlvTag.ITEM,iter);
    if (ctlv != null) {
      menu.items.add(retrieveItem(ctlv));
    }
 else {
      break;
    }
  }
  if (menu.items.size() == 0) {
    throw new ResultException(ResultCode.REQUIRED_VALUES_MISSING);
  }
  ctlv=searchForTag(ComprehensionTlvTag.ITEM_ID,ctlvs);
  if (ctlv != null) {
    menu.defaultItem=retrieveItemId(ctlv) - 1;
  }
  ctlv=searchForTag(ComprehensionTlvTag.ICON_ID,ctlvs);
  if (ctlv != null) {
    iconLoadState=SelectItemParams.LOAD_TITLE_ICON;
    titleIconId=retrieveIconId(ctlv);
    menu.titleIconSelfExplanatory=titleIconId.selfExplanatory;
  }
  ctlv=searchForTag(ComprehensionTlvTag.ITEM_ICON_ID_LIST,ctlvs);
  if (ctlv != null) {
    if (iconLoadState == SelectItemParams.LOAD_TITLE_ICON) {
      iconLoadState=SelectItemParams.LOAD_TITLE_ITEMS_ICONS;
    }
 else {
      iconLoadState=SelectItemParams.LOAD_ITEMS_ICONS;
    }
    itemsIconId=retrieveItemsIconId(ctlv);
    menu.itemsIconSelfExplanatory=itemsIconId.selfExplanatory;
  }
  boolean presentTypeSpecified=(cmdDet.commandQualifier & 0x01) != 0;
  if (presentTypeSpecified) {
    if ((cmdDet.commandQualifier & 0x02) == 0) {
      presentType=PresentationType.DATA_VALUES;
    }
 else {
      presentType=PresentationType.NAVIGATION_OPTIONS;
    }
  }
  menu.softKeyPreferred=(cmdDet.commandQualifier & 0x04) != 0;
  menu.helpAvailable=(cmdDet.commandQualifier & 0x80) != 0;
  mNextCmdParams=new SelectItemParams(cmdDet,menu,presentType,iconLoadState);
switch (iconLoadState) {
case SelectItemParams.LOAD_NO_ICON:
    return false;
case SelectItemParams.LOAD_TITLE_ICON:
  mIconLoader.loadIcon(titleIconId.recordNumber,this.obtainMessage(EVENT_LOAD_ICON_DONE));
break;
case SelectItemParams.LOAD_ITEMS_ICONS:
mIconLoader.loadIcons(itemsIconId.recordNumbers,this.obtainMessage(EVENT_LOAD_ICON_DONE));
break;
case SelectItemParams.LOAD_TITLE_ITEMS_ICONS:
int[] recordNumbers=new int[itemsIconId.recordNumbers.length + 1];
recordNumbers[0]=titleIconId.recordNumber;
System.arraycopy(itemsIconId.recordNumbers,0,recordNumbers,1,itemsIconId.recordNumbers.length);
mIconLoader.loadIcons(recordNumbers,this.obtainMessage(EVENT_LOAD_ICON_DONE));
break;
}
return true;
}
