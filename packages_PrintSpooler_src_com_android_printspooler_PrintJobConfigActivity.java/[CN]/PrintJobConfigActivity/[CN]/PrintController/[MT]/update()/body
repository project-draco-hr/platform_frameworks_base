{
  if (!mController.hasStarted()) {
    mController.start();
  }
  if (!printAttributesChanged() && mDocument.info != null) {
    handleOnLayoutFinished(mDocument.info,false,mRequestCounter.get());
  }
 else {
    PrintSpoolerService.peekInstance().setPrintJobAttributesNoPersistence(mPrintJobId,mCurrPrintAttributes);
    mMetadata.putBoolean(PrintDocumentAdapter.METADATA_KEY_PRINT_PREVIEW,!mEditor.isPrintConfirmed());
    mControllerState=CONTROLLER_STATE_LAYOUT_STARTED;
    mRemotePrintAdapter.layout(mOldPrintAttributes,mCurrPrintAttributes,mLayoutResultCallback,mMetadata,mRequestCounter.incrementAndGet());
    mOldPrintAttributes.copyFrom(mCurrPrintAttributes);
  }
}
