{
  if (!mController.hasStarted()) {
    mController.start();
  }
  if (!printAttributesChanged() && !mEditor.isPrintConfirmed()) {
    if (mDocument.info == null) {
      return;
    }
    handleOnLayoutFinished(mDocument.info,false,mRequestCounter.get());
  }
 else {
    mSpoolerProvider.getSpooler().setPrintJobAttributesNoPersistence(mPrintJobId,mCurrPrintAttributes);
    mMetadata.putBoolean(PrintDocumentAdapter.EXTRA_PRINT_PREVIEW,!mEditor.isPrintConfirmed());
    mControllerState=CONTROLLER_STATE_LAYOUT_STARTED;
    mRemotePrintAdapter.layout(mOldPrintAttributes,mCurrPrintAttributes,mLayoutResultCallback,mMetadata,mRequestCounter.incrementAndGet());
    mOldPrintAttributes.copyFrom(mCurrPrintAttributes);
  }
}
