{
  MediaSize mediaSize=mCurrPrintAttributes.getMediaSize();
  if (orientation == ORIENTATION_PORTRAIT) {
    if (!mediaSize.isPortrait()) {
      mCurrPrintAttributes.setMediaSize(mediaSize.asPortrait());
      Resolution oldResolution=mCurrPrintAttributes.getResolution();
      Resolution newResolution=new Resolution(oldResolution.getId(),oldResolution.getLabel(getPackageManager()),oldResolution.getVerticalDpi(),oldResolution.getHorizontalDpi());
      mCurrPrintAttributes.setResolution(newResolution);
      Margins oldMargins=mCurrPrintAttributes.getMargins();
      Margins newMargins=new Margins(oldMargins.getBottomMils(),oldMargins.getLeftMils(),oldMargins.getTopMils(),oldMargins.getRightMils());
      mCurrPrintAttributes.setMargins(newMargins);
    }
  }
 else {
    if (mediaSize.isPortrait()) {
      mCurrPrintAttributes.setMediaSize(mediaSize.asLandscape());
      Resolution oldResolution=mCurrPrintAttributes.getResolution();
      Resolution newResolution=new Resolution(oldResolution.getId(),oldResolution.getLabel(getPackageManager()),oldResolution.getVerticalDpi(),oldResolution.getHorizontalDpi());
      mCurrPrintAttributes.setResolution(newResolution);
      Margins oldMargins=mCurrPrintAttributes.getMargins();
      Margins newMargins=new Margins(oldMargins.getTopMils(),oldMargins.getRightMils(),oldMargins.getBottomMils(),oldMargins.getLeftMils());
      mCurrPrintAttributes.setMargins(newMargins);
    }
  }
}
