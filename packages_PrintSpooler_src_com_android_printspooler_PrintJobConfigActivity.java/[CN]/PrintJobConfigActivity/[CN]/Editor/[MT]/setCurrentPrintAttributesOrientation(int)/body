{
  MediaSize mediaSize=mCurrPrintAttributes.getMediaSize();
  if (orientation == ORIENTATION_PORTRAIT) {
    if (!mediaSize.isPortrait()) {
      mCurrPrintAttributes.setMediaSize(mediaSize.asPortrait());
      Resolution oldResolution=mCurrPrintAttributes.getResolution();
      Resolution newResolution=new Resolution(oldResolution.getId(),oldResolution.getLabel(),oldResolution.getVerticalDpi(),oldResolution.getHorizontalDpi());
      mCurrPrintAttributes.setResolution(newResolution);
      Margins oldMinMargins=mCurrPrintAttributes.getMinMargins();
      Margins newMinMargins=new Margins(oldMinMargins.getBottomMils(),oldMinMargins.getLeftMils(),oldMinMargins.getTopMils(),oldMinMargins.getRightMils());
      mCurrPrintAttributes.setMinMargins(newMinMargins);
    }
  }
 else {
    if (mediaSize.isPortrait()) {
      mCurrPrintAttributes.setMediaSize(mediaSize.asLandscape());
      Resolution oldResolution=mCurrPrintAttributes.getResolution();
      Resolution newResolution=new Resolution(oldResolution.getId(),oldResolution.getLabel(),oldResolution.getVerticalDpi(),oldResolution.getHorizontalDpi());
      mCurrPrintAttributes.setResolution(newResolution);
      Margins oldMinMargins=mCurrPrintAttributes.getMinMargins();
      Margins newMargins=new Margins(oldMinMargins.getTopMils(),oldMinMargins.getRightMils(),oldMinMargins.getBottomMils(),oldMinMargins.getLeftMils());
      mCurrPrintAttributes.setMinMargins(newMargins);
    }
  }
}
