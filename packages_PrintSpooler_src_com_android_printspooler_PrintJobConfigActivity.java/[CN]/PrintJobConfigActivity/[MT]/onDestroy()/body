{
  if (mController.hasStarted()) {
    mController.finish();
  }
  if (mEditor.isPrintConfirmed() && mController.isFinished()) {
    mSpoolerProvider.getSpooler().setPrintJobState(mPrintJobId,PrintJobInfo.STATE_QUEUED,null);
  }
 else {
    mSpoolerProvider.getSpooler().setPrintJobState(mPrintJobId,PrintJobInfo.STATE_CANCELED,null);
  }
  mIPrintDocumentAdapter.unlinkToDeath(mDeathRecipient,0);
  if (mGeneratingPrintJobDialog != null) {
    mGeneratingPrintJobDialog.dismiss();
    mGeneratingPrintJobDialog=null;
  }
  mSpoolerProvider.destroy();
  super.onDestroy();
}
