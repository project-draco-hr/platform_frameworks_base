{
  if (size < 0) {
    throw new IllegalArgumentException("size: " + size);
  }
  int originalLimit=source.limit();
  int position=source.position();
  int limit=position + size;
  if ((limit < position) || (limit > originalLimit)) {
    throw new BufferUnderflowException();
  }
  source.limit(limit);
  try {
    ByteBuffer result=source.slice();
    result.order(source.order());
    source.position(limit);
    return result;
  }
  finally {
    source.limit(originalLimit);
  }
}
