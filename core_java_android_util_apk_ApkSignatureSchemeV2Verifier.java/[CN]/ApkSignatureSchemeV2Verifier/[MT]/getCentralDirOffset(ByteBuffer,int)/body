{
  if (ZipUtils.isZip64EndOfCentralDirectoryLocatorPresent(apkContents,eocdOffset)) {
    throw new SignatureNotFoundException("ZIP64 APK not supported");
  }
  ByteBuffer eocd=sliceFromTo(apkContents,eocdOffset,apkContents.capacity());
  long centralDirOffsetLong=ZipUtils.getZipEocdCentralDirectoryOffset(eocd);
  if (centralDirOffsetLong >= eocdOffset) {
    throw new SignatureNotFoundException("ZIP Central Directory offset out of range: " + centralDirOffsetLong + ". ZIP End of Central Directory offset: "+ eocdOffset);
  }
  long centralDirSizeLong=ZipUtils.getZipEocdCentralDirectorySizeBytes(eocd);
  if (centralDirOffsetLong + centralDirSizeLong != eocdOffset) {
    throw new SignatureNotFoundException("ZIP Central Directory is not immediately followed by End of Central" + " Directory");
  }
  return centralDirOffsetLong;
}
