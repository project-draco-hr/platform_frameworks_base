{
  Pair<ByteBuffer,Long> eocdAndOffsetInFile=getEocd(apk);
  ByteBuffer eocd=eocdAndOffsetInFile.first;
  long eocdOffset=eocdAndOffsetInFile.second;
  if (ZipUtils.isZip64EndOfCentralDirectoryLocatorPresent(apk,eocdOffset)) {
    throw new SignatureNotFoundException("ZIP64 APK not supported");
  }
  long centralDirOffset=getCentralDirOffset(eocd,eocdOffset);
  Pair<ByteBuffer,Long> apkSigningBlockAndOffsetInFile=findApkSigningBlock(apk,centralDirOffset);
  ByteBuffer apkSigningBlock=apkSigningBlockAndOffsetInFile.first;
  long apkSigningBlockOffset=apkSigningBlockAndOffsetInFile.second;
  ByteBuffer apkSignatureSchemeV2Block=findApkSignatureSchemeV2Block(apkSigningBlock);
  return new SignatureInfo(apkSignatureSchemeV2Block,apkSigningBlockOffset,centralDirOffset,eocdOffset,eocd);
}
