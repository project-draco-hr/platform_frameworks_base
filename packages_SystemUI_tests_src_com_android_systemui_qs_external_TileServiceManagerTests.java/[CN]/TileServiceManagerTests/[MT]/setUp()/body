{
  super.setUp();
  mThread=new HandlerThread("TestThread");
  mThread.start();
  mHandler=new Handler(mThread.getLooper());
  mTileServices=Mockito.mock(TileServices.class);
  Mockito.when(mTileServices.getContext()).thenReturn(mContext);
  mTileLifecycle=Mockito.mock(TileLifecycleManager.class);
  ComponentName componentName=new ComponentName(mContext,TileServiceManagerTests.class);
  Mockito.when(mTileLifecycle.getComponent()).thenReturn(componentName);
  mContext.getSharedPreferences(TileServiceManager.PREFS_FILE,0).edit().putInt(componentName.flattenToString(),TileService.TILE_MODE_PASSIVE).commit();
  mTileServiceManager=new TileServiceManager(mTileServices,mHandler,mTileLifecycle);
}
