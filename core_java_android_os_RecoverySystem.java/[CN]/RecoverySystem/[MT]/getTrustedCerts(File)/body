{
  HashSet<X509Certificate> trusted=new HashSet<X509Certificate>();
  if (keystore == null) {
    keystore=DEFAULT_KEYSTORE;
  }
  ZipFile zip=new ZipFile(keystore);
  try {
    CertificateFactory cf=CertificateFactory.getInstance("X.509");
    Enumeration<? extends ZipEntry> entries=zip.entries();
    while (entries.hasMoreElements()) {
      ZipEntry entry=entries.nextElement();
      InputStream is=zip.getInputStream(entry);
      try {
        trusted.add((X509Certificate)cf.generateCertificate(is));
      }
  finally {
        is.close();
      }
    }
  }
  finally {
    zip.close();
  }
  return trusted;
}
