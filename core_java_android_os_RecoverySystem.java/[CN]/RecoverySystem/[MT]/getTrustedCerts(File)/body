{
  HashSet<Certificate> trusted=new HashSet<Certificate>();
  if (keystore == null) {
    keystore=DEFAULT_KEYSTORE;
  }
  ZipFile zip=new ZipFile(keystore);
  try {
    CertificateFactory cf=CertificateFactory.getInstance("X.509");
    Enumeration<? extends ZipEntry> entries=zip.entries();
    while (entries.hasMoreElements()) {
      ZipEntry entry=entries.nextElement();
      trusted.add(cf.generateCertificate(zip.getInputStream(entry)));
    }
  }
  finally {
    zip.close();
  }
  return trusted;
}
