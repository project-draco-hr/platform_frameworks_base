{
  QueuedInputEvent q=findActiveInputEvent(seq);
  if (q != null) {
    if (DEBUG_IMF) {
      Log.v(TAG,"IME finished event: seq=" + seq + " handled="+ handled+ " event="+ q);
    }
    if (handled) {
      dequeueActiveInputEvent(q);
      finishInputEvent(q,true);
    }
 else {
      q.mFlags|=QueuedInputEvent.FLAG_DELIVER_POST_IME;
    }
    while (mActiveInputEventHead != null && (mActiveInputEventHead.mFlags & QueuedInputEvent.FLAG_DELIVER_POST_IME) != 0) {
      q=dequeueActiveInputEvent();
      handled=false;
      if (!mAttachInfo.mHasWindowFocus && !isTerminalInputEvent(q.mEvent)) {
        Slog.w(TAG,"Dropping event due to no window focus: " + q.mEvent);
      }
 else {
        handled=(deliverInputEventPostIme(q) == EVENT_HANDLED);
      }
      finishInputEvent(q,handled);
    }
  }
 else {
    if (DEBUG_IMF) {
      Log.v(TAG,"IME finished event: seq=" + seq + " handled="+ handled+ ", event not found!");
    }
  }
}
