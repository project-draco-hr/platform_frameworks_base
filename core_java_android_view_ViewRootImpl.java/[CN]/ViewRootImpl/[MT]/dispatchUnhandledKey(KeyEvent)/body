{
  if ((event.getFlags() & KeyEvent.FLAG_FALLBACK) == 0) {
    final KeyCharacterMap kcm=event.getKeyCharacterMap();
    final int keyCode=event.getKeyCode();
    final int metaState=event.getMetaState();
    KeyCharacterMap.FallbackAction fallbackAction=kcm.getFallbackAction(keyCode,metaState);
    if (fallbackAction != null) {
      final int flags=event.getFlags() | KeyEvent.FLAG_FALLBACK;
      KeyEvent fallbackEvent=KeyEvent.obtain(event.getDownTime(),event.getEventTime(),event.getAction(),fallbackAction.keyCode,event.getRepeatCount(),fallbackAction.metaState,event.getDeviceId(),event.getScanCode(),flags,event.getSource(),null);
      fallbackAction.recycle();
      dispatchKey(fallbackEvent);
    }
  }
}
