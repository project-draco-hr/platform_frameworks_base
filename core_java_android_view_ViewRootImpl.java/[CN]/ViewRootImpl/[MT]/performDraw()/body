{
  if (!mAttachInfo.mScreenOn && !mReportNextDraw) {
    return;
  }
  final long drawStartTime;
  if (ViewDebug.DEBUG_LATENCY) {
    drawStartTime=System.nanoTime();
    if (mLastDrawFinishedTimeNanos != 0) {
      Log.d(ViewDebug.DEBUG_LATENCY_TAG,"Starting draw(); it has been " + ((drawStartTime - mLastDrawFinishedTimeNanos) * 0.000001f) + "ms since the last draw finished.");
    }
 else {
      Log.d(ViewDebug.DEBUG_LATENCY_TAG,"Starting draw().");
    }
  }
  final boolean fullRedrawNeeded=mFullRedrawNeeded;
  mFullRedrawNeeded=false;
  mIsDrawing=true;
  Trace.traceBegin(Trace.TRACE_TAG_VIEW,"draw");
  try {
    draw(fullRedrawNeeded);
  }
  finally {
    mIsDrawing=false;
    Trace.traceEnd(Trace.TRACE_TAG_VIEW);
  }
  if (ViewDebug.DEBUG_LATENCY) {
    long now=System.nanoTime();
    Log.d(ViewDebug.DEBUG_LATENCY_TAG,"performDraw() took " + ((now - drawStartTime) * 0.000001f) + "ms.");
    mLastDrawFinishedTimeNanos=now;
  }
  if (mReportNextDraw) {
    mReportNextDraw=false;
    if (LOCAL_LOGV) {
      Log.v(TAG,"FINISHED DRAWING: " + mWindowAttributes.getTitle());
    }
    if (mSurfaceHolder != null && mSurface.isValid()) {
      mSurfaceHolderCallback.surfaceRedrawNeeded(mSurfaceHolder);
      SurfaceHolder.Callback callbacks[]=mSurfaceHolder.getCallbacks();
      if (callbacks != null) {
        for (        SurfaceHolder.Callback c : callbacks) {
          if (c instanceof SurfaceHolder.Callback2) {
            ((SurfaceHolder.Callback2)c).surfaceRedrawNeeded(mSurfaceHolder);
          }
        }
      }
    }
    try {
      sWindowSession.finishDrawing(mWindow);
    }
 catch (    RemoteException e) {
    }
  }
}
