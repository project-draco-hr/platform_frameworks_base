{
  final MotionEvent event=(MotionEvent)q.mEvent;
  final int source=event.getSource();
  final boolean isJoystick=(source & InputDevice.SOURCE_CLASS_JOYSTICK) != 0;
  final boolean isTouchPad=(source & InputDevice.SOURCE_CLASS_POSITION) != 0;
  if (mView == null || !mAdded) {
    if (isJoystick) {
      updateJoystickDirection(event,false);
    }
 else     if (isTouchPad) {
      mSimulatedTrackball.updateTrackballDirection(this,event);
    }
    return EVENT_NOT_HANDLED;
  }
  if (mView.dispatchGenericMotionEvent(event)) {
    if (isJoystick) {
      updateJoystickDirection(event,false);
    }
 else     if (isTouchPad) {
      mSimulatedTrackball.updateTrackballDirection(this,event);
    }
    return EVENT_HANDLED;
  }
  if (isJoystick) {
    updateJoystickDirection(event,true);
    return EVENT_HANDLED;
  }
  if (isTouchPad) {
    mSimulatedTrackball.updateTrackballDirection(this,event);
    return EVENT_HANDLED;
  }
  return EVENT_NOT_HANDLED;
}
