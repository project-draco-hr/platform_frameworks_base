{
  final MotionEvent event=(MotionEvent)q.mEvent;
  final int source=event.getSource();
  final boolean isJoystick=(source & InputDevice.SOURCE_CLASS_JOYSTICK) != 0;
  final boolean isTouchPad=(source & InputDevice.SOURCE_CLASS_POSITION) != 0;
  if (mView == null || !mAdded) {
    if (isJoystick) {
      updateJoystickDirection(event,false);
    }
 else     if (isTouchPad) {
      mSimulatedTrackball.updateTrackballDirection(this,event);
    }
    finishInputEvent(q,false);
    return;
  }
  if (mView.dispatchGenericMotionEvent(event)) {
    if (isJoystick) {
      updateJoystickDirection(event,false);
    }
 else     if (isTouchPad) {
      mSimulatedTrackball.updateTrackballDirection(this,event);
    }
    finishInputEvent(q,true);
    return;
  }
  if (isJoystick) {
    updateJoystickDirection(event,true);
    finishInputEvent(q,true);
  }
 else   if (isTouchPad) {
    mSimulatedTrackball.updateTrackballDirection(this,event);
    finishInputEvent(q,true);
  }
 else {
    finishInputEvent(q,false);
  }
}
