{
  final String fromClosure=TABLE_DOCUMENTS + " AS child INNER JOIN " + TABLE_DOCUMENTS+ " AS parent ON "+ "child."+ COLUMN_PARENT_DOCUMENT_ID+ " = "+ "parent."+ Document.COLUMN_DOCUMENT_ID;
  final String whereClosure="parent." + COLUMN_DEVICE_ID + " = ? AND "+ "parent."+ COLUMN_ROW_STATE+ " IN (?, ?) AND "+ "parent."+ COLUMN_DOCUMENT_TYPE+ " != ? AND "+ "child."+ COLUMN_ROW_STATE+ " = ?";
  try (final Cursor cursor=mDatabase.query(fromClosure,strings("parent." + COLUMN_DEVICE_ID,"parent." + COLUMN_STORAGE_ID,"parent." + COLUMN_OBJECT_HANDLE,"parent." + Document.COLUMN_DOCUMENT_ID,"parent." + COLUMN_DOCUMENT_TYPE),whereClosure,strings(deviceId,ROW_STATE_VALID,ROW_STATE_INVALIDATED,DOCUMENT_TYPE_DEVICE,ROW_STATE_DISCONNECTED),null,null,null,"1")){
    if (cursor.getCount() == 0) {
      return null;
    }
    cursor.moveToNext();
    return new Identifier(cursor.getInt(0),cursor.getInt(1),cursor.getInt(2),cursor.getString(3),cursor.getInt(4));
  }
 }
