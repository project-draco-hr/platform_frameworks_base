{
  mDatabase.beginTransaction();
  try {
    final long[] documentIds=new long[valuesList.length];
    int i=0;
    for (    final ContentValues values : valuesList) {
      final String displayName=values.getAsString(Document.COLUMN_DISPLAY_NAME);
      final long numUnmapped=DatabaseUtils.queryNumEntries(mDatabase,TABLE_DOCUMENTS,selection + " AND " + COLUMN_ROW_STATE+ " = ? AND "+ Document.COLUMN_DISPLAY_NAME+ " = ?",strings(arg,ROW_STATE_UNMAPPED,displayName));
      if (numUnmapped != 0) {
        values.put(COLUMN_ROW_STATE,ROW_STATE_MAPPING);
      }
      documentIds[i++]=mDatabase.insert(TABLE_DOCUMENTS,null,values);
    }
    mDatabase.setTransactionSuccessful();
    return documentIds;
  }
  finally {
    mDatabase.endTransaction();
  }
}
