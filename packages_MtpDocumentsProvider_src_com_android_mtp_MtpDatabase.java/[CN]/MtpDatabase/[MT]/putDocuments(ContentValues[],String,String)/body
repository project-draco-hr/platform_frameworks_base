{
  database.beginTransaction();
  try {
    for (    final ContentValues values : valuesList) {
      final String displayName=values.getAsString(DocumentsContract.Document.COLUMN_DISPLAY_NAME);
      final long numUnmapped=DatabaseUtils.queryNumEntries(database,TABLE_DOCUMENTS,selection + " AND " + COLUMN_ROW_STATE+ " = ? AND "+ DocumentsContract.Document.COLUMN_DISPLAY_NAME+ " = ?",strings(arg,ROW_STATE_UNMAPPED,displayName));
      if (numUnmapped != 0) {
        values.put(COLUMN_ROW_STATE,ROW_STATE_MAPPING);
      }
      database.insert(TABLE_DOCUMENTS,null,values);
    }
    database.setTransactionSuccessful();
  }
  finally {
    database.endTransaction();
  }
}
