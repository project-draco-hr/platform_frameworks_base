{
  database.beginTransaction();
  try {
    final ContentValues values=new ContentValues();
    for (int i=0; i < roots.length; i++) {
      getRootDocumentValues(values,resources,roots[i]);
      final String displayName=values.getAsString(DocumentsContract.Document.COLUMN_DISPLAY_NAME);
      final long numUnmapped=DatabaseUtils.queryNumEntries(database,TABLE_DOCUMENTS,SELECTION_ROOT_DOCUMENTS_WITH_STATE + " AND " + DocumentsContract.Document.COLUMN_DISPLAY_NAME+ " = ?",strings(deviceId,ROW_STATE_UNMAPPED,displayName));
      if (numUnmapped != 0) {
        values.put(COLUMN_ROW_STATE,ROW_STATE_MAPPING);
      }
      database.insert(TABLE_DOCUMENTS,null,values);
    }
    database.setTransactionSuccessful();
  }
  finally {
    database.endTransaction();
  }
}
