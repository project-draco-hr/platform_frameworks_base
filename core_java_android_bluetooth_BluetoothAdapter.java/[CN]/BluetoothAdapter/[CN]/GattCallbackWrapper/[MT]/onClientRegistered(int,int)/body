{
  if (DBG)   Log.d(TAG,"onClientRegistered() - status=" + status + " clientIf="+ clientIf);
synchronized (this) {
    if (mLeHandle == -1) {
      if (DBG)       Log.d(TAG,"onClientRegistered LE scan canceled");
    }
    if (status == BluetoothGatt.GATT_SUCCESS) {
      mLeHandle=clientIf;
      IBluetoothGatt iGatt=null;
      try {
        BluetoothAdapter adapter=mBluetoothAdapter.get();
        if (adapter != null) {
          iGatt=adapter.getBluetoothManager().getBluetoothGatt();
          if (mAdvertiseCallback != null) {
            iGatt.startAdvertising(mLeHandle);
          }
 else {
            if (mScanFilter == null) {
              iGatt.startScan(mLeHandle,false);
            }
 else {
              ParcelUuid[] uuids=new ParcelUuid[mScanFilter.length];
              for (int i=0; i != uuids.length; ++i) {
                uuids[i]=new ParcelUuid(mScanFilter[i]);
              }
              iGatt.startScanWithUuids(mLeHandle,false,uuids);
            }
          }
        }
 else {
          Log.e(TAG,"onClientRegistered, BluetoothAdapter null");
          mLeHandle=-1;
        }
      }
 catch (      RemoteException e) {
        Log.e(TAG,"fail to start le scan: " + e);
        mLeHandle=-1;
      }
      if (mLeHandle == -1) {
        if (iGatt != null) {
          try {
            iGatt.unregisterClient(mLeHandle);
          }
 catch (          RemoteException e) {
            Log.e(TAG,"fail to unregister callback: " + mLeHandle + " error: "+ e);
          }
        }
      }
    }
 else {
      mLeHandle=-1;
    }
    notifyAll();
  }
}
