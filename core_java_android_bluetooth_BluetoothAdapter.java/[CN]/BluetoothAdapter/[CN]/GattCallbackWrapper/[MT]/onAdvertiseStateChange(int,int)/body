{
  Log.d(TAG,"on advertise call back, state: " + advertiseState + " status: "+ status);
  if (advertiseState == STATE_ADVERTISE_STARTED) {
    mAdvertiseCallback.onAdvertiseStart(status);
  }
 else {
synchronized (this) {
      if (status == ADVERTISE_CALLBACK_SUCCESS) {
        BluetoothAdapter adapter=mBluetoothAdapter.get();
        if (adapter != null) {
          try {
            IBluetoothGatt iGatt=adapter.getBluetoothManager().getBluetoothGatt();
            Log.d(TAG,"unregistering client " + mLeHandle);
            iGatt.unregisterClient(mLeHandle);
            mLeHandle=-1;
            adapter.mAdvertisingGattCallback=null;
          }
 catch (          RemoteException e) {
            Log.e(TAG,"Failed to unregister client" + e);
          }
        }
 else {
          Log.e(TAG,"cannot unregister client, BluetoothAdapter is null");
        }
      }
    }
    mAdvertiseCallback.onAdvertiseStop(status);
  }
}
