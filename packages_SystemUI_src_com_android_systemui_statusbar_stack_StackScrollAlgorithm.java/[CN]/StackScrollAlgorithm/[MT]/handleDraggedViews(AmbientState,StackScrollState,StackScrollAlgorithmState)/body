{
  ArrayList<View> draggedViews=ambientState.getDraggedViews();
  for (  View draggedView : draggedViews) {
    int childIndex=algorithmState.visibleChildren.indexOf(draggedView);
    if (childIndex >= 0 && childIndex < algorithmState.visibleChildren.size() - 1) {
      View nextChild=algorithmState.visibleChildren.get(childIndex + 1);
      if (!draggedViews.contains(nextChild)) {
        StackViewState viewState=resultState.getViewStateForView(nextChild);
        if (ambientState.isShadeExpanded()) {
          viewState.shadowAlpha=1;
          viewState.hidden=false;
        }
      }
      StackViewState viewState=resultState.getViewStateForView(draggedView);
      viewState.alpha=draggedView.getAlpha();
    }
  }
}
