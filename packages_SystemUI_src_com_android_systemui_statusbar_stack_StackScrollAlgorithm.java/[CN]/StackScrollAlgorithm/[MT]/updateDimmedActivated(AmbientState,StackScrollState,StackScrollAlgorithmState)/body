{
  boolean dimmed=ambientState.isDimmed();
  View activatedChild=ambientState.getActivatedChild();
  int childCount=algorithmState.visibleChildren.size();
  for (int i=0; i < childCount; i++) {
    View child=algorithmState.visibleChildren.get(i);
    StackScrollState.ViewState childViewState=resultState.getViewStateForView(child);
    childViewState.dimmed=dimmed;
    boolean isActivatedChild=activatedChild == child;
    childViewState.scale=!dimmed || isActivatedChild ? 1.0f : DIMMED_SCALE;
    if (dimmed && activatedChild != null) {
      if (!isActivatedChild) {
        childViewState.alpha*=ACTIVATED_INVERSE_ALPHA;
      }
 else {
        childViewState.zTranslation+=2.0f * mZDistanceBetweenElements;
      }
    }
  }
}
