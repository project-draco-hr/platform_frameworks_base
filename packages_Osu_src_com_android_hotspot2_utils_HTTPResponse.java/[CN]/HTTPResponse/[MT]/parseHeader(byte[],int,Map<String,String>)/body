{
  String headerText=new String(input,0,body - BODY_SEPARATOR_LENGTH,StandardCharsets.ISO_8859_1);
  Iterator<String> headerLines=Arrays.asList(headerText.split(CRLF)).iterator();
  if (!headerLines.hasNext()) {
    throw new IOException("Bad HTTP Request");
  }
  int statusCode;
  String line0=headerLines.next();
  String[] status=line0.split(" ");
  if (status.length != 3 || !"HTTP/1.1".equals(status[0])) {
    throw new IOException("Bad HTTP Result: " + line0);
  }
  try {
    statusCode=Integer.parseInt(status[1].trim());
  }
 catch (  NumberFormatException nfe) {
    throw new IOException("Bad HTTP header line: '" + line0 + "'");
  }
  while (headerLines.hasNext()) {
    String line=headerLines.next();
    int keyEnd=line.indexOf(':');
    if (keyEnd < 0) {
      throw new IOException("Bad header line: '" + line + "'");
    }
    String key=line.substring(0,keyEnd).trim();
    String value=line.substring(keyEnd + 1).trim();
    headers.put(key,value);
  }
  return statusCode;
}
