{
  List<Effect> effects=m.getAllEffects();
  List<Overlay> overlays=m.getAllOverlays();
  if (m.getBeginTransition() != null && m.getBeginTransition().getDuration() > 0 && m.getEndTransition() != null && m.getEndTransition().getDuration() > 0) {
    beginCutTime+=m.getBeginTransition().getDuration();
    endCutTime-=m.getEndTransition().getDuration();
  }
 else   if (m.getBeginTransition() == null && m.getEndTransition() != null && m.getEndTransition().getDuration() > 0) {
    endCutTime-=m.getEndTransition().getDuration();
  }
 else   if (m.getEndTransition() == null && m.getBeginTransition() != null && m.getBeginTransition().getDuration() > 0) {
    beginCutTime+=m.getBeginTransition().getDuration();
  }
  for (  Effect effect : effects) {
    if (effect instanceof EffectColor) {
      effectSettings[i]=getEffectSettings((EffectColor)effect);
      adjustEffectsStartTimeAndDuration(effectSettings[i],beginCutTime,endCutTime);
      effectSettings[i].startTime+=storyBoardTime;
      i++;
    }
  }
  for (  Overlay overlay : overlays) {
    effectSettings[i]=getOverlaySettings((OverlayFrame)overlay);
    adjustEffectsStartTimeAndDuration(effectSettings[i],beginCutTime,endCutTime);
    effectSettings[i].startTime+=storyBoardTime;
    i++;
  }
  return i;
}
