{
  int[] rgb888=null;
  int thumbnailSize=width * height * 4;
  int i=0;
  int deltaTime=(int)(endMs - startMs) / thumbnailCount;
  Bitmap[] bitmap=null;
  try {
    rgb888=new int[thumbnailSize * thumbnailCount];
    bitmap=new Bitmap[thumbnailCount];
  }
 catch (  Throwable e) {
    try {
      System.gc();
      rgb888=new int[thumbnailSize * MAX_THUMBNAIL_PERMITTED];
      bitmap=new Bitmap[MAX_THUMBNAIL_PERMITTED];
      thumbnailCount=MAX_THUMBNAIL_PERMITTED;
    }
 catch (    Throwable ex) {
      throw new RuntimeException("Memory allocation fails,reduce nos of thumbanail count");
    }
  }
  IntBuffer tmpBuffer=IntBuffer.allocate(thumbnailSize);
  nativeGetPixelsList(filename,rgb888,width,height,deltaTime,thumbnailCount,startMs,endMs);
  for (; i < thumbnailCount; i++) {
    bitmap[i]=Bitmap.createBitmap(width,height,Bitmap.Config.ARGB_8888);
    tmpBuffer.put(rgb888,(i * thumbnailSize),thumbnailSize);
    tmpBuffer.rewind();
    bitmap[i].copyPixelsFromBuffer(tmpBuffer);
  }
  return bitmap;
}
