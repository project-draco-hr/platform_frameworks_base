{
  vibratorInit();
  vibratorOff();
  mContext=context;
  PowerManager pm=(PowerManager)context.getSystemService(Context.POWER_SERVICE);
  mWakeLock=pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK,"*vibrator*");
  mWakeLock.setReferenceCounted(true);
  mAppOpsService=IAppOpsService.Stub.asInterface(ServiceManager.getService(Context.APP_OPS_SERVICE));
  mBatteryStatsService=IBatteryStats.Stub.asInterface(ServiceManager.getService(BatteryStats.SERVICE_NAME));
  mPreviousVibrationsLimit=mContext.getResources().getInteger(com.android.internal.R.integer.config_previousVibrationsDumpLimit);
  mVibrations=new LinkedList<>();
  mPreviousVibrations=new LinkedList<>();
  IntentFilter filter=new IntentFilter();
  filter.addAction(Intent.ACTION_SCREEN_OFF);
  context.registerReceiver(mIntentReceiver,filter);
}
