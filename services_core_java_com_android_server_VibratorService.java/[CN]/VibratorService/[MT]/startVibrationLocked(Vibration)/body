{
  try {
    int mode=mAppOpsService.checkAudioOperation(AppOpsManager.OP_VIBRATE,vib.mStreamHint,vib.mUid,vib.mPackageName);
    if (mode == AppOpsManager.MODE_ALLOWED) {
      mode=mAppOpsService.startOperation(AppOpsManager.getToken(mAppOpsService),AppOpsManager.OP_VIBRATE,vib.mUid,vib.mPackageName);
    }
    if (mode != AppOpsManager.MODE_ALLOWED) {
      if (mode == AppOpsManager.MODE_ERRORED) {
        Slog.w(TAG,"Would be an error: vibrate from uid " + vib.mUid);
      }
      mH.post(mVibrationRunnable);
      return;
    }
  }
 catch (  RemoteException e) {
  }
  if (vib.mTimeout != 0) {
    doVibratorOn(vib.mTimeout,vib.mUid,vib.mStreamHint);
    mH.postDelayed(mVibrationRunnable,vib.mTimeout);
  }
 else {
    mThread=new VibrateThread(vib);
    mThread.start();
  }
}
