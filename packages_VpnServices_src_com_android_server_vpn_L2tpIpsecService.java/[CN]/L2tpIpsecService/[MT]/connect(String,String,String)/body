{
  L2tpIpsecProfile p=getProfile();
  DaemonProxy ipsec=startDaemon(IPSEC);
  ipsec.sendCommand(serverIp,L2tpService.L2TP_PORT,Credentials.USER_PRIVATE_KEY + p.getUserCertificate(),Credentials.USER_CERTIFICATE + p.getUserCertificate(),Credentials.CA_CERTIFICATE + p.getCaCertificate());
  ipsec.closeControlSocket();
  sleep(2000);
  MtpdHelper.sendCommand(this,L2tpService.L2TP_DAEMON,serverIp,L2tpService.L2TP_PORT,(p.isSecretEnabled() ? p.getSecretString() : null),username,password);
}
