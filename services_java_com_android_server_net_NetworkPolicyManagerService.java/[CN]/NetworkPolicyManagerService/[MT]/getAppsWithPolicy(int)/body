{
  mContext.enforceCallingOrSelfPermission(MANAGE_NETWORK_POLICY,TAG);
  int[] appIds=new int[0];
synchronized (mRulesLock) {
    for (int i=0; i < mAppPolicy.size(); i++) {
      final int appId=mAppPolicy.keyAt(i);
      final int appPolicy=mAppPolicy.valueAt(i);
      if (appPolicy == policy) {
        appIds=appendInt(appIds,appId);
      }
    }
  }
  return appIds;
}
