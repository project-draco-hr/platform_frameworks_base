{
synchronized (mRulesLock) {
    readPolicyLocked();
    if (mRestrictBackground) {
      updateRulesForRestrictBackgroundLocked();
      updateNotificationsLocked();
    }
  }
  updateScreenOn();
  try {
    mActivityManager.registerProcessObserver(mProcessObserver);
  }
 catch (  RemoteException e) {
    Slog.e(TAG,"unable to register IProcessObserver",e);
  }
  try {
    mNetworkManager.registerObserver(mAlertObserver);
  }
 catch (  RemoteException e) {
    Slog.e(TAG,"unable to register INetworkManagementEventObserver",e);
  }
  final IntentFilter screenFilter=new IntentFilter();
  screenFilter.addAction(Intent.ACTION_SCREEN_ON);
  screenFilter.addAction(Intent.ACTION_SCREEN_OFF);
  mContext.registerReceiver(mScreenReceiver,screenFilter,null,mHandler);
  final IntentFilter connFilter=new IntentFilter(CONNECTIVITY_ACTION_IMMEDIATE);
  mContext.registerReceiver(mConnReceiver,connFilter,CONNECTIVITY_INTERNAL,mHandler);
  final IntentFilter packageFilter=new IntentFilter();
  packageFilter.addAction(ACTION_PACKAGE_ADDED);
  packageFilter.addAction(ACTION_UID_REMOVED);
  mContext.registerReceiver(mPackageReceiver,packageFilter,null,mHandler);
  final IntentFilter statsFilter=new IntentFilter(ACTION_NETWORK_STATS_UPDATED);
  mContext.registerReceiver(mStatsReceiver,statsFilter,READ_NETWORK_USAGE_HISTORY,mHandler);
  final IntentFilter allowFilter=new IntentFilter(ACTION_ALLOW_BACKGROUND);
  mContext.registerReceiver(mAllowReceiver,allowFilter,MANAGE_NETWORK_POLICY,mHandler);
}
