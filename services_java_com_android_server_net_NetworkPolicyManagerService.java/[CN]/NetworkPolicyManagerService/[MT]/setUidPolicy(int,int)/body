{
  mContext.enforceCallingOrSelfPermission(MANAGE_NETWORK_POLICY,TAG);
  final int oldPolicy;
synchronized (mRulesLock) {
    oldPolicy=getUidPolicy(uid);
    mUidPolicy.put(uid,policy);
    updateRulesForUidLocked(uid);
    writePolicyLocked();
  }
}
