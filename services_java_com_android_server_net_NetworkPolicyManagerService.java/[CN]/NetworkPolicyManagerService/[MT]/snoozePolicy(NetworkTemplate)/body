{
  mContext.enforceCallingOrSelfPermission(MANAGE_NETWORK_POLICY,TAG);
  if (mTime.getCacheAge() > TIME_CACHE_MAX_AGE) {
    mTime.forceRefresh();
  }
  final long currentTime=mTime.hasCache() ? mTime.currentTimeMillis() : System.currentTimeMillis();
synchronized (mRulesLock) {
    final NetworkPolicy policy=mNetworkPolicy.get(template);
    if (policy == null) {
      throw new IllegalArgumentException("unable to find policy for " + template);
    }
    policy.lastSnooze=currentTime;
    updateNetworkRulesLocked();
    updateNotificationsLocked();
    writePolicyLocked();
  }
}
