{
  if (LOGV)   Slog.v(TAG,"updateNetworkEnabledLocked()");
  final long currentTime=currentTimeMillis(true);
  for (  NetworkPolicy policy : mNetworkPolicy.values()) {
    if (policy.limitBytes == LIMIT_DISABLED) {
      setNetworkTemplateEnabled(policy.template,true);
      continue;
    }
    final long start=computeLastCycleBoundary(currentTime,policy);
    final long end=currentTime;
    final long totalBytes=getTotalBytes(policy.template,start,end);
    if (totalBytes == UNKNOWN_BYTES)     continue;
    final boolean overLimit=policy.limitBytes != LIMIT_DISABLED && totalBytes > policy.limitBytes && policy.lastSnooze < start;
    final boolean enabled=!overLimit;
    setNetworkTemplateEnabled(policy.template,enabled);
  }
}
