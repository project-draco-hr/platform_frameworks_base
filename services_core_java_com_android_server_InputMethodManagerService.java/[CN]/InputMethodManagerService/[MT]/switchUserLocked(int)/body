{
  mSettings.setCurrentUserId(newUserId);
  updateCurrentProfileIds();
  mFileManager=new InputMethodFileManager(mMethodMap,newUserId);
  final String defaultImiId=mSettings.getSelectedInputMethod();
  final boolean initialUserSwitch=TextUtils.isEmpty(defaultImiId);
  if (DEBUG) {
    Slog.d(TAG,"Switch user: " + newUserId + " current ime = "+ defaultImiId);
  }
  resetAllInternalStateLocked(false,initialUserSwitch);
  if (initialUserSwitch) {
    InputMethodUtils.setNonSelectedSystemImesDisabledUntilUsed(mContext.getPackageManager(),mSettings.getEnabledInputMethodListLocked());
  }
}
