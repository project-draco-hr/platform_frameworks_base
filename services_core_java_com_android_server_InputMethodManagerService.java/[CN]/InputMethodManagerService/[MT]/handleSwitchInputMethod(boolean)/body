{
synchronized (mMethodMap) {
    final ImeSubtypeListItem nextSubtype=mSwitchingController.getNextInputMethodLocked(false,mMethodMap.get(mCurMethodId),mCurrentSubtype,forwardDirection);
    if (nextSubtype == null) {
      return;
    }
    setInputMethodLocked(nextSubtype.mImi.getId(),nextSubtype.mSubtypeId);
    if (mSubtypeSwitchedByShortCutToast != null) {
      mSubtypeSwitchedByShortCutToast.cancel();
      mSubtypeSwitchedByShortCutToast=null;
    }
    if ((mImeWindowVis & InputMethodService.IME_VISIBLE) != 0) {
      return;
    }
    final InputMethodInfo newInputMethodInfo=mMethodMap.get(mCurMethodId);
    if (newInputMethodInfo == null) {
      return;
    }
    final CharSequence toastText=InputMethodUtils.getImeAndSubtypeDisplayName(mContext,newInputMethodInfo,mCurrentSubtype);
    if (!TextUtils.isEmpty(toastText)) {
      mSubtypeSwitchedByShortCutToast=Toast.makeText(mContext,toastText.toString(),Toast.LENGTH_SHORT);
      mSubtypeSwitchedByShortCutToast.show();
    }
  }
}
