{
  Response response=event.getResponse();
  String nonce=getNonceFromResponse(response);
  if (nonce == null) {
    onError(SipErrorCode.SERVER_ERROR,"server does not provide challenge");
    return false;
  }
 else   if (mAuthenticationRetryCount < 2) {
    mClientTransaction=mSipHelper.handleChallenge(event,getAccountManager());
    mDialog=mClientTransaction.getDialog();
    mAuthenticationRetryCount++;
    if (isLoggable(this,event)) {
      Log.d(TAG,"   authentication retry count=" + mAuthenticationRetryCount);
    }
    return true;
  }
 else {
    if (crossDomainAuthenticationRequired(response)) {
      onError(SipErrorCode.CROSS_DOMAIN_AUTHENTICATION,getRealmFromResponse(response));
    }
 else {
      onError(SipErrorCode.INVALID_CREDENTIALS,"incorrect username or password");
    }
    return false;
  }
}
