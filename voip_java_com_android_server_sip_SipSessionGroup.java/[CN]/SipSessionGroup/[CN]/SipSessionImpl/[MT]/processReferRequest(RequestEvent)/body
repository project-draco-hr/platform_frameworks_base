{
  try {
    ReferToHeader referto=(ReferToHeader)event.getRequest().getHeader(ReferTo.NAME);
    Address address=referto.getAddress();
    SipURI uri=(SipURI)address.getURI();
    String replacesHeader=uri.getHeader(ReplacesHeader.NAME);
    String username=uri.getUser();
    if (username == null) {
      mSipHelper.sendResponse(event,Response.BAD_REQUEST);
      return false;
    }
    mSipHelper.sendResponse(event,Response.ACCEPTED);
    SipSessionImpl newSession=createNewSession(event,this.mProxy.getListener(),mSipHelper.getServerTransaction(event),SipSession.State.READY_TO_CALL);
    newSession.mReferSession=this;
    newSession.mReferredBy=(ReferredByHeader)event.getRequest().getHeader(ReferredByHeader.NAME);
    newSession.mReplaces=replacesHeader;
    newSession.mPeerProfile=createPeerProfile(referto);
    newSession.mProxy.onCallTransferring(newSession,null);
    return true;
  }
 catch (  IllegalArgumentException e) {
    throw new SipException("createPeerProfile()",e);
  }
}
