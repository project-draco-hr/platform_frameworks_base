{
  ReplacesHeader replaces=(ReplacesHeader)event.getRequest().getHeader(ReplacesHeader.NAME);
  SipSessionImpl newSession=null;
  if (replaces != null) {
    int response=processInviteWithReplaces(event,replaces);
    if (DEBUG) {
      Log.v(TAG,"ReplacesHeader: " + replaces + " response="+ response);
    }
    if (response == Response.OK) {
      SipSessionImpl replacedSession=mSessionMap.get(replaces.getCallId());
      newSession=createNewSession(event,replacedSession.mProxy.getListener(),mSipHelper.getServerTransaction(event),SipSession.State.INCOMING_CALL);
      newSession.mProxy.onCallTransferring(newSession,newSession.mPeerSessionDescription);
    }
 else {
      mSipHelper.sendResponse(event,response);
    }
  }
 else {
    newSession=createNewSession(event,mProxy,mSipHelper.sendRinging(event,generateTag()),SipSession.State.INCOMING_CALL);
    mProxy.onRinging(newSession,newSession.mPeerProfile,newSession.mPeerSessionDescription);
  }
  if (newSession != null)   addSipSession(newSession);
}
