{
  final Notification n=sbn.getNotification();
  int importance=IMPORTANCE_DEFAULT;
  if (0 != (n.flags & Notification.FLAG_HIGH_PRIORITY)) {
    n.priority=Notification.PRIORITY_MAX;
  }
switch (n.priority) {
case Notification.PRIORITY_MIN:
case Notification.PRIORITY_LOW:
    importance=IMPORTANCE_LOW;
  break;
case Notification.PRIORITY_DEFAULT:
importance=IMPORTANCE_DEFAULT;
break;
case Notification.PRIORITY_HIGH:
importance=IMPORTANCE_HIGH;
break;
case Notification.PRIORITY_MAX:
importance=IMPORTANCE_MAX;
break;
}
stats.requestedImportance=importance;
boolean isNoisy=(n.defaults & Notification.DEFAULT_SOUND) != 0 || (n.defaults & Notification.DEFAULT_VIBRATE) != 0 || n.sound != null || n.vibrate != null;
stats.isNoisy=isNoisy;
if (!isNoisy && importance > IMPORTANCE_DEFAULT) {
importance=IMPORTANCE_DEFAULT;
}
try {
final ApplicationInfo applicationInfo=mContext.getPackageManager().getApplicationInfoAsUser(sbn.getPackageName(),0,sbn.getUser().getIdentifier());
if (applicationInfo.targetSdkVersion < Build.VERSION_CODES.N) {
if (isNoisy) {
if (importance >= IMPORTANCE_HIGH) {
importance=IMPORTANCE_MAX;
}
 else {
importance=IMPORTANCE_HIGH;
}
}
}
}
 catch (NameNotFoundException e) {
}
if (n.fullScreenIntent != null) {
importance=IMPORTANCE_MAX;
}
stats.naturalImportance=importance;
return importance;
}
