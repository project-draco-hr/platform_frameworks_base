{
  mNow=now;
  long seconds=mCountDown ? mBase - now : now - mBase;
  seconds/=1000;
  boolean negative=false;
  if (seconds < 0) {
    seconds=-seconds;
    negative=true;
  }
  String text=DateUtils.formatElapsedTime(mRecycle,seconds);
  if (negative) {
    text=getResources().getString(R.string.negative_duration,text);
  }
  if (mFormat != null) {
    Locale loc=Locale.getDefault();
    if (mFormatter == null || !loc.equals(mFormatterLocale)) {
      mFormatterLocale=loc;
      mFormatter=new Formatter(mFormatBuilder,loc);
    }
    mFormatBuilder.setLength(0);
    mFormatterArgs[0]=text;
    try {
      mFormatter.format(mFormat,mFormatterArgs);
      text=mFormatBuilder.toString();
    }
 catch (    IllegalFormatException ex) {
      if (!mLogged) {
        Log.w(TAG,"Illegal format string: " + mFormat);
        mLogged=true;
      }
    }
  }
  setText(text);
}
