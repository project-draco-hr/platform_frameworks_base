{
  super.onResume();
  if (getCallingPackage() != null) {
    Log.e(TAG,getCallingPackage() + " cannot start this activity");
    finish();
    return;
  }
  try {
    mConfig=getIntent().getParcelableExtra("config");
    mService=IConnectivityManager.Stub.asInterface(ServiceManager.getService(Context.CONNECTIVITY_SERVICE));
    View view=View.inflate(this,R.layout.manage,null);
    if (mConfig.session != null) {
      ((TextView)view.findViewById(R.id.session)).setText(mConfig.session);
    }
    mDuration=(TextView)view.findViewById(R.id.duration);
    mDataTransmitted=(TextView)view.findViewById(R.id.data_transmitted);
    mDataReceived=(TextView)view.findViewById(R.id.data_received);
    if (mConfig.user.equals(VpnConfig.LEGACY_VPN)) {
      mDialog=new AlertDialog.Builder(this).setIcon(android.R.drawable.ic_dialog_info).setTitle(R.string.legacy_title).setView(view).setNeutralButton(R.string.disconnect,this).setNegativeButton(android.R.string.cancel,this).create();
    }
 else {
      PackageManager pm=getPackageManager();
      ApplicationInfo app=pm.getApplicationInfo(mConfig.user,0);
      mDialog=new AlertDialog.Builder(this).setIcon(app.loadIcon(pm)).setTitle(app.loadLabel(pm)).setView(view).setNeutralButton(R.string.disconnect,this).setNegativeButton(android.R.string.cancel,this).create();
    }
    if (mConfig.configureIntent != null) {
      mDialog.setButton(DialogInterface.BUTTON_POSITIVE,getText(R.string.configure),this);
    }
    mDialog.setOnDismissListener(this);
    mDialog.show();
    if (mHandler == null) {
      mHandler=new Handler(this);
    }
    mHandler.sendEmptyMessage(0);
  }
 catch (  Exception e) {
    Log.e(TAG,"onResume",e);
    finish();
  }
}
