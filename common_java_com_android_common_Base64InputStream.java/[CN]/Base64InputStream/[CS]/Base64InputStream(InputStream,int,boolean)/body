{
  super(out);
  this.encode=encode;
  eof=false;
  inputBuffer=new byte[BUFFER_SIZE];
  if (encode) {
    outputBuffer=new byte[BUFFER_SIZE * 8 / 5 + 10];
    estate=new Base64.EncoderState(flags,outputBuffer);
    dstate=null;
  }
 else {
    outputBuffer=new byte[BUFFER_SIZE * 3 / 4 + 10];
    estate=null;
    dstate=new Base64.DecoderState(flags,outputBuffer);
  }
  outputStart=0;
  outputEnd=0;
}
