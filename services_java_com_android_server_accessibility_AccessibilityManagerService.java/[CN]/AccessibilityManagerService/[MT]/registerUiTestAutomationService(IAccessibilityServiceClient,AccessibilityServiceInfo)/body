{
  mSecurityPolicy.enforceCallingPermission(Manifest.permission.RETRIEVE_WINDOW_CONTENT,FUNCTION_REGISTER_UI_TEST_AUTOMATION_SERVICE);
  ComponentName componentName=new ComponentName("foo.bar","AutomationAccessibilityService");
synchronized (mLock) {
    UserState userState=getCurrentUserStateLocked();
    unbindAllServicesLocked(userState);
    if (!userState.mIsAccessibilityEnabled) {
      userState.mIsAccessibilityEnabled=true;
      scheduleSendStateToClientsLocked(userState);
    }
  }
  mUiAutomationService=new Service(mCurrentUserId,componentName,accessibilityServiceInfo,true);
  mUiAutomationService.onServiceConnected(componentName,serviceClient.asBinder());
}
