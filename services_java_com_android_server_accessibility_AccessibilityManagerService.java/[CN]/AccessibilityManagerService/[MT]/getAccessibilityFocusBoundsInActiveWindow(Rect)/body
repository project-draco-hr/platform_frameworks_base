{
  Service service=getQueryBridge();
  final int connectionId=service.mId;
  AccessibilityInteractionClient client=AccessibilityInteractionClient.getInstance();
  client.addConnection(connectionId,service);
  try {
    AccessibilityNodeInfo root=AccessibilityInteractionClient.getInstance().getRootInActiveWindow(connectionId);
    if (root == null) {
      return false;
    }
    AccessibilityNodeInfo focus=root.findFocus(AccessibilityNodeInfo.FOCUS_ACCESSIBILITY);
    if (focus == null) {
      return false;
    }
    focus.getBoundsInScreen(outBounds);
    MagnificationSpec spec=service.getCompatibleMagnificationSpec(focus.getWindowId());
    if (spec != null && !spec.isNop()) {
      outBounds.offset((int)-spec.offsetX,(int)-spec.offsetY);
      outBounds.scale(1 / spec.scale);
    }
    Rect windowBounds=mTempRect;
    getActiveWindowBounds(windowBounds);
    outBounds.intersect(windowBounds);
    mDefaultDisplay.getRealSize(mTempPoint);
    outBounds.intersect(0,0,mTempPoint.x,mTempPoint.y);
    return true;
  }
  finally {
    client.removeConnection(connectionId);
  }
}
