{
  enforceCallingPermission();
synchronized (mStats) {
    final boolean onBattery=plugType == BatteryStatsImpl.BATTERY_PLUGGED_NONE;
    if (mStats.isOnBattery() == onBattery) {
      mStats.setBatteryStateLocked(status,health,plugType,level,temp,volt);
      return;
    }
  }
  updateExternalStats("battery-state",false);
synchronized (mStats) {
    mStats.setBatteryStateLocked(status,health,plugType,level,temp,volt);
  }
}
