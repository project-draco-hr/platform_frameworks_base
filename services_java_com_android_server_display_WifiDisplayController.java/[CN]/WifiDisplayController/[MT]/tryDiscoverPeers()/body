{
  mWifiP2pManager.discoverPeers(mWifiP2pChannel,new ActionListener(){
    @Override public void onSuccess(){
      if (DEBUG) {
        Slog.d(TAG,"Discover peers succeeded.  Requesting peers now.");
      }
      mDiscoverPeersInProgress=false;
      requestPeers();
    }
    @Override public void onFailure(    int reason){
      if (DEBUG) {
        Slog.d(TAG,"Discover peers failed with reason " + reason + ".");
      }
      if (mDiscoverPeersInProgress) {
        if (reason == 0 && mDiscoverPeersRetriesLeft > 0 && mWfdEnabled) {
          mHandler.postDelayed(new Runnable(){
            @Override public void run(){
              if (mDiscoverPeersInProgress) {
                if (mDiscoverPeersRetriesLeft > 0 && mWfdEnabled) {
                  mDiscoverPeersRetriesLeft-=1;
                  if (DEBUG) {
                    Slog.d(TAG,"Retrying discovery.  Retries left: " + mDiscoverPeersRetriesLeft);
                  }
                  tryDiscoverPeers();
                }
 else {
                  mDiscoverPeersInProgress=false;
                }
              }
            }
          }
,DISCOVER_PEERS_RETRY_DELAY_MILLIS);
        }
 else {
          mDiscoverPeersInProgress=false;
        }
      }
    }
  }
);
}
