{
  float result=sizeBytes;
  int suffix=com.android.internal.R.string.byteShort;
  long mult=1;
  if (result > 900) {
    suffix=com.android.internal.R.string.kilobyteShort;
    mult=TrafficStats.KB_IN_BYTES;
    result=result / 1024;
  }
  if (result > 900) {
    suffix=com.android.internal.R.string.megabyteShort;
    mult=TrafficStats.MB_IN_BYTES;
    result=result / 1024;
  }
  if (result > 900) {
    suffix=com.android.internal.R.string.gigabyteShort;
    mult=TrafficStats.GB_IN_BYTES;
    result=result / 1024;
  }
  if (result > 900) {
    suffix=com.android.internal.R.string.terabyteShort;
    mult=TrafficStats.TB_IN_BYTES;
    result=result / 1024;
  }
  if (result > 900) {
    suffix=com.android.internal.R.string.petabyteShort;
    mult=TrafficStats.PB_IN_BYTES;
    result=result / 1024;
  }
  String value;
  if (result < 1) {
    value=String.format("%.2f",result);
  }
 else   if (result < 10) {
    if ((flags & FLAG_SHORTER) != 0) {
      value=String.format("%.1f",result);
    }
 else {
      value=String.format("%.2f",result);
    }
  }
 else   if (result < 100) {
    if ((flags & FLAG_SHORTER) != 0) {
      value=String.format("%.0f",result);
    }
 else {
      value=String.format("%.2f",result);
    }
  }
 else {
    value=String.format("%.0f",result);
  }
  final String units=res.getString(suffix);
  final long roundedBytes;
  if ((flags & FLAG_CALCULATE_ROUNDED) != 0) {
    roundedBytes=(long)(Double.parseDouble(value) * mult);
  }
 else {
    roundedBytes=0;
  }
  return new BytesResult(value,units,roundedBytes);
}
