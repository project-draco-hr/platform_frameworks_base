{
  if (DEBUG)   Log.d(TAG,"Preparing intent for doc:" + mDocument.documentId);
  String trustedPkg=mResources.getString(R.string.trusted_quick_viewer_package);
  if (!TextUtils.isEmpty(trustedPkg)) {
    Intent intent=new Intent(Intent.ACTION_QUICK_VIEW);
    intent.setDataAndType(mDocument.derivedUri,mDocument.mimeType);
    intent.setFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION);
    intent.setPackage(trustedPkg);
    if (hasRegisteredHandler(intent)) {
      List<String> siblingIds=mModel.getModelIds();
      for (int i=0; i < siblingIds.size(); i++) {
        onNextItem(i,siblingIds);
      }
      intent.putExtra(Intent.EXTRA_INDEX,mDocumentLocation);
      intent.setClipData(mClipData);
      return intent;
    }
 else {
      Log.e(TAG,"Can't resolve trusted quick view package: " + trustedPkg);
    }
  }
  return null;
}
