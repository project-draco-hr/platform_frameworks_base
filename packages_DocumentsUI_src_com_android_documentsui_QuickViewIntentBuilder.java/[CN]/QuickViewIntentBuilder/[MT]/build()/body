{
  if (DEBUG)   Log.d(TAG,"Preparing intent for doc:" + mDocument.documentId);
  Intent intent=new Intent(Intent.ACTION_QUICK_VIEW);
  intent.setDataAndType(mDocument.derivedUri,mDocument.mimeType);
  ComponentName handler=intent.resolveActivity(mPkgManager);
  if (handler == null) {
    return null;
  }
  Cursor cursor=mContext.getCursor();
  for (int i=0; i < cursor.getCount(); i++) {
    onNextItem(i,cursor);
  }
  intent.setFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION);
  intent.putExtra(Intent.EXTRA_INDEX,mDocumentLocation);
  intent.setClipData(mClipData);
  return intent;
}
