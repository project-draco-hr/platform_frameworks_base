{
  boolean persistChanged=false;
  modeFlags|=modeFlagsToGrant;
  if (persist) {
    final int before=persistedModeFlags;
    persistedModeFlags|=modeFlagsToGrant;
    persistChanged=persistedModeFlags != before;
    owner=null;
  }
  if (owner == null) {
    globalModeFlags|=modeFlags;
  }
 else {
    if ((modeFlags & Intent.FLAG_GRANT_READ_URI_PERMISSION) != 0) {
      addReadOwner(owner);
      owner.addReadPermission(this);
    }
    if ((modeFlags & Intent.FLAG_GRANT_WRITE_URI_PERMISSION) != 0) {
      addWriteOwner(owner);
      owner.addWritePermission(this);
    }
  }
  return persistChanged;
}
