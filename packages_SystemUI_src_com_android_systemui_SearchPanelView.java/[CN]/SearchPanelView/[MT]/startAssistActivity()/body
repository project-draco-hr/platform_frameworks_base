{
  if (!mBar.isDeviceProvisioned())   return;
  mBar.animateCollapsePanels(CommandQueue.FLAG_EXCLUDE_SEARCH_PANEL);
  boolean isKeyguardShowing=false;
  try {
    isKeyguardShowing=mWm.isKeyguardLocked();
  }
 catch (  RemoteException e) {
  }
  if (isKeyguardShowing) {
    try {
      mWm.showAssistant();
    }
 catch (    RemoteException e) {
    }
    onAnimationStarted();
  }
 else {
    Intent intent=((SearchManager)mContext.getSystemService(Context.SEARCH_SERVICE)).getAssistIntent(mContext,UserHandle.USER_CURRENT);
    if (intent == null)     return;
    try {
      ActivityManagerNative.getDefault().dismissKeyguardOnNextActivity();
    }
 catch (    RemoteException e) {
    }
    try {
      ActivityOptions opts=ActivityOptions.makeCustomAnimation(mContext,R.anim.search_launch_enter,R.anim.search_launch_exit,getHandler(),this);
      intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
      mContext.startActivityAsUser(intent,opts.toBundle(),new UserHandle(UserHandle.USER_CURRENT));
    }
 catch (    ActivityNotFoundException e) {
      Slog.w(TAG,"Activity not found for " + intent.getAction());
      onAnimationStarted();
    }
  }
}
