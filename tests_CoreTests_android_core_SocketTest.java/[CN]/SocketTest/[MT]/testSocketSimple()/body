{
  ServerSocket ss;
  Socket s, s1;
  int port;
  IOException lastEx=null;
  ss=new ServerSocket();
  for (port=9900; port < 9999; port++) {
    try {
      ss.bind(new InetSocketAddress("127.0.0.1",port));
      lastEx=null;
      break;
    }
 catch (    IOException ex) {
      lastEx=ex;
    }
  }
  if (lastEx != null) {
    throw lastEx;
  }
  s=new Socket("127.0.0.1",port);
  s1=ss.accept();
  s.getOutputStream().write(0xa5);
  assertEquals(0xa5,s1.getInputStream().read());
  s1.getOutputStream().write(0x5a);
  assertEquals(0x5a,s.getInputStream().read());
}
