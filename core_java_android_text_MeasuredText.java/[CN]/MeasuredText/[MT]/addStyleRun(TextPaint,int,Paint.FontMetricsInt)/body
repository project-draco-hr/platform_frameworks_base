{
  if (fm != null) {
    paint.getFontMetricsInt(fm);
  }
  int p=mPos;
  mPos=p + len;
  if (mEasy) {
    boolean isRtl=mDir != Layout.DIR_LEFT_TO_RIGHT;
    return paint.getTextRunAdvances(mChars,p,len,p,len,isRtl,mWidths,p);
  }
  float totalAdvance=0;
  int level=mLevels[p];
  for (int q=p, i=p + 1, e=p + len; ; ++i) {
    if (i == e || mLevels[i] != level) {
      boolean isRtl=(level & 0x1) != 0;
      totalAdvance+=paint.getTextRunAdvances(mChars,q,i - q,q,i - q,isRtl,mWidths,q);
      if (i == e) {
        break;
      }
      q=i;
      level=mLevels[i];
    }
  }
  return totalAdvance;
}
