{
  super.initForMenu(context,menu);
  final Resources res=context.getResources();
  final ActionBarPolicy abp=ActionBarPolicy.get(context);
  if (!mReserveOverflowSet) {
    mReserveOverflow=abp.showsOverflowMenuButton();
  }
  if (!mWidthLimitSet) {
    mWidthLimit=abp.getEmbeddedMenuWidthLimit();
  }
  if (!mMaxItemsSet) {
    mMaxItems=abp.getMaxActionButtons();
  }
  int width=mWidthLimit;
  if (mReserveOverflow) {
    if (mOverflowButton == null) {
      mOverflowButton=new OverflowMenuButton(mSystemContext);
      final int spec=MeasureSpec.makeMeasureSpec(0,MeasureSpec.UNSPECIFIED);
      mOverflowButton.measure(spec,spec);
    }
    width-=mOverflowButton.getMeasuredWidth();
  }
 else {
    mOverflowButton=null;
  }
  mActionItemWidthLimit=width;
  mMinCellSize=(int)(ActionMenuView.MIN_CELL_SIZE * res.getDisplayMetrics().density);
  mScrapActionButtonView=null;
}
