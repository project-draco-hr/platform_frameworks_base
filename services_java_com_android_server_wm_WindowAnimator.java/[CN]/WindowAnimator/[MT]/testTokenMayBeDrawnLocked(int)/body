{
  AppTokenIterator iterator=mService.getDisplayContentLocked(displayId).getTmpAppIterator(FORWARD_ITERATOR);
  while (iterator.hasNext()) {
    AppWindowToken wtoken=iterator.next();
    AppWindowAnimator appAnimator=wtoken.mAppAnimator;
    final boolean allDrawn=wtoken.allDrawn;
    if (allDrawn != appAnimator.allDrawn) {
      appAnimator.allDrawn=allDrawn;
      if (allDrawn) {
        if (appAnimator.freezingScreen) {
          appAnimator.showAllWindowsLocked();
          mService.unsetAppFreezingScreenLocked(wtoken,false,true);
          if (WindowManagerService.DEBUG_ORIENTATION)           Slog.i(TAG,"Setting mOrientationChangeComplete=true because wtoken " + wtoken + " numInteresting="+ wtoken.numInterestingWindows+ " numDrawn="+ wtoken.numDrawnWindows);
          setAppLayoutChanges(appAnimator,WindowManagerPolicy.FINISH_LAYOUT_REDO_WALLPAPER,"testTokenMayBeDrawnLocked: freezingScreen");
        }
 else {
          setAppLayoutChanges(appAnimator,WindowManagerPolicy.FINISH_LAYOUT_REDO_ANIM,"testTokenMayBeDrawnLocked");
          if (!mService.mOpeningApps.contains(wtoken)) {
            mAnimating|=appAnimator.showAllWindowsLocked();
          }
        }
      }
    }
  }
}
