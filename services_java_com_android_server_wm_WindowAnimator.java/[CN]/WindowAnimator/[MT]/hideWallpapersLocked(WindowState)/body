{
  if ((mWallpaperTarget == w && mLowerWallpaperTarget == null) || mWallpaperTarget == null) {
    final int numTokens=mWallpaperTokens.size();
    for (int i=numTokens - 1; i >= 0; i--) {
      final WindowToken token=mWallpaperTokens.get(i);
      final int numWindows=token.windows.size();
      for (int j=numWindows - 1; j >= 0; j--) {
        final WindowState wallpaper=token.windows.get(j);
        final WindowStateAnimator winAnimator=wallpaper.mWinAnimator;
        if (!winAnimator.mLastHidden) {
          winAnimator.hide();
          mService.dispatchWallpaperVisibility(wallpaper,false);
          setPendingLayoutChanges(Display.DEFAULT_DISPLAY,WindowManagerPolicy.FINISH_LAYOUT_REDO_WALLPAPER);
        }
      }
      if (WindowManagerService.DEBUG_WALLPAPER_LIGHT && !token.hidden)       Slog.d(TAG,"Hiding wallpaper " + token + " from "+ w);
      token.hidden=true;
    }
  }
}
