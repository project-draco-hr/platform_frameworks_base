{
  DisplayContentsAnimator displayAnimator=mDisplayContentsAnimators.get(displayId);
  if (dimParams == null) {
    displayAnimator.mDimParams=null;
  }
 else {
    final WindowStateAnimator newWinAnimator=dimParams.mDimWinAnimator;
    final WindowStateAnimator existingDimWinAnimator=displayAnimator.mDimParams == null ? null : displayAnimator.mDimParams.mDimWinAnimator;
    if (newWinAnimator.mSurfaceShown && (existingDimWinAnimator == null || !existingDimWinAnimator.mSurfaceShown || existingDimWinAnimator.mAnimLayer < newWinAnimator.mAnimLayer)) {
      displayAnimator.mDimParams=new DimAnimator.Parameters(dimParams);
    }
  }
}
