{
  final UserInfo user1=new UserInfo(11,"",0);
  user1.serialNumber=1111;
  final UserInfo user2=new UserInfo(13,"",0);
  user2.serialNumber=1313;
  when(mMockUserManager.getUsers()).thenReturn(Arrays.asList(user1,user2));
  when(mMockPrefs.edit()).thenReturn(mMockEdit).thenReturn(mock(SharedPreferences.Editor.class));
  when(mMockPrefs.getInt("222|app_count",-1)).thenReturn(-1);
  final Map allPrefs=new HashMap<String,Object>();
  allPrefs.put("version",null);
  allPrefs.put("some_strange_pref",null);
  allPrefs.put("",null);
  allPrefs.put("|",null);
  allPrefs.put("1313|app_count",null);
  allPrefs.put("1212|app_count",null);
  when(mMockPrefs.getAll()).thenReturn(allPrefs);
  mModel.setCurrentUser(2);
  verify(mMockEdit).remove("some_strange_pref");
  verify(mMockEdit).remove("");
  verify(mMockEdit).remove("|");
  verify(mMockEdit).remove("1212|app_count");
  verify(mMockEdit).apply();
  verifyNoMoreInteractions(mMockEdit);
}
