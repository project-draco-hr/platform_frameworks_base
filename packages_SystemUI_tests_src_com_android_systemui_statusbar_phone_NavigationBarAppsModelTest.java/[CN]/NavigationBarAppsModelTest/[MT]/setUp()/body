{
  super.setUp();
  System.setProperty("dexmaker.dexcache",mContext.getCacheDir().getPath());
  Thread.currentThread().setContextClassLoader(getClass().getClassLoader());
  final Context context=mock(Context.class);
  mMockPackageManager=mock(PackageManager.class);
  mMockPrefs=mock(SharedPreferences.class);
  mMockEdit=mock(SharedPreferences.Editor.class);
  mMockUserManager=mock(UserManager.class);
  when(context.getSharedPreferences("com.android.systemui.navbarapps",Context.MODE_PRIVATE)).thenReturn(mMockPrefs);
  when(context.getSystemService(Context.USER_SERVICE)).thenReturn(mMockUserManager);
  when(context.getPackageManager()).thenReturn(mMockPackageManager);
  setContext(context);
  when(mMockUserManager.getUsers()).thenReturn(new ArrayList<UserInfo>());
  when(mMockPrefs.getInt("version",-1)).thenReturn(2);
  when(mMockPrefs.edit()).thenReturn(mMockEdit);
  mModel=new NavigationBarAppsModel(context){
    @Override protected int getCurrentUser(){
      return 0;
    }
  }
;
}
