{
  if (size + TIMESTAMP_SIZE > MAX_PACKET_SIZE) {
    size=MAX_PACKET_SIZE - TIMESTAMP_SIZE;
  }
  System.arraycopy(message,offset,dest,0,size);
  for (int i=0; i < TIMESTAMP_SIZE; i++) {
    dest[size++]=(byte)timestamp;
    timestamp>>=8;
  }
  return size;
}
