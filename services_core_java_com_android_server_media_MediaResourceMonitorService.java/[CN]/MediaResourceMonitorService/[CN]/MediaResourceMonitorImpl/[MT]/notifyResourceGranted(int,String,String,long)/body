{
  if (DEBUG) {
    Slog.d(TAG,"notifyResourceGranted(pid=" + pid + ", type="+ type+ ", subType="+ subType+ ", value="+ value+ ")");
  }
  final long identity=Binder.clearCallingIdentity();
  try {
    String pkgNames[]=getPackageNamesFromPid(pid);
    Integer resourceType=null;
    if (RESOURCE_AUDIO_CODEC.equals(subType)) {
      resourceType=Intent.EXTRA_MEDIA_RESOURCE_TYPE_AUDIO_CODEC;
    }
 else     if (RESOURCE_VIDEO_CODEC.equals(subType)) {
      resourceType=Intent.EXTRA_MEDIA_RESOURCE_TYPE_VIDEO_CODEC;
    }
    if (pkgNames != null && resourceType != null) {
      Intent intent=new Intent(Intent.ACTION_MEDIA_RESOURCE_GRANTED);
      intent.putExtra(Intent.EXTRA_PACKAGES,pkgNames);
      intent.putExtra(Intent.EXTRA_MEDIA_RESOURCE_TYPE,resourceType);
      getContext().sendBroadcastAsUser(intent,new UserHandle(ActivityManager.getCurrentUser()),android.Manifest.permission.RECEIVE_MEDIA_RESOURCE_USAGE);
    }
  }
  finally {
    Binder.restoreCallingIdentity(identity);
  }
}
