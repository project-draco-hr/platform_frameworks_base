{
  int rawOffset=offset;
  if (dst) {
    rawOffset-=3600000;
  }
  String[] zones=TimeZone.getAvailableIDs(rawOffset);
  TimeZone guess=null;
  Date d=new Date(when);
  for (  String zone : zones) {
    TimeZone tz=TimeZone.getTimeZone(zone);
    if (tz.getOffset(when) == offset && tz.inDaylightTime(d) == dst) {
      guess=tz;
      break;
    }
  }
  return guess;
}
