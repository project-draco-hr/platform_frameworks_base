{
  DataConnectionTracker dcTracker=phone.mDataConnection;
synchronized (this) {
    if (!mPendingRadioPowerOffAfterDataOff) {
      if (dcTracker.isAnyActiveDataConnections()) {
        dcTracker.cleanUpAllConnections(Phone.REASON_RADIO_TURNED_OFF);
        if (sendEmptyMessageDelayed(EVENT_SET_RADIO_POWER_OFF,30000)) {
          if (DBG)           log("Wait upto 30s for data to disconnect, then turn off radio.");
          mPendingRadioPowerOffAfterDataOff=true;
        }
 else {
          Log.w(LOG_TAG,"Cannot send delayed Msg, turn off radio right away.");
          hangupAndPowerOff();
        }
      }
 else {
        dcTracker.cleanUpAllConnections(Phone.REASON_RADIO_TURNED_OFF);
        if (DBG)         log("Data disconnected, turn off radio right away.");
        hangupAndPowerOff();
      }
    }
  }
}
