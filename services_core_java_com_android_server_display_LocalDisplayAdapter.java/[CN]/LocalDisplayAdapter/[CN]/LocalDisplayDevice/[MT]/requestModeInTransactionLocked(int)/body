{
  if (modeId == 0) {
    modeId=mDefaultModeId;
  }
 else   if (mSupportedModes.indexOfKey(modeId) < 0) {
    Slog.w(TAG,"Requested mode " + modeId + " is not supported by this display,"+ " reverting to default display mode.");
    modeId=mDefaultModeId;
  }
  if (mActiveModeId == modeId && !mActiveModeInvalid) {
    return;
  }
  DisplayModeRecord record=mSupportedModes.get(modeId);
  SurfaceControl.setActiveConfig(getDisplayTokenLocked(),record.mPhysIndex);
  mActiveModeId=modeId;
  mActiveModeInvalid=false;
  updateDeviceInfoLocked();
}
