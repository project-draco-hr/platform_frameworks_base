{
  Object obj=null;
  try {
    obj=Providers.startJarVerification();
    PKCS7 block=new PKCS7(blockBytes);
    if (block.verify(sfBytes) == null) {
      throw new GeneralSecurityException("Failed to verify signature");
    }
    X509Certificate[] blockCerts=block.getCertificates();
    Certificate[] signerCertChain=null;
    if (blockCerts != null) {
      signerCertChain=new Certificate[blockCerts.length];
      for (int i=0; i < blockCerts.length; ++i) {
        signerCertChain[i]=blockCerts[i];
      }
    }
    return signerCertChain;
  }
 catch (  IOException e) {
    throw new GeneralSecurityException("IO exception verifying jar cert",e);
  }
 finally {
    Providers.stopJarVerification(obj);
  }
}
