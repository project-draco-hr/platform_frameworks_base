{
  if (TextUtils.isEmpty(value)) {
    value="";
  }
  final int asciiFirst=0x20;
  final int asciiLast=0x7E;
  final StringBuilder builder=new StringBuilder();
  final int length=value.length();
  boolean needQuote=false;
  for (int i=0; i < length; i=value.offsetByCodePoints(i,1)) {
    final int codePoint=value.codePointAt(i);
    if (codePoint < asciiFirst || codePoint == '"') {
      continue;
    }
    builder.appendCodePoint(codePoint);
    for (    int indicator : escapeIndicators) {
      if (codePoint == indicator) {
        needQuote=true;
        break;
      }
    }
  }
  final String result=builder.toString();
  return ((result.isEmpty() || VCardUtils.containsOnlyWhiteSpaces(result)) ? "" : (needQuote ? ('"' + result + '"') : result));
}
