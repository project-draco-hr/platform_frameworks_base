{
  Set<Integer> authorizedKeymasterKeyDigests=new HashSet<Integer>();
  for (  int keymasterDigest : KeyProperties.Digest.allToKeymaster(authorizedKeyDigests)) {
    authorizedKeymasterKeyDigests.add(keymasterDigest);
  }
  Set<Integer> supportedKeymasterSignatureDigests=new HashSet<Integer>();
  for (  int keymasterDigest : KeyProperties.Digest.allToKeymaster(supportedSignatureDigests)) {
    supportedKeymasterSignatureDigests.add(keymasterDigest);
  }
  if (authorizedKeymasterKeyDigests.contains(KeymasterDefs.KM_DIGEST_NONE)) {
    return supportedKeymasterSignatureDigests;
  }
 else {
    Set<Integer> result=new HashSet<Integer>(supportedKeymasterSignatureDigests);
    result.retainAll(authorizedKeymasterKeyDigests);
    return result;
  }
}
