{
switch (keymasterAlgorithm) {
case KeymasterDefs.KM_ALGORITHM_EC:
    if (keySize < EC_MIN_KEY_SIZE || keySize > EC_MAX_KEY_SIZE) {
      throw new InvalidAlgorithmParameterException("EC key size must be >= " + EC_MIN_KEY_SIZE + " and <= "+ EC_MAX_KEY_SIZE);
    }
  break;
case KeymasterDefs.KM_ALGORITHM_RSA:
if (keySize < RSA_MIN_KEY_SIZE || keySize > RSA_MAX_KEY_SIZE) {
  throw new InvalidAlgorithmParameterException("RSA key size must be >= " + RSA_MIN_KEY_SIZE + " and <= "+ RSA_MAX_KEY_SIZE);
}
break;
default :
throw new ProviderException("Unsupported algorithm: " + keymasterAlgorithm);
}
}
