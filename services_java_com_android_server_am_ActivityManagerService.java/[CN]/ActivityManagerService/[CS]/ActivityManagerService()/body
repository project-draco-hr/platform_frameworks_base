{
  String v=System.getenv("ANDROID_SIMPLE_PROCESS_MANAGEMENT");
  if (v != null && Integer.getInteger(v) != 0) {
    mSimpleProcessManagement=true;
  }
  v=System.getenv("ANDROID_DEBUG_APP");
  if (v != null) {
    mSimpleProcessManagement=true;
  }
  MY_PID=Process.myPid();
  File dataDir=Environment.getDataDirectory();
  File systemDir=new File(dataDir,"system");
  systemDir.mkdirs();
  mBatteryStatsService=new BatteryStatsService(new File(systemDir,"batterystats.bin").toString());
  mBatteryStatsService.getActiveStatistics().readLocked();
  mBatteryStatsService.getActiveStatistics().writeLocked();
  mUsageStatsService=new UsageStatsService(new File(systemDir,"usagestats.bin").toString());
  mConfiguration.makeDefault();
  mProcessStats.init();
  Watchdog.getInstance().addMonitor(this);
  FOREGROUND_APP_ADJ=Integer.valueOf(SystemProperties.get("ro.FOREGROUND_APP_ADJ"));
  VISIBLE_APP_ADJ=Integer.valueOf(SystemProperties.get("ro.VISIBLE_APP_ADJ"));
  SECONDARY_SERVER_ADJ=Integer.valueOf(SystemProperties.get("ro.SECONDARY_SERVER_ADJ"));
  HOME_APP_ADJ=Integer.valueOf(SystemProperties.get("ro.HOME_APP_ADJ"));
  HIDDEN_APP_MIN_ADJ=Integer.valueOf(SystemProperties.get("ro.HIDDEN_APP_MIN_ADJ"));
  CONTENT_PROVIDER_ADJ=Integer.valueOf(SystemProperties.get("ro.CONTENT_PROVIDER_ADJ"));
  HIDDEN_APP_MAX_ADJ=CONTENT_PROVIDER_ADJ - 1;
  EMPTY_APP_ADJ=Integer.valueOf(SystemProperties.get("ro.EMPTY_APP_ADJ"));
  FOREGROUND_APP_MEM=Integer.valueOf(SystemProperties.get("ro.FOREGROUND_APP_MEM")) * PAGE_SIZE;
  VISIBLE_APP_MEM=Integer.valueOf(SystemProperties.get("ro.VISIBLE_APP_MEM")) * PAGE_SIZE;
  SECONDARY_SERVER_MEM=Integer.valueOf(SystemProperties.get("ro.SECONDARY_SERVER_MEM")) * PAGE_SIZE;
  HOME_APP_MEM=Integer.valueOf(SystemProperties.get("ro.HOME_APP_MEM")) * PAGE_SIZE;
  HIDDEN_APP_MEM=Integer.valueOf(SystemProperties.get("ro.HIDDEN_APP_MEM")) * PAGE_SIZE;
  EMPTY_APP_MEM=Integer.valueOf(SystemProperties.get("ro.EMPTY_APP_MEM")) * PAGE_SIZE;
  mProcessStatsThread=new Thread("ProcessStats"){
    public void run(){
      while (true) {
        try {
          try {
synchronized (this) {
              final long now=SystemClock.uptimeMillis();
              long nextCpuDelay=(mLastCpuTime + MONITOR_CPU_MAX_TIME) - now;
              long nextWriteDelay=(mLastWriteTime + BATTERY_STATS_TIME) - now;
              if (nextWriteDelay < nextCpuDelay) {
                nextCpuDelay=nextWriteDelay;
              }
              if (nextCpuDelay > 0) {
                this.wait(nextCpuDelay);
              }
            }
          }
 catch (          InterruptedException e) {
          }
          updateCpuStatsNow();
        }
 catch (        Exception e) {
          Log.e(TAG,"Unexpected exception collecting process stats",e);
        }
      }
    }
  }
;
  mProcessStatsThread.start();
}
