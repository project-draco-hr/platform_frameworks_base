{
  final String name=app.processName;
  final int uid=app.uid;
  if (DEBUG_PROCESSES)   Slog.d(TAG,"Force removing proc " + app.toShortString() + " ("+ name+ "/"+ uid+ ")");
  mProcessNames.remove(name,uid);
  mIsolatedProcesses.remove(app.uid);
  if (mHeavyWeightProcess == app) {
    mHandler.sendMessage(mHandler.obtainMessage(CANCEL_HEAVY_NOTIFICATION_MSG,mHeavyWeightProcess.userId,0));
    mHeavyWeightProcess=null;
  }
  boolean needRestart=false;
  if (app.pid > 0 && app.pid != MY_PID) {
    int pid=app.pid;
synchronized (mPidsSelfLocked) {
      mPidsSelfLocked.remove(pid);
      mHandler.removeMessages(PROC_START_TIMEOUT_MSG,app);
    }
    Slog.i(TAG,"Killing proc " + app.toShortString() + ": "+ reason);
    handleAppDiedLocked(app,true,allowRestart);
    mLruProcesses.remove(app);
    Process.killProcessQuiet(pid);
    if (app.persistent && !app.isolated) {
      if (!callerWillRestart) {
        addAppLocked(app.info,false);
      }
 else {
        needRestart=true;
      }
    }
  }
 else {
    mRemovedProcesses.add(app);
  }
  return needRestart;
}
