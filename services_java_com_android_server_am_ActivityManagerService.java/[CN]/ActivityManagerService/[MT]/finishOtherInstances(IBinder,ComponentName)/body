{
synchronized (this) {
    final long origId=Binder.clearCallingIdentity();
    int N=mMainStack.mHistory.size();
    TaskRecord lastTask=null;
    for (int i=0; i < N; i++) {
      ActivityRecord r=(ActivityRecord)mMainStack.mHistory.get(i);
      if (r.realActivity.equals(className) && r.appToken != token && lastTask != r.task) {
        if (r.stack.finishActivityLocked(r,i,Activity.RESULT_CANCELED,null,"others")) {
          i--;
          N--;
        }
      }
      lastTask=r.task;
    }
    Binder.restoreCallingIdentity(origId);
  }
}
