{
synchronized (this) {
    if (checkCallingPermission(android.Manifest.permission.DUMP) != PackageManager.PERMISSION_GRANTED) {
      pw.println("Permission Denial: can't dump ActivityManager from from pid=" + Binder.getCallingPid() + ", uid="+ Binder.getCallingUid()+ " without permission "+ android.Manifest.permission.DUMP);
      return;
    }
    pw.println("Content Providers in Current Activity Manager State:");
    boolean needSep=false;
    if (mProvidersByName.size() > 0) {
      pw.println("  Published content providers (by name):");
      Iterator it=mProvidersByName.entrySet().iterator();
      while (it.hasNext()) {
        Map.Entry e=(Map.Entry)it.next();
        ContentProviderRecord r=(ContentProviderRecord)e.getValue();
        pw.println("  Provider " + (String)e.getKey());
        r.dump(pw,"    ");
      }
      needSep=true;
    }
    if (mProvidersByClass.size() > 0) {
      if (needSep)       pw.println(" ");
      pw.println("  Published content providers (by class):");
      Iterator it=mProvidersByClass.entrySet().iterator();
      while (it.hasNext()) {
        Map.Entry e=(Map.Entry)it.next();
        ContentProviderRecord r=(ContentProviderRecord)e.getValue();
        pw.println("  Provider " + (String)e.getKey());
        r.dump(pw,"    ");
      }
      needSep=true;
    }
    if (mLaunchingProviders.size() > 0) {
      if (needSep)       pw.println(" ");
      pw.println("  Launching content providers:");
      for (int i=mLaunchingProviders.size() - 1; i >= 0; i--) {
        pw.println("  Provider #" + i + ":");
        ((ContentProviderRecord)mLaunchingProviders.get(i)).dump(pw,"    ");
      }
      needSep=true;
    }
    pw.println();
    pw.println("Granted Uri Permissions:");
    for (int i=0; i < mGrantedUriPermissions.size(); i++) {
      int uid=mGrantedUriPermissions.keyAt(i);
      HashMap<Uri,UriPermission> perms=mGrantedUriPermissions.valueAt(i);
      pw.println("  Uris granted to uid " + uid + ":");
      for (      UriPermission perm : perms.values()) {
        perm.dump(pw,"    ");
      }
    }
  }
}
