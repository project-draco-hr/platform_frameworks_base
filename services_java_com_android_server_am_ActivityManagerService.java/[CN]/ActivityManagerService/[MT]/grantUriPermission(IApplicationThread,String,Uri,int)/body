{
synchronized (this) {
    final ProcessRecord r=getRecordForAppLocked(caller);
    if (r == null) {
      throw new SecurityException("Unable to find app for caller " + caller + " when granting permission to uri "+ uri);
    }
    if (targetPkg == null) {
      Log.w(TAG,"grantUriPermission: null target");
      return;
    }
    if (uri == null) {
      Log.w(TAG,"grantUriPermission: null uri");
      return;
    }
    grantUriPermissionLocked(r.info.uid,targetPkg,uri,modeFlags,null);
  }
}
