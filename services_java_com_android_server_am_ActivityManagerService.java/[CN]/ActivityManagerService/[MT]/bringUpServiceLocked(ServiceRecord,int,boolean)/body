{
  if (r.app != null && r.app.thread != null) {
    sendServiceArgsLocked(r,false);
    return true;
  }
  if (!whileRestarting && r.restartDelay > 0) {
    return true;
  }
  if (DEBUG_SERVICE)   Slog.v(TAG,"Bringing up " + r + " "+ r.intent);
  mRestartingServices.remove(r);
  try {
    AppGlobals.getPackageManager().setPackageStoppedState(r.packageName,false);
  }
 catch (  RemoteException e) {
  }
catch (  IllegalArgumentException e) {
    Slog.w(TAG,"Failed trying to unstop package " + r.packageName + ": "+ e);
  }
  final String appName=r.processName;
  ProcessRecord app=getProcessRecordLocked(appName,r.appInfo.uid);
  if (app != null && app.thread != null) {
    try {
      app.addPackage(r.appInfo.packageName);
      realStartServiceLocked(r,app);
      return true;
    }
 catch (    RemoteException e) {
      Slog.w(TAG,"Exception when starting service " + r.shortName,e);
    }
  }
  if (startProcessLocked(appName,r.appInfo,true,intentFlags,"service",r.name,false) == null) {
    Slog.w(TAG,"Unable to launch app " + r.appInfo.packageName + "/"+ r.appInfo.uid+ " for service "+ r.intent.getIntent()+ ": process is bad");
    bringDownServiceLocked(r,true);
    return false;
  }
  if (!mPendingServices.contains(r)) {
    mPendingServices.add(r);
  }
  return true;
}
