{
  if (r.errorReportReceiver == null) {
    return null;
  }
  if (!r.crashing && !r.notResponding) {
    return null;
  }
  try {
    ApplicationErrorReport report=new ApplicationErrorReport();
    report.packageName=r.info.packageName;
    report.installerPackageName=r.errorReportReceiver.getPackageName();
    report.processName=r.processName;
    if (r.crashing) {
      report.type=ApplicationErrorReport.TYPE_CRASH;
      report.crashInfo=new ApplicationErrorReport.CrashInfo();
      ByteArrayInputStream byteStream=new ByteArrayInputStream(r.crashingReport.crashData);
      DataInputStream dataStream=new DataInputStream(byteStream);
      CrashData crashData=new CrashData(dataStream);
      ThrowableData throwData=crashData.getThrowableData();
      report.time=crashData.getTime();
      report.crashInfo.stackTrace=throwData.toString();
      String exceptionMessage=throwData.getMessage();
      while (throwData.getCause() != null) {
        throwData=throwData.getCause();
        String msg=throwData.getMessage();
        if (msg != null && msg.length() > 0) {
          exceptionMessage=msg;
        }
      }
      StackTraceElementData trace=throwData.getStackTrace()[0];
      report.crashInfo.exceptionMessage=exceptionMessage;
      report.crashInfo.exceptionClassName=throwData.getType();
      report.crashInfo.throwFileName=trace.getFileName();
      report.crashInfo.throwClassName=trace.getClassName();
      report.crashInfo.throwMethodName=trace.getMethodName();
      report.crashInfo.throwLineNumber=trace.getLineNumber();
    }
 else     if (r.notResponding) {
      report.type=ApplicationErrorReport.TYPE_ANR;
      report.anrInfo=new ApplicationErrorReport.AnrInfo();
      report.anrInfo.activity=r.notRespondingReport.tag;
      report.anrInfo.cause=r.notRespondingReport.shortMsg;
      report.anrInfo.info=r.notRespondingReport.longMsg;
    }
    return report;
  }
 catch (  IOException e) {
  }
  return null;
}
