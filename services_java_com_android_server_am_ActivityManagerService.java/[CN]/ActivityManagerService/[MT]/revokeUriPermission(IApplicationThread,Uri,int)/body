{
synchronized (this) {
    final ProcessRecord r=getRecordForAppLocked(caller);
    if (r == null) {
      throw new SecurityException("Unable to find app for caller " + caller + " when revoking permission to uri "+ uri);
    }
    if (uri == null) {
      Log.w(TAG,"revokeUriPermission: null uri");
      return;
    }
    modeFlags&=(Intent.FLAG_GRANT_READ_URI_PERMISSION | Intent.FLAG_GRANT_WRITE_URI_PERMISSION);
    if (modeFlags == 0) {
      return;
    }
    final IPackageManager pm=ActivityThread.getPackageManager();
    final String authority=uri.getAuthority();
    ProviderInfo pi=null;
    ContentProviderRecord cpr=(ContentProviderRecord)mProvidersByName.get(authority);
    if (cpr != null) {
      pi=cpr.info;
    }
 else {
      try {
        pi=pm.resolveContentProvider(authority,PackageManager.GET_URI_PERMISSION_PATTERNS);
      }
 catch (      RemoteException ex) {
      }
    }
    if (pi == null) {
      Log.w(TAG,"No content provider found for: " + authority);
      return;
    }
    revokeUriPermissionLocked(r.info.uid,uri,modeFlags);
  }
}
