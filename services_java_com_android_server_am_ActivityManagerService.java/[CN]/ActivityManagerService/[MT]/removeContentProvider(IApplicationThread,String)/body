{
synchronized (this) {
    ContentProviderRecord cpr=mProvidersByName.get(name);
    if (cpr == null) {
      if (DEBUG_PROVIDER)       Slog.v(TAG,name + " provider not found in providers list");
      return;
    }
    final ProcessRecord r=getRecordForAppLocked(caller);
    if (r == null) {
      throw new SecurityException("Unable to find app for caller " + caller + " when removing content provider "+ name);
    }
    ContentProviderRecord localCpr=mProvidersByClass.get(cpr.info.name);
    if (DEBUG_PROVIDER)     Slog.v(TAG,"Removing provider requested by " + r.info.processName + " from process "+ localCpr.appInfo.processName);
    if (localCpr.app == r) {
      Slog.w(TAG,"removeContentProvider called on local provider: " + cpr.info.name + " in process "+ r.processName);
      return;
    }
 else {
      Integer cnt=r.conProviders.get(localCpr);
      if (cnt == null || cnt.intValue() <= 1) {
        localCpr.clients.remove(r);
        r.conProviders.remove(localCpr);
      }
 else {
        r.conProviders.put(localCpr,new Integer(cnt.intValue() - 1));
      }
    }
    updateOomAdjLocked();
  }
}
