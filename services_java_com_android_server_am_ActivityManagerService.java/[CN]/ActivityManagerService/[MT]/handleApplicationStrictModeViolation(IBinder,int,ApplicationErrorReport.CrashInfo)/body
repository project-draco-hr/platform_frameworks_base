{
  ProcessRecord r=findAppProcess(app);
  Log.w(TAG,"handleApplicationStrictModeViolation.");
  if ((violationMask & StrictMode.PENALTY_DROPBOX) != 0) {
    Integer crashFingerprint=crashInfo.stackTrace.hashCode();
    Log.d(TAG,"supposed to drop box for fingerprint " + crashFingerprint);
  }
  if ((violationMask & StrictMode.PENALTY_DIALOG) != 0) {
    AppErrorResult result=new AppErrorResult();
synchronized (this) {
      final long origId=Binder.clearCallingIdentity();
      Message msg=Message.obtain();
      msg.what=SHOW_STRICT_MODE_VIOLATION_MSG;
      HashMap<String,Object> data=new HashMap<String,Object>();
      data.put("result",result);
      data.put("app",r);
      msg.obj=data;
      mHandler.sendMessage(msg);
      Binder.restoreCallingIdentity(origId);
    }
    int res=result.get();
    Log.w(TAG,"handleApplicationStrictModeViolation; res=" + res);
  }
}
