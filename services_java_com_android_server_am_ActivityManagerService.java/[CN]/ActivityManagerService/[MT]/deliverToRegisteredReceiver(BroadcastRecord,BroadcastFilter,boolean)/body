{
  boolean skip=false;
  if (filter.requiredPermission != null) {
    int perm=checkComponentPermission(filter.requiredPermission,r.callingPid,r.callingUid,-1);
    if (perm != PackageManager.PERMISSION_GRANTED) {
      Log.w(TAG,"Permission Denial: broadcasting " + r.intent.toString() + " from "+ r.callerPackage+ " (pid="+ r.callingPid+ ", uid="+ r.callingUid+ ")"+ " requires "+ filter.requiredPermission+ " due to registered receiver "+ filter);
      skip=true;
    }
  }
  if (r.requiredPermission != null) {
    int perm=checkComponentPermission(r.requiredPermission,filter.receiverList.pid,filter.receiverList.uid,-1);
    if (perm != PackageManager.PERMISSION_GRANTED) {
      Log.w(TAG,"Permission Denial: receiving " + r.intent.toString() + " to "+ filter.receiverList.app+ " (pid="+ filter.receiverList.pid+ ", uid="+ filter.receiverList.uid+ ")"+ " requires "+ r.requiredPermission+ " due to sender "+ r.callerPackage+ " (uid "+ r.callingUid+ ")");
      skip=true;
    }
  }
  if (!skip) {
    if (ordered) {
      r.receiver=filter.receiverList.receiver.asBinder();
      r.curFilter=filter;
      filter.receiverList.curBroadcast=r;
      r.state=BroadcastRecord.CALL_IN_RECEIVE;
    }
    try {
      if (DEBUG_BROADCAST) {
        int seq=r.intent.getIntExtra("seq",-1);
        Log.i(TAG,"Sending broadcast " + r.intent.getAction() + " seq="+ seq+ " app="+ filter.receiverList.app);
      }
      performReceive(filter.receiverList.app,filter.receiverList.receiver,new Intent(r.intent),r.resultCode,r.resultData,r.resultExtras,r.ordered);
      if (ordered) {
        r.state=BroadcastRecord.CALL_DONE_RECEIVE;
      }
    }
 catch (    RemoteException e) {
      Log.w(TAG,"Failure sending broadcast " + r.intent,e);
      if (ordered) {
        r.receiver=null;
        r.curFilter=null;
        filter.receiverList.curBroadcast=null;
      }
    }
  }
}
