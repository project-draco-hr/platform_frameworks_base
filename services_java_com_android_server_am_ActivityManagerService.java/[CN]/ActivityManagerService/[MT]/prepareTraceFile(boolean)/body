{
  String tracesPath=SystemProperties.get("dalvik.vm.stack-trace-file",null);
  boolean fileReady=false;
  if (!TextUtils.isEmpty(tracesPath)) {
    File f=new File(tracesPath);
    if (!f.exists()) {
      File dir=f.getParentFile();
      if (!dir.exists()) {
        fileReady=dir.mkdirs();
        FileUtils.setPermissions(dir.getAbsolutePath(),FileUtils.S_IRWXU | FileUtils.S_IRWXG | FileUtils.S_IXOTH,-1,-1);
      }
 else       if (dir.isDirectory()) {
        fileReady=true;
      }
    }
 else     if (removeExisting) {
      Log.i(TAG,"Removing old ANR trace file from " + tracesPath);
      fileReady=f.delete();
    }
    if (removeExisting) {
      try {
        f.createNewFile();
        FileUtils.setPermissions(f.getAbsolutePath(),FileUtils.S_IRWXU | FileUtils.S_IRWXG | FileUtils.S_IWOTH| FileUtils.S_IROTH,-1,-1);
        fileReady=true;
      }
 catch (      IOException e) {
        Log.w(TAG,"Unable to make ANR traces file",e);
      }
    }
  }
  return fileReady;
}
