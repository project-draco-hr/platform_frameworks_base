{
synchronized (this) {
    if (DEBUG_SERVICE)     Log.v(TAG,"stopServiceToken: " + className + " "+ token+ " startId="+ startId);
    ServiceRecord r=findServiceLocked(className,token);
    if (r != null && (startId < 0 || r.lastStartId == startId)) {
synchronized (r.stats.getBatteryStats()) {
        r.stats.stopRunningLocked();
        r.startRequested=false;
      }
      final long origId=Binder.clearCallingIdentity();
      bringDownServiceLocked(r,false);
      Binder.restoreCallingIdentity(origId);
      return true;
    }
  }
  return false;
}
