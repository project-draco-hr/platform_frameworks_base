{
  if (intent != null && intent.hasFileDescriptors() == true) {
    throw new IllegalArgumentException("File descriptors passed in Intent");
  }
synchronized (this) {
    int flags=intent.getFlags();
    if (!mSystemReady) {
      if ((flags & Intent.FLAG_RECEIVER_REGISTERED_ONLY_BEFORE_BOOT) != 0) {
        intent=new Intent(intent);
        intent.addFlags(Intent.FLAG_RECEIVER_REGISTERED_ONLY);
      }
 else       if ((flags & Intent.FLAG_RECEIVER_REGISTERED_ONLY) == 0) {
        Log.e(TAG,"Attempt to launch receivers of broadcast intent " + intent + " before boot completion");
        throw new IllegalStateException("Cannot broadcast before boot completed");
      }
    }
    if ((flags & Intent.FLAG_RECEIVER_BOOT_UPGRADE) != 0) {
      throw new IllegalArgumentException("Can't use FLAG_RECEIVER_BOOT_UPGRADE here");
    }
    final ProcessRecord callerApp=getRecordForAppLocked(caller);
    final int callingPid=Binder.getCallingPid();
    final int callingUid=Binder.getCallingUid();
    final long origId=Binder.clearCallingIdentity();
    int res=broadcastIntentLocked(callerApp,callerApp != null ? callerApp.info.packageName : null,intent,resolvedType,resultTo,resultCode,resultData,map,requiredPermission,serialized,sticky,callingPid,callingUid);
    Binder.restoreCallingIdentity(origId);
    return res;
  }
}
