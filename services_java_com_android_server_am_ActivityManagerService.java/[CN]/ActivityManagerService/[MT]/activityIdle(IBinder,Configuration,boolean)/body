{
  final long origId=Binder.clearCallingIdentity();
synchronized (this) {
    ActivityStack stack=ActivityRecord.getStackLocked(token);
    if (stack != null) {
      ActivityRecord r=stack.activityIdleInternalLocked(token,false,config);
      if (stopProfiling) {
        if ((mProfileProc == r.app) && (mProfileFd != null)) {
          try {
            mProfileFd.close();
          }
 catch (          IOException e) {
          }
          clearProfilerLocked();
        }
      }
    }
  }
  Binder.restoreCallingIdentity(origId);
}
