{
  ArrayList<ProcessRecord> procs=collectProcesses(pw,args);
  if (procs == null) {
    return;
  }
  final boolean isCheckinRequest=scanArgs(args,"--checkin");
  long uptime=SystemClock.uptimeMillis();
  long realtime=SystemClock.elapsedRealtime();
  if (isCheckinRequest) {
    pw.println(uptime + "," + realtime);
    pw.flush();
  }
 else {
    pw.println("Applications Memory Usage (kB):");
    pw.println("Uptime: " + uptime + " Realtime: "+ realtime);
  }
  for (int i=procs.size() - 1; i >= 0; i--) {
    ProcessRecord r=procs.get(i);
    if (r.thread != null) {
      if (!isCheckinRequest) {
        pw.println("\n** MEMINFO in pid " + r.pid + " ["+ r.processName+ "] **");
        pw.flush();
      }
      try {
        TransferPipe.goDump(r.thread.asBinder(),fd,args);
      }
 catch (      IOException e) {
        pw.println("Failure: " + e);
        pw.flush();
      }
catch (      RemoteException e) {
        if (!isCheckinRequest) {
          pw.println("Got RemoteException!");
          pw.flush();
        }
      }
    }
  }
}
