{
  if (DEBUG_URI_PERMISSION)   Slog.v(TAG,"readGrantedUriPermissions()");
  final long now=System.currentTimeMillis();
  FileInputStream fis=null;
  try {
    fis=mGrantFile.openRead();
    final XmlPullParser in=Xml.newPullParser();
    in.setInput(fis,null);
    int type;
    while ((type=in.next()) != END_DOCUMENT) {
      final String tag=in.getName();
      if (type == START_TAG) {
        if (TAG_URI_GRANT.equals(tag)) {
          final int userHandle=readIntAttribute(in,ATTR_USER_HANDLE);
          final String sourcePkg=in.getAttributeValue(null,ATTR_SOURCE_PKG);
          final String targetPkg=in.getAttributeValue(null,ATTR_TARGET_PKG);
          final Uri uri=Uri.parse(in.getAttributeValue(null,ATTR_URI));
          final int modeFlags=readIntAttribute(in,ATTR_MODE_FLAGS);
          final long createdTime=readLongAttribute(in,ATTR_CREATED_TIME,now);
          final ProviderInfo pi=getProviderInfoLocked(uri.getAuthority(),userHandle);
          if (pi != null && sourcePkg.equals(pi.packageName)) {
            int targetUid=-1;
            try {
              targetUid=AppGlobals.getPackageManager().getPackageUid(targetPkg,userHandle);
            }
 catch (            RemoteException e) {
            }
            if (targetUid != -1) {
              final UriPermission perm=findOrCreateUriPermissionLocked(sourcePkg,targetPkg,targetUid,uri);
              perm.initPersistedModes(modeFlags,createdTime);
            }
          }
 else {
            Slog.w(TAG,"Persisted grant for " + uri + " had source "+ sourcePkg+ " but instead found "+ pi);
          }
        }
      }
    }
  }
 catch (  FileNotFoundException e) {
  }
catch (  IOException e) {
    Log.wtf(TAG,"Failed reading Uri grants",e);
  }
catch (  XmlPullParserException e) {
    Log.wtf(TAG,"Failed reading Uri grants",e);
  }
 finally {
    IoUtils.closeQuietly(fis);
  }
}
