{
  if (checkCallingPermission(android.Manifest.permission.SET_ACTIVITY_WATCHER) != PackageManager.PERMISSION_GRANTED) {
    throw new SecurityException("Requires permission " + android.Manifest.permission.SET_ACTIVITY_WATCHER);
  }
  Log.i(TAG,"Sending shutdown broadcast...");
  BroadcastReceiver br=new BroadcastReceiver(){
    @Override public void onReceive(    Context context,    Intent intent){
      Log.i(TAG,"Shutting down activity manager...");
      shutdown(10000);
      Log.i(TAG,"Shutdown complete, restarting!");
      Process.killProcess(Process.myPid());
      System.exit(10);
    }
  }
;
  Intent intent=new Intent(Intent.ACTION_SHUTDOWN);
  intent.addFlags(Intent.FLAG_RECEIVER_FOREGROUND);
  intent.putExtra(Intent.EXTRA_SHUTDOWN_USERSPACE_ONLY,true);
  br.onReceive(mContext,intent);
}
