{
  if (checkCallingPermission(android.Manifest.permission.KILL_BACKGROUND_PROCESSES) != PackageManager.PERMISSION_GRANTED && checkCallingPermission(android.Manifest.permission.RESTART_PACKAGES) != PackageManager.PERMISSION_GRANTED) {
    String msg="Permission Denial: killBackgroundProcesses() from pid=" + Binder.getCallingPid() + ", uid="+ Binder.getCallingUid()+ " requires "+ android.Manifest.permission.KILL_BACKGROUND_PROCESSES;
    Slog.w(TAG,msg);
    throw new SecurityException(msg);
  }
  int userId=UserHandle.getCallingUserId();
  long callingId=Binder.clearCallingIdentity();
  try {
    IPackageManager pm=AppGlobals.getPackageManager();
    int pkgUid=-1;
synchronized (this) {
      try {
        pkgUid=pm.getPackageUid(packageName,userId);
      }
 catch (      RemoteException e) {
      }
      if (pkgUid == -1) {
        Slog.w(TAG,"Invalid packageName: " + packageName);
        return;
      }
      killPackageProcessesLocked(packageName,pkgUid,-1,ProcessList.SERVICE_ADJ,false,true,true,false,"kill background");
    }
  }
  finally {
    Binder.restoreCallingIdentity(callingId);
  }
}
