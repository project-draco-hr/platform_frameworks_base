{
  boolean needSep=false;
  pw.println("ACTIVITY MANAGER BROADCAST STATE (dumpsys activity broadcasts)");
  if (dumpAll) {
    if (mRegisteredReceivers.size() > 0) {
      boolean printed=false;
      Iterator it=mRegisteredReceivers.values().iterator();
      while (it.hasNext()) {
        ReceiverList r=(ReceiverList)it.next();
        if (dumpPackage != null && (r.app == null || !dumpPackage.equals(r.app.info.packageName))) {
          continue;
        }
        if (!printed) {
          pw.println("  Registered Receivers:");
          needSep=true;
          printed=true;
        }
        pw.print("  * ");
        pw.println(r);
        r.dump(pw,"    ");
      }
    }
    if (mReceiverResolver.dump(pw,needSep ? "\n  Receiver Resolver Table:" : "  Receiver Resolver Table:","    ",dumpPackage,false)) {
      needSep=true;
    }
  }
  if (mParallelBroadcasts.size() > 0 || mOrderedBroadcasts.size() > 0 || mPendingBroadcast != null) {
    boolean printed=false;
    for (int i=mParallelBroadcasts.size() - 1; i >= 0; i--) {
      BroadcastRecord br=mParallelBroadcasts.get(i);
      if (dumpPackage != null && !dumpPackage.equals(br.callerPackage)) {
        continue;
      }
      if (!printed) {
        if (needSep) {
          pw.println();
        }
        needSep=true;
        pw.println("  Active broadcasts:");
      }
      pw.println("  Broadcast #" + i + ":");
      br.dump(pw,"    ");
    }
    printed=false;
    for (int i=mOrderedBroadcasts.size() - 1; i >= 0; i--) {
      BroadcastRecord br=mOrderedBroadcasts.get(i);
      if (dumpPackage != null && !dumpPackage.equals(br.callerPackage)) {
        continue;
      }
      if (!printed) {
        if (needSep) {
          pw.println();
        }
        needSep=true;
        pw.println("  Active ordered broadcasts:");
      }
      pw.println("  Ordered Broadcast #" + i + ":");
      mOrderedBroadcasts.get(i).dump(pw,"    ");
    }
    if (dumpPackage == null || (mPendingBroadcast != null && dumpPackage.equals(mPendingBroadcast.callerPackage))) {
      if (needSep) {
        pw.println();
      }
      pw.println("  Pending broadcast:");
      if (mPendingBroadcast != null) {
        mPendingBroadcast.dump(pw,"    ");
      }
 else {
        pw.println("    (null)");
      }
      needSep=true;
    }
  }
  boolean printed=false;
  for (int i=0; i < MAX_BROADCAST_HISTORY; i++) {
    BroadcastRecord r=mBroadcastHistory[i];
    if (r == null) {
      break;
    }
    if (dumpPackage != null && !dumpPackage.equals(r.callerPackage)) {
      continue;
    }
    if (!printed) {
      if (needSep) {
        pw.println();
      }
      needSep=true;
      pw.println("  Historical broadcasts:");
      printed=true;
    }
    if (dumpAll) {
      pw.print("  Historical Broadcast #");
      pw.print(i);
      pw.println(":");
      r.dump(pw,"    ");
    }
 else {
      if (i >= 50) {
        pw.println("  ...");
        break;
      }
      pw.print("  #");
      pw.print(i);
      pw.print(": ");
      pw.println(r);
    }
  }
  needSep=true;
  if (mStickyBroadcasts != null && dumpPackage == null) {
    if (needSep) {
      pw.println();
    }
    needSep=true;
    pw.println("  Sticky broadcasts:");
    StringBuilder sb=new StringBuilder(128);
    for (    Map.Entry<String,ArrayList<Intent>> ent : mStickyBroadcasts.entrySet()) {
      pw.print("  * Sticky action ");
      pw.print(ent.getKey());
      if (dumpAll) {
        pw.println(":");
        ArrayList<Intent> intents=ent.getValue();
        final int N=intents.size();
        for (int i=0; i < N; i++) {
          sb.setLength(0);
          sb.append("    Intent: ");
          intents.get(i).toShortString(sb,false,true,false);
          pw.println(sb.toString());
          Bundle bundle=intents.get(i).getExtras();
          if (bundle != null) {
            pw.print("      ");
            pw.println(bundle.toString());
          }
        }
      }
 else {
        pw.println("");
      }
    }
    needSep=true;
  }
  if (dumpAll) {
    pw.println();
    pw.println("  mBroadcastsScheduled=" + mBroadcastsScheduled);
    pw.println("  mHandler:");
    mHandler.dump(new PrintWriterPrinter(pw),"    ");
    needSep=true;
  }
  return needSep;
}
