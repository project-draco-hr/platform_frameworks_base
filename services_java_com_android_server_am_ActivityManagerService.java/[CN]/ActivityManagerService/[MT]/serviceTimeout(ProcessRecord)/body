{
  String anrMessage=null;
synchronized (this) {
    if (proc.executingServices.size() == 0 || proc.thread == null) {
      return;
    }
    long maxTime=SystemClock.uptimeMillis() - SERVICE_TIMEOUT;
    Iterator<ServiceRecord> it=proc.executingServices.iterator();
    ServiceRecord timeout=null;
    long nextTime=0;
    while (it.hasNext()) {
      ServiceRecord sr=it.next();
      if (sr.executingStart < maxTime) {
        timeout=sr;
        break;
      }
      if (sr.executingStart > nextTime) {
        nextTime=sr.executingStart;
      }
    }
    if (timeout != null && mLruProcesses.contains(proc)) {
      Slog.w(TAG,"Timeout executing service: " + timeout);
      anrMessage="Executing service " + timeout.shortName;
    }
 else {
      Message msg=mHandler.obtainMessage(SERVICE_TIMEOUT_MSG);
      msg.obj=proc;
      mHandler.sendMessageAtTime(msg,nextTime + SERVICE_TIMEOUT);
    }
  }
  if (anrMessage != null) {
    appNotResponding(proc,null,null,anrMessage);
  }
}
