{
  final int userId=uss.mHandle.getIdentifier();
  boolean stopped;
  ArrayList<IStopUserCallback> callbacks;
synchronized (this) {
    callbacks=new ArrayList<IStopUserCallback>(uss.mStopCallbacks);
    if (mStartedUsers.get(userId) != uss) {
      stopped=false;
    }
 else     if (uss.mState != UserStartedState.STATE_SHUTDOWN) {
      stopped=false;
    }
 else {
      stopped=true;
      mStartedUsers.remove(userId);
      mUserLru.remove(Integer.valueOf(userId));
      updateStartedUserArrayLocked();
      forceStopUserLocked(userId);
      AttributeCache ac=AttributeCache.instance();
      if (ac != null) {
        ac.removeUser(userId);
      }
    }
  }
  for (int i=0; i < callbacks.size(); i++) {
    try {
      if (stopped)       callbacks.get(i).userStopped(userId);
 else       callbacks.get(i).userStopAborted(userId);
    }
 catch (    RemoteException e) {
    }
  }
}
