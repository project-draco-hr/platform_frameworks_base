{
  enforceCallingPermission(android.Manifest.permission.SET_DEBUG_APP,"setDebugApp()");
  if (persistent) {
    final ContentResolver resolver=mContext.getContentResolver();
    Settings.System.putString(resolver,Settings.System.DEBUG_APP,packageName);
    Settings.System.putInt(resolver,Settings.System.WAIT_FOR_DEBUGGER,waitForDebugger ? 1 : 0);
  }
synchronized (this) {
    if (!persistent) {
      mOrigDebugApp=mDebugApp;
      mOrigWaitForDebugger=mWaitForDebugger;
    }
    mDebugApp=packageName;
    mWaitForDebugger=waitForDebugger;
    mDebugTransient=!persistent;
    if (packageName != null) {
      final long origId=Binder.clearCallingIdentity();
      forceStopPackageLocked(packageName,-1,false,false,true,true);
      Binder.restoreCallingIdentity(origId);
    }
  }
}
