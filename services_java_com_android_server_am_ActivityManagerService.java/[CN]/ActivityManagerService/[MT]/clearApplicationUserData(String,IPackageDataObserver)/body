{
  int uid=Binder.getCallingUid();
  int pid=Binder.getCallingPid();
  long callingId=Binder.clearCallingIdentity();
  try {
    IPackageManager pm=ActivityThread.getPackageManager();
synchronized (this) {
      int pkgUid=-1;
      try {
        pkgUid=pm.getPackageUid(packageName);
      }
 catch (      RemoteException e) {
      }
      if (pkgUid == -1) {
        Log.w(TAG,"Invalid packageName:" + packageName);
        return false;
      }
      if (uid == pkgUid || checkComponentPermission(android.Manifest.permission.CLEAR_APP_USER_DATA,pid,uid,-1) == PackageManager.PERMISSION_GRANTED) {
        uninstallPackageLocked(packageName,pkgUid,false);
      }
 else {
        throw new SecurityException(pid + " does not have permission:" + android.Manifest.permission.CLEAR_APP_USER_DATA+ " to clear data"+ "for process:"+ packageName);
      }
    }
    try {
      pm.clearApplicationUserData(packageName,observer);
    }
 catch (    RemoteException e) {
    }
  }
  finally {
    Binder.restoreCallingIdentity(callingId);
  }
  return true;
}
