{
  if (mOrderedBroadcasts.size() == 0) {
    if (explicit) {
      Slog.w(TAG,"finishReceiver called but no pending broadcasts");
    }
    return false;
  }
  BroadcastRecord r=mOrderedBroadcasts.get(0);
  if (r.receiver == null) {
    if (explicit) {
      Slog.w(TAG,"finishReceiver called but none active");
    }
    return false;
  }
  if (r.receiver != receiver) {
    Slog.w(TAG,"finishReceiver called but active receiver is different");
    return false;
  }
  int state=r.state;
  r.state=BroadcastRecord.IDLE;
  if (state == BroadcastRecord.IDLE) {
    if (explicit) {
      Slog.w(TAG,"finishReceiver called but state is IDLE");
    }
  }
  r.receiver=null;
  r.intent.setComponent(null);
  if (r.curApp != null) {
    r.curApp.curReceiver=null;
  }
  if (r.curFilter != null) {
    r.curFilter.receiverList.curBroadcast=null;
  }
  r.curFilter=null;
  r.curApp=null;
  r.curComponent=null;
  r.curReceiver=null;
  mPendingBroadcast=null;
  r.resultCode=resultCode;
  r.resultData=resultData;
  r.resultExtras=resultExtras;
  r.resultAbort=resultAbort;
  return state == BroadcastRecord.APP_RECEIVE || state == BroadcastRecord.CALL_DONE_RECEIVE;
}
