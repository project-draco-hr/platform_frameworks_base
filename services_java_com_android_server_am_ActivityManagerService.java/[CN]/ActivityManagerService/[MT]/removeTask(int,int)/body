{
synchronized (this) {
    enforceCallingPermission(android.Manifest.permission.REMOVE_TASKS,"removeTask()");
    long ident=Binder.clearCallingIdentity();
    try {
      TaskRecord tr=recentTaskForIdLocked(taskId);
      if (tr != null) {
        ActivityRecord r=tr.stack.removeTaskActivitiesLocked(taskId,-1,false);
        if (r != null) {
          mRecentTasks.remove(tr);
          cleanUpRemovedTaskLocked(tr,flags);
          return true;
        }
        if (tr.mActivities.size() == 0) {
          mRecentTasks.remove(tr);
          cleanUpRemovedTaskLocked(tr,flags);
          return true;
        }
        Slog.w(TAG,"removeTask: task " + taskId + " does not have activities to remove, "+ " but numActivities="+ tr.numActivities+ ": "+ tr);
      }
    }
  finally {
      Binder.restoreCallingIdentity(ident);
    }
  }
  return false;
}
