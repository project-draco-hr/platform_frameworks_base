{
synchronized (this) {
    enforceCallingPermission(android.Manifest.permission.REMOVE_TASKS,"removeTask()");
    long ident=Binder.clearCallingIdentity();
    try {
      ActivityRecord r=mMainStack.removeTaskActivitiesLocked(taskId,-1,false);
      if (r != null) {
        mRecentTasks.remove(r.task);
        cleanUpRemovedTaskLocked(r.task,flags);
        return true;
      }
 else {
        TaskRecord tr=null;
        int i=0;
        while (i < mRecentTasks.size()) {
          TaskRecord t=mRecentTasks.get(i);
          if (t.taskId == taskId) {
            tr=t;
            break;
          }
          i++;
        }
        if (tr != null) {
          if (tr.numActivities <= 0) {
            mRecentTasks.remove(i);
            cleanUpRemovedTaskLocked(tr,flags);
            return true;
          }
 else {
            Slog.w(TAG,"removeTask: task " + taskId + " does not have activities to remove, "+ " but numActivities="+ tr.numActivities+ ": "+ tr);
          }
        }
      }
    }
  finally {
      Binder.restoreCallingIdentity(ident);
    }
  }
  return false;
}
