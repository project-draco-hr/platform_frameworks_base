{
  if (checkCallingPermission(android.Manifest.permission.RESTART_PACKAGES) != PackageManager.PERMISSION_GRANTED) {
    String msg="Permission Denial: restartPackage() from pid=" + Binder.getCallingPid() + ", uid="+ Binder.getCallingUid()+ " requires "+ android.Manifest.permission.RESTART_PACKAGES;
    Log.w(TAG,msg);
    throw new SecurityException(msg);
  }
  long callingId=Binder.clearCallingIdentity();
  try {
    IPackageManager pm=ActivityThread.getPackageManager();
    int pkgUid=-1;
synchronized (this) {
      try {
        pkgUid=pm.getPackageUid(packageName);
      }
 catch (      RemoteException e) {
      }
      if (pkgUid == -1) {
        Log.w(TAG,"Invalid packageName: " + packageName);
        return;
      }
      restartPackageLocked(packageName,pkgUid);
    }
  }
  finally {
    Binder.restoreCallingIdentity(callingId);
  }
}
