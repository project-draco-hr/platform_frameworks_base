{
  if (checkCallingPermission(android.Manifest.permission.RESTART_PACKAGES) != PackageManager.PERMISSION_GRANTED) {
    String msg="Permission Denial: restartPackage() from pid=" + Binder.getCallingPid() + ", uid="+ Binder.getCallingUid()+ " requires "+ android.Manifest.permission.RESTART_PACKAGES;
    Log.w(TAG,msg);
    throw new SecurityException(msg);
  }
  long callingId=Binder.clearCallingIdentity();
  try {
synchronized (this) {
      uninstallPackageLocked(packageName,-1,false);
      broadcastIntentLocked(null,null,new Intent(Intent.ACTION_PACKAGE_RESTARTED,Uri.fromParts("package",packageName,null)),null,null,0,null,null,null,false,false,MY_PID,Process.SYSTEM_UID);
    }
  }
  finally {
    Binder.restoreCallingIdentity(callingId);
  }
}
