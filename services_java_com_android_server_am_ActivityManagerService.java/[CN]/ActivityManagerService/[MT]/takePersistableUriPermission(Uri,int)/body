{
  enforceNotIsolatedCaller("takePersistableUriPermission");
  Preconditions.checkFlagsArgument(modeFlags,Intent.FLAG_GRANT_READ_URI_PERMISSION | Intent.FLAG_GRANT_WRITE_URI_PERMISSION);
synchronized (this) {
    final int callingUid=Binder.getCallingUid();
    final UriPermission perm=findUriPermissionLocked(callingUid,uri);
    if (perm == null) {
      Slog.w(TAG,"No permission grant found for UID " + callingUid + " and Uri "+ uri.toSafeString());
      return;
    }
    boolean persistChanged=perm.takePersistableModes(modeFlags);
    persistChanged|=maybePrunePersistedUriGrantsLocked(callingUid);
    if (persistChanged) {
      schedulePersistUriGrants();
    }
  }
}
