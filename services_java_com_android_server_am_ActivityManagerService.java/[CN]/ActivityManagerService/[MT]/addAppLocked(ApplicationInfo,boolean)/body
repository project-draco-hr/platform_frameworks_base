{
  ProcessRecord app;
  if (!isolated) {
    app=getProcessRecordLocked(info.processName,info.uid);
  }
 else {
    app=null;
  }
  if (app == null) {
    app=newProcessRecordLocked(null,info,null,isolated);
    mProcessNames.put(info.processName,app.uid,app);
    if (isolated) {
      mIsolatedProcesses.put(app.uid,app);
    }
    updateLruProcessLocked(app,true);
  }
  try {
    AppGlobals.getPackageManager().setPackageStoppedState(info.packageName,false,UserHandle.getUserId(app.uid));
  }
 catch (  RemoteException e) {
  }
catch (  IllegalArgumentException e) {
    Slog.w(TAG,"Failed trying to unstop package " + info.packageName + ": "+ e);
  }
  if ((info.flags & (ApplicationInfo.FLAG_SYSTEM | ApplicationInfo.FLAG_PERSISTENT)) == (ApplicationInfo.FLAG_SYSTEM | ApplicationInfo.FLAG_PERSISTENT)) {
    app.persistent=true;
    app.maxAdj=ProcessList.PERSISTENT_PROC_ADJ;
  }
  if (app.thread == null && mPersistentStartingProcesses.indexOf(app) < 0) {
    mPersistentStartingProcesses.add(app);
    startProcessLocked(app,"added application",app.processName);
  }
  return app;
}
