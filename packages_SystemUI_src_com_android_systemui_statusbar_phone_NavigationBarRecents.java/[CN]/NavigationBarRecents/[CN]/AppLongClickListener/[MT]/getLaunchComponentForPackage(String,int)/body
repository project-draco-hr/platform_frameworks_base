{
  PackageManager packageManager=mContext.getPackageManager();
  Intent intentToResolve=new Intent(Intent.ACTION_MAIN);
  intentToResolve.addCategory(Intent.CATEGORY_INFO);
  intentToResolve.setPackage(packageName);
  List<ResolveInfo> ris=packageManager.queryIntentActivitiesAsUser(intentToResolve,0,userId);
  if (ris == null || ris.size() <= 0) {
    intentToResolve.removeCategory(Intent.CATEGORY_INFO);
    intentToResolve.addCategory(Intent.CATEGORY_LAUNCHER);
    intentToResolve.setPackage(packageName);
    ris=packageManager.queryIntentActivitiesAsUser(intentToResolve,0,userId);
  }
  if (ris == null || ris.size() <= 0) {
    Log.e(TAG,"Failed to build intent for " + packageName);
    return null;
  }
  return new ComponentName(ris.get(0).activityInfo.packageName,ris.get(0).activityInfo.name);
}
