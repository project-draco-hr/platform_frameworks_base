{
  if (!canWriteCompressed()) {
    throw new UnsupportedOperationException("Compression not supported.");
  }
}
