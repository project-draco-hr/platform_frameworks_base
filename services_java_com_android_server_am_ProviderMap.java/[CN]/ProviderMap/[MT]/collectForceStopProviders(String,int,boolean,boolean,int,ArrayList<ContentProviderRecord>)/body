{
  boolean didSomething=collectForceStopProvidersLocked(name,appId,doit,evenPersistent,userId,mSingletonByClass,result);
  if (!doit && didSomething) {
    return true;
  }
  if (userId == UserHandle.USER_ALL) {
    for (int i=0; i < mProvidersByClassPerUser.size(); i++) {
      if (collectForceStopProvidersLocked(name,appId,doit,evenPersistent,userId,mProvidersByClassPerUser.valueAt(i),result)) {
        if (!doit) {
          return true;
        }
        didSomething=true;
      }
    }
  }
 else {
    HashMap<ComponentName,ContentProviderRecord> items=getProvidersByClass(userId);
    if (items != null) {
      didSomething|=collectForceStopProvidersLocked(name,appId,doit,evenPersistent,userId,items,result);
    }
  }
  return didSomething;
}
