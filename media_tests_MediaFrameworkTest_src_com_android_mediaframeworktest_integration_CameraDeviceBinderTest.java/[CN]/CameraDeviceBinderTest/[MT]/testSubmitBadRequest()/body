{
  CameraMetadata metadata=new CameraMetadata();
  assertTrue(metadata.isEmpty());
  CaptureRequest request=new CaptureRequest();
  assertTrue(request.isEmpty());
  int status=mCameraUser.createDefaultRequest(TEMPLATE_PREVIEW,metadata);
  assertEquals(CameraBinderTestUtils.NO_ERROR,status);
  assertFalse(metadata.isEmpty());
  request.swap(metadata);
  assertFalse(request.isEmpty());
  assertTrue(metadata.isEmpty());
  status=mCameraUser.submitRequest(request,false);
  assertEquals("Expected submitRequest to return BAD_VALUE " + "since we had 0 surface targets set.",CameraBinderTestUtils.BAD_VALUE,status);
  SurfaceTexture surfaceTexture=new SurfaceTexture(0);
  surfaceTexture.setDefaultBufferSize(640,480);
  Surface surface=new Surface(surfaceTexture);
  request.addTarget(surface);
  status=mCameraUser.submitRequest(request,false);
  assertEquals("Expected submitRequest to return BAD_VALUE since " + "the target surface wasn't registered with createStream.",CameraBinderTestUtils.BAD_VALUE,status);
  request.close();
  metadata.close();
  surface.release();
}
