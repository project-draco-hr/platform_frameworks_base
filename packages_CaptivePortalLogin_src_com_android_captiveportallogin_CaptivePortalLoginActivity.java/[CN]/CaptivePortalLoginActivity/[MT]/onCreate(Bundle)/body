{
  super.onCreate(savedInstanceState);
  String server=Settings.Global.getString(getContentResolver(),"captive_portal_server");
  if (server == null)   server=DEFAULT_SERVER;
  try {
    mURL=new URL("http://" + server + "/generate_204");
  }
 catch (  MalformedURLException e) {
    done(true);
  }
  requestWindowFeature(Window.FEATURE_PROGRESS);
  setContentView(R.layout.activity_captive_portal_login);
  getActionBar().setDisplayShowHomeEnabled(false);
  mNetId=Integer.parseInt(getIntent().getStringExtra(Intent.EXTRA_TEXT));
  ConnectivityManager.setProcessDefaultNetwork(new Network(mNetId));
  WebView myWebView=(WebView)findViewById(R.id.webview);
  WebSettings webSettings=myWebView.getSettings();
  webSettings.setJavaScriptEnabled(true);
  myWebView.setWebViewClient(new MyWebViewClient());
  myWebView.setWebChromeClient(new MyWebChromeClient());
  myWebView.loadUrl(mURL.toString());
}
