{
  mContext=context;
  mHandler=new Handler(true);
  mLed=new Led(context,lightsManager);
  mBatteryStats=BatteryStatsService.getService();
  mCriticalBatteryLevel=mContext.getResources().getInteger(com.android.internal.R.integer.config_criticalBatteryWarningLevel);
  mLowBatteryWarningLevel=mContext.getResources().getInteger(com.android.internal.R.integer.config_lowBatteryWarningLevel);
  mLowBatteryCloseWarningLevel=mLowBatteryWarningLevel + mContext.getResources().getInteger(com.android.internal.R.integer.config_lowBatteryCloseWarningBump);
  mShutdownBatteryTemperature=mContext.getResources().getInteger(com.android.internal.R.integer.config_shutdownBatteryTemperature);
  if (new File("/sys/devices/virtual/switch/invalid_charger/state").exists()) {
    mInvalidChargerObserver.startObserving("DEVPATH=/devices/virtual/switch/invalid_charger");
  }
  IBinder b=ServiceManager.getService("batteryproperties");
  final IBatteryPropertiesRegistrar batteryPropertiesRegistrar=IBatteryPropertiesRegistrar.Stub.asInterface(b);
  try {
    batteryPropertiesRegistrar.registerListener(new BatteryListener());
  }
 catch (  RemoteException e) {
  }
}
