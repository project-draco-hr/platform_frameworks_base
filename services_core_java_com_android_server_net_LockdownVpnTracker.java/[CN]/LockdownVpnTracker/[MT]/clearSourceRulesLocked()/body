{
  try {
    if (mAcceptedIface != null) {
      mNetService.setFirewallInterfaceRule(mAcceptedIface,false);
      mAcceptedIface=null;
    }
    if (mAcceptedSourceAddr != null) {
      for (      LinkAddress addr : mAcceptedSourceAddr) {
        setFirewallEgressSourceRule(addr,false);
      }
      mNetService.setFirewallUidRule(FIREWALL_CHAIN_NONE,ROOT_UID,FIREWALL_RULE_DEFAULT);
      mNetService.setFirewallUidRule(FIREWALL_CHAIN_NONE,Os.getuid(),FIREWALL_RULE_DEFAULT);
      mAcceptedSourceAddr=null;
    }
  }
 catch (  RemoteException e) {
    throw new RuntimeException("Problem setting firewall rules",e);
  }
}
