{
  List<String> imeList=new ArrayList<>();
  ParcelFileDescriptor pfd=getInstrumentation().getUiAutomation().executeShellCommand(COMMAND_LIST_ENABLED_IME_COMPONENTS);
  try (BufferedReader reader=new BufferedReader(new InputStreamReader(new FileInputStream(pfd.getFileDescriptor())))){
    String line;
    while ((line=reader.readLine()) != null) {
      imeList.add(line);
    }
  }
   String[] imeArray=new String[imeList.size()];
  imeList.toArray(imeArray);
  return imeArray;
}
