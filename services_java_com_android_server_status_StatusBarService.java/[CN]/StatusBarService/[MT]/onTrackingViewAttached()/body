{
  WindowManager.LayoutParams lp;
  int pixelFormat;
  Drawable bg;
  pixelFormat=PixelFormat.TRANSLUCENT;
  bg=mExpandedView.getBackground();
  if (bg != null) {
    pixelFormat=bg.getOpacity();
    if (pixelFormat != PixelFormat.TRANSLUCENT) {
      pixelFormat=PixelFormat.RGBX_8888;
    }
  }
  final int disph=mDisplay.getHeight();
  lp=mExpandedDialog.getWindow().getAttributes();
  lp.width=ViewGroup.LayoutParams.MATCH_PARENT;
  lp.height=ViewGroup.LayoutParams.WRAP_CONTENT;
  lp.x=0;
  mTrackingPosition=lp.y=-disph;
  lp.type=WindowManager.LayoutParams.TYPE_STATUS_BAR_PANEL;
  lp.flags=WindowManager.LayoutParams.FLAG_LAYOUT_IN_SCREEN | WindowManager.LayoutParams.FLAG_LAYOUT_NO_LIMITS | WindowManager.LayoutParams.FLAG_NOT_TOUCH_MODAL| WindowManager.LayoutParams.FLAG_DITHER| WindowManager.LayoutParams.FLAG_NOT_FOCUSABLE;
  lp.format=pixelFormat;
  lp.gravity=Gravity.TOP | Gravity.FILL_HORIZONTAL;
  lp.setTitle("StatusBarExpanded");
  mExpandedDialog.getWindow().setAttributes(lp);
  mExpandedDialog.getWindow().setFormat(pixelFormat);
  mExpandedParams=lp;
  mExpandedDialog.getWindow().requestFeature(Window.FEATURE_NO_TITLE);
  mExpandedDialog.setContentView(mExpandedView,new ViewGroup.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT,ViewGroup.LayoutParams.WRAP_CONTENT));
  mExpandedDialog.show();
  FrameLayout hack=(FrameLayout)mExpandedView.getParent();
  hack.setForeground(null);
}
