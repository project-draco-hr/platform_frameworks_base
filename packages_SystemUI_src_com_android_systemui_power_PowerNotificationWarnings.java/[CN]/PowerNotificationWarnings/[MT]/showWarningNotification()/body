{
  final int textRes=mSaver ? R.string.battery_low_percent_format_saver_started : R.string.battery_low_percent_format;
  final String percentage=NumberFormat.getPercentInstance().format((double)mBatteryLevel / 100.0);
  final Notification.Builder nb=new Notification.Builder(mContext).setSmallIcon(R.drawable.ic_power_low).setWhen(mBucketDroppedNegativeTimeMs).setShowWhen(false).setContentTitle(mContext.getString(R.string.battery_low_title)).setContentText(mContext.getString(textRes,percentage)).setOnlyAlertOnce(true).setDeleteIntent(pendingBroadcast(ACTION_DISMISSED_WARNING)).setPriority(Notification.PRIORITY_MAX).setVisibility(Notification.VISIBILITY_PUBLIC).setColor(mContext.getResources().getColor(com.android.internal.R.color.battery_saver_mode_color));
  if (hasBatterySettings()) {
    nb.setContentIntent(pendingBroadcast(ACTION_SHOW_BATTERY_SETTINGS));
  }
  if (!mSaver) {
    nb.addAction(0,mContext.getString(R.string.battery_saver_start_action),pendingBroadcast(ACTION_START_SAVER));
  }
 else {
    addStopSaverAction(nb);
  }
  if (mPlaySound) {
    attachLowBatterySound(nb);
    mPlaySound=false;
  }
  final Notification n=nb.build();
  if (n.headsUpContentView != null) {
    n.headsUpContentView.setViewVisibility(com.android.internal.R.id.right_icon,View.GONE);
  }
  mNoMan.notifyAsUser(TAG_NOTIFICATION,R.id.notification_power,n,UserHandle.ALL);
}
