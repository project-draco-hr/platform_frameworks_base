{
  mResult.setText(null);
  String result="resultCode=" + resultCode + ", data="+ String.valueOf(data);
  if (requestCode == CODE_READ) {
    final Uri uri=data != null ? data.getData() : null;
    if (uri != null) {
      getContentResolver().takePersistableUriPermission(uri,Intent.FLAG_GRANT_READ_URI_PERMISSION);
      InputStream is=null;
      try {
        is=getContentResolver().openInputStream(uri);
        final int length=Streams.readFullyNoClose(is).length;
        result+="; read length=" + length;
      }
 catch (      Exception e) {
        result+="; ERROR";
        Log.w(TAG,"Failed to read " + uri,e);
      }
 finally {
        IoUtils.closeQuietly(is);
      }
    }
 else {
      result+="no uri?";
    }
  }
 else   if (requestCode == CODE_WRITE) {
    final Uri uri=data != null ? data.getData() : null;
    if (uri != null) {
      getContentResolver().takePersistableUriPermission(uri,Intent.FLAG_GRANT_WRITE_URI_PERMISSION);
      OutputStream os=null;
      try {
        os=getContentResolver().openOutputStream(uri);
        os.write("THE COMPLETE WORKS OF SHAKESPEARE".getBytes());
      }
 catch (      Exception e) {
        result+="; ERROR";
        Log.w(TAG,"Failed to write " + uri,e);
      }
 finally {
        IoUtils.closeQuietly(os);
      }
    }
 else {
      result+="no uri?";
    }
  }
  Log.d(TAG,result);
  mResult.setText(result);
}
