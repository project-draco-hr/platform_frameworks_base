{
  if (!isHtml || text == null) {
    mPlainText=text;
    return;
  }
  String textNormal=text;
  String textSelected=text;
  String textPressed=text;
  int textLength=text.length();
  int start=text.indexOf("\"@");
  while (start >= 0) {
    start++;
    int end=text.indexOf("\"",start);
    if (end == -1)     break;
    String colorIdString=text.substring(start,end);
    int colorId=Integer.parseInt(colorIdString.substring(1));
    try {
      ColorStateList csl=context.getResources().getColorStateList(colorId);
      int normalColor=csl.getColorForState(View.EMPTY_STATE_SET,csl.getDefaultColor());
      int selectedColor=csl.getColorForState(View.SELECTED_STATE_SET,csl.getDefaultColor());
      int pressedColor=csl.getColorForState(View.PRESSED_STATE_SET,csl.getDefaultColor());
      textNormal=textNormal.replace(colorIdString,"#" + Integer.toHexString(normalColor).substring(2));
      textSelected=textSelected.replace(colorIdString,"#" + Integer.toHexString(selectedColor).substring(2));
      textPressed=textPressed.replace(colorIdString,"#" + Integer.toHexString(pressedColor).substring(2));
    }
 catch (    Resources.NotFoundException e) {
    }
    start=text.indexOf("\"@",end);
  }
  mNormal=Html.fromHtml(textNormal);
  mSelected=Html.fromHtml(textSelected);
  mPressed=Html.fromHtml(textPressed);
}
