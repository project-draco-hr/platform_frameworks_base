{
  RecentsConfiguration config=Recents.getConfiguration();
  Resources res=mContext.getResources();
  ArrayList<Task> tasks=mStack.getStackTasks();
  int taskCount=tasks.size();
  for (int i=0; i < taskCount; i++) {
    Task task=tasks.get(i);
    Task.TaskKey taskKey=task.key;
    boolean isRunningTask=(task.key.id == opts.runningTaskId);
    boolean isVisibleTask=i >= (taskCount - opts.numVisibleTasks);
    boolean isVisibleThumbnail=i >= (taskCount - opts.numVisibleTaskThumbnails);
    if (opts.onlyLoadPausedActivities && isRunningTask) {
      continue;
    }
    if (opts.loadIcons && (isRunningTask || isVisibleTask)) {
      if (task.icon == null) {
        task.icon=loader.getAndUpdateActivityIcon(taskKey,task.taskDescription,res,true);
      }
    }
    if (opts.loadThumbnails && (isRunningTask || isVisibleThumbnail)) {
      if (task.thumbnail == null || isRunningTask) {
        if (config.svelteLevel <= RecentsConfiguration.SVELTE_LIMIT_CACHE) {
          task.thumbnail=loader.getAndUpdateThumbnail(taskKey,true);
        }
 else         if (config.svelteLevel == RecentsConfiguration.SVELTE_DISABLE_CACHE) {
          loadQueue.addTask(task);
        }
      }
    }
  }
}
