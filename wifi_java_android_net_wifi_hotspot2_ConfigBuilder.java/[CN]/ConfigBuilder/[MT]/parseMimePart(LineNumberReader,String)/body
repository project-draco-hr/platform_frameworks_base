{
  MimeHeader header=parseHeaders(in);
  if (!TextUtils.equals(header.encodingType,ENCODING_BASE64)) {
    throw new IOException("Unexpected encoding type: " + header.encodingType);
  }
  if (!TextUtils.equals(header.contentType,TYPE_PASSPOINT_PROFILE) && !TextUtils.equals(header.contentType,TYPE_CA_CERT) && !TextUtils.equals(header.contentType,TYPE_PKCS12)) {
    throw new IOException("Unexpected content type: " + header.contentType);
  }
  StringBuilder text=new StringBuilder();
  boolean isLast=false;
  String partBoundary="--" + boundary;
  String endBoundary=partBoundary + "--";
  for (; ; ) {
    String line=in.readLine();
    if (line == null) {
      throw new IOException("Unexpected EOF file in body @ " + in.getLineNumber());
    }
    if (line.startsWith(partBoundary)) {
      if (line.equals(endBoundary)) {
        isLast=true;
      }
      break;
    }
    text.append(line);
  }
  MimePart part=new MimePart();
  part.type=header.contentType;
  part.data=Base64.decode(text.toString(),Base64.DEFAULT);
  part.isLast=isLast;
  return part;
}
