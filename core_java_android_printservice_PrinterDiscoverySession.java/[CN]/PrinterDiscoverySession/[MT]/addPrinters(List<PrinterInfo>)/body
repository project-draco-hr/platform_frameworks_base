{
  PrintService.throwIfNotCalledOnMainThread();
  if (mIsDestroyed) {
    Log.w(LOG_TAG,"Not adding printers - session destroyed.");
    return;
  }
  if (mIsDiscoveryStarted) {
    List<PrinterInfo> addedPrinters=new ArrayList<PrinterInfo>();
    final int addedPrinterCount=printers.size();
    for (int i=0; i < addedPrinterCount; i++) {
      PrinterInfo addedPrinter=printers.get(i);
      if (mPrinters.get(addedPrinter.getId()) == null) {
        mPrinters.put(addedPrinter.getId(),addedPrinter);
        addedPrinters.add(addedPrinter);
      }
    }
    if (!addedPrinters.isEmpty()) {
      sendAddedPrinters(mObserver,addedPrinters);
    }
  }
 else {
    if (mLastSentPrinters == null) {
      mLastSentPrinters=new ArrayMap<PrinterId,PrinterInfo>(mPrinters);
    }
    final int addedPrinterCount=printers.size();
    for (int i=0; i < addedPrinterCount; i++) {
      PrinterInfo addedPrinter=printers.get(i);
      if (mPrinters.get(addedPrinter.getId()) == null) {
        mPrinters.put(addedPrinter.getId(),addedPrinter);
      }
    }
  }
}
