{
  assertNotNull("SSID is null",mTestAccessPoint);
  assertTrue("failed to connect to " + mTestAccessPoint,connectToWifi(mTestAccessPoint));
  assertTrue(waitForWifiState(WifiManager.WIFI_STATE_ENABLED,LONG_TIMEOUT));
  assertTrue(waitForNetworkState(ConnectivityManager.TYPE_WIFI,State.CONNECTED,WIFI_CONNECTION_TIMEOUT));
  assertNotNull("Not associated with any AP",mWifiManager.getConnectionInfo().getBSSID());
  try {
    Thread.sleep(SHORT_TIMEOUT);
  }
 catch (  Exception e) {
    log("exception: " + e.toString());
  }
  log("disconnect from the AP");
  if (!disconnectAP()) {
    log("failed to disconnect from " + mTestAccessPoint);
  }
  assertTrue(waitForNetworkState(ConnectivityManager.TYPE_WIFI,State.DISCONNECTED,LONG_TIMEOUT));
  if (!disableWifi()) {
    log("disable Wifi failed");
    return;
  }
  assertTrue(waitForWifiState(WifiManager.WIFI_STATE_DISABLED,LONG_TIMEOUT));
}
