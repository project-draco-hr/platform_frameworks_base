{
  assertNotNull("SSID is null",TEST_ACCESS_POINT);
  assertTrue("failed to connect to " + TEST_ACCESS_POINT,cmActivity.connectToWifi(TEST_ACCESS_POINT));
  waitForWifiState(WifiManager.WIFI_STATE_ENABLED,STATE_TRANSITION_LONG_TIMEOUT);
  waitForNetworkState(ConnectivityManager.TYPE_WIFI,State.CONNECTED,STATE_TRANSITION_LONG_TIMEOUT);
  assertNotNull("Not associated with any AP",cmActivity.mWifiManager.getConnectionInfo().getBSSID());
  try {
    Thread.sleep(STATE_TRANSITION_SHORT_TIMEOUT);
  }
 catch (  Exception e) {
    Log.v(LOG_TAG,"exception: " + e.toString());
  }
  Log.v(LOG_TAG,"disconnect from the AP");
  if (!cmActivity.disconnectAP()) {
    Log.v(LOG_TAG,"failed to disconnect from " + TEST_ACCESS_POINT);
  }
  waitForNetworkState(ConnectivityManager.TYPE_WIFI,State.DISCONNECTED,STATE_TRANSITION_LONG_TIMEOUT);
  if (!cmActivity.disableWifi()) {
    Log.v(LOG_TAG,"disable Wifi failed");
    return;
  }
  waitForWifiState(WifiManager.WIFI_STATE_DISABLED,STATE_TRANSITION_LONG_TIMEOUT);
}
