{
  long startTime=System.currentTimeMillis();
  while (true) {
    if ((System.currentTimeMillis() - startTime) > timeout) {
      if (cmActivity.mCM.getNetworkInfo(networkType).getState() != expectedState) {
        assertFalse("Wait for network state timeout",true);
      }
 else {
        return;
      }
    }
    Log.v(LOG_TAG,"Wait for the connectivity state for network: " + networkType + " to be "+ expectedState.toString());
synchronized (cmActivity.connectivityObject) {
      try {
        cmActivity.connectivityObject.wait(STATE_TRANSITION_SHORT_TIMEOUT);
      }
 catch (      InterruptedException e) {
        e.printStackTrace();
      }
      if ((cmActivity.mNetworkInfo.getType() != networkType) || (cmActivity.mNetworkInfo.getState() != expectedState)) {
        Log.v(LOG_TAG,"network state for " + cmActivity.mNetworkInfo.getType() + "is: "+ cmActivity.mNetworkInfo.getState());
        continue;
      }
      break;
    }
  }
}
