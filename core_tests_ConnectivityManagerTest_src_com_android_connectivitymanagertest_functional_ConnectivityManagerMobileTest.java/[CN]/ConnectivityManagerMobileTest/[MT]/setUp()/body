{
  super.setUp();
  ConnectivityManagerTestRunner mRunner=(ConnectivityManagerTestRunner)getInstrumentation();
  mTestAccessPoint=mRunner.mTestSsid;
  mWifiOnlyFlag=mRunner.mWifiOnlyFlag;
  if (Settings.Global.getInt(getInstrumentation().getContext().getContentResolver(),Settings.Global.AIRPLANE_MODE_ON) == 1) {
    log("airplane is not disabled, disable it.");
    mCm.setAirplaneMode(false);
  }
  if (!mWifiOnlyFlag) {
    if (!waitForNetworkState(ConnectivityManager.TYPE_MOBILE,State.CONNECTED,LONG_TIMEOUT)) {
      tearDown();
      fail("Device is not connected to Mobile, setUp failed");
    }
  }
}
