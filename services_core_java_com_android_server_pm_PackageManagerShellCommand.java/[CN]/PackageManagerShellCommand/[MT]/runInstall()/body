{
  final PrintWriter pw=getOutPrintWriter();
  final InstallParams params=makeInstallParams();
  final int sessionId=doCreateSession(params.sessionParams,params.installerPackageName,params.userId);
  final String inPath=getNextArg();
  if (inPath == null && params.sessionParams.sizeBytes == 0) {
    pw.println("Error: must either specify a package size or an APK file");
    return 1;
  }
  if (doWriteSession(sessionId,inPath,params.sessionParams.sizeBytes,"base.apk") != 0) {
    return 1;
  }
  if (doCommitSession(sessionId) != 0) {
    return 1;
  }
  return 0;
}
