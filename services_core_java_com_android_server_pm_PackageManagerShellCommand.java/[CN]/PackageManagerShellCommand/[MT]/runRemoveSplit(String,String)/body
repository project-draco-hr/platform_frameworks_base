{
  final PrintWriter pw=getOutPrintWriter();
  final SessionParams sessionParams=new SessionParams(SessionParams.MODE_INHERIT_EXISTING);
  sessionParams.installFlags|=PackageManager.INSTALL_REPLACE_EXISTING;
  sessionParams.appPackageName=packageName;
  final int sessionId=doCreateSession(sessionParams,null,UserHandle.USER_ALL);
  boolean abandonSession=true;
  try {
    if (doRemoveSplit(sessionId,splitName,false) != PackageInstaller.STATUS_SUCCESS) {
      return 1;
    }
    if (doCommitSession(sessionId,false) != PackageInstaller.STATUS_SUCCESS) {
      return 1;
    }
    abandonSession=false;
    pw.println("Success");
    return 0;
  }
  finally {
    if (abandonSession) {
      try {
        doAbandonSession(sessionId,false);
      }
 catch (      Exception ignore) {
      }
    }
  }
}
