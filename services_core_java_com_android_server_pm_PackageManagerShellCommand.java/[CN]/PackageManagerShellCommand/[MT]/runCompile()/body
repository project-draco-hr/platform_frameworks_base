{
  final PrintWriter pw=getOutPrintWriter();
  boolean useJitProfiles=false;
  boolean extractOnly=false;
  boolean forceCompilation=false;
  String compilationMode="default";
  String opt;
  while ((opt=getNextOption()) != null) {
switch (opt) {
case "-m":
      compilationMode=getNextArgRequired();
    break;
case "-f":
  forceCompilation=true;
break;
default :
pw.println("Error: Unknown option: " + opt);
return 1;
}
}
switch (compilationMode) {
case "default":
useJitProfiles=SystemProperties.getBoolean("dalvik.vm.usejitprofiles",false);
extractOnly=false;
break;
case "all":
useJitProfiles=false;
extractOnly=false;
break;
case "profile":
useJitProfiles=true;
extractOnly=false;
break;
case "extract":
useJitProfiles=false;
extractOnly=true;
break;
default :
pw.println("Error: Unknown compilation mode: " + compilationMode);
return 1;
}
String packageName=getNextArg();
if (packageName == null) {
pw.println("Error: package name not specified");
return 1;
}
boolean success=mInterface.performDexOpt(packageName,null,useJitProfiles,extractOnly,forceCompilation);
if (success) {
pw.println("Success");
return 0;
}
 else {
pw.println("Failure: package " + packageName + " could not be compiled");
return 1;
}
}
