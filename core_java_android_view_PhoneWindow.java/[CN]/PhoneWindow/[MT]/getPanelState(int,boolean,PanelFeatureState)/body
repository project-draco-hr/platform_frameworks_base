{
  if ((getFeatures() & (1 << featureId)) == 0) {
    if (!required) {
      return null;
    }
    throw new RuntimeException("The feature has not been requested");
  }
  PanelFeatureState[] ar;
  if ((ar=mPanels) == null || ar.length <= featureId) {
    PanelFeatureState[] nar=new PanelFeatureState[featureId + 1];
    if (ar != null) {
      System.arraycopy(ar,0,nar,0,ar.length);
    }
    mPanels=ar=nar;
  }
  PanelFeatureState st=ar[featureId];
  if (st == null) {
    ar[featureId]=st=(convertPanelState != null) ? convertPanelState : new PanelFeatureState(featureId);
  }
  return st;
}
