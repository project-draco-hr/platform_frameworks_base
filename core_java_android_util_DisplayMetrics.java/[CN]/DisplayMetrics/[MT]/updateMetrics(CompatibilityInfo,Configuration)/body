{
  if (compatibilityInfo.mScalingRequired) {
    float invertedRatio=compatibilityInfo.mApplicationInvertedScale;
    density*=invertedRatio;
    scaledDensity*=invertedRatio;
    xdpi*=invertedRatio;
    ydpi*=invertedRatio;
    widthPixels*=invertedRatio;
    heightPixels*=invertedRatio;
  }
  if (!compatibilityInfo.mExpandable) {
    int defaultWidth;
    int defaultHeight;
switch (configuration.orientation) {
case Configuration.ORIENTATION_LANDSCAPE:
{
        defaultWidth=(int)(CompatibilityInfo.DEFAULT_PORTRAIT_HEIGHT * density);
        defaultHeight=(int)(CompatibilityInfo.DEFAULT_PORTRAIT_WIDTH * density);
        break;
      }
case Configuration.ORIENTATION_UNDEFINED:
case Configuration.ORIENTATION_PORTRAIT:
case Configuration.ORIENTATION_SQUARE:
default :
{
      defaultWidth=(int)(CompatibilityInfo.DEFAULT_PORTRAIT_WIDTH * density);
      defaultHeight=(int)(CompatibilityInfo.DEFAULT_PORTRAIT_HEIGHT * density);
    }
}
if (defaultWidth < widthPixels) {
  widthPixels=defaultWidth;
}
if (defaultHeight < heightPixels) {
  heightPixels=defaultHeight;
}
}
}
