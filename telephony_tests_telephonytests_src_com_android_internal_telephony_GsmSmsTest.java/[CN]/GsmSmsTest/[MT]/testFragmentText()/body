{
  boolean isGsmPhone=(TelephonyManager.getDefault().getPhoneType() == TelephonyManager.PHONE_TYPE_GSM);
  String text="123456789012345678901234567890123456789012345678901234567890" + "1234567890123456789012345678901234567890123456789012345678901234567890" + "123456789012345678901234567890";
  SmsMessageBase.TextEncodingDetails ted=SmsMessage.calculateLength(text,false);
  assertEquals(1,ted.msgCount);
  assertEquals(160,ted.codeUnitCount);
  assertEquals(1,ted.codeUnitSize);
  assertEquals(0,ted.languageTable);
  assertEquals(0,ted.languageShiftTable);
  if (isGsmPhone) {
    ArrayList<String> fragments=android.telephony.SmsMessage.fragmentText(text);
    assertEquals(1,fragments.size());
  }
  text="123456789012345678901234567890123456789012345678901234567890" + "1234567890123456789012345678901234567890123456789012345678901234567890" + "1234567890123456789012345678901";
  ted=SmsMessage.calculateLength(text,false);
  assertEquals(2,ted.msgCount);
  assertEquals(161,ted.codeUnitCount);
  assertEquals(1,ted.codeUnitSize);
  assertEquals(0,ted.languageTable);
  assertEquals(0,ted.languageShiftTable);
  if (isGsmPhone) {
    ArrayList<String> fragments=android.telephony.SmsMessage.fragmentText(text);
    assertEquals(2,fragments.size());
    assertEquals(text,fragments.get(0) + fragments.get(1));
    assertEquals(153,fragments.get(0).length());
    assertEquals(8,fragments.get(1).length());
  }
}
