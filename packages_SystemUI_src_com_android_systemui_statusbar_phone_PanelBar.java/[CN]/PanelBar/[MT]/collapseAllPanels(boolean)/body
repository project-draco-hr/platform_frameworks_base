{
  boolean waiting=false;
  for (  PanelView pv : mPanels) {
    if (animate && !pv.isFullyCollapsed()) {
      pv.collapse();
      waiting=true;
    }
 else {
      pv.setExpandedFraction(0);
    }
    pv.setVisibility(View.GONE);
  }
  if (!waiting) {
    go(STATE_CLOSED);
    onAllPanelsCollapsed();
  }
}
