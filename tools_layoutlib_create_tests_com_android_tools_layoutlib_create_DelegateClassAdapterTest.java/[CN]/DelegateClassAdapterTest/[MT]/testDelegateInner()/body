{
  HashSet<String> delegateMethods=new HashSet<String>();
  delegateMethods.add("get");
  delegateMethods.add("privateMethod");
  ClassWriter cwOuter=new ClassWriter(0);
  String outerClassName=OUTER_CLASS_NAME.replace('.','/');
  DelegateClassAdapter cvOuter=new DelegateClassAdapter(mLog,cwOuter,outerClassName,delegateMethods);
  ClassReader cr=new ClassReader(OUTER_CLASS_NAME);
  cr.accept(cvOuter,0);
  ClassWriter cwInner=new ClassWriter(0);
  String innerClassName=INNER_CLASS_NAME.replace('.','/');
  DelegateClassAdapter cvInner=new DelegateClassAdapter(mLog,cwInner,innerClassName,delegateMethods);
  cr=new ClassReader(INNER_CLASS_NAME);
  cr.accept(cvInner,0);
  ClassLoader2 cl2=null;
  try {
    cl2=new ClassLoader2(){
      @Override public void testModifiedInstance() throws Exception {
        Class<?> outerClazz2=loadClass(OUTER_CLASS_NAME);
        Object o2=outerClazz2.newInstance();
        assertNotNull(o2);
        assertEquals(4 + 10 + 20,callGet(o2,10,20));
        assertEquals(1 + 10 + 20,callGet_Original(o2,10,20));
        assertEquals("outerPrivateMethod",callMethod(o2,"privateMethod_Original",false));
        boolean gotIllegalAccessException=false;
        try {
          callMethod(o2,"privateMethod",false);
        }
 catch (        IllegalAccessException e) {
          gotIllegalAccessException=true;
        }
        assertTrue(gotIllegalAccessException);
        assertEquals("outerPrivate_Delegate",callMethod(o2,"privateMethod",true));
        Class<?> innerClazz2=loadClass(INNER_CLASS_NAME);
        Constructor<?> innerCons=innerClazz2.getConstructor(new Class<?>[]{outerClazz2});
        Object i2=innerCons.newInstance(new Object[]{o2});
        assertNotNull(i2);
        assertEquals(6 + 10 + 20,callGet(i2,10,20));
        assertEquals(3 + 10 + 20,callGet_Original(i2,10,20));
      }
    }
;
    cl2.add(OUTER_CLASS_NAME,cwOuter.toByteArray());
    cl2.add(INNER_CLASS_NAME,cwInner.toByteArray());
    cl2.testModifiedInstance();
  }
 catch (  Throwable t) {
    throw dumpGeneratedClass(t,cl2);
  }
}
