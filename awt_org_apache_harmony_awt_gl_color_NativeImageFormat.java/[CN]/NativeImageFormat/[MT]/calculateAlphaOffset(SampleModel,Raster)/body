{
  if (sm instanceof ComponentSampleModel) {
    ComponentSampleModel csm=(ComponentSampleModel)sm;
    int dataTypeSize=DataBuffer.getDataTypeSize(r.getDataBuffer().getDataType()) / 8;
    return csm.getBandOffsets()[csm.getBandOffsets().length - 1] * dataTypeSize;
  }
 else   if (sm instanceof SinglePixelPackedSampleModel) {
    SinglePixelPackedSampleModel sppsm=(SinglePixelPackedSampleModel)sm;
    return sppsm.getBitOffsets()[sppsm.getBitOffsets().length - 1] / 8;
  }
 else {
    return -1;
  }
}
