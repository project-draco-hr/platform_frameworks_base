{
  final WifiDisplayStatus oldStatus=sStatic.mLastKnownWifiDisplayStatus;
  boolean needScan=false;
  WifiDisplay[] oldDisplays=oldStatus != null ? oldStatus.getRememberedDisplays() : new WifiDisplay[0];
  WifiDisplay[] newDisplays=newStatus.getRememberedDisplays();
  WifiDisplay[] availableDisplays=newStatus.getAvailableDisplays();
  for (int i=0; i < newDisplays.length; i++) {
    final WifiDisplay d=newDisplays[i];
    final WifiDisplay oldRemembered=findMatchingDisplay(d,oldDisplays);
    if (oldRemembered == null) {
      addRoute(makeWifiDisplayRoute(d));
      needScan=true;
    }
 else {
      final boolean available=findMatchingDisplay(d,availableDisplays) != null;
      final RouteInfo route=findWifiDisplayRoute(d);
      updateWifiDisplayRoute(route,d,available,newStatus);
    }
  }
  for (int i=0; i < oldDisplays.length; i++) {
    final WifiDisplay d=oldDisplays[i];
    final WifiDisplay newDisplay=findMatchingDisplay(d,newDisplays);
    if (newDisplay == null) {
      removeRoute(findWifiDisplayRoute(d));
    }
  }
  if (needScan) {
    sStatic.mDisplayService.scanWifiDisplays();
  }
  sStatic.mLastKnownWifiDisplayStatus=newStatus;
}
