{
  final boolean isScanning=wifiDisplayStatus.getScanState() == WifiDisplayStatus.SCAN_STATE_SCANNING;
  boolean changed=false;
  int newStatus=RouteInfo.STATUS_NONE;
  if (available) {
    newStatus=isScanning ? RouteInfo.STATUS_SCANNING : RouteInfo.STATUS_AVAILABLE;
  }
 else {
    newStatus=RouteInfo.STATUS_NOT_AVAILABLE;
  }
  if (display.equals(wifiDisplayStatus.getActiveDisplay())) {
    final int activeState=wifiDisplayStatus.getActiveDisplayState();
switch (activeState) {
case WifiDisplayStatus.DISPLAY_STATE_CONNECTED:
      newStatus=RouteInfo.STATUS_NONE;
    break;
case WifiDisplayStatus.DISPLAY_STATE_CONNECTING:
  newStatus=RouteInfo.STATUS_CONNECTING;
break;
case WifiDisplayStatus.DISPLAY_STATE_NOT_CONNECTED:
Log.e(TAG,"Active display is not connected!");
break;
}
}
final String newName=makeWifiDisplayName(display);
if (route.getName().equals(newName)) {
route.mName=newName;
changed=true;
}
changed|=route.mEnabled != available;
route.mEnabled=available;
changed|=route.setStatusCode(newStatus);
if (changed) {
dispatchRouteChanged(route);
}
if (!available && route == sStatic.mSelectedRoute) {
final RouteInfo defaultRoute=sStatic.mDefaultAudioVideo;
selectRouteStatic(defaultRoute.getSupportedTypes(),defaultRoute);
}
}
