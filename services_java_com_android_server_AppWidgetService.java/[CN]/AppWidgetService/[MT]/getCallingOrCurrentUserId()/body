{
  int callingUid=Binder.getCallingUid();
  if (callingUid == android.os.Process.myUid() && Binder.getCallingPid() == android.os.Process.myPid()) {
    try {
      return ActivityManagerNative.getDefault().getCurrentUser().id;
    }
 catch (    RemoteException re) {
      return UserHandle.getUserId(callingUid);
    }
  }
 else {
    return UserHandle.getUserId(callingUid);
  }
}
