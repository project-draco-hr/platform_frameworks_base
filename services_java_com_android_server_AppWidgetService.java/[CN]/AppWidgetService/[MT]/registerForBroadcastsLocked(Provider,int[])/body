{
  if (p.info.updatePeriodMillis > 0) {
    boolean alreadyRegistered=p.broadcast != null;
    Intent intent=new Intent(AppWidgetManager.ACTION_APPWIDGET_UPDATE);
    intent.putExtra(AppWidgetManager.EXTRA_APPWIDGET_IDS,appWidgetIds);
    intent.setComponent(p.info.provider);
    long token=Binder.clearCallingIdentity();
    try {
      p.broadcast=PendingIntent.getBroadcast(mContext,1,intent,PendingIntent.FLAG_UPDATE_CURRENT);
    }
  finally {
      Binder.restoreCallingIdentity(token);
    }
    if (!alreadyRegistered) {
      long period=p.info.updatePeriodMillis;
      if (period < MIN_UPDATE_PERIOD) {
        period=MIN_UPDATE_PERIOD;
      }
      mAlarmManager.setInexactRepeating(AlarmManager.ELAPSED_REALTIME_WAKEUP,SystemClock.elapsedRealtime() + period,period,p.broadcast);
    }
  }
}
