{
  boolean sendInitial=false;
  AppWidgetServiceImpl service;
synchronized (mAppWidgetServices) {
    service=mAppWidgetServices.get(userId);
    if (service == null) {
      Slog.i(TAG,"Unable to find AppWidgetServiceImpl for user " + userId + ", adding");
      service=new AppWidgetServiceImpl(mContext,userId,mSaveStateHandler);
      service.systemReady(mSafeMode);
      mAppWidgetServices.append(userId,service);
      sendInitial=true;
    }
  }
  if (sendInitial) {
    service.sendInitialBroadcasts();
  }
  return service;
}
