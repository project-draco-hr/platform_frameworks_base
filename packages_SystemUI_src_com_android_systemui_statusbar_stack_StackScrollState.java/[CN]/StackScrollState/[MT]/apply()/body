{
  int numChildren=mHostView.getChildCount();
  for (int i=0; i < numChildren; i++) {
    View child=mHostView.getChildAt(i);
    ViewState state=mStateMap.get(child);
    if (state != null) {
      float alpha=child.getAlpha();
      float yTranslation=child.getTranslationY();
      float zTranslation=child.getTranslationZ();
      int height=child.getHeight();
      float newAlpha=state.alpha;
      float newYTranslation=state.yTranslation;
      float newZTranslation=state.zTranslation;
      int newHeight=state.height;
      boolean becomesInvisible=newAlpha == 0.0f;
      if (alpha != newAlpha) {
        boolean becomesFullyVisible=newAlpha == 1.0f;
        boolean newLayerTypeIsHardware=!becomesInvisible && !becomesFullyVisible;
        int layerType=child.getLayerType();
        int newLayerType=newLayerTypeIsHardware ? View.LAYER_TYPE_HARDWARE : View.LAYER_TYPE_NONE;
        if (layerType != newLayerType) {
          child.setLayerType(newLayerType,null);
        }
        if (!becomesInvisible) {
          child.setAlpha(newAlpha);
        }
      }
      int oldVisibility=child.getVisibility();
      int newVisibility=becomesInvisible ? View.INVISIBLE : View.VISIBLE;
      if (newVisibility != oldVisibility) {
        child.setVisibility(newVisibility);
      }
      if (yTranslation != newYTranslation) {
        child.setTranslationY(newYTranslation);
      }
      if (zTranslation != newZTranslation) {
        child.setTranslationZ(newZTranslation);
      }
      if (height != newHeight) {
        applyNewHeight(child,newHeight);
      }
    }
 else {
      Log.wtf(CHILD_NOT_FOUND_TAG,"No child state was found when applying this state " + "to the hostView");
    }
  }
}
