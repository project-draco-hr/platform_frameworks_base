{
  sProxyInfoLock.readLock().lock();
  try {
    if (sGlobalProxyChangedObserver == null) {
      registerContentObserversReadLocked(ctx);
      parseGlobalProxyInfoReadLocked(ctx);
    }
    if (sGlobalProxySpec != null) {
      InetSocketAddress sa=sGlobalProxySpec.proxyAddress;
      return sa.getPort();
    }
    return getDefaultPort();
  }
  finally {
    sProxyInfoLock.readLock().unlock();
  }
}
