{
  if (oldLp == null || (newLp.isIdenticalDnses(oldLp) == false)) {
    Collection<InetAddress> dnses=newLp.getDnsServers();
    if (DBG)     log("Setting Dns servers for network " + netId + " to "+ dnses);
    try {
      mNetd.setDnsServersForNetwork(netId,NetworkUtils.makeStrings(dnses),newLp.getDomains());
    }
 catch (    Exception e) {
      loge("Exception in setDnsServersForNetwork: " + e);
    }
    final NetworkAgentInfo defaultNai=getDefaultNetwork();
    if (defaultNai != null && defaultNai.network.netId == netId) {
      setDefaultDnsSystemProperties(dnses);
    }
    flushVmDnsCache();
  }
 else   if (flush) {
    try {
      mNetd.flushNetworkDnsCache(netId);
    }
 catch (    Exception e) {
      loge("Exception in flushNetworkDnsCache: " + e);
    }
    flushVmDnsCache();
  }
}
