{
  if (DBG)   log("handleSetAcceptUnvalidated network=" + network + " accept="+ accept+ " always="+ always);
  NetworkAgentInfo nai=getNetworkAgentInfoForNetwork(network);
  if (nai == null) {
    return;
  }
  if (nai.everValidated) {
    return;
  }
  if (!nai.networkMisc.explicitlySelected) {
    Slog.wtf(TAG,"BUG: setAcceptUnvalidated non non-explicitly selected network");
  }
  if (accept != nai.networkMisc.acceptUnvalidated) {
    int oldScore=nai.getCurrentScore();
    nai.networkMisc.acceptUnvalidated=accept;
    rematchAllNetworksAndRequests(nai,oldScore,NascentState.NOT_JUST_VALIDATED);
    sendUpdatedScoreToFactories(nai);
  }
  if (always) {
    nai.asyncChannel.sendMessage(NetworkAgent.CMD_SAVE_ACCEPT_UNVALIDATED,accept ? 1 : 0);
  }
  if (!accept) {
    nai.asyncChannel.sendMessage(NetworkAgent.CMD_REPORT_NETWORK_STATUS,NetworkAgent.INVALID_NETWORK,0,null);
  }
}
