{
  checkNotNull(operation,"PendingIntent cannot be null.");
  networkCapabilities=new NetworkCapabilities(networkCapabilities);
  enforceNetworkRequestPermissions(networkCapabilities);
  enforceMeteredApnPolicy(networkCapabilities);
  ensureImmutableCapabilities(networkCapabilities);
  NetworkRequest networkRequest=new NetworkRequest(networkCapabilities,TYPE_NONE,nextNetworkRequestId());
  if (DBG)   log("pendingRequest for " + networkRequest + " to trigger "+ operation);
  NetworkRequestInfo nri=new NetworkRequestInfo(networkRequest,operation,NetworkRequestInfo.REQUEST);
  mHandler.sendMessage(mHandler.obtainMessage(EVENT_REGISTER_NETWORK_REQUEST_WITH_INTENT,nri));
  return networkRequest;
}
