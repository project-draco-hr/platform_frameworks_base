{
  if (!Objects.equals(networkAgent.networkCapabilities,networkCapabilities)) {
synchronized (networkAgent) {
      networkAgent.networkCapabilities=networkCapabilities;
    }
    if (networkAgent.lastValidated) {
      networkAgent.networkCapabilities.addCapability(NET_CAPABILITY_VALIDATED);
    }
    rematchAllNetworksAndRequests(networkAgent,networkAgent.getCurrentScore());
    notifyNetworkCallbacks(networkAgent,ConnectivityManager.CALLBACK_CAP_CHANGED);
  }
}
