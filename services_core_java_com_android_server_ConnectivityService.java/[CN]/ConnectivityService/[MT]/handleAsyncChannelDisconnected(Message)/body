{
  NetworkAgentInfo nai=mNetworkAgentInfos.get(msg.replyTo);
  if (nai != null) {
    if (DBG)     log(nai.name() + " got DISCONNECTED");
    try {
      mNetd.removeNetwork(nai.network.netId);
    }
 catch (    Exception e) {
      loge("Exception removing network: " + e);
    }
    notifyNetworkCallbacks(nai,NetworkCallbacks.LOST);
    mNetworkAgentInfos.remove(nai);
    for (int i=0; i < nai.networkRequests.size(); i++) {
      NetworkRequest request=nai.networkRequests.valueAt(i);
      NetworkAgentInfo currentNetwork=mNetworkForRequestId.get(request.requestId);
      if (currentNetwork != null && currentNetwork.network.netId == nai.network.netId) {
        mNetworkForRequestId.remove(request.requestId);
        sendUpdatedScoreToFactories(request,0);
      }
    }
    if (nai.networkRequests.get(mDefaultRequest.requestId) != null) {
      removeDataActivityTracking(nai);
    }
  }
}
