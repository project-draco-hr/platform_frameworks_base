{
  AsyncChannel ac=(AsyncChannel)msg.obj;
  if (mNetworkFactories.contains(ac)) {
    if (msg.arg1 == AsyncChannel.STATUS_SUCCESSFUL) {
      if (VDBG)       log("NetworkFactory connected");
      for (int i=0; i < mNetworkRequests.size(); i++) {
        NetworkRequest request=mNetworkRequests.valueAt(i);
        NetworkAgentInfo nai=mNetworkForRequestId.get(request.requestId);
        ac.sendMessage(NetworkFactoryProtocol.CMD_REQUEST_NETWORK,(nai != null ? nai.currentScore : 0),0,request);
      }
    }
 else {
      loge("Error connecting NetworkFactory");
      mNetworkFactories.remove(ac);
    }
  }
 else   if (mNetworkAgentInfos.containsKey(msg.replyTo)) {
    if (msg.arg1 == AsyncChannel.STATUS_SUCCESSFUL) {
      if (VDBG)       log("NetworkAgent connected");
      mNetworkAgentInfos.get(msg.replyTo).asyncChannel.sendMessage(AsyncChannel.CMD_CHANNEL_FULL_CONNECTION);
    }
 else {
      loge("Error connecting NetworkAgent");
      NetworkAgentInfo nai=mNetworkAgentInfos.remove(msg.replyTo);
      try {
        mNetworkAgentInfoForType[nai.networkInfo.getType()].remove(nai);
      }
 catch (      NullPointerException e) {
      }
    }
  }
}
