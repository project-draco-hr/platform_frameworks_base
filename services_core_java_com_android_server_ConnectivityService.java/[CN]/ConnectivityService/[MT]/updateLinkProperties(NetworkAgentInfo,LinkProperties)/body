{
  LinkProperties newLp=networkAgent.linkProperties;
  int netId=networkAgent.network.netId;
  mClat.fixupLinkProperties(networkAgent,oldLp);
  updateInterfaces(newLp,oldLp,netId);
  updateMtu(newLp,oldLp);
  updateTcpBufferSizes(networkAgent);
  final boolean flushDns=updateRoutes(newLp,oldLp,netId);
  updateDnses(newLp,oldLp,netId,flushDns);
  updateClat(newLp,oldLp,networkAgent);
  if (isDefaultNetwork(networkAgent))   handleApplyDefaultProxy(newLp.getHttpProxy());
  if (!Objects.equals(newLp,oldLp)) {
    notifyNetworkCallbacks(networkAgent,ConnectivityManager.CALLBACK_IP_CHANGED);
  }
}
