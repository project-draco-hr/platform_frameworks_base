{
  enforceConnectivityInternalPermission();
  setAirplaneMode(false);
  for (  String tether : getTetheredIfaces()) {
    untether(tether);
  }
  VpnConfig vpnConfig=getVpnConfig();
  if (vpnConfig != null) {
    if (vpnConfig.legacy) {
      prepareVpn(VpnConfig.LEGACY_VPN,VpnConfig.LEGACY_VPN);
    }
 else {
      setVpnPackageAuthorization(false);
      prepareVpn(vpnConfig.user,VpnConfig.LEGACY_VPN);
    }
  }
}
