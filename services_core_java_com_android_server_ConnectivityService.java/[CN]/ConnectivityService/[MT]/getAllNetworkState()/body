{
  enforceAccessPermission();
  final int uid=Binder.getCallingUid();
  final ArrayList<NetworkState> result=Lists.newArrayList();
  for (int networkType=0; networkType <= ConnectivityManager.MAX_NETWORK_TYPE; networkType++) {
    if (getNetworkInfoForType(networkType) != null) {
      final NetworkInfo info=getFilteredNetworkInfo(networkType,uid);
      final LinkProperties lp=getLinkPropertiesForTypeInternal(networkType);
      final NetworkCapabilities netcap=getNetworkCapabilitiesForType(networkType);
      result.add(new NetworkState(info,lp,netcap));
    }
  }
  return result.toArray(new NetworkState[result.size()]);
}
