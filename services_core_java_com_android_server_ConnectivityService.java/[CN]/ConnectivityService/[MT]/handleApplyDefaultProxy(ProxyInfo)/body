{
  if (proxy != null && TextUtils.isEmpty(proxy.getHost()) && (proxy.getPacFileUrl() == null)) {
    proxy=null;
  }
synchronized (mProxyLock) {
    if (mDefaultProxy != null && mDefaultProxy.equals(proxy))     return;
    if (mDefaultProxy == proxy)     return;
    if (proxy != null && !proxy.isValid()) {
      if (DBG)       log("Invalid proxy properties, ignoring: " + proxy.toString());
      return;
    }
    if ((mGlobalProxy != null) && (proxy != null) && (proxy.getPacFileUrl() != null)&& proxy.getPacFileUrl().equals(mGlobalProxy.getPacFileUrl())) {
      mGlobalProxy=proxy;
      sendProxyBroadcast(mGlobalProxy);
      return;
    }
    mDefaultProxy=proxy;
    if (mGlobalProxy != null)     return;
    if (!mDefaultProxyDisabled) {
      sendProxyBroadcast(proxy);
    }
  }
}
