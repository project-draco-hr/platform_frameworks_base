{
synchronized (mVpns) {
    Vpn userVpn=mVpns.get(userId);
    if (userVpn != null) {
      loge("Starting user already has a VPN");
      return;
    }
    userVpn=new Vpn(mHandler.getLooper(),mContext,mNetd,userId);
    mVpns.put(userId,userVpn);
    final ContentResolver cr=mContext.getContentResolver();
    String alwaysOnPackage=Settings.Secure.getStringForUser(cr,Settings.Secure.ALWAYS_ON_VPN_APP,userId);
    final boolean alwaysOnLockdown=Settings.Secure.getIntForUser(cr,Settings.Secure.ALWAYS_ON_VPN_LOCKDOWN,0,userId) != 0;
    if (alwaysOnPackage != null) {
      userVpn.setAlwaysOnPackage(alwaysOnPackage,alwaysOnLockdown);
    }
  }
  if (mUserManager.getUserInfo(userId).isPrimary() && LockdownVpnTracker.isEnabled()) {
    updateLockdownVpn();
  }
}
