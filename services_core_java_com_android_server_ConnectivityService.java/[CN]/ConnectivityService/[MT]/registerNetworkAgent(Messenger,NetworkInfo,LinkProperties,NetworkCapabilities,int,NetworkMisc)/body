{
  enforceConnectivityInternalPermission();
  NetworkAgentInfo nai=new NetworkAgentInfo(messenger,new AsyncChannel(),new NetworkInfo(networkInfo),new LinkProperties(linkProperties),new NetworkCapabilities(networkCapabilities),currentScore,mContext,mTrackerHandler,new NetworkMisc(networkMisc));
synchronized (this) {
    nai.networkMonitor.systemReady=mSystemReady;
  }
  if (DBG)   log("registerNetworkAgent " + nai);
  mHandler.sendMessage(mHandler.obtainMessage(EVENT_REGISTER_NETWORK_AGENT,nai));
}
