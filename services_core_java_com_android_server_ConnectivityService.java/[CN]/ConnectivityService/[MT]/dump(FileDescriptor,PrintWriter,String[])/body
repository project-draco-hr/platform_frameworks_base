{
  final IndentingPrintWriter pw=new IndentingPrintWriter(writer,"  ");
  if (mContext.checkCallingOrSelfPermission(android.Manifest.permission.DUMP) != PackageManager.PERMISSION_GRANTED) {
    pw.println("Permission Denial: can't dump ConnectivityService " + "from from pid=" + Binder.getCallingPid() + ", uid="+ Binder.getCallingUid());
    return;
  }
  if (argsContain(args,"--diag")) {
    dumpNetworkDiagnostics(pw);
    return;
  }
  pw.print("NetworkFactories for:");
  for (  NetworkFactoryInfo nfi : mNetworkFactoryInfos.values()) {
    pw.print(" " + nfi.name);
  }
  pw.println();
  pw.println();
  final NetworkAgentInfo defaultNai=getDefaultNetwork();
  pw.print("Active default network: ");
  if (defaultNai == null) {
    pw.println("none");
  }
 else {
    pw.println(defaultNai.network.netId);
  }
  pw.println();
  pw.println("Current Networks:");
  pw.increaseIndent();
  for (  NetworkAgentInfo nai : mNetworkAgentInfos.values()) {
    pw.println(nai.toString());
    pw.increaseIndent();
    pw.println("Requests:");
    pw.increaseIndent();
    for (int i=0; i < nai.networkRequests.size(); i++) {
      pw.println(nai.networkRequests.valueAt(i).toString());
    }
    pw.decreaseIndent();
    pw.println("Lingered:");
    pw.increaseIndent();
    for (    NetworkRequest nr : nai.networkLingered)     pw.println(nr.toString());
    pw.decreaseIndent();
    pw.decreaseIndent();
  }
  pw.decreaseIndent();
  pw.println();
  pw.println("Metered Interfaces:");
  pw.increaseIndent();
  for (  String value : mMeteredIfaces) {
    pw.println(value);
  }
  pw.decreaseIndent();
  pw.println();
  pw.print("Restrict background: ");
  pw.println(mRestrictBackground);
  pw.println();
  pw.println("Status for known UIDs:");
  pw.increaseIndent();
  final int size=mUidRules.size();
  for (int i=0; i < size; i++) {
    final int uid=mUidRules.keyAt(i);
    pw.print("UID=");
    pw.print(uid);
    final int uidRules=mUidRules.get(uid,RULE_NONE);
    pw.print(" rules=");
    pw.print(uidRulesToString(uidRules));
    pw.println();
  }
  pw.println();
  pw.decreaseIndent();
  pw.println("Network Requests:");
  pw.increaseIndent();
  for (  NetworkRequestInfo nri : mNetworkRequests.values()) {
    pw.println(nri.toString());
  }
  pw.println();
  pw.decreaseIndent();
  mLegacyTypeTracker.dump(pw);
synchronized (this) {
    pw.print("mNetTransitionWakeLock: currently " + (mNetTransitionWakeLock.isHeld() ? "" : "not ") + "held");
    if (!TextUtils.isEmpty(mNetTransitionWakeLockCausedBy)) {
      pw.println(", last requested for " + mNetTransitionWakeLockCausedBy);
    }
 else {
      pw.println(", last requested never");
    }
  }
  pw.println();
  mTethering.dump(fd,pw,args);
  pw.println();
  mKeepaliveTracker.dump(pw);
  pw.println();
  if (mInetLog != null && mInetLog.size() > 0) {
    pw.println();
    pw.println("Inet condition reports:");
    pw.increaseIndent();
    for (int i=0; i < mInetLog.size(); i++) {
      pw.println(mInetLog.get(i));
    }
    pw.decreaseIndent();
  }
  if (argsContain(args,"--short") == false) {
    pw.println();
synchronized (mValidationLogs) {
      pw.println("mValidationLogs (most recent first):");
      for (      Pair<Network,ReadOnlyLocalLog> p : mValidationLogs) {
        pw.println(p.first);
        pw.increaseIndent();
        p.second.dump(fd,pw,args);
        pw.decreaseIndent();
      }
    }
    pw.println();
    pw.println("mNetworkRequestInfoLogs (most recent first):");
    pw.increaseIndent();
    mNetworkRequestInfoLogs.reverseDump(fd,pw,args);
    pw.decreaseIndent();
  }
}
