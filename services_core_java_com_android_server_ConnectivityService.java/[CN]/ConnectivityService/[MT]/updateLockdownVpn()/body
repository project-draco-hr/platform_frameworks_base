{
  if (Binder.getCallingUid() != Process.SYSTEM_UID) {
    Slog.w(TAG,"Lockdown VPN only available to AID_SYSTEM");
    return false;
  }
  mLockdownEnabled=LockdownVpnTracker.isEnabled();
  if (mLockdownEnabled) {
    if (!mKeyStore.isUnlocked()) {
      Slog.w(TAG,"KeyStore locked; unable to create LockdownTracker");
      return false;
    }
    final String profileName=new String(mKeyStore.get(Credentials.LOCKDOWN_VPN));
    final VpnProfile profile=VpnProfile.decode(profileName,mKeyStore.get(Credentials.VPN + profileName));
    if (profile == null) {
      Slog.e(TAG,"Lockdown VPN configured invalid profile " + profileName);
      setLockdownTracker(null);
      return true;
    }
    int user=UserHandle.getUserId(Binder.getCallingUid());
synchronized (mVpns) {
      setLockdownTracker(new LockdownVpnTracker(mContext,mNetd,this,mVpns.get(user),profile));
    }
  }
 else {
    setLockdownTracker(null);
  }
  return true;
}
