{
  if (Binder.getCallingUid() != Process.SYSTEM_UID) {
    Slog.w(TAG,"Lockdown VPN only available to AID_SYSTEM");
    return false;
  }
  mLockdownEnabled=LockdownVpnTracker.isEnabled();
  if (mLockdownEnabled) {
    final String profileName=new String(mKeyStore.get(Credentials.LOCKDOWN_VPN));
    final VpnProfile profile=VpnProfile.decode(profileName,mKeyStore.get(Credentials.VPN + profileName));
    if (profile == null) {
      Slog.e(TAG,"Lockdown VPN configured invalid profile " + profileName);
      setLockdownTracker(null);
      return true;
    }
    int user=UserHandle.getUserId(Binder.getCallingUid());
synchronized (mVpns) {
      Vpn vpn=mVpns.get(user);
      if (vpn == null) {
        Slog.w(TAG,"VPN for user " + user + " not ready yet. Skipping lockdown");
        return false;
      }
      setLockdownTracker(new LockdownVpnTracker(mContext,mNetd,this,vpn,profile));
    }
  }
 else {
    setLockdownTracker(null);
  }
  return true;
}
