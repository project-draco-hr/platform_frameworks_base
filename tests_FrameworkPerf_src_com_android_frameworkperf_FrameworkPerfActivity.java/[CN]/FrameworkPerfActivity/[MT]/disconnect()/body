{
  final TestConnection conn=mCurConnection;
  if (conn != null) {
    if (DEBUG) {
      RuntimeException here=new RuntimeException("here");
      here.fillInStackTrace();
      Log.i(TAG,"Unbinding " + conn,here);
    }
    if (mConnectionBound) {
      unbindService(conn);
      mConnectionBound=false;
    }
    if (conn.mLinked) {
      Message msg=Message.obtain(null,TestService.CMD_TERMINATE);
      try {
        conn.mService.send(msg);
        return;
      }
 catch (      RemoteException e) {
        Log.w(TAG,"Test service aleady died when terminating");
      }
    }
    conn.cleanup();
  }
  connectionDied(conn);
}
