{
  if (beginTime >= mCurrentStats[bucketType].mEndTimeStamp) {
    if (DEBUG) {
      Slog.d(TAG,mLogPrefix + "Requesting stats after " + beginTime+ " but latest is "+ mCurrentStats[bucketType].mEndTimeStamp);
    }
    return UsageStats.EMPTY_STATS;
  }
 else   if (beginTime >= mCurrentStats[bucketType].mBeginTimeStamp) {
    if (DEBUG) {
      Slog.d(TAG,mLogPrefix + "Returning in-memory stats");
    }
    return new UsageStats[]{new UsageStats(mCurrentStats[bucketType])};
  }
 else {
    persistActiveStats();
  }
  if (DEBUG) {
    Slog.d(TAG,mLogPrefix + "SELECT * FROM " + bucketType+ " WHERE beginTime >= "+ beginTime+ " LIMIT "+ UsageStatsService.USAGE_STAT_RESULT_LIMIT);
  }
  final UsageStats[] results=mDatabase.getUsageStats(bucketType,beginTime,UsageStatsService.USAGE_STAT_RESULT_LIMIT);
  if (DEBUG) {
    Slog.d(TAG,mLogPrefix + "Results: " + results.length);
  }
  return results;
}
