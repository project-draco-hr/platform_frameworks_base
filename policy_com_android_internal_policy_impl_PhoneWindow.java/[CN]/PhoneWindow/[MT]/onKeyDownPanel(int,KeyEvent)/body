{
  final int keyCode=event.getKeyCode();
  if (event.getRepeatCount() == 0) {
    mPanelChordingKey=keyCode;
    mPanelMayLongPress=false;
    PanelFeatureState st=getPanelState(featureId,true);
    if (!st.isOpen) {
      if (getContext().getResources().getConfiguration().keyboard == Configuration.KEYBOARD_NOKEYS) {
        mPanelMayLongPress=true;
      }
      return preparePanel(st,event);
    }
  }
 else   if (mPanelMayLongPress && mPanelChordingKey == keyCode && (event.getFlags() & KeyEvent.FLAG_LONG_PRESS) != 0) {
    mPanelChordingKey=0;
    mPanelMayLongPress=false;
    InputMethodManager imm=(InputMethodManager)getContext().getSystemService(Context.INPUT_METHOD_SERVICE);
    if (imm != null) {
      mDecor.performHapticFeedback(HapticFeedbackConstants.LONG_PRESS);
      imm.toggleSoftInput(InputMethodManager.SHOW_FORCED,0);
    }
  }
  return false;
}
