{
  final int keyCode=event.getKeyCode();
  final boolean isDown=event.getAction() == KeyEvent.ACTION_DOWN;
  if (keyCode != KeyEvent.KEYCODE_VOLUME_DOWN && keyCode != KeyEvent.KEYCODE_VOLUME_UP && mVolumeKeyUpTime + VolumePanel.PLAY_SOUND_DELAY > SystemClock.uptimeMillis()) {
    AudioManager audioManager=(AudioManager)getContext().getSystemService(Context.AUDIO_SERVICE);
    if (audioManager != null) {
      audioManager.adjustSuggestedStreamVolume(AudioManager.ADJUST_SAME,mVolumeControlStreamType,AudioManager.FLAG_REMOVE_SOUND_AND_VIBRATE);
    }
  }
  if (isDown && (event.getRepeatCount() == 0)) {
    if ((mPanelChordingKey > 0) && (mPanelChordingKey != keyCode)) {
      boolean handled=performPanelShortcut(mPreparedPanel,keyCode,event,Menu.FLAG_PERFORM_NO_CLOSE);
      if (!handled) {
        handled=dispatchKeyShortcutEvent(event);
        if (handled && mPreparedPanel != null) {
          mPreparedPanel.isHandled=true;
        }
      }
      if (handled) {
        return true;
      }
    }
    if ((mPreparedPanel != null) && mPreparedPanel.isOpen) {
      if (performPanelShortcut(mPreparedPanel,keyCode,event,0)) {
        return true;
      }
    }
  }
  final Callback cb=getCallback();
  final boolean handled=cb != null && mFeatureId < 0 ? cb.dispatchKeyEvent(event) : super.dispatchKeyEvent(event);
  if (handled) {
    return true;
  }
  return isDown ? PhoneWindow.this.onKeyDown(mFeatureId,event.getKeyCode(),event) : PhoneWindow.this.onKeyUp(mFeatureId,event.getKeyCode(),event);
}
