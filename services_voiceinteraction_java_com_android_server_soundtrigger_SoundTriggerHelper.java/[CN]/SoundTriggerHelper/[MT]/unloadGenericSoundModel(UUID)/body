{
synchronized (mLock) {
    MetricsLogger.count(mContext,"sth_unload_generic_sound_model",1);
    if (modelId == null || mModule == null) {
      return STATUS_ERROR;
    }
    ModelData modelData=mModelDataMap.get(modelId);
    if (modelData == null || !modelData.isGenericModel()) {
      Slog.w(TAG,"Unload error: Attempting unload invalid generic model with id:" + modelId);
      return STATUS_ERROR;
    }
    if (!modelData.isModelLoaded()) {
      Slog.i(TAG,"Unload: Given generic model is not loaded:" + modelId);
      return STATUS_OK;
    }
    if (modelData.isModelStarted()) {
      int status=stopRecognitionLocked(modelData,false);
      if (status != SoundTrigger.STATUS_OK) {
        Slog.w(TAG,"stopGenericRecognition failed: " + status);
      }
    }
    int status=mModule.unloadSoundModel(modelData.getHandle());
    if (status != SoundTrigger.STATUS_OK) {
      Slog.w(TAG,"unloadGenericSoundModel() call failed with " + status);
      Slog.w(TAG,"unloadGenericSoundModel() force-marking model as unloaded.");
    }
    mModelDataMap.remove(modelId);
    if (DBG)     dumpModelStateLocked();
    return status;
  }
}
