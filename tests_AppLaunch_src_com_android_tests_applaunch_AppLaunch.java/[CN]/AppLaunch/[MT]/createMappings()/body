{
  mNameToIntent=new LinkedHashMap<String,Intent>();
  mNameToProcess=new LinkedHashMap<String,String>();
  PackageManager pm=getInstrumentation().getContext().getPackageManager();
  Intent intentToResolve=new Intent(Intent.ACTION_MAIN);
  intentToResolve.addCategory(Intent.CATEGORY_LAUNCHER);
  List<ResolveInfo> ris=pm.queryIntentActivities(intentToResolve,0);
  if (ris == null || ris.isEmpty()) {
    Log.i(TAG,"Could not find any apps");
  }
 else {
    for (    ResolveInfo ri : ris) {
      Intent startIntent=new Intent(intentToResolve);
      startIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_RESET_TASK_IF_NEEDED);
      startIntent.setClassName(ri.activityInfo.packageName,ri.activityInfo.name);
      mNameToIntent.put(ri.loadLabel(pm).toString(),startIntent);
      mNameToProcess.put(ri.loadLabel(pm).toString(),ri.activityInfo.processName);
    }
  }
}
