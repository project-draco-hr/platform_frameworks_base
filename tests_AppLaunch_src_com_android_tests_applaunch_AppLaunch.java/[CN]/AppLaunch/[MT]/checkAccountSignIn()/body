{
  if (mRequiredAccounts == null || mRequiredAccounts.isEmpty()) {
    return;
  }
  final AccountManager am=(AccountManager)getInstrumentation().getTargetContext().getSystemService(Context.ACCOUNT_SERVICE);
  Account[] accounts=am.getAccounts();
  Set<String> foundAccounts=new HashSet<String>();
  for (  Account account : accounts) {
    if (mRequiredAccounts.contains(account.type)) {
      foundAccounts.add(account.type);
    }
  }
  if (mRequiredAccounts.size() != foundAccounts.size()) {
    mRequiredAccounts.removeAll(foundAccounts);
    StringBuilder sb=new StringBuilder("Device missing these accounts:");
    for (    String account : mRequiredAccounts) {
      sb.append(' ');
      sb.append(account);
    }
    fail(sb.toString());
  }
}
