{
  final int dimLayer;
  final float dimAmount;
  if (mDimWinAnimator == null) {
    dimLayer=mDimLayer.getLayer();
    dimAmount=0;
  }
 else {
    dimLayer=mDimWinAnimator.mAnimLayer - WindowManagerService.LAYER_OFFSET_DIM;
    dimAmount=mDimWinAnimator.mWin.mAttrs.dimAmount;
  }
  final float targetAlpha=mDimLayer.getTargetAlpha();
  if (targetAlpha != dimAmount) {
    if (mDimWinAnimator == null) {
      mDimLayer.hide(DEFAULT_DIM_DURATION);
    }
 else {
      long duration=(mDimWinAnimator.mAnimating && mDimWinAnimator.mAnimation != null) ? mDimWinAnimator.mAnimation.computeDurationHint() : DEFAULT_DIM_DURATION;
      if (targetAlpha > dimAmount) {
        duration=getDimBehindFadeDuration(duration);
      }
      mDimLayer.show(dimLayer,dimAmount,duration);
    }
  }
 else   if (mDimLayer.getLayer() != dimLayer) {
    mDimLayer.setLayer(dimLayer);
  }
  if (mDimLayer.isAnimating()) {
    if (!mService.okToDisplay()) {
      mDimLayer.show();
    }
 else {
      return mDimLayer.stepAnimation();
    }
  }
  return false;
}
