{
  final int N=ev.getHistorySize();
  final int pointerCount=ev.getPointerCount();
  int touchIndex=(mLastTouch + 1) % NUM_PAST;
  for (int i=0; i < N; i++) {
    for (int id=0; id < MotionEvent.BASE_AVAIL_POINTERS; id++) {
      mPastTime[id][touchIndex]=Long.MIN_VALUE;
    }
    for (int p=0; p < pointerCount; p++) {
      int id=ev.getPointerId(p);
      mPastX[id][touchIndex]=ev.getHistoricalX(p,i);
      mPastY[id][touchIndex]=ev.getHistoricalY(p,i);
      mPastTime[id][touchIndex]=ev.getHistoricalEventTime(i);
    }
    touchIndex=(touchIndex + 1) % NUM_PAST;
  }
  for (int id=0; id < MotionEvent.BASE_AVAIL_POINTERS; id++) {
    mPastTime[id][touchIndex]=Long.MIN_VALUE;
  }
  final long time=ev.getEventTime();
  for (int p=0; p < pointerCount; p++) {
    int id=ev.getPointerId(p);
    mPastX[id][touchIndex]=ev.getX(p);
    mPastY[id][touchIndex]=ev.getY(p);
    mPastTime[id][touchIndex]=time;
  }
  mLastTouch=touchIndex;
}
