{
  if (mClearingCache) {
    if (localLOGV)     Slog.i(TAG,"Thread already running just skip");
    long diffTime=System.currentTimeMillis() - mThreadStartTime;
    if (diffTime > (10 * 60 * 1000)) {
      Slog.w(TAG,"Thread that clears cache file seems to run for ever");
    }
  }
 else {
    restatDataDir();
    if (localLOGV)     Slog.v(TAG,"freeMemory=" + mFreeMem);
    if (mFreeMem < mMemLowThreshold) {
      if (checkCache) {
        if (mFreeMem < mMemCacheStartTrimThreshold) {
          if ((mFreeMemAfterLastCacheClear - mFreeMem) >= ((mMemLowThreshold - mMemCacheStartTrimThreshold) / 4)) {
            mThreadStartTime=System.currentTimeMillis();
            mClearSucceeded=false;
            clearCache();
          }
        }
      }
 else {
        mFreeMemAfterLastCacheClear=mFreeMem;
        if (!mLowMemFlag) {
          Slog.i(TAG,"Running low on memory. Sending notification");
          sendNotification();
          mLowMemFlag=true;
        }
 else {
          if (localLOGV)           Slog.v(TAG,"Running low on memory " + "notification already sent. do nothing");
        }
      }
    }
 else {
      mFreeMemAfterLastCacheClear=mFreeMem;
      if (mLowMemFlag) {
        Slog.i(TAG,"Memory available. Cancelling notification");
        cancelNotification();
        mLowMemFlag=false;
      }
    }
    if (mFreeMem < mMemFullThreshold) {
      if (!mMemFullFlag) {
        sendFullNotification();
        mMemFullFlag=true;
      }
    }
 else {
      if (mMemFullFlag) {
        cancelFullNotification();
        mMemFullFlag=false;
      }
    }
  }
  if (localLOGV)   Slog.i(TAG,"Posting Message again");
  postCheckMemoryMsg(true,DEFAULT_CHECK_INTERVAL);
}
