{
synchronized (mLock) {
    if (!mPrepared) {
      throw new IllegalStateException(cookie + " before prepared");
    }
    if (mSealed) {
      throw new SecurityException(cookie + " not allowed after commit");
    }
  }
}
