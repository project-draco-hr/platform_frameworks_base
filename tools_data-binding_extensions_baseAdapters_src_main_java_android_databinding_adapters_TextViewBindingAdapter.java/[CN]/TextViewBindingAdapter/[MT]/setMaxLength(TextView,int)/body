{
  InputFilter[] filters=view.getFilters();
  if (filters == null) {
    filters=new InputFilter[]{new InputFilter.LengthFilter(value)};
  }
 else {
    boolean foundMaxLength=false;
    for (int i=0; i < filters.length; i++) {
      InputFilter filter=filters[i];
      if (filter instanceof InputFilter.LengthFilter) {
        foundMaxLength=true;
        boolean replace=true;
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.LOLLIPOP) {
          replace=((InputFilter.LengthFilter)filter).getMax() != value;
        }
        if (replace) {
          filters[i]=new InputFilter.LengthFilter(value);
        }
        break;
      }
    }
    if (!foundMaxLength) {
      InputFilter[] oldFilters=filters;
      filters=new InputFilter[oldFilters.length + 1];
      System.arraycopy(oldFilters,0,filters,0,oldFilters.length);
      filters[filters.length - 1]=new InputFilter.LengthFilter(value);
    }
  }
  view.setFilters(filters);
}
