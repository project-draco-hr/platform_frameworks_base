{
  mStartTimeMillis=SystemClock.elapsedRealtime();
  mApfFilter=ApfFilter.maybeCreate(mConfiguration.mApfCapabilities,mNetworkInterface,mCallback,mMulticastFiltering);
  if (mApfFilter == null) {
    mCallback.setFallbackMulticastFilter(mMulticastFiltering);
  }
  if (mConfiguration.mEnableIPv6) {
    startIPv6();
  }
  if (mConfiguration.mUsingIpReachabilityMonitor) {
    mIpReachabilityMonitor=new IpReachabilityMonitor(mContext,mInterfaceName,new IpReachabilityMonitor.Callback(){
      @Override public void notifyLost(      InetAddress ip,      String logMsg){
        mCallback.onReachabilityLost(logMsg);
      }
    }
);
  }
  if (mConfiguration.mEnableIPv4) {
    if (!startIPv4()) {
      transitionTo(mStoppingState);
    }
  }
}
