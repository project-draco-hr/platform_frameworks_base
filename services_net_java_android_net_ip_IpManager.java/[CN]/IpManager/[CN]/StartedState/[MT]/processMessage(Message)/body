{
switch (msg.what) {
case CMD_STOP:
    transitionTo(mStoppedState);
  break;
case CMD_START:
Log.e(TAG,"ALERT: START received in StartedState.");
break;
case CMD_CONFIRM:
if (mCallback.usingIpReachabilityMonitor()) {
mIpReachabilityMonitor.probeAll();
}
break;
case CMD_UPDATE_DHCPV4_RESULTS:
final DhcpResults dhcpResults=(DhcpResults)msg.obj;
if (dhcpResults != null) {
mDhcpResults=new DhcpResults(dhcpResults);
setLinkProperties(assembleLinkProperties());
mCallback.onIPv4ProvisioningSuccess(dhcpResults);
}
 else {
mDhcpResults=null;
setLinkProperties(assembleLinkProperties());
mCallback.onIPv4ProvisioningFailure();
}
break;
case EVENT_NETLINK_LINKPROPERTIES_CHANGED:
final LinkProperties newLp=assembleLinkProperties();
final ProvisioningChange delta=setLinkProperties(newLp);
switch (delta) {
case GAINED_PROVISIONING:
mCallback.onProvisioningSuccess(newLp);
break;
case LOST_PROVISIONING:
mCallback.onProvisioningFailure(newLp);
break;
default :
mCallback.onLinkPropertiesChange(newLp);
break;
}
break;
default :
return NOT_HANDLED;
}
return HANDLED;
}
