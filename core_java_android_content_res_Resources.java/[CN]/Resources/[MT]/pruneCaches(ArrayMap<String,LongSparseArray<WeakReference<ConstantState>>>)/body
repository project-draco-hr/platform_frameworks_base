{
  final int N=caches.size();
  for (int i=N - 1; i >= 0; i--) {
    final LongSparseArray<WeakReference<ConstantState>> cache=caches.get(i);
    if (pruneCache(cache)) {
      caches.removeAt(i);
    }
  }
}
