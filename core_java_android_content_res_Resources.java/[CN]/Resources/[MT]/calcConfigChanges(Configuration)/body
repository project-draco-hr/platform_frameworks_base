{
  int configChanges=0xfffffff;
  if (config != null) {
    mTmpConfig.setTo(config);
    int density=config.densityDpi;
    if (density == Configuration.DENSITY_DPI_UNDEFINED) {
      density=mMetrics.noncompatDensityDpi;
    }
    mCompatibilityInfo.applyToConfiguration(density,mTmpConfig);
    if (mTmpConfig.locale == null) {
      mTmpConfig.locale=Locale.getDefault();
      mTmpConfig.setLayoutDirection(mTmpConfig.locale);
    }
    configChanges=mConfiguration.updateFrom(mTmpConfig);
    configChanges=ActivityInfo.activityInfoConfigToNative(configChanges);
  }
  return configChanges;
}
