{
synchronized (mLock) {
    PackageInfo info;
    boolean changed=false;
    try {
      info=mPackageManager.getPackageInfo(packageName,PackageManager.GET_ACTIVITIES | PackageManager.GET_META_DATA);
    }
 catch (    NameNotFoundException e) {
      Slog.e(TAG,"handlePackageUpdate could not find package " + packageName,e);
      return;
    }
    ActivityInfo[] activities=info.activities;
    if (activities == null)     return;
    for (int i=0; i < activities.length; i++) {
      if (handlePackageUpdateLocked(packageName,activities[i],UsbManager.ACTION_USB_DEVICE_ATTACHED)) {
        changed=true;
      }
      if (handlePackageUpdateLocked(packageName,activities[i],UsbManager.ACTION_USB_ACCESSORY_ATTACHED)) {
        changed=true;
      }
    }
    if (changed) {
      writeSettingsLocked();
    }
  }
}
