{
  if (mVendorId != -1 && device.getVendorId() != mVendorId)   return false;
  if (mProductId != -1 && device.getProductId() != mProductId)   return false;
  if (matches(device.getDeviceClass(),device.getDeviceSubclass(),device.getDeviceProtocol()))   return true;
  int count=device.getInterfaceCount();
  for (int i=0; i < count; i++) {
    UsbInterface intf=device.getInterface(i);
    if (matches(intf.getInterfaceClass(),intf.getInterfaceSubclass(),intf.getInterfaceProtocol()))     return true;
  }
  return false;
}
