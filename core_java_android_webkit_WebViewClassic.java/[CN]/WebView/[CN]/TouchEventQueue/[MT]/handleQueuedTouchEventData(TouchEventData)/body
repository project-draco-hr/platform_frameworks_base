{
  if (ted.mMotionEvent != null) {
    mLastEventTime=ted.mMotionEvent.getEventTime();
  }
  if (!ted.mReprocess) {
    if (ted.mAction == MotionEvent.ACTION_DOWN && mPreventDefault == PREVENT_DEFAULT_MAYBE_YES) {
      mPreventDefault=ted.mNativeResult ? PREVENT_DEFAULT_YES : PREVENT_DEFAULT_NO_FROM_TOUCH_DOWN;
    }
 else     if (ted.mAction == MotionEvent.ACTION_MOVE && mPreventDefault == PREVENT_DEFAULT_NO_FROM_TOUCH_DOWN) {
      mPreventDefault=ted.mNativeResult ? PREVENT_DEFAULT_YES : PREVENT_DEFAULT_NO;
    }
    if (mPreventDefault == PREVENT_DEFAULT_YES) {
      mTouchHighlightRegion.setEmpty();
    }
  }
 else {
    if (ted.mPoints.length > 1) {
      if (!ted.mNativeResult && mPreventDefault != PREVENT_DEFAULT_YES) {
        mPreventDefault=PREVENT_DEFAULT_NO;
        handleMultiTouchInWebView(ted.mMotionEvent);
      }
 else {
        mPreventDefault=PREVENT_DEFAULT_YES;
      }
      return;
    }
    if (!ted.mNativeResult) {
switch (ted.mAction) {
case MotionEvent.ACTION_DOWN:
        mLastDeferTouchX=ted.mPointsInView[0].x;
      mLastDeferTouchY=ted.mPointsInView[0].y;
    mDeferTouchMode=TOUCH_INIT_MODE;
  break;
case MotionEvent.ACTION_MOVE:
{
  int x=ted.mPointsInView[0].x;
  int y=ted.mPointsInView[0].y;
  if (mDeferTouchMode != TOUCH_DRAG_MODE) {
    mDeferTouchMode=TOUCH_DRAG_MODE;
    mLastDeferTouchX=x;
    mLastDeferTouchY=y;
    startScrollingLayer(x,y);
    startDrag();
  }
  int deltaX=pinLocX((int)(getScrollX() + mLastDeferTouchX - x)) - getScrollX();
  int deltaY=pinLocY((int)(getScrollY() + mLastDeferTouchY - y)) - getScrollY();
  doDrag(deltaX,deltaY);
  if (deltaX != 0)   mLastDeferTouchX=x;
  if (deltaY != 0)   mLastDeferTouchY=y;
  break;
}
case MotionEvent.ACTION_UP:
case MotionEvent.ACTION_CANCEL:
if (mDeferTouchMode == TOUCH_DRAG_MODE) {
mScroller.springBack(getScrollX(),getScrollY(),0,computeMaxScrollX(),0,computeMaxScrollY());
invalidate();
WebViewCore.resumePriority();
WebViewCore.resumeUpdatePicture(mWebViewCore);
}
mDeferTouchMode=TOUCH_DONE_MODE;
break;
case WebViewCore.ACTION_DOUBLETAP:
mLastDeferTouchX=ted.mPointsInView[0].x;
mLastDeferTouchY=ted.mPointsInView[0].y;
mZoomManager.handleDoubleTap(mLastTouchX,mLastTouchY);
mDeferTouchMode=TOUCH_DONE_MODE;
break;
case WebViewCore.ACTION_LONGPRESS:
HitTestResult hitTest=getHitTestResult();
if (hitTest != null && hitTest.mType != HitTestResult.UNKNOWN_TYPE) {
performLongClick();
}
mDeferTouchMode=TOUCH_DONE_MODE;
break;
}
}
}
}
