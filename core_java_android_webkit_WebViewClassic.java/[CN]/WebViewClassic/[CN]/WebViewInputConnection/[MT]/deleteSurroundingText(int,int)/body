{
  Editable content=getEditable();
  int a=Selection.getSelectionStart(content);
  int b=Selection.getSelectionEnd(content);
  if (a > b) {
    int tmp=a;
    a=b;
    b=tmp;
  }
  int ca=getComposingSpanStart(content);
  int cb=getComposingSpanEnd(content);
  if (cb < ca) {
    int tmp=ca;
    ca=cb;
    cb=tmp;
  }
  if (ca != -1 && cb != -1) {
    if (ca < a)     a=ca;
    if (cb > b)     b=cb;
  }
  int endDelete=Math.min(content.length(),b + rightLength);
  if (endDelete > b) {
    setNewText(b,endDelete,"");
  }
  int startDelete=Math.max(0,a - leftLength);
  if (startDelete < a) {
    setNewText(startDelete,a,"");
  }
  return super.deleteSurroundingText(leftLength,rightLength);
}
