{
  Editable editable=getEditable();
  int selectionStart=Selection.getSelectionStart(editable);
  int selectionEnd=Selection.getSelectionEnd(editable);
  text=limitReplaceTextByMaxLength(text,editable.length());
  editable.replace(0,editable.length(),text);
  restartInput();
  selectionStart=Math.min(selectionStart,editable.length());
  selectionEnd=Math.min(selectionEnd,editable.length());
  setSelection(selectionStart,selectionEnd);
  finishComposingText();
}
