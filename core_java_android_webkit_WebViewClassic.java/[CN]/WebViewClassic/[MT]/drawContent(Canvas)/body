{
  if (mDrawHistory) {
    canvas.scale(mZoomManager.getScale(),mZoomManager.getScale());
    canvas.drawPicture(mHistoryPicture);
    return;
  }
  if (mNativeClass == 0)   return;
  boolean animateZoom=mZoomManager.isFixedLengthAnimationInProgress();
  boolean animateScroll=((!mScroller.isFinished() || mVelocityTracker != null) && (mTouchMode != TOUCH_DRAG_MODE || mHeldMotionless != MOTIONLESS_TRUE));
  if (mTouchMode == TOUCH_DRAG_MODE) {
    if (mHeldMotionless == MOTIONLESS_PENDING) {
      mPrivateHandler.removeMessages(DRAG_HELD_MOTIONLESS);
      mPrivateHandler.removeMessages(AWAKEN_SCROLL_BARS);
      mHeldMotionless=MOTIONLESS_FALSE;
    }
    if (mHeldMotionless == MOTIONLESS_FALSE) {
      mPrivateHandler.sendMessageDelayed(mPrivateHandler.obtainMessage(DRAG_HELD_MOTIONLESS),MOTIONLESS_TIME);
      mPrivateHandler.sendMessageDelayed(mPrivateHandler.obtainMessage(AWAKEN_SCROLL_BARS),ViewConfiguration.getScrollDefaultDelay());
      mHeldMotionless=MOTIONLESS_PENDING;
    }
  }
  int saveCount=canvas.save();
  if (animateZoom) {
    mZoomManager.animateZoom(canvas);
  }
 else   if (!canvas.isHardwareAccelerated()) {
    canvas.scale(mZoomManager.getScale(),mZoomManager.getScale());
  }
  boolean UIAnimationsRunning=false;
  if (mNativeClass != 0 && !canvas.isHardwareAccelerated() && nativeEvaluateLayersAnimations(mNativeClass)) {
    UIAnimationsRunning=true;
    mWebViewCore.sendMessage(EventHub.NOTIFY_ANIMATION_STARTED);
    invalidate();
  }
  int extras=DRAW_EXTRAS_NONE;
  if (!mFindIsUp && mSelectingText) {
    extras=DRAW_EXTRAS_SELECTION;
  }
  calcOurContentVisibleRectF(mVisibleContentRect);
  if (canvas.isHardwareAccelerated()) {
    Rect invScreenRect=mGLViewportEmpty ? null : mInvScreenRect;
    Rect screenRect=mGLViewportEmpty ? null : mScreenRect;
    int functor=nativeCreateDrawGLFunction(mNativeClass,invScreenRect,screenRect,mVisibleContentRect,getScale(),extras);
    ((HardwareCanvas)canvas).callDrawGLFunction(functor);
    if (mHardwareAccelSkia != getSettings().getHardwareAccelSkiaEnabled()) {
      mHardwareAccelSkia=getSettings().getHardwareAccelSkiaEnabled();
      nativeUseHardwareAccelSkia(mHardwareAccelSkia);
    }
  }
 else {
    DrawFilter df=null;
    if (mZoomManager.isZoomAnimating() || UIAnimationsRunning) {
      df=mZoomFilter;
    }
 else     if (animateScroll) {
      df=mScrollFilter;
    }
    canvas.setDrawFilter(df);
    nativeDraw(canvas,mVisibleContentRect,mBackgroundColor,extras);
    canvas.setDrawFilter(null);
  }
  canvas.restoreToCount(saveCount);
  drawTextSelectionHandles(canvas);
  if (extras == DRAW_EXTRAS_CURSOR_RING) {
    if (mTouchMode == TOUCH_SHORTPRESS_START_MODE) {
      mTouchMode=TOUCH_SHORTPRESS_MODE;
    }
  }
}
