{
  if (textGeneration == mTextGeneration) {
    if (inEditingMode() && mWebTextView.isSameTextField(nodePointer)) {
      mWebTextView.setSelectionFromWebKit(data.mStart,data.mEnd);
    }
 else     if (mInputConnection != null && mFieldPointer == nodePointer) {
      mInputConnection.setSelection(data.mStart,data.mEnd);
    }
  }
  nativeSetTextSelection(mNativeClass,data.mSelectTextPtr);
  if (data.mSelectTextPtr != 0 && (data.mStart != data.mEnd || (mFieldPointer == nodePointer && mFieldPointer != 0))) {
    mIsCaretSelection=(data.mStart == data.mEnd);
    if (!mSelectingText) {
      setupWebkitSelect();
    }
 else     if (!mSelectionStarted) {
      syncSelectionCursors();
    }
    if (mIsCaretSelection) {
      resetCaretTimer();
    }
  }
 else {
    selectionDone();
  }
  invalidate();
}
