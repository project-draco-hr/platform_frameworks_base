{
  final String[] classPathElements=classPath.split(":");
  final InstallerConnection installer=new InstallerConnection();
  final String instructionSet=VMRuntime.getRuntime().vmInstructionSet();
  try {
    for (    String classPathElement : classPathElements) {
      final byte dexopt=DexFile.isDexOptNeededInternal(classPathElement,"*",instructionSet,false);
      if (dexopt == DexFile.DEXOPT_NEEDED) {
        installer.dexopt(classPathElement,Process.SYSTEM_UID,false,instructionSet);
      }
 else       if (dexopt == DexFile.PATCHOAT_NEEDED) {
        installer.patchoat(classPathElement,Process.SYSTEM_UID,false,instructionSet);
      }
    }
  }
 catch (  IOException ioe) {
    throw new RuntimeException("Error starting system_server",ioe);
  }
 finally {
    installer.disconnect();
  }
}
