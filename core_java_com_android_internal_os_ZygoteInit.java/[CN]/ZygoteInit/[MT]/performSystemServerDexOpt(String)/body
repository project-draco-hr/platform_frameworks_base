{
  final String[] classPathElements=classPath.split(":");
  final InstallerConnection installer=new InstallerConnection();
  installer.waitForConnection();
  final String instructionSet=VMRuntime.getRuntime().vmInstructionSet();
  try {
    for (    String classPathElement : classPathElements) {
      final int dexoptNeeded=DexFile.getDexOptNeeded(classPathElement,"*",instructionSet,false);
      if (dexoptNeeded != DexFile.NO_DEXOPT_NEEDED) {
        installer.dexopt(classPathElement,Process.SYSTEM_UID,false,instructionSet,dexoptNeeded);
      }
    }
  }
 catch (  IOException ioe) {
    throw new RuntimeException("Error starting system_server",ioe);
  }
 finally {
    installer.disconnect();
  }
}
