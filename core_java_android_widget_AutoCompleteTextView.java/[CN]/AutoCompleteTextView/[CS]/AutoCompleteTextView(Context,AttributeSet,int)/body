{
  super(context,attrs,defStyle);
  mPopup=new PopupWindow(context,attrs,com.android.internal.R.attr.autoCompleteTextViewStyle);
  TypedArray a=context.obtainStyledAttributes(attrs,com.android.internal.R.styleable.AutoCompleteTextView,defStyle,0);
  mThreshold=a.getInt(R.styleable.AutoCompleteTextView_completionThreshold,2);
  mHintText=a.getText(R.styleable.AutoCompleteTextView_completionHint);
  mDropDownListHighlight=a.getDrawable(R.styleable.AutoCompleteTextView_dropDownSelector);
  mDropDownVerticalOffset=(int)a.getDimension(R.styleable.AutoCompleteTextView_dropDownVerticalOffset,0.0f);
  mDropDownHorizontalOffset=(int)a.getDimension(R.styleable.AutoCompleteTextView_dropDownHorizontalOffset,0.0f);
  mHintResource=a.getResourceId(R.styleable.AutoCompleteTextView_completionHintView,R.layout.simple_dropdown_hint);
  int contentType=a.getInt(R.styleable.AutoCompleteTextView_inputType,EditorInfo.TYPE_NULL);
  if (contentType == EditorInfo.TYPE_NULL) {
    contentType=getInputType();
    if ((contentType & EditorInfo.TYPE_MASK_CLASS) == EditorInfo.TYPE_CLASS_TEXT) {
      contentType|=EditorInfo.TYPE_TEXT_FLAG_AUTO_COMPLETE;
      setRawInputType(contentType);
    }
  }
  a.recycle();
  setFocusable(true);
  addTextChangedListener(new MyWatcher());
}
