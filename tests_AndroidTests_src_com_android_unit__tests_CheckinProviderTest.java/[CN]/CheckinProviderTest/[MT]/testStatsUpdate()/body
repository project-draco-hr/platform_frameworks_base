{
  ContentResolver r=getContext().getContentResolver();
  Uri uri=Checkin.updateStats(r,Checkin.Stats.Tag.TEST,0,0);
  assertNotNull(uri);
  assertEquals(1,r.delete(uri,null,null));
  assertFalse(r.query(uri,null,null,null,null).moveToNext());
  Uri u2=Checkin.updateStats(r,Checkin.Stats.Tag.TEST,1,0.5);
  assertFalse(uri.equals(u2));
  Cursor c=r.query(u2,null,null,null,null);
  assertTrue(c.moveToNext());
  assertEquals(1,c.getInt(c.getColumnIndex(Checkin.Stats.COUNT)));
  assertEquals(0.5,c.getDouble(c.getColumnIndex(Checkin.Stats.SUM)));
  assertFalse(c.moveToNext());
  Uri u3=Checkin.updateStats(r,Checkin.Stats.Tag.TEST,2,1.0);
  assertEquals(u2,u3);
  c.requery();
  assertTrue(c.moveToNext());
  assertEquals(3,c.getInt(c.getColumnIndex(Checkin.Stats.COUNT)));
  assertEquals(1.5,c.getDouble(c.getColumnIndex(Checkin.Stats.SUM)));
  assertFalse(c.moveToNext());
  Uri u4=Checkin.updateStats(r,Checkin.Stats.Tag.TEST,-3,-1.5);
  assertNull(u4);
  c.requery();
  assertFalse(c.moveToNext());
  c.close();
}
