{
  if (!subsession.isSessionCompleted() || subsession.getChildSessions().size() != 0) {
    return;
  }
  Session parentSession=subsession.getParentSession();
  if (parentSession != null) {
    subsession.setParentSession(null);
    parentSession.removeChild(subsession);
    if (parentSession.isExternal()) {
      long fullSessionTimeMs=System.currentTimeMillis() - subsession.getExecutionStartTimeMilliseconds();
      notifySessionCompleteListeners(subsession.getShortMethodName(),fullSessionTimeMs);
    }
    endParentSessions(parentSession);
  }
 else {
    long fullSessionTimeMs=System.currentTimeMillis() - subsession.getExecutionStartTimeMilliseconds();
    Log.d(LOGGING_TAG,Session.END_SESSION + " (dur: " + fullSessionTimeMs+ " ms): "+ subsession.toString());
    if (!subsession.isExternal()) {
      notifySessionCompleteListeners(subsession.getShortMethodName(),fullSessionTimeMs);
    }
  }
}
