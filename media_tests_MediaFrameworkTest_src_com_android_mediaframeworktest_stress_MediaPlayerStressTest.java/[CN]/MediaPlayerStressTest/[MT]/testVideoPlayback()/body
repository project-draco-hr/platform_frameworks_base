{
  String fileWithError="Filename:\n";
  File playbackOutput=new File("/sdcard/PlaybackTestResult.txt");
  Writer output=new BufferedWriter(new FileWriter(playbackOutput,true));
  boolean testResult=true;
  boolean onCompleteSuccess=false;
  File dir=new File(MediaNames.MEDIA_SAMPLE_POOL);
  Instrumentation inst=getInstrumentation();
  Intent intent=new Intent();
  intent.setClass(getInstrumentation().getTargetContext(),MediaFrameworkTest.class);
  intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
  String[] children=dir.list();
  if (children == null) {
    Log.v("MediaPlayerApiTest:testMediaSamples","dir is empty");
    return;
  }
 else {
    for (int i=0; i < children.length; i++) {
      Activity act=inst.startActivitySync(intent);
      String filename=children[i];
      onCompleteSuccess=CodecTest.playMediaSamples(dir + "/" + filename);
      if (!onCompleteSuccess) {
        fileWithError+=filename + '\n';
        Log.v(TAG,"Failure File : " + fileWithError);
        testResult=false;
      }
      Thread.sleep(3000);
      act.finish();
      writeTestOutput(filename,output);
      updateTestResult();
    }
    writeTestSummary(output);
    output.close();
    assertTrue("testMediaSamples",testResult);
  }
}
