{
  mOnlyAllowReadOnlyOperations=false;
  final int functionCount=configuration.customFunctions.size();
  for (int i=0; i < functionCount; i++) {
    SQLiteCustomFunction function=configuration.customFunctions.get(i);
    if (!mConfiguration.customFunctions.contains(function)) {
      nativeRegisterCustomFunction(mConnectionPtr,function);
    }
  }
  boolean foreignKeyModeChanged=configuration.foreignKeyConstraintsEnabled != mConfiguration.foreignKeyConstraintsEnabled;
  boolean walModeChanged=((configuration.openFlags ^ mConfiguration.openFlags) & SQLiteDatabase.ENABLE_WRITE_AHEAD_LOGGING) != 0;
  boolean localeChanged=!configuration.locale.equals(mConfiguration.locale);
  mConfiguration.updateParametersFrom(configuration);
  mPreparedStatementCache.resize(configuration.maxSqlCacheSize);
  if (foreignKeyModeChanged) {
    setForeignKeyModeFromConfiguration();
  }
  if (walModeChanged) {
    setWalModeFromConfiguration();
  }
  if (localeChanged) {
    setLocaleFromConfiguration();
  }
}
