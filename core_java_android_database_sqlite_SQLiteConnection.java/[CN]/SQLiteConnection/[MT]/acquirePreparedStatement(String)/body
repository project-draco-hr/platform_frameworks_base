{
  PreparedStatement statement=mPreparedStatementCache.get(sql);
  if (statement != null) {
    return statement;
  }
  final int statementPtr=nativePrepareStatement(mConnectionPtr,sql);
  try {
    final int numParameters=nativeGetParameterCount(mConnectionPtr,statementPtr);
    final int type=DatabaseUtils.getSqlStatementType(sql);
    final boolean readOnly=nativeIsReadOnly(mConnectionPtr,statementPtr);
    statement=obtainPreparedStatement(sql,statementPtr,numParameters,type,readOnly);
    if (isCacheable(type)) {
      mPreparedStatementCache.put(sql,statement);
      statement.mInCache=true;
    }
  }
 catch (  RuntimeException ex) {
    if (statement == null || !statement.mInCache) {
      nativeFinalizeStatement(mConnectionPtr,statementPtr);
    }
    throw ex;
  }
  return statement;
}
