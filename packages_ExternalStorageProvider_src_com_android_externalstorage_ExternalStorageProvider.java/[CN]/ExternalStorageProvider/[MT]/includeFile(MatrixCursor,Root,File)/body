{
  int flags=0;
  if (file.isDirectory()) {
    flags|=DocumentsContract.FLAG_SUPPORTS_SEARCH;
  }
  if (file.isDirectory() && file.canWrite()) {
    flags|=DocumentsContract.FLAG_SUPPORTS_CREATE;
  }
  if (file.canWrite()) {
    flags|=DocumentsContract.FLAG_SUPPORTS_RENAME;
    flags|=DocumentsContract.FLAG_SUPPORTS_DELETE;
  }
  final String mimeType=getTypeForFile(file);
  if (mimeType.startsWith("image/")) {
    flags|=DocumentsContract.FLAG_SUPPORTS_THUMBNAIL;
  }
  final String docId=fileToDocId(root,file);
  final long id=docId.hashCode();
  final String displayName;
  if (DocumentsContract.ROOT_DOC_ID.equals(docId)) {
    displayName=root.title;
  }
 else {
    displayName=file.getName();
  }
  cursor.addRow(new Object[]{id,displayName,file.length(),docId,mimeType,file.lastModified(),flags});
}
