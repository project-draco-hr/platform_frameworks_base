{
  int flags=0;
  if (file.isDirectory()) {
    flags|=Documents.FLAG_SUPPORTS_SEARCH;
  }
  if (file.isDirectory() && file.canWrite()) {
    flags|=Documents.FLAG_SUPPORTS_CREATE;
  }
  if (file.canWrite()) {
    flags|=Documents.FLAG_SUPPORTS_WRITE;
    flags|=Documents.FLAG_SUPPORTS_RENAME;
    flags|=Documents.FLAG_SUPPORTS_DELETE;
  }
  final String mimeType=getTypeForFile(file);
  if (mimeType.startsWith("image/")) {
    flags|=Documents.FLAG_SUPPORTS_THUMBNAIL;
  }
  final String docId=fileToDocId(root,file);
  final String displayName;
  if (Documents.DOC_ID_ROOT.equals(docId)) {
    displayName=root.title;
  }
 else {
    displayName=file.getName();
  }
  final RowBuilder row=result.newRow();
  row.offer(DocumentColumns.DOC_ID,docId);
  row.offer(DocumentColumns.DISPLAY_NAME,displayName);
  row.offer(DocumentColumns.SIZE,file.length());
  row.offer(DocumentColumns.MIME_TYPE,mimeType);
  row.offer(DocumentColumns.LAST_MODIFIED,file.lastModified());
  row.offer(DocumentColumns.FLAGS,flags);
}
