{
  final File parent=getFileForDocId(docId);
  displayName=validateDisplayName(mimeType,displayName);
  final File file=new File(parent,displayName);
  if (Documents.MIME_TYPE_DIR.equals(mimeType)) {
    if (!file.mkdir()) {
      throw new IllegalStateException("Failed to mkdir " + file);
    }
  }
 else {
    try {
      if (!file.createNewFile()) {
        throw new IllegalStateException("Failed to touch " + file);
      }
    }
 catch (    IOException e) {
      throw new IllegalStateException("Failed to touch " + file + ": "+ e);
    }
  }
  return getDocIdForFile(file);
}
