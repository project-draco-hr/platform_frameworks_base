{
  String path=file.getAbsolutePath();
  Map.Entry<String,File> mostSpecific=null;
synchronized (mRootsLock) {
    for (    Map.Entry<String,File> root : mIdToPath.entrySet()) {
      final String rootPath=root.getValue().getPath();
      if (path.startsWith(rootPath) && (mostSpecific == null || rootPath.length() > mostSpecific.getValue().getPath().length())) {
        mostSpecific=root;
      }
    }
  }
  if (mostSpecific == null) {
    throw new FileNotFoundException("Failed to find root that contains " + path);
  }
  final String rootPath=mostSpecific.getValue().getPath();
  if (rootPath.equals(path)) {
    path="";
  }
 else   if (rootPath.endsWith("/")) {
    path=path.substring(rootPath.length());
  }
 else {
    path=path.substring(rootPath.length() + 1);
  }
  return mostSpecific.getKey() + ':' + path;
}
