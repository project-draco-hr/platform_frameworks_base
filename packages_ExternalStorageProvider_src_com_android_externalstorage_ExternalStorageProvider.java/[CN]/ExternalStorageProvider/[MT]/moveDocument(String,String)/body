{
  final File before=getFileForDocId(sourceDocumentId);
  final File after=new File(getFileForDocId(targetParentDocumentId),before.getName());
  if (after.exists()) {
    throw new IllegalStateException("Already exists " + after);
  }
  if (!before.renameTo(after)) {
    throw new IllegalStateException("Failed to move to " + after);
  }
  return getDocIdForFile(after);
}
