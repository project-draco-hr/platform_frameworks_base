{
  if (mActionBar != null) {
    if (!mActionBar.isOverflowMenuShowing() || !toggleMenuMode) {
      final Callback cb=getCallback();
      if (cb != null) {
        final PanelFeatureState st=getPanelState(FEATURE_OPTIONS_PANEL,true);
        if (cb.onPreparePanel(FEATURE_OPTIONS_PANEL,st.createdPanelView,st.menu)) {
          mActionBar.showOverflowMenu();
        }
      }
    }
 else {
      mActionBar.hideOverflowMenu();
    }
    return;
  }
  PanelFeatureState st=getPanelState(FEATURE_OPTIONS_PANEL,true);
  boolean newExpandedMode=toggleMenuMode ? !st.isInExpandedMode : st.isInExpandedMode;
  st.refreshDecorView=true;
  closePanel(st,false);
  st.isInExpandedMode=newExpandedMode;
  openPanel(st,null);
}
