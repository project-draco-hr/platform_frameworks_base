{
  final StructNlMsgHdr nlmsghdr=new StructNlMsgHdr();
  nlmsghdr.nlmsg_type=NetlinkConstants.RTM_NEWNEIGH;
  nlmsghdr.nlmsg_flags=NLM_F_REQUEST | NLM_F_ACK | NLM_F_REPLACE;
  nlmsghdr.nlmsg_seq=seqNo;
  final RtNetlinkNeighborMessage msg=new RtNetlinkNeighborMessage(nlmsghdr);
  msg.mNdmsg=new StructNdMsg();
  msg.mNdmsg.ndm_family=(byte)((ip instanceof Inet6Address) ? OsConstants.AF_INET6 : OsConstants.AF_INET);
  msg.mNdmsg.ndm_ifindex=ifIndex;
  msg.mNdmsg.ndm_state=nudState;
  msg.mDestination=ip;
  msg.mLinkLayerAddr=llAddr;
  final byte[] bytes=new byte[msg.getRequiredSpace()];
  nlmsghdr.nlmsg_len=bytes.length;
  final ByteBuffer byteBuffer=ByteBuffer.wrap(bytes);
  byteBuffer.order(ByteOrder.nativeOrder());
  msg.pack(byteBuffer);
  return bytes;
}
