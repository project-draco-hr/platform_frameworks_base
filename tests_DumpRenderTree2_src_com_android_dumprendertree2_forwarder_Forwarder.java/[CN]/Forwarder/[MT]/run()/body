{
  while (true) {
synchronized (this) {
      if (!mIsRunning) {
        return;
      }
      Socket localSocket;
      Socket remoteSocket;
      try {
        localSocket=mServerSocket.accept();
        remoteSocket=AdbUtils.getSocketToRemoteMachine(mRemoteMachineIpAddress,mPort);
      }
 catch (      IOException e) {
        Log.w(LOG_TAG,"mPort=" + mPort,e);
        return;
      }
      if (remoteSocket == null) {
        try {
          localSocket.close();
        }
 catch (        IOException e) {
          Log.e(LOG_TAG,"mPort=" + mPort,e);
        }
        Log.e(LOG_TAG,"run(): mPort= " + mPort + " Failed to start forwarding from "+ localSocket);
        continue;
      }
      final ConnectionHandler connectionHandler=new ConnectionHandler(localSocket,remoteSocket);
      ConnectionHandler.OnFinishedCallback callback=new ConnectionHandler.OnFinishedCallback(){
        @Override public void onFinished(){
          removeConncetionHandler(connectionHandler);
        }
      }
;
      connectionHandler.registerOnConnectionHandlerFinishedCallback(callback);
      mConnectionHandlers.add(connectionHandler);
      connectionHandler.start();
    }
  }
}
