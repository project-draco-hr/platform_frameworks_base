{
  AccessibilityEvent sentEvent=AccessibilityEvent.obtain();
  IAccessibilityManager mockServiceInterface=mMockServiceInterface;
  expect(mockServiceInterface.addClient(anyIAccessibilityManagerClient(),UserHandle.USER_OWNER)).andReturn(AccessibilityManager.STATE_FLAG_ACCESSIBILITY_ENABLED);
  expect(mockServiceInterface.sendAccessibilityEvent(eqAccessibilityEvent(sentEvent),UserHandle.USER_OWNER)).andReturn(true);
  expect(mockServiceInterface.sendAccessibilityEvent(eqAccessibilityEvent(sentEvent),UserHandle.USER_OWNER)).andReturn(false);
  replay(mockServiceInterface);
  AccessibilityManager manager=new AccessibilityManager(mContext,mockServiceInterface,UserHandle.USER_OWNER);
  manager.sendAccessibilityEvent(sentEvent);
  AccessibilityEvent nextEventDifferentProcesses=AccessibilityEvent.obtain();
  assertSame("The manager and the service are in different processes, so the event must be " + "recycled",sentEvent,nextEventDifferentProcesses);
  manager.sendAccessibilityEvent(sentEvent);
  AccessibilityEvent nextEventSameProcess=AccessibilityEvent.obtain();
  assertNotSame("The manager and the service are in the same process, so the event must not" + "be recycled",sentEvent,nextEventSameProcess);
  verify(mockServiceInterface);
}
