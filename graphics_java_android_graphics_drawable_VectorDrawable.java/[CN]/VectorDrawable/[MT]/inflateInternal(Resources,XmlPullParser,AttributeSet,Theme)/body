{
  final VAnimatedPath animatedPath=new VAnimatedPath();
  boolean noSizeTag=true;
  boolean noViewportTag=true;
  boolean noGroupTag=true;
  boolean noPathTag=true;
  VGroup currentGroup=null;
  int eventType=parser.getEventType();
  while (eventType != XmlPullParser.END_DOCUMENT) {
    if (eventType == XmlPullParser.START_TAG) {
      final String tagName=parser.getName();
      if (SHAPE_PATH.equals(tagName)) {
        final VPath path=new VPath();
        path.inflate(res,attrs,theme);
        currentGroup.add(path);
        noPathTag=false;
      }
 else       if (SHAPE_ANIMATION.equals(tagName)) {
        final VAnimation anim=new VAnimation();
        anim.inflate(animatedPath.mGroupList,res,attrs,theme);
        animatedPath.addAnimation(anim);
      }
 else       if (SHAPE_SIZE.equals(tagName)) {
        animatedPath.parseSize(res,attrs);
        noSizeTag=false;
      }
 else       if (SHAPE_VIEWPORT.equals(tagName)) {
        animatedPath.parseViewport(res,attrs);
        noViewportTag=false;
      }
 else       if (SHAPE_GROUP.equals(tagName)) {
        currentGroup=new VGroup();
        animatedPath.mGroupList.add(currentGroup);
        noGroupTag=false;
      }
 else       if (SHAPE_VECTOR.equals(tagName)) {
        final TypedArray a=res.obtainAttributes(attrs,R.styleable.VectorDrawable);
        animatedPath.setTrigger(a.getInteger(R.styleable.VectorDrawable_trigger,0));
        final int versionCode=a.getInt(R.styleable.VectorDrawable_versionCode,1);
        if (versionCode != 1) {
          throw new IllegalArgumentException("So far, VectorDrawable only support version 1");
        }
        a.recycle();
      }
    }
    eventType=parser.next();
  }
  if (noSizeTag || noViewportTag || noGroupTag|| noPathTag) {
    final StringBuffer tag=new StringBuffer();
    if (noSizeTag) {
      tag.append(SHAPE_SIZE);
    }
    if (noViewportTag) {
      if (tag.length() > 0) {
        tag.append(" & ");
      }
      tag.append(SHAPE_SIZE);
    }
    if (noGroupTag) {
      if (tag.length() > 0) {
        tag.append(" & ");
      }
      tag.append(SHAPE_GROUP);
    }
    if (noPathTag) {
      if (tag.length() > 0) {
        tag.append(" or ");
      }
      tag.append(SHAPE_PATH);
    }
    throw new XmlPullParserException("no " + tag + " defined");
  }
  animatedPath.parseFinish();
  return animatedPath;
}
