{
  final boolean justBootedUp=mAccounts == INITIAL_ACCOUNTS_ARRAY;
  List<UserInfo> users=getAllUsers();
  if (users == null)   return;
  int count=0;
  AccountAndUser[] allAccounts=AccountManagerService.getSingleton().getAllAccounts();
  for (  UserInfo user : users) {
    if (mBootCompleted) {
      Account[] accountsForUser=AccountManagerService.getSingleton().getAccounts(user.id);
      mSyncStorageEngine.doDatabaseCleanup(accountsForUser,user.id);
    }
  }
  mAccounts=allAccounts;
  for (  ActiveSyncContext currentSyncContext : mActiveSyncContexts) {
    if (!containsAccountAndUser(allAccounts,currentSyncContext.mSyncOperation.account,currentSyncContext.mSyncOperation.userId)) {
      Log.d(TAG,"canceling sync since the account has been removed");
      sendSyncFinishedOrCanceledMessage(currentSyncContext,null);
    }
  }
  sendCheckAlarmsMessage();
  if (allAccounts.length > 0) {
    boolean onlyThoseWithUnkownSyncableState=justBootedUp;
    scheduleSync(null,UserHandle.USER_ALL,null,null,0,onlyThoseWithUnkownSyncableState);
  }
}
