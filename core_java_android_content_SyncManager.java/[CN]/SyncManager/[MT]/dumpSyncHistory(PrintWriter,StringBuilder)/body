{
  SyncStorageEngine.DayStats dses[]=mSyncStorageEngine.getDayStatistics();
  if (dses != null && dses[0] != null) {
    pw.println();
    pw.println("Sync Statistics");
    pw.print("  Today:  ");
    dumpDayStatistic(pw,dses[0]);
    int today=dses[0].day;
    int i;
    SyncStorageEngine.DayStats ds;
    for (i=1; i <= 6 && i < dses.length; i++) {
      ds=dses[i];
      if (ds == null)       break;
      int delta=today - ds.day;
      if (delta > 6)       break;
      pw.print("  Day-");
      pw.print(delta);
      pw.print(":  ");
      dumpDayStatistic(pw,ds);
    }
    int weekDay=today;
    while (i < dses.length) {
      SyncStorageEngine.DayStats aggr=null;
      weekDay-=7;
      while (i < dses.length) {
        ds=dses[i];
        if (ds == null) {
          i=dses.length;
          break;
        }
        int delta=weekDay - ds.day;
        if (delta > 6)         break;
        i++;
        if (aggr == null) {
          aggr=new SyncStorageEngine.DayStats(weekDay);
        }
        aggr.successCount+=ds.successCount;
        aggr.successTime+=ds.successTime;
        aggr.failureCount+=ds.failureCount;
        aggr.failureTime+=ds.failureTime;
      }
      if (aggr != null) {
        pw.print("  Week-");
        pw.print((today - weekDay) / 7);
        pw.print(": ");
        dumpDayStatistic(pw,aggr);
      }
    }
  }
  ArrayList<SyncStorageEngine.SyncHistoryItem> items=mSyncStorageEngine.getSyncHistory();
  if (items != null && items.size() > 0) {
    pw.println();
    pw.println("Recent Sync History");
    final int N=items.size();
    for (int i=0; i < N; i++) {
      SyncStorageEngine.SyncHistoryItem item=items.get(i);
      SyncStorageEngine.AuthorityInfo authority=mSyncStorageEngine.getAuthority(item.authorityId);
      pw.print("  #");
      pw.print(i + 1);
      pw.print(": ");
      if (authority != null) {
        pw.print(authority.account.name);
        pw.print(":");
        pw.print(authority.account.type);
        pw.print(" ");
        pw.print(authority.authority);
      }
 else {
        pw.print("<no account>");
      }
      Time time=new Time();
      time.set(item.eventTime);
      pw.print(" ");
      pw.print(SyncStorageEngine.SOURCES[item.source]);
      pw.print(" @ ");
      pw.print(formatTime(item.eventTime));
      pw.print(" for ");
      dumpTimeSec(pw,item.elapsedTime);
      pw.println();
      if (item.event != SyncStorageEngine.EVENT_STOP || item.upstreamActivity != 0 || item.downstreamActivity != 0) {
        pw.print("    event=");
        pw.print(item.event);
        pw.print(" upstreamActivity=");
        pw.print(item.upstreamActivity);
        pw.print(" downstreamActivity=");
        pw.println(item.downstreamActivity);
      }
      if (item.mesg != null && !SyncStorageEngine.MESG_SUCCESS.equals(item.mesg)) {
        pw.print("    mesg=");
        pw.println(item.mesg);
      }
    }
  }
}
