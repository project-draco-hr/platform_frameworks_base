{
  ActiveSyncContext activeSyncContext=mActiveSyncContext;
  final long now=SystemClock.elapsedRealtime();
  if (now > activeSyncContext.mTimeoutStartTime + MAX_TIME_PER_SYNC) {
    SyncOperation nextSyncOperation;
synchronized (mSyncQueue) {
      nextSyncOperation=mSyncQueue.head();
    }
    if (nextSyncOperation != null && nextSyncOperation.earliestRunTime <= now) {
      if (Config.LOGD) {
        Log.d(TAG,"canceling and rescheduling sync because it ran too long: " + activeSyncContext.mSyncOperation);
      }
      rescheduleImmediately(activeSyncContext.mSyncOperation);
      sendSyncFinishedOrCanceledMessage(activeSyncContext,null);
    }
 else {
      activeSyncContext.mTimeoutStartTime=now + MAX_TIME_PER_SYNC;
    }
  }
}
