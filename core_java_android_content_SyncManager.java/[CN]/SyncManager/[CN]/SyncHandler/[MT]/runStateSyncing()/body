{
  ActiveSyncContext activeSyncContext=mActiveSyncContext;
  final long now=SystemClock.elapsedRealtime();
  if (now > activeSyncContext.mTimeoutStartTime + MAX_TIME_PER_SYNC) {
    SyncOperation nextSyncOperation;
synchronized (mSyncQueue) {
      nextSyncOperation=getNextReadyToRunSyncOperation(now);
    }
    if (nextSyncOperation != null) {
      Log.d(TAG,"canceling and rescheduling sync because it ran too long: " + activeSyncContext.mSyncOperation);
      scheduleSyncOperation(new SyncOperation(activeSyncContext.mSyncOperation));
      sendSyncFinishedOrCanceledMessage(activeSyncContext,null);
    }
 else {
      activeSyncContext.mTimeoutStartTime=now + MAX_TIME_PER_SYNC;
    }
  }
}
