{
  final int action=event.getAction();
  boolean handled=true;
  if (!mGestureInProgress) {
    if ((action == MotionEvent.ACTION_POINTER_1_DOWN || action == MotionEvent.ACTION_POINTER_2_DOWN) && event.getPointerCount() >= 2) {
      reset();
      mPrevEvent=MotionEvent.obtain(event);
      mTimeDelta=0;
      setContext(event);
      mGestureInProgress=mListener.onScaleBegin(this);
    }
  }
 else {
switch (action) {
case MotionEvent.ACTION_POINTER_1_UP:
case MotionEvent.ACTION_POINTER_2_UP:
      setContext(event);
    int id=(((action & MotionEvent.ACTION_POINTER_ID_MASK) >> MotionEvent.ACTION_POINTER_ID_SHIFT) == 0) ? 1 : 0;
  mFocusX=event.getX(id);
mFocusY=event.getY(id);
mListener.onScaleEnd(this);
mGestureInProgress=false;
reset();
break;
case MotionEvent.ACTION_CANCEL:
mListener.onScaleEnd(this);
mGestureInProgress=false;
reset();
break;
case MotionEvent.ACTION_MOVE:
setContext(event);
if (mCurrPressure / mPrevPressure > PRESSURE_THRESHOLD) {
final boolean updatePrevious=mListener.onScale(this);
if (updatePrevious) {
mPrevEvent.recycle();
mPrevEvent=MotionEvent.obtain(event);
}
}
break;
}
}
return handled;
}
