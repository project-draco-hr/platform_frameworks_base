{
  final boolean enforcedDefault=isPermissionEnforcedDefault(permName);
synchronized (mPackages) {
    Object obj=mSettings.getUserIdLPr(UserHandle.getAppId(uid));
    if (obj != null) {
      GrantedPermissions gp=(GrantedPermissions)obj;
      if (gp.grantedPermissions.contains(permName)) {
        return PackageManager.PERMISSION_GRANTED;
      }
    }
 else {
      HashSet<String> perms=mSystemPermissions.get(uid);
      if (perms != null && perms.contains(permName)) {
        return PackageManager.PERMISSION_GRANTED;
      }
    }
    if (!isPermissionEnforcedLocked(permName,enforcedDefault)) {
      return PackageManager.PERMISSION_GRANTED;
    }
  }
  return PackageManager.PERMISSION_DENIED;
}
