{
  final boolean enforcedDefault=isPermissionEnforcedDefault(permName);
synchronized (mPackages) {
    PackageParser.Package p=mPackages.get(pkgName);
    if (p != null && p.mExtras != null) {
      PackageSetting ps=(PackageSetting)p.mExtras;
      if (ps.sharedUser != null) {
        if (ps.sharedUser.grantedPermissions.contains(permName)) {
          return PackageManager.PERMISSION_GRANTED;
        }
      }
 else       if (ps.grantedPermissions.contains(permName)) {
        return PackageManager.PERMISSION_GRANTED;
      }
    }
    if (!isPermissionEnforcedLocked(permName,enforcedDefault)) {
      return PackageManager.PERMISSION_GRANTED;
    }
  }
  return PackageManager.PERMISSION_DENIED;
}
