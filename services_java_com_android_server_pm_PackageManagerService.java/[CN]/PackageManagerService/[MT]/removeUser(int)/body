{
  enforceSystemOrRoot("Only the system can remove users");
  if (userId == 0 || !sUserManager.exists(userId)) {
    return false;
  }
  cleanUpUser(userId);
  if (sUserManager.removeUser(userId)) {
    Intent addedIntent=new Intent(Intent.ACTION_USER_REMOVED);
    addedIntent.putExtra(Intent.EXTRA_USERID,userId);
    mContext.sendBroadcast(addedIntent,android.Manifest.permission.MANAGE_ACCOUNTS);
  }
  sUserManager.removePackageFolders(userId);
  return true;
}
