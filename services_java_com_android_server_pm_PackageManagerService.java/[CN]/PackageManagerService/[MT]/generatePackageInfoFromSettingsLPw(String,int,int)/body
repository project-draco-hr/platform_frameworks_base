{
  if (!sUserManager.exists(userId))   return null;
  PackageSetting ps=mSettings.mPackages.get(packageName);
  if (ps != null) {
    PackageParser.Package pkg=new PackageParser.Package(packageName);
    if (ps.pkg == null) {
      ps.pkg=new PackageParser.Package(packageName);
      ps.pkg.applicationInfo.packageName=packageName;
      ps.pkg.applicationInfo.flags=ps.pkgFlags;
      ps.pkg.applicationInfo.publicSourceDir=ps.resourcePathString;
      ps.pkg.applicationInfo.sourceDir=ps.codePathString;
      ps.pkg.applicationInfo.dataDir=getDataPathForPackage(ps.pkg.packageName,0).getPath();
      ps.pkg.applicationInfo.nativeLibraryDir=ps.nativeLibraryPathString;
    }
    return generatePackageInfo(ps.pkg,flags,userId);
  }
  return null;
}
