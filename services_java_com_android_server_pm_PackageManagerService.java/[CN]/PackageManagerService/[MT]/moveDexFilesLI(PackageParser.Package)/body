{
  if ((newPackage.applicationInfo.flags & ApplicationInfo.FLAG_HAS_CODE) != 0) {
    final String instructionSet=getAppInstructionSet(newPackage.applicationInfo);
    final String dexCodeInstructionSet=getDexCodeInstructionSet(instructionSet);
    int retCode=mInstaller.movedex(newPackage.mScanPath,newPackage.mPath,dexCodeInstructionSet);
    if (retCode != 0) {
      newPackage.mDexOptNeeded=true;
      mInstaller.rmdex(newPackage.mScanPath,dexCodeInstructionSet);
      mInstaller.rmdex(newPackage.mPath,dexCodeInstructionSet);
    }
  }
  return PackageManager.INSTALL_SUCCEEDED;
}
