{
  int retCode;
  if ((newPackage.applicationInfo.flags & ApplicationInfo.FLAG_HAS_CODE) != 0) {
    retCode=mInstaller.movedex(newPackage.mScanPath,newPackage.mPath);
    if (retCode != 0) {
      if (mNoDexOpt) {
        Slog.i(TAG,"dex file doesn't exist, skipping move: " + newPackage.mPath);
      }
 else {
        Slog.e(TAG,"Couldn't rename dex file: " + newPackage.mPath);
        return PackageManager.INSTALL_FAILED_INSUFFICIENT_STORAGE;
      }
    }
  }
  return PackageManager.INSTALL_SUCCEEDED;
}
