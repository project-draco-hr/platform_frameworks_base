{
  final long lowThreshold;
  final DeviceStorageMonitorInternal dsm=LocalServices.getService(DeviceStorageMonitorInternal.class);
  if (dsm == null) {
    Log.w(TAG,"Couldn't get low memory threshold; no free limit imposed");
    lowThreshold=0L;
  }
 else {
    if (dsm.isMemoryLow()) {
      Log.w(TAG,"Memory is reported as being too low; aborting package install");
      return false;
    }
    lowThreshold=dsm.getMemoryLowThreshold();
  }
  try {
    mContext.grantUriPermission(DEFAULT_CONTAINER_PACKAGE,packageURI,Intent.FLAG_GRANT_READ_URI_PERMISSION);
    return imcs.checkInternalFreeStorage(packageURI,isFwdLocked(),lowThreshold);
  }
  finally {
    mContext.revokeUriPermission(packageURI,Intent.FLAG_GRANT_READ_URI_PERMISSION);
  }
}
