{
  if (status != PackageManager.INSTALL_SUCCEEDED) {
    cleanUp();
    return false;
  }
 else {
    final File oldCodeFile=new File(getCodePath());
    final File oldResourceFile=new File(getResourcePath());
    final String apkName=getNextCodePath(oldCodePath,pkgName,".apk");
    final File newCodeFile=new File(installDir,apkName + ".apk");
    if (!oldCodeFile.renameTo(newCodeFile)) {
      return false;
    }
    codeFileName=newCodeFile.getPath();
    final File newResFile=new File(getResourcePathFromCodePath());
    if (isFwdLocked() && !oldResourceFile.renameTo(newResFile)) {
      return false;
    }
    resourceFileName=getResourcePathFromCodePath();
    if (!setPermissions()) {
      return false;
    }
    if (!SELinux.restorecon(newCodeFile)) {
      return false;
    }
    return true;
  }
}
