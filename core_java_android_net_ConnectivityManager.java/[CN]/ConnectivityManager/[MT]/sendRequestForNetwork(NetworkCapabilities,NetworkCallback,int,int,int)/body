{
  if (networkCallback == null) {
    throw new IllegalArgumentException("null NetworkCallback");
  }
  if (need == null && action != REQUEST) {
    throw new IllegalArgumentException("null NetworkCapabilities");
  }
  try {
    incCallbackHandlerRefCount();
synchronized (sNetworkCallback) {
      if (action == LISTEN) {
        networkCallback.networkRequest=mService.listenForNetwork(need,new Messenger(sCallbackHandler),new Binder());
      }
 else {
        networkCallback.networkRequest=mService.requestNetwork(need,new Messenger(sCallbackHandler),timeoutSec,new Binder(),legacyType);
      }
      if (networkCallback.networkRequest != null) {
        sNetworkCallback.put(networkCallback.networkRequest,networkCallback);
      }
    }
  }
 catch (  RemoteException e) {
    throw e.rethrowFromSystemServer();
  }
  if (networkCallback.networkRequest == null)   decCallbackHandlerRefCount();
  return networkCallback.networkRequest;
}
