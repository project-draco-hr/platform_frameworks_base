{
  BlockingSessionCallback sessionListener=new BlockingSessionCallback(listener);
  if (isHighSpeed) {
    camera.createConstrainedHighSpeedCaptureSession(outputSurfaces,sessionListener,handler);
  }
 else {
    camera.createCaptureSession(outputSurfaces,sessionListener,handler);
  }
  CameraCaptureSession session=sessionListener.waitAndGetSession(SESSION_CONFIGURE_TIMEOUT_MS);
  assertFalse("Camera session should not be a reprocessable session",session.isReprocessable());
  String sessionType=isHighSpeed ? "High Speed" : "Normal";
  assertTrue("Capture session type must be " + sessionType,isHighSpeed == CameraConstrainedHighSpeedCaptureSession.class.isAssignableFrom(session.getClass()));
  return session;
}
