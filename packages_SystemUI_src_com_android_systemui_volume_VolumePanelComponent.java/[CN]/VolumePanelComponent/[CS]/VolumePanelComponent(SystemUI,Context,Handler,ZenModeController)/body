{
  mSysui=sysui;
  mContext=context;
  mHandler=handler;
  mAudioManager=context.getSystemService(AudioManager.class);
  mMediaSessionManager=context.getSystemService(MediaSessionManager.class);
  mVolumeController=new VolumeController();
  mRemoteVolumeController=new RemoteVolumeController();
  mDismissDelay=mContext.getResources().getInteger(R.integer.volume_panel_dismiss_delay);
  mPanel=new VolumePanel(mContext,controller);
  mPanel.setCallback(new VolumePanel.Callback(){
    @Override public void onZenSettings(){
      mHandler.removeCallbacks(mStartZenSettings);
      mHandler.post(mStartZenSettings);
    }
    @Override public void onZenPrioritySettings(){
      mHandler.removeCallbacks(mStartZenPrioritySettings);
      mHandler.post(mStartZenPrioritySettings);
    }
    @Override public void onInteraction(){
      final KeyguardViewMediator kvm=mSysui.getComponent(KeyguardViewMediator.class);
      if (kvm != null) {
        kvm.userActivity();
      }
    }
    @Override public void onVisible(    boolean visible){
      if (mAudioManager != null && mVolumeController != null) {
        mAudioManager.notifyVolumeControllerVisible(mVolumeController,visible);
      }
    }
  }
);
}
