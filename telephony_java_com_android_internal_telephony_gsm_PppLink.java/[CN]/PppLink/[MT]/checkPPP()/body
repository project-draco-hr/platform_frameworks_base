{
  boolean connecting=(dataConnection.getState() == State.CONNECTING);
  try {
    RandomAccessFile file=new RandomAccessFile(PATH_PPP_OPERSTATE,"r");
    file.read(mCheckPPPBuffer);
    file.close();
    if (ArrayUtils.equals(mCheckPPPBuffer,UP_ASCII_STRING,UP_ASCII_STRING.length) || ArrayUtils.equals(mCheckPPPBuffer,UNKNOWN_ASCII_STRING,UNKNOWN_ASCII_STRING.length) && dataConnection.getState() == State.CONNECTING) {
      Log.i(LOG_TAG,"found ppp interface. Notifying GPRS connected");
      if (mLinkChangeRegistrant != null) {
        mLinkChangeRegistrant.notifyResult(LinkState.LINK_UP);
      }
      connecting=false;
    }
 else     if (dataConnection.getState() == State.CONNECTED && ArrayUtils.equals(mCheckPPPBuffer,DOWN_ASCII_STRING,DOWN_ASCII_STRING.length)) {
      Log.i(LOG_TAG,"ppp interface went down. Reconnecting...");
      if (mLinkChangeRegistrant != null) {
        mLinkChangeRegistrant.notifyResult(LinkState.LINK_DOWN);
      }
    }
  }
 catch (  IOException ex) {
    if (!(ex instanceof FileNotFoundException)) {
      Log.i(LOG_TAG,"Poll ppp0 ex " + ex.toString());
    }
    if (dataConnection.getState() == State.CONNECTED && mLinkChangeRegistrant != null) {
      mLinkChangeRegistrant.notifyResult(LinkState.LINK_DOWN);
    }
  }
  if (connecting) {
    String exitCode;
    exitCode=SystemProperties.get(PROPERTY_PPPD_EXIT_CODE,"");
    if (!exitCode.equals("")) {
      lastPppdExitCode=Integer.parseInt(exitCode);
      Log.d(LOG_TAG,"pppd exited with " + exitCode);
      if (mLinkChangeRegistrant != null) {
        mLinkChangeRegistrant.notifyResult(LinkState.LINK_EXITED);
      }
    }
  }
}
