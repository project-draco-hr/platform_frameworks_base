{
  setTheme(R.style.Theme_DeviceDefault_Resolver);
  super.onCreate(savedInstanceState);
  try {
    mLaunchedFromUid=ActivityManagerNative.getDefault().getLaunchedFromUid(getActivityToken());
  }
 catch (  RemoteException e) {
    mLaunchedFromUid=-1;
  }
  mPm=getPackageManager();
  mAlwaysUseOption=alwaysUseOption;
  mMaxColumns=getResources().getInteger(R.integer.config_maxResolverActivityColumns);
  mPackageMonitor.register(this,getMainLooper(),false);
  mRegistered=true;
  final ActivityManager am=(ActivityManager)getSystemService(ACTIVITY_SERVICE);
  mIconDpi=am.getLauncherLargeIconDensity();
  mIconSize=am.getLauncherLargeIconSize();
  mAdapter=new ResolveListAdapter(this,intent,initialIntents,rList,mLaunchedFromUid);
  int count=mAdapter.getCount();
  if (mLaunchedFromUid < 0 || UserHandle.isIsolated(mLaunchedFromUid)) {
    finish();
    return;
  }
 else   if (count > 1) {
    setContentView(R.layout.resolver_list);
    mGridView=(GridView)findViewById(R.id.resolver_list);
    mGridView.setAdapter(mAdapter);
    mGridView.setOnItemClickListener(this);
    mGridView.setOnItemLongClickListener(new ItemLongClickListener());
    if (alwaysUseOption) {
      mGridView.setChoiceMode(ListView.CHOICE_MODE_SINGLE);
    }
    resizeGrid();
  }
 else   if (count == 1) {
    startActivity(mAdapter.intentForPosition(0));
    mPackageMonitor.unregister();
    mRegistered=false;
    finish();
    return;
  }
 else {
    setContentView(R.layout.resolver_list);
    final TextView empty=(TextView)findViewById(R.id.empty);
    empty.setVisibility(View.VISIBLE);
    mGridView=(GridView)findViewById(R.id.resolver_list);
    mGridView.setVisibility(View.GONE);
  }
  final ResolverDrawerLayout rdl=(ResolverDrawerLayout)findViewById(R.id.contentPanel);
  if (rdl != null) {
    rdl.setOnClickOutsideListener(new View.OnClickListener(){
      @Override public void onClick(      View v){
        finish();
      }
    }
);
  }
  final TextView titleView=(TextView)findViewById(R.id.title);
  if (titleView != null) {
    titleView.setText(title);
  }
  if (alwaysUseOption) {
    final ViewGroup buttonLayout=(ViewGroup)findViewById(R.id.button_bar);
    if (buttonLayout != null) {
      buttonLayout.setVisibility(View.VISIBLE);
      mAlwaysButton=(Button)buttonLayout.findViewById(R.id.button_always);
      mOnceButton=(Button)buttonLayout.findViewById(R.id.button_once);
    }
 else {
      mAlwaysUseOption=false;
    }
    final int initialHighlight=mAdapter.getInitialHighlight();
    if (initialHighlight >= 0) {
      mGridView.setItemChecked(initialHighlight,true);
      onItemClick(null,null,initialHighlight,0);
    }
  }
}
