{
  handleDisconnectLocked();
  int deviceFlags=0;
  if ((flags & RemoteDisplay.DISPLAY_FLAG_SECURE) != 0) {
    deviceFlags|=DisplayDeviceInfo.FLAG_SUPPORTS_SECURE_VIDEO_OUTPUT;
  }
  float refreshRate=60.0f;
  String name=display.getDeviceName();
  IBinder displayToken=Surface.createDisplay(name);
  mDisplayDevice=new WifiDisplayDevice(displayToken,name,width,height,refreshRate,deviceFlags,surface);
  sendDisplayDeviceEventLocked(mDisplayDevice,DISPLAY_DEVICE_EVENT_ADDED);
}
