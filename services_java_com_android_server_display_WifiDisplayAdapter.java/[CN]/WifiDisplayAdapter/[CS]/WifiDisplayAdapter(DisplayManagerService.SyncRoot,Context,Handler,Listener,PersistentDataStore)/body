{
  super(syncRoot,context,handler,listener,TAG);
  mHandler=new WifiDisplayHandler(handler.getLooper());
  mPersistentDataStore=persistentDataStore;
  mSupportsProtectedBuffers=context.getResources().getBoolean(com.android.internal.R.bool.config_wifiDisplaySupportsProtectedBuffers);
  mNotificationManager=(NotificationManager)context.getSystemService(Context.NOTIFICATION_SERVICE);
  Intent settingsIntent=new Intent(Settings.ACTION_WIFI_DISPLAY_SETTINGS);
  settingsIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_RESET_TASK_IF_NEEDED | Intent.FLAG_ACTIVITY_CLEAR_TOP);
  mSettingsPendingIntent=PendingIntent.getActivityAsUser(context,0,settingsIntent,0,null,UserHandle.CURRENT);
  Intent disconnectIntent=new Intent(ACTION_DISCONNECT);
  mDisconnectPendingIntent=PendingIntent.getBroadcastAsUser(context,0,disconnectIntent,0,UserHandle.CURRENT);
  context.registerReceiverAsUser(mBroadcastReceiver,UserHandle.ALL,new IntentFilter(ACTION_DISCONNECT),null,mHandler);
}
