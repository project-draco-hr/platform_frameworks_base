{
  CharSequence subtypeName=getSubtypeName(imi,subtype);
  CharSequence imiName=getIMIName(imi);
  Drawable icon=getSubtypeIcon(imi,subtype);
  View view=View.inflate(mContext,R.layout.status_bar_input_methods_item,null);
  ImageView subtypeIcon=(ImageView)view.findViewById(R.id.item_icon);
  TextView itemTitle=(TextView)view.findViewById(R.id.item_title);
  TextView itemSubtitle=(TextView)view.findViewById(R.id.item_subtitle);
  ImageView settingsIcon=(ImageView)view.findViewById(R.id.item_settings_icon);
  View subtypeView=view.findViewById(R.id.item_subtype);
  if (subtypeName == null) {
    itemTitle.setText(imiName);
    itemSubtitle.setVisibility(View.GONE);
  }
 else {
    itemTitle.setText(subtypeName);
    itemSubtitle.setVisibility(View.VISIBLE);
    itemSubtitle.setText(imiName);
  }
  subtypeIcon.setImageDrawable(icon);
  subtypeIcon.setContentDescription(itemTitle.getText());
  final String settingsActivity=imi.getSettingsActivity();
  if (!TextUtils.isEmpty(settingsActivity)) {
    settingsIcon.setOnClickListener(new View.OnClickListener(){
      @Override public void onClick(      View arg0){
        Intent intent=new Intent(Intent.ACTION_MAIN);
        intent.setClassName(imi.getPackageName(),settingsActivity);
        intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_RESET_TASK_IF_NEEDED | Intent.FLAG_ACTIVITY_CLEAR_TOP);
        startActivity(intent);
        closePanel(true);
      }
    }
);
  }
 else {
    view.findViewById(R.id.item_vertical_separator).setVisibility(View.GONE);
    settingsIcon.setVisibility(View.GONE);
  }
  mRadioViewAndImiMap.put(subtypeView,new Pair<InputMethodInfo,InputMethodSubtype>(imi,subtype));
  subtypeView.setOnClickListener(new View.OnClickListener(){
    @Override public void onClick(    View v){
      Pair<InputMethodInfo,InputMethodSubtype> imiAndSubtype=updateRadioButtonsByView(v);
      closePanel(false);
      setInputMethodAndSubtype(imiAndSubtype.first,imiAndSubtype.second);
    }
  }
);
  return view;
}
