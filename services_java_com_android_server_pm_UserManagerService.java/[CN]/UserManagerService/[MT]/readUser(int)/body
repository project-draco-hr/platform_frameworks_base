{
  int flags=0;
  int serialNumber=id;
  String name=null;
  String iconPath=null;
  FileInputStream fis=null;
  try {
    AtomicFile userFile=new AtomicFile(new File(mUsersDir,Integer.toString(id) + ".xml"));
    fis=userFile.openRead();
    XmlPullParser parser=Xml.newPullParser();
    parser.setInput(fis,null);
    int type;
    while ((type=parser.next()) != XmlPullParser.START_TAG && type != XmlPullParser.END_DOCUMENT) {
      ;
    }
    if (type != XmlPullParser.START_TAG) {
      Slog.e(LOG_TAG,"Unable to read user " + id);
      return null;
    }
    if (type == XmlPullParser.START_TAG && parser.getName().equals(TAG_USER)) {
      String storedId=parser.getAttributeValue(null,ATTR_ID);
      if (Integer.parseInt(storedId) != id) {
        Slog.e(LOG_TAG,"User id does not match the file name");
        return null;
      }
      String serialNumberValue=parser.getAttributeValue(null,ATTR_SERIAL_NO);
      if (serialNumberValue != null) {
        serialNumber=Integer.parseInt(serialNumberValue);
      }
      String flagString=parser.getAttributeValue(null,ATTR_FLAGS);
      flags=Integer.parseInt(flagString);
      iconPath=parser.getAttributeValue(null,ATTR_ICON_PATH);
      while ((type=parser.next()) != XmlPullParser.START_TAG && type != XmlPullParser.END_DOCUMENT) {
      }
      if (type == XmlPullParser.START_TAG && parser.getName().equals(TAG_NAME)) {
        type=parser.next();
        if (type == XmlPullParser.TEXT) {
          name=parser.getText();
        }
      }
    }
    UserInfo userInfo=new UserInfo(id,name,iconPath,flags);
    userInfo.serialNumber=serialNumber;
    return userInfo;
  }
 catch (  IOException ioe) {
  }
catch (  XmlPullParserException pe) {
  }
 finally {
    if (fis != null) {
      try {
        fis.close();
      }
 catch (      IOException e) {
      }
    }
  }
  return null;
}
