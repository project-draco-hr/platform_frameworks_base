{
  checkManageUsersPermission("query users");
synchronized (mPackagesLock) {
    ArrayList<UserInfo> users=new ArrayList<UserInfo>(mUsers.size());
    for (int i=0; i < mUsers.size(); i++) {
      if (!excludeDying || !mRemovingUserIds.contains(mUsers.keyAt(i))) {
        users.add(mUsers.valueAt(i));
      }
    }
    return users;
  }
}
