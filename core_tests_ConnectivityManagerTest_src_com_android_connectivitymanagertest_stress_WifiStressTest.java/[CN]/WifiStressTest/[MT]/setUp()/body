{
  super.setUp();
  mAct=getActivity();
  mRunner=(ConnectivityManagerStressTestRunner)getInstrumentation();
  mReconnectIterations=mRunner.mReconnectIterations;
  mSsid=mRunner.mReconnectSsid;
  mPassword=mRunner.mReconnectPassword;
  mScanIterations=mRunner.mScanIterations;
  mWifiSleepTime=mRunner.mSleepTime;
  mWifiOnlyFlag=mRunner.mWifiOnlyFlag;
  log(String.format("mReconnectIterations(%d), mSsid(%s), mPassword(%s)," + "mScanIterations(%d), mWifiSleepTime(%d)",mReconnectIterations,mSsid,mPassword,mScanIterations,mWifiSleepTime));
  mOutputWriter=new BufferedWriter(new FileWriter(new File(Environment.getExternalStorageDirectory(),OUTPUT_FILE),true));
  mAct.turnScreenOn();
  if (mAct.mWifiManager.isWifiApEnabled()) {
    assertTrue(mAct.mWifiManager.setWifiApEnabled(null,false));
    Log.v(TAG,"disable soft ap");
  }
  if (!mAct.mWifiManager.isWifiEnabled()) {
    log("Enable wi-fi before stress tests.");
    if (!mAct.enableWifi()) {
      tearDown();
      fail("enable wifi failed.");
    }
    sleep(ConnectivityManagerTestActivity.SHORT_TIMEOUT,"Interruped while waiting for wifi on");
  }
}
