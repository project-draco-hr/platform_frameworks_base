{
  final SQLiteDatabase database=mDatabase.getSQLiteDatabase();
  database.beginTransaction();
  try {
    final boolean heuristic;
    final String mapColumn;
    Preconditions.checkState(mMappingMode.containsKey(parentDocumentId));
switch (mMappingMode.get(parentDocumentId)) {
case MAP_BY_MTP_IDENTIFIER:
      heuristic=false;
    mapColumn=COLUMN_STORAGE_ID;
  break;
case MAP_BY_NAME:
heuristic=true;
mapColumn=Document.COLUMN_DISPLAY_NAME;
break;
default :
throw new Error("Unexpected map mode.");
}
final ContentValues[] valuesList=new ContentValues[roots.length];
final ContentValues[] extraValuesList=new ContentValues[roots.length];
for (int i=0; i < roots.length; i++) {
valuesList[i]=new ContentValues();
extraValuesList[i]=new ContentValues();
MtpDatabase.getStorageDocumentValues(valuesList[i],extraValuesList[i],resources,parentDocumentId,roots[i]);
}
final boolean changed=putDocuments(valuesList,extraValuesList,COLUMN_PARENT_DOCUMENT_ID + "=?",strings(parentDocumentId),heuristic,mapColumn);
database.setTransactionSuccessful();
return changed;
}
  finally {
database.endTransaction();
}
}
