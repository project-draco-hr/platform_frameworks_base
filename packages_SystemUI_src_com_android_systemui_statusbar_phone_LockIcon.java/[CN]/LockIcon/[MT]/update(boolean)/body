{
  boolean visible=isShown() && KeyguardUpdateMonitor.getInstance(mContext).isDeviceInteractive();
  if (visible) {
    mTrustDrawable.start();
  }
 else {
    mTrustDrawable.stop();
  }
  int state=getState();
  boolean anyFingerprintIcon=state == STATE_FINGERPRINT || state == STATE_FINGERPRINT_ERROR;
  boolean useAdditionalPadding=anyFingerprintIcon;
  boolean trustHidden=anyFingerprintIcon;
  if (state != mLastState || mDeviceInteractive != mLastDeviceInteractive || mScreenOn != mLastScreenOn || force) {
    boolean isAnim=true;
    int iconRes=getAnimationResForTransition(mLastState,state,mLastDeviceInteractive,mDeviceInteractive,mLastScreenOn,mScreenOn);
    if (iconRes == R.drawable.lockscreen_fingerprint_draw_off_animation) {
      anyFingerprintIcon=true;
      useAdditionalPadding=true;
      trustHidden=true;
    }
 else     if (iconRes == R.drawable.trusted_state_to_error_animation) {
      anyFingerprintIcon=true;
      useAdditionalPadding=false;
      trustHidden=true;
    }
 else     if (iconRes == R.drawable.error_to_trustedstate_animation) {
      anyFingerprintIcon=true;
      useAdditionalPadding=false;
      trustHidden=false;
    }
    if (iconRes == -1) {
      iconRes=getIconForState(state,mScreenOn,mDeviceInteractive);
      isAnim=false;
    }
    Drawable icon=mContext.getDrawable(iconRes);
    final AnimatedVectorDrawable animation=icon instanceof AnimatedVectorDrawable ? (AnimatedVectorDrawable)icon : null;
    int iconHeight=getResources().getDimensionPixelSize(R.dimen.keyguard_affordance_icon_height);
    int iconWidth=getResources().getDimensionPixelSize(R.dimen.keyguard_affordance_icon_width);
    if (!anyFingerprintIcon && (icon.getIntrinsicHeight() != iconHeight || icon.getIntrinsicWidth() != iconWidth)) {
      icon=new IntrinsicSizeDrawable(icon,iconWidth,iconHeight);
    }
    setPaddingRelative(0,0,0,useAdditionalPadding ? getResources().getDimensionPixelSize(R.dimen.fingerprint_icon_additional_padding) : 0);
    setRestingAlpha(anyFingerprintIcon ? 1f : KeyguardAffordanceHelper.SWIPE_RESTING_ALPHA_AMOUNT);
    setImageDrawable(icon);
    String contentDescription=getResources().getString(anyFingerprintIcon ? R.string.accessibility_unlock_button_fingerprint : R.string.accessibility_unlock_button);
    setContentDescription(contentDescription);
    mHasFingerPrintIcon=anyFingerprintIcon;
    if (animation != null && isAnim) {
      animation.start();
    }
    mLastState=state;
    mLastDeviceInteractive=mDeviceInteractive;
    mLastScreenOn=mScreenOn;
  }
  boolean trustManaged=mUnlockMethodCache.isTrustManaged() && !trustHidden;
  mTrustDrawable.setTrustManaged(trustManaged);
  updateClickability();
}
