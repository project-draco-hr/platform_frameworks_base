{
  if (HttpLog.LOGV) {
    HttpLog.v("validation error: " + errorMessage);
  }
  if (socket != null) {
    SSLSession session=socket.getSession();
    if (session != null) {
      session.invalidate();
    }
    socket.close();
  }
  throw new SSLHandshakeException(errorMessage);
}
