{
  if (certChain == null || certChain.length == 0) {
    throw new IllegalArgumentException("bad certificate chain");
  }
  X509Certificate[] serverCertificates=new X509Certificate[certChain.length];
  try {
    CertificateFactory cf=CertificateFactory.getInstance("X.509");
    for (int i=0; i < certChain.length; ++i) {
      serverCertificates[i]=(X509Certificate)cf.generateCertificate(new ByteArrayInputStream(certChain[i]));
    }
  }
 catch (  CertificateException e) {
    throw new IOException("can't read certificate",e);
  }
  return verifyServerDomainAndCertificates(serverCertificates,domain,authType);
}
