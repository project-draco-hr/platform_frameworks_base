{
  X509Certificate currCertificate=chain[0];
  if (currCertificate == null) {
    throw new IllegalArgumentException("certificate for this site is null");
  }
  boolean valid=domain != null && !domain.isEmpty() && NoPreloadHolder.sVerifier.verify(domain,new DelegatingSSLSession.CertificateWrap(currCertificate));
  if (!valid) {
    if (HttpLog.LOGV) {
      HttpLog.v("certificate not for this host: " + domain);
    }
    return new SslError(SslError.SSL_IDMISMATCH,currCertificate);
  }
  try {
    getInstance().getTrustManager().checkServerTrusted(chain,authType,new DelegatingSocketWrapper(domain));
    return null;
  }
 catch (  GeneralSecurityException e) {
    if (HttpLog.LOGV) {
      HttpLog.v("failed to validate the certificate chain, error: " + e.getMessage());
    }
    return new SslError(SslError.SSL_UNTRUSTED,currCertificate);
  }
}
