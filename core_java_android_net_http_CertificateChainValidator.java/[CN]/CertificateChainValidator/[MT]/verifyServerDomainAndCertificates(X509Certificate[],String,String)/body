{
  X509Certificate currCertificate=chain[0];
  if (currCertificate == null) {
    throw new IllegalArgumentException("certificate for this site is null");
  }
  boolean valid=domain != null && !domain.isEmpty() && sVerifier.verify(domain,currCertificate);
  if (!valid) {
    if (HttpLog.LOGV) {
      HttpLog.v("certificate not for this host: " + domain);
    }
    return new SslError(SslError.SSL_IDMISMATCH,currCertificate);
  }
  try {
    X509TrustManager x509TrustManager=SSLParametersImpl.getDefaultTrustManager();
    if (x509TrustManager instanceof TrustManagerImpl) {
      TrustManagerImpl trustManager=(TrustManagerImpl)x509TrustManager;
      trustManager.checkServerTrusted(chain,authType,domain);
    }
 else {
      x509TrustManager.checkServerTrusted(chain,authType);
    }
    return null;
  }
 catch (  GeneralSecurityException e) {
    if (HttpLog.LOGV) {
      HttpLog.v("failed to validate the certificate chain, error: " + e.getMessage());
    }
    return new SslError(SslError.SSL_UNTRUSTED,currCertificate);
  }
}
