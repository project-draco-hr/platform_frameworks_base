{
switch (status) {
case GPS_REQUEST_AGPS_DATA_CONN:
    if (DEBUG)     Log.d(TAG,"GPS_REQUEST_AGPS_DATA_CONN");
  Log.v(TAG,"Received SUPL IP addr[]: " + ipaddr);
mAGpsDataConnectionState=AGPS_DATA_CONNECTION_OPENING;
int result=mConnMgr.startUsingNetworkFeature(ConnectivityManager.TYPE_MOBILE,Phone.FEATURE_ENABLE_SUPL);
if (ipaddr != null) {
try {
mAGpsDataConnectionIpAddr=InetAddress.getByAddress(ipaddr);
Log.v(TAG,"IP address converted to: " + mAGpsDataConnectionIpAddr);
}
 catch (UnknownHostException e) {
Log.e(TAG,"Bad IP Address: " + ipaddr,e);
mAGpsDataConnectionIpAddr=null;
}
}
if (result == PhoneConstants.APN_ALREADY_ACTIVE) {
if (DEBUG) Log.d(TAG,"PhoneConstants.APN_ALREADY_ACTIVE");
if (mAGpsApn != null) {
setRouting();
native_agps_data_conn_open(mAGpsApn,mApnIpType);
mAGpsDataConnectionState=AGPS_DATA_CONNECTION_OPEN;
}
 else {
Log.e(TAG,"mAGpsApn not set when receiving PhoneConstants.APN_ALREADY_ACTIVE");
mAGpsDataConnectionState=AGPS_DATA_CONNECTION_CLOSED;
native_agps_data_conn_failed();
}
}
 else if (result == PhoneConstants.APN_REQUEST_STARTED) {
if (DEBUG) Log.d(TAG,"PhoneConstants.APN_REQUEST_STARTED");
}
 else {
if (DEBUG) Log.d(TAG,"startUsingNetworkFeature failed, value is " + result);
mAGpsDataConnectionState=AGPS_DATA_CONNECTION_CLOSED;
native_agps_data_conn_failed();
}
break;
case GPS_RELEASE_AGPS_DATA_CONN:
if (DEBUG) Log.d(TAG,"GPS_RELEASE_AGPS_DATA_CONN");
if (mAGpsDataConnectionState != AGPS_DATA_CONNECTION_CLOSED) {
mConnMgr.stopUsingNetworkFeature(ConnectivityManager.TYPE_MOBILE,Phone.FEATURE_ENABLE_SUPL);
native_agps_data_conn_closed();
mAGpsDataConnectionState=AGPS_DATA_CONNECTION_CLOSED;
mAGpsDataConnectionIpAddr=null;
}
break;
case GPS_AGPS_DATA_CONNECTED:
if (DEBUG) Log.d(TAG,"GPS_AGPS_DATA_CONNECTED");
break;
case GPS_AGPS_DATA_CONN_DONE:
if (DEBUG) Log.d(TAG,"GPS_AGPS_DATA_CONN_DONE");
break;
case GPS_AGPS_DATA_CONN_FAILED:
if (DEBUG) Log.d(TAG,"GPS_AGPS_DATA_CONN_FAILED");
break;
default :
Log.d(TAG,"Received Unknown AGPS status: " + status);
}
}
