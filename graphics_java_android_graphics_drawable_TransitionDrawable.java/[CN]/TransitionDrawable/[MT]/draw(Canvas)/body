{
  boolean done=true;
  final TransitionState state=mState;
switch (mTransitionState) {
case TRANSITION_STARTING:
    mStartTimeMillis=SystemClock.uptimeMillis();
  done=false;
mTransitionState=TRANSITION_RUNNING;
break;
case TRANSITION_RUNNING:
if (mStartTimeMillis >= 0) {
float normalized=(float)(SystemClock.uptimeMillis() - mStartTimeMillis) / mDuration;
done=normalized >= 1.0f;
normalized=Math.min(normalized,1.0f);
state.mAlpha=(int)(mFrom + (mTo - mFrom) * normalized);
}
break;
}
final int alpha=state.mAlpha;
final boolean crossFade=state.mCrossFade;
final Rec[] array=mLayerState.mArray;
Drawable d;
d=array[0].mDrawable;
if (crossFade) {
d.setAlpha(255 - alpha);
}
d.draw(canvas);
if (crossFade) {
d.setAlpha(0xFF);
}
if (alpha > 0) {
d=array[1].mDrawable;
d.setAlpha(alpha);
d.draw(canvas);
d.setAlpha(0xFF);
}
if (!done) {
invalidateSelf();
}
}
