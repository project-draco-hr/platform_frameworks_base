{
  ContentResolver cr=context.getContentResolver();
  ContentValues values=new ContentValues();
  values.put(android.provider.Downloads.Impl.COLUMN_URI,url);
  values.put(android.provider.Downloads.Impl.COLUMN_COOKIE_DATA,cookieData);
  values.put(android.provider.Downloads.Impl.COLUMN_VISIBILITY,showDownload ? android.provider.Downloads.Impl.VISIBILITY_VISIBLE : android.provider.Downloads.Impl.VISIBILITY_HIDDEN);
  if (title != null) {
    values.put(android.provider.Downloads.Impl.COLUMN_TITLE,title);
  }
  values.put(android.provider.Downloads.Impl.COLUMN_APP_DATA,url);
  int destination=android.provider.Downloads.Impl.DESTINATION_EXTERNAL;
switch (downloadDestination) {
case DOWNLOAD_DESTINATION_EXTERNAL:
    destination=android.provider.Downloads.Impl.DESTINATION_EXTERNAL;
  break;
case DOWNLOAD_DESTINATION_CACHE:
if (allowRoaming) {
  destination=android.provider.Downloads.Impl.DESTINATION_CACHE_PARTITION;
}
 else {
  destination=android.provider.Downloads.Impl.DESTINATION_CACHE_PARTITION_NOROAMING;
}
break;
case DOWNLOAD_DESTINATION_CACHE_PURGEABLE:
destination=android.provider.Downloads.Impl.DESTINATION_CACHE_PARTITION_PURGEABLE;
break;
}
values.put(android.provider.Downloads.Impl.COLUMN_DESTINATION,destination);
values.put(android.provider.Downloads.Impl.COLUMN_NO_INTEGRITY,skipIntegrityCheck);
if (notification_package != null && notification_class != null) {
values.put(android.provider.Downloads.Impl.COLUMN_NOTIFICATION_PACKAGE,notification_package);
values.put(android.provider.Downloads.Impl.COLUMN_NOTIFICATION_CLASS,notification_class);
if (notification_extras != null) {
values.put(android.provider.Downloads.Impl.COLUMN_NOTIFICATION_EXTRAS,notification_extras);
}
}
Uri downloadUri=cr.insert(android.provider.Downloads.Impl.CONTENT_URI,values);
long downloadId=DOWNLOAD_ID_INVALID;
if (downloadUri != null) {
downloadId=Long.parseLong(downloadUri.getLastPathSegment());
}
return downloadId;
}
