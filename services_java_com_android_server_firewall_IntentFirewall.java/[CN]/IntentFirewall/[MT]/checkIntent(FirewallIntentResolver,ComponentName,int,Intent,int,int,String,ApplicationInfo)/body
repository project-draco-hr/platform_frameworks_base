{
  List<Rule> matchingRules=resolver.queryIntent(intent,resolvedType,false,0);
  boolean log=false;
  boolean block=false;
  for (int i=0; i < matchingRules.size(); i++) {
    Rule rule=matchingRules.get(i);
    if (rule.matches(this,resolvedComponent,intent,callerUid,callerPid,resolvedType,resolvedApp)) {
      block|=rule.getBlock();
      log|=rule.getLog();
      if (block && log) {
        break;
      }
    }
  }
  if (log) {
    logIntent(intentType,intent,callerUid,resolvedType);
  }
  return !block;
}
