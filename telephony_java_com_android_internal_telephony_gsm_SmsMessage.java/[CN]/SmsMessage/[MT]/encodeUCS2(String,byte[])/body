{
  byte[] userData, textPart;
  textPart=message.getBytes("utf-16be");
  if (header != null) {
    userData=new byte[header.length + textPart.length + 1];
    userData[0]=(byte)header.length;
    System.arraycopy(header,0,userData,1,header.length);
    System.arraycopy(textPart,0,userData,header.length + 1,textPart.length);
  }
 else {
    userData=textPart;
  }
  byte[] ret=new byte[userData.length + 1];
  ret[0]=(byte)(userData.length & 0xff);
  System.arraycopy(userData,0,ret,1,userData.length);
  return ret;
}
