{
  Map<Short,Object> m=new HashMap<Short,Object>();
  while (true) {
    Object o=readObject();
    if (!(o instanceof Short)) {
      throw new DecoderException("Expected short key, got " + o.getClass());
    }
    Short key=(Short)o;
    if (key == SIG_END_MAP) {
      break;
    }
    m.put(key,readObject());
  }
  return m;
}
