{
  if (!metadataFile.exists()) {
    return null;
  }
  FileInputStream in;
  try {
    in=new AtomicFile(metadataFile).openRead();
  }
 catch (  FileNotFoundException fnfe) {
    Slog.i(LOG_TAG,"No ephemeral metadata file");
    return null;
  }
  final File ephemeralDir=metadataFile.getParentFile();
  final long timestamp=metadataFile.lastModified();
  final String packageName=ephemeralDir.getName();
  try {
    XmlPullParser parser=Xml.newPullParser();
    parser.setInput(in,StandardCharsets.UTF_8.name());
    return new UninstalledEphemeralAppState(parseMetadata(parser,packageName),timestamp);
  }
 catch (  XmlPullParserException|IOException e) {
    throw new IllegalStateException("Failed parsing ephemeral" + " metadata file: " + metadataFile,e);
  }
 finally {
    IoUtils.closeQuietly(in);
  }
}
