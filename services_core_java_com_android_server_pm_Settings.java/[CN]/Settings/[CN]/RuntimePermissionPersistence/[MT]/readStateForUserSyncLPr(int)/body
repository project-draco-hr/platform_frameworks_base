{
  File permissionsFile=getUserRuntimePermissionsFile(userId);
  if (!permissionsFile.exists()) {
    return;
  }
  FileInputStream in;
  try {
    in=new FileInputStream(permissionsFile);
  }
 catch (  FileNotFoundException fnfe) {
    Slog.i(PackageManagerService.TAG,"No permissions state");
    return;
  }
  try {
    XmlPullParser parser=Xml.newPullParser();
    parser.setInput(in,null);
    parseRuntimePermissionsLPr(parser,userId);
  }
 catch (  XmlPullParserException|IOException ise) {
    throw new IllegalStateException("Failed parsing permissions file: " + permissionsFile,ise);
  }
 finally {
    IoUtils.closeQuietly(in);
  }
}
