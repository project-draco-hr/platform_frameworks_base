{
  if (mKernelMappingFilename == null)   return;
  final String[] known=mKernelMappingFilename.list();
  final ArraySet<String> knownSet=new ArraySet<>(known.length);
  for (  String name : known) {
    knownSet.add(name);
  }
  for (  final PackageSetting ps : mPackages.values()) {
    knownSet.remove(ps.name);
    writeKernelMappingLPr(ps);
  }
  for (int i=0; i < knownSet.size(); i++) {
    final String name=knownSet.valueAt(i);
    if (DEBUG_KERNEL)     Slog.d(TAG,"Dropping mapping " + name);
    mKernelMapping.remove(name);
    final File dir=new File(mKernelMappingFilename,name);
    FileUtils.deleteContents(dir);
    dir.delete();
  }
}
