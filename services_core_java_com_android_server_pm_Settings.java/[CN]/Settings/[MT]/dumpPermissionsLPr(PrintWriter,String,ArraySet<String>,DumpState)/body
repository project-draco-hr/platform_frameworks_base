{
  boolean printedSomething=false;
  for (  BasePermission p : mPermissions.values()) {
    if (packageName != null && !packageName.equals(p.sourcePackage)) {
      continue;
    }
    if (permissionNames != null && !permissionNames.contains(p.name)) {
      continue;
    }
    if (!printedSomething) {
      if (dumpState.onTitlePrinted())       pw.println();
      pw.println("Permissions:");
      printedSomething=true;
    }
    pw.print("  Permission [");
    pw.print(p.name);
    pw.print("] (");
    pw.print(Integer.toHexString(System.identityHashCode(p)));
    pw.println("):");
    pw.print("    sourcePackage=");
    pw.println(p.sourcePackage);
    pw.print("    uid=");
    pw.print(p.uid);
    pw.print(" gids=");
    pw.print(Arrays.toString(p.computeGids(UserHandle.USER_SYSTEM)));
    pw.print(" type=");
    pw.print(p.type);
    pw.print(" prot=");
    pw.println(PermissionInfo.protectionToString(p.protectionLevel));
    if (p.perm != null) {
      pw.print("    perm=");
      pw.println(p.perm);
      if ((p.perm.info.flags & PermissionInfo.FLAG_INSTALLED) == 0 || (p.perm.info.flags & PermissionInfo.FLAG_HIDDEN) != 0) {
        pw.print("    flags=0x");
        pw.println(Integer.toHexString(p.perm.info.flags));
      }
    }
    if (p.packageSetting != null) {
      pw.print("    packageSetting=");
      pw.println(p.packageSetting);
    }
    if (READ_EXTERNAL_STORAGE.equals(p.name)) {
      pw.print("    enforced=");
      pw.println(mReadExternalStorageEnforced);
    }
  }
}
