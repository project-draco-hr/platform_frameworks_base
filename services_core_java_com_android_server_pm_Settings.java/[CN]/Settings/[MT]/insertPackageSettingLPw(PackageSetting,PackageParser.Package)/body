{
  p.pkg=pkg;
  final String codePath=pkg.applicationInfo.getCodePath();
  final String resourcePath=pkg.applicationInfo.getResourcePath();
  final String legacyNativeLibraryPath=pkg.applicationInfo.nativeLibraryRootDir;
  if (!Objects.equals(codePath,p.codePathString)) {
    Slog.w(PackageManagerService.TAG,"Code path for pkg : " + p.pkg.packageName + " changing from "+ p.codePathString+ " to "+ codePath);
    p.codePath=new File(codePath);
    p.codePathString=codePath;
  }
  if (!Objects.equals(resourcePath,p.resourcePathString)) {
    Slog.w(PackageManagerService.TAG,"Resource path for pkg : " + p.pkg.packageName + " changing from "+ p.resourcePathString+ " to "+ resourcePath);
    p.resourcePath=new File(resourcePath);
    p.resourcePathString=resourcePath;
  }
  if (!Objects.equals(legacyNativeLibraryPath,p.legacyNativeLibraryPathString)) {
    p.legacyNativeLibraryPathString=legacyNativeLibraryPath;
  }
  p.primaryCpuAbiString=pkg.applicationInfo.primaryCpuAbi;
  p.secondaryCpuAbiString=pkg.applicationInfo.secondaryCpuAbi;
  p.cpuAbiOverrideString=pkg.cpuAbiOverride;
  if (pkg.mVersionCode != p.versionCode) {
    p.versionCode=pkg.mVersionCode;
  }
  if (p.signatures.mSignatures == null) {
    p.signatures.assignSignatures(pkg.mSignatures);
  }
  if (pkg.applicationInfo.flags != p.pkgFlags) {
    p.pkgFlags=pkg.applicationInfo.flags;
  }
  if (p.sharedUser != null && p.sharedUser.signatures.mSignatures == null) {
    p.sharedUser.signatures.assignSignatures(pkg.mSignatures);
  }
  addPackageSettingLPw(p,pkg.packageName,p.sharedUser);
}
