{
  if ("0".equals(SystemProperties.get("ro.secure")) && "yes".equals(SystemProperties.get("socket.relaxsslcheck"))) {
    if (mInsecureFactory == null) {
      Log.w(TAG,"*** BYPASSING SSL SECURITY CHECKS (socket.relaxsslcheck=yes) ***");
      mInsecureFactory=makeSocketFactory(INSECURE_TRUST_MANAGER);
    }
    return mInsecureFactory;
  }
 else {
    if (mSecureFactory == null) {
      mSecureFactory=makeSocketFactory(null);
    }
    return mSecureFactory;
  }
}
