{
  if (!(socket instanceof OpenSSLSocketImpl)) {
    throw new IllegalArgumentException("Socket not created by this factory: " + socket);
  }
  return (OpenSSLSocketImpl)socket;
}
