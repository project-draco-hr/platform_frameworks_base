{
  int newlen=ArrayUtils.idealCharArraySize(size + 1);
  char[] newtext=new char[newlen];
  int after=mText.length - (mGapStart + mGapLength);
  System.arraycopy(mText,0,newtext,0,mGapStart);
  System.arraycopy(mText,mText.length - after,newtext,newlen - after,after);
  for (int i=0; i < mSpanCount; i++) {
    if (mSpanStarts[i] > mGapStart)     mSpanStarts[i]+=newlen - mText.length;
    if (mSpanEnds[i] > mGapStart)     mSpanEnds[i]+=newlen - mText.length;
  }
  int oldlen=mText.length;
  mText=newtext;
  mGapLength+=mText.length - oldlen;
  if (mGapLength < 1)   new Exception("mGapLength < 1").printStackTrace();
}
