{
  final int NUM_REFS=128;
  Object objects[]=new Object[NUM_REFS];
  SoftReference<Object> refs[]=new SoftReference[objects.length];
  makeRefs(objects,refs);
  Runtime.getRuntime().gc();
  clearRefs(objects);
  final int NUM_OBJECTS=64 * 1024;
  Object junk[]=new Object[NUM_OBJECTS];
  Random random=new Random();
  int i=0;
  int mod=0;
  int totalSize=0;
  int cleared=-1;
  while (i < junk.length && totalSize < 8 * 1024 * 1024) {
    int r=random.nextInt(64 * 1024) + 128;
    Object o=(Object)new byte[r];
    if (++mod % 16 == 0) {
      junk[i++]=o;
      totalSize+=r * 4;
    }
    cleared=checkRefs(refs,cleared);
  }
}
