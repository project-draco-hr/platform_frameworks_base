{
  if (hasNonOpaqueMask) {
    final Paint p=getMaskingPaint(SRC_OVER);
    canvas.saveLayer(bounds.left,bounds.top,bounds.right,bounds.bottom,p);
  }
  final PorterDuffXfermode mode=hasContentLayer ? SRC_ATOP : SRC_OVER;
  final float x=mHotspotBounds.exactCenterX();
  final float y=mHotspotBounds.exactCenterY();
  canvas.translate(x,y);
  final Paint p=getRipplePaint();
  p.setXfermode(mode);
  final int color=mState.mColor.getColorForState(getState(),Color.BLACK);
  final int alpha=(Color.alpha(color) / 2) << 24;
  p.setColor(color & 0xFFFFFF | alpha);
  final RippleBackground background=mBackground;
  if (background != null && background.shouldDraw()) {
    background.draw(canvas,p);
  }
  final int count=mExitingRipplesCount;
  if (count > 0) {
    final Ripple[] ripples=mExitingRipples;
    for (int i=0; i < count; i++) {
      ripples[i].draw(canvas,p);
    }
  }
  final Ripple active=mRipple;
  if (active != null) {
    active.draw(canvas,p);
  }
  canvas.translate(-x,-y);
  return hasNonOpaqueMask;
}
