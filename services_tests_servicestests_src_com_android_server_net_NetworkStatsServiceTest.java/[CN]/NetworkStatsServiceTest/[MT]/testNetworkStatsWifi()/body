{
  expectCurrentTime();
  expectDefaultSettings();
  expectNetworkState(buildWifiState());
  expectNetworkStatsSummary(buildEmptyStats());
  expectNetworkStatsUidDetail(buildEmptyStats());
  expectNetworkStatsPoll();
  expectBandwidthControlCheck();
  replay();
  mService.forceUpdateIfaces();
  assertNetworkTotal(sTemplateWifi,0L,0L,0L,0L,0);
  verifyAndReset();
  incrementCurrentTime(HOUR_IN_MILLIS);
  expectCurrentTime();
  expectDefaultSettings();
  expectNetworkStatsSummary(new NetworkStats(getElapsedRealtime(),1).addIfaceValues(TEST_IFACE,1024L,1L,2048L,2L));
  expectNetworkStatsUidDetail(buildEmptyStats());
  expectNetworkStatsPoll();
  replay();
  forcePollAndWaitForIdle();
  assertNetworkTotal(sTemplateWifi,1024L,1L,2048L,2L,0);
  verifyAndReset();
  incrementCurrentTime(DAY_IN_MILLIS);
  expectCurrentTime();
  expectDefaultSettings();
  expectNetworkStatsSummary(new NetworkStats(getElapsedRealtime(),1).addIfaceValues(TEST_IFACE,4096L,4L,8192L,8L));
  expectNetworkStatsUidDetail(buildEmptyStats());
  expectNetworkStatsPoll();
  replay();
  forcePollAndWaitForIdle();
  assertNetworkTotal(sTemplateWifi,4096L,4L,8192L,8L,0);
  verifyAndReset();
}
