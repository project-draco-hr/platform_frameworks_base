{
  int count=mSpanCount;
  Object[] spans=mSpans;
  int[] data=mSpanData;
  if (kind == null) {
    kind=Object.class;
  }
  for (int i=0; i < count; i++) {
    int st=data[i * COLUMNS + START];
    int en=data[i * COLUMNS + END];
    if (st > start && st < limit && kind.isInstance(spans[i]))     limit=st;
    if (en > start && en < limit && kind.isInstance(spans[i]))     limit=en;
  }
  return limit;
}
