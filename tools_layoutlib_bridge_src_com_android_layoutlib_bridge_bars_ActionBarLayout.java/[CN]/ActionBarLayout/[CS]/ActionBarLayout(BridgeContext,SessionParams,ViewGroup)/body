{
  mBridgeContext=context;
  ResourceValue layoutName=context.getRenderResources().findItemInTheme(LAYOUT_ATTR_NAME,true);
  if (layoutName != null) {
    layoutName=context.getRenderResources().findResValue(layoutName.getValue(),layoutName.isFramework());
  }
  int layoutId=0;
  String error=null;
  if (layoutName == null) {
    error="Unable to find action bar layout (" + LAYOUT_ATTR_NAME + ") in the current theme.";
  }
 else {
    layoutId=context.getFrameworkResourceValue(layoutName.getResourceType(),layoutName.getName(),0);
    if (layoutId == 0) {
      error=String.format("Unable to resolve attribute \"%s\" of type \"%s\"",layoutName.getName(),layoutName.getResourceType());
    }
  }
  if (layoutId == 0) {
    throw new RuntimeException(error);
  }
  mEnclosingLayout=new RelativeLayout(mBridgeContext);
  setMatchParent(mEnclosingLayout);
  parentView.addView(mEnclosingLayout);
  View decorContent=LayoutInflater.from(context).inflate(layoutId,mEnclosingLayout,true);
  mActionBar=CustomActionBarWrapper.getActionBarWrapper(context,params,decorContent);
  FrameLayout contentRoot=(FrameLayout)mEnclosingLayout.findViewById(android.R.id.content);
  if (contentRoot == null) {
    contentRoot=new FrameLayout(context);
    setMatchParent(contentRoot);
    mEnclosingLayout.addView(contentRoot);
    mContentRoot=contentRoot;
  }
 else {
    mContentRoot=contentRoot;
    mActionBar.setupActionBar();
    mActionBar.inflateMenus();
  }
}
