{
  if (destCM != null) {
    return new BufferedImage(destCM,destCM.createCompatibleWritableRaster(src.getWidth(),src.getHeight()),destCM.isAlphaPremultiplied(),null);
  }
  int nSpaces=conversionSequence.length;
  if (nSpaces < 1) {
    throw new IllegalArgumentException(Messages.getString("awt.261"));
  }
  Object destination=conversionSequence[nSpaces - 1];
  ColorSpace dstCS=(destination instanceof ColorSpace) ? (ColorSpace)destination : new ICC_ColorSpace((ICC_Profile)destination);
  ColorModel srcCM=src.getColorModel();
  ColorModel dstCM=new ComponentColorModel(dstCS,srcCM.hasAlpha(),srcCM.isAlphaPremultiplied(),srcCM.getTransparency(),srcCM.getTransferType());
  return new BufferedImage(dstCM,destCM.createCompatibleWritableRaster(src.getWidth(),src.getHeight()),destCM.isAlphaPremultiplied(),null);
}
