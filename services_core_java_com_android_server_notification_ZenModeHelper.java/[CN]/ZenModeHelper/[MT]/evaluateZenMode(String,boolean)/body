{
  if (DEBUG)   Log.d(TAG,"evaluateZenMode");
  final ArraySet<ZenRule> automaticRules=new ArraySet<ZenRule>();
  final int zen=computeZenMode(automaticRules);
  if (zen == mZenMode)   return false;
  ZenLog.traceSetZenMode(zen,reason);
  mZenMode=zen;
  updateRingerModeAffectedStreams();
  setZenModeSetting(mZenMode);
  if (setRingerMode) {
    applyZenToRingerMode();
  }
  applyRestrictions();
  mHandler.postDispatchOnZenModeChanged();
  return true;
}
