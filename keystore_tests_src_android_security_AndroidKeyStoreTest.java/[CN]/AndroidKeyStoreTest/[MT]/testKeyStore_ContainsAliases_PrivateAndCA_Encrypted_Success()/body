{
  setupPassword();
  mKeyStore.load(null,null);
  assertAliases(new String[]{});
  assertTrue(mAndroidKeyStore.generate(Credentials.USER_PRIVATE_KEY + TEST_ALIAS_1,KeyStore.UID_SELF,NativeCrypto.EVP_PKEY_RSA,1024,KeyStore.FLAG_ENCRYPTED,null));
  assertTrue("Should contain generated private key",mKeyStore.containsAlias(TEST_ALIAS_1));
  assertTrue(mAndroidKeyStore.put(Credentials.CA_CERTIFICATE + TEST_ALIAS_2,FAKE_RSA_CA_1,KeyStore.UID_SELF,KeyStore.FLAG_ENCRYPTED));
  assertTrue("Should contain added CA certificate",mKeyStore.containsAlias(TEST_ALIAS_2));
  assertFalse("Should not contain unadded certificate alias",mKeyStore.containsAlias(TEST_ALIAS_3));
}
