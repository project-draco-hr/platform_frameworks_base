{
  setupPassword();
  mKeyStore.load(null,null);
  assertTrue(mAndroidKeyStore.put(Credentials.CA_CERTIFICATE + TEST_ALIAS_1,FAKE_CA_1,KeyStore.UID_SELF,KeyStore.FLAG_ENCRYPTED));
  assertAliases(new String[]{TEST_ALIAS_1});
  assertNull("Certificate should not exist in keystore",mKeyStore.getCertificate(TEST_ALIAS_2));
  Certificate retrieved=mKeyStore.getCertificate(TEST_ALIAS_1);
  assertNotNull("Retrieved certificate should not be null",retrieved);
  CertificateFactory f=CertificateFactory.getInstance("X.509");
  Certificate actual=f.generateCertificate(new ByteArrayInputStream(FAKE_CA_1));
  assertEquals("Actual and retrieved certificates should be the same",actual,retrieved);
}
