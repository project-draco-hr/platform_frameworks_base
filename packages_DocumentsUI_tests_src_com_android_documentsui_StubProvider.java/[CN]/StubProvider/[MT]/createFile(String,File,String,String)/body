{
  StubDocument parentDoc=null;
  if (parent == null) {
    parentDoc=mRoots.get(rootId).rootDocument;
  }
 else {
    parentDoc=mStorage.get(getDocumentIdForFile(parent));
    if (parentDoc == null) {
      throw new IllegalArgumentException("Parent file not found.");
    }
    if (!Document.MIME_TYPE_DIR.equals(parentDoc.mimeType)) {
      throw new IllegalArgumentException("Parent file must be a directory.");
    }
  }
  File file=new File(parentDoc.file,name);
  if (Document.MIME_TYPE_DIR.equals(mimeType)) {
    file.mkdir();
  }
 else {
    file.createNewFile();
  }
  new StubDocument(file,mimeType,parentDoc);
  return file;
}
