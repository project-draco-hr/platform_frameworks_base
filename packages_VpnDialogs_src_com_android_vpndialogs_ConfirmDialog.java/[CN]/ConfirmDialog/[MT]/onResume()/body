{
  super.onResume();
  try {
    mPackageName=getCallingPackage();
    mService=(ConnectivityManager)getSystemService(Context.CONNECTIVITY_SERVICE);
    if (mPackageName.equals(mService.prepareVpn(null))) {
      setResult(RESULT_OK);
      finish();
      return;
    }
    PackageManager pm=getPackageManager();
    ApplicationInfo app=pm.getApplicationInfo(mPackageName,0);
    View view=View.inflate(this,R.layout.confirm,null);
    ((ImageView)view.findViewById(R.id.icon)).setImageDrawable(app.loadIcon(pm));
    ((TextView)view.findViewById(R.id.prompt)).setText(getString(R.string.prompt,app.loadLabel(pm)));
    ((CompoundButton)view.findViewById(R.id.check)).setOnCheckedChangeListener(this);
    mDialog=new AlertDialog.Builder(this).setIcon(android.R.drawable.ic_dialog_alert).setTitle(android.R.string.dialog_alert_title).setView(view).setPositiveButton(android.R.string.ok,this).setNegativeButton(android.R.string.cancel,this).setCancelable(false).create();
    mDialog.setOnDismissListener(this);
    mDialog.show();
    mButton=mDialog.getButton(DialogInterface.BUTTON_POSITIVE);
    mButton.setEnabled(false);
  }
 catch (  Exception e) {
    Log.e(TAG,"onResume",e);
    finish();
  }
}
