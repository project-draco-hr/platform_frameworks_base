{
synchronized (sFileXfer) {
    File path=makeFilePath(context,fname);
    BatteryStats stats=sFileXfer.get(path);
    if (stats != null) {
      return stats;
    }
    FileInputStream fin=null;
    try {
      fin=new FileInputStream(path);
      byte[] data=readFully(fin);
      Parcel parcel=Parcel.obtain();
      parcel.unmarshall(data,0,data.length);
      parcel.setDataPosition(0);
      return com.android.internal.os.BatteryStatsImpl.CREATOR.createFromParcel(parcel);
    }
 catch (    IOException e) {
      Log.w(TAG,"Unable to read history to file",e);
    }
 finally {
      if (fin != null) {
        try {
          fin.close();
        }
 catch (        IOException e) {
        }
      }
    }
  }
  return getStats(IBatteryStats.Stub.asInterface(ServiceManager.getService(BatteryStats.SERVICE_NAME)));
}
