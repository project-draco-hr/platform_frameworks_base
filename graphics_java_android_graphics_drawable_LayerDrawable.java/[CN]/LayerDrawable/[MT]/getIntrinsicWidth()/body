{
  int width=-1;
  int padL=0;
  int padR=0;
  final boolean nest=mLayerState.mPaddingMode == PADDING_MODE_NEST;
  final ChildDrawable[] array=mLayerState.mChildren;
  final int N=mLayerState.mNum;
  for (int i=0; i < N; i++) {
    final ChildDrawable r=array[i];
    if (r.mDrawable == null) {
      continue;
    }
    final int insetL, insetR;
    final int layoutDirection=getLayoutDirection();
    if (layoutDirection == LayoutDirection.RTL) {
      insetL=r.mInsetE == UNDEFINED_INSET ? r.mInsetL : r.mInsetE;
      insetR=r.mInsetS == UNDEFINED_INSET ? r.mInsetR : r.mInsetS;
    }
 else {
      insetL=r.mInsetS == UNDEFINED_INSET ? r.mInsetL : r.mInsetS;
      insetR=r.mInsetE == UNDEFINED_INSET ? r.mInsetR : r.mInsetE;
    }
    final int minWidth=r.mWidth < 0 ? r.mDrawable.getIntrinsicWidth() : r.mWidth;
    final int w=minWidth + insetL + insetR+ padL+ padR;
    if (w > width) {
      width=w;
    }
    if (nest) {
      padL+=mPaddingL[i];
      padR+=mPaddingR[i];
    }
  }
  return width;
}
