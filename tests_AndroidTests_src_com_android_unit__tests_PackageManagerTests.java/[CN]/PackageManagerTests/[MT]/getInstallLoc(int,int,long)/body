{
  if ((flags & PackageManager.INSTALL_FORWARD_LOCK) != 0) {
    return INSTALL_LOC_INT;
  }
 else   if ((flags & PackageManager.INSTALL_EXTERNAL) != 0) {
    return INSTALL_LOC_SD;
  }
 else   if ((flags & PackageManager.INSTALL_INTERNAL) != 0) {
    return INSTALL_LOC_INT;
  }
  if (expInstallLocation == PackageInfo.INSTALL_LOCATION_PREFER_EXTERNAL) {
    if (checkSd(pkgLen)) {
      return INSTALL_LOC_SD;
    }
    if (checkInt(pkgLen)) {
      return INSTALL_LOC_INT;
    }
    return INSTALL_LOC_ERR;
  }
  if (expInstallLocation == PackageInfo.INSTALL_LOCATION_INTERNAL_ONLY) {
    if (checkInt(pkgLen)) {
      return INSTALL_LOC_INT;
    }
    return INSTALL_LOC_ERR;
  }
  if (expInstallLocation == PackageInfo.INSTALL_LOCATION_AUTO) {
    if (checkInt(pkgLen)) {
      return INSTALL_LOC_INT;
    }
    if (checkSd(pkgLen)) {
      return INSTALL_LOC_SD;
    }
    return INSTALL_LOC_ERR;
  }
  boolean checkSd=false;
  int setLoc=0;
  try {
    setLoc=Settings.System.getInt(mContext.getContentResolver(),Settings.System.SET_INSTALL_LOCATION);
  }
 catch (  SettingNotFoundException e) {
    failStr(e);
  }
  if (setLoc == 1) {
    int userPref=APP_INSTALL_AUTO;
    try {
      userPref=Settings.System.getInt(mContext.getContentResolver(),Settings.System.DEFAULT_INSTALL_LOCATION);
    }
 catch (    SettingNotFoundException e) {
      failStr(e);
    }
    if (userPref == APP_INSTALL_DEVICE) {
      if (checkInt(pkgLen)) {
        return INSTALL_LOC_INT;
      }
      return INSTALL_LOC_ERR;
    }
 else     if (userPref == APP_INSTALL_SDCARD) {
      if (checkSd(pkgLen)) {
        return INSTALL_LOC_SD;
      }
      return INSTALL_LOC_ERR;
    }
 else     if (userPref == APP_INSTALL_AUTO) {
      if (checkInt(pkgLen)) {
        return INSTALL_LOC_INT;
      }
      if (checkSd(pkgLen)) {
        return INSTALL_LOC_SD;
      }
      return INSTALL_LOC_ERR;
    }
  }
  return INSTALL_LOC_ERR;
}
