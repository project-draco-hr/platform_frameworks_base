{
  InstallParams ip=installFromRawResource(flags,false);
  boolean result=((flags & PackageManager.INSTALL_REPLACE_EXISTING) != 0);
  GenericReceiver receiver;
  if (result) {
    receiver=new ReplaceReceiver(ip.pkg.packageName);
  }
 else {
    receiver=new InstallReceiver(ip.pkg.packageName);
  }
  try {
    try {
      assertEquals(invokeInstallPackage(ip.packageURI,flags,ip.pkg.packageName,receiver),result);
      if (result) {
        assertInstall(ip.pkg.packageName,flags);
      }
    }
 catch (    Exception e) {
      failStr("Failed with exception : " + e);
    }
  }
  finally {
    getPm().deletePackage(ip.pkg.packageName,null,0);
    File outFile=new File(ip.outFileName);
    if (outFile != null && outFile.exists()) {
      outFile.delete();
    }
  }
}
