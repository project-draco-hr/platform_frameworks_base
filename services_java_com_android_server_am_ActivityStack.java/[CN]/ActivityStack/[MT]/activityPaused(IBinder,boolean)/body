{
  if (DEBUG_PAUSE)   Slog.v(TAG,"Activity paused: token=" + token + ", timeout="+ timeout);
  ActivityRecord r=null;
synchronized (mService) {
    int index=indexOfTokenLocked(token);
    if (index >= 0) {
      r=mHistory.get(index);
      mHandler.removeMessages(PAUSE_TIMEOUT_MSG,r);
      if (mPausingActivities.contains(r)) {
        if (DEBUG_STATES)         Slog.v(TAG,"Moving to PAUSED: " + r + (timeout ? " (due to timeout)" : " (pause complete)"));
        r.state=ActivityState.PAUSED;
        completePauseLocked(r);
      }
 else {
        ActivityRecord old=mPausingActivities.size() > 0 ? mPausingActivities.get(0) : null;
        EventLog.writeEvent(EventLogTags.AM_FAILED_TO_PAUSE,System.identityHashCode(r),r.shortComponentName,old != null ? old.shortComponentName : "(none)");
      }
    }
  }
}
