{
  mHandler.removeMessages(SLEEP_TIMEOUT_MSG);
  mSleepTimeout=false;
  if (mGoingToSleep.isHeld()) {
    mGoingToSleep.release();
  }
  for (int taskNdx=mTaskHistory.size() - 1; taskNdx >= 0; --taskNdx) {
    final ArrayList<ActivityRecord> activities=mTaskHistory.get(taskNdx).mActivities;
    for (int activityNdx=activities.size() - 1; activityNdx >= 0; --activityNdx) {
      activities.get(activityNdx).setSleeping(false);
    }
  }
  mGoingToSleepActivities.clear();
}
