{
  if (localLOGV)   Slog.v(TAG,"Activity idle: " + token);
  ActivityRecord res=null;
  ArrayList<ActivityRecord> stops=null;
  ArrayList<ActivityRecord> finishes=null;
  ArrayList<UserStartedState> startingUsers=null;
  int NS=0;
  int NF=0;
  IApplicationThread sendThumbnail=null;
  boolean booting=false;
  boolean enableScreen=false;
  boolean activityRemoved=false;
  res=isInStackLocked(token);
  if (res != null) {
    if (mResumedActivity == res && mLaunchingActivity.isHeld()) {
      mHandler.removeMessages(LAUNCH_TIMEOUT_MSG);
      mLaunchingActivity.release();
    }
    if (DEBUG_VISBILITY)     Slog.v(TAG,"Idle activity for " + res);
    mStackSupervisor.ensureActivitiesVisibleLocked(null,0);
  }
  return res;
}
