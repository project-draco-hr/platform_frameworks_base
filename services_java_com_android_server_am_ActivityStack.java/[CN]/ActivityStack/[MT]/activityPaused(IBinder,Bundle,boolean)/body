{
  if (DEBUG_PAUSE)   Slog.v(TAG,"Activity paused: token=" + token + ", icicle="+ icicle+ ", timeout="+ timeout);
  ActivityRecord r=null;
synchronized (mService) {
    int index=indexOfTokenLocked(token);
    if (index >= 0) {
      r=(ActivityRecord)mHistory.get(index);
      if (!timeout) {
        r.icicle=icicle;
        r.haveState=true;
      }
      mHandler.removeMessages(PAUSE_TIMEOUT_MSG,r);
      if (mPausingActivity == r) {
        r.state=ActivityState.PAUSED;
        completePauseLocked();
      }
 else {
        EventLog.writeEvent(EventLogTags.AM_FAILED_TO_PAUSE,System.identityHashCode(r),r.shortComponentName,mPausingActivity != null ? mPausingActivity.shortComponentName : "(none)");
      }
    }
  }
}
