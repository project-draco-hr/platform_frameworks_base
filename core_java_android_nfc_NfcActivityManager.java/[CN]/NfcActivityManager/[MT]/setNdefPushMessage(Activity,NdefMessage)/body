{
  NfcActivityState state=getOrCreateState(activity,message != null);
  if (state == null || state.ndefMessage == message) {
    return;
  }
  state.ndefMessage=message;
  if (message == null) {
    maybeRemoveState(activity,state);
  }
  if (state.resumed) {
    updateNfcService(state);
  }
}
