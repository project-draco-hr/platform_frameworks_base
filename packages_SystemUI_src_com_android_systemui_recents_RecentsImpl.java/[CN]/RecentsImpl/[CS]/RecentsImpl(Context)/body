{
  mContext=context;
  mHandler=new Handler();
  mAppWidgetHost=new RecentsAppWidgetHost(mContext,RecentsAppWidgetHost.HOST_ID);
  ForegroundThread.get();
  mTaskStackListener=new TaskStackListenerImpl(mHandler);
  SystemServicesProxy ssp=Recents.getSystemServices();
  ssp.registerTaskStackListener(mTaskStackListener);
  reloadHeaderBarLayout();
  updateHeaderBarLayout(true,null);
  RecentsTaskLoader loader=Recents.getTaskLoader();
  RecentsTaskLoadPlan plan=loader.createLoadPlan(mContext);
  loader.preloadTasks(plan,-1,true);
  RecentsTaskLoadPlan.Options launchOpts=new RecentsTaskLoadPlan.Options();
  launchOpts.numVisibleTasks=loader.getIconCacheSize();
  launchOpts.numVisibleTaskThumbnails=loader.getThumbnailCacheSize();
  launchOpts.onlyLoadForCache=true;
  loader.loadTasks(mContext,plan,launchOpts);
  UiModeManager uiModeManager=(UiModeManager)mContext.getSystemService(Context.UI_MODE_SERVICE);
  if (uiModeManager.getCurrentModeType() == Configuration.UI_MODE_TYPE_TELEVISION) {
    mRecentsIntentActivityName=RECENTS_TV_ACTIVITY;
    mIsRunningOnTv=true;
  }
 else {
    mRecentsIntentActivityName=RECENTS_ACTIVITY;
    mIsRunningOnTv=false;
  }
}
