{
  RecentsConfiguration config=Recents.getConfiguration();
  SystemServicesProxy ssp=Recents.getSystemServices();
  Rect systemInsets=new Rect();
  ssp.getStableInsets(systemInsets);
  Rect windowRect=ssp.getWindowRect();
  calculateWindowStableInsets(systemInsets,windowRect);
  windowRect.offsetTo(0,0);
  config.update(systemInsets);
  if (RecentsDebugFlags.Static.EnableSearchBar && tryAndBindSearchWidget) {
    if (ssp.getOrBindSearchAppWidget(mContext,mAppWidgetHost) != null) {
      config.getSearchBarBounds(windowRect,mStatusBarHeight,mSearchBarBounds);
    }
  }
  config.getTaskStackBounds(windowRect,systemInsets.top,systemInsets.right,mSearchBarBounds,mTaskStackBounds);
  TaskStackLayoutAlgorithm stackLayout=mDummyStackView.getStackAlgorithm();
  Rect taskStackBounds=new Rect(mTaskStackBounds);
  stackLayout.setSystemInsets(systemInsets);
  if (stack != null) {
    stackLayout.initialize(taskStackBounds,TaskStackLayoutAlgorithm.StackState.getStackStateForStack(stack));
    mDummyStackView.setTasks(stack,false,false);
  }
  Rect taskViewBounds=stackLayout.getUntransformedTaskViewBounds();
  if (!taskViewBounds.equals(mLastTaskViewBounds)) {
    mLastTaskViewBounds.set(taskViewBounds);
    int taskViewWidth=taskViewBounds.width();
synchronized (mHeaderBarLock) {
      mHeaderBar.measure(View.MeasureSpec.makeMeasureSpec(taskViewWidth,View.MeasureSpec.EXACTLY),View.MeasureSpec.makeMeasureSpec(mTaskBarHeight,View.MeasureSpec.EXACTLY));
      mHeaderBar.layout(0,0,taskViewWidth,mTaskBarHeight);
    }
  }
}
