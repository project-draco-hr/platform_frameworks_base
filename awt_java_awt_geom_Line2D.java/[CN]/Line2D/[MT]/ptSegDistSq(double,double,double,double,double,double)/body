{
  x2-=x1;
  y2-=y1;
  px-=x1;
  py-=y1;
  double dist;
  if (px * x2 + py * y2 <= 0.0) {
    dist=px * px + py * py;
  }
 else {
    px=x2 - px;
    py=y2 - py;
    if (px * x2 + py * y2 <= 0.0) {
      dist=px * px + py * py;
    }
 else {
      dist=px * y2 - py * x2;
      dist=dist * dist / (x2 * x2 + y2 * y2);
    }
  }
  if (dist < 0) {
    dist=0;
  }
  return dist;
}
