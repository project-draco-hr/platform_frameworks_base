{
  if (DEBUG) {
    Slog.d(TAG,"prepare: mode=" + mode);
  }
  mMode=mode;
  DisplayInfo displayInfo=mDisplayManager.getDisplayInfo(Display.DEFAULT_DISPLAY);
  mDisplayLayerStack=displayInfo.layerStack;
  mDisplayWidth=displayInfo.getNaturalWidth();
  mDisplayHeight=displayInfo.getNaturalHeight();
  if (!tryPrepare()) {
    dismiss();
    return false;
  }
  mPrepared=true;
  if (mode == MODE_COOL_DOWN) {
    for (int i=0; i < DEJANK_FRAMES; i++) {
      draw(1.0f);
    }
  }
  return true;
}
