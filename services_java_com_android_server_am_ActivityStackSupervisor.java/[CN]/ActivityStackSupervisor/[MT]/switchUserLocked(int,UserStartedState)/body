{
  mUserStates.put(mCurrentUser,new UserState());
  mCurrentUser=userId;
  UserState userState=mUserStates.get(userId);
  if (userState != null) {
    userState.restore();
    mUserStates.delete(userId);
  }
 else {
    mFocusedStack=null;
    if (DEBUG_STACK)     Slog.d(TAG,"switchUserLocked: mStackState=" + stackStateToString(STACK_STATE_HOME_IN_FRONT));
    mStackState=STACK_STATE_HOME_IN_FRONT;
  }
  mStartingUsers.add(uss);
  boolean haveActivities=mHomeStack.switchUserLocked(userId);
  resumeTopActivitiesLocked();
  return haveActivities;
}
