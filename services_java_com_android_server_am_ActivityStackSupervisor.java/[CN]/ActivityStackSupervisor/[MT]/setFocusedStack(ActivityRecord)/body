{
  if (r == null) {
    return;
  }
  if (!r.isApplicationActivity() || (r.task != null && !r.task.isApplicationTask())) {
    if (mStackState != STACK_STATE_HOME_IN_FRONT) {
      if (DEBUG_STACK || DEBUG_FOCUS)       Slog.d(TAG,"setFocusedStack: mStackState old=" + stackStateToString(mStackState) + " new="+ stackStateToString(STACK_STATE_HOME_TO_FRONT)+ " Callers="+ Debug.getCallers(3));
      mStackState=STACK_STATE_HOME_TO_FRONT;
    }
  }
 else {
    if (DEBUG_FOCUS || DEBUG_STACK)     Slog.d(TAG,"setFocusedStack: Setting focused stack to r=" + r + " task="+ r.task+ " Callers="+ Debug.getCallers(3));
    final ActivityStack taskStack=r.task.stack;
    mFocusedStack=taskStack.isHomeStack() ? null : taskStack;
    if (mStackState != STACK_STATE_HOME_IN_BACK) {
      if (DEBUG_STACK)       Slog.d(TAG,"setFocusedStack: mStackState old=" + stackStateToString(mStackState) + " new="+ stackStateToString(STACK_STATE_HOME_TO_BACK)+ " Callers="+ Debug.getCallers(3));
      mStackState=STACK_STATE_HOME_TO_BACK;
    }
  }
}
