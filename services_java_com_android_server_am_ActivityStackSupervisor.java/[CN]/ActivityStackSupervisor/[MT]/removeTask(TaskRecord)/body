{
  final ActivityStack stack=task.stack;
  if (stack.removeTask(task) && !stack.isHomeStack()) {
    mStacks.remove(stack);
    final int stackId=stack.mStackId;
    final int nextStackId=mService.mWindowManager.removeStack(stackId);
    if (mMainStack.mStackId == stackId) {
      mMainStack=nextStackId == HOME_STACK_ID ? null : getStack(nextStackId);
    }
  }
}
