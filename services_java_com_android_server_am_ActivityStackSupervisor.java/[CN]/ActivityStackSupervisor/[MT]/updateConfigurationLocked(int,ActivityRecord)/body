{
  boolean kept=true;
  final int numStacks=mStacks.size();
  for (int stackNdx=0; stackNdx < numStacks; ++stackNdx) {
    final ActivityStack stack=mStacks.get(stackNdx);
    if (changes != 0 && starting == null) {
      starting=stack.topRunningActivityLocked(null);
    }
    if (starting != null) {
      if (!stack.ensureActivityConfigurationLocked(starting,changes)) {
        kept=false;
      }
      stack.ensureActivitiesVisibleLocked(starting,changes);
    }
  }
  return kept;
}
