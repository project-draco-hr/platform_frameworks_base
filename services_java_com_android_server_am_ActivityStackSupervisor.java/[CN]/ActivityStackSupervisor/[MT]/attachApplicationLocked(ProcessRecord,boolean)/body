{
  boolean didSomething=false;
  final String processName=app.processName;
  for (int stackNdx=mStacks.size() - 1; stackNdx >= 0; --stackNdx) {
    final ActivityStack stack=mStacks.get(stackNdx);
    ActivityRecord hr=stack.topRunningActivityLocked(null);
    if (hr != null) {
      if (hr.app == null && app.uid == hr.info.applicationInfo.uid && processName.equals(hr.processName)) {
        try {
          if (headless) {
            Slog.e(TAG,"Starting activities not supported on headless device: " + hr);
          }
 else           if (realStartActivityLocked(hr,app,true,true)) {
            didSomething=true;
          }
        }
 catch (        Exception e) {
          Slog.w(TAG,"Exception in new application when starting activity " + hr.intent.getComponent().flattenToShortString(),e);
          throw e;
        }
      }
 else {
        stack.ensureActivitiesVisibleLocked(hr,null,processName,0);
      }
    }
  }
  return didSomething;
}
