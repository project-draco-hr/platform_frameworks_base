{
  float elevation=0;
  final boolean wasAdjustedForStack=mElevationAdjustedForStack;
  if (ActivityManager.StackId.hasWindowShadow(mStackId) && mBackdropFrameRenderer == null) {
    elevation=hasWindowFocus() ? DECOR_SHADOW_FOCUSED_HEIGHT_IN_DIP : DECOR_SHADOW_UNFOCUSED_HEIGHT_IN_DIP;
    if (!mAllowUpdateElevation) {
      elevation=DECOR_SHADOW_FOCUSED_HEIGHT_IN_DIP;
    }
    elevation=dipToPx(elevation);
    mElevationAdjustedForStack=true;
  }
 else {
    mElevationAdjustedForStack=false;
  }
  if ((wasAdjustedForStack || mElevationAdjustedForStack) && getElevation() != elevation) {
    mWindow.setElevation(elevation);
  }
}
