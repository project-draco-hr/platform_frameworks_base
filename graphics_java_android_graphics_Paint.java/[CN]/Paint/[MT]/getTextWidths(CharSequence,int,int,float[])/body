{
  if (text == null || text.length() == 0 || start == end) {
    return 0;
  }
  if (text instanceof String) {
    return getTextWidths((String)text,start,end,widths);
  }
  if (text instanceof SpannedString || text instanceof SpannableString) {
    return getTextWidths(text.toString(),start,end,widths);
  }
  if (text instanceof GraphicsOperations) {
    return ((GraphicsOperations)text).getTextWidths(start,end,widths,this);
  }
  char[] buf=TemporaryBuffer.obtain(end - start);
  TextUtils.getChars(text,start,end,buf,0);
  int result=getTextWidths(buf,0,end - start,widths);
  TemporaryBuffer.recycle(buf);
  return result;
}
