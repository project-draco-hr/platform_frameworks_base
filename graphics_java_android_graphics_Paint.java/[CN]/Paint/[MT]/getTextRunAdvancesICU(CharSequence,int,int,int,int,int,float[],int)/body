{
  if (text instanceof String) {
    return getTextRunAdvancesICU((String)text,start,end,contextStart,contextEnd,flags,advances,advancesIndex);
  }
  if (text instanceof SpannedString || text instanceof SpannableString) {
    return getTextRunAdvancesICU(text.toString(),start,end,contextStart,contextEnd,flags,advances,advancesIndex);
  }
  if (text instanceof GraphicsOperations) {
    return ((GraphicsOperations)text).getTextRunAdvancesICU(start,end,contextStart,contextEnd,flags,advances,advancesIndex,this);
  }
  int contextLen=contextEnd - contextStart;
  int len=end - start;
  char[] buf=TemporaryBuffer.obtain(contextLen);
  TextUtils.getChars(text,start,end,buf,0);
  float result=getTextRunAdvancesICU(buf,start - contextStart,len,0,contextLen,flags,advances,advancesIndex);
  TemporaryBuffer.recycle(buf);
  return result;
}
