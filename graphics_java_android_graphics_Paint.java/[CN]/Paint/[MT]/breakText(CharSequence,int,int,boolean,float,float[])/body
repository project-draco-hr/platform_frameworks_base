{
  if (text == null) {
    throw new IllegalArgumentException("text cannot be null");
  }
  if ((start | end | (end - start)| (text.length() - end)) < 0) {
    throw new IndexOutOfBoundsException();
  }
  if (text.length() == 0 || start == end) {
    return 0;
  }
  if (start == 0 && text instanceof String && end == text.length()) {
    return breakText((String)text,measureForwards,maxWidth,measuredWidth);
  }
  char[] buf=TemporaryBuffer.obtain(end - start);
  int result;
  TextUtils.getChars(text,start,end,buf,0);
  if (measureForwards) {
    result=breakText(buf,0,end - start,maxWidth,measuredWidth);
  }
 else {
    result=breakText(buf,0,-(end - start),maxWidth,measuredWidth);
  }
  TemporaryBuffer.recycle(buf);
  return result;
}
