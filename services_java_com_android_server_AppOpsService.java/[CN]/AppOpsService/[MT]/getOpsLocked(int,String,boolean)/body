{
  HashMap<String,Ops> pkgOps=mUidOps.get(uid);
  if (pkgOps == null) {
    if (!edit) {
      return null;
    }
    pkgOps=new HashMap<String,Ops>();
    mUidOps.put(uid,pkgOps);
  }
  if (uid == 0) {
    packageName="root";
  }
 else   if (uid == Process.SHELL_UID) {
    packageName="com.android.shell";
  }
  Ops ops=pkgOps.get(packageName);
  if (ops == null) {
    if (!edit) {
      return null;
    }
    if (uid != 0) {
      final long ident=Binder.clearCallingIdentity();
      try {
        int pkgUid=-1;
        try {
          pkgUid=mContext.getPackageManager().getPackageUid(packageName,UserHandle.getUserId(uid));
        }
 catch (        NameNotFoundException e) {
          if ("media".equals(packageName)) {
            pkgUid=Process.MEDIA_UID;
          }
        }
        if (pkgUid != uid) {
          Slog.w(TAG,"Bad call: specified package " + packageName + " under uid "+ uid+ " but it is really "+ pkgUid);
          return null;
        }
      }
  finally {
        Binder.restoreCallingIdentity(ident);
      }
    }
    ops=new Ops(packageName,uid);
    pkgOps.put(packageName,ops);
  }
  return ops;
}
