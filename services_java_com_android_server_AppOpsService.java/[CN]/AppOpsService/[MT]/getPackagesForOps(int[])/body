{
  mContext.enforcePermission(android.Manifest.permission.GET_APP_OPS_STATS,Binder.getCallingPid(),Binder.getCallingUid(),null);
  ArrayList<AppOpsManager.PackageOps> res=null;
synchronized (this) {
    for (int i=0; i < mUidOps.size(); i++) {
      HashMap<String,Ops> packages=mUidOps.valueAt(i);
      for (      Ops pkgOps : packages.values()) {
        ArrayList<AppOpsManager.OpEntry> resOps=null;
        if (ops == null) {
          resOps=new ArrayList<AppOpsManager.OpEntry>();
          for (int j=0; j < pkgOps.size(); j++) {
            Op curOp=pkgOps.valueAt(j);
            resOps.add(new AppOpsManager.OpEntry(curOp.op,curOp.time,curOp.duration));
          }
        }
 else {
          for (int j=0; j < ops.length; j++) {
            Op curOp=pkgOps.get(ops[j]);
            if (curOp != null) {
              if (resOps == null) {
                resOps=new ArrayList<AppOpsManager.OpEntry>();
              }
              resOps.add(new AppOpsManager.OpEntry(curOp.op,curOp.time,curOp.duration));
            }
          }
        }
        if (resOps != null) {
          if (res == null) {
            res=new ArrayList<AppOpsManager.PackageOps>();
          }
          AppOpsManager.PackageOps resPackage=new AppOpsManager.PackageOps(pkgOps.packageName,pkgOps.uid,resOps);
          res.add(resPackage);
        }
      }
    }
  }
  return res;
}
