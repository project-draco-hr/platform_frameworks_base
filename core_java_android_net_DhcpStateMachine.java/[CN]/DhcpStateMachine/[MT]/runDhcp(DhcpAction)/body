{
  boolean success=false;
  DhcpInfoInternal dhcpInfoInternal=new DhcpInfoInternal();
  if (dhcpAction == DhcpAction.START) {
    NetworkUtils.stopDhcp(mInterfaceName);
    if (DBG)     Log.d(TAG,"DHCP request on " + mInterfaceName);
    success=NetworkUtils.runDhcp(mInterfaceName,dhcpInfoInternal);
    mDhcpInfo=dhcpInfoInternal;
  }
 else   if (dhcpAction == DhcpAction.RENEW) {
    if (DBG)     Log.d(TAG,"DHCP renewal on " + mInterfaceName);
    success=NetworkUtils.runDhcpRenew(mInterfaceName,dhcpInfoInternal);
    dhcpInfoInternal.updateFromDhcpRequest(mDhcpInfo);
  }
  if (success) {
    if (DBG)     Log.d(TAG,"DHCP succeeded on " + mInterfaceName);
    long leaseDuration=dhcpInfoInternal.leaseDuration;
    if (leaseDuration >= 0) {
      if (leaseDuration < MIN_RENEWAL_TIME_SECS) {
        leaseDuration=MIN_RENEWAL_TIME_SECS;
      }
      mAlarmManager.set(AlarmManager.ELAPSED_REALTIME_WAKEUP,SystemClock.elapsedRealtime() + leaseDuration * 480,mDhcpRenewalIntent);
    }
 else {
    }
    mController.obtainMessage(CMD_POST_DHCP_ACTION,DHCP_SUCCESS,0,dhcpInfoInternal).sendToTarget();
  }
 else {
    Log.e(TAG,"DHCP failed on " + mInterfaceName + ": "+ NetworkUtils.getDhcpError());
    NetworkUtils.stopDhcp(mInterfaceName);
    mController.obtainMessage(CMD_POST_DHCP_ACTION,DHCP_FAILURE,0).sendToTarget();
  }
  return success;
}
