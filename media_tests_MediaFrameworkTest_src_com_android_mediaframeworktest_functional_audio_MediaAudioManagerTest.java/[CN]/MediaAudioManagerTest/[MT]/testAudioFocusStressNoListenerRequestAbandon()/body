{
  final int ITERATIONS=1000;
  setupAudioFocusListener();
  mAudioManager.requestAudioFocus(mAudioFocusListener,AudioManager.STREAM_MUSIC,AudioManager.AUDIOFOCUS_GAIN);
  for (int i=0; i < ITERATIONS; i++) {
    mAudioManager.requestAudioFocus(null,AudioManager.STREAM_MUSIC,AudioManager.AUDIOFOCUS_GAIN_TRANSIENT);
    mAudioManager.abandonAudioFocus(null);
    java.lang.Thread.sleep(WAIT_FOR_AUDIOFOCUS_LOSS_MS);
  }
  assertTrue("testAudioFocusListenerLifeCycle : observed " + mAudioFocusListener.mFocusChangeCounter + " AudioFocus changes",mAudioFocusListener.mFocusChangeCounter == ITERATIONS * 2);
  mAudioManager.abandonAudioFocus(mAudioFocusListener);
  mAudioManager.unregisterAudioFocusListener(mAudioFocusListener);
}
