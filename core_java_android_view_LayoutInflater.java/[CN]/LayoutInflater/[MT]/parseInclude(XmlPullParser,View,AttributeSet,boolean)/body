{
  int type;
  if (parent instanceof ViewGroup) {
    Context context=inheritContext ? parent.getContext() : mContext;
    final TypedArray ta=context.obtainStyledAttributes(attrs,ATTRS_THEME);
    final int themeResId=ta.getResourceId(0,0);
    if (themeResId != 0) {
      context=new ContextThemeWrapper(context,themeResId);
    }
    ta.recycle();
    int layout=attrs.getAttributeResourceValue(null,ATTR_LAYOUT,0);
    if (layout == 0) {
      final String value=attrs.getAttributeValue(null,ATTR_LAYOUT);
      if (value == null || value.length() < 1) {
        throw new InflateException("You must specify a layout in the" + " include tag: <include layout=\"@layout/layoutID\" />");
      }
      layout=context.getResources().getIdentifier(value.substring(1),null,null);
    }
    if (mTempValue == null) {
      mTempValue=new TypedValue();
    }
    if (layout != 0 && context.getTheme().resolveAttribute(layout,mTempValue,true)) {
      layout=mTempValue.resourceId;
    }
    if (layout == 0) {
      final String value=attrs.getAttributeValue(null,ATTR_LAYOUT);
      throw new InflateException("You must specify a valid layout " + "reference. The layout ID " + value + " is not valid.");
    }
 else {
      final XmlResourceParser childParser=getContext().getResources().getLayout(layout);
      try {
        final AttributeSet childAttrs=Xml.asAttributeSet(childParser);
        while ((type=childParser.next()) != XmlPullParser.START_TAG && type != XmlPullParser.END_DOCUMENT) {
        }
        if (type != XmlPullParser.START_TAG) {
          throw new InflateException(childParser.getPositionDescription() + ": No start tag found!");
        }
        final String childName=childParser.getName();
        if (TAG_MERGE.equals(childName)) {
          rInflate(childParser,parent,childAttrs,false,inheritContext);
        }
 else {
          final View view=createViewFromTag(parent,childName,childAttrs,inheritContext);
          final ViewGroup group=(ViewGroup)parent;
          ViewGroup.LayoutParams params=null;
          try {
            params=group.generateLayoutParams(attrs);
          }
 catch (          RuntimeException e) {
            params=group.generateLayoutParams(childAttrs);
          }
 finally {
            if (params != null) {
              view.setLayoutParams(params);
            }
          }
          rInflate(childParser,view,childAttrs,true,true);
          final TypedArray a=context.obtainStyledAttributes(attrs,com.android.internal.R.styleable.Include);
          final int id=a.getResourceId(com.android.internal.R.styleable.Include_id,View.NO_ID);
          final int visibility=a.getInt(com.android.internal.R.styleable.Include_visibility,-1);
          a.recycle();
          if (id != View.NO_ID) {
            view.setId(id);
          }
switch (visibility) {
case 0:
            view.setVisibility(View.VISIBLE);
          break;
case 1:
        view.setVisibility(View.INVISIBLE);
      break;
case 2:
    view.setVisibility(View.GONE);
  break;
}
group.addView(view);
}
}
  finally {
childParser.close();
}
}
}
 else {
throw new InflateException("<include /> can only be used inside of a ViewGroup");
}
final int currentDepth=parser.getDepth();
while (((type=parser.next()) != XmlPullParser.END_TAG || parser.getDepth() > currentDepth) && type != XmlPullParser.END_DOCUMENT) {
}
}
