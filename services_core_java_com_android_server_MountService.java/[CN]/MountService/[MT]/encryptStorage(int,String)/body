{
  if (TextUtils.isEmpty(password) && type != StorageManager.CRYPT_TYPE_DEFAULT) {
    throw new IllegalArgumentException("password cannot be empty");
  }
  mContext.enforceCallingOrSelfPermission(Manifest.permission.CRYPT_KEEPER,"no permission to access the crypt keeper");
  waitForReady();
  if (DEBUG_EVENTS) {
    Slog.i(TAG,"encrypting storage...");
  }
  try {
    if (type == StorageManager.CRYPT_TYPE_DEFAULT) {
      mCryptConnector.execute("cryptfs","enablecrypto","inplace",CRYPTO_TYPES[type]);
    }
 else {
      mCryptConnector.execute("cryptfs","enablecrypto","inplace",CRYPTO_TYPES[type],new SensitiveArg(password));
    }
  }
 catch (  NativeDaemonConnectorException e) {
    return e.getCode();
  }
  return 0;
}
