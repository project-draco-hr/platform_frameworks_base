{
  mContext.enforceCallingOrSelfPermission(Manifest.permission.STORAGE_INTERNAL,"no permission to access the crypt keeper");
  waitForReady();
  final NativeDaemonEvent event;
  try {
    event=mCryptConnector.execute("cryptfs","getpwtype");
    for (int i=0; i < CRYPTO_TYPES.length; ++i) {
      if (CRYPTO_TYPES[i].equals(event.getMessage()))       return i;
    }
    throw new IllegalStateException("unexpected return from cryptfs");
  }
 catch (  NativeDaemonConnectorException e) {
    throw e.rethrowAsParcelableException();
  }
}
