{
  waitForReady();
  validatePermission(android.Manifest.permission.MOUNT_UNMOUNT_FILESYSTEMS);
  validateUserRestriction(UserManager.DISALLOW_USB_FILE_TRANSFER);
  final StorageVolume primary=getPrimaryPhysicalVolume();
  if (primary == null)   return;
  String path=primary.getPath();
  String vs=getVolumeState(path);
  String method="ums";
  if (enable && vs.equals(Environment.MEDIA_MOUNTED)) {
    setUmsEnabling(enable);
    UmsEnableCallBack umscb=new UmsEnableCallBack(path,method,true);
    mHandler.sendMessage(mHandler.obtainMessage(H_UNMOUNT_PM_UPDATE,umscb));
    setUmsEnabling(false);
  }
  if (!enable) {
    doShareUnshareVolume(path,method,enable);
    if (doMountVolume(path) != StorageResultCode.OperationSucceeded) {
      Slog.e(TAG,"Failed to remount " + path + " after disabling share method "+ method);
    }
  }
}
