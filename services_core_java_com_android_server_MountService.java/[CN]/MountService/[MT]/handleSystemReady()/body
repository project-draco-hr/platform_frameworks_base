{
  final HashMap<String,String> snapshot;
synchronized (mVolumesLock) {
    snapshot=new HashMap<String,String>(mVolumeStates);
  }
  for (  Map.Entry<String,String> entry : snapshot.entrySet()) {
    final String path=entry.getKey();
    final String state=entry.getValue();
    if (state.equals(Environment.MEDIA_UNMOUNTED)) {
      int rc=doMountVolume(path);
      if (rc != StorageResultCode.OperationSucceeded) {
        Slog.e(TAG,String.format("Boot-time mount failed (%d)",rc));
      }
    }
 else     if (state.equals(Environment.MEDIA_SHARED)) {
      notifyVolumeStateChange(null,path,VolumeState.NoMedia,VolumeState.Shared);
    }
  }
synchronized (mVolumesLock) {
    for (    StorageVolume volume : mVolumes) {
      if (volume.isEmulated()) {
        updatePublicVolumeState(volume,Environment.MEDIA_MOUNTED);
      }
    }
  }
  if (mSendUmsConnectedOnBoot) {
    sendUmsIntent(true);
    mSendUmsConnectedOnBoot=false;
  }
  MountServiceIdler.scheduleIdlePass(mContext);
}
