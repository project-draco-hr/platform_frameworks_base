{
  if (vol.type == VolumeInfo.TYPE_EMULATED) {
    final StorageManager storage=mContext.getSystemService(StorageManager.class);
    final VolumeInfo privateVol=storage.findPrivateForEmulated(vol);
    if (Objects.equals(StorageManager.UUID_PRIVATE_INTERNAL,mPrimaryStorageUuid) && VolumeInfo.ID_PRIVATE_INTERNAL.equals(privateVol.id)) {
      Slog.v(TAG,"Found primary storage at " + vol);
      vol.mountFlags|=VolumeInfo.MOUNT_FLAG_PRIMARY;
      vol.mountFlags|=VolumeInfo.MOUNT_FLAG_VISIBLE;
      mHandler.obtainMessage(H_VOLUME_MOUNT,vol).sendToTarget();
    }
 else     if (Objects.equals(privateVol.fsUuid,mPrimaryStorageUuid)) {
      Slog.v(TAG,"Found primary storage at " + vol);
      vol.mountFlags|=VolumeInfo.MOUNT_FLAG_PRIMARY;
      vol.mountFlags|=VolumeInfo.MOUNT_FLAG_VISIBLE;
      mHandler.obtainMessage(H_VOLUME_MOUNT,vol).sendToTarget();
    }
  }
 else   if (vol.type == VolumeInfo.TYPE_PUBLIC) {
    if (Objects.equals(StorageManager.UUID_PRIMARY_PHYSICAL,mPrimaryStorageUuid) && vol.disk.isDefaultPrimary()) {
      Slog.v(TAG,"Found primary storage at " + vol);
      vol.mountFlags|=VolumeInfo.MOUNT_FLAG_PRIMARY;
      vol.mountFlags|=VolumeInfo.MOUNT_FLAG_VISIBLE;
    }
    if (vol.disk.isAdoptable()) {
      vol.mountFlags|=VolumeInfo.MOUNT_FLAG_VISIBLE;
    }
    vol.mountUserId=ActivityManager.getCurrentUser();
    mHandler.obtainMessage(H_VOLUME_MOUNT,vol).sendToTarget();
  }
 else   if (vol.type == VolumeInfo.TYPE_PRIVATE) {
    mHandler.obtainMessage(H_VOLUME_MOUNT,vol).sendToTarget();
  }
 else {
    Slog.d(TAG,"Skipping automatic mounting of " + vol);
  }
}
