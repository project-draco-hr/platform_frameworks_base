{
  enforcePermission(android.Manifest.permission.MOUNT_UNMOUNT_FILESYSTEMS);
  waitForReady();
synchronized (mLock) {
    for (int i=0; i < mRecords.size(); i++) {
      final String fsUuid=mRecords.keyAt(i);
      final VolumeRecord rec=mRecords.valueAt(i);
      if (!TextUtils.isEmpty(rec.partGuid)) {
        forgetPartition(rec.partGuid);
      }
      mCallbacks.notifyVolumeForgotten(fsUuid);
    }
    mRecords.clear();
    if (!Objects.equals(StorageManager.UUID_PRIVATE_INTERNAL,mPrimaryStorageUuid)) {
      mPrimaryStorageUuid=getDefaultPrimaryStorageUuid();
    }
    writeSettingsLocked();
    resetIfReadyAndConnectedLocked();
  }
}
