{
  ReceivedPointerTracker receivedTracker=mReceivedPointerTracker;
  if (prototype.getPointerCount() == receivedTracker.getActivePointerCount()) {
    sendMotionEvent(prototype,prototype.getAction(),ALL_POINTER_ID_BITS,policyFlags);
    return;
  }
  if (receivedTracker.getActivePointerCount() == 0 && !receivedTracker.wasLastReceivedUpPointerActive()) {
    return;
  }
  final int actionMasked=prototype.getActionMasked();
  final int actionPointerId=prototype.getPointerId(prototype.getActionIndex());
  if (actionMasked != MotionEvent.ACTION_MOVE) {
    if (!receivedTracker.isActiveOrWasLastActiveUpPointer(actionPointerId)) {
      return;
    }
  }
  int pointerIdBits=0;
  final int pointerCount=prototype.getPointerCount();
  for (int pointerIndex=0; pointerIndex < pointerCount; pointerIndex++) {
    final int pointerId=prototype.getPointerId(pointerIndex);
    if (receivedTracker.isActiveOrWasLastActiveUpPointer(pointerId)) {
      pointerIdBits|=(1 << pointerId);
    }
  }
  sendMotionEvent(prototype,prototype.getAction(),pointerIdBits,policyFlags);
}
