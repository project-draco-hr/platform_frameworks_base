{
  final PointerTracker pointerTracker=mPointerTracker;
  final PointerProperties[] pointerProperties=mTempPointerProperties;
  final PointerCoords[] pointerCoords=mTempPointerCoords;
  int pointerDataIndex=0;
  final int pointerCount=prototype.getPointerCount();
  for (int i=0; i < pointerCount; i++) {
    final int pointerId=prototype.getPointerId(i);
    if (!pointerTracker.isInjectedPointerDown(pointerId)) {
      continue;
    }
    prototype.getPointerProperties(i,pointerProperties[pointerDataIndex]);
    prototype.getPointerCoords(i,pointerCoords[pointerDataIndex]);
    final long downTime=pointerTracker.getLastInjectedDownEventTime();
    final int action=computeInjectionAction(MotionEvent.ACTION_UP,pointerDataIndex);
    final int newPointerCount=pointerDataIndex + 1;
    final long eventTime=SystemClock.uptimeMillis();
    MotionEvent event=MotionEvent.obtain(downTime,eventTime,action,newPointerCount,pointerProperties,pointerCoords,prototype.getMetaState(),prototype.getButtonState(),prototype.getXPrecision(),prototype.getYPrecision(),prototype.getDeviceId(),prototype.getEdgeFlags(),prototype.getSource(),prototype.getFlags());
    sendMotionEvent(event,policyFlags);
    event.recycle();
    pointerDataIndex++;
  }
}
