{
  try {
    IBinder b=ServiceManager.getService(USB_SERVICE);
    IUsbManager service=IUsbManager.Stub.asInterface(b);
    int uid=ri.activityInfo.applicationInfo.uid;
    if (mDevice != null) {
      service.grantDevicePermission(mDevice,uid);
      if (alwaysCheck) {
        service.setDevicePackage(mDevice,ri.activityInfo.packageName);
      }
 else {
        service.setDevicePackage(mDevice,null);
      }
    }
 else     if (mAccessory != null) {
      service.grantAccessoryPermission(mAccessory,uid);
      if (alwaysCheck) {
        service.setAccessoryPackage(mAccessory,ri.activityInfo.packageName);
      }
 else {
        service.setAccessoryPackage(mAccessory,null);
      }
    }
    try {
      startActivity(intent);
    }
 catch (    ActivityNotFoundException e) {
      Log.e(TAG,"startActivity failed",e);
    }
  }
 catch (  RemoteException e) {
    Log.e(TAG,"onIntentSelected failed",e);
  }
}
