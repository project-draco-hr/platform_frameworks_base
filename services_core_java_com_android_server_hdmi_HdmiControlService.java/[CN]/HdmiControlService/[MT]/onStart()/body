{
  mIoThread.start();
  mPowerStatus=HdmiControlManager.POWER_STATUS_TRANSIENT_TO_ON;
  mProhibitMode=false;
  mHdmiControlEnabled=readBooleanSetting(Global.HDMI_CONTROL_ENABLED,true);
  mMhlInputChangeEnabled=readBooleanSetting(Global.MHL_INPUT_SWITCHING_ENABLED,true);
  mCecController=HdmiCecController.create(this);
  if (mCecController != null) {
    if (mHdmiControlEnabled) {
      initializeCec(INITIATED_BY_BOOT_UP);
    }
  }
 else {
    Slog.i(TAG,"Device does not support HDMI-CEC.");
    return;
  }
  mMhlController=HdmiMhlControllerStub.create(this);
  if (!mMhlController.isReady()) {
    Slog.i(TAG,"Device does not support MHL-control.");
  }
  mMhlDevices=Collections.emptyList();
  initPortInfo();
  mMessageValidator=new HdmiCecMessageValidator(this);
  publishBinderService(Context.HDMI_CONTROL_SERVICE,new BinderService());
  if (mCecController != null) {
    IntentFilter filter=new IntentFilter();
    filter.addAction(Intent.ACTION_SCREEN_OFF);
    filter.addAction(Intent.ACTION_SCREEN_ON);
    filter.addAction(Intent.ACTION_SHUTDOWN);
    filter.addAction(Intent.ACTION_CONFIGURATION_CHANGED);
    getContext().registerReceiver(mHdmiControlBroadcastReceiver,filter);
    registerContentObserver();
  }
  mMhlController.setOption(OPTION_MHL_SERVICE_CONTROL,ENABLED);
}
