{
  if (model instanceof IndexColorModel && canFilterIndexColorModel) {
    IndexColorModel icm=(IndexColorModel)model;
    ColorModel filteredModel=filterIndexColorModel(icm);
    substituteColorModel(model,filteredModel);
    consumer.setColorModel(filteredModel);
  }
 else {
    consumer.setColorModel(ColorModel.getRGBdefault());
  }
}
