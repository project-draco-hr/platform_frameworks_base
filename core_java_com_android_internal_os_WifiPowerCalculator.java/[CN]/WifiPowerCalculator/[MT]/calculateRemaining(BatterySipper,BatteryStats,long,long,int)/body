{
  final long idleTimeMs=stats.getWifiControllerActivity(BatteryStats.CONTROLLER_IDLE_TIME,statsType);
  final long rxTimeMs=stats.getWifiControllerActivity(BatteryStats.CONTROLLER_RX_TIME,statsType);
  final long txTimeMs=stats.getWifiControllerActivity(BatteryStats.CONTROLLER_TX_TIME,statsType);
  app.wifiRunningTimeMs=idleTimeMs + rxTimeMs + txTimeMs;
  double powerDrainMah=stats.getWifiControllerActivity(BatteryStats.CONTROLLER_POWER_DRAIN,statsType) / (double)(1000 * 60 * 60);
  if (powerDrainMah == 0) {
    powerDrainMah=((idleTimeMs * mIdleCurrentMa) + (txTimeMs * mTxCurrentMa) + (rxTimeMs * mRxCurrentMa)) / (1000 * 60 * 60);
  }
  app.wifiPowerMah=Math.max(0,powerDrainMah - mTotalAppPowerDrain);
  if (DEBUG) {
    Log.d(TAG,"left over WiFi power: " + BatteryStatsHelper.makemAh(app.wifiPowerMah));
  }
}
