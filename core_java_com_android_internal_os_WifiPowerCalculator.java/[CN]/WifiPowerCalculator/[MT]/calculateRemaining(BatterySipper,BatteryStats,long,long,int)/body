{
  final long idleTimeMs=stats.getWifiControllerActivity(BatteryStats.CONTROLLER_IDLE_TIME,statsType);
  final long rxTimeMs=stats.getWifiControllerActivity(BatteryStats.CONTROLLER_RX_TIME,statsType);
  final long txTimeMs=stats.getWifiControllerActivity(BatteryStats.CONTROLLER_TX_TIME,statsType);
  app.wifiRunningTimeMs=idleTimeMs + rxTimeMs + txTimeMs;
  double powerDrain=stats.getWifiControllerActivity(BatteryStats.CONTROLLER_POWER_DRAIN,statsType) / (1000 * 60 * 60);
  if (powerDrain == 0) {
    powerDrain=((idleTimeMs * mIdleCurrentMa) + (txTimeMs * mTxCurrentMa) + (rxTimeMs * mRxCurrentMa)) / (1000 * 60 * 60);
  }
  app.wifiPowerMah=Math.max(0,powerDrain - mTotalAppPowerDrain);
}
