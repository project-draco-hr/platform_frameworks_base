{
  mService.mDragState.broadcastDragEndedLw();
  mService.mDragState.unregister();
  mService.mInputMonitor.updateInputWindowsLw(true);
  mService.mDragState.reset();
  mService.mDragState=null;
  if (WindowManagerService.DEBUG_ORIENTATION)   Slog.d(WindowManagerService.TAG,"Performing post-drag rotation");
  boolean changed=mService.setRotationUncheckedLocked(WindowManagerPolicy.USE_LAST_ROTATION,0,false);
  if (changed) {
    mService.mH.sendEmptyMessage(H.SEND_NEW_CONFIGURATION);
  }
}
