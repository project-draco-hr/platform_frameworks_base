{
  maybeInitHttpClient();
  String protocol=url.getProtocol();
  OkUrlFactory okUrlFactory;
  if (protocol.equals("http")) {
    okUrlFactory=HttpHandler.createHttpOkUrlFactory(null);
  }
 else   if (protocol.equals("https")) {
    okUrlFactory=HttpsHandler.createHttpsOkUrlFactory(null);
  }
 else {
    throw new MalformedURLException("Invalid URL or unrecognized protocol " + protocol);
  }
  OkHttpClient client=okUrlFactory.client();
  client.setSocketFactory(getSocketFactory()).setConnectionPool(mConnectionPool);
  Internal.instance.setNetwork(client,mNetwork);
  return okUrlFactory.open(url);
}
