{
  DataBuffer data=null;
  int maxOffset=bandOffsets[0];
  for (int i=1; i < bandOffsets.length; i++) {
    if (bandOffsets[i] > maxOffset) {
      maxOffset=bandOffsets[i];
    }
  }
  int size=(height - 1) * scanlineStride + (width - 1) * pixelStride + maxOffset + 1;
switch (dataType) {
case DataBuffer.TYPE_BYTE:
    data=new DataBufferByte(size,numBanks);
  break;
case DataBuffer.TYPE_SHORT:
data=new DataBufferShort(size,numBanks);
break;
case DataBuffer.TYPE_USHORT:
data=new DataBufferUShort(size,numBanks);
break;
case DataBuffer.TYPE_INT:
data=new DataBufferInt(size,numBanks);
break;
case DataBuffer.TYPE_FLOAT:
data=new DataBufferFloat(size,numBanks);
break;
case DataBuffer.TYPE_DOUBLE:
data=new DataBufferDouble(size,numBanks);
break;
}
return data;
}
