{
  Message msg;
  while (true) {
    msg=null;
synchronized (this) {
      try {
        this.wait(FAIL_TIMEOUT_MILLIS);
      }
 catch (      InterruptedException e) {
      }
      if (mCurrentMessage != null) {
        msg=Message.obtain();
        msg.copyFrom(mCurrentMessage);
        mCurrentMessage=null;
        mMsgConsumed=true;
        this.notifyAll();
      }
    }
    if (msg == null || code == GSMPhoneTest.ANY_MESSAGE || msg.what == code)     return msg;
  }
}
