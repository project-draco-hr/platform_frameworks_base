{
  server.enqueue(new MockResponse().setBody("Via request parameter proxy!"));
  server.play();
  System.setProperty("http.proxyHost","proxy.foo");
  System.setProperty("http.proxyPort","8080");
  HttpClient client=newHttpClient();
  HttpGet request=new HttpGet("http://origin.foo/bar");
  proxyConfig.configure(server,client,request);
  HttpResponse response=client.execute(request);
  assertEquals("Via request parameter proxy!",contentToString(response));
  RecordedRequest recordedRequest=server.takeRequest();
  assertEquals("GET http://origin.foo/bar HTTP/1.1",recordedRequest.getRequestLine());
}
