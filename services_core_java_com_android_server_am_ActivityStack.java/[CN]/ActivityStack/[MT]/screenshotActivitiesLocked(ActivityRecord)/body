{
  if (DEBUG_SCREENSHOTS)   Slog.d(TAG_SCREENSHOTS,"screenshotActivitiesLocked: " + who);
  if (who.noDisplay) {
    if (DEBUG_SCREENSHOTS)     Slog.d(TAG_SCREENSHOTS,"\tNo display");
    return null;
  }
  if (isHomeStack()) {
    if (DEBUG_SCREENSHOTS)     Slog.d(TAG_SCREENSHOTS,"\tHome stack");
    return null;
  }
  int w=mService.mThumbnailWidth;
  int h=mService.mThumbnailHeight;
  float scale=1f;
  if (w > 0) {
    if (DEBUG_SCREENSHOTS)     Slog.d(TAG_SCREENSHOTS,"\tTaking screenshot");
    if (ActivityManagerService.TAKE_FULLSCREEN_SCREENSHOTS) {
      w=h=-1;
      scale=mService.mFullscreenThumbnailScale;
    }
    return mWindowManager.screenshotApplications(who.appToken,Display.DEFAULT_DISPLAY,w,h,scale);
  }
  Slog.e(TAG,"Invalid thumbnail dimensions: " + w + "x"+ h);
  return null;
}
