{
  if (DEBUG_VISIBILITY)   Slog.v(TAG_VISIBILITY,"Make invisible? " + r + " finishing="+ r.finishing+ " state="+ r.state+ " stackInvisible="+ stackInvisible+ " behindFullscreenActivity="+ behindFullscreenActivity);
  if (!r.visible) {
    if (DEBUG_VISIBILITY)     Slog.v(TAG_VISIBILITY,"Already invisible: " + r);
    return;
  }
  if (DEBUG_VISIBILITY)   Slog.v(TAG_VISIBILITY,"Making invisible: " + r);
  try {
    setVisible(r,false);
switch (r.state) {
case STOPPING:
case STOPPED:
      if (r.app != null && r.app.thread != null) {
        if (DEBUG_VISIBILITY)         Slog.v(TAG_VISIBILITY,"Scheduling invisibility: " + r);
        r.app.thread.scheduleWindowVisibility(r.appToken,false);
      }
    break;
case INITIALIZING:
case RESUMED:
case PAUSING:
case PAUSED:
  if (getVisibleBehindActivity() == r) {
    releaseBackgroundResources(r);
  }
 else {
    if (!mStackSupervisor.mStoppingActivities.contains(r)) {
      mStackSupervisor.mStoppingActivities.add(r);
    }
    mStackSupervisor.scheduleIdleLocked();
  }
break;
default :
break;
}
}
 catch (Exception e) {
Slog.w(TAG,"Exception thrown making hidden: " + r.intent.getComponent(),e);
}
}
