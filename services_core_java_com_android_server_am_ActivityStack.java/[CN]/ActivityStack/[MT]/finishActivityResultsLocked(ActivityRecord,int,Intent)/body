{
  ActivityRecord resultTo=r.resultTo;
  if (resultTo != null) {
    if (DEBUG_RESULTS)     Slog.v(TAG,"Adding result to " + resultTo + " who="+ r.resultWho+ " req="+ r.requestCode+ " res="+ resultCode+ " data="+ resultData);
    if (resultTo.userId != r.userId) {
      if (resultData != null) {
        resultData.setContentUserHint(r.userId);
      }
    }
    if (r.info.applicationInfo.uid > 0) {
      mService.grantUriPermissionFromIntentLocked(r.info.applicationInfo.uid,resultTo.packageName,resultData,resultTo.getUriPermissionsLocked(),resultTo.userId);
    }
    resultTo.addResultLocked(r,r.resultWho,r.requestCode,resultCode,resultData);
    r.resultTo=null;
  }
 else   if (DEBUG_RESULTS)   Slog.v(TAG,"No result destination from " + r);
  r.results=null;
  r.pendingResults=null;
  r.newIntents=null;
  r.icicle=null;
}
