{
  if (!isAttached()) {
    return false;
  }
  if (mStackSupervisor.isFrontStack(this)) {
    return true;
  }
  final int stackIndex=mStacks.indexOf(this);
  if (stackIndex == mStacks.size() - 1) {
    Slog.wtf(TAG,"Stack=" + this + " isn't front stack but is at the top of the stack list");
    return false;
  }
  final ActivityStack focusedStack=mStackSupervisor.getFocusedStack();
  final int focusedStackId=focusedStack.mStackId;
  if (mStackId == DOCKED_STACK_ID) {
    if (focusedStackId != HOME_STACK_ID) {
      return true;
    }
    ActivityRecord topHomeActivity=focusedStack.topRunningActivityLocked(null);
    return topHomeActivity == null || !topHomeActivity.isHomeActivity();
  }
  final int belowFocusedIndex=mStacks.indexOf(focusedStack) - 1;
  if (focusedStackId == DOCKED_STACK_ID && stackIndex == belowFocusedIndex) {
    return true;
  }
  if (focusedStackId == FULLSCREEN_WORKSPACE_STACK_ID && hasTranslucentActivity(focusedStack)) {
    if (stackIndex == belowFocusedIndex) {
      return true;
    }
    if (belowFocusedIndex >= 0) {
      final ActivityStack stack=mStacks.get(belowFocusedIndex);
      if (stack.mStackId == DOCKED_STACK_ID && stackIndex == (belowFocusedIndex - 1)) {
        return true;
      }
    }
  }
  if (mStackId >= FIRST_STATIC_STACK_ID && mStackId <= LAST_STATIC_STACK_ID) {
    return false;
  }
  for (int i=stackIndex + 1; i < mStacks.size(); i++) {
    final ActivityStack stack=mStacks.get(i);
    if (!stack.mFullscreen && !stack.hasFullscreenTask()) {
      continue;
    }
    if (stack.mStackId == FREEFORM_WORKSPACE_STACK_ID || stack.mStackId == HOME_STACK_ID || stack.mStackId == FULLSCREEN_WORKSPACE_STACK_ID) {
      return false;
    }
    if (!hasTranslucentActivity(stack)) {
      return false;
    }
  }
  return true;
}
