{
  if (hasVisibleBehindActivity() && !mHandler.hasMessages(RELEASE_BACKGROUND_RESOURCES_TIMEOUT_MSG)) {
    if (r == topRunningActivityLocked(null)) {
      return;
    }
    if (DEBUG_STATES)     Slog.d(TAG_STATES,"releaseBackgroundResources activtyDisplay=" + mActivityContainer.mActivityDisplay + " visibleBehind="+ r+ " app="+ r.app+ " thread="+ r.app.thread);
    if (r != null && r.app != null && r.app.thread != null) {
      try {
        r.app.thread.scheduleCancelVisibleBehind(r.appToken);
      }
 catch (      RemoteException e) {
      }
      mHandler.sendEmptyMessageDelayed(RELEASE_BACKGROUND_RESOURCES_TIMEOUT_MSG,500);
    }
 else {
      Slog.e(TAG,"releaseBackgroundResources: activity " + r + " no longer running");
      backgroundResourcesReleased();
    }
  }
}
