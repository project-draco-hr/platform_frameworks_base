{
  if (isMediaPlaying() && !mHandler.hasMessages(STOP_MEDIA_PLAYING_TIMEOUT_MSG)) {
    final ActivityRecord r=getMediaPlayer();
    if (DEBUG_STATES)     Slog.d(TAG,"releaseMediaResources activtyDisplay=" + mActivityContainer.mActivityDisplay + " mediaPlayer="+ r+ " app="+ r.app+ " thread="+ r.app.thread);
    if (r != null && r.app != null && r.app.thread != null) {
      try {
        r.app.thread.scheduleStopMediaPlaying(r.appToken);
      }
 catch (      RemoteException e) {
      }
      mHandler.sendEmptyMessageDelayed(STOP_MEDIA_PLAYING_TIMEOUT_MSG,500);
    }
 else {
      Slog.e(TAG,"releaseMediaResources: activity " + r + " no longer running");
      mediaResourcesReleased(r.appToken);
    }
  }
}
