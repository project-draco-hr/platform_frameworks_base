{
  Provider[] providers=Security.getProviders();
  int bcProviderPosition=-1;
  for (int position=0; position < providers.length; position++) {
    Provider provider=providers[position];
    if ("BC".equals(provider.getName())) {
      bcProviderPosition=position;
      break;
    }
  }
  Security.addProvider(new AndroidKeyStoreProvider());
  Provider workaroundProvider=new AndroidKeyStoreBCWorkaroundProvider();
  if (bcProviderPosition != -1) {
    Security.insertProviderAt(workaroundProvider,bcProviderPosition);
  }
 else {
    Security.addProvider(workaroundProvider);
  }
}
