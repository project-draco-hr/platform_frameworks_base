{
  final File testFile=new File(getContext().getFilesDir(),TEST_FILE);
  stageFile(R.raw.netstats_uid_v4,testFile);
  final NetworkStatsCollection collection=new NetworkStatsCollection(30 * MINUTE_IN_MILLIS);
  collection.readLegacyUid(testFile,true);
  assertSummaryTotalIncludingTags(collection,buildTemplateMobileAll(TEST_IMSI),77017831L,100995L,35436758L,92344L);
  final ByteArrayOutputStream bos=new ByteArrayOutputStream();
  collection.write(new DataOutputStream(bos));
  collection.reset();
  assertSummaryTotalIncludingTags(collection,buildTemplateMobileAll(TEST_IMSI),0L,0L,0L,0L);
  collection.read(new ByteArrayInputStream(bos.toByteArray()));
  assertSummaryTotalIncludingTags(collection,buildTemplateMobileAll(TEST_IMSI),77017831L,100995L,35436758L,92344L);
}
