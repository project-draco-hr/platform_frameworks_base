{
  final File testFile=new File(getContext().getFilesDir(),TEST_FILE);
  stageFile(R.raw.netstats_uid_v4,testFile);
  final NetworkStatsCollection collection=new NetworkStatsCollection(30 * MINUTE_IN_MILLIS);
  collection.readLegacyUid(testFile,false);
  assertSummaryTotal(collection,buildTemplateMobileAll(TEST_IMSI),637073904L,711398L,88342093L,521006L);
  final ByteArrayOutputStream bos=new ByteArrayOutputStream();
  collection.write(new DataOutputStream(bos));
  collection.reset();
  assertSummaryTotal(collection,buildTemplateMobileAll(TEST_IMSI),0L,0L,0L,0L);
  collection.read(new ByteArrayInputStream(bos.toByteArray()));
  assertSummaryTotal(collection,buildTemplateMobileAll(TEST_IMSI),637073904L,711398L,88342093L,521006L);
}
