{
  final int userId=uss.mHandle.getIdentifier();
synchronized (mService) {
    if (mStartedUsers.get(uss.mHandle.getIdentifier()) != uss)     return;
    if (!StorageManager.isUserKeyUnlocked(userId))     return;
    if (uss.setState(STATE_RUNNING_LOCKED,STATE_RUNNING_UNLOCKING)) {
      getUserManagerInternal().setUserState(userId,uss.state);
      uss.mUnlockProgress.start();
      uss.mUnlockProgress.setProgress(5,mService.mContext.getString(R.string.android_start_title));
      mUserManager.onBeforeUnlockUser(userId);
      uss.mUnlockProgress.setProgress(20);
      mHandler.obtainMessage(SYSTEM_USER_UNLOCK_MSG,userId,0,uss).sendToTarget();
    }
  }
}
