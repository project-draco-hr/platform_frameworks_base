{
  if (mService.checkCallingPermission(INTERACT_ACROSS_USERS_FULL) != PackageManager.PERMISSION_GRANTED) {
    String msg="Permission Denial: unlockUser() from pid=" + Binder.getCallingPid() + ", uid="+ Binder.getCallingUid()+ " requires "+ INTERACT_ACROSS_USERS_FULL;
    Slog.w(TAG,msg);
    throw new SecurityException(msg);
  }
  final long binderToken=Binder.clearCallingIdentity();
  try {
    return unlockUserCleared(userId,token,secret,listener);
  }
  finally {
    Binder.restoreCallingIdentity(binderToken);
  }
}
