{
synchronized (mService) {
    final UserState uss=mStartedUsers.get(userId);
    if (uss.unlocked) {
      return true;
    }
  }
  final UserInfo userInfo=getUserInfo(userId);
  final IMountService mountService=IMountService.Stub.asInterface(ServiceManager.getService("mount"));
  try {
    mountService.unlockUserKey(userId,userInfo.serialNumber,token);
  }
 catch (  RemoteException e) {
    Slog.w(TAG,"Failed to unlock: " + e.getMessage());
    return false;
  }
synchronized (mService) {
    final UserState uss=mStartedUsers.get(userId);
    updateUserUnlockedState(uss);
  }
  final Intent intent=new Intent(Intent.ACTION_USER_UNLOCKED);
  intent.addFlags(Intent.FLAG_RECEIVER_REGISTERED_ONLY | Intent.FLAG_RECEIVER_FOREGROUND);
  mService.broadcastIntentLocked(null,null,intent,null,null,0,null,null,null,AppOpsManager.OP_NONE,null,false,false,MY_PID,SYSTEM_UID,userId);
  return true;
}
