{
  int startedUsersSize=mStartedUsers.size();
  IntArray userIds=new IntArray();
  userIds.add(userId);
synchronized (mUserProfileGroupIdsSelfLocked) {
    int userGroupId=mUserProfileGroupIdsSelfLocked.get(userId,UserInfo.NO_PROFILE_GROUP_ID);
    for (int i=0; i < startedUsersSize; i++) {
      UserState uss=mStartedUsers.valueAt(i);
      int startedUserId=uss.mHandle.getIdentifier();
      int startedUserGroupId=mUserProfileGroupIdsSelfLocked.get(startedUserId,UserInfo.NO_PROFILE_GROUP_ID);
      boolean sameGroup=(userGroupId != UserInfo.NO_PROFILE_GROUP_ID) && (userGroupId == startedUserGroupId);
      boolean sameUserId=startedUserId == userId;
      if (!sameGroup || sameUserId) {
        continue;
      }
      userIds.add(startedUserId);
    }
  }
  return userIds.toArray();
}
