{
  final Notification n=notification.notification;
  LayoutInflater inflater=(LayoutInflater)mContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
  ViewGroup group;
  int layoutId;
  int iconId;
  if (n.largeIcon != null) {
    iconId=R.id.right_icon;
  }
 else {
    iconId=R.id.left_icon;
  }
  if (n.tickerView != null) {
    group=(ViewGroup)inflater.inflate(R.layout.system_bar_ticker_panel,null,false);
    ViewGroup content=(FrameLayout)group.findViewById(R.id.ticker_expanded);
    View expanded=null;
    Exception exception=null;
    try {
      expanded=n.tickerView.apply(mContext,content);
    }
 catch (    RuntimeException e) {
      exception=e;
    }
    if (expanded == null) {
      final String ident=notification.pkg + "/0x" + Integer.toHexString(notification.id);
      Slog.e(TAG,"couldn't inflate view for notification " + ident,exception);
      return null;
    }
    FrameLayout.LayoutParams lp=new FrameLayout.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT,ViewGroup.LayoutParams.MATCH_PARENT);
    content.addView(expanded,lp);
  }
 else   if (n.tickerText != null) {
    group=(ViewGroup)inflater.inflate(R.layout.system_bar_ticker_compat,mWindow,false);
    final Drawable icon=StatusBarIconView.getIcon(mContext,new StatusBarIcon(notification.pkg,n.icon,n.iconLevel,0,n.tickerText));
    ImageView iv=(ImageView)group.findViewById(iconId);
    iv.setImageDrawable(icon);
    iv.setVisibility(View.VISIBLE);
    TextView tv=(TextView)group.findViewById(R.id.text);
    tv.setText(n.tickerText);
  }
 else {
    throw new RuntimeException("tickerView==null && tickerText==null");
  }
  ImageView largeIcon=(ImageView)group.findViewById(R.id.large_icon);
  if (n.largeIcon != null) {
    largeIcon.setImageBitmap(n.largeIcon);
    largeIcon.setVisibility(View.VISIBLE);
    final ViewGroup.LayoutParams lp=largeIcon.getLayoutParams();
    final int statusBarHeight=mBar.getStatusBarHeight();
    if (n.largeIcon.getHeight() <= statusBarHeight) {
      lp.height=statusBarHeight;
    }
 else {
      lp.height=mLargeIconHeight;
    }
    largeIcon.setLayoutParams(lp);
  }
  if (CLICKABLE_TICKER) {
    PendingIntent contentIntent=notification.notification.contentIntent;
    if (contentIntent != null) {
      final View.OnClickListener clicker=mBar.makeClicker(contentIntent,notification.pkg,notification.tag,notification.id);
      group.setOnClickListener(new View.OnClickListener(){
        public void onClick(        View v){
          halt();
          clicker.onClick(v);
        }
      }
);
    }
 else {
      group.setOnClickListener(null);
    }
  }
  return group;
}
