{
  MockIpManagerCallback ipManagerCallback=new MockIpManagerCallback();
  ApfFilter apfFilter=new TestApfFilter(ipManagerCallback,false);
  byte[] program=ipManagerCallback.getApfProgram();
  ByteBuffer packet=ByteBuffer.wrap(new byte[100]);
  packet.putShort(ETH_ETHERTYPE_OFFSET,(short)ETH_P_IPV6);
  assertPass(program,packet.array(),0);
  packet.put(IPV6_NEXT_HEADER_OFFSET,(byte)IPPROTO_ICMPV6);
  assertPass(program,packet.array(),0);
  packet.put(ICMP6_TYPE_OFFSET,(byte)ICMP6_NEIGHBOR_ANNOUNCEMENT);
  assertPass(program,packet.array(),0);
  packet.position(IPV6_DEST_ADDR_OFFSET);
  packet.put(IPV6_ALL_NODES_ADDRESS);
  assertDrop(program,packet.array(),0);
  apfFilter.shutdown();
}
