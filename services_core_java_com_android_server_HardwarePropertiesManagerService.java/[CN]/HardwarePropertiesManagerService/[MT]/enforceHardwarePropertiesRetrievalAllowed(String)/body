{
  final PackageManager pm=mContext.getPackageManager();
  try {
    final int uid=pm.getPackageUid(callingPackage,0);
    if (Binder.getCallingUid() != uid) {
      throw new SecurityException("The caller has faked the package name.");
    }
  }
 catch (  PackageManager.NameNotFoundException e) {
    throw new SecurityException("The caller has faked the package name.");
  }
  final DevicePolicyManager dpm=mContext.getSystemService(DevicePolicyManager.class);
  if (!dpm.isDeviceOwnerApp(callingPackage) && !dpm.isProfileOwnerApp(callingPackage)) {
    throw new SecurityException("The caller is not a device or profile owner.");
  }
}
