{
  if (DEBUG) {
    Slog.v(TAG,"onRestoreFinished()");
  }
  final File infoStage=new File(getFilesDir(),INFO_STAGE);
  final File imageStage=new File(getFilesDir(),IMAGE_STAGE);
  try {
    if (imageStage.exists()) {
      if (DEBUG) {
        Slog.v(TAG,"Got restored wallpaper; renaming into place");
      }
      Os.rename(infoStage.getCanonicalPath(),mWallpaperInfo.getCanonicalPath());
      Os.rename(imageStage.getCanonicalPath(),mWallpaperFile.getCanonicalPath());
    }
  }
 catch (  Exception e) {
    Slog.e(TAG,"Unable to restore wallpaper: " + e.getMessage());
    mWm.clearWallpaper(WallpaperManager.FLAG_SYSTEM,UserHandle.USER_SYSTEM);
  }
 finally {
    if (DEBUG) {
      Slog.v(TAG,"Removing restore stage files");
    }
    infoStage.delete();
    imageStage.delete();
  }
}
