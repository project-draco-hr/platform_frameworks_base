{
synchronized (this) {
    final File legacy=getLegacyConfigFileWithTestOverride();
    if (readLegacyOwnerFile(legacy)) {
      if (DEBUG) {
        Log.d(TAG,"Legacy config file found.");
      }
      writeDeviceOwner();
      for (      int userId : getProfileOwnerKeys()) {
        writeProfileOwner(userId);
      }
      if (DEBUG) {
        Log.d(TAG,"Deleting legacy config file");
      }
      if (!legacy.delete()) {
        Slog.e(TAG,"Failed to remove the legacy setting file");
      }
      return;
    }
    new DeviceOwnerReadWriter().readFromFileLocked();
    final List<UserInfo> users=mUserManager.getUsers();
    for (    UserInfo ui : users) {
      new ProfileOwnerReadWriter(ui.id).readFromFileLocked();
    }
  }
}
