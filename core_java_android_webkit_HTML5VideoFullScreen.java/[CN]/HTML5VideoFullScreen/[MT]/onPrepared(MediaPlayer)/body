{
  super.onPrepared(mp);
  mVideoSurfaceView.setOnTouchListener(this);
  Metadata data=mp.getMetadata(MediaPlayer.METADATA_ALL,MediaPlayer.BYPASS_METADATA_FILTER);
  if (data != null) {
    mCanPause=!data.has(Metadata.PAUSE_AVAILABLE) || data.getBoolean(Metadata.PAUSE_AVAILABLE);
    mCanSeekBack=!data.has(Metadata.SEEK_BACKWARD_AVAILABLE) || data.getBoolean(Metadata.SEEK_BACKWARD_AVAILABLE);
    mCanSeekForward=!data.has(Metadata.SEEK_FORWARD_AVAILABLE) || data.getBoolean(Metadata.SEEK_FORWARD_AVAILABLE);
  }
 else {
    mCanPause=mCanSeekBack=mCanSeekForward=true;
  }
  if (mMediaController != null) {
    mMediaController.setEnabled(true);
  }
  if (mProgressView != null) {
    mProgressView.setVisibility(View.GONE);
  }
  mVideoWidth=mp.getVideoWidth();
  mVideoHeight=mp.getVideoHeight();
  mVideoSurfaceView.getHolder().setFixedSize(mVideoWidth,mVideoHeight);
  mProxy.dispatchOnRestoreState();
}
