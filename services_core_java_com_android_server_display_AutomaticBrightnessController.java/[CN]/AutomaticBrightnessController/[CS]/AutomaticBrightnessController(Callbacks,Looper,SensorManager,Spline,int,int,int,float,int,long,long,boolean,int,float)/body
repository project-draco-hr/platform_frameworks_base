{
  mCallbacks=callbacks;
  mTwilight=LocalServices.getService(TwilightManager.class);
  mSensorManager=sensorManager;
  mScreenAutoBrightnessSpline=autoBrightnessSpline;
  mScreenBrightnessRangeMinimum=brightnessMin;
  mScreenBrightnessRangeMaximum=brightnessMax;
  mLightSensorWarmUpTimeConfig=lightSensorWarmUpTime;
  mDozeScaleFactor=dozeScaleFactor;
  mLightSensorRate=lightSensorRate;
  mBrighteningLightDebounceConfig=brighteningLightDebounceConfig;
  mDarkeningLightDebounceConfig=darkeningLightDebounceConfig;
  mResetAmbientLuxAfterWarmUpConfig=resetAmbientLuxAfterWarmUpConfig;
  mAmbientLightHorizon=ambientLightHorizon;
  mWeightingIntercept=ambientLightHorizon;
  mScreenAutoBrightnessAdjustmentMaxGamma=autoBrightnessAdjustmentMaxGamma;
  mHandler=new AutomaticBrightnessHandler(looper);
  mAmbientLightRingBuffer=new AmbientLightRingBuffer(mLightSensorRate,mAmbientLightHorizon);
  mInitialHorizonAmbientLightRingBuffer=new AmbientLightRingBuffer(mLightSensorRate,mAmbientLightHorizon);
  if (!DEBUG_PRETEND_LIGHT_SENSOR_ABSENT) {
    mLightSensor=mSensorManager.getDefaultSensor(Sensor.TYPE_LIGHT);
  }
}
