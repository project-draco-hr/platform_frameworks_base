{
  if (puaString == null) {
    return null;
  }
  int minVsp=nativeGetMinimumAndroidPua(mNativeEmojiFactory);
  int maxVsp=nativeGetMaximumAndroidPua(mNativeEmojiFactory);
  int len=puaString.length();
  int[] codePoints=new int[puaString.codePointCount(0,len)];
  int new_len=0;
  for (int i=0; i < len; i=puaString.offsetByCodePoints(i,1), new_len++) {
    int codePoint=puaString.codePointAt(i);
    if (minVsp <= codePoint && codePoint <= maxVsp) {
      int newCodePoint=getVendorSpecificPuaFromAndroidPua(codePoint);
      if (newCodePoint > 0) {
        codePoints[new_len]=newCodePoint;
        continue;
      }
    }
    codePoints[new_len]=codePoint;
  }
  return new String(codePoints,0,new_len);
}
