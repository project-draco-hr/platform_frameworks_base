{
  if (vspString == null) {
    return null;
  }
  int minVsp=nativeGetMinimumVendorSpecificPua(mNativeEmojiFactory);
  int maxVsp=nativeGetMaximumVendorSpecificPua(mNativeEmojiFactory);
  int len=vspString.length();
  int[] codePoints=new int[vspString.codePointCount(0,len)];
  int new_len=0;
  for (int i=0; i < len; i=vspString.offsetByCodePoints(i,1), new_len++) {
    int codePoint=vspString.codePointAt(i);
    if (minVsp <= codePoint && codePoint <= maxVsp) {
      int newCodePoint=getAndroidPuaFromVendorSpecificPua(codePoint);
      if (newCodePoint > 0) {
        codePoints[new_len]=newCodePoint;
        continue;
      }
    }
    codePoints[new_len]=codePoint;
  }
  return new String(codePoints,0,new_len);
}
