{
  int callingUid=Binder.getCallingUid();
  int userHandle=UserHandle.getUserId(callingUid);
  if (mDpm != null) {
    long ident=Binder.clearCallingIdentity();
    try {
      ComponentName restrictionsProvider=mDpm.getRestrictionsProvider(userHandle);
      if (restrictionsProvider == null) {
        throw new IllegalStateException("Cannot fetch permission without a restrictions provider registered");
      }
      enforceCallerMatchesPackage(callingUid,packageName,"Package name does not" + " match caller ");
      Intent intent=new Intent();
      intent.setComponent(restrictionsProvider);
      new ProviderServiceConnection(intent,callback.asBinder(),userHandle){
        @Override public void run() throws RemoteException {
          if (DEBUG) {
            Log.i(LOG_TAG,"calling getPermissionResponse for " + packageName + ", id="+ requestId);
          }
          Bundle response=mRestrictionsProvider.getPermissionResponse(packageName,requestId);
          callback.onResponse(response);
        }
      }
.bind();
    }
  finally {
      Binder.restoreCallingIdentity(ident);
    }
  }
}
