{
  if (DEBUG) {
    Log.i(LOG_TAG,"requestPermission");
  }
  int callingUid=Binder.getCallingUid();
  int userHandle=UserHandle.getUserId(callingUid);
  if (mDpm != null) {
    long ident=Binder.clearCallingIdentity();
    try {
      ComponentName restrictionsProvider=mDpm.getRestrictionsProvider(userHandle);
      if (restrictionsProvider == null) {
        throw new IllegalStateException("Cannot request permission without a restrictions provider registered");
      }
      enforceCallerMatchesPackage(callingUid,packageName,"Package name does not" + " match caller ");
      Intent intent=new Intent(RestrictionsManager.ACTION_REQUEST_PERMISSION);
      intent.setComponent(restrictionsProvider);
      intent.putExtra(RestrictionsManager.EXTRA_PACKAGE_NAME,packageName);
      intent.putExtra(RestrictionsManager.EXTRA_REQUEST_TYPE,requestType);
      intent.putExtra(RestrictionsManager.EXTRA_REQUEST_ID,requestId);
      intent.putExtra(RestrictionsManager.EXTRA_REQUEST_BUNDLE,requestData);
      mContext.sendBroadcastAsUser(intent,new UserHandle(userHandle));
    }
  finally {
      Binder.restoreCallingIdentity(ident);
    }
  }
}
