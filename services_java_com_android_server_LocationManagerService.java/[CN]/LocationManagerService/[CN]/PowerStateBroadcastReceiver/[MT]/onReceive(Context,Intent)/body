{
  String action=intent.getAction();
  if (action.equals(ALARM_INTENT)) {
    mLocationHandler.removeMessages(MESSAGE_ACQUIRE_WAKE_LOCK);
    mLocationHandler.removeMessages(MESSAGE_RELEASE_WAKE_LOCK);
    log("PowerStateBroadcastReceiver: Alarm received");
    Message m=mLocationHandler.obtainMessage(MESSAGE_ACQUIRE_WAKE_LOCK);
    mLocationHandler.sendMessageAtFrontOfQueue(m);
  }
 else   if (action.equals(Intent.ACTION_SCREEN_OFF)) {
    log("PowerStateBroadcastReceiver: Screen off");
    updateWakelockStatus(false);
  }
 else   if (action.equals(Intent.ACTION_SCREEN_ON)) {
    log("PowerStateBroadcastReceiver: Screen on");
    updateWakelockStatus(true);
  }
 else   if (action.equals(Intent.ACTION_BATTERY_CHANGED)) {
    log("PowerStateBroadcastReceiver: Battery changed");
    int scale=intent.getIntExtra(BATTERY_EXTRA_SCALE,100);
    int level=intent.getIntExtra(BATTERY_EXTRA_LEVEL,0);
    boolean plugged=intent.getIntExtra(BATTERY_EXTRA_PLUGGED,0) != 0;
    if (mCollector != null) {
      mCollector.updateBatteryState(scale,level,plugged);
    }
  }
}
