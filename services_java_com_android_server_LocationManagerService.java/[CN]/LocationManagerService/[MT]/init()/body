{
  if (D)   Log.d(TAG,"init()");
  PowerManager powerManager=(PowerManager)mContext.getSystemService(Context.POWER_SERVICE);
  mWakeLock=powerManager.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK,WAKELOCK_KEY);
  mPackageManager=mContext.getPackageManager();
  mBlacklist=new LocationBlacklist(mContext,mLocationHandler);
  mBlacklist.init();
  mLocationFudger=new LocationFudger(mContext,mLocationHandler);
synchronized (mLock) {
    loadProvidersLocked();
  }
  mGeofenceManager=new GeofenceManager(mContext,mBlacklist);
  mContext.getContentResolver().registerContentObserver(Settings.Secure.getUriFor(Settings.Secure.LOCATION_PROVIDERS_ALLOWED),true,new ContentObserver(mLocationHandler){
    @Override public void onChange(    boolean selfChange){
synchronized (mLock) {
        updateProvidersLocked();
      }
    }
  }
);
  mPackageMonitor.register(mContext,Looper.myLooper(),true);
  IntentFilter intentFilter=new IntentFilter();
  intentFilter.addAction(Intent.ACTION_USER_SWITCHED);
  mContext.registerReceiverAsUser(new BroadcastReceiver(){
    @Override public void onReceive(    Context context,    Intent intent){
      String action=intent.getAction();
      if (Intent.ACTION_USER_SWITCHED.equals(action)) {
        switchUser(intent.getIntExtra(Intent.EXTRA_USER_HANDLE,0));
      }
    }
  }
,UserHandle.ALL,intentFilter,null,null);
  updateProvidersLocked();
}
