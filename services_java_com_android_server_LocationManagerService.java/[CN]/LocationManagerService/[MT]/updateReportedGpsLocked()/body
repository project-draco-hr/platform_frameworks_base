{
  if (mGpsLocationProvider == null) {
    return;
  }
  final String name=mGpsLocationProvider.getName();
  final int curSeq=mReportedGpsSeq;
  final int nextSeq=(curSeq + 1) >= 0 ? (curSeq + 1) : 0;
  mReportedGpsSeq=nextSeq;
  ArrayList<UpdateRecord> urs=mRecordsByProvider.get(name);
  int num=0;
  final int N=urs.size();
  for (int i=0; i < N; i++) {
    UpdateRecord ur=urs.get(i);
    if (ur.mReceiver == mProximityListener) {
      continue;
    }
    if (reportGpsUidLocked(curSeq,nextSeq,ur.mUid)) {
      num++;
    }
  }
  for (  ProximityAlert pe : mProximityAlerts.values()) {
    if (reportGpsUidLocked(curSeq,nextSeq,pe.mUid)) {
      num++;
    }
  }
  if (num != mReportedGpsUids.size()) {
    for (int i=mReportedGpsUids.size() - 1; i >= 0; i--) {
      if (mReportedGpsUids.valueAt(i) != nextSeq) {
        try {
          mBatteryStats.noteStopGps(mReportedGpsUids.keyAt(i));
        }
 catch (        RemoteException e) {
        }
        mReportedGpsUids.removeAt(i);
      }
    }
  }
}
