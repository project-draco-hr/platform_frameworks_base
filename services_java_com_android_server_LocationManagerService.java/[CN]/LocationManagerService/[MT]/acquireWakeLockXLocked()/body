{
  if (mWakeLock.isHeld()) {
    log("Must release wakelock before acquiring");
    mWakeLockAcquireTime=0;
    mWakeLock.release();
  }
  boolean networkActive=(mNetworkLocationProvider != null) && mNetworkLocationProvider.isLocationTracking();
  boolean gpsActive=(mGpsLocationProvider != null) && mGpsLocationProvider.isLocationTracking();
  boolean needsLock=networkActive || gpsActive;
  if (!needsLock) {
    log("No need for Lock!");
    return;
  }
  mWakeLockGpsReceived=!gpsActive;
  mWakeLockNetworkReceived=!networkActive;
  mWakeLock.acquire();
  mWakeLockAcquireTime=SystemClock.elapsedRealtime();
  log("Acquired wakelock");
  startGpsLocked();
  if (mCellWakeLockAcquired) {
  }
 else   if (!mWakeLockNetworkReceived) {
    mTelephonyManager.enableLocationUpdates();
    mCellWakeLockAcquired=true;
  }
 else {
    mCellWakeLockAcquired=false;
  }
  if (mNetworkLocationInterface != null) {
    mNetworkLocationInterface.updateCellLockStatus(mCellWakeLockAcquired);
  }
  WifiManager.WifiLock wifiLock=getWifiWakelockLocked();
  if (wifiLock != null) {
    if (mWifiWakeLockAcquired) {
    }
 else     if (mWifiManager.isWifiEnabled() && !mWakeLockNetworkReceived) {
      wifiLock.acquire();
      mWifiWakeLockAcquired=true;
    }
 else {
      mWifiWakeLockAcquired=false;
      Log.w(TAG,"acquireWakeLock(): Unable to get WiFi lock");
    }
  }
}
