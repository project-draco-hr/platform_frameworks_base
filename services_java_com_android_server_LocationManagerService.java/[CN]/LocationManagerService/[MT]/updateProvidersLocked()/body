{
  boolean changesMade=false;
  for (int i=mProviders.size() - 1; i >= 0; i--) {
    LocationProviderInterface p=mProviders.get(i);
    boolean isEnabled=p.isEnabled();
    String name=p.getName();
    boolean shouldBeEnabled=isAllowedByCurrentUserSettingsLocked(name);
    if (isEnabled && !shouldBeEnabled) {
      updateProviderListenersLocked(name,false,mCurrentUserId);
      mLastLocation.clear();
      mLastLocationCoarseInterval.clear();
      changesMade=true;
    }
 else     if (!isEnabled && shouldBeEnabled) {
      updateProviderListenersLocked(name,true,mCurrentUserId);
      changesMade=true;
    }
  }
  if (changesMade) {
    mContext.sendBroadcastAsUser(new Intent(LocationManager.PROVIDERS_CHANGED_ACTION),UserHandle.ALL);
  }
}
