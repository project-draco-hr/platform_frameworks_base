{
  if (Config.LOGD) {
    Log.d(TAG,"addProximityAlert: latitude = " + latitude + ", longitude = "+ longitude+ ", expiration = "+ expiration+ ", intent = "+ intent);
  }
  if (!isAllowedProvider(LocationManager.GPS_PROVIDER) || !isAllowedProvider(LocationManager.NETWORK_PROVIDER)) {
    throw new SecurityException("Requires ACCESS_FINE_LOCATION permission");
  }
  if (expiration != -1) {
    expiration+=System.currentTimeMillis();
  }
  ProximityAlert alert=new ProximityAlert(latitude,longitude,radius,expiration,intent);
  mProximityAlerts.put(intent,alert);
  if (mProximityListener == null) {
    mProximityListener=new ProximityListener();
    LocationProvider provider=LocationProviderImpl.getProvider(LocationManager.GPS_PROVIDER);
    if (provider != null) {
      _requestLocationUpdates(provider.getName(),1000L,1.0f,mProximityListener);
    }
    provider=LocationProviderImpl.getProvider(LocationManager.NETWORK_PROVIDER);
    if (provider != null) {
      _requestLocationUpdates(provider.getName(),1000L,1.0f,mProximityListener);
    }
  }
}
