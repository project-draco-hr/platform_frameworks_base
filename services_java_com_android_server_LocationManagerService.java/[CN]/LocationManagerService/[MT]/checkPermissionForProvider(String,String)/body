{
  String minPerm=getMinimumPermissionForProvider(provider);
  if (!isPermissionSufficient(perm,minPerm)) {
    if (ACCESS_FINE_LOCATION.equals(minPerm)) {
      throw new SecurityException("Location provider \"" + provider + "\" requires ACCESS_FINE_LOCATION permission.");
    }
 else     if (ACCESS_COARSE_LOCATION.equals(minPerm)) {
      throw new SecurityException("Location provider \"" + provider + "\" requires ACCESS_COARSE_LOCATION or ACCESS_FINE_LOCATION permission.");
    }
 else {
      throw new SecurityException("Insufficient permission for location provider \"" + provider + "\".");
    }
  }
}
