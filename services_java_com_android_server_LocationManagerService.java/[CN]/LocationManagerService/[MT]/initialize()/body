{
  PowerManager powerManager=(PowerManager)mContext.getSystemService(Context.POWER_SERVICE);
  mWakeLock=powerManager.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK,WAKELOCK_KEY);
  mPackageManager=mContext.getPackageManager();
  loadProviders();
  IntentFilter intentFilter=new IntentFilter();
  intentFilter.addAction(ConnectivityManager.CONNECTIVITY_ACTION);
  intentFilter.addAction(Intent.ACTION_PACKAGE_REMOVED);
  intentFilter.addAction(Intent.ACTION_PACKAGE_RESTARTED);
  intentFilter.addAction(Intent.ACTION_QUERY_PACKAGE_RESTART);
  mContext.registerReceiver(mBroadcastReceiver,intentFilter);
  IntentFilter sdFilter=new IntentFilter(Intent.ACTION_EXTERNAL_APPLICATIONS_UNAVAILABLE);
  mContext.registerReceiver(mBroadcastReceiver,sdFilter);
  ContentResolver resolver=mContext.getContentResolver();
  Cursor settingsCursor=resolver.query(Settings.Secure.CONTENT_URI,null,"(" + NameValueTable.NAME + "=?)",new String[]{Settings.Secure.LOCATION_PROVIDERS_ALLOWED},null);
  mSettings=new ContentQueryMap(settingsCursor,NameValueTable.NAME,true,mLocationHandler);
  SettingsObserver settingsObserver=new SettingsObserver();
  mSettings.addObserver(settingsObserver);
}
