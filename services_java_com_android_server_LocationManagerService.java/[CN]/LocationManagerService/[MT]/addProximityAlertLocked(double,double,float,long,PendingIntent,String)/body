{
  if (LOCAL_LOGV) {
    Slog.v(TAG,"addProximityAlert: latitude = " + latitude + ", longitude = "+ longitude+ ", expiration = "+ expiration+ ", intent = "+ intent);
  }
  checkPackageName(Binder.getCallingUid(),packageName);
  if (!isAllowedProviderSafe(LocationManager.GPS_PROVIDER) || !isAllowedProviderSafe(LocationManager.NETWORK_PROVIDER)) {
    throw new SecurityException("Requires ACCESS_FINE_LOCATION permission");
  }
  if (expiration != -1) {
    expiration+=System.currentTimeMillis();
  }
  ProximityAlert alert=new ProximityAlert(Binder.getCallingUid(),latitude,longitude,radius,expiration,intent,packageName);
  mProximityAlerts.put(intent,alert);
  if (mProximityReceiver == null) {
    mProximityListener=new ProximityListener();
    mProximityReceiver=new Receiver(mProximityListener,packageName);
    for (int i=mProviders.size() - 1; i >= 0; i--) {
      LocationProviderInterface provider=mProviders.get(i);
      requestLocationUpdatesLocked(provider.getName(),1000L,1.0f,false,mProximityReceiver);
    }
  }
}
