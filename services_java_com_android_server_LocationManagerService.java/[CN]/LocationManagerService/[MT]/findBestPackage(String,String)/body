{
  Intent intent=new Intent(serviceIntentName);
  List<ResolveInfo> infos=mPackageManager.queryIntentServices(intent,PackageManager.GET_META_DATA);
  if (infos == null)   return null;
  int bestVersion=Integer.MIN_VALUE;
  String bestPackage=null;
  for (  ResolveInfo info : infos) {
    String packageName=info.serviceInfo.packageName;
    if (mPackageManager.checkSignatures(packageName,sigPackageName) != PackageManager.SIGNATURE_MATCH) {
      Slog.w(TAG,packageName + " implements " + serviceIntentName+ " but its signatures don't match those in "+ sigPackageName+ ", ignoring");
      continue;
    }
    int version=0;
    if (info.serviceInfo.metaData != null) {
      version=info.serviceInfo.metaData.getInt("version",0);
    }
    if (LOCAL_LOGV)     Slog.v(TAG,packageName + " implements " + serviceIntentName+ " with version "+ version);
    if (version > bestVersion) {
      bestVersion=version;
      bestPackage=packageName;
    }
  }
  return bestPackage;
}
