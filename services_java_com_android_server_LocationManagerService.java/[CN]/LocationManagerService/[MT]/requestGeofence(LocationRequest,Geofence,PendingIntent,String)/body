{
  if (request == null)   request=DEFAULT_LOCATION_REQUEST;
  int allowedResolutionLevel=getCallerAllowedResolutionLevel();
  checkResolutionLevelIsSufficientForGeofenceUse(allowedResolutionLevel);
  checkPendingIntent(intent);
  checkPackageName(packageName);
  checkResolutionLevelIsSufficientForProviderUse(allowedResolutionLevel,request.getProvider());
  LocationRequest sanitizedRequest=createSanitizedRequest(request,allowedResolutionLevel);
  if (D)   Log.d(TAG,"requestGeofence: " + sanitizedRequest + " "+ geofence+ " "+ intent);
  int uid=Binder.getCallingUid();
  long identity=Binder.clearCallingIdentity();
  try {
    mGeofenceManager.addFence(sanitizedRequest,geofence,intent,uid,packageName);
  }
  finally {
    Binder.restoreCallingIdentity(identity);
  }
}
