{
  super();
  mContext=context;
  mLocationHandler=new LocationWorkerHandler();
  if (LOCAL_LOGV) {
    Log.v(TAG,"Constructed LocationManager Service");
  }
  mAlarmManager=(AlarmManager)context.getSystemService(Context.ALARM_SERVICE);
  PowerManager powerManager=(PowerManager)mContext.getSystemService(Context.POWER_SERVICE);
  mWakeLock=powerManager.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK,WAKELOCK_KEY);
  loadProviders();
  NetworkStateBroadcastReceiver networkReceiver=new NetworkStateBroadcastReceiver();
  IntentFilter networkIntentFilter=new IntentFilter();
  networkIntentFilter.addAction(ConnectivityManager.CONNECTIVITY_ACTION);
  networkIntentFilter.addAction(GpsLocationProvider.GPS_ENABLED_CHANGE_ACTION);
  context.registerReceiver(networkReceiver,networkIntentFilter);
  PowerStateBroadcastReceiver powerStateReceiver=new PowerStateBroadcastReceiver();
  IntentFilter intentFilter=new IntentFilter();
  intentFilter.addAction(ALARM_INTENT);
  intentFilter.addAction(Intent.ACTION_SCREEN_OFF);
  intentFilter.addAction(Intent.ACTION_SCREEN_ON);
  intentFilter.addAction(Intent.ACTION_PACKAGE_REMOVED);
  intentFilter.addAction(Intent.ACTION_PACKAGE_RESTARTED);
  context.registerReceiver(powerStateReceiver,intentFilter);
  ContentResolver resolver=mContext.getContentResolver();
  Cursor settingsCursor=resolver.query(Settings.Secure.CONTENT_URI,null,"(" + Settings.System.NAME + "=?)",new String[]{Settings.Secure.LOCATION_PROVIDERS_ALLOWED},null);
  mSettings=new ContentQueryMap(settingsCursor,Settings.System.NAME,true,mLocationHandler);
  SettingsObserver settingsObserver=new SettingsObserver();
  mSettings.addObserver(settingsObserver);
}
