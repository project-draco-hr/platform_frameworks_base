{
  SystemServicesProxy ssp=mSystemServicesProxy;
  List<ActivityManager.RecentTaskInfo> recentTasks=ssp.getRecentTasks(3,UserHandle.CURRENT.getIdentifier());
  Rect taskRect=getAnimationTaskRect(recentTasks);
  boolean useThumbnailTransition=!isTopTaskHome && hasValidTaskRects();
  boolean hasRecentTasks=!recentTasks.isEmpty();
  if (useThumbnailTransition) {
    ActivityOptions opts=getThumbnailTransitionActivityOptions(taskRect);
    if (opts != null) {
      if (sLastScreenshot != null) {
        startAlternateRecentsActivity(opts,EXTRA_FROM_APP_FULL_SCREENSHOT);
      }
 else {
        startAlternateRecentsActivity(opts,EXTRA_FROM_APP_THUMBNAIL);
      }
    }
 else {
      useThumbnailTransition=false;
    }
  }
 else {
    if (hasRecentTasks) {
      ActivityOptions opts=getHomeTransitionActivityOptions();
      startAlternateRecentsActivity(opts,EXTRA_FROM_HOME);
    }
 else {
      ActivityOptions opts=getUnknownTransitionActivityOptions();
      startAlternateRecentsActivity(opts,null);
    }
  }
  if (Console.Enabled) {
    Console.logTraceTime(Constants.Log.App.TimeRecentsStartup,Constants.Log.App.TimeRecentsStartupKey,"startRecentsActivity");
  }
  mLastToggleTime=System.currentTimeMillis();
}
