{
  Bitmap thumbnail;
  Bitmap firstThumbnail=loadFirstTaskThumbnail();
  if (firstThumbnail != null) {
    thumbnail=Bitmap.createBitmap(taskRect.width(),taskRect.height(),Bitmap.Config.ARGB_8888);
    int size=Math.min(firstThumbnail.getWidth(),firstThumbnail.getHeight());
    Canvas c=new Canvas(thumbnail);
    c.drawBitmap(firstThumbnail,new Rect(0,0,size,size),new Rect(0,0,taskRect.width(),taskRect.height()),null);
    c.setBitmap(null);
    firstThumbnail.recycle();
  }
 else {
    WindowManager wm=(WindowManager)mContext.getSystemService(Context.WINDOW_SERVICE);
    Display display=wm.getDefaultDisplay();
    Bitmap screenshot=takeScreenshot(display);
    if (screenshot != null) {
      Resources res=mContext.getResources();
      int size=Math.min(screenshot.getWidth(),screenshot.getHeight());
      int statusBarHeight=res.getDimensionPixelSize(com.android.internal.R.dimen.status_bar_height);
      thumbnail=Bitmap.createBitmap(taskRect.width(),taskRect.height(),Bitmap.Config.ARGB_8888);
      Canvas c=new Canvas(thumbnail);
      c.drawBitmap(screenshot,new Rect(0,statusBarHeight,size,statusBarHeight + size),new Rect(0,0,taskRect.width(),taskRect.height()),null);
      c.setBitmap(null);
      screenshot.recycle();
    }
 else {
      return null;
    }
  }
  return ActivityOptions.makeThumbnailScaleDownAnimation(mStatusBarView,thumbnail,taskRect.left,taskRect.top,this);
}
