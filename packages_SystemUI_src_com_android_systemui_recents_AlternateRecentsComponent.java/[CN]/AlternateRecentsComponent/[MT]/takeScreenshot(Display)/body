{
  DisplayMetrics dm=new DisplayMetrics();
  display.getRealMetrics(dm);
  float[] dims={dm.widthPixels,dm.heightPixels};
  float degrees=getDegreesForRotation(display.getRotation());
  boolean requiresRotation=(degrees > 0);
  if (requiresRotation) {
    Matrix m=new Matrix();
    m.preRotate(-degrees);
    m.mapPoints(dims);
    dims[0]=Math.abs(dims[0]);
    dims[1]=Math.abs(dims[1]);
  }
  return SurfaceControl.screenshot((int)dims[0],(int)dims[1]);
}
