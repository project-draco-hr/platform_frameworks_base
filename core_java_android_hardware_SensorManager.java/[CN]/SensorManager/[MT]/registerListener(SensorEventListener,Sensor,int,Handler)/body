{
  if (listener == null || sensor == null) {
    return false;
  }
  boolean result;
  int delay=-1;
switch (rate) {
case SENSOR_DELAY_FASTEST:
    delay=0;
  break;
case SENSOR_DELAY_GAME:
delay=20000;
break;
case SENSOR_DELAY_UI:
delay=60000;
break;
case SENSOR_DELAY_NORMAL:
delay=200000;
break;
default :
delay=rate;
break;
}
synchronized (sListeners) {
ListenerDelegate l=null;
for (ListenerDelegate i : sListeners) {
if (i.getListener() == listener) {
l=i;
break;
}
}
String name=sensor.getName();
int handle=sensor.getHandle();
if (l == null) {
result=false;
l=new ListenerDelegate(listener,sensor,handler);
sListeners.add(l);
if (!sListeners.isEmpty()) {
result=sSensorThread.startLocked();
if (result) {
result=sensors_enable_sensor(sQueue,name,handle,delay);
if (!result) {
sListeners.remove(l);
}
}
}
}
 else {
result=sensors_enable_sensor(sQueue,name,handle,delay);
if (result) {
l.addSensor(sensor);
}
}
}
return result;
}
