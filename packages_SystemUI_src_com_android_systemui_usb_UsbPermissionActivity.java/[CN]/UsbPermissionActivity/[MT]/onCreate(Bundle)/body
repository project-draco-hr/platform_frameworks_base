{
  super.onCreate(icicle);
  Intent intent=getIntent();
  mDevice=(UsbDevice)intent.getParcelableExtra(UsbManager.EXTRA_DEVICE);
  mAccessory=(UsbAccessory)intent.getParcelableExtra(UsbManager.EXTRA_ACCESSORY);
  mPendingIntent=(PendingIntent)intent.getParcelableExtra(Intent.EXTRA_INTENT);
  mUid=intent.getIntExtra("uid",0);
  mPackageName=intent.getStringExtra("package");
  PackageManager packageManager=getPackageManager();
  ApplicationInfo aInfo;
  try {
    aInfo=packageManager.getApplicationInfo(mPackageName,0);
  }
 catch (  PackageManager.NameNotFoundException e) {
    Log.e(TAG,"unable to look up package name",e);
    finish();
    return;
  }
  String appName=aInfo.loadLabel(packageManager).toString();
  final AlertController.AlertParams ap=mAlertParams;
  ap.mIcon=aInfo.loadIcon(packageManager);
  ap.mTitle=appName;
  if (mDevice == null) {
    ap.mMessage=getString(R.string.usb_accessory_permission_prompt,appName);
    mDisconnectedReceiver=new UsbDisconnectedReceiver(this,mAccessory);
  }
 else {
    ap.mMessage=getString(R.string.usb_device_permission_prompt,appName);
    mDisconnectedReceiver=new UsbDisconnectedReceiver(this,mDevice);
  }
  ap.mPositiveButtonText=getString(android.R.string.ok);
  ap.mNegativeButtonText=getString(android.R.string.cancel);
  ap.mPositiveButtonListener=this;
  ap.mNegativeButtonListener=this;
  LayoutInflater inflater=(LayoutInflater)getSystemService(Context.LAYOUT_INFLATER_SERVICE);
  ap.mView=inflater.inflate(com.android.internal.R.layout.always_use_checkbox,null);
  mAlwaysUse=(CheckBox)ap.mView.findViewById(com.android.internal.R.id.alwaysUse);
  if (mDevice == null) {
    mAlwaysUse.setText(R.string.always_use_accessory);
  }
 else {
    mAlwaysUse.setText(R.string.always_use_device);
  }
  mAlwaysUse.setOnCheckedChangeListener(this);
  mClearDefaultHint=(TextView)ap.mView.findViewById(com.android.internal.R.id.clearDefaultHint);
  mClearDefaultHint.setVisibility(View.GONE);
  setupAlert();
}
