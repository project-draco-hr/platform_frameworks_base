{
  checkForSubscriberId();
  boolean startNewPeriod=true;
  if (end.before(mPeriodStart)) {
    if (DBG) {
      Slog.d(TAG,"next period (" + start.getTimeInMillis() + ","+ end.getTimeInMillis()+ ") - old start was "+ mPeriodStart.getTimeInMillis()+ ", wiping");
    }
synchronized (mParent) {
      mPeriodRxData[mCurrentPeriod]=0;
      mPeriodTxData[mCurrentPeriod]=0;
    }
  }
 else   if (start.after(mPeriodEnd)) {
    if (DBG) {
      Slog.d(TAG,"next period (" + start.getTimeInMillis() + ","+ end.getTimeInMillis()+ ") - old end was "+ mPeriodEnd.getTimeInMillis()+ ", following");
    }
synchronized (mParent) {
      ++mCurrentPeriod;
      if (mCurrentPeriod >= mPeriodCount)       mCurrentPeriod=0;
      mPeriodRxData[mCurrentPeriod]=0;
      mPeriodTxData[mCurrentPeriod]=0;
    }
  }
 else {
    startNewPeriod=false;
    if (DBG) {
      Slog.d(TAG,"next period (" + start.getTimeInMillis() + ","+ end.getTimeInMillis()+ ") - we fit - ammending to last period");
    }
  }
  setPeriodStart(start);
  setPeriodEnd(end);
  record();
  return startNewPeriod;
}
