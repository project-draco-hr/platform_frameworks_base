{
  if (VDBG || (mPolicyThreshold.get() != 0)) {
    Slog.d(TAG,"onResetAlarm - last period had " + mRecorder.getPeriodRx(0) + " bytes read and "+ mRecorder.getPeriodTx(0)+ " written");
  }
  if (mTime.getCacheAge() > mMaxNtpCacheAge) {
    mTime.forceRefresh();
  }
  if (mTime.hasCache()) {
    final long now=mTime.currentTimeMillis();
    Calendar end=calculatePeriodEnd(now);
    Calendar start=calculatePeriodStart(end);
    if (mRecorder.setNextPeriod(start,end)) {
      onPollAlarm();
    }
    mAlarmManager.cancel(mPendingResetIntent);
    long offset=end.getTimeInMillis() - now;
    mAlarmManager.set(AlarmManager.ELAPSED_REALTIME,SystemClock.elapsedRealtime() + offset,mPendingResetIntent);
  }
 else {
    if (VDBG)     Slog.d(TAG,"no trusted time, not resetting period");
  }
}
