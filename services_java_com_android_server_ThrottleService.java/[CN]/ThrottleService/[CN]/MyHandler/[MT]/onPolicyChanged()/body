{
  boolean testing=SystemProperties.get(TESTING_ENABLED_PROPERTY).equals("true");
  int pollingPeriod=mContext.getResources().getInteger(R.integer.config_datause_polling_period_sec);
  mPolicyPollPeriodSec=Settings.Secure.getInt(mContext.getContentResolver(),Settings.Secure.THROTTLE_POLLING_SEC,pollingPeriod);
  long defaultThreshold=mContext.getResources().getInteger(R.integer.config_datause_threshold_bytes);
  int defaultValue=mContext.getResources().getInteger(R.integer.config_datause_throttle_kbitsps);
synchronized (ThrottleService.this) {
    mPolicyThreshold=Settings.Secure.getLong(mContext.getContentResolver(),Settings.Secure.THROTTLE_THRESHOLD_BYTES,defaultThreshold);
    mPolicyThrottleValue=Settings.Secure.getInt(mContext.getContentResolver(),Settings.Secure.THROTTLE_VALUE_KBITSPS,defaultValue);
    if (testing) {
      mPolicyPollPeriodSec=TESTING_POLLING_PERIOD_SEC;
      mPolicyThreshold=TESTING_THRESHOLD;
    }
  }
  mPolicyResetDay=Settings.Secure.getInt(mContext.getContentResolver(),Settings.Secure.THROTTLE_RESET_DAY,-1);
  if (mPolicyResetDay == -1 || ((mPolicyResetDay < 1) || (mPolicyResetDay > 28))) {
    Random g=new Random();
    mPolicyResetDay=1 + g.nextInt(28);
    Settings.Secure.putInt(mContext.getContentResolver(),Settings.Secure.THROTTLE_RESET_DAY,mPolicyResetDay);
  }
synchronized (ThrottleService.this) {
    if (mIface == null) {
      mPolicyThreshold=0;
    }
  }
  int defaultNotificationType=mContext.getResources().getInteger(R.integer.config_datause_notification_type);
  mPolicyNotificationsAllowedMask=Settings.Secure.getInt(mContext.getContentResolver(),Settings.Secure.THROTTLE_NOTIFICATION_TYPE,defaultNotificationType);
  mMaxNtpCacheAgeSec=Settings.Secure.getInt(mContext.getContentResolver(),Settings.Secure.THROTTLE_MAX_NTP_CACHE_AGE_SEC,MAX_NTP_CACHE_AGE_SEC);
  if (VDBG || (mPolicyThreshold != 0)) {
    Slog.d(TAG,"onPolicyChanged testing=" + testing + ", period="+ mPolicyPollPeriodSec+ ", threshold="+ mPolicyThreshold+ ", value="+ mPolicyThrottleValue+ ", resetDay="+ mPolicyResetDay+ ", noteType="+ mPolicyNotificationsAllowedMask+ ", maxNtpCacheAge="+ mMaxNtpCacheAgeSec);
  }
  mThrottleIndex=THROTTLE_INDEX_UNINITIALIZED;
  onResetAlarm();
  onPollAlarm();
  Intent broadcast=new Intent(ThrottleManager.POLICY_CHANGED_ACTION);
  mContext.sendBroadcast(broadcast);
}
