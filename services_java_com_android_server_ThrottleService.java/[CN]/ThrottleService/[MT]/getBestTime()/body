{
  SntpClient client=new SntpClient();
  long time;
  if ((mNtpServer != null) && client.requestTime(mNtpServer,10000)) {
    time=client.getNtpTime();
    if (!mNtpActive) {
      mNtpActive=true;
      if (DBG)       Slog.d(TAG,"found Authoritative time - reseting alarm");
      mHandler.obtainMessage(EVENT_RESET_ALARM).sendToTarget();
    }
    if (DBG)     Slog.d(TAG,"using Authoritative time: " + time);
  }
 else {
    time=System.currentTimeMillis();
    if (DBG)     Slog.d(TAG,"using User time: " + time);
    mNtpActive=false;
  }
  return time;
}
