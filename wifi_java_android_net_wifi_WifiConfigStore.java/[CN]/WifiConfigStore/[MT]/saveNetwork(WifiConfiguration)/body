{
  boolean newNetwork=(config.networkId == INVALID_NETWORK_ID);
  NetworkUpdateResult result=addOrUpdateNetworkNative(config);
  int netId=result.getNetworkId();
  if (newNetwork && netId != INVALID_NETWORK_ID) {
    WifiNative.enableNetworkCommand(netId,false);
synchronized (sConfiguredNetworks) {
      sConfiguredNetworks.get(netId).status=Status.ENABLED;
    }
  }
  WifiNative.saveConfigCommand();
  sendConfiguredNetworksChangedBroadcast(config,result.isNewNetwork() ? WifiManager.CHANGE_REASON_ADDED : WifiManager.CHANGE_REASON_CONFIG_CHANGE);
  return result;
}
