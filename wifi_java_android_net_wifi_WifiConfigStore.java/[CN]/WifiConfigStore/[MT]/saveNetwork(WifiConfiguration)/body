{
  if (config == null || (config.networkId == INVALID_NETWORK_ID && config.SSID == null)) {
    return new NetworkUpdateResult(INVALID_NETWORK_ID);
  }
  boolean newNetwork=(config.networkId == INVALID_NETWORK_ID);
  NetworkUpdateResult result=addOrUpdateNetworkNative(config);
  int netId=result.getNetworkId();
  if (newNetwork && netId != INVALID_NETWORK_ID) {
    mWifiNative.enableNetwork(netId,false);
    mConfiguredNetworks.get(netId).status=Status.ENABLED;
  }
  mWifiNative.saveConfig();
  sendConfiguredNetworksChangedBroadcast(config,result.isNewNetwork() ? WifiManager.CHANGE_REASON_ADDED : WifiManager.CHANGE_REASON_CONFIG_CHANGE);
  return result;
}
