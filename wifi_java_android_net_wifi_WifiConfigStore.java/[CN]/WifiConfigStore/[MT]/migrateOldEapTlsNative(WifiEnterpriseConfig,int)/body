{
  String oldPrivateKey=mWifiNative.getNetworkVariable(netId,OLD_PRIVATE_KEY_NAME);
  if (TextUtils.isEmpty(oldPrivateKey)) {
    return false;
  }
 else {
    oldPrivateKey=removeDoubleQuotes(oldPrivateKey);
    if (TextUtils.isEmpty(oldPrivateKey)) {
      return false;
    }
  }
  config.setFieldValue(ENGINE_KEY,ENGINE_ENABLE);
  config.setFieldValue(ENGINE_ID_KEY,ENGINE_ID_KEYSTORE);
  final String keyName;
  if (oldPrivateKey.startsWith(KEYSTORE_URI)) {
    keyName=new String(oldPrivateKey.substring(KEYSTORE_URI.length()));
  }
 else {
    keyName=oldPrivateKey;
  }
  config.setFieldValue(PRIVATE_KEY_ID_KEY,keyName);
  mWifiNative.setNetworkVariable(netId,ENGINE_KEY,config.getFieldValue(ENGINE_KEY,""));
  mWifiNative.setNetworkVariable(netId,ENGINE_ID_KEY,config.getFieldValue(ENGINE_ID_KEY,""));
  mWifiNative.setNetworkVariable(netId,PRIVATE_KEY_ID_KEY,config.getFieldValue(PRIVATE_KEY_ID_KEY,""));
  mWifiNative.setNetworkVariable(netId,OLD_PRIVATE_KEY_NAME,EMPTY_VALUE);
  return true;
}
