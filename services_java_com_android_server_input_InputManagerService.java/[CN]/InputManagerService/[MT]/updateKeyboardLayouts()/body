{
  final HashSet<String> availableKeyboardLayouts=new HashSet<String>();
  visitAllKeyboardLayouts(new KeyboardLayoutVisitor(){
    @Override public void visitKeyboardLayout(    Resources resources,    String descriptor,    String label,    String collection,    int keyboardLayoutResId){
      availableKeyboardLayouts.add(descriptor);
    }
  }
);
synchronized (mDataStore) {
    try {
      mDataStore.removeUninstalledKeyboardLayouts(availableKeyboardLayouts);
    }
  finally {
      mDataStore.saveIfNeeded();
    }
  }
  reloadKeyboardLayouts();
}
