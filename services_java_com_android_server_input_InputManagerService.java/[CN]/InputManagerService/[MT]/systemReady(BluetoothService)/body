{
  if (DEBUG) {
    Slog.d(TAG,"System ready.");
  }
  mBluetoothService=bluetoothService;
  mSystemReady=true;
  IntentFilter filter=new IntentFilter(Intent.ACTION_PACKAGE_ADDED);
  filter.addAction(Intent.ACTION_PACKAGE_REMOVED);
  filter.addAction(Intent.ACTION_PACKAGE_CHANGED);
  filter.addDataScheme("package");
  mContext.registerReceiver(new BroadcastReceiver(){
    @Override public void onReceive(    Context context,    Intent intent){
      if (DEBUG) {
        Slog.d(TAG,"Packages changed, reloading keyboard layouts.");
      }
      reloadKeyboardLayouts();
    }
  }
,filter,null,mHandler);
  filter=new IntentFilter(BluetoothDevice.ACTION_ALIAS_CHANGED);
  mContext.registerReceiver(new BroadcastReceiver(){
    @Override public void onReceive(    Context context,    Intent intent){
      if (DEBUG) {
        Slog.d(TAG,"Bluetooth alias changed, reloading device names.");
      }
      reloadDeviceAliases();
    }
  }
,filter,null,mHandler);
  reloadKeyboardLayouts();
  reloadDeviceAliases();
}
