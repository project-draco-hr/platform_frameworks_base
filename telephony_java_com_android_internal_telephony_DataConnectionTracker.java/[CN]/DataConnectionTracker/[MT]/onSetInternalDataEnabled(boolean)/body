{
synchronized (mDataEnabledLock) {
    final boolean prevEnabled=getAnyDataEnabled();
    if (mInternalDataEnabled != enabled) {
      mInternalDataEnabled=enabled;
      if (prevEnabled != getAnyDataEnabled()) {
        if (!prevEnabled) {
          resetAllRetryCounts();
          onTrySetupData(Phone.REASON_DATA_ENABLED);
        }
 else {
          cleanUpAllConnections(null);
        }
      }
    }
  }
}
