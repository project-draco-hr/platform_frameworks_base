{
  boolean prevEnabled=getAnyDataEnabled();
  if (mDataEnabled != enable) {
synchronized (this) {
      mDataEnabled=enable;
    }
    Settings.Secure.putInt(mPhone.getContext().getContentResolver(),Settings.Secure.MOBILE_DATA,enable ? 1 : 0);
    if (prevEnabled != getAnyDataEnabled()) {
      if (!prevEnabled) {
        resetAllRetryCounts();
        onTrySetupData(Phone.REASON_DATA_ENABLED);
      }
 else {
        onCleanUpAllConnections(Phone.REASON_DATA_DISABLED);
      }
    }
  }
}
