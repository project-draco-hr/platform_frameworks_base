{
  boolean txUpdated=false, rxUpdated=false;
  long txSum=0, rxSum=0;
  for (  ApnContext apnContext : mApnContexts.values()) {
    if (apnContext.getState() == State.CONNECTED) {
      DataConnectionAc dcac=apnContext.getDataConnectionAc();
      if (dcac == null)       continue;
      LinkProperties linkProp=dcac.getLinkPropertiesSync();
      if (linkProp == null)       continue;
      String iface=linkProp.getInterfaceName();
      if (iface != null) {
        long stats=TrafficStats.getTxPackets(iface);
        if (stats > 0) {
          txUpdated=true;
          txSum+=stats;
        }
        stats=TrafficStats.getRxPackets(iface);
        if (stats > 0) {
          rxUpdated=true;
          rxSum+=stats;
        }
      }
    }
  }
  if (txUpdated)   this.txPkts=txSum;
  if (rxUpdated)   this.rxPkts=rxSum;
}
