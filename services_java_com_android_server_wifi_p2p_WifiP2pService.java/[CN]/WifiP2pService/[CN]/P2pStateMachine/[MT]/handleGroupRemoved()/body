{
  if (mGroup.isGroupOwner()) {
    stopDhcpServer(mGroup.getInterface());
  }
 else {
    if (DBG)     logd("stop DHCP client");
    mDhcpStateMachine.sendMessage(DhcpStateMachine.CMD_STOP_DHCP);
    mDhcpStateMachine.doQuit();
    mDhcpStateMachine=null;
  }
  try {
    mNwService.clearInterfaceAddresses(mGroup.getInterface());
  }
 catch (  Exception e) {
    loge("Failed to clear addresses " + e);
  }
  NetworkUtils.resetConnections(mGroup.getInterface(),NetworkUtils.RESET_ALL_ADDRESSES);
  mWifiNative.setP2pGroupIdle(mGroup.getInterface(),0);
  boolean peersChanged=false;
  for (  WifiP2pDevice d : mGroup.getClientList()) {
    if (mPeers.remove(d))     peersChanged=true;
  }
  if (mPeers.remove(mGroup.getOwner()))   peersChanged=true;
  if (mPeers.remove(mPeersLostDuringConnection))   peersChanged=true;
  if (peersChanged) {
    sendPeersChangedBroadcast();
  }
  mGroup=null;
  mPeersLostDuringConnection.clear();
  mServiceDiscReqId=null;
  if (mTempoarilyDisconnectedWifi) {
    mWifiChannel.sendMessage(WifiP2pService.DISCONNECT_WIFI_REQUEST,0);
    mTempoarilyDisconnectedWifi=false;
  }
}
