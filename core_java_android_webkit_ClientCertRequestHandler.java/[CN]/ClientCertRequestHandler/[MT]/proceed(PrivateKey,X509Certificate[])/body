{
  try {
    byte[][] chainBytes=NativeCrypto.encodeCertificates(chain);
    mTable.Allow(mHostAndPort,privateKey,chainBytes);
    if (privateKey instanceof OpenSSLRSAPrivateKey) {
      setSslClientCertFromCtx(((OpenSSLRSAPrivateKey)privateKey).getPkeyContext(),chainBytes);
    }
 else     if (privateKey instanceof OpenSSLDSAPrivateKey) {
      setSslClientCertFromCtx(((OpenSSLDSAPrivateKey)privateKey).getPkeyContext(),chainBytes);
    }
 else {
      setSslClientCertFromPKCS8(privateKey.getEncoded(),chainBytes);
    }
  }
 catch (  CertificateEncodingException e) {
    post(new Runnable(){
      public void run(){
        mBrowserFrame.nativeSslClientCert(mHandle,0,null);
        return;
      }
    }
);
  }
}
