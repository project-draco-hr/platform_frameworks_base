{
synchronized (mLock) {
    if (mRemoteInterface != null && mUserId == userId) {
      return mRemoteInterface;
    }
    final long identity=Binder.clearCallingIdentity();
    try {
      if (mUserId != UserHandle.USER_NULL && mUserId != userId) {
        unbind();
      }
      mContext.bindServiceAsUser(mIntent,this,Context.BIND_AUTO_CREATE | Context.BIND_ALLOW_OOM_MANAGEMENT,UserHandle.CURRENT);
    }
  finally {
      Binder.restoreCallingIdentity(identity);
    }
    final long startMillis=SystemClock.uptimeMillis();
    while (true) {
      if (mRemoteInterface != null) {
        break;
      }
      final long elapsedMillis=SystemClock.uptimeMillis() - startMillis;
      final long remainingMillis=BIND_SPOOLER_SERVICE_TIMEOUT - elapsedMillis;
      if (remainingMillis <= 0) {
        throw new TimeoutException("Cannot get spooler!");
      }
      try {
        mLock.wait(remainingMillis);
      }
 catch (      InterruptedException ie) {
      }
    }
    mUserId=userId;
    return mRemoteInterface;
  }
}
