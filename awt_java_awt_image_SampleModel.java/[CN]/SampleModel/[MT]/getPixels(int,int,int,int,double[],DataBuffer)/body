{
  if (x < 0 || y < 0 || x + w > this.width || y + h > this.height) {
    throw new ArrayIndexOutOfBoundsException(Messages.getString("awt.63"));
  }
  double pixels[];
  int idx=0;
  if (dArray == null) {
    pixels=new double[w * h * numBands];
  }
 else {
    pixels=dArray;
  }
  for (int i=y; i < y + h; i++) {
    for (int j=x; j < x + w; j++) {
      for (int n=0; n < numBands; n++) {
        pixels[idx++]=getSampleDouble(j,i,n,data);
      }
    }
  }
  return pixels;
}
