{
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  if (networkPolicy != null) {
    DataOutputStream out=new DataOutputStream(baos);
    try {
      out.writeInt(STATE_VERSION);
      writeNetworkTemplate(out,networkPolicy.template);
      out.writeInt(networkPolicy.cycleDay);
      writeString(out,networkPolicy.cycleTimezone);
      out.writeLong(networkPolicy.warningBytes);
      out.writeLong(networkPolicy.limitBytes);
      out.writeLong(networkPolicy.lastWarningSnooze);
      out.writeLong(networkPolicy.lastLimitSnooze);
      out.writeInt(networkPolicy.metered ? 1 : 0);
      out.writeInt(networkPolicy.inferred ? 1 : 0);
    }
 catch (    IOException ioe) {
      Log.e(TAG,"Failed to Convert NetworkPolicy to byte array",ioe);
      baos.reset();
    }
  }
  return baos.toByteArray();
}
