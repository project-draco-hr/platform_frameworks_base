{
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  if (policies != null && policies.length != 0) {
    DataOutputStream out=new DataOutputStream(baos);
    try {
      out.writeInt(STATE_VERSION);
      out.writeInt(policies.length);
      for (      NetworkPolicy policy : policies) {
        byte[] marshaledPolicy=marshalNetworkPolicy(policy);
        if (marshaledPolicy != null) {
          out.writeByte(NOT_NULL);
          out.writeInt(marshaledPolicy.length);
          out.write(marshaledPolicy);
        }
 else {
          out.writeByte(NULL);
        }
      }
    }
 catch (    IOException ioe) {
      Log.e(TAG,"Failed to Convert NetworkPolicies to byte array",ioe);
      baos.reset();
    }
  }
  return baos.toByteArray();
}
