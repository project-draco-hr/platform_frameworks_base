{
  resetWifiP2pInfo();
  mNetworkInfo.setDetailedState(NetworkInfo.DetailedState.FAILED,null,null);
  sendP2pConnectionChangedBroadcast();
  boolean peersChanged=mPeers.remove(mPeersLostDuringConnection);
  if (mSavedPeerConfig != null && mPeers.remove(mSavedPeerConfig.deviceAddress) != null) {
    peersChanged=true;
  }
  if (peersChanged) {
    sendPeersChangedBroadcast();
  }
  mSavedPeerConfig=null;
  mPeersLostDuringConnection.clear();
  mServiceDiscReqId=null;
  sendMessage(WifiP2pManager.DISCOVER_PEERS);
}
