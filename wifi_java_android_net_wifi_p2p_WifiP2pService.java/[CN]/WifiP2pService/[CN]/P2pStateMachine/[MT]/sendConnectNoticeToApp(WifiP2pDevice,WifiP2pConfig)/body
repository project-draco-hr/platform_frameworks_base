{
  if (dev == null) {
    dev=new WifiP2pDevice(config.deviceAddress);
  }
  if (!isForegroundApp(mForegroundAppPkgName)) {
    if (DBG)     logd("application is NOT foreground");
    sendDetachedMsg(WifiP2pManager.NOT_IN_FOREGROUND);
    return false;
  }
  Message msg=Message.obtain();
  msg.what=WifiP2pManager.CONNECTION_REQUESTED;
  Bundle bundle=new Bundle();
  bundle.putParcelable(WifiP2pManager.P2P_DEV_BUNDLE_KEY,dev);
  bundle.putParcelable(WifiP2pManager.P2P_CONFIG_BUNDLE_KEY,config);
  msg.setData(bundle);
  return sendDialogMsgToFrontApp(msg);
}
