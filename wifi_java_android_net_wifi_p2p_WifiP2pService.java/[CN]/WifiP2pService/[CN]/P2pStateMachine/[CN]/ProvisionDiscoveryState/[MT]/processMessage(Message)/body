{
  if (DBG)   logd(getName() + message.toString());
  WifiP2pProvDiscEvent provDisc;
  WifiP2pDevice device;
switch (message.what) {
case WifiMonitor.P2P_PROV_DISC_PBC_RSP_EVENT:
    provDisc=(WifiP2pProvDiscEvent)message.obj;
  device=provDisc.device;
if (!device.deviceAddress.equals(mSavedPeerConfig.deviceAddress)) break;
if (mSavedPeerConfig.wps.setup == WpsInfo.PBC) {
if (DBG) logd("Found a match " + mSavedPeerConfig);
mWifiNative.p2pConnect(mSavedPeerConfig,FORM_GROUP);
transitionTo(mGroupNegotiationState);
}
break;
case WifiMonitor.P2P_PROV_DISC_ENTER_PIN_EVENT:
provDisc=(WifiP2pProvDiscEvent)message.obj;
device=provDisc.device;
if (!device.deviceAddress.equals(mSavedPeerConfig.deviceAddress)) break;
if (mSavedPeerConfig.wps.setup == WpsInfo.KEYPAD) {
if (DBG) logd("Found a match " + mSavedPeerConfig);
if (!TextUtils.isEmpty(mSavedPeerConfig.wps.pin)) {
mWifiNative.p2pConnect(mSavedPeerConfig,FORM_GROUP);
transitionTo(mGroupNegotiationState);
}
 else {
mJoinExistingGroup=false;
transitionTo(mUserAuthorizingInvitationState);
}
}
break;
case WifiMonitor.P2P_PROV_DISC_SHOW_PIN_EVENT:
provDisc=(WifiP2pProvDiscEvent)message.obj;
device=provDisc.device;
if (!device.deviceAddress.equals(mSavedPeerConfig.deviceAddress)) break;
if (mSavedPeerConfig.wps.setup == WpsInfo.DISPLAY) {
if (DBG) logd("Found a match " + mSavedPeerConfig);
mSavedPeerConfig.wps.pin=provDisc.pin;
mWifiNative.p2pConnect(mSavedPeerConfig,FORM_GROUP);
if (!sendShowPinReqToFrontApp(provDisc.pin)) {
notifyInvitationSent(provDisc.pin,device.deviceAddress);
}
transitionTo(mGroupNegotiationState);
}
break;
default :
return NOT_HANDLED;
}
return HANDLED;
}
