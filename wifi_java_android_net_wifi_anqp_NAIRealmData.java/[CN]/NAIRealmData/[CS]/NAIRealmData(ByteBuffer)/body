{
  if (payload.remaining() < 5) {
    throw new ProtocolException("Runt payload: " + payload.remaining());
  }
  int length=payload.getShort() & SHORT_MASK;
  if (length > payload.remaining()) {
    throw new ProtocolException("Invalid data length: " + length);
  }
  boolean utf8=(payload.get() & 1) == UTF8_INDICATOR;
  String realm=Constants.getPrefixedString(payload,1,utf8 ? StandardCharsets.UTF_8 : StandardCharsets.US_ASCII);
  String[] realms=realm.split(";");
  mRealms=new ArrayList<String>();
  for (  String realmElement : realms) {
    if (realmElement.length() > 0) {
      mRealms.add(realmElement);
    }
  }
  int methodCount=payload.get() & BYTE_MASK;
  mEAPMethods=new ArrayList<EAPMethod>(methodCount);
  while (methodCount > 0) {
    mEAPMethods.add(new EAPMethod(payload));
    methodCount--;
  }
}
