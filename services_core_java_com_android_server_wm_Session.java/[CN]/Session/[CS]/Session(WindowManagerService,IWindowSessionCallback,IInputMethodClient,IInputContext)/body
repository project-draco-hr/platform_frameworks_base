{
  mService=service;
  mCallback=callback;
  mClient=client;
  mInputContext=inputContext;
  mUid=Binder.getCallingUid();
  mPid=Binder.getCallingPid();
  mLastReportedAnimatorScale=service.getCurrentAnimatorScale();
  StringBuilder sb=new StringBuilder();
  sb.append("Session{");
  sb.append(Integer.toHexString(System.identityHashCode(this)));
  sb.append(" ");
  sb.append(mPid);
  if (mUid < Process.FIRST_APPLICATION_UID) {
    sb.append(":");
    sb.append(mUid);
  }
 else {
    sb.append(":u");
    sb.append(UserHandle.getUserId(mUid));
    sb.append('a');
    sb.append(UserHandle.getAppId(mUid));
  }
  sb.append("}");
  mStringName=sb.toString();
synchronized (mService.mWindowMap) {
    if (mService.mInputMethodManager == null && mService.mHaveInputMethods) {
      IBinder b=ServiceManager.getService(Context.INPUT_METHOD_SERVICE);
      mService.mInputMethodManager=IInputMethodManager.Stub.asInterface(b);
    }
  }
  long ident=Binder.clearCallingIdentity();
  try {
    if (mService.mInputMethodManager != null) {
      mService.mInputMethodManager.addClient(client,inputContext,mUid,mPid);
    }
 else {
      client.setUsingInputMethod(false);
    }
    client.asBinder().linkToDeath(this,0);
  }
 catch (  RemoteException e) {
    try {
      if (mService.mInputMethodManager != null) {
        mService.mInputMethodManager.removeClient(client);
      }
    }
 catch (    RemoteException ee) {
    }
  }
 finally {
    Binder.restoreCallingIdentity(ident);
  }
}
