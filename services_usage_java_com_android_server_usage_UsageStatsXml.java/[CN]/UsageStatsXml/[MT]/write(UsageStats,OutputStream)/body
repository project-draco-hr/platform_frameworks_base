{
  FastXmlSerializer xml=new FastXmlSerializer();
  xml.setOutput(out,"utf-8");
  xml.startDocument("utf-8",true);
  xml.setFeature("http://xmlpull.org/v1/doc/features.html#indent-output",true);
  xml.startTag(null,USAGESTATS_TAG);
  xml.attribute(null,VERSION_ATTR,Integer.toString(CURRENT_VERSION));
  xml.attribute(null,BEGIN_TIME_ATTR,Long.toString(stats.mBeginTimeStamp));
  xml.attribute(null,END_TIME_ATTR,Long.toString(stats.mEndTimeStamp));
  final int pkgCount=stats.getPackageCount();
  for (int i=0; i < pkgCount; i++) {
    final PackageUsageStats pkgStats=stats.getPackage(i);
    xml.startTag(null,PACKAGE_TAG);
    xml.attribute(null,NAME_ATTR,pkgStats.mPackageName);
    xml.attribute(null,TOTAL_TIME_ACTIVE_ATTR,Long.toString(pkgStats.mTotalTimeSpent));
    xml.attribute(null,LAST_TIME_ACTIVE_ATTR,Long.toString(pkgStats.mLastTimeUsed));
    xml.attribute(null,LAST_EVENT_ATTR,Integer.toString(pkgStats.mLastEvent));
    xml.endTag(null,PACKAGE_TAG);
  }
  xml.endTag(null,USAGESTATS_TAG);
  xml.endDocument();
}
