{
  final IccCardConstants.State simState=mUpdateMonitor.getSimState();
  UnlockMode currentMode;
  if (simState == IccCardConstants.State.PIN_REQUIRED) {
    currentMode=UnlockMode.SimPin;
  }
 else   if (simState == IccCardConstants.State.PUK_REQUIRED) {
    currentMode=UnlockMode.SimPuk;
  }
 else {
    final int mode=mLockPatternUtils.getKeyguardStoredPasswordQuality();
switch (mode) {
case DevicePolicyManager.PASSWORD_QUALITY_NUMERIC:
case DevicePolicyManager.PASSWORD_QUALITY_ALPHABETIC:
case DevicePolicyManager.PASSWORD_QUALITY_ALPHANUMERIC:
case DevicePolicyManager.PASSWORD_QUALITY_COMPLEX:
      currentMode=UnlockMode.Password;
    break;
case DevicePolicyManager.PASSWORD_QUALITY_SOMETHING:
case DevicePolicyManager.PASSWORD_QUALITY_UNSPECIFIED:
  if (mLockPatternUtils.isLockPatternEnabled()) {
    if (mForgotPattern || mLockPatternUtils.isPermanentlyLocked()) {
      currentMode=UnlockMode.Account;
    }
 else {
      currentMode=UnlockMode.Pattern;
    }
  }
 else {
    currentMode=UnlockMode.Unknown;
  }
break;
default :
throw new IllegalStateException("Unknown unlock mode:" + mode);
}
}
return currentMode;
}
