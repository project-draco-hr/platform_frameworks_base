{
  if (uid == UID_NOT_SET) {
    uid=Binder.getCallingUid();
  }
synchronized (mLock) {
    if (mCallingUid == UID_NOT_SET || mCallingUid != uid) {
      mCallingUid=uid;
      mCallingPackage=packageName;
      if (mCallingPackage != null) {
        return;
      }
      Context context=mService.getContext();
      if (context == null) {
        return;
      }
      String[] packages=context.getPackageManager().getPackagesForUid(uid);
      if (packages != null && packages.length > 0) {
        mCallingPackage=packages[0];
      }
    }
  }
}
