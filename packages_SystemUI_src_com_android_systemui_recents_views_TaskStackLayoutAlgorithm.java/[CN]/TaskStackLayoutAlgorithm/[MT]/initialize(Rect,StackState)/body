{
  RecentsConfiguration config=Recents.getConfiguration();
  int widthPadding=(int)(config.taskStackWidthPaddingPct * taskStackBounds.width());
  int heightPadding=mContext.getResources().getDimensionPixelSize(R.dimen.recents_stack_top_padding);
  Rect lastStackRect=new Rect(mStackRect);
  mState=state;
  mStackTopOffset=mFocusedTopPeekHeight + heightPadding;
  mStackBottomOffset=mSystemInsets.bottom + heightPadding;
  state.computeRects(mFreeformRect,mStackRect,taskStackBounds,widthPadding,heightPadding,mStackBottomOffset);
  mHistoryButtonRect.set(mStackRect.left,mStackRect.top - heightPadding,mStackRect.right,mStackRect.top + mFocusedTopPeekHeight);
  float aspect=(float)(taskStackBounds.width() - mSystemInsets.left - mSystemInsets.right) / (taskStackBounds.height() - mSystemInsets.bottom);
  int width=mStackRect.width();
  int minHeight=mStackRect.height() - mFocusedTopPeekHeight - mStackBottomOffset;
  int height=(int)Math.min(width / aspect,minHeight);
  mTaskRect.set(mStackRect.left,mStackRect.top,mStackRect.left + width,mStackRect.top + height);
  if (lastStackRect.equals(mStackRect)) {
    return;
  }
  mUnfocusedCurve=constructUnfocusedCurve();
  mUnfocusedCurveInterpolator=new FreePathInterpolator(mUnfocusedCurve);
  mFocusedCurve=constructFocusedCurve();
  mFocusedCurveInterpolator=new FreePathInterpolator(mFocusedCurve);
  mUnfocusedDimCurve=constructUnfocusedDimCurve();
  mUnfocusedDimCurveInterpolator=new FreePathInterpolator(mUnfocusedDimCurve);
  mFocusedDimCurve=constructFocusedDimCurve();
  mFocusedDimCurveInterpolator=new FreePathInterpolator(mFocusedDimCurve);
  updateFrontBackTransforms();
}
