{
  HashMap<ComponentName,SearchableInfo> newSearchablesMap=new HashMap<ComponentName,SearchableInfo>();
  ArrayList<SearchableInfo> newSearchablesList=new ArrayList<SearchableInfo>();
  ArrayList<SearchableInfo> newSearchablesInGlobalSearchList=new ArrayList<SearchableInfo>();
  final PackageManager pm=mContext.getPackageManager();
  List<ResolveInfo> infoList;
  final Intent intent=new Intent(Intent.ACTION_SEARCH);
  infoList=pm.queryIntentActivities(intent,PackageManager.GET_META_DATA);
  if (infoList != null) {
    int count=infoList.size();
    for (int ii=0; ii < count; ii++) {
      ResolveInfo info=infoList.get(ii);
      ActivityInfo ai=info.activityInfo;
      SearchableInfo searchable=SearchableInfo.getActivityMetaData(mContext,ai);
      if (searchable != null) {
        newSearchablesList.add(searchable);
        newSearchablesMap.put(searchable.getSearchActivity(),searchable);
        if (searchable.shouldIncludeInGlobalSearch()) {
          newSearchablesInGlobalSearchList.add(searchable);
        }
      }
    }
  }
  Intent globalSearchIntent=new Intent(SearchManager.INTENT_ACTION_GLOBAL_SEARCH);
  ComponentName globalSearchActivity=globalSearchIntent.resolveActivity(pm);
  SearchableInfo newDefaultSearchable=newSearchablesMap.get(globalSearchActivity);
  if (newDefaultSearchable == null) {
    Log.w(LOG_TAG,"No searchable info found for new default searchable activity " + globalSearchActivity);
  }
synchronized (this) {
    mSearchablesMap=newSearchablesMap;
    mSearchablesList=newSearchablesList;
    mSearchablesInGlobalSearchList=newSearchablesInGlobalSearchList;
    mDefaultSearchable=newDefaultSearchable;
  }
}
