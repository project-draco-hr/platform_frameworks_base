{
  Message msg;
  mGSMPhone.dial("#646#");
  List<? extends MmiCode> pendingMmis=mGSMPhone.getPendingMmiCodes();
  assertEquals(1,pendingMmis.size());
  MmiCode mmi=pendingMmis.get(0);
  assertTrue(mmi.isCancelable());
  mmi.cancel();
  do {
    msg=mTestHandler.getNextMessage();
  }
 while (msg.what != EVENT_MMI_INITIATE);
  do {
    msg=mTestHandler.getNextMessage();
  }
 while (msg.what != EVENT_MMI_COMPLETE);
  AsyncResult ar=(AsyncResult)msg.obj;
  mmi=(MmiCode)ar.result;
  assertEquals(MmiCode.State.CANCELLED,mmi.getState());
}
