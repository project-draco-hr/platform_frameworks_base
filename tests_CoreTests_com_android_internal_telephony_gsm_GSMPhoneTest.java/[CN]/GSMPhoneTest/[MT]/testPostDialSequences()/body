{
  Message msg;
  AsyncResult ar;
  Connection cn;
  mGSMPhone.dial("+13125551212,1234;5N8xx");
  do {
    msg=mTestHandler.getNextMessage();
    mRadioControl.progressConnectingToActive();
  }
 while (msg.what != EVENT_POST_DIAL);
  ar=(AsyncResult)(msg.obj);
  cn=(Connection)(ar.result);
  assertEquals(',',msg.arg1);
  assertEquals("1234;5N8",cn.getRemainingPostDialString());
  do {
    msg=mTestHandler.getNextMessage();
  }
 while (msg.what != EVENT_POST_DIAL);
  assertEquals('1',msg.arg1);
  ar=(AsyncResult)(msg.obj);
  assertEquals(Connection.PostDialState.STARTED,ar.userObj);
  do {
    msg=mTestHandler.getNextMessage();
  }
 while (msg.what != EVENT_POST_DIAL);
  assertEquals('2',msg.arg1);
  ar=(AsyncResult)(msg.obj);
  assertEquals(Connection.PostDialState.STARTED,ar.userObj);
  do {
    msg=mTestHandler.getNextMessage();
  }
 while (msg.what != EVENT_POST_DIAL);
  assertEquals('3',msg.arg1);
  ar=(AsyncResult)(msg.obj);
  assertEquals(Connection.PostDialState.STARTED,ar.userObj);
  do {
    msg=mTestHandler.getNextMessage();
  }
 while (msg.what != EVENT_POST_DIAL);
  assertEquals('4',msg.arg1);
  ar=(AsyncResult)(msg.obj);
  assertEquals(Connection.PostDialState.STARTED,ar.userObj);
  do {
    msg=mTestHandler.getNextMessage();
  }
 while (msg.what != EVENT_POST_DIAL);
  assertEquals(';',msg.arg1);
  ar=(AsyncResult)(msg.obj);
  cn=(Connection)(ar.result);
  assertEquals(Connection.PostDialState.WAIT,cn.getPostDialState());
  assertEquals(Connection.PostDialState.WAIT,ar.userObj);
  cn.proceedAfterWaitChar();
  do {
    msg=mTestHandler.getNextMessage();
  }
 while (msg.what != EVENT_POST_DIAL);
  assertEquals('5',msg.arg1);
  ar=(AsyncResult)(msg.obj);
  assertEquals(Connection.PostDialState.STARTED,ar.userObj);
  do {
    msg=mTestHandler.getNextMessage();
  }
 while (msg.what != EVENT_POST_DIAL);
  assertEquals('N',msg.arg1);
  ar=(AsyncResult)(msg.obj);
  cn=(Connection)(ar.result);
  assertEquals(Connection.PostDialState.WILD,cn.getPostDialState());
  assertEquals(Connection.PostDialState.WILD,ar.userObj);
  cn.proceedAfterWildChar(",6;7");
  do {
    msg=mTestHandler.getNextMessage();
  }
 while (msg.what != EVENT_POST_DIAL);
  ar=(AsyncResult)(msg.obj);
  cn=(Connection)(ar.result);
  assertEquals(',',msg.arg1);
  assertEquals("6;78",cn.getRemainingPostDialString());
  do {
    msg=mTestHandler.getNextMessage();
  }
 while (msg.what != EVENT_POST_DIAL);
  assertEquals('6',msg.arg1);
  ar=(AsyncResult)(msg.obj);
  assertEquals(Connection.PostDialState.STARTED,ar.userObj);
  do {
    msg=mTestHandler.getNextMessage();
  }
 while (msg.what != EVENT_POST_DIAL);
  assertEquals(';',msg.arg1);
  ar=(AsyncResult)(msg.obj);
  cn=(Connection)(ar.result);
  assertEquals(Connection.PostDialState.WAIT,cn.getPostDialState());
  assertEquals(Connection.PostDialState.WAIT,ar.userObj);
  cn.proceedAfterWaitChar();
  do {
    msg=mTestHandler.getNextMessage();
  }
 while (msg.what != EVENT_POST_DIAL);
  assertEquals('7',msg.arg1);
  ar=(AsyncResult)(msg.obj);
  assertEquals(Connection.PostDialState.STARTED,ar.userObj);
  do {
    msg=mTestHandler.getNextMessage();
  }
 while (msg.what != EVENT_POST_DIAL);
  assertEquals('8',msg.arg1);
  ar=(AsyncResult)(msg.obj);
  assertEquals(Connection.PostDialState.STARTED,ar.userObj);
  do {
    msg=mTestHandler.getNextMessage();
  }
 while (msg.what != EVENT_POST_DIAL);
  assertEquals(0,msg.arg1);
  ar=(AsyncResult)(msg.obj);
  cn=(Connection)(ar.result);
  assertEquals(Connection.PostDialState.COMPLETE,cn.getPostDialState());
  assertEquals(Connection.PostDialState.COMPLETE,ar.userObj);
}
