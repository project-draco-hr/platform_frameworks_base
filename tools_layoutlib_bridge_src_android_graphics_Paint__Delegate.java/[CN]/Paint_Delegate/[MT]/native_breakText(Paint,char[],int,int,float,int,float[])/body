{
  Paint_Delegate delegate=sManager.getDelegate(thisPaint.mNativePaint);
  if (delegate == null) {
    return 0;
  }
  int inc=count > 0 ? 1 : -1;
  int measureIndex=0;
  for (int i=index; i != index + count; i+=inc, measureIndex++) {
    int start, end;
    if (i < index) {
      start=i;
      end=index;
    }
 else {
      start=index;
      end=i;
    }
    RectF bounds=delegate.measureText(text,start,end - start + 1,isRtl(bidiFlags));
    float res=bounds.right - bounds.left;
    if (measuredWidth != null) {
      measuredWidth[measureIndex]=res;
    }
    if (res > maxWidth) {
      return measureIndex;
    }
  }
  return measureIndex;
}
