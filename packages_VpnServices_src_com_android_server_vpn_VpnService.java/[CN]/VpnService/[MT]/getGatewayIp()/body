{
  Enumeration<NetworkInterface> ifces=NetworkInterface.getNetworkInterfaces();
  for (; ifces.hasMoreElements(); ) {
    NetworkInterface ni=ifces.nextElement();
    int gateway=NetworkUtils.getDefaultRoute(ni.getName());
    if (gateway == 0)     continue;
    return toInetAddress(gateway).getHostAddress();
  }
  throw new IOException("Default gateway is not available");
}
