{
  final File packagePath=new File(getUserBitmapFilePath(userId),shortcut.getPackageName());
  if (!packagePath.isDirectory()) {
    packagePath.mkdirs();
    if (!packagePath.isDirectory()) {
      throw new IOException("Unable to create directory " + packagePath);
    }
    SELinux.restorecon(packagePath);
  }
  final String baseName=String.valueOf(injectCurrentTimeMillis());
  for (int suffix=0; ; suffix++) {
    final String filename=(suffix == 0 ? baseName : baseName + "_" + suffix) + ".png";
    final File file=new File(packagePath,filename);
    if (!file.exists()) {
      if (DEBUG) {
        Slog.d(TAG,"Saving icon to " + file.getAbsolutePath());
      }
      return new FileOutputStreamWithPath(file);
    }
  }
}
