{
  if (DEBUG) {
    Slog.d(TAG,"cleanupGonePackages() userId=" + userId);
  }
  ArrayList<String> gonePackages=null;
  final ShortcutUser user=getUserShortcutsLocked(userId);
  final ArrayMap<String,ShortcutPackageInfo> infos=user.getPackageInfos();
  for (int i=infos.size() - 1; i >= 0; i--) {
    final ShortcutPackageInfo info=infos.valueAt(i);
    if (info.isShadow()) {
      continue;
    }
    if (isPackageInstalled(info.getPackageName(),userId)) {
      continue;
    }
    gonePackages=ArrayUtils.add(gonePackages,info.getPackageName());
  }
  if (gonePackages != null) {
    for (int i=gonePackages.size() - 1; i >= 0; i--) {
      handlePackageGone(gonePackages.get(i),userId);
    }
  }
}
