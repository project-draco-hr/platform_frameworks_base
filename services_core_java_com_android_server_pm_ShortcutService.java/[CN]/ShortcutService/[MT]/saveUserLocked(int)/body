{
  final File path=new File(injectUserDataPath(userId),FILENAME_USER_PACKAGES);
  if (DEBUG) {
    Slog.d(TAG,"Saving to " + path);
  }
  path.mkdirs();
  final AtomicFile file=new AtomicFile(path);
  FileOutputStream outs=null;
  try {
    outs=file.startWrite();
    XmlSerializer out=new FastXmlSerializer();
    out.setOutput(outs,StandardCharsets.UTF_8.name());
    out.startDocument(null,true);
    getUserShortcutsLocked(userId).saveToXml(this,out,false);
    out.endDocument();
    file.finishWrite(outs);
  }
 catch (  IOException|XmlPullParserException e) {
    Slog.e(TAG,"Failed to write to file " + file.getBaseFile(),e);
    file.failWrite(outs);
  }
}
