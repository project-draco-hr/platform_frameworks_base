{
  Preconditions.checkStringNotEmpty(packageName,"packageName");
  if (isCallerSystem()) {
    return;
  }
  final int callingUid=injectBinderCallingUid();
  if (UserHandle.getUserId(callingUid) != userId) {
    throw new SecurityException("Invalid user-ID");
  }
  if (injectGetPackageUid(packageName,userId) == injectBinderCallingUid()) {
    return;
  }
  throw new SecurityException("Calling package name mismatch");
}
