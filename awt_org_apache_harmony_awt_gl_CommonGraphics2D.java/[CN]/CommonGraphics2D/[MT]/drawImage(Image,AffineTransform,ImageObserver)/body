{
  if (image == null) {
    return true;
  }
  if (trans == null || trans.isIdentity()) {
    return drawImage(image,0,0,imageObserver);
  }
  boolean done=false;
  boolean somebits=false;
  Surface srcSurf=null;
  if (image instanceof OffscreenImage) {
    OffscreenImage oi=(OffscreenImage)image;
    if ((oi.getState() & ImageObserver.ERROR) != 0) {
      return false;
    }
    done=oi.prepareImage(imageObserver);
    somebits=(oi.getState() & ImageObserver.SOMEBITS) != 0;
    srcSurf=oi.getImageSurface();
  }
 else {
    done=true;
    srcSurf=Surface.getImageSurface(image);
  }
  if (done || somebits) {
    int w=srcSurf.getWidth();
    int h=srcSurf.getHeight();
    AffineTransform xform=(AffineTransform)transform.clone();
    xform.concatenate(trans);
    blitter.blit(0,0,srcSurf,0,0,dstSurf,w,h,xform,composite,null,clip);
  }
  return done;
}
