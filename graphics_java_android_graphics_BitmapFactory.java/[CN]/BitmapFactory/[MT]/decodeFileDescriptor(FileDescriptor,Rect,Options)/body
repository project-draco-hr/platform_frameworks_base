{
  Bitmap bm;
  Trace.traceBegin(Trace.TRACE_TAG_GRAPHICS,"decodeFileDescriptor");
  try {
    if (nativeIsSeekable(fd)) {
      bm=nativeDecodeFileDescriptor(fd,outPadding,opts);
    }
 else {
      FileInputStream fis=new FileInputStream(fd);
      byte[] tempStorage=null;
      if (opts != null)       tempStorage=opts.inTempStorage;
      if (tempStorage == null)       tempStorage=new byte[DECODE_BUFFER_SIZE];
      try {
        bm=nativeDecodeStream(fis,tempStorage,outPadding,opts);
      }
  finally {
        try {
          fis.close();
        }
 catch (        Throwable t) {
        }
      }
    }
    if (bm == null && opts != null && opts.inBitmap != null) {
      throw new IllegalArgumentException("Problem decoding into existing bitmap");
    }
    setDensityFromOptions(bm,opts);
  }
  finally {
    Trace.traceEnd(Trace.TRACE_TAG_GRAPHICS);
  }
  return bm;
}
