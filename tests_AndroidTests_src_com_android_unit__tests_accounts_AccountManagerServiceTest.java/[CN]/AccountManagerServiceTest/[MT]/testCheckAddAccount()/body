{
  AccountManagerService ams=new AccountManagerService(getContext());
  Account a11=new Account("account1","type1");
  Account a21=new Account("account2","type1");
  Account a31=new Account("account3","type1");
  Account a12=new Account("account1","type2");
  Account a22=new Account("account2","type2");
  Account a32=new Account("account3","type2");
  assertTrue(ams.addAccount(a11,"p11",null));
  assertTrue(ams.addAccount(a12,"p12",null));
  assertTrue(ams.addAccount(a21,"p21",null));
  assertTrue(ams.addAccount(a22,"p22",null));
  assertTrue(ams.addAccount(a31,"p31",null));
  assertTrue(ams.addAccount(a32,"p32",null));
  assertFalse("duplicate account insertion should fail",ams.addAccount(a32,"p",null));
  Account[] accounts=ams.getAccounts();
  Arrays.sort(accounts,new AccountSorter());
  assertEquals(6,accounts.length);
  assertEquals(a11,accounts[0]);
  assertEquals(a21,accounts[1]);
  assertEquals(a31,accounts[2]);
  assertEquals(a12,accounts[3]);
  assertEquals(a22,accounts[4]);
  assertEquals(a32,accounts[5]);
  accounts=ams.getAccountsByType("type1");
  Arrays.sort(accounts,new AccountSorter());
  assertEquals(3,accounts.length);
  assertEquals(a11,accounts[0]);
  assertEquals(a21,accounts[1]);
  assertEquals(a31,accounts[2]);
  ams.removeAccount(a21);
  accounts=ams.getAccountsByType("type1");
  Arrays.sort(accounts,new AccountSorter());
  assertEquals(2,accounts.length);
  assertEquals(a11,accounts[0]);
  assertEquals(a31,accounts[1]);
}
