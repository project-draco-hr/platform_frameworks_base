{
  String value=Settings.Global.getString(getContext().getContentResolver(),Settings.Global.OVERLAY_DISPLAY_DEVICES);
  if (value == null) {
    value="";
  }
  if (value.equals(mCurrentOverlaySetting)) {
    return;
  }
  mCurrentOverlaySetting=value;
  if (!mOverlays.isEmpty()) {
    Slog.i(TAG,"Dismissing all overlay display devices.");
    for (    OverlayDisplayHandle overlay : mOverlays) {
      overlay.dismissLocked();
    }
    mOverlays.clear();
  }
  int count=0;
  for (  String part : value.split(";")) {
    Matcher displayMatcher=DISPLAY_PATTERN.matcher(part);
    if (displayMatcher.matches()) {
      if (count >= 4) {
        Slog.w(TAG,"Too many overlay display devices specified: " + value);
        break;
      }
      String modeString=displayMatcher.group(1);
      String flagString=displayMatcher.group(2);
      ArrayList<OverlayMode> modes=new ArrayList<>();
      for (      String mode : modeString.split("\\|")) {
        Matcher modeMatcher=MODE_PATTERN.matcher(mode);
        if (modeMatcher.matches()) {
          try {
            int width=Integer.parseInt(modeMatcher.group(1),10);
            int height=Integer.parseInt(modeMatcher.group(2),10);
            int densityDpi=Integer.parseInt(modeMatcher.group(3),10);
            if (width >= MIN_WIDTH && width <= MAX_WIDTH && height >= MIN_HEIGHT && height <= MAX_HEIGHT && densityDpi >= DisplayMetrics.DENSITY_LOW && densityDpi <= DisplayMetrics.DENSITY_XXHIGH) {
              modes.add(new OverlayMode(width,height,densityDpi));
              continue;
            }
          }
 catch (          NumberFormatException ex) {
          }
        }
 else         if (mode.isEmpty()) {
          continue;
        }
      }
      if (!modes.isEmpty()) {
        int number=++count;
        String name=getContext().getResources().getString(com.android.internal.R.string.display_manager_overlay_display_name,number);
        int gravity=chooseOverlayGravity(number);
        boolean secure=flagString != null && flagString.contains(",secure");
        Slog.i(TAG,"Showing overlay display device #" + number + ": name="+ name+ ", modes="+ Arrays.toString(modes.toArray()));
        mOverlays.add(new OverlayDisplayHandle(name,modes,gravity,secure,number));
        continue;
      }
    }
    Slog.w(TAG,"Malformed overlay display devices setting: " + value);
  }
}
