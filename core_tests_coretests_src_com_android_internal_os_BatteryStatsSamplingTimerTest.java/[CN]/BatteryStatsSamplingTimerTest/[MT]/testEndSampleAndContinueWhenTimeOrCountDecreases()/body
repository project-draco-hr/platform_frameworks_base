{
  final MockClocks clocks=new MockClocks();
  final BatteryStatsImpl.TimeBase timeBase=Mockito.mock(BatteryStatsImpl.TimeBase.class);
  final BatteryStatsImpl.SamplingTimer timer=new BatteryStatsImpl.SamplingTimer(clocks,timeBase);
  timer.update(10,1);
  timer.add(10,1);
  assertEquals(0,timer.getCountLocked(BatteryStats.STATS_SINCE_CHARGED));
  assertEquals(0,timer.getTotalTimeLocked(200,BatteryStats.STATS_SINCE_CHARGED));
  timer.update(0,0);
  assertEquals(0,timer.getCountLocked(BatteryStats.STATS_SINCE_CHARGED));
  assertEquals(0,timer.getTotalTimeLocked(200,BatteryStats.STATS_SINCE_CHARGED));
  timer.onTimeStarted(100,100,100);
  timer.add(100,10);
  assertEquals(100,timer.getTotalTimeLocked(200,BatteryStats.STATS_SINCE_CHARGED));
  assertEquals(10,timer.getCountLocked(BatteryStats.STATS_SINCE_CHARGED));
  timer.update(50,5);
  assertEquals(150,timer.getTotalTimeLocked(200,BatteryStats.STATS_SINCE_CHARGED));
  assertEquals(15,timer.getCountLocked(BatteryStats.STATS_SINCE_CHARGED));
  timer.onTimeStopped(200,200,200);
  assertEquals(150,timer.getTotalTimeLocked(200,BatteryStats.STATS_SINCE_CHARGED));
  assertEquals(15,timer.getCountLocked(BatteryStats.STATS_SINCE_CHARGED));
}
