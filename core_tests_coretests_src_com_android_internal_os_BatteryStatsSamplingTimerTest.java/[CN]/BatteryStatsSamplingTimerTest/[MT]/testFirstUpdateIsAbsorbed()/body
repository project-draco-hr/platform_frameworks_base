{
  final MockClocks clocks=new MockClocks();
  final BatteryStatsImpl.TimeBase timeBase=Mockito.mock(BatteryStatsImpl.TimeBase.class);
  BatteryStatsImpl.SamplingTimer timer=new BatteryStatsImpl.SamplingTimer(clocks,timeBase);
  timer.update(10,1);
  assertEquals(0,timer.getTotalTimeLocked(10,BatteryStats.STATS_SINCE_CHARGED));
  assertEquals(0,timer.getCountLocked(BatteryStats.STATS_SINCE_CHARGED));
  timer=new BatteryStatsImpl.SamplingTimer(clocks,timeBase);
  timer.onTimeStarted(100,100,100);
  timer.update(10,1);
  assertEquals(0,timer.getTotalTimeLocked(100,BatteryStats.STATS_SINCE_CHARGED));
  assertEquals(0,timer.getCountLocked(BatteryStats.STATS_SINCE_CHARGED));
  timer.add(10,1);
  assertEquals(10,timer.getTotalTimeLocked(100,BatteryStats.STATS_SINCE_CHARGED));
  assertEquals(1,timer.getCountLocked(BatteryStats.STATS_SINCE_CHARGED));
  timer.onTimeStopped(200,200,200);
  timer.onTimeStarted(300,300,300);
  timer.add(10,1);
  assertEquals(20,timer.getTotalTimeLocked(300,BatteryStats.STATS_SINCE_CHARGED));
  assertEquals(2,timer.getCountLocked(BatteryStats.STATS_SINCE_CHARGED));
}
