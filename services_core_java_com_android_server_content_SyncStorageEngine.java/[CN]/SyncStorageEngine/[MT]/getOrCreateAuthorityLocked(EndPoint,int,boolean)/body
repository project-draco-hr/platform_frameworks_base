{
  AuthorityInfo authority=null;
  if (info.target_service) {
    SparseArray<AuthorityInfo> aInfo=mServices.get(info.service);
    if (aInfo == null) {
      aInfo=new SparseArray<AuthorityInfo>();
      mServices.put(info.service,aInfo);
    }
    authority=aInfo.get(info.userId);
    if (authority == null) {
      authority=createAuthorityLocked(info,ident,doWrite);
      aInfo.put(info.userId,authority);
    }
  }
 else   if (info.target_provider) {
    AccountAndUser au=new AccountAndUser(info.account,info.userId);
    AccountInfo account=mAccounts.get(au);
    if (account == null) {
      account=new AccountInfo(au);
      mAccounts.put(au,account);
    }
    authority=account.authorities.get(info.provider);
    if (authority == null) {
      authority=createAuthorityLocked(info,ident,doWrite);
      account.authorities.put(info.provider,authority);
    }
  }
  return authority;
}
