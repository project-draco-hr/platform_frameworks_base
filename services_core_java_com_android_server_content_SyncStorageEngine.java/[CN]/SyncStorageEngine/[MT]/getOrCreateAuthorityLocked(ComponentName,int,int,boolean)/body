{
  SparseArray<AuthorityInfo> aInfo=mServices.get(cname);
  if (aInfo == null) {
    aInfo=new SparseArray<AuthorityInfo>();
    mServices.put(cname,aInfo);
  }
  AuthorityInfo authority=aInfo.get(userId);
  if (authority == null) {
    if (ident < 0) {
      ident=mNextAuthorityId;
      mNextAuthorityId++;
      doWrite=true;
    }
    if (DEBUG) {
      Log.v(TAG,"created a new AuthorityInfo for " + cname.getPackageName() + ", "+ cname.getClassName()+ ", user: "+ userId);
    }
    authority=new AuthorityInfo(cname,userId,ident);
    aInfo.put(userId,authority);
    mAuthorities.put(ident,authority);
    if (doWrite) {
      writeAccountInfoLocked();
    }
  }
  return authority;
}
