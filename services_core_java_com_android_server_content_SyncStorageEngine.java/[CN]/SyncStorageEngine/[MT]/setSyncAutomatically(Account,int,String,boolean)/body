{
  if (Log.isLoggable(TAG,Log.VERBOSE)) {
    Slog.d(TAG,"setSyncAutomatically: " + " provider " + providerName + ", user "+ userId+ " -> "+ sync);
  }
synchronized (mAuthorities) {
    AuthorityInfo authority=getOrCreateAuthorityLocked(new EndPoint(account,providerName,userId),-1,false);
    if (authority.enabled == sync) {
      if (Log.isLoggable(TAG,Log.VERBOSE)) {
        Slog.d(TAG,"setSyncAutomatically: already set to " + sync + ", doing nothing");
      }
      return;
    }
    if (sync && authority.syncable == AuthorityInfo.SYNCABLE_NOT_INITIALIZED) {
      authority.syncable=AuthorityInfo.NOT_INITIALIZED;
    }
    authority.enabled=sync;
    writeAccountInfoLocked();
  }
  if (sync) {
    requestSync(account,userId,SyncOperation.REASON_SYNC_AUTO,providerName,new Bundle());
  }
  reportChange(ContentResolver.SYNC_OBSERVER_TYPE_SETTINGS);
  queueBackup();
}
