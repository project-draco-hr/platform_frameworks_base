{
  for (; ; ) {
    final int state;
    final boolean stateChanged;
    final int backlight;
    final boolean backlightChanged;
synchronized (mLock) {
      state=mPendingState;
      stateChanged=(state != mActualState);
      backlight=mPendingBacklight;
      backlightChanged=(backlight != mActualBacklight);
      if (!stateChanged) {
        postScreenUpdateThreadSafe();
        mStateChangeInProgress=false;
      }
      if (!backlightChanged) {
        mBacklightChangeInProgress=false;
      }
      if (!stateChanged && !backlightChanged) {
        try {
          mLock.wait();
        }
 catch (        InterruptedException ex) {
        }
        continue;
      }
      mActualState=state;
      mActualBacklight=backlight;
    }
    if (DEBUG) {
      Slog.d(TAG,"Updating screen state: state=" + Display.stateToString(state) + ", backlight="+ backlight);
    }
    mBlanker.requestDisplayState(state,backlight);
  }
}
