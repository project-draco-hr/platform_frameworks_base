{
synchronized (mLock) {
    boolean stateChanged=state != mPendingState;
    boolean backlightChanged=backlight != mPendingBacklight;
    if (stateChanged || backlightChanged) {
      if (DEBUG) {
        Slog.d(TAG,"Requesting new screen state: state=" + Display.stateToString(state) + ", backlight="+ backlight);
      }
      mPendingState=state;
      mPendingBacklight=backlight;
      boolean changeInProgress=mStateChangeInProgress || mBacklightChangeInProgress;
      mStateChangeInProgress=stateChanged;
      mBacklightChangeInProgress=backlightChanged;
      if (!changeInProgress) {
        mLock.notifyAll();
      }
    }
    return !mStateChangeInProgress;
  }
}
