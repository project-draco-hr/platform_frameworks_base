{
  final AppButtonData appButtonData=(AppButtonData)appIcon.getTag();
  if (appButtonData.getTaskCount() <= 1)   return;
  final ImageView anchorButton=(ImageView)mPopupAnchor.findViewById(R.id.shelf_menu_anchor_anchor);
  anchorButton.setImageDrawable(appIcon.getDrawable());
  appIcon.getLocationOnScreen(mClickedIconLocation);
  anchorButton.setTranslationX(mClickedIconLocation[0]);
  anchorButton.setTranslationY(mClickedIconLocation[1]);
  final OnAttachStateChangeListener onAttachStateChangeListener=new OnAttachStateChangeListener(){
    @java.lang.Override public void onViewAttachedToWindow(    View v){
      mPopupMenu.show();
    }
    @java.lang.Override public void onViewDetachedFromWindow(    View v){
    }
  }
;
  anchorButton.addOnAttachStateChangeListener(onAttachStateChangeListener);
  populateLaunchMenu(appButtonData.tasks);
  mPopupMenu.setOnDismissListener(new PopupMenu.OnDismissListener(){
    @java.lang.Override public void onDismiss(    PopupMenu menu){
      mWindowManager.removeView(mPopupAnchor);
      anchorButton.removeOnAttachStateChangeListener(onAttachStateChangeListener);
      mPopupMenu.setOnDismissListener(null);
      mPopupMenu.getMenu().clear();
    }
  }
);
  mWindowManager.addView(mPopupAnchor,mPopupAnchorLayoutParams);
}
