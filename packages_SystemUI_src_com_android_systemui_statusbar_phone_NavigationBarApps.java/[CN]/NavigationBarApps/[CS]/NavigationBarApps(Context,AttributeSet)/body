{
  super(context,attrs);
  sAppsModel=new NavigationBarAppsModel(context);
  mPackageManager=context.getPackageManager();
  mUserManager=(UserManager)context.getSystemService(Context.USER_SERVICE);
  mWindowManager=(WindowManager)context.getSystemService(Context.WINDOW_SERVICE);
  mLayoutInflater=LayoutInflater.from(context);
  mAppPackageMonitor=new AppPackageMonitor();
  LayoutTransition transition=new LayoutTransition();
  transition.disableTransitionType(LayoutTransition.DISAPPEARING);
  transition.disableTransitionType(LayoutTransition.APPEARING);
  transition.setStartDelay(LayoutTransition.CHANGE_DISAPPEARING,0);
  transition.setStagger(LayoutTransition.CHANGE_DISAPPEARING,0);
  setLayoutTransition(transition);
  TaskStackListener taskStackListener=new TaskStackListener();
  IActivityManager iam=ActivityManagerNative.getDefault();
  try {
    iam.registerTaskStackListener(taskStackListener);
  }
 catch (  RemoteException e) {
    Slog.e(TAG,"registerTaskStackListener failed",e);
  }
  mPopupAnchorLayoutParams=new WindowManager.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT,ViewGroup.LayoutParams.MATCH_PARENT,0,0,WindowManager.LayoutParams.TYPE_SECURE_SYSTEM_OVERLAY,WindowManager.LayoutParams.FLAG_FULLSCREEN | WindowManager.LayoutParams.FLAG_HARDWARE_ACCELERATED | WindowManager.LayoutParams.FLAG_LAYOUT_IN_SCREEN,PixelFormat.TRANSLUCENT);
  mPopupAnchorLayoutParams.setTitle("ShelfMenuAnchor");
  mPopupAnchor=(ViewGroup)mLayoutInflater.inflate(R.layout.shelf_menu_anchor,null);
  ImageView anchorButton=(ImageView)mPopupAnchor.findViewById(R.id.shelf_menu_anchor_anchor);
  mPopupMenu=new PopupMenu(context,anchorButton);
}
