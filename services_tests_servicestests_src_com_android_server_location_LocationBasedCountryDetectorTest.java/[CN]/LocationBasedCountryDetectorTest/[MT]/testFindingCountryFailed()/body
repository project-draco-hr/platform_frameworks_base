{
  final String country="us";
  final String provider="Good";
  TestCountryDetector detector=new TestCountryDetector(country,provider){
    @Override protected String getCountryFromLocation(    Location location){
synchronized (countryFoundLocker) {
        if (!notifyCountry) {
          try {
            countryFoundLocker.wait();
          }
 catch (          InterruptedException e) {
          }
        }
      }
      return null;
    }
  }
;
  CountryListenerImpl countryListener=new CountryListenerImpl();
  detector.setCountryListener(countryListener);
  detector.detectCountry();
  assertEquals(TestCountryDetector.TOTAL_PROVIDERS,detector.getListenersCount());
  detector.notifyLocationFound();
  assertEquals(0,detector.getListenersCount());
  assertNull(detector.getTimer());
  Thread queryThread=waitForQueryThreadLaunched(detector);
  detector.notifyCountryFound();
  waitForThreadEnding(queryThread);
  assertNull(detector.getQueryThread());
  assertTrue(countryListener.notified());
  assertNull(countryListener.getCountry());
}
