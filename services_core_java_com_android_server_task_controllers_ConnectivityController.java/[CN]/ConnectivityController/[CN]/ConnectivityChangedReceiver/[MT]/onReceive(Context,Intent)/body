{
  final String action=intent.getAction();
  if (action.equals(ConnectivityManager.CONNECTIVITY_ACTION)) {
    final int networkType=intent.getIntExtra(ConnectivityManager.EXTRA_NETWORK_TYPE,ConnectivityManager.TYPE_NONE);
    final ConnectivityManager connManager=(ConnectivityManager)context.getSystemService(Context.CONNECTIVITY_SERVICE);
    final NetworkInfo activeNetwork=connManager.getActiveNetworkInfo();
    if (activeNetwork.getType() == networkType) {
      final int userid=context.getUserId();
      boolean isMetered=false;
      boolean isConnected=!intent.getBooleanExtra(ConnectivityManager.EXTRA_NO_CONNECTIVITY,false);
      if (isConnected) {
        isMetered=connManager.isActiveNetworkMetered();
      }
      updateTrackedTasks(isConnected,isMetered,userid);
    }
  }
 else {
    Log.w(TAG,"Unrecognised action in intent: " + action);
  }
}
