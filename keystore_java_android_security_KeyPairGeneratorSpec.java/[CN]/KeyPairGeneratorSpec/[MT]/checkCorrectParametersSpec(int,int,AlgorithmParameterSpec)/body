{
  if (keyType == NativeCrypto.EVP_PKEY_RSA && spec != null) {
    if (spec instanceof RSAKeyGenParameterSpec) {
      RSAKeyGenParameterSpec rsaSpec=(RSAKeyGenParameterSpec)spec;
      if (keySize != -1 && keySize != rsaSpec.getKeysize()) {
        throw new IllegalArgumentException("RSA key size must match: " + keySize + " vs "+ rsaSpec.getKeysize());
      }
    }
 else {
      throw new IllegalArgumentException("RSA may only use RSAKeyGenParameterSpec");
    }
  }
}
