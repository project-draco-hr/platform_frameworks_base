{
  if (mHost != null && mDreaming && !mPulsing) {
    mWakeLock.acquire();
    mPulsing=true;
    if (!mDozeParameters.getProxCheckBeforePulse()) {
      continuePulsing(reason);
      return;
    }
    final long start=SystemClock.uptimeMillis();
    new ProximityCheck(){
      @Override public void onProximityResult(      int result){
        final boolean isNear=result == RESULT_NEAR;
        final long end=SystemClock.uptimeMillis();
        DozeLog.traceProximityResult(isNear,end - start,reason);
        if (isNear) {
          mPulsing=false;
          mWakeLock.release();
          return;
        }
        continuePulsing(reason);
      }
    }
.check();
  }
}
