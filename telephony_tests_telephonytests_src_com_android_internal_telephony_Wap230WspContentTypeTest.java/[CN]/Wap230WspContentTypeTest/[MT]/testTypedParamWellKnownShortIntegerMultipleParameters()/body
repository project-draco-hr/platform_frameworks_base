{
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  out.write(0x0B);
  out.write(SHORT_MIME_TYPE_ROLLOVER_CERTIFICATE | WSP_SHORT_INTEGER_MASK);
  out.write(TYPED_PARAM_SEC | WSP_SHORT_INTEGER_MASK);
  out.write(0x01 | WSP_SHORT_INTEGER_MASK);
  out.write(TYPED_PARAM_MAC | WSP_SHORT_INTEGER_MASK);
  out.write(WSP_QUOTE);
  out.write("imapc".getBytes("US-ASCII"));
  out.write(WSP_STRING_TERMINATOR);
  WspTypeDecoder unit=new WspTypeDecoder(out.toByteArray());
  assertTrue(unit.decodeContentType(0));
  String mimeType=unit.getValueString();
  assertEquals(STRING_MIME_TYPE_ROLLOVER_CERTIFICATE,mimeType);
  assertEquals(SHORT_MIME_TYPE_ROLLOVER_CERTIFICATE,unit.getValue32());
  assertEquals(12,unit.getDecodedDataLength());
  Map<String,String> params=unit.getContentParameters();
  assertEquals("1",params.get("SEC"));
  assertEquals("imapc",params.get("MAC"));
}
