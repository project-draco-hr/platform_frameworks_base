{
  if (rgbArray == null) {
    rgbArray=new int[offset + h * scansize];
  }
  int off=offset;
  for (int y=startY; y < startY + h; y++, off+=scansize) {
    int i=off;
    for (int x=startX; x < startX + w; x++, i++) {
      rgbArray[i]=cm.getRGB(raster.getDataElements(x,y,null));
    }
  }
  return rgbArray;
}
