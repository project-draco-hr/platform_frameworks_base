{
  mMidiManager=IMidiManager.Stub.asInterface(ServiceManager.getService(Context.MIDI_SERVICE));
  MidiDeviceServer server;
  try {
    MidiDeviceInfo deviceInfo=mMidiManager.getServiceDeviceInfo(getPackageName(),this.getClass().getName());
    MidiReceiver[] inputPortReceivers=getInputPortReceivers();
    if (inputPortReceivers == null) {
      inputPortReceivers=new MidiReceiver[0];
    }
    server=new MidiDeviceServer(mMidiManager,inputPortReceivers,deviceInfo.getOutputPortCount());
    server.setDeviceInfo(deviceInfo);
  }
 catch (  RemoteException e) {
    Log.e(TAG,"RemoteException in IMidiManager.getServiceDeviceInfo");
    server=null;
  }
  mServer=server;
}
