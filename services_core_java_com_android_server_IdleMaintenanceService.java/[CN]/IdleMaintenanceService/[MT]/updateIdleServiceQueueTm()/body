{
  if (DEBUG) {
    Slog.i(TAG,"Updating idle service queue");
  }
  PackageManager pm=mContext.getPackageManager();
  Intent idleIntent=new Intent(IdleService.SERVICE_INTERFACE);
  List<ResolveInfo> services=pm.queryIntentServices(idleIntent,0);
  for (  ResolveInfo info : services) {
    if (info.serviceInfo != null) {
      if (IdleService.PERMISSION_BIND.equals(info.serviceInfo.permission)) {
        final ComponentName componentName=new ComponentName(info.serviceInfo.packageName,info.serviceInfo.name);
        if (DEBUG) {
          Slog.i(TAG,"   - " + componentName);
        }
        if (!mIdleServices.containsKey(componentName)) {
          if (DEBUG) {
            Slog.i(TAG,"      + not known; adding");
          }
          IdleServiceInfo serviceInfo=new IdleServiceInfo(info,componentName);
          mIdleServices.put(componentName,serviceInfo);
          mIdleServiceQueue.add(serviceInfo);
        }
      }
 else {
        if (DEBUG) {
          Slog.i(TAG,"Idle service " + info.serviceInfo + " does not have required permission; ignoring");
        }
      }
    }
  }
}
