{
  super.onLayout(changed,left,top,right,bottom);
  final int width=right - left;
  final int height=bottom - top;
  float newWaveCenterX=mHorizontalOffset + Math.max(width,mOuterRing.getWidth()) / 2;
  float newWaveCenterY=mVerticalOffset + Math.max(height,mOuterRing.getHeight()) / 2;
  if (newWaveCenterX != mWaveCenterX || newWaveCenterY != mWaveCenterY) {
    if (mWaveCenterX == 0 && mWaveCenterY == 0) {
      performInitialLayout(newWaveCenterX,newWaveCenterY);
    }
    mWaveCenterX=newWaveCenterX;
    mWaveCenterY=newWaveCenterY;
    mOuterRing.setX(mWaveCenterX);
    mOuterRing.setY(Math.max(mWaveCenterY,mWaveCenterY));
    updateTargetPositions();
  }
  if (DEBUG)   dump();
}
