{
  if (path == null) {
    return;
  }
  final boolean written=(event == CLOSE_WRITE || event == MOVED_TO);
  final File changedFile=new File(mWallpaperDir,path);
synchronized (mLock) {
    if (mWallpaperFile.equals(changedFile) || mWallpaperInfoFile.equals(changedFile)) {
      long origId=Binder.clearCallingIdentity();
      BackupManager bm=new BackupManager(mContext);
      bm.dataChanged();
      Binder.restoreCallingIdentity(origId);
    }
    if (mWallpaperFile.equals(changedFile)) {
      notifyCallbacksLocked(mWallpaper);
      if (mWallpaper.wallpaperComponent == null || event != CLOSE_WRITE || mWallpaper.imageWallpaperPending) {
        if (written) {
          generateCrop(mWallpaper);
          mWallpaper.imageWallpaperPending=false;
          if (mWallpaper.setComplete != null) {
            try {
              mWallpaper.setComplete.onWallpaperChanged();
            }
 catch (            RemoteException e) {
            }
          }
          bindWallpaperComponentLocked(mImageWallpaper,true,false,mWallpaper,null);
          saveSettingsLocked(mWallpaper);
        }
      }
    }
  }
}
