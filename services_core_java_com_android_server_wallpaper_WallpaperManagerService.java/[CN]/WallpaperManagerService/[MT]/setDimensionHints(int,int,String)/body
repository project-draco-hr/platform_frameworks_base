{
  checkPermission(android.Manifest.permission.SET_WALLPAPER_HINTS);
  if (!isWallpaperSupported(callingPackage)) {
    return;
  }
synchronized (mLock) {
    int userId=UserHandle.getCallingUserId();
    WallpaperData wallpaper=getWallpaperSafeLocked(userId,FLAG_SET_SYSTEM);
    if (width <= 0 || height <= 0) {
      throw new IllegalArgumentException("width and height must be > 0");
    }
    Point displaySize=getDefaultDisplaySize();
    width=Math.max(width,displaySize.x);
    height=Math.max(height,displaySize.y);
    if (width != wallpaper.width || height != wallpaper.height) {
      wallpaper.width=width;
      wallpaper.height=height;
      saveSettingsLocked(userId);
      if (mCurrentUserId != userId)       return;
      if (wallpaper.connection != null) {
        if (wallpaper.connection.mEngine != null) {
          try {
            wallpaper.connection.mEngine.setDesiredSize(width,height);
          }
 catch (          RemoteException e) {
          }
          notifyCallbacksLocked(wallpaper);
        }
 else         if (wallpaper.connection.mService != null) {
          wallpaper.connection.mDimensionsChanged=true;
        }
      }
    }
  }
}
