{
  setCaller(CALLING_PACKAGE_1);
  final ShortcutInfo s1_1=makeShortcutWithTimestamp("s1",5000);
  final ShortcutInfo s1_2=makeShortcutWithTimestamp("s2",1000);
  assertTrue(mManager.setDynamicShortcuts(Arrays.asList(s1_1,s1_2)));
  setCaller(CALLING_PACKAGE_2);
  final ShortcutInfo s2_2=makeShortcutWithTimestamp("s2",1500);
  final ShortcutInfo s2_3=makeShortcutWithTimestamp("s3",3000);
  final ShortcutInfo s2_4=makeShortcutWithTimestamp("s4",500);
  assertTrue(mManager.setDynamicShortcuts(Arrays.asList(s2_2,s2_3,s2_4)));
  setCaller(CALLING_PACKAGE_3);
  final ShortcutInfo s3_2=makeShortcutWithTimestamp("s3",5000);
  assertTrue(mManager.setDynamicShortcuts(Arrays.asList(s3_2)));
  setCaller(LAUNCHER_1);
  assertAllDynamic(assertAllHaveTitle(assertAllNotHaveIntents(assertShortcutIds(assertAllNotKeyFieldsOnly(mInternal.getShortcuts(getCallingPackage(),0,CALLING_PACKAGE_1,null,ShortcutQuery.FLAG_GET_DYNAMIC,getCallingUserId())),"s1","s2"))));
  assertShortcutIds(mInternal.getShortcuts(getCallingPackage(),0,CALLING_PACKAGE_1,null,ShortcutQuery.FLAG_GET_PINNED,getCallingUserId()));
  assertAllDynamic(assertAllHaveTitle(assertAllNotHaveIntents(assertShortcutIds(assertAllNotKeyFieldsOnly(mInternal.getShortcuts(getCallingPackage(),1000,CALLING_PACKAGE_2,null,ShortcutQuery.FLAG_GET_PINNED | ShortcutQuery.FLAG_GET_DYNAMIC,getCallingUserId())),"s2","s3"))));
  assertAllDynamic(assertAllNotHaveTitle(assertAllNotHaveIntents(assertShortcutIds(assertAllKeyFieldsOnly(mInternal.getShortcuts(getCallingPackage(),1000,CALLING_PACKAGE_2,null,ShortcutQuery.FLAG_GET_DYNAMIC | ShortcutQuery.FLAG_GET_KEY_FIELDS_ONLY,getCallingUserId())),"s2","s3"))));
  mInternal.pinShortcuts(getCallingPackage(),CALLING_PACKAGE_2,Arrays.asList("s3","s4"),getCallingUserId());
  assertAllPinned(assertAllHaveTitle(assertAllNotHaveIntents(assertShortcutIds(assertAllNotKeyFieldsOnly(mInternal.getShortcuts(getCallingPackage(),1000,CALLING_PACKAGE_2,null,ShortcutQuery.FLAG_GET_PINNED,getCallingUserId())),"s3"))));
  assertShortcutIds(assertAllNotKeyFieldsOnly(mInternal.getShortcuts(getCallingPackage(),5000,null,null,ShortcutQuery.FLAG_GET_DYNAMIC | ShortcutQuery.FLAG_GET_PINNED,getCallingUserId())),"s1","s3");
}
