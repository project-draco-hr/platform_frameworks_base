{
  final Icon bmp32x32=Icon.createWithBitmap(BitmapFactory.decodeResource(getTestContext().getResources(),R.drawable.black_32x32));
  setCaller(CALLING_PACKAGE_1,USER_0);
  assertTrue(mManager.addDynamicShortcuts(list(makeShortcutWithIcon("s1",bmp32x32),makeShortcutWithIcon("s2",bmp32x32))));
  setCaller(CALLING_PACKAGE_2,USER_0);
  assertTrue(mManager.addDynamicShortcuts(list(makeShortcutWithIcon("s1",bmp32x32))));
  setCaller(CALLING_PACKAGE_3,USER_0);
  assertTrue(mManager.addDynamicShortcuts(list(makeShortcutWithIcon("s1",bmp32x32))));
  setCaller(CALLING_PACKAGE_1,USER_10);
  assertTrue(mManager.addDynamicShortcuts(list(makeShortcutWithIcon("s1",bmp32x32))));
  setCaller(CALLING_PACKAGE_2,USER_10);
  assertTrue(mManager.addDynamicShortcuts(list(makeShortcutWithIcon("s1",bmp32x32))));
  setCaller(CALLING_PACKAGE_3,USER_10);
  assertTrue(mManager.addDynamicShortcuts(list(makeShortcutWithIcon("s1",bmp32x32))));
  assertNotNull(mService.getPackageShortcutForTest(CALLING_PACKAGE_1,"s1",USER_0));
  assertNotNull(mService.getPackageShortcutForTest(CALLING_PACKAGE_2,"s1",USER_0));
  assertNotNull(mService.getPackageShortcutForTest(CALLING_PACKAGE_3,"s1",USER_0));
  assertNotNull(mService.getPackageShortcutForTest(CALLING_PACKAGE_1,"s1",USER_10));
  assertNotNull(mService.getPackageShortcutForTest(CALLING_PACKAGE_2,"s1",USER_10));
  assertNotNull(mService.getPackageShortcutForTest(CALLING_PACKAGE_3,"s1",USER_10));
  assertTrue(bitmapDirectoryExists(CALLING_PACKAGE_1,USER_0));
  assertTrue(bitmapDirectoryExists(CALLING_PACKAGE_2,USER_0));
  assertTrue(bitmapDirectoryExists(CALLING_PACKAGE_3,USER_0));
  assertTrue(bitmapDirectoryExists(CALLING_PACKAGE_1,USER_10));
  assertTrue(bitmapDirectoryExists(CALLING_PACKAGE_2,USER_10));
  assertTrue(bitmapDirectoryExists(CALLING_PACKAGE_3,USER_10));
  mService.mPackageMonitor.onReceive(getTestContext(),genPackageDataClear(CALLING_PACKAGE_1,USER_0));
  assertNull(mService.getPackageShortcutForTest(CALLING_PACKAGE_1,"s1",USER_0));
  assertNotNull(mService.getPackageShortcutForTest(CALLING_PACKAGE_2,"s1",USER_0));
  assertNotNull(mService.getPackageShortcutForTest(CALLING_PACKAGE_3,"s1",USER_0));
  assertNotNull(mService.getPackageShortcutForTest(CALLING_PACKAGE_1,"s1",USER_10));
  assertNotNull(mService.getPackageShortcutForTest(CALLING_PACKAGE_2,"s1",USER_10));
  assertNotNull(mService.getPackageShortcutForTest(CALLING_PACKAGE_3,"s1",USER_10));
  assertFalse(bitmapDirectoryExists(CALLING_PACKAGE_1,USER_0));
  assertTrue(bitmapDirectoryExists(CALLING_PACKAGE_2,USER_0));
  assertTrue(bitmapDirectoryExists(CALLING_PACKAGE_3,USER_0));
  assertTrue(bitmapDirectoryExists(CALLING_PACKAGE_1,USER_10));
  assertTrue(bitmapDirectoryExists(CALLING_PACKAGE_2,USER_10));
  assertTrue(bitmapDirectoryExists(CALLING_PACKAGE_3,USER_10));
  mService.mPackageMonitor.onReceive(getTestContext(),genPackageDataClear(CALLING_PACKAGE_2,USER_10));
  assertNull(mService.getPackageShortcutForTest(CALLING_PACKAGE_1,"s1",USER_0));
  assertNotNull(mService.getPackageShortcutForTest(CALLING_PACKAGE_2,"s1",USER_0));
  assertNotNull(mService.getPackageShortcutForTest(CALLING_PACKAGE_3,"s1",USER_0));
  assertNotNull(mService.getPackageShortcutForTest(CALLING_PACKAGE_1,"s1",USER_10));
  assertNull(mService.getPackageShortcutForTest(CALLING_PACKAGE_2,"s1",USER_10));
  assertNotNull(mService.getPackageShortcutForTest(CALLING_PACKAGE_3,"s1",USER_10));
  assertFalse(bitmapDirectoryExists(CALLING_PACKAGE_1,USER_0));
  assertTrue(bitmapDirectoryExists(CALLING_PACKAGE_2,USER_0));
  assertTrue(bitmapDirectoryExists(CALLING_PACKAGE_3,USER_0));
  assertTrue(bitmapDirectoryExists(CALLING_PACKAGE_1,USER_10));
  assertFalse(bitmapDirectoryExists(CALLING_PACKAGE_2,USER_10));
  assertTrue(bitmapDirectoryExists(CALLING_PACKAGE_3,USER_10));
}
