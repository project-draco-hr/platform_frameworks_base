{
  setCaller(CALLING_PACKAGE_1,USER_10);
  final Icon bmp32x32=Icon.createWithBitmap(BitmapFactory.decodeResource(getTestContext().getResources(),R.drawable.black_32x32));
  PersistableBundle pb=new PersistableBundle();
  pb.putInt("k",1);
  ShortcutInfo sorig=new ShortcutInfo.Builder(mClientContext).setId("id").setActivityComponent(new ComponentName(mClientContext,ShortcutActivity2.class)).setIcon(bmp32x32).setTitle("title").setText("text").setCategories(set(ShortcutInfo.SHORTCUT_CATEGORY_CONVERSATION,"xyz")).setIntent(makeIntent("action",ShortcutActivity.class,"key","val")).setWeight(123).setExtras(pb).build();
  mManager.addDynamicShortcuts(list(sorig));
  Thread.sleep(2);
  final long now=System.currentTimeMillis();
  mService.saveDirtyInfo();
  initService();
  mService.handleUnlockUser(USER_10);
  ShortcutInfo si;
  si=mService.getPackageShortcutForTest(CALLING_PACKAGE_1,"id",USER_10);
  assertEquals(USER_10,si.getUserId());
  assertEquals(HANDLE_USER_10,si.getUserHandle());
  assertEquals(CALLING_PACKAGE_1,si.getPackageName());
  assertEquals("id",si.getId());
  assertEquals(ShortcutActivity2.class.getName(),si.getActivityComponent().getClassName());
  assertEquals(null,si.getIcon());
  assertEquals("title",si.getTitle());
  assertEquals("text",si.getText());
  assertEquals(set(ShortcutInfo.SHORTCUT_CATEGORY_CONVERSATION,"xyz"),si.getCategories());
  assertEquals("action",si.getIntent().getAction());
  assertEquals("val",si.getIntent().getStringExtra("key"));
  assertEquals(123,si.getWeight());
  assertEquals(1,si.getExtras().getInt("k"));
  assertEquals(ShortcutInfo.FLAG_DYNAMIC | ShortcutInfo.FLAG_HAS_ICON_FILE,si.getFlags());
  assertNotNull(si.getBitmapPath());
  assertEquals(0,si.getIconResourceId());
  assertTrue(si.getLastChangedTimestamp() < now);
}
