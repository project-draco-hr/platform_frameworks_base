{
  final Icon res32x32=Icon.createWithResource(getTestContext(),R.drawable.black_32x32);
  final Icon res64x64=Icon.createWithResource(getTestContext(),R.drawable.black_64x64);
  final Icon res512x512=Icon.createWithResource(getTestContext(),R.drawable.black_512x512);
  final Icon bmp32x32=Icon.createWithBitmap(BitmapFactory.decodeResource(getTestContext().getResources(),R.drawable.black_32x32));
  final Icon bmp64x64=Icon.createWithBitmap(BitmapFactory.decodeResource(getTestContext().getResources(),R.drawable.black_64x64));
  final Icon bmp512x512=Icon.createWithBitmap(BitmapFactory.decodeResource(getTestContext().getResources(),R.drawable.black_512x512));
  setCaller(CALLING_PACKAGE_1);
  assertTrue(mManager.setDynamicShortcuts(list(makeShortcutWithIcon("res32x32",res32x32),makeShortcutWithIcon("res64x64",res64x64),makeShortcutWithIcon("bmp32x32",bmp32x32),makeShortcutWithIcon("bmp64x64",bmp64x64),makeShortcutWithIcon("bmp512x512",bmp512x512),makeShortcut("none"))));
  assertShortcutIds(assertAllNotHaveIcon(mManager.getDynamicShortcuts()),"res32x32","res64x64","bmp32x32","bmp64x64","bmp512x512","none");
  setCaller(CALLING_PACKAGE_2);
  assertTrue(mManager.setDynamicShortcuts(list(makeShortcutWithIcon("res32x32",res512x512),makeShortcutWithIcon("res64x64",res512x512),makeShortcutWithIcon("none",res512x512))));
  assertShortcutIds(assertAllNotHaveIcon(mManager.getDynamicShortcuts()),"res32x32","res64x64","none");
  mService.saveDirtyInfo();
  initService();
  Bitmap bmp;
  setCaller(LAUNCHER_1);
  assertShortcutIds(assertAllHaveIconResId(mLauncherApps.getShortcutInfo(CALLING_PACKAGE_1,list("res32x32"),getCallingUser())),"res32x32");
  assertShortcutIds(assertAllHaveIconResId(mLauncherApps.getShortcutInfo(CALLING_PACKAGE_1,list("res64x64"),getCallingUser())),"res64x64");
  assertShortcutIds(assertAllHaveIconFile(mLauncherApps.getShortcutInfo(CALLING_PACKAGE_1,list("bmp32x32"),getCallingUser())),"bmp32x32");
  assertShortcutIds(assertAllHaveIconFile(mLauncherApps.getShortcutInfo(CALLING_PACKAGE_1,list("bmp64x64"),getCallingUser())),"bmp64x64");
  assertShortcutIds(assertAllHaveIconFile(mLauncherApps.getShortcutInfo(CALLING_PACKAGE_1,list("bmp512x512"),getCallingUser())),"bmp512x512");
  assertEquals(R.drawable.black_32x32,mLauncherApps.getShortcutIconResId(makePackageShortcut(CALLING_PACKAGE_1,"res32x32"),getCallingUser()));
  assertEquals(R.drawable.black_64x64,mLauncherApps.getShortcutIconResId(makePackageShortcut(CALLING_PACKAGE_1,"res64x64"),getCallingUser()));
  assertEquals(0,mLauncherApps.getShortcutIconResId(makePackageShortcut(CALLING_PACKAGE_1,"bmp32x32"),getCallingUser()));
  assertEquals(0,mLauncherApps.getShortcutIconResId(makePackageShortcut(CALLING_PACKAGE_1,"bmp64x64"),getCallingUser()));
  assertEquals(0,mLauncherApps.getShortcutIconResId(makePackageShortcut(CALLING_PACKAGE_1,"bmp512x512"),getCallingUser()));
  bmp=pfdToBitmap(mLauncherApps.getShortcutIconFd(makePackageShortcut(CALLING_PACKAGE_1,"bmp32x32"),getCallingUser()));
  assertBitmapSize(32,32,bmp);
  bmp=pfdToBitmap(mLauncherApps.getShortcutIconFd(makePackageShortcut(CALLING_PACKAGE_1,"bmp64x64"),getCallingUser()));
  assertBitmapSize(64,64,bmp);
  bmp=pfdToBitmap(mLauncherApps.getShortcutIconFd(makePackageShortcut(CALLING_PACKAGE_1,"bmp512x512"),getCallingUser()));
  assertBitmapSize(128,128,bmp);
}
