{
  if (predictions == null) {
    predictions=new ArrayList<Prediction>();
  }
 else {
    predictions.clear();
  }
  final float[] intermediateOutput=compute(mHiddenLayer,vector);
  final float[] output=compute(mOutputLayer,intermediateOutput);
  double sum=0;
  final String[] classes=mClasses;
  final int count=classes.length;
  for (int i=0; i < count; i++) {
    double score=output[i];
    sum+=score;
    predictions.add(new Prediction(classes[i],score));
  }
  for (int i=0; i < count; i++) {
    predictions.get(i).score/=sum;
  }
  Collections.sort(predictions,mComparator);
  return predictions;
}
