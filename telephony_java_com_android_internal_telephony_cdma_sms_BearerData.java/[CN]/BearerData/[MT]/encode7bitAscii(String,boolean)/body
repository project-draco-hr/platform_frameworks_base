{
  try {
    BitwiseOutputStream outStream=new BitwiseOutputStream(msg.length());
    byte[] expandedData=msg.getBytes("US-ASCII");
    for (int i=0; i < expandedData.length; i++) {
      int charCode=expandedData[i];
      if ((charCode < UserData.PRINTABLE_ASCII_MIN_INDEX) || (charCode > UserData.PRINTABLE_ASCII_MAX_INDEX)) {
        if (force) {
          outStream.write(7,UserData.UNENCODABLE_7_BIT_CHAR);
        }
 else {
          throw new CodingException("illegal ASCII code (" + charCode + ")");
        }
      }
 else {
        outStream.write(7,expandedData[i]);
      }
    }
    return new SeptetData(outStream.toByteArray(),expandedData.length);
  }
 catch (  java.io.UnsupportedEncodingException ex) {
    throw new CodingException("7bit ASCII encode failed: " + ex);
  }
catch (  BitwiseOutputStream.AccessException ex) {
    throw new CodingException("7bit ASCII encode failed: " + ex);
  }
}
