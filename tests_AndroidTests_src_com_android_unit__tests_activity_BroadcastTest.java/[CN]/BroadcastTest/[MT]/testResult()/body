{
  TestBroadcastReceiver broadcastReceiver=new TestBroadcastReceiver();
synchronized (this) {
    Bundle map=new Bundle();
    map.putString("foo","you");
    map.putString("remove","me");
    getContext().sendOrderedBroadcast(new Intent("com.android.unit_tests.activity.BROADCAST_RESULT"),null,broadcastReceiver,null,1,"foo",map);
    while (!broadcastReceiver.mHaveResult) {
      try {
        wait();
      }
 catch (      InterruptedException e) {
      }
    }
    assertEquals("Incorrect code: " + broadcastReceiver.getResultCode(),3,broadcastReceiver.getResultCode());
    assertEquals("bar",broadcastReceiver.getResultData());
    Bundle resultExtras=broadcastReceiver.getResultExtras(false);
    assertEquals("them",resultExtras.getString("bar"));
    assertEquals("you",resultExtras.getString("foo"));
    assertNull(resultExtras.getString("remove"));
  }
}
