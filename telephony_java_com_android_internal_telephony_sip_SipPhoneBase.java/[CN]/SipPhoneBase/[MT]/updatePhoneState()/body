{
  State oldState=state;
  if (getRingingCall().isRinging()) {
    state=State.RINGING;
  }
 else   if (getForegroundCall().isIdle() && getBackgroundCall().isIdle()) {
    state=State.IDLE;
  }
 else {
    state=State.OFFHOOK;
  }
  Log.e(LOG_TAG,"    ^^^^^^   new phone state: " + state);
  if (state != oldState) {
    notifyPhoneStateChanged();
  }
}
