{
  State oldState=state;
  if (getRingingCall().isRinging()) {
    state=State.RINGING;
  }
 else   if (getForegroundCall().isIdle() && getBackgroundCall().isIdle()) {
    state=State.IDLE;
  }
 else {
    state=State.OFFHOOK;
  }
  if (state != oldState) {
    Log.d(LOG_TAG," ^^^ new phone state: " + state);
    notifyPhoneStateChanged();
  }
}
