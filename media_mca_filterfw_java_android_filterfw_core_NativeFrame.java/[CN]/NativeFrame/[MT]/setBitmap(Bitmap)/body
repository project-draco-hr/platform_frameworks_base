{
  assertFrameMutable();
  if (getFormat().getNumberOfDimensions() != 2) {
    throw new RuntimeException("Attempting to set Bitmap for non 2-dimensional native frame!");
  }
 else   if (getFormat().getWidth() != bitmap.getWidth() || getFormat().getHeight() != bitmap.getHeight()) {
    throw new RuntimeException("Bitmap dimensions do not match native frame dimensions!");
  }
 else {
    Bitmap rgbaBitmap=convertBitmapToRGBA(bitmap);
    int byteCount=rgbaBitmap.getByteCount();
    int bps=getFormat().getBytesPerSample();
    if (!setNativeBitmap(rgbaBitmap,byteCount,bps)) {
      throw new RuntimeException("Could not set native frame bitmap data!");
    }
  }
}
