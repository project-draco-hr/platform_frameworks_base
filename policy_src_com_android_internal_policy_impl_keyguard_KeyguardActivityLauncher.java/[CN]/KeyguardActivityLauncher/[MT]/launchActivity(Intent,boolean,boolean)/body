{
  final Context context=getContext();
  final Bundle animation=animate ? null : ActivityOptions.makeCustomAnimation(context,0,0).toBundle();
  LockPatternUtils lockPatternUtils=getLockPatternUtils();
  intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_SINGLE_TOP | Intent.FLAG_ACTIVITY_CLEAR_TOP);
  boolean isSecure=lockPatternUtils.isSecure();
  if (!isSecure || showsWhileLocked) {
    if (!isSecure)     try {
      ActivityManagerNative.getDefault().dismissKeyguardOnNextActivity();
    }
 catch (    RemoteException e) {
      Log.w(TAG,"can't dismiss keyguard on launch");
    }
    try {
      if (DEBUG)       Log.d(TAG,String.format("Starting activity for intent %s at %s",intent,SystemClock.uptimeMillis()));
      context.startActivityAsUser(intent,animation,new UserHandle(UserHandle.USER_CURRENT));
    }
 catch (    ActivityNotFoundException e) {
      Log.w(TAG,"Activity not found for intent + " + intent.getAction());
    }
  }
 else {
    KeyguardSecurityCallback callback=getCallback();
    callback.setOnDismissRunnable(new Runnable(){
      @Override public void run(){
        context.startActivityAsUser(intent,animation,new UserHandle(UserHandle.USER_CURRENT));
      }
    }
);
    callback.dismiss(false);
  }
}
