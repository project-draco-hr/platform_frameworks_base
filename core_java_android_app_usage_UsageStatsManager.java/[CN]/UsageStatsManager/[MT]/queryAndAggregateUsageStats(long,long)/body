{
  List<UsageStats> stats=queryUsageStats(INTERVAL_BEST,beginTime,endTime);
  if (stats.isEmpty()) {
    @SuppressWarnings("unchecked") ArrayMap<String,UsageStats> emptyStats=ArrayMap.EMPTY;
    return emptyStats;
  }
  ArrayMap<String,UsageStats> aggregatedStats=new ArrayMap<>();
  final int statCount=stats.size();
  for (int i=0; i < statCount; i++) {
    UsageStats newStat=stats.get(i);
    UsageStats existingStat=aggregatedStats.get(newStat.getPackageName());
    if (existingStat == null) {
      aggregatedStats.put(newStat.mPackageName,newStat);
    }
 else {
      existingStat.add(newStat);
    }
  }
  return aggregatedStats;
}
