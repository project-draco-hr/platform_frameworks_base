{
  final int state;
  try {
    state=packageManager.getApplicationEnabledSetting(packageName,userId);
  }
 catch (  RemoteException e) {
    Slog.w(TAG,"getApplicationEnabledSetting failed. packageName=" + packageName + " userId="+ userId,e);
    return;
  }
  if (state == PackageManager.COMPONENT_ENABLED_STATE_DEFAULT || state == PackageManager.COMPONENT_ENABLED_STATE_ENABLED) {
    if (DEBUG) {
      Slog.d(TAG,"Update state(" + packageName + "): DISABLED_UNTIL_USED");
    }
    try {
      packageManager.setApplicationEnabledSetting(packageName,PackageManager.COMPONENT_ENABLED_STATE_DISABLED_UNTIL_USED,0,userId,callingPackage);
    }
 catch (    RemoteException e) {
      Slog.w(TAG,"setApplicationEnabledSetting failed. packageName=" + packageName + " userId="+ userId+ " callingPackage="+ callingPackage,e);
      return;
    }
  }
 else {
    if (DEBUG) {
      Slog.d(TAG,packageName + " is already DISABLED_UNTIL_USED");
    }
  }
}
