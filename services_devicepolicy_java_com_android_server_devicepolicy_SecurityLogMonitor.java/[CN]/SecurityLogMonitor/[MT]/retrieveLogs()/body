{
  mLock.lock();
  try {
    if (mAllowedToRetrieve) {
      mAllowedToRetrieve=false;
      mNextAllowedRetrivalTimeMillis=System.currentTimeMillis() + RATE_LIMIT_INTERVAL_MILLISECONDS;
      List<SecurityEvent> result=mPendingLogs;
      mPendingLogs=new ArrayList<SecurityEvent>();
      return result;
    }
 else {
      return null;
    }
  }
  finally {
    mLock.unlock();
  }
}
