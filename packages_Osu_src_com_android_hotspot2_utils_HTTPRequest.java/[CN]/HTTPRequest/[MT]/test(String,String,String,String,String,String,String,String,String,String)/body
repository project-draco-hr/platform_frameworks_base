{
  byte[] a1=hash(user,realm,password);
  System.out.println("HA1: " + bytesToHex(a1));
  byte[] a2=hash(method,path);
  System.out.println("HA2: " + bytesToHex(a2));
  byte[] response=hash(a1,nonce,nc,cnonce,qop,a2);
  StringBuilder authLine=new StringBuilder();
  String responseString=bytesToHex(response);
  authLine.append("Digest ").append("username=\"").append(user).append("\", ").append("realm=\"").append(realm).append("\", ").append("nonce=\"").append(nonce).append("\", ").append("uri=\"").append(path).append("\", ").append("qop=\"").append(qop).append("\", ").append("nc=").append(nc).append(", ").append("cnonce=\"").append(cnonce).append("\", ").append("response=\"").append(responseString).append('"');
  System.out.println(authLine);
  System.out.println("Success: " + responseString.equals(expect));
}
