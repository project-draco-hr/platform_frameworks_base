{
  try {
    if (record[curOffset] == 0 || (record[curOffset] & 0xff) == 0xff) {
      return false;
    }
    if ((record[curOffset + 1] & 0xff) < 0x80) {
      curDataLength=record[curOffset + 1] & 0xff;
      curDataOffset=curOffset + 2;
    }
 else     if ((record[curOffset + 1] & 0xff) == 0x81) {
      curDataLength=record[curOffset + 2] & 0xff;
      curDataOffset=curOffset + 3;
    }
 else {
      return false;
    }
  }
 catch (  ArrayIndexOutOfBoundsException ex) {
    return false;
  }
  if (curDataLength + curDataOffset > tlvOffset + tlvLength) {
    return false;
  }
  return true;
}
