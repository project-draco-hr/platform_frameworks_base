{
  Cursor c=query(uri,new String[]{"_data"},null,null,null);
  int count=(c != null) ? c.getCount() : 0;
  if (count != 1) {
    if (c != null) {
      c.close();
    }
    if (count == 0) {
      throw new FileNotFoundException("No entry for " + uri);
    }
    throw new FileNotFoundException("Multiple items at " + uri);
  }
  c.moveToFirst();
  int i=c.getColumnIndex("_data");
  String path=(i >= 0 ? c.getString(i) : null);
  c.close();
  if (path == null) {
    throw new FileNotFoundException("Column _data not found.");
  }
  int modeBits;
  if ("r".equals(mode)) {
    modeBits=ParcelFileDescriptor.MODE_READ_ONLY;
  }
 else   if ("rw".equals(mode)) {
    modeBits=ParcelFileDescriptor.MODE_READ_WRITE | ParcelFileDescriptor.MODE_CREATE;
  }
 else {
    throw new FileNotFoundException("Bad mode for " + uri + ": "+ mode);
  }
  return ParcelFileDescriptor.open(new File(path),modeBits);
}
