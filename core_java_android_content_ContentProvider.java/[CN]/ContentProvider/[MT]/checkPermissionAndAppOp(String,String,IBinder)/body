{
  if (getContext().checkPermission(permission,Binder.getCallingPid(),Binder.getCallingUid(),callerToken) != PERMISSION_GRANTED) {
    return MODE_ERRORED;
  }
  final int permOp=AppOpsManager.permissionToOpCode(permission);
  if (permOp != AppOpsManager.OP_NONE) {
    return mTransport.mAppOpsManager.noteProxyOp(permOp,callingPkg);
  }
  return MODE_ALLOWED;
}
