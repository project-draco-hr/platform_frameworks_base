{
  final String wperm=getWritePermission();
  final int pid=Binder.getCallingPid();
  final int uid=Binder.getCallingUid();
  if (getContext().checkUriPermission(uri,null,wperm,pid,uid,Intent.FLAG_GRANT_WRITE_URI_PERMISSION) == PackageManager.PERMISSION_GRANTED) {
    return;
  }
  String msg="Permission Denial: writing " + ContentProvider.this.getClass().getName() + " uri "+ uri+ " from pid="+ Binder.getCallingPid()+ ", uid="+ Binder.getCallingUid()+ " requires "+ wperm;
  throw new SecurityException(msg);
}
