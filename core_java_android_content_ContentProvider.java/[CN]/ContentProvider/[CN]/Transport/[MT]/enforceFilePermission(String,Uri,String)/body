{
  if (mode != null && mode.startsWith("rw")) {
    if (enforceWritePermission(callingPkg,uri) != AppOpsManager.MODE_ALLOWED) {
      throw new FileNotFoundException("App op not allowed");
    }
  }
 else {
    if (enforceReadPermission(callingPkg,uri) != AppOpsManager.MODE_ALLOWED) {
      throw new FileNotFoundException("App op not allowed");
    }
  }
}
