{
  final Context context=getContext();
  final int pid=Binder.getCallingPid();
  final int uid=Binder.getCallingUid();
  if (uid == mMyUid) {
    return true;
  }
 else   if (mExported) {
    final String componentPerm=getReadPermission();
    if (componentPerm != null && (context.checkPermission(componentPerm,pid,uid) == PERMISSION_GRANTED)) {
      return true;
    }
    boolean allowDefaultRead=(componentPerm == null);
    final PathPermission[] pps=getPathPermissions();
    if (pps != null) {
      final String path=uri.getPath();
      for (      PathPermission pp : pps) {
        final String pathPerm=pp.getReadPermission();
        if (pathPerm != null && pp.match(path)) {
          if (context.checkPermission(pathPerm,pid,uid) == PERMISSION_GRANTED) {
            return true;
          }
 else {
            allowDefaultRead=false;
          }
        }
      }
    }
    if (allowDefaultRead)     return true;
  }
  if (context.checkUriPermission(uri,pid,uid,Intent.FLAG_GRANT_READ_URI_PERMISSION) == PERMISSION_GRANTED) {
    return true;
  }
  return false;
}
