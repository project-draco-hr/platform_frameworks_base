{
  final String imageItemFileName=INPUT_FILE_PATH + "IMG_640x480.jpg";
  final int renderingMode=MediaItem.RENDERING_MODE_BLACK_BORDER;
  final String[] loggingInfo=new String[2];
  final MediaImageItem mediaImageItem=new MediaImageItem(mVideoEditor,"m1",imageItemFileName,5000,renderingMode);
  System.gc();
  final Runtime runtimeObjStart=Runtime.getRuntime();
  final long javaMemStart=runtimeObjStart.totalMemory();
  final long nativeMemStart=Debug.getNativeHeapAllocatedSize();
  for (int i=0; i < 200; i++) {
    if (i % 4 == 0) {
      final Bitmap[] thumbNails=mediaImageItem.getThumbnailList(mediaImageItem.getWidth() / 2,mediaImageItem.getHeight() / 2,i,5000,2);
      for (int i1=0; i1 < thumbNails.length; i1++) {
        thumbNails[i1].recycle();
      }
    }
    if (i % 4 == 1) {
      final Bitmap[] thumbNails=mediaImageItem.getThumbnailList(mediaImageItem.getWidth() / 2,mediaImageItem.getHeight() * 3,i,5000,2);
      for (int i1=0; i1 < thumbNails.length; i1++) {
        thumbNails[i1].recycle();
      }
    }
    if (i % 4 == 2) {
      final Bitmap[] thumbNails=mediaImageItem.getThumbnailList(mediaImageItem.getWidth() * 2,mediaImageItem.getHeight() / 3,i,5000,2);
      for (int i1=0; i1 < thumbNails.length; i1++) {
        thumbNails[i1].recycle();
      }
    }
    if (i % 4 == 3) {
      final Bitmap[] thumbNails=mediaImageItem.getThumbnailList(mediaImageItem.getWidth(),mediaImageItem.getHeight(),i,5000,2);
      for (int i1=0; i1 < thumbNails.length; i1++) {
        thumbNails[i1].recycle();
      }
    }
  }
  System.gc();
  Thread.sleep(2500);
  final Runtime runtimeObjEnd=Runtime.getRuntime();
  final long javaMemEnd=runtimeObjEnd.totalMemory();
  final long nativeMemEnd=Debug.getNativeHeapAllocatedSize();
  loggingInfo[0]="Java Memory at Start = " + javaMemStart + "\t\tJava Memory at End = "+ javaMemEnd+ "\t\tJava Memory (End - Start) = "+ (javaMemEnd - javaMemStart);
  loggingInfo[1]="Native Memory at Start = " + nativeMemStart + "\tNative Memory at End = "+ nativeMemEnd+ "\t\tNative Memory (End-Start) = "+ (nativeMemEnd - nativeMemStart);
  writeTimingInfo("testStressThumbnailImageItem",loggingInfo);
}
