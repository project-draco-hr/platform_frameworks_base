{
  Context context=getContext();
  while (context instanceof ContextWrapper && !(context instanceof Activity)) {
    context=((ContextWrapper)context).getBaseContext();
  }
  if (!(context instanceof Activity)) {
    throw new IllegalStateException("The MediaRouteButton's Context is not an Activity.");
  }
  return (Activity)context;
}
