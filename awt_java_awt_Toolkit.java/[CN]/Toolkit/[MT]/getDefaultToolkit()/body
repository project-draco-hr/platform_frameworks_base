{
synchronized (ContextStorage.getContextLock()) {
    if (ContextStorage.shutdownPending()) {
      return null;
    }
    Toolkit defToolkit=ContextStorage.getDefaultToolkit();
    if (defToolkit != null) {
      return defToolkit;
    }
    staticLockAWT();
    try {
      defToolkit=GraphicsEnvironment.isHeadless() ? new HeadlessToolkit() : new ToolkitImpl();
      ContextStorage.setDefaultToolkit(defToolkit);
      return defToolkit;
    }
  finally {
      staticUnlockAWT();
    }
  }
}
