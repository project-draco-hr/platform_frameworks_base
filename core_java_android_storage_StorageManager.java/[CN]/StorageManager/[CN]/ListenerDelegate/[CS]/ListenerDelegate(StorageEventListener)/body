{
  mStorageEventListener=listener;
  mHandler=new Handler(mTgtLooper){
    @Override public void handleMessage(    Message msg){
      StorageEvent e=(StorageEvent)msg.obj;
      if (msg.what == StorageEvent.EVENT_SHARE_AVAILABILITY_CHANGED) {
        ShareAvailabilityChangedStorageEvent ev=(ShareAvailabilityChangedStorageEvent)e;
        mStorageEventListener.onShareAvailabilityChanged(ev.method,ev.available);
      }
 else       if (msg.what == StorageEvent.EVENT_MEDIA_INSERTED) {
        MediaInsertedStorageEvent ev=(MediaInsertedStorageEvent)e;
        mStorageEventListener.onMediaInserted(ev.label,ev.path,ev.major,ev.minor);
      }
 else       if (msg.what == StorageEvent.EVENT_MEDIA_REMOVED) {
        MediaRemovedStorageEvent ev=(MediaRemovedStorageEvent)e;
        mStorageEventListener.onMediaRemoved(ev.label,ev.path,ev.major,ev.minor,ev.clean);
      }
 else       if (msg.what == StorageEvent.EVENT_VOLUME_STATE_CHANGED) {
        VolumeStateChangedStorageEvent ev=(VolumeStateChangedStorageEvent)e;
        mStorageEventListener.onVolumeStateChanged(ev.label,ev.path,ev.oldState,ev.newState);
      }
 else {
        Log.e(TAG,"Unsupported event " + msg.what);
      }
    }
  }
;
}
