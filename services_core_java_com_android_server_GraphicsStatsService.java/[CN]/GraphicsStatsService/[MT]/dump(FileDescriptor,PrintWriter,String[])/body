{
  mContext.enforceCallingOrSelfPermission(android.Manifest.permission.DUMP,TAG);
synchronized (mLock) {
    for (int i=0; i < mActive.size(); i++) {
      final ActiveBuffer buffer=mActive.get(i);
      fout.print("Package: ");
      fout.print(buffer.mPackageName);
      fout.flush();
      try {
        buffer.mProcessBuffer.readBytes(mTempBuffer,0,0,ASHMEM_SIZE);
        ThreadedRenderer.dumpProfileData(mTempBuffer,fd);
      }
 catch (      IOException e) {
        fout.println("Failed to dump");
      }
      fout.println();
    }
    for (    HistoricalData buffer : mHistoricalLog) {
      if (buffer == null)       continue;
      fout.print("Package: ");
      fout.print(buffer.mPackageName);
      fout.flush();
      ThreadedRenderer.dumpProfileData(buffer.mBuffer,fd);
      fout.println();
    }
  }
}
