{
  int uid=Binder.getCallingUid();
  int pid=Binder.getCallingPid();
  ParcelFileDescriptor pfd=null;
  long callingIdentity=Binder.clearCallingIdentity();
  try {
    mAppOps.checkPackage(uid,packageName);
synchronized (mLock) {
      pfd=requestBufferForProcessLocked(token,uid,pid,packageName);
    }
  }
  finally {
    Binder.restoreCallingIdentity(callingIdentity);
  }
  return pfd;
}
