{
  final int specMode=MeasureSpec.getMode(measureSpec);
  final int specSize=MeasureSpec.getSize(measureSpec);
  final int result;
switch (specMode) {
case MeasureSpec.AT_MOST:
    if (specSize < size) {
      result=specSize | MEASURED_STATE_TOO_SMALL;
    }
 else {
      result=size;
    }
  break;
case MeasureSpec.EXACTLY:
result=specSize;
break;
case MeasureSpec.UNSPECIFIED:
default :
result=size;
}
return result | (childMeasuredState & MEASURED_STATE_MASK);
}
