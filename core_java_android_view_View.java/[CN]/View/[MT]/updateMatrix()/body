{
  if (mMatrixDirty) {
    if ((mPrivateFlags & PIVOT_EXPLICITLY_SET) == 0) {
      if ((mRight - mLeft) != mPrevWidth || (mBottom - mTop) != mPrevHeight) {
        mPrevWidth=mRight - mLeft;
        mPrevHeight=mBottom - mTop;
        mPivotX=(float)mPrevWidth / 2f;
        mPivotY=(float)mPrevHeight / 2f;
      }
    }
    mMatrix.reset();
    if (!nonzero(mRotationX) && !nonzero(mRotationY)) {
      mMatrix.setTranslate(mTranslationX,mTranslationY);
      mMatrix.preRotate(mRotation,mPivotX,mPivotY);
      mMatrix.preScale(mScaleX,mScaleY,mPivotX,mPivotY);
    }
 else {
      if (mCamera == null) {
        mCamera=new Camera();
        matrix3D=new Matrix();
      }
      mCamera.save();
      mMatrix.preScale(mScaleX,mScaleY,mPivotX,mPivotY);
      mCamera.rotateX(mRotationX);
      mCamera.rotateY(mRotationY);
      mCamera.rotateZ(-mRotation);
      mCamera.getMatrix(matrix3D);
      matrix3D.preTranslate(-mPivotX,-mPivotY);
      matrix3D.postTranslate(mPivotX + mTranslationX,mPivotY + mTranslationY);
      mMatrix.postConcat(matrix3D);
      mCamera.restore();
    }
    mMatrixDirty=false;
    mMatrixIsIdentity=mMatrix.isIdentity();
    mInverseMatrixDirty=true;
  }
}
