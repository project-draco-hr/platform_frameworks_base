{
  final int overscrollMode=mOverscrollMode;
  final boolean canScrollHorizontal=computeHorizontalScrollRange() > computeHorizontalScrollExtent();
  final boolean canScrollVertical=computeVerticalScrollRange() > computeVerticalScrollExtent();
  final boolean overscrollHorizontal=overscrollMode == OVERSCROLL_ALWAYS || (overscrollMode == OVERSCROLL_IF_CONTENT_SCROLLS && canScrollHorizontal);
  final boolean overscrollVertical=overscrollMode == OVERSCROLL_ALWAYS || (overscrollMode == OVERSCROLL_IF_CONTENT_SCROLLS && canScrollVertical);
  int newScrollX=scrollX + deltaX;
  if (overscrollHorizontal) {
    final int dropoffX=maxOverscrollX / 2;
    final int dropoffLeft=-dropoffX;
    final int dropoffRight=dropoffX + scrollRangeX;
    if ((scrollX < dropoffLeft && deltaX < 0) || (scrollX > dropoffRight && deltaX > 0)) {
      newScrollX=scrollX + deltaX / 2;
    }
 else {
      if (newScrollX > dropoffRight && deltaX > 0) {
        int extra=newScrollX - dropoffRight;
        newScrollX=dropoffRight + extra / 2;
      }
 else       if (newScrollX < dropoffLeft && deltaX < 0) {
        int extra=newScrollX - dropoffLeft;
        newScrollX=dropoffLeft + extra / 2;
      }
    }
  }
 else {
    maxOverscrollX=0;
  }
  int newScrollY=scrollY + deltaY;
  if (overscrollVertical) {
    final int dropoffY=maxOverscrollY / 2;
    final int dropoffTop=-dropoffY;
    final int dropoffBottom=dropoffY + scrollRangeY;
    if ((scrollY < dropoffTop && deltaY < 0) || (scrollY > dropoffBottom && deltaY > 0)) {
      newScrollY=scrollY + deltaY / 2;
    }
 else {
      if (newScrollY > dropoffBottom && deltaY > 0) {
        int extra=newScrollY - dropoffBottom;
        newScrollY=dropoffBottom + extra / 2;
      }
 else       if (newScrollY < dropoffTop && deltaY < 0) {
        int extra=newScrollY - dropoffTop;
        newScrollY=dropoffTop + extra / 2;
      }
    }
  }
 else {
    maxOverscrollY=0;
  }
  final int left=-maxOverscrollX;
  final int right=maxOverscrollX + scrollRangeX;
  final int top=-maxOverscrollY;
  final int bottom=maxOverscrollY + scrollRangeY;
  boolean clampedX=false;
  if (newScrollX > right) {
    newScrollX=right;
    clampedX=true;
  }
 else   if (newScrollX < left) {
    newScrollX=left;
    clampedX=true;
  }
  boolean clampedY=false;
  if (newScrollY > bottom) {
    newScrollY=bottom;
    clampedY=true;
  }
 else   if (newScrollY < top) {
    newScrollY=top;
    clampedY=true;
  }
  if (isTouchEvent && ((overscrollHorizontal && clampedX && scrollX != left && scrollX != right) || (overscrollVertical && clampedY && scrollY != top && scrollY != bottom))) {
    performHapticFeedback(HapticFeedbackConstants.SCROLL_BARRIER);
  }
  onOverscrolled(newScrollX,newScrollY,clampedX,clampedY);
  return clampedX || clampedY;
}
