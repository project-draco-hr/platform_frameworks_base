{
  if (gainFocus) {
    if (AccessibilityManager.getInstance(mContext).isEnabled()) {
      sendAccessibilityEvent(AccessibilityEvent.TYPE_VIEW_FOCUSED);
    }
  }
  InputMethodManager imm=InputMethodManager.peekInstance();
  if (!gainFocus) {
    if (isPressed()) {
      setPressed(false);
    }
    if (imm != null && mAttachInfo != null && mAttachInfo.mHasWindowFocus) {
      imm.focusOut(this);
    }
    onFocusLost();
  }
 else   if (imm != null && mAttachInfo != null && mAttachInfo.mHasWindowFocus) {
    imm.focusIn(this);
  }
  invalidate(true);
  ListenerInfo li=mListenerInfo;
  if (li != null && li.mOnFocusChangeListener != null) {
    li.mOnFocusChangeListener.onFocusChange(this,gainFocus);
  }
  if (mAttachInfo != null) {
    mAttachInfo.mKeyDispatchState.reset(this);
  }
}
