{
  final int width=mRight - mLeft;
  final int height=mBottom - mTop;
  Bitmap bitmap=Bitmap.createBitmap(width,height,quality);
  if (bitmap == null) {
    throw new OutOfMemoryError();
  }
  Canvas canvas;
  final AttachInfo attachInfo=mAttachInfo;
  if (attachInfo != null) {
    canvas=attachInfo.mCanvas;
    if (canvas == null) {
      canvas=new Canvas();
    }
    canvas.setBitmap(bitmap);
    attachInfo.mCanvas=null;
  }
 else {
    canvas=new Canvas(bitmap);
  }
  if ((backgroundColor & 0xff000000) != 0) {
    bitmap.eraseColor(backgroundColor);
  }
  computeScroll();
  final int restoreCount=canvas.save();
  canvas.translate(-mScrollX,-mScrollY);
  if ((mPrivateFlags & SKIP_DRAW) == SKIP_DRAW) {
    dispatchDraw(canvas);
  }
 else {
    draw(canvas);
  }
  canvas.restoreToCount(restoreCount);
  if (attachInfo != null) {
    attachInfo.mCanvas=canvas;
  }
  return bitmap;
}
