{
  final HardwareRenderer renderer=getHardwareRenderer();
  if (renderNode == null) {
    throw new IllegalArgumentException("RenderNode must not be null");
  }
  if (renderer == null || !canHaveDisplayList()) {
    return;
  }
  if ((mPrivateFlags & PFLAG_DRAWING_CACHE_VALID) == 0 || !renderNode.isValid() || (!isLayer && mRecreateDisplayList)) {
    if (renderNode.isValid() && !isLayer && !mRecreateDisplayList) {
      mPrivateFlags|=PFLAG_DRAWN | PFLAG_DRAWING_CACHE_VALID;
      mPrivateFlags&=~PFLAG_DIRTY_MASK;
      dispatchGetDisplayList();
      return;
    }
    if (!isLayer) {
      mRecreateDisplayList=true;
    }
    boolean caching=false;
    int width=mRight - mLeft;
    int height=mBottom - mTop;
    int layerType=getLayerType();
    final HardwareCanvas canvas=renderNode.start(width,height);
    try {
      if (!isLayer && layerType != LAYER_TYPE_NONE) {
        if (layerType == LAYER_TYPE_HARDWARE) {
          final HardwareLayer layer=getHardwareLayer();
          if (layer != null && layer.isValid()) {
            canvas.drawHardwareLayer(layer,0,0,mLayerPaint);
          }
 else {
            canvas.saveLayer(0,0,mRight - mLeft,mBottom - mTop,mLayerPaint,Canvas.HAS_ALPHA_LAYER_SAVE_FLAG | Canvas.CLIP_TO_LAYER_SAVE_FLAG);
          }
          caching=true;
        }
 else {
          buildDrawingCache(true);
          Bitmap cache=getDrawingCache(true);
          if (cache != null) {
            canvas.drawBitmap(cache,0,0,mLayerPaint);
            caching=true;
          }
        }
      }
 else {
        computeScroll();
        canvas.translate(-mScrollX,-mScrollY);
        if (!isLayer) {
          mPrivateFlags|=PFLAG_DRAWN | PFLAG_DRAWING_CACHE_VALID;
          mPrivateFlags&=~PFLAG_DIRTY_MASK;
        }
        if ((mPrivateFlags & PFLAG_SKIP_DRAW) == PFLAG_SKIP_DRAW) {
          dispatchDraw(canvas);
          if (mOverlay != null && !mOverlay.isEmpty()) {
            mOverlay.getOverlayView().draw(canvas);
          }
        }
 else {
          draw(canvas);
        }
      }
    }
  finally {
      renderNode.end(renderer,canvas);
      renderNode.setCaching(caching);
      if (isLayer) {
        renderNode.setLeftTopRightBottom(0,0,width,height);
      }
 else {
        setDisplayListProperties(renderNode);
      }
      if (renderer != getHardwareRenderer()) {
        Log.w(VIEW_LOG_TAG,"View was detached during a draw() call!");
      }
    }
  }
 else   if (!isLayer) {
    mPrivateFlags|=PFLAG_DRAWN | PFLAG_DRAWING_CACHE_VALID;
    mPrivateFlags&=~PFLAG_DIRTY_MASK;
  }
}
