{
  int[] index=new int[1];
  if (!egl.eglChooseConfig(display,mConfigSpec,null,0,index)) {
    throw new IllegalArgumentException("eglChooseConfig failed " + getEGLErrorString(egl.eglGetError()));
  }
  int numConfigs=index[0];
  if (numConfigs <= 0) {
    throw new IllegalArgumentException("No configs match configSpec");
  }
  EGLConfig[] configs=new EGLConfig[numConfigs];
  if (!egl.eglChooseConfig(display,mConfigSpec,configs,numConfigs,index)) {
    throw new IllegalArgumentException("eglChooseConfig failed " + getEGLErrorString(egl.eglGetError()));
  }
  EGLConfig config=chooseConfig(egl,display,configs);
  if (config == null) {
    throw new IllegalArgumentException("No config chosen");
  }
  return config;
}
