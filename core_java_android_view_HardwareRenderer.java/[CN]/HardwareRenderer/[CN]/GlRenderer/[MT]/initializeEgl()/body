{
synchronized (sEglLock) {
    if (sEgl == null && sEglConfig == null) {
      sEgl=(EGL10)EGLContext.getEGL();
      sEglDisplay=sEgl.eglGetDisplay(EGL10.EGL_DEFAULT_DISPLAY);
      if (sEglDisplay == EGL10.EGL_NO_DISPLAY) {
        throw new RuntimeException("eglGetDisplay failed " + getEGLErrorString(sEgl.eglGetError()));
      }
      int[] version=new int[2];
      if (!sEgl.eglInitialize(sEglDisplay,version)) {
        throw new RuntimeException("eglInitialize failed " + getEGLErrorString(sEgl.eglGetError()));
      }
      sEglConfig=chooseEglConfig();
      if (sEglConfig == null) {
        if (sDirtyRegions) {
          sDirtyRegions=false;
          sEglConfig=chooseEglConfig();
          if (sEglConfig == null) {
            throw new RuntimeException("eglConfig not initialized");
          }
        }
 else {
          throw new RuntimeException("eglConfig not initialized");
        }
      }
    }
  }
  mEglContext=sEglContextStorage.get();
  mEglThread=Thread.currentThread();
  if (mEglContext == null) {
    mEglContext=createContext(sEgl,sEglDisplay,sEglConfig);
    sEglContextStorage.set(mEglContext);
  }
}
