{
  sEgl.eglMakeCurrent(sEglDisplay,EGL_NO_SURFACE,EGL_NO_SURFACE,EGL_NO_CONTEXT);
  if (mEglSurface != null && mEglSurface != EGL_NO_SURFACE) {
    sEgl.eglDestroySurface(sEglDisplay,mEglSurface);
  }
  if (holder.getSurface().isValid()) {
    mEglSurface=sEgl.eglCreateWindowSurface(sEglDisplay,sEglConfig,holder,null);
    if (mEglSurface == null || mEglSurface == EGL_NO_SURFACE) {
      int error=sEgl.eglGetError();
      if (error == EGL_BAD_NATIVE_WINDOW) {
        Log.e(LOG_TAG,"createWindowSurface returned EGL_BAD_NATIVE_WINDOW.");
        return;
      }
      throw new RuntimeException("createWindowSurface failed " + getEGLErrorString(error));
    }
  }
}
