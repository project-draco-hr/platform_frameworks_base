{
  if ((sVmPolicyMask & PENALTY_LOG) != 0) {
    Log.e(TAG,message,originStack);
  }
  boolean penaltyDropbox=(sVmPolicyMask & PENALTY_DROPBOX) != 0;
  boolean penaltyDeath=(sVmPolicyMask & PENALTY_DEATH) != 0;
  int violationMaskSubset=PENALTY_DROPBOX | DETECT_VM_CURSOR_LEAKS;
  ViolationInfo info=new ViolationInfo(originStack,sVmPolicyMask);
  if (penaltyDropbox && !penaltyDeath) {
    dropboxViolationAsync(violationMaskSubset,info);
    return;
  }
  if (penaltyDropbox) {
    final int savedPolicyMask=getThreadPolicyMask();
    try {
      setThreadPolicyMask(0);
      ActivityManagerNative.getDefault().handleApplicationStrictModeViolation(RuntimeInit.getApplicationObject(),violationMaskSubset,info);
    }
 catch (    RemoteException e) {
      Log.e(TAG,"RemoteException trying to handle StrictMode violation",e);
    }
 finally {
      setThreadPolicyMask(savedPolicyMask);
    }
  }
  if (penaltyDeath) {
    System.err.println("StrictMode VmPolicy violation with POLICY_DEATH; shutting down.");
    Process.killProcess(Process.myPid());
    System.exit(10);
  }
}
