{
synchronized (StrictMode.class) {
    sVmPolicy=policy;
    sVmPolicyMask=policy.mask;
    setCloseGuardEnabled(vmClosableObjectLeaksEnabled());
    Looper looper=Looper.getMainLooper();
    if (looper != null) {
      MessageQueue mq=looper.mQueue;
      if (policy.classInstanceLimit.size() == 0 || (sVmPolicyMask & VM_PENALTY_MASK) == 0) {
        mq.removeIdleHandler(sProcessIdleHandler);
        sIsIdlerRegistered=false;
      }
 else       if (!sIsIdlerRegistered) {
        mq.addIdleHandler(sProcessIdleHandler);
        sIsIdlerRegistered=true;
      }
    }
  }
}
