{
  StringWriter sw=new StringWriter();
  new LogStackTrace().printStackTrace(new PrintWriter(sw));
  String ourStack=sw.toString();
  int policyMask=getThreadPolicyMask();
  boolean currentlyGathering=(policyMask & PENALTY_GATHER) != 0;
  int numViolations=p.readInt();
  for (int i=0; i < numViolations; ++i) {
    if (LOG_V)     Log.d(TAG,"strict mode violation stacks read from binder call.  i=" + i);
    ViolationInfo info=new ViolationInfo(p,!currentlyGathering);
    info.crashInfo.stackTrace+="# via Binder call with stack:\n" + ourStack;
    BlockGuard.Policy policy=BlockGuard.getThreadPolicy();
    if (policy instanceof AndroidBlockGuardPolicy) {
      ((AndroidBlockGuardPolicy)policy).handleViolationWithTimingAttempt(info);
    }
  }
}
