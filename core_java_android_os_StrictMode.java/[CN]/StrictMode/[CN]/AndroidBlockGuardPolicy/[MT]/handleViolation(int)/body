{
  final BlockGuard.BlockGuardPolicyException violation=new BlockGuard.BlockGuardPolicyException(mPolicyMask,violationBit);
  violation.fillInStackTrace();
  Looper looper=Looper.myLooper();
  if (looper == null) {
    handleViolationWithTime(violation,-1L);
  }
 else {
    MessageQueue queue=Looper.myQueue();
    final long violationTime=SystemClock.uptimeMillis();
    queue.addIdleHandler(new MessageQueue.IdleHandler(){
      public boolean queueIdle(){
        long afterViolationTime=SystemClock.uptimeMillis();
        handleViolationWithTime(violation,afterViolationTime - violationTime);
        return false;
      }
    }
);
  }
}
