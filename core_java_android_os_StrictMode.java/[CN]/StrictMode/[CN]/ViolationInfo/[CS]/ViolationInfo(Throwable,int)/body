{
  crashInfo=new ApplicationErrorReport.CrashInfo(tr);
  violationUptimeMillis=SystemClock.uptimeMillis();
  this.policy=policy;
  this.numAnimationsRunning=ValueAnimator.getCurrentAnimationsCount();
  Intent broadcastIntent=ActivityThread.getIntentBeingBroadcast();
  if (broadcastIntent != null) {
    broadcastIntentAction=broadcastIntent.getAction();
  }
  ThreadSpanState state=sThisThreadSpanState.get();
  if (tr instanceof InstanceCountViolation) {
    this.numInstances=((InstanceCountViolation)tr).mInstances;
  }
synchronized (state) {
    int spanActiveCount=state.mActiveSize;
    if (spanActiveCount > MAX_SPAN_TAGS) {
      spanActiveCount=MAX_SPAN_TAGS;
    }
    if (spanActiveCount != 0) {
      this.tags=new String[spanActiveCount];
      Span iter=state.mActiveHead;
      int index=0;
      while (iter != null && index < spanActiveCount) {
        this.tags[index]=iter.mName;
        index++;
        iter=iter.mNext;
      }
    }
  }
}
