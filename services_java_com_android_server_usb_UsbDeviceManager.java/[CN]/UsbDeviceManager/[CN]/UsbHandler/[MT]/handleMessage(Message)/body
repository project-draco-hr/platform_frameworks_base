{
switch (msg.what) {
case MSG_UPDATE_STATE:
    mConnected=(msg.arg1 == 1);
  mConfigured=(msg.arg2 == 1);
updateUsbNotification();
updateAdbNotification();
if (containsFunction(mCurrentFunctions,UsbManager.USB_FUNCTION_ACCESSORY)) {
updateCurrentAccessory();
}
if (!mConnected) {
setEnabledFunctions(mDefaultFunctions,false);
}
if (mBootCompleted) {
updateUsbState();
boolean audioSourceEnabled=containsFunction(mCurrentFunctions,UsbManager.USB_FUNCTION_AUDIO_SOURCE);
if (audioSourceEnabled != mAudioSourceEnabled) {
updateAudioSourceFunction(audioSourceEnabled);
}
}
break;
case MSG_ENABLE_ADB:
setAdbEnabled(msg.arg1 == 1);
break;
case MSG_SET_CURRENT_FUNCTION:
String function=(String)msg.obj;
boolean makeDefault=(msg.arg1 == 1);
setEnabledFunctions(function,makeDefault);
break;
case MSG_SYSTEM_READY:
updateUsbNotification();
updateAdbNotification();
updateUsbState();
break;
case MSG_BOOT_COMPLETED:
mBootCompleted=true;
if (mCurrentAccessory != null) {
mSettingsManager.accessoryAttached(mCurrentAccessory);
}
updateAudioSourceFunction(mAudioSourceEnabled);
break;
}
}
