{
  if (imi == null && mCurMethodId != null) {
    imi=mMethodMap.get(mCurMethodId);
  }
  List<InputMethodSubtype> enabledSubtypes=mSettings.getEnabledInputMethodSubtypeListLocked(imi);
  if (allowsImplicitlySelectedSubtypes && enabledSubtypes.isEmpty()) {
    enabledSubtypes=getApplicableSubtypesLocked(mRes,getSubtypes(imi));
  }
  return InputMethodSubtype.sort(mContext,0,imi,enabledSubtypes);
}
