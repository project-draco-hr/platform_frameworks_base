{
  if (TextUtils.isEmpty(imiId) || subtypes == null || subtypes.length == 0)   return;
synchronized (mMethodMap) {
    final InputMethodInfo imi=mMethodMap.get(imiId);
    if (imi == null)     return;
    final PackageManager pm=mContext.getPackageManager();
    final String[] packageInfos=pm.getPackagesForUid(Binder.getCallingUid());
    if (packageInfos != null) {
      final int packageNum=packageInfos.length;
      for (int i=0; i < packageNum; ++i) {
        if (packageInfos[i].equals(imi.getPackageName())) {
          mFileManager.addInputMethodSubtypes(imi,subtypes);
          final long ident=Binder.clearCallingIdentity();
          try {
            buildInputMethodListLocked(mMethodList,mMethodMap);
          }
  finally {
            Binder.restoreCallingIdentity(ident);
          }
          return;
        }
      }
    }
  }
  return;
}
