{
  long ident=Binder.clearCallingIdentity();
  try {
    if (token == null || mCurToken != token) {
      Slog.w(TAG,"Ignoring setInputMethod of token: " + token);
      return;
    }
synchronized (mMethodMap) {
      if (iconId == 0) {
        if (DEBUG)         Slog.d(TAG,"hide the small icon for the input method");
        mStatusBar.setIconVisibility(mInputMethodIcon,false);
      }
 else       if (packageName != null) {
        if (DEBUG)         Slog.d(TAG,"show a small icon for the input method");
        mInputMethodData.iconId=iconId;
        mInputMethodData.iconPackage=packageName;
        mStatusBar.updateIcon(mInputMethodIcon,mInputMethodData,null);
        mStatusBar.setIconVisibility(mInputMethodIcon,true);
      }
    }
  }
  finally {
    Binder.restoreCallingIdentity(ident);
  }
}
