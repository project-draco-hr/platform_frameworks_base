{
  final Configuration conf=mRes.getConfiguration();
  final boolean haveHardKeyboard=conf.keyboard != Configuration.KEYBOARD_NOKEYS;
  final boolean hardKeyShown=haveHardKeyboard && conf.hardKeyboardHidden != Configuration.HARDKEYBOARDHIDDEN_YES;
  final boolean isScreenLocked=isKeyguardLocked();
  final boolean inputActive=!isScreenLocked && (mInputShown || hardKeyShown);
  final boolean inputVisible=inputActive && !hardKeyShown;
  mImeWindowVis=(inputActive ? InputMethodService.IME_ACTIVE : 0) | (inputVisible ? InputMethodService.IME_VISIBLE : 0);
  updateImeWindowStatusLocked();
}
