{
synchronized (mMethodMap) {
    final InputMethodInfo targetImi=mSecureSuggestionSpans.get(span);
    if (targetImi != null) {
      final String[] suggestions=span.getSuggestions();
      if (index < 0 || index >= suggestions.length)       return false;
      final Class<?> c=span.getNotificationTargetClass();
      final Intent intent=new Intent();
      intent.setClassName(targetImi.getPackageName(),c.getCanonicalName());
      intent.setAction(SuggestionSpan.ACTION_SUGGESTION_PICKED);
      intent.putExtra(SuggestionSpan.SUGGESTION_SPAN_PICKED_BEFORE,originalString);
      intent.putExtra(SuggestionSpan.SUGGESTION_SPAN_PICKED_AFTER,suggestions[index]);
      intent.putExtra(SuggestionSpan.SUGGESTION_SPAN_PICKED_HASHCODE,span.hashCode());
      mContext.sendBroadcast(intent);
      return true;
    }
  }
  return false;
}
