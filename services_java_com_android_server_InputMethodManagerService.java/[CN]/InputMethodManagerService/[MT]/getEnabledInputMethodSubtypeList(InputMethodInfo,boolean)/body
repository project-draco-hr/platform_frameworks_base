{
synchronized (mMethodMap) {
    if (imi == null && mCurMethodId != null) {
      imi=mMethodMap.get(mCurMethodId);
    }
    final List<InputMethodSubtype> enabledSubtypes=mSettings.getEnabledInputMethodSubtypeListLocked(imi);
    if (!allowsImplicitlySelectedSubtypes || enabledSubtypes.size() > 0) {
      return enabledSubtypes;
    }
 else {
      return getApplicableSubtypesLocked(imi.getSubtypes());
    }
  }
}
