{
  list.clear();
  map.clear();
  PackageManager pm=mContext.getPackageManager();
  Object[][] buildin={{DefaultInputMethod.class.getName(),DefaultInputMethod.getMetaInfo()}};
  List<ResolveInfo> services=pm.queryIntentServices(new Intent(InputMethod.SERVICE_INTERFACE),PackageManager.GET_META_DATA);
  for (int i=0; i < services.size(); ++i) {
    ResolveInfo ri=services.get(i);
    ServiceInfo si=ri.serviceInfo;
    ComponentName compName=new ComponentName(si.packageName,si.name);
    if (!android.Manifest.permission.BIND_INPUT_METHOD.equals(si.permission)) {
      Log.w(TAG,"Skipping input method " + compName + ": it does not require the permission "+ android.Manifest.permission.BIND_INPUT_METHOD);
      continue;
    }
    if (DEBUG)     Log.d(TAG,"Checking " + compName);
    try {
      InputMethodInfo p=new InputMethodInfo(mContext,ri);
      list.add(p);
      map.put(p.getId(),p);
      if (DEBUG) {
        Log.d(TAG,"Found a third-party input method " + p);
      }
    }
 catch (    XmlPullParserException e) {
      Log.w(TAG,"Unable to load input method " + compName,e);
    }
catch (    IOException e) {
      Log.w(TAG,"Unable to load input method " + compName,e);
    }
  }
}
