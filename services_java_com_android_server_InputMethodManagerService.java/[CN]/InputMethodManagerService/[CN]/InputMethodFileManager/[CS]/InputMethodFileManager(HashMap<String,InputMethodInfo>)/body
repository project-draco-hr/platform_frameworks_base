{
  if (methodMap == null) {
    throw new NullPointerException("methodMap is null");
  }
  mMethodMap=methodMap;
  final File systemDir=new File(Environment.getDataDirectory(),SYSTEM_PATH);
  final File inputMethodDir=new File(systemDir,INPUT_METHOD_PATH);
  if (!inputMethodDir.mkdirs()) {
    Slog.w(TAG,"Couldn't create dir.: " + inputMethodDir.getAbsolutePath());
  }
  final File subtypeFile=new File(inputMethodDir,ADDITIONAL_SUBTYPES_FILE_NAME);
  mAdditionalInputMethodSubtypeFile=new AtomicFile(subtypeFile);
  if (!subtypeFile.exists()) {
    writeAdditionalInputMethodSubtypes(mSubtypesMap,mAdditionalInputMethodSubtypeFile,methodMap);
  }
 else {
    readAdditionalInputMethodSubtypes(mSubtypesMap,mAdditionalInputMethodSubtypeFile);
  }
}
