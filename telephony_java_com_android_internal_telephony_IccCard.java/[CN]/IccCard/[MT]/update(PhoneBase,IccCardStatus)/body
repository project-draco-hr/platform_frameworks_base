{
  if (phone != mPhone) {
    PhoneBase oldPhone=mPhone;
    mPhone=phone;
    log("Update");
    if (phone instanceof GSMPhone) {
      is3gpp=true;
    }
 else     if (phone instanceof CDMALTEPhone) {
      is3gpp=true;
    }
 else     if (phone instanceof CDMAPhone) {
      is3gpp=false;
    }
 else {
      throw new RuntimeException("Update: Unhandled phone type. Critical error!" + phone.getPhoneName());
    }
    if (phone.mCM.getLteOnCdmaMode() == Phone.LTE_ON_CDMA_TRUE && phone instanceof CDMALTEPhone) {
      mIccFileHandler=new CdmaLteUiccFileHandler(this,"",mPhone.mCM);
      mIccRecords=new CdmaLteUiccRecords(this,mPhone.mContext,mPhone.mCM);
    }
 else {
      mIccFileHandler=is3gpp ? new SIMFileHandler(this,"",mPhone.mCM) : new RuimFileHandler(this,"",mPhone.mCM);
      mIccRecords=is3gpp ? new SIMRecords(this,mPhone.mContext,mPhone.mCM) : new RuimRecords(this,mPhone.mContext,mPhone.mCM);
    }
    mCatService=CatService.getInstance(mPhone.mCM,mIccRecords,mPhone.mContext,mIccFileHandler,this);
  }
  mHandler.sendMessage(mHandler.obtainMessage(EVENT_GET_ICC_STATUS_DONE,ics));
}
