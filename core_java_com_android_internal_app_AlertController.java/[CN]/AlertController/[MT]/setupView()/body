{
  final LinearLayout contentPanel=(LinearLayout)mWindow.findViewById(R.id.contentPanel);
  setupContent(contentPanel);
  final boolean hasButtons=setupButtons();
  final LinearLayout topPanel=(LinearLayout)mWindow.findViewById(R.id.topPanel);
  final TypedArray a=mContext.obtainStyledAttributes(null,R.styleable.AlertDialog,R.attr.alertDialogStyle,0);
  final boolean hasTitle=setupTitle(topPanel);
  final View buttonPanel=mWindow.findViewById(R.id.buttonPanel);
  if (!hasButtons) {
    buttonPanel.setVisibility(View.GONE);
    final View spacer=mWindow.findViewById(R.id.textSpacerNoButtons);
    if (spacer != null) {
      spacer.setVisibility(View.VISIBLE);
    }
    mWindow.setCloseOnTouchOutsideIfNotSet(true);
  }
  final FrameLayout customPanel=(FrameLayout)mWindow.findViewById(R.id.customPanel);
  final View customView;
  if (mView != null) {
    customView=mView;
  }
 else   if (mViewLayoutResId != 0) {
    final LayoutInflater inflater=LayoutInflater.from(mContext);
    customView=inflater.inflate(mViewLayoutResId,customPanel,false);
  }
 else {
    customView=null;
  }
  final boolean hasCustomView=customView != null;
  if (!hasCustomView || !canTextInput(customView)) {
    mWindow.setFlags(WindowManager.LayoutParams.FLAG_ALT_FOCUSABLE_IM,WindowManager.LayoutParams.FLAG_ALT_FOCUSABLE_IM);
  }
  if (hasCustomView) {
    final FrameLayout custom=(FrameLayout)mWindow.findViewById(R.id.custom);
    custom.addView(customView,new LayoutParams(MATCH_PARENT,MATCH_PARENT));
    if (mViewSpacingSpecified) {
      custom.setPadding(mViewSpacingLeft,mViewSpacingTop,mViewSpacingRight,mViewSpacingBottom);
    }
    if (mListView != null) {
      ((LinearLayout.LayoutParams)customPanel.getLayoutParams()).weight=0;
    }
  }
 else {
    customPanel.setVisibility(View.GONE);
  }
  if (hasTitle) {
    final View divider;
    if (mMessage != null || customView != null || mListView != null) {
      divider=mWindow.findViewById(R.id.titleDivider);
    }
 else {
      divider=mWindow.findViewById(R.id.titleDividerTop);
    }
    if (divider != null) {
      divider.setVisibility(View.VISIBLE);
    }
  }
  setBackground(a,topPanel,contentPanel,customPanel,buttonPanel,hasTitle,hasCustomView,hasButtons);
  a.recycle();
}
