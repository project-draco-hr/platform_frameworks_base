{
  LinearLayout contentPanel=(LinearLayout)mWindow.findViewById(R.id.contentPanel);
  setupContent(contentPanel);
  boolean hasButtons=setupButtons();
  LinearLayout topPanel=(LinearLayout)mWindow.findViewById(R.id.topPanel);
  TypedArray a=mContext.obtainStyledAttributes(null,com.android.internal.R.styleable.AlertDialog,com.android.internal.R.attr.alertDialogStyle,0);
  boolean hasTitle=setupTitle(topPanel);
  View buttonPanel=mWindow.findViewById(R.id.buttonPanel);
  if (!hasButtons) {
    buttonPanel.setVisibility(View.GONE);
    mWindow.setCloseOnTouchOutsideIfNotSet(true);
  }
  final FrameLayout customPanel=(FrameLayout)mWindow.findViewById(R.id.customPanel);
  final View customView;
  if (mView != null) {
    customView=mView;
  }
 else   if (mViewLayoutResId != 0) {
    final LayoutInflater inflater=LayoutInflater.from(mContext);
    customView=inflater.inflate(mViewLayoutResId,customPanel,false);
  }
 else {
    customView=null;
  }
  if (customView == null || !canTextInput(customView)) {
    mWindow.setFlags(WindowManager.LayoutParams.FLAG_ALT_FOCUSABLE_IM,WindowManager.LayoutParams.FLAG_ALT_FOCUSABLE_IM);
  }
  if (customView != null) {
    final FrameLayout custom=(FrameLayout)mWindow.findViewById(R.id.custom);
    custom.addView(customView,new LayoutParams(MATCH_PARENT,MATCH_PARENT));
    if (mViewSpacingSpecified) {
      custom.setPadding(mViewSpacingLeft,mViewSpacingTop,mViewSpacingRight,mViewSpacingBottom);
    }
    if (mListView != null) {
      ((LinearLayout.LayoutParams)customPanel.getLayoutParams()).weight=0;
    }
  }
 else {
    customPanel.setVisibility(View.GONE);
  }
  if (hasTitle) {
    View divider=null;
    if (mMessage != null || customView != null || mListView != null) {
      divider=mWindow.findViewById(R.id.titleDivider);
    }
 else {
      divider=mWindow.findViewById(R.id.titleDividerTop);
    }
    if (divider != null) {
      divider.setVisibility(View.VISIBLE);
    }
  }
  setBackground(topPanel,contentPanel,customPanel,hasButtons,a,hasTitle,buttonPanel);
  a.recycle();
}
