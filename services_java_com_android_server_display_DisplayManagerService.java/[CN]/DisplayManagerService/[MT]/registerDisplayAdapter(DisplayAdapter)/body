{
  int displayId;
  DisplayCallback[] callbacks;
synchronized (mLock) {
    displayId=mDisplayIdSeq;
    do {
      mDisplayIdSeq++;
      if (mDisplayIdSeq < 0) {
        mDisplayIdSeq=Display.DEFAULT_DISPLAY + 1;
      }
    }
 while (mDisplayInfos.get(mDisplayIdSeq) != null);
    adapter.setDisplayId(displayId);
    createDisplayInfoLocked(displayId,adapter);
    ArrayList<DisplayAdapter> list=new ArrayList<DisplayAdapter>();
    list.add(adapter);
    mLogicalToPhysicals.put(displayId,list);
    mDisplayAdapters.add(adapter);
    callbacks=mCallbacks.toArray(new DisplayCallback[mCallbacks.size()]);
  }
  for (int i=callbacks.length - 1; i >= 0; i--) {
    callbacks[i].displayAdded(displayId);
  }
}
