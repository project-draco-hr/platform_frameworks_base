{
  final PackageManager pm=getContext().getPackageManager();
  if (imi != null) {
    if (DEBUG) {
      Log.d(TAG,"Update icons of IME: " + imi.getPackageName() + ","+ subtype.getLocale()+ ","+ subtype.getMode());
    }
    if (subtype != null) {
      return pm.getDrawable(imi.getPackageName(),subtype.getIconResId(),imi.getServiceInfo().applicationInfo);
    }
 else     if (imi.getSubtypes().size() > 0) {
      return pm.getDrawable(imi.getPackageName(),imi.getSubtypes().get(0).getIconResId(),imi.getServiceInfo().applicationInfo);
    }
 else {
      try {
        return pm.getApplicationInfo(imi.getPackageName(),0).loadIcon(pm);
      }
 catch (      PackageManager.NameNotFoundException e) {
        Log.w(TAG,"IME can't be found: " + imi.getPackageName());
      }
    }
  }
  return null;
}
