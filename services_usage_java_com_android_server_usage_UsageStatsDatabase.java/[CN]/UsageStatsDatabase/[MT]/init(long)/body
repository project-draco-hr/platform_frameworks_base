{
synchronized (mLock) {
    for (    File f : mIntervalDirs) {
      f.mkdirs();
      if (!f.exists()) {
        throw new IllegalStateException("Failed to create directory " + f.getAbsolutePath());
      }
    }
    checkVersionAndBuildLocked();
    indexFilesLocked();
    for (    TimeSparseArray<AtomicFile> files : mSortedStatFiles) {
      final int startIndex=files.closestIndexOnOrAfter(currentTimeMillis);
      if (startIndex < 0) {
        continue;
      }
      final int fileCount=files.size();
      for (int i=startIndex; i < fileCount; i++) {
        files.valueAt(i).delete();
      }
      for (int i=startIndex; i < fileCount; i++) {
        files.removeAt(i);
      }
    }
  }
}
