{
  int version;
  try (BufferedReader reader=new BufferedReader(new FileReader(mVersionFile))){
    version=Integer.parseInt(reader.readLine());
  }
 catch (  NumberFormatException|IOException e) {
    version=0;
  }
  if (version != CURRENT_VERSION) {
    Slog.i(TAG,"Upgrading from version " + version + " to "+ CURRENT_VERSION);
    doUpgradeLocked(version);
    try (BufferedWriter writer=new BufferedWriter(new FileWriter(mVersionFile))){
      writer.write(Integer.toString(CURRENT_VERSION));
    }
 catch (    IOException e) {
      Slog.e(TAG,"Failed to write new version");
      throw new RuntimeException(e);
    }
  }
}
