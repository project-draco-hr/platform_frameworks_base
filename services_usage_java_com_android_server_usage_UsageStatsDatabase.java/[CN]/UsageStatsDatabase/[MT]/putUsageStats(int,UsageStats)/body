{
synchronized (mLock) {
    if (bucketType < 0 || bucketType >= mBucketDirs.length) {
      throw new IllegalArgumentException("Bad bucket type " + bucketType);
    }
    AtomicFile f=mSortedStatFiles[bucketType].get(stats.mBeginTimeStamp);
    if (f == null) {
      f=new AtomicFile(new File(mBucketDirs[bucketType],Long.toString(stats.mBeginTimeStamp)));
      mSortedStatFiles[bucketType].append(stats.mBeginTimeStamp,f);
    }
    UsageStatsXml.write(stats,f);
    stats.mLastTimeSaved=f.getLastModifiedTime();
  }
}
