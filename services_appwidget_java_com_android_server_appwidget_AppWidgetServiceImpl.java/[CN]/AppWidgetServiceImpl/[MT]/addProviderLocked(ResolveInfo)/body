{
  if ((ri.activityInfo.applicationInfo.flags & ApplicationInfo.FLAG_EXTERNAL_STORAGE) != 0) {
    return false;
  }
  if (!ri.activityInfo.isEnabled()) {
    return false;
  }
  ComponentName componentName=new ComponentName(ri.activityInfo.packageName,ri.activityInfo.name);
  ProviderId providerId=new ProviderId(ri.activityInfo.applicationInfo.uid,componentName);
  Provider provider=parseProviderInfoXml(providerId,ri);
  if (provider != null) {
    Provider existing=lookupProviderLocked(providerId);
    if (existing == null) {
      ProviderId restoredProviderId=new ProviderId(UNKNOWN_UID,componentName);
      existing=lookupProviderLocked(restoredProviderId);
    }
    if (existing != null) {
      if (existing.zombie && !mSafeMode) {
        existing.id=providerId;
        existing.zombie=false;
        existing.info=provider.info;
        if (DEBUG) {
          Slog.i(TAG,"Provider placeholder now reified: " + existing);
        }
      }
    }
 else {
      mProviders.add(provider);
    }
    return true;
  }
  return false;
}
