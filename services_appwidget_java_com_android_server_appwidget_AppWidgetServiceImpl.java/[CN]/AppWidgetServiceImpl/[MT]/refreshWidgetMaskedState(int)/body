{
  if (!mUserManager.isUserUnlocked(profileId))   return;
  final long identity=Binder.clearCallingIdentity();
  try {
    UserInfo user=mUserManager.getUserInfo(profileId);
    if (!user.isManagedProfile()) {
      return;
    }
    boolean shouldMask=user.isQuietModeEnabled();
    final int iconSize=(int)mContext.getResources().getDimension(android.R.dimen.app_icon_size);
synchronized (mLock) {
      final int N=mProviders.size();
      for (int i=0; i < N; i++) {
        Provider provider=mProviders.get(i);
        int providerUserId=provider.getUserId();
        if (providerUserId == profileId) {
          final int widgetCount=provider.widgets.size();
          for (int j=0; j < widgetCount; j++) {
            Widget widget=provider.widgets.get(j);
            if (shouldMask) {
              widget.replaceWithMaskedViewsLocked(mContext,iconSize);
            }
 else {
              widget.clearMaskedViewsLocked();
            }
            scheduleNotifyUpdateAppWidgetLocked(widget,widget.getEffectiveViewsLocked());
          }
        }
      }
    }
  }
  finally {
    Binder.restoreCallingIdentity(identity);
  }
}
