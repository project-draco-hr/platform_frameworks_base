{
  if (DEBUG && !mState.stack.isEmpty()) {
    Log.w(mTag,"Overwriting existing stack.");
  }
  RootsCache roots=DocumentsApplication.getRootsCache(BaseActivity.this);
  final String packageName=getCallingPackageMaybeExtra();
  final Cursor cursor=getContentResolver().query(RecentsProvider.buildResume(packageName),null,null,null,null);
  try {
    if (cursor.moveToFirst()) {
      mExternal=cursor.getInt(cursor.getColumnIndex(ResumeColumns.EXTERNAL)) != 0;
      final byte[] rawStack=cursor.getBlob(cursor.getColumnIndex(ResumeColumns.STACK));
      DurableUtils.readFromArray(rawStack,mState.stack);
      mRestoredStack=true;
    }
  }
 catch (  IOException e) {
    Log.w(mTag,"Failed to resume: " + e);
  }
 finally {
    IoUtils.closeQuietly(cursor);
  }
  if (mRestoredStack) {
    final Collection<RootInfo> matchingRoots=roots.getMatchingRootsBlocking(mState);
    try {
      mState.stack.updateRoot(matchingRoots);
      mState.stack.updateDocuments(getContentResolver());
    }
 catch (    FileNotFoundException e) {
      Log.w(mTag,"Failed to restore stack: " + e);
      mState.stack.reset();
      mRestoredStack=false;
    }
  }
  return null;
}
