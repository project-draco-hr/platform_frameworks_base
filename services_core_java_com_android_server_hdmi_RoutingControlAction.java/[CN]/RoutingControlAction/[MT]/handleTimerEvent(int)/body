{
  if (mState != timeoutState || mState == STATE_NONE) {
    Slog.w("CEC","Timer in a wrong state. Ignored.");
    return;
  }
switch (timeoutState) {
case STATE_WAIT_FOR_ROUTING_INFORMATION:
    HdmiCecDeviceInfo device=tv().getDeviceInfoByPath(mCurrentRoutingPath);
  if (device == null) {
    maybeChangeActiveInput(tv().pathToPortId(mCurrentRoutingPath));
  }
 else {
    int deviceLogicalAddress=device.getLogicalAddress();
    queryDevicePowerStatus(deviceLogicalAddress,new SendMessageCallback(){
      @Override public void onSendCompleted(      int error){
        handlDevicePowerStatusAckResult(error == HdmiCec.RESULT_SUCCESS);
      }
    }
);
  }
return;
case STATE_WAIT_FOR_REPORT_POWER_STATUS:
int tvPowerStatus=getTvPowerStatus();
if (isPowerStatusOnOrTransientToOn(tvPowerStatus)) {
if (!maybeChangeActiveInput(localDevice().pathToPortId(mCurrentRoutingPath))) {
sendSetStreamPath();
}
}
invokeCallback(HdmiCec.RESULT_SUCCESS);
finish();
return;
}
}
