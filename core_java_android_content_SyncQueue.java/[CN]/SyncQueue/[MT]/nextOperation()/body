{
  SyncOperation best=null;
  long bestRunTime=0;
  for (  SyncOperation op : mOperationsMap.values()) {
    long opRunTime=op.earliestRunTime;
    if (!op.extras.getBoolean(ContentResolver.SYNC_EXTRAS_IGNORE_BACKOFF,false)) {
      Pair<Long,Long> backoff=mSyncStorageEngine.getBackoff(op.account,op.authority);
      long delayUntil=mSyncStorageEngine.getDelayUntilTime(op.account,op.authority);
      opRunTime=Math.max(Math.max(opRunTime,delayUntil),backoff != null ? backoff.first : 0);
    }
    if (best == null || (best.expedited == op.expedited ? opRunTime < bestRunTime : op.expedited)) {
      best=op;
      bestRunTime=opRunTime;
    }
  }
  if (best == null) {
    return null;
  }
  return Pair.create(best,bestRunTime);
}
