{
  boolean setBest=false;
  if (Log.isLoggable(TAG,Log.VERBOSE)) {
    Log.v(TAG,"nextOperation: Processing op: " + op);
  }
  if (best == null) {
    if (Log.isLoggable(TAG,Log.VERBOSE)) {
      Log.v(TAG,"   First op selected");
    }
    setBest=true;
  }
 else   if (bestIsInitial == opIsInitial) {
    if (best.expedited == op.expedited) {
      if (opRunTime < bestRunTime) {
        if (Log.isLoggable(TAG,Log.VERBOSE)) {
          Log.v(TAG,"   Same expedite level - new op selected");
        }
        setBest=true;
      }
    }
 else {
      final long now=SystemClock.elapsedRealtime();
      if (op.expedited) {
        if (opRunTime <= now || bestRunTime > now) {
          if (Log.isLoggable(TAG,Log.VERBOSE)) {
            Log.v(TAG,"   New op is expedited and can run - new op selected");
          }
          setBest=true;
        }
 else {
          if (Log.isLoggable(TAG,Log.VERBOSE)) {
            Log.v(TAG,"   New op is expedited but can't run and best can");
          }
        }
      }
 else {
        if (bestRunTime > now && opRunTime <= now) {
          if (Log.isLoggable(TAG,Log.VERBOSE)) {
            Log.v(TAG,"   New op is not expedited but can run - new op selected");
          }
          setBest=true;
        }
      }
    }
  }
 else {
    if (opIsInitial) {
      if (Log.isLoggable(TAG,Log.VERBOSE)) {
        Log.v(TAG,"   New op is init - new op selected");
      }
      setBest=true;
    }
  }
  return setBest;
}
