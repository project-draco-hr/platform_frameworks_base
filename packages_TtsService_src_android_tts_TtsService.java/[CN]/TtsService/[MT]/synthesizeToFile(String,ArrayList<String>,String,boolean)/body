{
  if (calledFromApi) {
    stop();
  }
  Log.i("TTS","Synthesizing to " + filename);
  boolean synthAvailable=false;
  try {
    synthAvailable=synthesizerLock.tryLock();
    if (!synthAvailable) {
      return false;
    }
    if (filename.length() > MAX_FILENAME_LENGTH) {
      return false;
    }
    nativeSynth.synthesizeToFile(text,filename);
  }
  finally {
    if (synthAvailable) {
      synthesizerLock.unlock();
    }
  }
  Log.i("TTS","Completed synthesis for " + filename);
  return true;
}
