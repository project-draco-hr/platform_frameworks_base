{
  mContext=context;
  mAms=service;
  mLongAnimationDuration=context.getResources().getInteger(com.android.internal.R.integer.config_longAnimTime);
  mTapDistanceSlop=ViewConfiguration.get(context).getScaledTouchSlop();
  mMultiTapDistanceSlop=ViewConfiguration.get(context).getScaledDoubleTapSlop();
  mWindowAnimationScale=Settings.Global.getFloat(context.getContentResolver(),Settings.Global.WINDOW_ANIMATION_SCALE,DEFAULT_WINDOW_ANIMATION_SCALE);
  mDetectingStateHandler=new DetectingStateHandler();
  mStateViewportDraggingHandler=new StateViewportDraggingHandler();
  mMagnifiedContentInteractonStateHandler=new MagnifiedContentInteractonStateHandler(context);
  mMagnificationController=new MagnificationController(mLongAnimationDuration);
  mViewportWindow=new ViewportWindow(context,displayId);
  mScreenStateObserver=new ScreenStateObserver(context,mMagnificationController,mViewportWindow);
  try {
    IWindowManager windowManagerService=IWindowManager.Stub.asInterface(ServiceManager.getService("window"));
    mDisplayMagnifier=windowManagerService.getDisplayMagnificationMediator();
    mDisplayMagnifier.addController(Display.DEFAULT_DISPLAY,this);
  }
 catch (  RemoteException re) {
  }
  transitionToState(STATE_DETECTING);
}
