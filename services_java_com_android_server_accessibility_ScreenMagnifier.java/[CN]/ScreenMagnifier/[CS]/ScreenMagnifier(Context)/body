{
  mContext=context;
  mWindowManager=(WindowManager)context.getSystemService(Context.WINDOW_SERVICE);
  mShortAnimationDuration=context.getResources().getInteger(com.android.internal.R.integer.config_shortAnimTime);
  mLongAnimationDuration=context.getResources().getInteger(com.android.internal.R.integer.config_longAnimTime);
  mTapDistanceSlop=ViewConfiguration.get(context).getScaledTouchSlop();
  mMultiTapDistanceSlop=ViewConfiguration.get(context).getScaledDoubleTapSlop();
  mWindowAnimationScale=Settings.System.getFloat(context.getContentResolver(),Settings.System.WINDOW_ANIMATION_SCALE,DEFAULT_WINDOW_ANIMATION_SCALE);
  mMagnificationController=new MagnificationController(mShortAnimationDuration);
  mDisplayProvider=new DisplayProvider(context,mWindowManager);
  mViewport=new Viewport(mContext,mWindowManager,mWindowManagerService,mDisplayProvider,mInterpolator,mShortAnimationDuration);
  mDisplayContentObserver=new DisplayContentObserver(mContext,mViewport,mMagnificationController,mWindowManagerService,mDisplayProvider,mLongAnimationDuration,mWindowAnimationScale);
  mGestureDetector=new GestureDetector(context);
  transitionToState(STATE_DETECTING);
}
