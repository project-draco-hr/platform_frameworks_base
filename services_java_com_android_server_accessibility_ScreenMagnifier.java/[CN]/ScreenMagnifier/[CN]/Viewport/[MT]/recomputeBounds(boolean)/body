{
  Rect magnifiedFrame=mTempRect1;
  magnifiedFrame.set(0,0,0,0);
  Rect notMagnifiedFrame=mTempRect2;
  notMagnifiedFrame.set(0,0,0,0);
  ArrayList<WindowInfo> infos=mTempWindowInfoList;
  infos.clear();
  int windowCount=0;
  try {
    mWindowManagerService.getVisibleWindowsForDisplay(mDisplayProvider.getDisplay().getDisplayId(),infos);
    Collections.sort(infos,mWindowInfoInverseComparator);
    windowCount=infos.size();
    for (int i=0; i < windowCount; i++) {
      WindowInfo info=infos.get(i);
      if (info.type == WindowManager.LayoutParams.TYPE_MAGNIFICATION_OVERLAY) {
        continue;
      }
      if (isWindowMagnified(info.type)) {
        Rect clippedFrame=mTempRect3;
        clippedFrame.set(info.touchableRegion);
        subtract(clippedFrame,notMagnifiedFrame);
        magnifiedFrame.union(clippedFrame);
      }
 else {
        Rect clippedFrame=mTempRect3;
        clippedFrame.set(info.touchableRegion);
        subtract(clippedFrame,magnifiedFrame);
        notMagnifiedFrame.union(clippedFrame);
      }
      if (magnifiedFrame.bottom >= notMagnifiedFrame.top) {
        break;
      }
    }
  }
 catch (  RemoteException re) {
  }
 finally {
    for (int i=windowCount - 1; i >= 0; i--) {
      infos.remove(i).recycle();
    }
  }
  final int displayWidth=mDisplayProvider.getDisplayInfo().logicalWidth;
  final int displayHeight=mDisplayProvider.getDisplayInfo().logicalHeight;
  magnifiedFrame.intersect(0,0,displayWidth,displayHeight);
  resize(magnifiedFrame,animate);
}
