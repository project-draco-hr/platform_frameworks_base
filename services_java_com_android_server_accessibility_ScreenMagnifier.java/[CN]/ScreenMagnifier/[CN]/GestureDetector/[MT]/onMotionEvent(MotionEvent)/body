{
  mScaleGestureDetector.onTouchEvent(event);
switch (mCurrentState) {
case STATE_DETECTING:
case STATE_DELEGATING:
case STATE_VIEWPORT_DRAGGING:
{
      return;
    }
}
if (event.getActionMasked() == MotionEvent.ACTION_UP) {
  clear();
  final float scale=mMagnificationController.getScale();
  if (scale != getPersistedScale()) {
    persistScale(scale);
  }
  if (mPreviousState == STATE_VIEWPORT_DRAGGING) {
    transitionToState(STATE_VIEWPORT_DRAGGING);
  }
 else {
    transitionToState(STATE_DETECTING);
  }
}
}
