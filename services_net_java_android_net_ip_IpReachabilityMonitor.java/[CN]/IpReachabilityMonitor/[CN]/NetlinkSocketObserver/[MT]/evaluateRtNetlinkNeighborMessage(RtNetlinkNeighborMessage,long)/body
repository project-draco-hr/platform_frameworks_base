{
  final StructNdMsg ndMsg=neighMsg.getNdHeader();
  if (ndMsg == null || ndMsg.ndm_ifindex != mInterfaceIndex) {
    return;
  }
  final InetAddress destination=neighMsg.getDestination();
  if (!isWatching(destination)) {
    return;
  }
  final short msgType=neighMsg.getHeader().nlmsg_type;
  final short nudState=ndMsg.ndm_state;
  final String eventMsg="NeighborEvent{" + "elapsedMs=" + whenMs + ", "+ destination.getHostAddress()+ ", "+ "["+ NetlinkConstants.hexify(neighMsg.getLinkLayerAddress())+ "], "+ NetlinkConstants.stringForNlMsgType(msgType)+ ", "+ StructNdMsg.stringForNudState(nudState)+ "}";
  if (VDBG) {
    Log.d(TAG,neighMsg.toString());
  }
 else   if (DBG) {
    Log.d(TAG,eventMsg);
  }
synchronized (mLock) {
    if (mIpWatchList.containsKey(destination)) {
      final short value=(msgType == NetlinkConstants.RTM_DELNEIGH) ? StructNdMsg.NUD_NONE : nudState;
      mIpWatchList.put(destination,value);
    }
  }
  if (nudState == StructNdMsg.NUD_FAILED) {
    Log.w(TAG,"ALERT: " + eventMsg);
    handleNeighborLost(eventMsg);
  }
}
