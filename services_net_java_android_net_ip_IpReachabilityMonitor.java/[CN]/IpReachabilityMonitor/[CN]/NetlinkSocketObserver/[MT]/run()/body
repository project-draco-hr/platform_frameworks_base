{
  if (VDBG) {
    Log.d(TAG,"Starting observing thread.");
  }
synchronized (mLock) {
    mRunning=true;
  }
  try {
    setupNetlinkSocket();
  }
 catch (  ErrnoException|SocketException e) {
    Log.e(TAG,"Failed to suitably initialize a netlink socket",e);
synchronized (mLock) {
      mRunning=false;
    }
  }
  ByteBuffer byteBuffer;
  while (stillRunning()) {
    try {
      byteBuffer=recvKernelReply();
    }
 catch (    ErrnoException e) {
      if (stillRunning()) {
        Log.w(TAG,"ErrnoException: ",e);
      }
      break;
    }
    final long whenMs=SystemClock.elapsedRealtime();
    if (byteBuffer == null) {
      continue;
    }
    parseNetlinkMessageBuffer(byteBuffer,whenMs);
  }
  clearNetlinkSocket();
synchronized (mLock) {
    mRunning=false;
  }
  if (VDBG) {
    Log.d(TAG,"Finishing observing thread.");
  }
}
