{
  InetAddress ip=null;
  ProvisioningChange delta;
synchronized (mLock) {
    LinkProperties whatIfLp=new LinkProperties(mLinkProperties);
    for (    Map.Entry<InetAddress,Short> entry : mIpWatchList.entrySet()) {
      if (entry.getValue() != StructNdMsg.NUD_FAILED) {
        continue;
      }
      ip=entry.getKey();
      for (      RouteInfo route : mLinkProperties.getRoutes()) {
        if (ip.equals(route.getGateway())) {
          whatIfLp.removeRoute(route);
        }
      }
      whatIfLp.removeDnsServer(ip);
    }
    delta=LinkProperties.compareProvisioning(mLinkProperties,whatIfLp);
  }
  if (delta == ProvisioningChange.LOST_PROVISIONING) {
    IpReachabilityEvent.logProvisioningLost(mInterfaceName);
    final String logMsg="FAILURE: LOST_PROVISIONING, " + msg;
    Log.w(TAG,logMsg);
    if (mCallback != null) {
      mCallback.notifyLost(ip,logMsg);
    }
  }
 else {
    IpReachabilityEvent.logNudFailed(mInterfaceName);
  }
}
