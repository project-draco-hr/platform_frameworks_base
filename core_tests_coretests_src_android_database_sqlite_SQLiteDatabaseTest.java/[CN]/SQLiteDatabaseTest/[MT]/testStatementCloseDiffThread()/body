{
  mDatabase.execSQL("CREATE TABLE test (i int, j int);");
  Thread t1=new Thread(){
    @Override public void run(){
      int N=SQLiteDatabase.MAX_SQL_CACHE_SIZE;
      mDatabase.setMaxSqlCacheSize(N);
      SQLiteStatement stmt;
      for (int i=0; i < N; i++) {
        ClassToTestSqlCompilationAndCaching c=ClassToTestSqlCompilationAndCaching.create(mDatabase,"insert into test values(" + i + ", ?);");
        if (i == 0) {
          stmt0Id=c.getSqlStatementId();
        }
        c.close();
      }
    }
  }
;
  t1.start();
  t1.join();
  Thread t2=new Thread(){
    @Override public void run(){
      ClassToTestSqlCompilationAndCaching stmt1=ClassToTestSqlCompilationAndCaching.create(mDatabase,"insert into test values(100, ?);");
      stmt1.close();
    }
  }
;
  t2.start();
  t2.join();
  ArrayList<Integer> statementIds=mDatabase.getQueuedUpStmtList();
  assertTrue(getStmt0Id() > 0);
  assertTrue(statementIds.contains(stmt0Id));
  assertEquals(1,statementIds.size());
  Thread t3=new Thread(){
    @Override public void run(){
      mDatabase.execSQL("delete from test where i = 10;");
    }
  }
;
  t3.start();
  t3.join();
  statementIds=mDatabase.getQueuedUpStmtList();
  assertEquals(0,statementIds.size());
}
