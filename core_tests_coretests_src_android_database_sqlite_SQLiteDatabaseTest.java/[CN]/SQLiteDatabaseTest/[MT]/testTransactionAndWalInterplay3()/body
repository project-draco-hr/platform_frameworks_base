{
  createTableAndClearCache();
  mDatabase.execSQL("INSERT into " + TEST_TABLE + " values(10, 999);");
  String sql="select * from " + TEST_TABLE;
  Cursor c=mDatabase.rawQuery(sql,null);
  assertEquals(1,c.getCount());
  mDatabase.execSQL("BEGIN transaction");
  try {
    mDatabase.execSQL("INSERT into " + TEST_TABLE + " values(100, 9909);");
    assertEquals(2,DatabaseUtils.longForQuery(mDatabase,"select count(*) from " + TEST_TABLE,null));
    c.requery();
    assertEquals(2,c.getCount());
  }
  finally {
    mDatabase.execSQL("rollback;");
  }
  c.requery();
  assertEquals(1,c.getCount());
  assertEquals(1,DatabaseUtils.longForQuery(mDatabase,"select count(*) from " + TEST_TABLE,null));
  c.close();
}
