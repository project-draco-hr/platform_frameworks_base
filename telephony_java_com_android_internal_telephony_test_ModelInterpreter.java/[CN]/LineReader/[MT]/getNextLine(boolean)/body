{
  int i=0;
  try {
    for (; ; ) {
      int result;
      result=inStream.read();
      if (result < 0) {
        return null;
      }
      if (ctrlZ && result == 0x1a) {
        break;
      }
 else       if (result == '\r' || result == '\n') {
        if (i == 0) {
          continue;
        }
 else {
          break;
        }
      }
      buffer[i++]=(byte)result;
    }
  }
 catch (  IOException ex) {
    return null;
  }
catch (  IndexOutOfBoundsException ex) {
    System.err.println("ATChannel: buffer overflow");
  }
  try {
    return new String(buffer,0,i,"US-ASCII");
  }
 catch (  UnsupportedEncodingException ex) {
    System.err.println("ATChannel: implausable UnsupportedEncodingException");
    return null;
  }
}
