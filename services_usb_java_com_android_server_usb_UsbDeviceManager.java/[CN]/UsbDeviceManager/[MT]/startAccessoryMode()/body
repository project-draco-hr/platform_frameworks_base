{
  if (!mHasUsbAccessory)   return;
  mAccessoryStrings=nativeGetAccessoryStrings();
  boolean enableAudio=(nativeGetAudioMode() == AUDIO_MODE_SOURCE);
  boolean enableAccessory=(mAccessoryStrings != null && mAccessoryStrings[UsbAccessory.MANUFACTURER_STRING] != null && mAccessoryStrings[UsbAccessory.MODEL_STRING] != null);
  String functions=null;
  if (enableAccessory && enableAudio) {
    functions=UsbManager.USB_FUNCTION_ACCESSORY + "," + UsbManager.USB_FUNCTION_AUDIO_SOURCE;
  }
 else   if (enableAccessory) {
    functions=UsbManager.USB_FUNCTION_ACCESSORY;
  }
 else   if (enableAudio) {
    functions=UsbManager.USB_FUNCTION_AUDIO_SOURCE;
  }
  if (functions != null) {
    mAccessoryModeRequestTime=SystemClock.elapsedRealtime();
    setCurrentFunctions(functions,false);
  }
}
