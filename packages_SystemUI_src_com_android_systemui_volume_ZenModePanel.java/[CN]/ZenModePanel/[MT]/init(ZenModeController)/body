{
  mController=controller;
  mCountdownConditionSupported=mController.isCountdownConditionSupported();
  final int countdownDelta=mCountdownConditionSupported ? 1 : 0;
  mFirstConditionIndex=COUNTDOWN_CONDITION_INDEX + countdownDelta;
  final int minConditions=1 + countdownDelta;
  mMaxConditions=MathUtils.constrain(mContext.getResources().getInteger(R.integer.zen_mode_max_conditions),minConditions,100);
  mMaxOptionalConditions=mMaxConditions - minConditions;
  for (int i=0; i < mMaxConditions; i++) {
    mZenConditions.addView(mInflater.inflate(R.layout.zen_mode_condition,this,false));
  }
  setExitCondition(mController.getExitCondition());
  refreshExitConditionText();
  mSessionZen=getSelectedZen(-1);
  handleUpdateZen(mController.getZen());
  if (DEBUG)   Log.d(mTag,"init mExitCondition=" + mExitCondition);
  hideAllConditions();
  mController.addCallback(mZenCallback);
}
