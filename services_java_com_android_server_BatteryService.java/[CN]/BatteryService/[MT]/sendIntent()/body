{
  Intent intent=new Intent(Intent.ACTION_BATTERY_CHANGED);
  intent.addFlags(Intent.FLAG_RECEIVER_REGISTERED_ONLY);
  try {
    mBatteryStats.setOnBattery(mPlugType == BATTERY_PLUGGED_NONE,mBatteryLevel);
  }
 catch (  RemoteException e) {
  }
  int icon=getIcon(mBatteryLevel);
  intent.putExtra(BatteryManager.EXTRA_STATUS,mBatteryStatus);
  intent.putExtra(BatteryManager.EXTRA_HEALTH,mBatteryHealth);
  intent.putExtra(BatteryManager.EXTRA_PRESENT,mBatteryPresent);
  intent.putExtra(BatteryManager.EXTRA_LEVEL,mBatteryLevel);
  intent.putExtra(BatteryManager.EXTRA_SCALE,BATTERY_SCALE);
  intent.putExtra(BatteryManager.EXTRA_ICON_SMALL,icon);
  intent.putExtra(BatteryManager.EXTRA_PLUGGED,mPlugType);
  intent.putExtra(BatteryManager.EXTRA_VOLTAGE,mBatteryVoltage);
  intent.putExtra(BatteryManager.EXTRA_TEMPERATURE,mBatteryTemperature);
  intent.putExtra(BatteryManager.EXTRA_TECHNOLOGY,mBatteryTechnology);
  if (false) {
    Log.d(TAG,"updateBattery level:" + mBatteryLevel + " scale:"+ BATTERY_SCALE+ " status:"+ mBatteryStatus+ " health:"+ mBatteryHealth+ " present:"+ mBatteryPresent+ " voltage: "+ mBatteryVoltage+ " temperature: "+ mBatteryTemperature+ " technology: "+ mBatteryTechnology+ " AC powered:"+ mAcOnline+ " USB powered:"+ mUsbOnline+ " icon:"+ icon);
  }
  ActivityManagerNative.broadcastStickyIntent(intent,null);
}
