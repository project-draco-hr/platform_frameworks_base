{
  ArrayList<EventHandler> eventHandlers=mEventTypeMap.get(event.getClass());
  if (eventHandlers == null) {
    return;
  }
  boolean hasPostedEvent=false;
  event.onPreDispatch();
  eventHandlers=(ArrayList<EventHandler>)eventHandlers.clone();
  for (  final EventHandler eventHandler : eventHandlers) {
    if (eventHandler.subscriber.getReference() != null) {
      if (event.requiresPost) {
        mHandler.post(new Runnable(){
          @Override public void run(){
            processEvent(eventHandler,event);
          }
        }
);
        hasPostedEvent=true;
      }
 else {
        processEvent(eventHandler,event);
      }
    }
  }
  if (hasPostedEvent) {
    mHandler.post(new Runnable(){
      @Override public void run(){
        event.onPostDispatch();
      }
    }
);
  }
 else {
    event.onPostDispatch();
  }
}
