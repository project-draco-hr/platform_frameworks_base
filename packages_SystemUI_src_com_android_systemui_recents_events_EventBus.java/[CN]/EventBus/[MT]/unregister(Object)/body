{
  if (DEBUG_TRACE_ALL) {
    logWithPid("unregister()");
  }
  long callingThreadId=Thread.currentThread().getId();
  if (callingThreadId != mHandler.getLooper().getThread().getId()) {
    throw new RuntimeException("Can not unregister() a subscriber from a non-main thread.");
  }
  if (!findRegisteredSubscriber(subscriber,true)) {
    return;
  }
  Class<?> subscriberType=subscriber.getClass();
  ArrayList<EventHandlerMethod> subscriberMethods=mSubscriberTypeMap.get(subscriberType);
  if (subscriberMethods != null) {
    for (    EventHandlerMethod method : subscriberMethods) {
      ArrayList<EventHandler> eventHandlers=mEventTypeMap.get(method.eventType);
      for (int i=eventHandlers.size() - 1; i >= 0; i--) {
        if (eventHandlers.get(i).subscriber.getReference() == subscriber) {
          eventHandlers.remove(i);
        }
      }
    }
  }
}
