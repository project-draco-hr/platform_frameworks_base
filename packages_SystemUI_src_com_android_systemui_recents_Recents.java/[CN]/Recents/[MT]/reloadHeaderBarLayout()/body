{
  Resources res=mContext.getResources();
  mWindowRect=mSystemServicesProxy.getWindowRect();
  mStatusBarHeight=res.getDimensionPixelSize(com.android.internal.R.dimen.status_bar_height);
  mNavBarHeight=res.getDimensionPixelSize(com.android.internal.R.dimen.navigation_bar_height);
  mNavBarWidth=res.getDimensionPixelSize(com.android.internal.R.dimen.navigation_bar_width);
  mConfig=RecentsConfiguration.reinitialize(mContext,mSystemServicesProxy);
  mConfig.updateOnConfigurationChange();
  Rect searchBarBounds=new Rect();
  if (mSystemServicesProxy.getOrBindSearchAppWidget(mContext,mAppWidgetHost) != null) {
    mConfig.getSearchBarBounds(mWindowRect.width(),mWindowRect.height(),mStatusBarHeight,searchBarBounds);
  }
  mConfig.getAvailableTaskStackBounds(mWindowRect.width(),mWindowRect.height(),mStatusBarHeight,(mConfig.hasTransposedNavBar ? mNavBarWidth : 0),searchBarBounds,mTaskStackBounds);
  if (mConfig.isLandscape && mConfig.hasTransposedNavBar) {
    mSystemInsets.set(0,mStatusBarHeight,mNavBarWidth,0);
  }
 else {
    mSystemInsets.set(0,mStatusBarHeight,0,mNavBarHeight);
  }
  TaskStack stack=new TaskStack();
  mDummyStackView=new TaskStackView(mContext,stack);
  TaskStackViewLayoutAlgorithm algo=mDummyStackView.getStackAlgorithm();
  Rect taskStackBounds=new Rect(mTaskStackBounds);
  taskStackBounds.bottom-=mSystemInsets.bottom;
  algo.computeRects(mWindowRect.width(),mWindowRect.height(),taskStackBounds);
  Rect taskViewSize=algo.getUntransformedTaskViewSize();
  int taskBarHeight=res.getDimensionPixelSize(R.dimen.recents_task_bar_height);
synchronized (mHeaderBarLock) {
    mHeaderBar=(TaskViewHeader)mInflater.inflate(R.layout.recents_task_view_header,null,false);
    mHeaderBar.measure(View.MeasureSpec.makeMeasureSpec(taskViewSize.width(),View.MeasureSpec.EXACTLY),View.MeasureSpec.makeMeasureSpec(taskBarHeight,View.MeasureSpec.EXACTLY));
    mHeaderBar.layout(0,0,taskViewSize.width(),taskBarHeight);
  }
}
