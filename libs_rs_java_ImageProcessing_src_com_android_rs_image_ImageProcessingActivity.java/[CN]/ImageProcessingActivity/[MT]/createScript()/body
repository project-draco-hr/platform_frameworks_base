{
  mRS=RenderScript.create();
  mRS.mMessageCallback=new FilterCallback();
  mInPixelsAllocation=Allocation.createBitmapRef(mRS,mBitmapIn);
  mOutPixelsAllocation=Allocation.createBitmapRef(mRS,mBitmapOut);
  mScratchPixelsAllocation=Allocation.createBitmapRef(mRS,mBitmapScratch);
  mScriptVBlur=new ScriptC_Vertical_blur(mRS,getResources(),R.raw.vertical_blur,false);
  mScriptHBlur=new ScriptC_Horizontal_blur(mRS,getResources(),R.raw.horizontal_blur,false);
  mScriptLevels=new ScriptC_Levels(mRS,getResources(),R.raw.levels,false);
  mScript=new ScriptC_Threshold(mRS,getResources(),R.raw.threshold,false);
  mScript.set_width(mBitmapIn.getWidth());
  mScript.set_height(mBitmapIn.getHeight());
  mScript.set_radius(mRadius);
  mScriptLevels.invoke_setLevels(mInBlack,mOutBlack,mInWhite,mOutWhite);
  mScriptLevels.invoke_setGamma(mGamma);
  mScriptLevels.invoke_setSaturation(mSaturation);
  mScript.bind_InPixel(mInPixelsAllocation);
  mScript.bind_OutPixel(mOutPixelsAllocation);
  mScript.bind_ScratchPixel(mScratchPixelsAllocation);
  mScript.set_vBlurScript(mScriptVBlur);
  mScript.set_hBlurScript(mScriptHBlur);
  mScript.set_levelsScript(mScriptLevels);
}
