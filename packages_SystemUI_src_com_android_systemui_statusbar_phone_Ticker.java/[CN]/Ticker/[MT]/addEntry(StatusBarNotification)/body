{
  int initialCount=mSegments.size();
  if (initialCount > 0) {
    final Segment seg=mSegments.get(0);
    if (n.getPkg().equals(seg.notification.getPkg()) && n.getNotification().icon == seg.notification.getNotification().icon && n.getNotification().iconLevel == seg.notification.getNotification().iconLevel && CharSequences.equals(seg.notification.getNotification().tickerText,n.getNotification().tickerText)) {
      return;
    }
  }
  final Drawable icon=StatusBarIconView.getIcon(mContext,new StatusBarIcon(n.getPkg(),n.getUser(),n.getNotification().icon,n.getNotification().iconLevel,0,n.getNotification().tickerText));
  final CharSequence text=n.getNotification().tickerText;
  final Segment newSegment=new Segment(n,icon,text);
  for (int i=0; i < mSegments.size(); i++) {
    Segment seg=mSegments.get(i);
    if (n.getId() == seg.notification.getId() && n.getPkg().equals(seg.notification.getPkg())) {
      mSegments.remove(i--);
    }
  }
  mSegments.add(newSegment);
  if (initialCount == 0 && mSegments.size() > 0) {
    Segment seg=mSegments.get(0);
    seg.first=false;
    mIconSwitcher.setAnimateFirstView(false);
    mIconSwitcher.reset();
    mIconSwitcher.setImageDrawable(seg.icon);
    mTextSwitcher.setAnimateFirstView(false);
    mTextSwitcher.reset();
    mTextSwitcher.setText(seg.getText());
    tickerStarting();
    scheduleAdvance();
  }
}
