{
  final String cpuAbi=Build.CPU_ABI;
  try {
    int result=cachePackageSharedLibsForAbiLI(pkg,dataPath,scanFile,cpuAbi);
    if (result == PACKAGE_INSTALL_NATIVE_ABI_MISMATCH) {
      String cpuAbi2=SystemProperties.get("ro.product.cpu.abi2",null);
      if (cpuAbi2 != null) {
        result=cachePackageSharedLibsForAbiLI(pkg,dataPath,scanFile,cpuAbi2);
      }
      if (result == PACKAGE_INSTALL_NATIVE_ABI_MISMATCH) {
        Log.w(TAG,"Native ABI mismatch from package file");
        return PackageManager.INSTALL_FAILED_INVALID_APK;
      }
    }
  }
 catch (  ZipException e) {
    Log.w(TAG,"Failed to extract data from package file",e);
    return PackageManager.INSTALL_FAILED_INVALID_APK;
  }
catch (  IOException e) {
    Log.w(TAG,"Failed to cache package shared libs",e);
    return PackageManager.INSTALL_FAILED_INSUFFICIENT_STORAGE;
  }
  return PackageManager.INSTALL_SUCCEEDED;
}
