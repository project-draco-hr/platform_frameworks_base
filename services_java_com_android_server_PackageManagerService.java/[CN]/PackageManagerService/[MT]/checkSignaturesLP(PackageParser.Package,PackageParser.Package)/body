{
  if (p1.mSignatures == null) {
    return p2.mSignatures == null ? PackageManager.SIGNATURE_NEITHER_SIGNED : PackageManager.SIGNATURE_FIRST_NOT_SIGNED;
  }
  if (p2.mSignatures == null) {
    return PackageManager.SIGNATURE_SECOND_NOT_SIGNED;
  }
  final int N1=p1.mSignatures.length;
  final int N2=p2.mSignatures.length;
  for (int i=0; i < N1; i++) {
    boolean match=false;
    for (int j=0; j < N2; j++) {
      if (p1.mSignatures[i].equals(p2.mSignatures[j])) {
        match=true;
        break;
      }
    }
    if (!match) {
      return PackageManager.SIGNATURE_NO_MATCH;
    }
  }
  return PackageManager.SIGNATURE_MATCH;
}
