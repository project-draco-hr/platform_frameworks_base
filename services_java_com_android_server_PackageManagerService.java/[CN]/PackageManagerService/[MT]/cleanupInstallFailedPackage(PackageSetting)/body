{
  Log.i(TAG,"Cleaning up incompletely installed app: " + ps.name);
  if (mInstaller != null) {
    int retCode=mInstaller.remove(ps.name);
    if (retCode < 0) {
      Log.w(TAG,"Couldn't remove app data directory for package: " + ps.name + ", retcode="+ retCode);
    }
  }
 else {
    PackageParser.Package pkg=mPackages.get(ps.name);
    File dataDir=new File(pkg.applicationInfo.dataDir);
    dataDir.delete();
  }
  if (ps.codePath != null) {
    if (!ps.codePath.delete()) {
      Log.w(TAG,"Unable to remove old code file: " + ps.codePath);
    }
  }
  if (ps.resourcePath != null) {
    if (!ps.resourcePath.delete() && !ps.resourcePath.equals(ps.codePath)) {
      Log.w(TAG,"Unable to remove old code file: " + ps.resourcePath);
    }
  }
  mSettings.removePackageLP(ps.name);
}
