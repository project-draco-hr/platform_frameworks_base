{
  ApplicationInfo applicationInfo=p.applicationInfo;
  if (applicationInfo == null) {
    Log.w(TAG,"Package " + p.packageName + " has no applicationInfo.");
    return false;
  }
  File sourceFile=new File(applicationInfo.sourceDir);
  if (!sourceFile.exists()) {
    Log.w(TAG,"Package source " + applicationInfo.sourceDir + " does not exist.");
    return false;
  }
  outInfo.uid=applicationInfo.uid;
  removePackageDataLI(p,outInfo,flags);
  if (deleteCodeAndResources) {
    sourceFile.delete();
    final File publicSourceFile=new File(applicationInfo.publicSourceDir);
    if (publicSourceFile.exists()) {
      publicSourceFile.delete();
    }
    if (mInstaller != null) {
      int retCode=mInstaller.rmdex(sourceFile.toString());
      if (retCode < 0) {
        Log.w(TAG,"Couldn't remove dex file for package: " + p.packageName + " at location "+ sourceFile.toString()+ ", retcode="+ retCode);
      }
    }
  }
  return true;
}
