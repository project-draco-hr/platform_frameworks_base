{
  ApplicationInfo applicationInfo=p.applicationInfo;
  if (applicationInfo == null) {
    Slog.w(TAG,"Package " + p.packageName + " has no applicationInfo.");
    return false;
  }
  if (outInfo != null) {
    outInfo.uid=applicationInfo.uid;
  }
  removePackageDataLI(p,outInfo,flags);
  if (deleteCodeAndResources) {
    int installFlags=((p.applicationInfo.flags & ApplicationInfo.FLAG_EXTERNAL_STORAGE) != 0) ? PackageManager.INSTALL_EXTERNAL : 0;
    installFlags|=((p.applicationInfo.flags & ApplicationInfo.FLAG_FORWARD_LOCK) != 0) ? PackageManager.INSTALL_FORWARD_LOCK : 0;
    outInfo.args=createInstallArgs(installFlags,applicationInfo.sourceDir,applicationInfo.publicSourceDir);
  }
  return true;
}
