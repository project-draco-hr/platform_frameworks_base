{
  PackageRemovedInfo info=new PackageRemovedInfo();
  boolean res;
synchronized (mInstallLock) {
    res=deletePackageLI(packageName,deleteCodeAndResources,flags,info);
  }
  if (res && sendBroadCast) {
    boolean systemUpdate=info.isRemovedPackageSystemUpdate;
    info.sendBroadcast(deleteCodeAndResources,systemUpdate);
    if (systemUpdate) {
      Bundle extras=new Bundle(1);
      extras.putInt(Intent.EXTRA_UID,info.removedUid >= 0 ? info.removedUid : info.uid);
      extras.putBoolean(Intent.EXTRA_REPLACING,true);
      sendPackageBroadcast(Intent.ACTION_PACKAGE_ADDED,packageName,extras);
      sendPackageBroadcast(Intent.ACTION_PACKAGE_REPLACED,packageName,extras);
    }
  }
synchronized (mInstallLock) {
    if (info.args != null) {
      info.args.cleanUpResourcesLI();
    }
  }
  return res;
}
