{
synchronized (mPackages) {
    final ArrayList<PackageInfo> res=new ArrayList<PackageInfo>();
    final ArrayList<PackageSetting> pref=mSettings.mPreferredPackages;
    final int N=pref.size();
    for (int i=0; i < N; i++) {
      res.add(generatePackageInfo(pref.get(i).pkg,flags));
    }
    return res;
  }
}
