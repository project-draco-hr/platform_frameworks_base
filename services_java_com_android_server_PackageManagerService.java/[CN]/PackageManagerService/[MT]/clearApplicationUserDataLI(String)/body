{
  if (packageName == null) {
    Log.w(TAG,"Attempt to delete null packageName.");
    return false;
  }
  PackageParser.Package p;
  boolean dataOnly=false;
synchronized (mPackages) {
    p=mPackages.get(packageName);
    if (p == null) {
      dataOnly=true;
      PackageSetting ps=mSettings.mPackages.get(packageName);
      if ((ps == null) || (ps.pkg == null)) {
        Log.w(TAG,"Package named '" + packageName + "' doesn't exist.");
        return false;
      }
      p=ps.pkg;
    }
  }
  boolean useEncryptedFSDir=false;
  if (!dataOnly) {
    if (p == null) {
      Log.w(TAG,"Package named '" + packageName + "' doesn't exist.");
      return false;
    }
    final ApplicationInfo applicationInfo=p.applicationInfo;
    if (applicationInfo == null) {
      Log.w(TAG,"Package " + packageName + " has no applicationInfo.");
      return false;
    }
    useEncryptedFSDir=useEncryptedFilesystemForPackage(p);
  }
  if (mInstaller != null) {
    int retCode=mInstaller.clearUserData(packageName,useEncryptedFSDir);
    if (retCode < 0) {
      Log.w(TAG,"Couldn't remove cache files for package: " + packageName);
      return false;
    }
  }
  return true;
}
