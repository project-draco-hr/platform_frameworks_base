{
  if (mContext.checkCallingOrSelfPermission(android.Manifest.permission.DUMP) != PackageManager.PERMISSION_GRANTED) {
    pw.println("Permission Denial: can't dump ActivityManager from from pid=" + Binder.getCallingPid() + ", uid="+ Binder.getCallingUid()+ " without permission "+ android.Manifest.permission.DUMP);
    return;
  }
synchronized (mPackages) {
    pw.println("Activity Resolver Table:");
    mActivities.dump(pw,"  ");
    pw.println(" ");
    pw.println("Receiver Resolver Table:");
    mReceivers.dump(pw,"  ");
    pw.println(" ");
    pw.println("Service Resolver Table:");
    mServices.dump(pw,"  ");
    pw.println(" ");
    pw.println("Preferred Activities:");
    mSettings.mPreferredActivities.dump(pw,"  ");
    pw.println(" ");
    pw.println("Permissions:");
{
      for (      BasePermission p : mSettings.mPermissions.values()) {
        pw.print("  Permission [");
        pw.print(p.name);
        pw.print("] (");
        pw.print(Integer.toHexString(System.identityHashCode(p)));
        pw.println("):");
        pw.print("    sourcePackage=");
        pw.println(p.sourcePackage);
        pw.print("    uid=");
        pw.print(p.uid);
        pw.print(" gids=");
        pw.print(arrayToString(p.gids));
        pw.print(" type=");
        pw.println(p.type);
      }
    }
    pw.println(" ");
    pw.println("Packages:");
{
      for (      PackageSetting ps : mSettings.mPackages.values()) {
        pw.print("  Package [");
        pw.print(ps.name);
        pw.print("] (");
        pw.print(Integer.toHexString(System.identityHashCode(ps)));
        pw.println("):");
        pw.print("    userId=");
        pw.print(ps.userId);
        pw.print(" gids=");
        pw.println(arrayToString(ps.gids));
        pw.print("    sharedUser=");
        pw.println(ps.sharedUser);
        pw.print("    pkg=");
        pw.println(ps.pkg);
        pw.print("    codePath=");
        pw.println(ps.codePathString);
        pw.print("    resourcePath=");
        pw.println(ps.resourcePathString);
        if (ps.pkg != null) {
          pw.print("    dataDir=");
          pw.println(ps.pkg.applicationInfo.dataDir);
          pw.print("    targetSdk=");
          pw.println(ps.pkg.applicationInfo.targetSdkVersion);
          pw.print("    supportsScreens=[");
          boolean first=true;
          if ((ps.pkg.applicationInfo.flags & ApplicationInfo.FLAG_SUPPORTS_NORMAL_SCREENS) != 0) {
            if (!first)             pw.print(", ");
            first=false;
            pw.print("medium");
          }
          if ((ps.pkg.applicationInfo.flags & ApplicationInfo.FLAG_SUPPORTS_LARGE_SCREENS) != 0) {
            if (!first)             pw.print(", ");
            first=false;
            pw.print("large");
          }
          if ((ps.pkg.applicationInfo.flags & ApplicationInfo.FLAG_SUPPORTS_SMALL_SCREENS) != 0) {
            if (!first)             pw.print(", ");
            first=false;
            pw.print("small");
          }
          if ((ps.pkg.applicationInfo.flags & ApplicationInfo.FLAG_RESIZEABLE_FOR_SCREENS) != 0) {
            if (!first)             pw.print(", ");
            first=false;
            pw.print("resizeable");
          }
          if ((ps.pkg.applicationInfo.flags & ApplicationInfo.FLAG_SUPPORTS_SCREEN_DENSITIES) != 0) {
            if (!first)             pw.print(", ");
            first=false;
            pw.print("anyDensity");
          }
        }
        pw.println("]");
        pw.print("    timeStamp=");
        pw.println(ps.getTimeStampStr());
        pw.print("    signatures=");
        pw.println(ps.signatures);
        pw.print("    permissionsFixed=");
        pw.print(ps.permissionsFixed);
        pw.print(" pkgFlags=0x");
        pw.print(Integer.toHexString(ps.pkgFlags));
        pw.print(" installStatus=");
        pw.print(ps.installStatus);
        pw.print(" enabled=");
        pw.println(ps.enabled);
        if (ps.disabledComponents.size() > 0) {
          pw.println("    disabledComponents:");
          for (          String s : ps.disabledComponents) {
            pw.print("      ");
            pw.println(s);
          }
        }
        if (ps.enabledComponents.size() > 0) {
          pw.println("    enabledComponents:");
          for (          String s : ps.enabledComponents) {
            pw.print("      ");
            pw.println(s);
          }
        }
        if (ps.grantedPermissions.size() > 0) {
          pw.println("    grantedPermissions:");
          for (          String s : ps.grantedPermissions) {
            pw.print("      ");
            pw.println(s);
          }
        }
        if (ps.loadedPermissions.size() > 0) {
          pw.println("    loadedPermissions:");
          for (          String s : ps.loadedPermissions) {
            pw.print("      ");
            pw.println(s);
          }
        }
      }
    }
    pw.println(" ");
    pw.println("Shared Users:");
{
      for (      SharedUserSetting su : mSettings.mSharedUsers.values()) {
        pw.print("  SharedUser [");
        pw.print(su.name);
        pw.print("] (");
        pw.print(Integer.toHexString(System.identityHashCode(su)));
        pw.println("):");
        pw.print("    userId=");
        pw.print(su.userId);
        pw.print(" gids=");
        pw.println(arrayToString(su.gids));
        pw.println("    grantedPermissions:");
        for (        String s : su.grantedPermissions) {
          pw.print("      ");
          pw.println(s);
        }
        pw.println("    loadedPermissions:");
        for (        String s : su.loadedPermissions) {
          pw.print("      ");
          pw.println(s);
        }
      }
    }
    pw.println(" ");
    pw.println("Settings parse messages:");
    pw.println(mSettings.mReadMessages.toString());
  }
synchronized (mProviders) {
    pw.println(" ");
    pw.println("Registered ContentProviders:");
    for (    PackageParser.Provider p : mProviders.values()) {
      pw.println("  [");
      pw.println(p.info.authority);
      pw.println("]: ");
      pw.println(p.toString());
    }
  }
}
