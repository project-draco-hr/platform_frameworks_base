{
  int retCode;
  if (forwardLocked) {
    try {
      extractPublicFiles(newPackage,destResourceFile);
    }
 catch (    IOException e) {
      Log.e(TAG,"Couldn't create a new zip file for the public parts of a" + " forward-locked app.");
      return PackageManager.INSTALL_FAILED_INSUFFICIENT_STORAGE;
    }
 finally {
    }
    if (mInstaller != null) {
      retCode=mInstaller.setForwardLockPerm(pkgName,newPackage.applicationInfo.uid);
    }
 else {
      final int filePermissions=FileUtils.S_IRUSR | FileUtils.S_IWUSR | FileUtils.S_IRGRP;
      retCode=FileUtils.setPermissions(destFilePath,filePermissions,-1,newPackage.applicationInfo.uid);
    }
  }
 else {
    final int filePermissions=FileUtils.S_IRUSR | FileUtils.S_IWUSR | FileUtils.S_IRGRP| FileUtils.S_IROTH;
    retCode=FileUtils.setPermissions(destFilePath,filePermissions,-1,-1);
  }
  if (retCode != 0) {
    Log.e(TAG,"Couldn't set new package file permissions for " + destFilePath + ". The return code was: "+ retCode);
  }
  return PackageManager.INSTALL_SUCCEEDED;
}
