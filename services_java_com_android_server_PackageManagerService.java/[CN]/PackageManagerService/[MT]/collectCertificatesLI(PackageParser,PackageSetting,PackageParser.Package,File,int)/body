{
  if (GET_CERTIFICATES) {
    if (ps != null && ps.codePath.equals(srcFile) && ps.getTimeStamp() == srcFile.lastModified()) {
      if (ps.signatures.mSignatures != null && ps.signatures.mSignatures.length != 0) {
        pkg.mSignatures=ps.signatures.mSignatures;
        return true;
      }
      Slog.w(TAG,"PackageSetting for " + ps.name + " is missing signatures.  Collecting certs again to recover them.");
    }
 else {
      Log.i(TAG,srcFile.toString() + " changed; collecting certs");
    }
    if (!pp.collectCertificates(pkg,parseFlags)) {
      mLastScanError=pp.getParseError();
      return false;
    }
  }
  return true;
}
