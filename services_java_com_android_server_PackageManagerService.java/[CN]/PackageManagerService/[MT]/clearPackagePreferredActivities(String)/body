{
synchronized (mPackages) {
    int uid=Binder.getCallingUid();
    PackageParser.Package pkg=mPackages.get(packageName);
    if (pkg == null || pkg.applicationInfo.uid != uid) {
      if (mContext.checkCallingOrSelfPermission(android.Manifest.permission.SET_PREFERRED_APPLICATIONS) != PackageManager.PERMISSION_GRANTED) {
        if (getUidTargetSdkVersionLockedLP(Binder.getCallingUid()) < Build.VERSION_CODES.FROYO) {
          Slog.w(TAG,"Ignoring clearPackagePreferredActivities() from uid " + Binder.getCallingUid());
          return;
        }
        mContext.enforceCallingOrSelfPermission(android.Manifest.permission.SET_PREFERRED_APPLICATIONS,null);
      }
    }
    if (clearPackagePreferredActivitiesLP(packageName)) {
      scheduleWriteSettingsLocked();
    }
  }
}
