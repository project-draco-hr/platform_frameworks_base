{
  ArrayList<ProviderInfo> finalList=null;
synchronized (mPackages) {
    Iterator<PackageParser.Provider> i=mProvidersByComponent.values().iterator();
    while (i.hasNext()) {
      PackageParser.Provider p=i.next();
      if (p.info.authority != null && (processName == null || (p.info.processName.equals(processName) && p.info.applicationInfo.uid == uid)) && mSettings.isEnabledLP(p.info,flags) && (!mSafeMode || (p.info.applicationInfo.flags & ApplicationInfo.FLAG_SYSTEM) != 0)) {
        if (finalList == null) {
          finalList=new ArrayList<ProviderInfo>(3);
        }
        finalList.add(PackageParser.generateProviderInfo(p,flags));
      }
    }
  }
  if (finalList != null) {
    Collections.sort(finalList,mProviderInitOrderSorter);
  }
  return finalList;
}
