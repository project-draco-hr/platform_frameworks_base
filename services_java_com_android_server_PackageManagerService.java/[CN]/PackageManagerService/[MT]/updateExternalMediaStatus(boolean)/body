{
  final boolean ret;
synchronized (mPackages) {
    if (DEBUG_SD_INSTALL)     Log.i(TAG,"updateExternalMediaStatus:: mediaStatus=" + mediaStatus + ", mMediaMounted="+ mMediaMounted);
    if (mediaStatus == mMediaMounted) {
      return false;
    }
    mMediaMounted=mediaStatus;
    Set<String> appList=mSettings.findPackagesWithFlag(ApplicationInfo.FLAG_ON_SDCARD);
    ret=appList != null && appList.size() > 0;
  }
  mHandler.post(new Runnable(){
    public void run(){
      mHandler.removeCallbacks(this);
      updateExternalMediaStatusInner(mediaStatus,ret);
    }
  }
);
  return ret;
}
