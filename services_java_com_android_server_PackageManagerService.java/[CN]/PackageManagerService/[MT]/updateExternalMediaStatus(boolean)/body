{
synchronized (mPackages) {
    if (DEBUG_SD_INSTALL)     Log.i(TAG,"updateExternalMediaStatus:: mediaStatus=" + mediaStatus + ", mMediaMounted="+ mMediaMounted);
    if (mediaStatus == mMediaMounted) {
      return false;
    }
    mMediaMounted=mediaStatus;
    final HashMap<SdInstallArgs,String> processCids=new HashMap<SdInstallArgs,String>();
    final int[] uidArr=getExternalMediaPackages(mediaStatus,processCids);
    if (processCids.size() == 0) {
      return false;
    }
    mHandler.post(new Runnable(){
      public void run(){
        mHandler.removeCallbacks(this);
        if (mediaStatus) {
          if (DEBUG_SD_INSTALL)           Log.i(TAG,"Loading packages");
          loadMediaPackages(processCids,uidArr);
          startCleaningPackages();
        }
 else {
          if (DEBUG_SD_INSTALL)           Log.i(TAG,"Unloading packages");
          unloadMediaPackages(processCids,uidArr);
        }
      }
    }
);
    return true;
  }
}
