{
  if (pkg.mSignatures != null) {
    if (!pkgSetting.signatures.updateSignatures(pkg.mSignatures,updateSignature)) {
      Log.e(TAG,"Package " + pkg.packageName + " signatures do not match the previously installed version; ignoring!");
      mLastScanError=PackageManager.INSTALL_FAILED_UPDATE_INCOMPATIBLE;
      return false;
    }
    if (pkgSetting.sharedUser != null) {
      if (!pkgSetting.sharedUser.signatures.mergeSignatures(pkg.mSignatures,updateSignature)) {
        Log.e(TAG,"Package " + pkg.packageName + " has no signatures that match those in shared user "+ pkgSetting.sharedUser.name+ "; ignoring!");
        mLastScanError=PackageManager.INSTALL_FAILED_SHARED_USER_INCOMPATIBLE;
        return false;
      }
    }
  }
 else {
    pkg.mSignatures=pkgSetting.signatures.mSignatures;
  }
  return true;
}
