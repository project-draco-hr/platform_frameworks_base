{
  String newCacheId=getNextCodePath(oldCodePath,pkgName,"/" + RES_FILE_NAME);
  String newCachePath=null;
  final int RENAME_FAILED=1;
  final int MOUNT_FAILED=2;
  final int PASS=4;
  int errCode=RENAME_FAILED;
  String errMsg="RENAME_FAILED";
  boolean mounted=PackageHelper.isContainerMounted(cid);
  if (mounted) {
    if (!PackageHelper.unMountSdDir(cid)) {
      Log.i(TAG,"Failed to unmount " + cid + " before renaming");
      return false;
    }
    mounted=false;
  }
  if (PackageHelper.renameSdDir(cid,newCacheId)) {
    errCode=MOUNT_FAILED;
    errMsg="MOUNT_FAILED";
    if ((newCachePath=PackageHelper.mountSdDir(newCacheId,getEncryptKey(),Process.SYSTEM_UID)) != null) {
      errCode=PASS;
      errMsg="PASS";
    }
  }
  if (errCode != PASS) {
    Log.i(TAG,"Failed to rename " + cid + " to "+ newCacheId+ " at path: "+ cachePath+ " to new path: "+ newCachePath+ "err = "+ errMsg);
    return false;
  }
 else {
    Log.i(TAG,"Succesfully renamed " + cid + " to "+ newCacheId+ " at path: "+ cachePath+ " to new path: "+ newCachePath);
  }
  cid=newCacheId;
  cachePath=newCachePath;
  return true;
}
