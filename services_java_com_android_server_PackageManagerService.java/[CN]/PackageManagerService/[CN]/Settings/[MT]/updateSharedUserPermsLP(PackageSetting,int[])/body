{
  if ((deletedPs == null) || (deletedPs.pkg == null)) {
    Log.i(TAG,"Trying to update info for null package. Just ignoring");
    return;
  }
  if (deletedPs.sharedUser == null) {
    return;
  }
  SharedUserSetting sus=deletedPs.sharedUser;
  for (  String eachPerm : deletedPs.pkg.requestedPermissions) {
    boolean used=false;
    if (!sus.grantedPermissions.contains(eachPerm)) {
      continue;
    }
    for (    PackageSetting pkg : sus.packages) {
      if (pkg.pkg != null && !pkg.pkg.packageName.equalsIgnoreCase(deletedPs.pkg.packageName) && pkg.pkg.requestedPermissions.contains(eachPerm)) {
        used=true;
        break;
      }
    }
    if (!used) {
      sus.grantedPermissions.remove(eachPerm);
      sus.loadedPermissions.remove(eachPerm);
    }
  }
  int newGids[]=globalGids;
  for (  String eachPerm : sus.grantedPermissions) {
    BasePermission bp=mPermissions.get(eachPerm);
    if (bp != null) {
      newGids=appendInts(newGids,bp.gids);
    }
  }
  sus.gids=newGids;
}
