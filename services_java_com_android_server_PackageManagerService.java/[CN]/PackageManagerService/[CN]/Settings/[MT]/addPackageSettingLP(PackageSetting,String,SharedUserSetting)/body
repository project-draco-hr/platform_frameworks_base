{
  mPackages.put(name,p);
  if (sharedUser != null) {
    if (p.sharedUser != null && p.sharedUser != sharedUser) {
      reportSettingsProblem(Log.ERROR,"Package " + p.name + " was user "+ p.sharedUser+ " but is now "+ sharedUser+ "; I am not changing its files so it will probably fail!");
      p.sharedUser.packages.remove(p);
    }
 else     if (p.userId != sharedUser.userId) {
      reportSettingsProblem(Log.ERROR,"Package " + p.name + " was user id "+ p.userId+ " but is now user "+ sharedUser+ " with id "+ sharedUser.userId+ "; I am not changing its files so it will probably fail!");
    }
    sharedUser.packages.add(p);
    p.sharedUser=sharedUser;
    p.userId=sharedUser.userId;
  }
}
