{
  XmlConfigSource source=new XmlConfigSource(getContext(),R.xml.domain1);
  ApplicationConfig appConfig=new ApplicationConfig(source);
  assertTrue(appConfig.hasPerDomainConfigs());
  NetworkSecurityConfig config=appConfig.getConfigForHostname("");
  assertNotNull(config);
  assertTrue(config.isCleartextTrafficPermitted());
  assertFalse(config.isHstsEnforced());
  assertTrue(config.getTrustAnchors().isEmpty());
  PinSet pinSet=config.getPins();
  assertTrue(pinSet.pins.isEmpty());
  config=appConfig.getConfigForHostname("android.com");
  assertTrue(config.isCleartextTrafficPermitted());
  assertFalse(config.isHstsEnforced());
  assertFalse(config.getTrustAnchors().isEmpty());
  pinSet=config.getPins();
  assertTrue(pinSet.pins.isEmpty());
  SSLContext context=TestUtils.getSSLContext(source);
  TestUtils.assertConnectionSucceeds(context,"android.com",443);
  TestUtils.assertConnectionFails(context,"developer.android.com",443);
  TestUtils.assertUrlConnectionFails(context,"google.com",443);
  TestUtils.assertUrlConnectionSucceeds(context,"android.com",443);
}
