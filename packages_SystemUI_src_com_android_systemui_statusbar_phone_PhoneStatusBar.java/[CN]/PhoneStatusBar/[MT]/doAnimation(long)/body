{
  if (mAnimating) {
    if (SPEW)     Slog.d(TAG,"doAnimation dt=" + (frameTimeNanos - mAnimLastTimeNanos));
    if (SPEW)     Slog.d(TAG,"doAnimation before mAnimY=" + mAnimY);
    incrementAnim(frameTimeNanos);
    if (SPEW) {
      Slog.d(TAG,"doAnimation after  mAnimY=" + mAnimY);
      Slog.d(TAG,"doAnimation expandedViewMax=" + getExpandedViewMaxHeight());
    }
    if (mAnimY >= getExpandedViewMaxHeight() - 1 && !mClosing) {
      if (SPEW)       Slog.d(TAG,"Animation completed to expanded state.");
      mAnimating=false;
      updateExpandedViewPos(EXPANDED_FULL_OPEN);
      performExpand();
      return;
    }
    if (mAnimY == 0 && mAnimAccel == 0 && mClosing) {
      if (SPEW)       Slog.d(TAG,"Animation completed to collapsed state.");
      mAnimating=false;
      performCollapse();
      return;
    }
    if (mAnimY < getStatusBarHeight() && mClosing) {
      mAnimY=0;
      mAnimAccel=0;
      mAnimVel=0;
    }
    updateExpandedViewPos((int)mAnimY);
    mChoreographer.postCallback(Choreographer.CALLBACK_ANIMATION,mAnimationCallback,null);
  }
}
