{
  if (DEBUG)   Log.d(TAG,"addNotification key=" + notification.getKey());
  mNotificationData.updateRanking(ranking);
  Entry shadeEntry=createNotificationViews(notification);
  if (shadeEntry == null) {
    return;
  }
  boolean isHeadsUped=mUseHeadsUp && shouldPeek(shadeEntry);
  if (isHeadsUped) {
    mHeadsUpManager.showNotification(shadeEntry);
    setNotificationShown(notification);
  }
  if (!isHeadsUped && notification.getNotification().fullScreenIntent != null) {
    awakenDreams();
    if (DEBUG)     Log.d(TAG,"Notification has fullScreenIntent; sending fullScreenIntent");
    try {
      EventLog.writeEvent(EventLogTags.SYSUI_FULLSCREEN_NOTIFICATION,notification.getKey());
      notification.getNotification().fullScreenIntent.send();
      shadeEntry.notifyFullScreenIntentLaunched();
      MetricsLogger.count(mContext,"note_fullscreen",1);
    }
 catch (    PendingIntent.CanceledException e) {
    }
  }
  addNotificationViews(shadeEntry,ranking);
  setAreThereNotifications();
}
