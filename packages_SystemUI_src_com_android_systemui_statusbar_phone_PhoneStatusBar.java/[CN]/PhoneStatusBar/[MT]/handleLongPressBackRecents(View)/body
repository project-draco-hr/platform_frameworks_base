{
  try {
    boolean sendBackLongPress=false;
    IActivityManager activityManager=ActivityManagerNative.getDefault();
    boolean isAccessiblityEnabled=mAccessibilityManager.isEnabled();
    if (activityManager.isInLockTaskMode() && !isAccessiblityEnabled) {
      long time=System.currentTimeMillis();
      if ((time - mLastLockToAppLongPress) < LOCK_TO_APP_GESTURE_TOLERENCE) {
        activityManager.stopLockTaskModeOnCurrent();
      }
 else       if ((v.getId() == R.id.back) && !mNavigationBarView.getRecentsButton().isPressed()) {
        sendBackLongPress=true;
      }
      mLastLockToAppLongPress=time;
    }
 else {
      if (v.getId() == R.id.back) {
        sendBackLongPress=true;
      }
 else       if (isAccessiblityEnabled && activityManager.isInLockTaskMode()) {
        activityManager.stopLockTaskModeOnCurrent();
      }
    }
    if (sendBackLongPress) {
      KeyButtonView keyButtonView=(KeyButtonView)v;
      keyButtonView.sendEvent(KeyEvent.ACTION_DOWN,KeyEvent.FLAG_LONG_PRESS);
      keyButtonView.sendAccessibilityEvent(AccessibilityEvent.TYPE_VIEW_LONG_CLICKED);
    }
  }
 catch (  RemoteException e) {
    Log.d(TAG,"Unable to reach activity manager",e);
  }
}
