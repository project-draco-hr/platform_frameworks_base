{
  if (SPEW) {
    Slog.d(TAG,"updateExpandedViewPos before expandedPosition=" + expandedPosition + " mTrackingPosition="+ mTrackingPosition);
  }
  int h=0;
  int disph=mDisplayMetrics.heightPixels;
  if (!mExpandedVisible) {
    updateExpandedInvisiblePosition();
    return;
  }
  int pos;
  if (expandedPosition == EXPANDED_FULL_OPEN) {
    pos=h;
  }
 else   if (expandedPosition == EXPANDED_LEAVE_ALONE) {
    pos=mTrackingPosition;
  }
 else {
    if (expandedPosition <= disph) {
      pos=expandedPosition;
    }
 else {
      pos=disph;
    }
    pos-=disph - h;
  }
  mTrackingPosition=pos;
  mNotificationPanel.setY(pos);
  final float frac=1.0f + (float)pos / mDisplayMetrics.heightPixels;
  final int color=((int)(0xCC * frac * frac)) << 24;
  mExpandedWindowView.setBackgroundColor(color);
}
