{
  Slog.d(TAG,"addNotification score=" + notification.score);
  StatusBarIconView iconView=addNotificationViews(key,notification);
  if (iconView == null)   return;
  boolean immersive=false;
  try {
    immersive=ActivityManagerNative.getDefault().isTopActivityImmersive();
    if (DEBUG) {
      Slog.d(TAG,"Top activity is " + (immersive ? "immersive" : "not immersive"));
    }
  }
 catch (  RemoteException ex) {
  }
  if (ENABLE_INTRUDERS && (notification.notification.intruderView != null)) {
    Slog.d(TAG,"Presenting high-priority notification");
    if (notification.notification.intruderView == null) {
      Slog.e(TAG,notification.notification.toString() + " wanted to intrude but intruderView was null");
      return;
    }
    PendingIntent contentIntent=notification.notification.contentIntent;
    final View.OnClickListener listener=(contentIntent != null) ? new NotificationClicker(contentIntent,notification.pkg,notification.tag,notification.id) : null;
    mIntruderAlertView.applyIntruderContent(notification.notification.intruderView,listener);
    mCurrentlyIntrudingNotification=notification;
    mHandler.sendEmptyMessage(MSG_SHOW_INTRUDER);
    mHandler.removeMessages(MSG_HIDE_INTRUDER);
    if (INTRUDER_ALERT_DECAY_MS > 0) {
      mHandler.sendEmptyMessageDelayed(MSG_HIDE_INTRUDER,INTRUDER_ALERT_DECAY_MS);
    }
  }
 else   if (notification.notification.fullScreenIntent != null) {
    Slog.d(TAG,"Notification has fullScreenIntent; sending fullScreenIntent");
    try {
      notification.notification.fullScreenIntent.send();
    }
 catch (    PendingIntent.CanceledException e) {
    }
  }
 else {
    if (mCurrentlyIntrudingNotification == null) {
      tick(notification);
    }
  }
  setAreThereNotifications();
  updateExpandedViewPos(EXPANDED_LEAVE_ALONE);
}
