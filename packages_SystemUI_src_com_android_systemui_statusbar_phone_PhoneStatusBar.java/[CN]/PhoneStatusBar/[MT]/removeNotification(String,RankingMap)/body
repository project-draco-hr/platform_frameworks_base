{
  if (ENABLE_HEADS_UP && mHeadsUpNotificationView.getEntry() != null && key.equals(mHeadsUpNotificationView.getEntry().notification.getKey())) {
    mHeadsUpNotificationView.clear();
  }
  StatusBarNotification old=removeNotificationViews(key,ranking);
  if (SPEW)   Log.d(TAG,"removeNotification key=" + key + " old="+ old);
  if (old != null) {
    if (mTickerEnabled) {
      mTicker.removeEntry(old);
    }
    updateExpandedViewPos(EXPANDED_LEAVE_ALONE);
    if (CLOSE_PANEL_WHEN_EMPTIED && mNotificationData.size() == 0 && !mNotificationPanel.isTracking() && mState != StatusBarState.KEYGUARD) {
      animateCollapsePanels();
    }
  }
  mIntercepted.remove(key);
  setAreThereNotifications();
}
