{
  if (SPEW) {
    Slog.d(TAG,"animateCollapse(): mExpanded=" + mExpanded + " mExpandedVisible="+ mExpandedVisible+ " mExpanded="+ mExpanded+ " mAnimating="+ mAnimating+ " mAnimY="+ mAnimY+ " mAnimVel="+ mAnimVel+ " flags="+ flags);
  }
  if ((flags & CommandQueue.FLAG_EXCLUDE_RECENTS_PANEL) == 0) {
    mHandler.removeMessages(MSG_CLOSE_RECENTS_PANEL);
    mHandler.sendEmptyMessage(MSG_CLOSE_RECENTS_PANEL);
  }
  if ((flags & CommandQueue.FLAG_EXCLUDE_SEARCH_PANEL) == 0) {
    mHandler.removeMessages(MSG_CLOSE_SEARCH_PANEL);
    mHandler.sendEmptyMessage(MSG_CLOSE_SEARCH_PANEL);
  }
  if (!mExpandedVisible) {
    return;
  }
  int y;
  if (mAnimating) {
    y=(int)mAnimY;
  }
 else {
    y=getExpandedViewMaxHeight() - 1;
  }
  mExpanded=true;
  prepareTracking(y,false);
  performFling(y,-mSelfCollapseVelocityPx * velocityMultiplier,true);
}
