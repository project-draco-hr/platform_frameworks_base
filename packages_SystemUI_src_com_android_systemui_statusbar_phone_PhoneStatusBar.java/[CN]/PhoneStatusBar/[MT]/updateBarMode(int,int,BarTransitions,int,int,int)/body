{
  final int oldMode=barMode(oldVis,transientFlag,transparentFlag);
  final int newMode=barMode(newVis,transientFlag,transparentFlag);
  if (oldMode == newMode) {
    return -1;
  }
  boolean animate=windowState == StatusBarManager.WINDOW_STATE_SHOWING && oldMode == MODE_SEMI_TRANSPARENT && newMode == MODE_OPAQUE;
  transitions.transitionTo(newMode,animate);
  return newMode;
}
