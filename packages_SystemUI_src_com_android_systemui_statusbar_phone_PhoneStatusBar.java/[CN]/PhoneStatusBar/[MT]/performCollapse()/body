{
  if (SPEW)   Slog.d(TAG,"performCollapse: mExpanded=" + mExpanded + " mExpandedVisible="+ mExpandedVisible);
  if (!mExpandedVisible) {
    return;
  }
  mExpandedVisible=false;
  visibilityChanged(false);
  makeSlippery(mNavigationBarView,false);
  WindowManager.LayoutParams lp=(WindowManager.LayoutParams)mStatusBarWindow.getLayoutParams();
  lp.height=getStatusBarHeight();
  lp.flags|=WindowManager.LayoutParams.FLAG_NOT_FOCUSABLE;
  lp.flags&=~WindowManager.LayoutParams.FLAG_ALT_FOCUSABLE_IM;
  final WindowManager wm=WindowManagerImpl.getDefault();
  wm.updateViewLayout(mStatusBarWindow,lp);
  if ((mDisabled & StatusBarManager.DISABLE_NOTIFICATION_ICONS) == 0) {
    setNotificationIconVisibility(true,com.android.internal.R.anim.fade_in);
  }
  if (!mExpanded) {
    return;
  }
  mExpanded=false;
  dismissPopups();
  if (mPostCollapseCleanup != null) {
    mPostCollapseCleanup.run();
    mPostCollapseCleanup=null;
  }
}
