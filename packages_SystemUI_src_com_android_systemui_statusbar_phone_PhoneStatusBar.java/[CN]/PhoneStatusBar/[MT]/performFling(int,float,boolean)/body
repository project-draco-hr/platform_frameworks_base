{
  if (CHATTY) {
    Slog.d(TAG,"panel: will fling, y=" + y + " vel="+ vel+ " mExpanded="+ mExpanded);
  }
  mAnimatingReveal=false;
  mAnimY=y;
  mAnimVel=vel;
  if (mExpanded) {
    if (!always && (vel > mFlingCollapseMinVelocityPx || (y > (getExpandedViewMaxHeight() * (1f - mCollapseMinDisplayFraction)) && vel > -mFlingExpandMinVelocityPx))) {
      mAnimAccel=mExpandAccelPx;
      if (vel < 0) {
        mAnimVel=0;
      }
    }
 else {
      mAnimAccel=-mCollapseAccelPx;
      if (vel > 0) {
        mAnimVel=0;
      }
    }
  }
 else {
    if (always || (vel > mFlingExpandMinVelocityPx || (y > (getExpandedViewMaxHeight() * (1f - mExpandMinDisplayFraction)) && vel > -mFlingCollapseMinVelocityPx))) {
      mAnimAccel=mExpandAccelPx;
      if (vel < 0) {
        mAnimVel=0;
      }
    }
 else {
      mAnimAccel=-mCollapseAccelPx;
      if (vel > 0) {
        mAnimVel=0;
      }
    }
  }
  resetLastAnimTime();
  mAnimating=true;
  mClosing=mAnimAccel < 0;
  mChoreographer.removeCallbacks(Choreographer.CALLBACK_ANIMATION,mAnimationCallback,null);
  mChoreographer.removeCallbacks(Choreographer.CALLBACK_ANIMATION,mRevealAnimationCallback,null);
  mChoreographer.postCallback(Choreographer.CALLBACK_ANIMATION,mAnimationCallback,null);
  stopTracking();
}
