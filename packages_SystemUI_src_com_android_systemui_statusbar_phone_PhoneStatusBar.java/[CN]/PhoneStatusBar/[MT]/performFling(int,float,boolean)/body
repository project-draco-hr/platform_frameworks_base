{
  if (CHATTY) {
    Slog.d(TAG,"panel: will fling, y=" + y + " vel="+ vel);
  }
  mAnimatingReveal=false;
  mAnimY=y;
  mAnimVel=vel;
  if (mExpanded) {
    if (!always && (vel > mFlingCollapseMinVelocityPx || (y > (getExpandedViewMaxHeight() * (1f - mCollapseMinDisplayFraction)) && vel > -mFlingExpandMinVelocityPx))) {
      mAnimAccel=mExpandAccelPx;
      if (vel < 0) {
        mAnimVel=0;
      }
    }
 else {
      mAnimAccel=-mCollapseAccelPx;
      if (vel > 0) {
        mAnimVel=0;
      }
    }
  }
 else {
    if (always || (vel > mFlingExpandMinVelocityPx || (y > (getExpandedViewMaxHeight() * (1f - mExpandMinDisplayFraction)) && vel > -mFlingCollapseMinVelocityPx))) {
      mAnimAccel=mExpandAccelPx;
      if (vel < 0) {
        mAnimVel=0;
      }
    }
 else {
      mAnimAccel=-mCollapseAccelPx;
      if (vel > 0) {
        mAnimVel=0;
      }
    }
  }
  long now=SystemClock.uptimeMillis();
  mAnimLastTime=now;
  mCurAnimationTime=now + ANIM_FRAME_DURATION;
  mAnimating=true;
  mHandler.removeMessages(MSG_ANIMATE);
  mHandler.removeMessages(MSG_ANIMATE_REVEAL);
  mHandler.sendMessageAtTime(mHandler.obtainMessage(MSG_ANIMATE),mCurAnimationTime);
  stopTracking();
}
