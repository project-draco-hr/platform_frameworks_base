{
  mLaunchTransitionEndRunnable=endRunnable;
  Runnable hideRunnable=new Runnable(){
    @Override public void run(){
      mLaunchTransitionFadingAway=true;
      if (beforeFading != null) {
        beforeFading.run();
      }
      mNotificationPanel.setAlpha(1);
      mNotificationPanel.animate().alpha(0).setStartDelay(FADE_KEYGUARD_START_DELAY).setDuration(FADE_KEYGUARD_DURATION).withLayer().withEndAction(new Runnable(){
        @Override public void run(){
          mNotificationPanel.setAlpha(1);
          if (mLaunchTransitionEndRunnable != null) {
            mLaunchTransitionEndRunnable.run();
          }
          mLaunchTransitionEndRunnable=null;
          mLaunchTransitionFadingAway=false;
        }
      }
);
    }
  }
;
  if (mNotificationPanel.isLaunchTransitionRunning()) {
    mNotificationPanel.setLaunchTransitionEndRunnable(hideRunnable);
  }
 else {
    hideRunnable.run();
  }
}
