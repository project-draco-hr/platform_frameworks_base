{
  mNewVisibleNotifications.clear();
  for (int i=0; i < mNotificationData.size(); i++) {
    final Entry entry=mNotificationData.get(i);
    final boolean visible=entry.row != null && entry.row.getVisibility() == View.VISIBLE;
    if (visible) {
      mNewVisibleNotifications.add(entry.key + entry.notification.getPostTime());
    }
  }
  final boolean updates=!mVisibleNotifications.containsAll(mNewVisibleNotifications);
  mVisibleNotifications.clear();
  mVisibleNotifications.addAll(mNewVisibleNotifications);
  if (updates && mDozeServiceHost != null) {
    mDozeServiceHost.fireNewNotifications();
  }
}
