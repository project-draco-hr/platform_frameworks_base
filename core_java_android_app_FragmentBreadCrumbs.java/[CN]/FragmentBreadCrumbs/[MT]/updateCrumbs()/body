{
  FragmentManager fm=mActivity.getFragmentManager();
  int numEntries=fm.countBackStackEntries();
  int numViews=mContainer.getChildCount();
  for (int i=mTopEntry != null ? -1 : 0; i < numEntries; i++) {
    BackStackEntry bse=i == -1 ? mTopEntry : fm.getBackStackEntry(i);
    int viewI=mTopEntry != null ? i + 1 : i;
    if (viewI < numViews) {
      View v=mContainer.getChildAt(viewI);
      Object tag=v.getTag();
      if (tag != bse) {
        for (int j=viewI; j < numViews; j++) {
          mContainer.removeViewAt(viewI);
        }
        numViews=viewI;
      }
    }
    if (viewI >= numViews) {
      final View item=mInflater.inflate(com.android.internal.R.layout.fragment_bread_crumb_item,this,false);
      final TextView text=(TextView)item.findViewById(com.android.internal.R.id.title);
      text.setText(bse.getBreadCrumbTitle());
      text.setTag(bse);
      if (viewI == 0) {
        item.findViewById(com.android.internal.R.id.left_icon).setVisibility(View.GONE);
      }
      mContainer.addView(item);
      text.setOnClickListener(mOnClickListener);
    }
  }
  int viewI=mTopEntry != null ? numEntries + 1 : numEntries;
  numViews=mContainer.getChildCount();
  while (numViews > viewI) {
    mContainer.removeViewAt(numViews - 1);
    numViews--;
  }
  for (int i=0; i < numViews; i++) {
    final View child=mContainer.getChildAt(i);
    child.findViewById(com.android.internal.R.id.title).setEnabled(i < numViews - 1);
    if (mMaxVisible > 0) {
      child.setVisibility(i < numViews - mMaxVisible ? View.GONE : View.VISIBLE);
      final View leftIcon=child.findViewById(com.android.internal.R.id.left_icon);
      leftIcon.setVisibility(i > numViews - mMaxVisible && i != 0 ? View.VISIBLE : View.GONE);
    }
  }
}
