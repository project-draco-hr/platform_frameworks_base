{
  if (event == null) {
    Slog.w(TAG,"Invalid recognition event!");
    return;
  }
  if (DBG)   Slog.d(TAG,"onRecognition: " + event);
switch (event.status) {
case SoundTrigger.RECOGNITION_STATUS_ABORT:
case SoundTrigger.RECOGNITION_STATUS_FAILURE:
    try {
synchronized (this) {
        for (int i=0; i < mActiveListeners.size(); i++) {
          mActiveListeners.valueAt(i).onDetectionStopped();
        }
      }
    }
 catch (    RemoteException e) {
      Slog.w(TAG,"RemoteException in onDetectionStopped");
    }
  break;
case SoundTrigger.RECOGNITION_STATUS_SUCCESS:
if (!(event instanceof KeyphraseRecognitionEvent)) {
  Slog.w(TAG,"Invalid recognition event!");
  return;
}
KeyphraseRecognitionExtra[] keyphraseExtras=((KeyphraseRecognitionEvent)event).keyphraseExtras;
if (keyphraseExtras == null || keyphraseExtras.length == 0) {
Slog.w(TAG,"Invalid keyphrase recognition event!");
return;
}
int keyphraseId=keyphraseExtras[0].id;
try {
synchronized (this) {
IRecognitionStatusCallback listener=mActiveListeners.get(keyphraseId);
if (listener != null) {
listener.onDetected((KeyphraseRecognitionEvent)event);
}
 else {
Slog.w(TAG,"received onRecognition event without any listener for it");
return;
}
}
}
 catch (RemoteException e) {
Slog.w(TAG,"RemoteException in onDetectionStopped");
}
break;
}
}
