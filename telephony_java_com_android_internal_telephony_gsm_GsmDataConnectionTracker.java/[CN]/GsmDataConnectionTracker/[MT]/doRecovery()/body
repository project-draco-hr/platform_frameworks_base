{
  if (getOverallState() == State.CONNECTED) {
    int maxPdpReset=Settings.Secure.getInt(mResolver,Settings.Secure.PDP_WATCHDOG_MAX_PDP_RESET_FAIL_COUNT,DEFAULT_MAX_PDP_RESET_FAIL);
    if (mPdpResetCount < maxPdpReset) {
      mPdpResetCount++;
      EventLog.writeEvent(EventLogTags.PDP_RADIO_RESET,mSentSinceLastRecv);
      if (DBG)       log("doRecovery() cleanup all connections mPdpResetCount < max");
      cleanUpAllConnections(true,Phone.REASON_PDP_RESET);
    }
 else {
      mPdpResetCount=0;
      EventLog.writeEvent(EventLogTags.PDP_REREGISTER_NETWORK,mSentSinceLastRecv);
      if (DBG)       log("doRecovery() re-register getting preferred network type");
      mPhone.getServiceStateTracker().reRegisterNetwork(null);
    }
  }
 else {
    if (DBG)     log("doRecovery(): ignore, we're not connected");
  }
}
