{
  if (mAllApns.isEmpty()) {
    log("getPreferredApn: X not found mAllApns.isEmpty");
    return null;
  }
  Cursor cursor=mPhone.getContext().getContentResolver().query(PREFERAPN_NO_UPDATE_URI,new String[]{"_id","name","apn"},null,null,Telephony.Carriers.DEFAULT_SORT_ORDER);
  if (cursor != null) {
    canSetPreferApn=true;
  }
 else {
    canSetPreferApn=false;
  }
  if (canSetPreferApn && cursor.getCount() > 0) {
    int pos;
    cursor.moveToFirst();
    pos=cursor.getInt(cursor.getColumnIndexOrThrow(Telephony.Carriers._ID));
    for (    ApnSetting p : mAllApns) {
      if (p.id == pos && p.canHandleType(mRequestedApnType)) {
        log("getPreferredApn: X found apnSetting" + p);
        cursor.close();
        return p;
      }
    }
  }
  if (cursor != null) {
    cursor.close();
  }
  log("getPreferredApn: X not found");
  return null;
}
