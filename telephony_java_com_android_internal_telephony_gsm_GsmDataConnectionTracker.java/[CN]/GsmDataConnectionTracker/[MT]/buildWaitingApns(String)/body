{
  ArrayList<ApnSetting> apnList=new ArrayList<ApnSetting>();
  if (requestedApnType.equals(Phone.APN_TYPE_DUN)) {
    ApnSetting dun=fetchDunApn();
    if (dun != null) {
      apnList.add(dun);
      if (DBG)       log("buildWaitingApns: X added APN_TYPE_DUN apnList=" + apnList);
      return apnList;
    }
  }
  String operator=mPhone.mIccRecords.getOperatorNumeric();
  int radioTech=mPhone.getServiceState().getRadioTechnology();
  boolean needToCheckApnBearer=needToCheckApnBearer(radioTech);
  if (requestedApnType.equals(Phone.APN_TYPE_DEFAULT)) {
    if (canSetPreferApn && mPreferredApn != null) {
      if (DBG) {
        log("buildWaitingApns: Preferred APN:" + operator + ":"+ mPreferredApn.numeric+ ":"+ mPreferredApn);
      }
      if (mPreferredApn.numeric.equals(operator)) {
        if (!needToCheckApnBearer || mPreferredApn.bearer == radioTech) {
          apnList.add(mPreferredApn);
          if (DBG)           log("buildWaitingApns: X added preferred apnList=" + apnList);
          return apnList;
        }
 else {
          if (DBG)           log("buildWaitingApns: no preferred APN");
          setPreferredApn(-1);
          mPreferredApn=null;
        }
      }
 else {
        if (DBG)         log("buildWaitingApns: no preferred APN");
        setPreferredApn(-1);
        mPreferredApn=null;
      }
    }
  }
  if (mAllApns != null) {
    for (    ApnSetting apn : mAllApns) {
      if (apn.canHandleType(requestedApnType)) {
        if (!needToCheckApnBearer || apn.bearer == radioTech) {
          if (DBG)           log("apn info : " + apn.toString());
          apnList.add(apn);
        }
      }
    }
  }
 else {
    loge("mAllApns is empty!");
  }
  if (DBG)   log("buildWaitingApns: X apnList=" + apnList);
  return apnList;
}
