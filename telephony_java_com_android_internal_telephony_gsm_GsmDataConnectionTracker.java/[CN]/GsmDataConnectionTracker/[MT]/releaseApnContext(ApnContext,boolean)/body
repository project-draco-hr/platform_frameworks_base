{
  if (apnContext == null) {
    if (DBG)     loge("releaseApnContext: apnContext null should not happen, ignore");
    return -1;
  }
  DataConnection dc=apnContext.getDataConnection();
  if (dc == null) {
    if (DBG)     loge("releaseApnContext: apnContext dc == null should not happen, ignore");
    return -1;
  }
  int refCount=dc.decAndGetRefCount();
  if (DBG)   log("releaseApnContext: dec refCount=" + refCount + " tearDown="+ tearDown);
  if (tearDown && (refCount == 0)) {
    if (DBG)     log("releaseApnContext: tearing down");
    Message msg=obtainMessage(EVENT_DISCONNECT_DONE,apnContext);
    apnContext.getDataConnection().tearDown(apnContext.getReason(),msg);
  }
  apnContext.setDataConnection(null);
  apnContext.setDataConnectionAc(null);
  return refCount;
}
