{
  boolean isConnected;
  ApnContext defaultApnContext=mApnContexts.get(Phone.APN_TYPE_DEFAULT);
  isConnected=(defaultApnContext.getState() != State.IDLE && defaultApnContext.getState() != State.FAILED);
  if (mPhone instanceof GSMPhone) {
    ((GSMPhone)mPhone).updateCurrentCarrierInProvider();
  }
  if (DBG)   log("onApnChanged createAllApnList and cleanUpAllConnections");
  createAllApnList();
  cleanUpAllConnections(isConnected,Phone.REASON_APN_CHANGED);
  if (!isConnected) {
    setupDataOnReadyApns(Phone.REASON_APN_CHANGED);
  }
}
