{
  State overallState=getOverallState();
  boolean isDisconnected=(overallState == State.IDLE || overallState == State.FAILED);
  if (mPhone instanceof GSMPhone) {
    ((GSMPhone)mPhone).updateCurrentCarrierInProvider();
  }
  if (DBG)   log("onApnChanged: createAllApnList and cleanUpAllConnections");
  createAllApnList();
  cleanUpAllConnections(!isDisconnected,Phone.REASON_APN_CHANGED);
  if (isDisconnected) {
    setupDataOnReadyApns(Phone.REASON_APN_CHANGED);
  }
}
