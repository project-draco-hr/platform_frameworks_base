{
  String apnType=apnContext.getApnType();
  ApnSetting dunSetting=null;
  if (Phone.APN_TYPE_DUN.equals(apnType)) {
    dunSetting=fetchDunApn();
  }
  for (  ApnContext c : mApnContexts.values()) {
    DataConnection conn=c.getDataConnection();
    if (conn != null) {
      ApnSetting apnSetting=c.getApnSetting();
      if (dunSetting != null) {
        if (dunSetting.equals(apnSetting)) {
          if (DBG) {
            log("checkForConnectionForApnContext: apnContext=" + apnContext + " found conn="+ conn);
          }
          return conn;
        }
      }
 else       if (apnSetting != null && apnSetting.canHandleType(apnType)) {
        if (DBG) {
          log("checkForConnectionForApnContext: apnContext=" + apnContext + " found conn="+ conn);
        }
        return conn;
      }
    }
  }
  if (DBG)   log("checkForConnectionForApnContext: apnContext=" + apnContext + " NO conn");
  return null;
}
