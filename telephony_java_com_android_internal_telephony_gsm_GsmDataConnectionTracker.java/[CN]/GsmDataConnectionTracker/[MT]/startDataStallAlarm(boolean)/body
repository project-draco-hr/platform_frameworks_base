{
  int nextAction=getRecoveryAction();
  int delayInMs;
  if (mIsScreenOn || suspectedStall || RecoveryAction.isAggressiveRecovery(nextAction)) {
    delayInMs=Settings.Secure.getInt(mResolver,Settings.Secure.DATA_STALL_ALARM_AGGRESSIVE_DELAY_IN_MS,DATA_STALL_ALARM_AGGRESSIVE_DELAY_IN_MS_DEFAULT);
  }
 else {
    delayInMs=Settings.Secure.getInt(mResolver,Settings.Secure.DATA_STALL_ALARM_NON_AGGRESSIVE_DELAY_IN_MS,DATA_STALL_ALARM_NON_AGGRESSIVE_DELAY_IN_MS_DEFAULT);
  }
  mDataStallAlarmTag+=1;
  if (VDBG) {
    log("startDataStallAlarm: tag=" + mDataStallAlarmTag + " delay="+ (delayInMs / 1000)+ "s");
  }
  AlarmManager am=(AlarmManager)mPhone.getContext().getSystemService(Context.ALARM_SERVICE);
  Intent intent=new Intent(INTENT_DATA_STALL_ALARM);
  intent.putExtra(DATA_STALL_ALARM_TAG_EXTRA,mDataStallAlarmTag);
  mDataStallAlarmIntent=PendingIntent.getBroadcast(mPhone.getContext(),0,intent,PendingIntent.FLAG_UPDATE_CURRENT);
  am.set(AlarmManager.ELAPSED_REALTIME_WAKEUP,SystemClock.elapsedRealtime() + delayInMs,mDataStallAlarmIntent);
}
