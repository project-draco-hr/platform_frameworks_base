{
  final VolumeRow activeRow=getActiveRow();
  updateFooterH();
  updateExpandButtonH();
  final boolean footerVisible=mFooter.getVisibility() == View.VISIBLE;
  if (!mShowing) {
    trimObsoleteH();
  }
  VolumeRow lastVisible=null;
  for (  VolumeRow row : mRows) {
    final boolean isActive=row == activeRow;
    if (isVisibleH(row,isActive)) {
      lastVisible=row;
    }
  }
  for (  VolumeRow row : mRows) {
    final boolean isActive=row == activeRow;
    final boolean visible=isVisibleH(row,isActive);
    Util.setVisOrGone(row.view,visible);
    Util.setVisOrGone(row.space,visible && mExpanded);
    final int expandButtonRes=mExpanded ? R.drawable.ic_volume_settings : 0;
    if (expandButtonRes != row.cachedExpandButtonRes) {
      row.cachedExpandButtonRes=expandButtonRes;
      if (expandButtonRes == 0) {
        row.settingsButton.setImageDrawable(null);
      }
 else {
        row.settingsButton.setImageResource(expandButtonRes);
      }
    }
    Util.setVisOrInvis(row.settingsButton,mExpanded && (!footerVisible && row == lastVisible));
    row.header.setAlpha(mExpanded && isActive ? 1 : 0.5f);
  }
}
