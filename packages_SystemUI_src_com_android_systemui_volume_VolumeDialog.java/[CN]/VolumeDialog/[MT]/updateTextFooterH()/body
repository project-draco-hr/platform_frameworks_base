{
  final boolean zen=mState.zenMode != Global.ZEN_MODE_OFF;
  final boolean wasVisible=mFooter.getVisibility() == View.VISIBLE;
  Util.setVisOrGone(mTextFooter,mExpanded && mShowFooter && (zen || mShowing && wasVisible));
  if (mTextFooter.getVisibility() == View.VISIBLE) {
    String text=null;
    String action=null;
    if (mState.exitCondition != null) {
      final long countdown=ZenModeConfig.tryParseCountdownConditionId(mState.exitCondition.id);
      if (countdown != 0) {
        text=mContext.getString(R.string.volume_dnd_ends_at,Util.getShortTime(countdown));
        action=mContext.getString(R.string.volume_end_now);
      }
    }
    if (text == null) {
      text=mContext.getString(R.string.volume_dnd_is_on);
    }
    if (action == null) {
      action=mContext.getString(R.string.volume_turn_off);
    }
    Util.setText(mFootlineText,text);
    Util.setText(mFootlineAction,action);
    mFootlineAction.setOnClickListener(mTurnOffDnd);
  }
  Util.setVisOrGone(mFootlineText,zen);
  Util.setVisOrGone(mFootlineAction,zen);
}
