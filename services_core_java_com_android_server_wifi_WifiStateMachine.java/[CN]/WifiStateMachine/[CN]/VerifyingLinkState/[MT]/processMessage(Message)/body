{
switch (message.what) {
case WifiWatchdogStateMachine.POOR_LINK_DETECTED:
    log(getName() + " POOR_LINK_DETECTED: no transition");
  break;
case WifiWatchdogStateMachine.GOOD_LINK_DETECTED:
log(getName() + " GOOD_LINK_DETECTED: transition to captive portal check");
setNetworkDetailedState(DetailedState.CAPTIVE_PORTAL_CHECK);
mWifiConfigStore.updateStatus(mLastNetworkId,DetailedState.CAPTIVE_PORTAL_CHECK);
sendNetworkStateChangeBroadcast(mLastBssid);
try {
mNwService.enableIpv6(mInterfaceName);
}
 catch (RemoteException re) {
loge("Failed to enable IPv6: " + re);
}
catch (IllegalStateException e) {
loge("Failed to enable IPv6: " + e);
}
log(getName() + " GOOD_LINK_DETECTED: transition to CONNECTED");
setNetworkDetailedState(DetailedState.CONNECTED);
mWifiConfigStore.updateStatus(mLastNetworkId,DetailedState.CONNECTED);
sendNetworkStateChangeBroadcast(mLastBssid);
transitionTo(mConnectedState);
break;
default :
if (DBG) log(getName() + " what=" + message.what+ " NOT_HANDLED");
return NOT_HANDLED;
}
return HANDLED;
}
