{
  if (DBG)   log("Stopping DHCP and clearing IP");
  stopDhcp();
  try {
    mNwService.clearInterfaceAddresses(mInterfaceName);
    mNwService.disableIpv6(mInterfaceName);
  }
 catch (  Exception e) {
    loge("Failed to clear addresses or disable ipv6" + e);
  }
  mWifiInfo.setInetAddress(null);
  mWifiInfo.setBSSID(null);
  mWifiInfo.setSSID(null);
  mWifiInfo.setNetworkId(WifiConfiguration.INVALID_NETWORK_ID);
  mWifiInfo.setRssi(MIN_RSSI);
  mWifiInfo.setLinkSpeed(-1);
  mWifiInfo.setMeteredHint(false);
  setNetworkDetailedState(DetailedState.DISCONNECTED);
  mWifiConfigStore.updateStatus(mLastNetworkId,DetailedState.DISCONNECTED);
  clearLinkProperties();
  sendNetworkStateChangeBroadcast(mLastBssid);
  mLastBssid=null;
  mLastNetworkId=WifiConfiguration.INVALID_NETWORK_ID;
}
