{
  LinkProperties newLp=new LinkProperties();
  newLp.setInterfaceName(mInterfaceName);
  newLp.setHttpProxy(mWifiConfigStore.getProxyProperties(mLastNetworkId));
  newLp.setLinkAddresses(mNetlinkLinkProperties.getLinkAddresses());
synchronized (mDhcpResultsLock) {
    if ((mDhcpResults != null) && (mDhcpResults.linkProperties != null)) {
      LinkProperties lp=mDhcpResults.linkProperties;
      for (      RouteInfo route : lp.getRoutes()) {
        newLp.addRoute(route);
      }
      for (      InetAddress dns : lp.getDnses()) {
        newLp.addDns(dns);
      }
      newLp.setDomains(lp.getDomains());
    }
  }
  if (!newLp.equals(mLinkProperties)) {
    if (DBG) {
      log("Link configuration changed for netId: " + mLastNetworkId + " old: "+ mLinkProperties+ "new: "+ newLp);
    }
    mLinkProperties=newLp;
    if (getNetworkDetailedState() == DetailedState.CONNECTED) {
      sendLinkConfigurationChangedBroadcast();
    }
  }
}
