{
  mContext=context;
  mLocalAdapter=adapter;
  mDeviceManager=deviceManager;
  mEventManager=eventManager;
  mUsePbapPce=mContext.getResources().getBoolean(R.bool.enable_pbap_pce_profile);
  mUseMapClient=mContext.getResources().getBoolean(R.bool.enable_pbap_pce_profile);
  mLocalAdapter.setProfileManager(this);
  mEventManager.setProfileManager(this);
  ParcelUuid[] uuids=adapter.getUuids();
  if (uuids != null) {
    updateLocalProfiles(uuids);
  }
  mHidProfile=new HidProfile(context,mLocalAdapter,mDeviceManager,this);
  addProfile(mHidProfile,HidProfile.NAME,BluetoothInputDevice.ACTION_CONNECTION_STATE_CHANGED);
  mPanProfile=new PanProfile(context);
  addPanProfile(mPanProfile,PanProfile.NAME,BluetoothPan.ACTION_CONNECTION_STATE_CHANGED);
  if (DEBUG)   Log.d(TAG,"Adding local MAP profile");
  if (mUseMapClient) {
    mMapClientProfile=new MapClientProfile(mContext,mLocalAdapter,mDeviceManager,this);
    addProfile(mMapClientProfile,MapClientProfile.NAME,BluetoothMapClient.ACTION_CONNECTION_STATE_CHANGED);
  }
 else {
    mMapProfile=new MapProfile(mContext,mLocalAdapter,mDeviceManager,this);
    addProfile(mMapProfile,MapProfile.NAME,BluetoothMap.ACTION_CONNECTION_STATE_CHANGED);
  }
  mPbapProfile=new PbapServerProfile(context);
  if (DEBUG)   Log.d(TAG,"LocalBluetoothProfileManager construction complete");
}
