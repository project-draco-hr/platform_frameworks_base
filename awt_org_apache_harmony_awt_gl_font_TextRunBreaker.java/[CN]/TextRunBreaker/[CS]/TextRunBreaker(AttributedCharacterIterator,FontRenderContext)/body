{
  this.aci=aci;
  this.frc=frc;
  segmentsStart=aci.getBeginIndex();
  segmentsEnd=aci.getEndIndex();
  int len=segmentsEnd - segmentsStart;
  text=new char[len];
  aci.setIndex(segmentsEnd);
  while (len-- != 0) {
    text[len]=aci.previous();
  }
  createStyleRuns();
}
