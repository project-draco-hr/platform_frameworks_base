{
  aci=newParagraph;
  char insChar=aci.setIndex(insertPos);
  Integer key=new Integer(insertPos);
  insertPos-=aci.getBeginIndex();
  char newText[]=new char[text.length + 1];
  System.arraycopy(text,0,newText,0,insertPos);
  newText[insertPos]=insChar;
  System.arraycopy(text,insertPos,newText,insertPos + 1,text.length - insertPos);
  text=newText;
  if (aci.getRunStart() == key.intValue() && aci.getRunLimit() == key.intValue() + 1) {
    createStyleRuns();
  }
 else {
    shiftStyleRuns(key,1);
  }
  resetSegments();
  segmentsEnd++;
}
