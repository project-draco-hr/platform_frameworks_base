{
  Policy p=new Policy(this);
  if (p.mDefaultStanza) {
    if (p.mSeinfo == null) {
      String err="Missing global seinfo tag with default stanza.";
      throw new IllegalStateException(err);
    }
    if (p.mCerts.size() != 0) {
      String err="Certs not allowed with default stanza.";
      throw new IllegalStateException(err);
    }
    if (!p.mPkgMap.isEmpty()) {
      String err="Inner package mappings not allowed with default stanza.";
      throw new IllegalStateException(err);
    }
  }
 else {
    if (p.mCerts.size() == 0) {
      String err="Missing certs with signer tag. Expecting at least one.";
      throw new IllegalStateException(err);
    }
    if ((p.mSeinfo == null) && (p.mPkgMap.isEmpty())) {
      String err="Missing seinfo OR package tags with signer tag. At " + "least one must be present.";
      throw new IllegalStateException(err);
    }
  }
  return p;
}
