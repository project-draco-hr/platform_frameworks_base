{
  if (p1.isDefaultStanza() != p2.isDefaultStanza()) {
    return p1.isDefaultStanza() ? 1 : -1;
  }
  if (p1.hasInnerPackages() != p2.hasInnerPackages()) {
    return p1.hasInnerPackages() ? -1 : 1;
  }
  if (p1.getSignatures().equals(p2.getSignatures())) {
    if (p1.hasGlobalSeinfo()) {
      duplicateFound=true;
      Slog.e(SELinuxMMAC.TAG,"Duplicate policy entry: " + p1.toString());
    }
    final Map<String,String> p1Packages=p1.getInnerPackages();
    final Map<String,String> p2Packages=p2.getInnerPackages();
    if (!Collections.disjoint(p1Packages.keySet(),p2Packages.keySet())) {
      duplicateFound=true;
      Slog.e(SELinuxMMAC.TAG,"Duplicate policy entry: " + p1.toString());
    }
  }
  return 0;
}
