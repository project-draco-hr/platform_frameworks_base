{
  if (mMulticastFilter) {
    gen.addLoad8(Register.R0,IPV4_DEST_ADDR_OFFSET);
    gen.addAnd(0xf0);
    gen.addJumpIfR0Equals(0xe0,gen.DROP_LABEL);
    gen.addLoadImmediate(Register.R0,ETH_DEST_ADDR_OFFSET);
    gen.addJumpIfBytesNotEqual(Register.R0,ETH_BROADCAST_MAC_ADDRESS,gen.PASS_LABEL);
    gen.addLoad8(Register.R0,IPV4_PROTOCOL_OFFSET);
    gen.addJumpIfR0NotEquals(IPPROTO_UDP,gen.DROP_LABEL);
    gen.addLoad16(Register.R0,IPV4_FRAGMENT_OFFSET_OFFSET);
    gen.addJumpIfR0AnyBitsSet(IPV4_FRAGMENT_OFFSET_MASK,gen.DROP_LABEL);
    gen.addLoadFromMemory(Register.R1,gen.IPV4_HEADER_SIZE_MEMORY_SLOT);
    gen.addLoad16Indexed(Register.R0,UDP_DESTINATION_PORT_OFFSET);
    gen.addJumpIfR0NotEquals(DHCP_CLIENT_PORT,gen.DROP_LABEL);
    gen.addLoadImmediate(Register.R0,DHCP_CLIENT_MAC_OFFSET);
    gen.addAddR1();
    gen.addJumpIfBytesNotEqual(Register.R0,mHardwareAddress,gen.DROP_LABEL);
  }
  gen.addJump(gen.PASS_LABEL);
}
