{
  ApfGenerator gen=new ApfGenerator();
  gen.setApfVersion(mApfCapabilities.apfVersionSupported);
  String skipArpFiltersLabel="skipArpFilters";
  gen.addLoad16(Register.R0,ETH_ETHERTYPE_OFFSET);
  gen.addJumpIfR0NotEquals(ETH_P_ARP,skipArpFiltersLabel);
  generateArpFilterLocked(gen);
  gen.defineLabel(skipArpFiltersLabel);
  String skipIPv4FiltersLabel="skipIPv4Filters";
  gen.addJumpIfR0NotEquals(ETH_P_IP,skipIPv4FiltersLabel);
  generateIPv4FilterLocked(gen);
  gen.defineLabel(skipIPv4FiltersLabel);
  String ipv6FilterLabel="IPv6Filters";
  gen.addJumpIfR0Equals(ETH_P_IPV6,ipv6FilterLabel);
  gen.addLoadImmediate(Register.R0,ETH_DEST_ADDR_OFFSET);
  gen.addJumpIfBytesNotEqual(Register.R0,ETH_BROADCAST_MAC_ADDRESS,gen.PASS_LABEL);
  gen.addJump(gen.DROP_LABEL);
  gen.defineLabel(ipv6FilterLabel);
  generateIPv6FilterLocked(gen);
  return gen;
}
