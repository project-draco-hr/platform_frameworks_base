{
  ApfGenerator gen=new ApfGenerator();
  gen.setApfVersion(mApfCapabilities.apfVersionSupported);
  gen.addLoad16(Register.R0,ETH_ETHERTYPE_OFFSET);
  if (mIPv4Address != null) {
    String skipArpFiltersLabel="skipArpFilters";
    gen.addJumpIfR0NotEquals(ETH_P_ARP,skipArpFiltersLabel);
    generateArpFilterLocked(gen);
    gen.defineLabel(skipArpFiltersLabel);
  }
  String skipIPv4FiltersLabel="skipIPv4Filters";
  gen.addJumpIfR0NotEquals(ETH_P_IP,skipIPv4FiltersLabel);
  generateIPv4FilterLocked(gen);
  gen.defineLabel(skipIPv4FiltersLabel);
  gen.addJumpIfR0NotEquals(ETH_P_IPV6,gen.PASS_LABEL);
  generateIPv6FilterLocked(gen);
  return gen;
}
