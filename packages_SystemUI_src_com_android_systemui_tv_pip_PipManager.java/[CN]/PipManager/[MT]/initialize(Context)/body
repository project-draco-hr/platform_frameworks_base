{
  if (mInitialized) {
    return;
  }
  mInitialized=true;
  mContext=context;
  Resources res=context.getResources();
  mPipBounds=Rect.unflattenFromString(res.getString(com.android.internal.R.string.config_defaultPictureInPictureBounds));
  mMenuModePipBounds=Rect.unflattenFromString(res.getString(R.string.pip_menu_bounds));
  mRecentsPipBounds=Rect.unflattenFromString(res.getString(R.string.pip_recents_bounds));
  mRecentsFocusedPipBounds=Rect.unflattenFromString(res.getString(R.string.pip_recents_focused_bounds));
  mRecentsFocusChangedAnimationDurationMs=res.getInteger(R.integer.recents_tv_pip_focus_anim_duration);
  mActivityManager=ActivityManagerNative.getDefault();
  SystemServicesProxy.getInstance(context).registerTaskStackListener(mTaskStackListener);
  IntentFilter intentFilter=new IntentFilter();
  intentFilter.addAction(Intent.ACTION_MEDIA_RESOURCE_GRANTED);
  mContext.registerReceiver(mBroadcastReceiver,intentFilter);
  mOnboardingShown=Prefs.getBoolean(mContext,TV_PICTURE_IN_PICTURE_ONBOARDING_SHOWN,false);
  mPipRecentsOverlayManager=new PipRecentsOverlayManager(context);
  mMediaSessionManager=(MediaSessionManager)mContext.getSystemService(Context.MEDIA_SESSION_SERVICE);
}
