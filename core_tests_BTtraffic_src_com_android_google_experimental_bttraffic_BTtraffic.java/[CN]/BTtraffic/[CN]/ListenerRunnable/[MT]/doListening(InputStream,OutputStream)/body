{
  ByteBuffer byteBuffer=ByteBuffer.allocate(maxbuffersize);
  while (!Thread.interrupted()) {
    readBytesIntoBuffer(inputStream,byteBuffer,4);
    byteBuffer.flip();
    int length=byteBuffer.getInt();
    if (Thread.interrupted())     break;
    readBytesIntoBuffer(inputStream,byteBuffer,length);
    if (sendAck)     outputStream.write(0x55);
  }
}
