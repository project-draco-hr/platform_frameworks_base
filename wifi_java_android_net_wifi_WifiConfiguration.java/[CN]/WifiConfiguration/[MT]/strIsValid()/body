{
  if (allowedKeyManagement == null)   return "allowed kmgmt";
  if (allowedKeyManagement.cardinality() > 1) {
    if (allowedKeyManagement.cardinality() != 2) {
      return "cardinality != 2";
    }
    if (!allowedKeyManagement.get(KeyMgmt.WPA_EAP)) {
      return "not WPA_EAP";
    }
    if ((!allowedKeyManagement.get(KeyMgmt.IEEE8021X)) && (!allowedKeyManagement.get(KeyMgmt.WPA_PSK))) {
      return "not PSK or 8021X";
    }
  }
  if (!TextUtils.isEmpty(FQDN)) {
    if (!TextUtils.isEmpty(SSID)) {
      return "no SSID";
    }
    if (TextUtils.isEmpty(providerFriendlyName)) {
      return "no provider friendly name";
    }
    if (enterpriseConfig == null || enterpriseConfig.getEapMethod() == WifiEnterpriseConfig.Eap.NONE) {
      return "no enterprise config";
    }
  }
  return null;
}
