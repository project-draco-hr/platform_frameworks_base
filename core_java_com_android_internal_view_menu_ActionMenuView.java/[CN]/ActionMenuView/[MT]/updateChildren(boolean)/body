{
  final boolean reserveOverflow=mReserveOverflow;
  removeAllViews();
  final ArrayList<MenuItemImpl> itemsToShow=mMenu.getActionItems(reserveOverflow);
  final int itemCount=itemsToShow.size();
  boolean needsDivider=false;
  for (int i=0; i < itemCount; i++) {
    final MenuItemImpl itemData=itemsToShow.get(i);
    boolean hasDivider=false;
    if (needsDivider) {
      addView(makeDividerView(),makeDividerLayoutParams());
      hasDivider=true;
    }
    View actionView=itemData.getActionView();
    if (actionView != null) {
      final ViewParent parent=actionView.getParent();
      if (parent instanceof ViewGroup) {
        ((ViewGroup)parent).removeView(actionView);
      }
      addView(actionView,makeActionViewLayoutParams(actionView));
    }
 else {
      ActionMenuItemView view=(ActionMenuItemView)itemData.getItemView(MenuBuilder.TYPE_ACTION_BUTTON,this);
      view.setItemInvoker(this);
      if (i > 0 && !hasDivider && view.hasText() && itemData.getIcon() == null) {
        addView(makeDividerView(),makeDividerLayoutParams());
      }
      addView(view);
      needsDivider=view.hasText();
    }
  }
  if (reserveOverflow) {
    if (mMenu.getNonActionItems(true).size() > 0) {
      if (itemCount > 0) {
        addView(makeDividerView(),makeDividerLayoutParams());
      }
      OverflowMenuButton button=new OverflowMenuButton(mContext);
      addView(button);
      mOverflowButton=button;
    }
 else {
      mOverflowButton=null;
    }
  }
}
