{
  int i=0;
  try {
    i=uri.lastIndexOf("#");
    if (i == -1)     return new Intent(ACTION_VIEW,Uri.parse(uri));
    if (!uri.startsWith("#Intent;",i))     return getIntentOld(uri);
    Intent intent=new Intent(ACTION_VIEW);
    if (i > 0) {
      intent.mData=Uri.parse(uri.substring(0,i));
    }
    i+="#Intent;".length();
    while (!uri.startsWith("end",i)) {
      int eq=uri.indexOf('=',i);
      int semi=uri.indexOf(';',eq);
      String value=uri.substring(eq + 1,semi);
      if (uri.startsWith("action=",i)) {
        intent.mAction=value;
      }
 else       if (uri.startsWith("category=",i)) {
        intent.addCategory(value);
      }
 else       if (uri.startsWith("type=",i)) {
        intent.mType=value;
      }
 else       if (uri.startsWith("launchFlags=",i)) {
        intent.mFlags=Integer.decode(value).intValue();
      }
 else       if (uri.startsWith("component=",i)) {
        intent.mComponent=ComponentName.unflattenFromString(value);
      }
 else {
        String key=Uri.decode(uri.substring(i + 2,eq));
        value=Uri.decode(value);
        if (intent.mExtras == null)         intent.mExtras=new Bundle();
        Bundle b=intent.mExtras;
        if (uri.startsWith("S.",i))         b.putString(key,value);
 else         if (uri.startsWith("B.",i))         b.putBoolean(key,Boolean.parseBoolean(value));
 else         if (uri.startsWith("b.",i))         b.putByte(key,Byte.parseByte(value));
 else         if (uri.startsWith("c.",i))         b.putChar(key,value.charAt(0));
 else         if (uri.startsWith("d.",i))         b.putDouble(key,Double.parseDouble(value));
 else         if (uri.startsWith("f.",i))         b.putFloat(key,Float.parseFloat(value));
 else         if (uri.startsWith("i.",i))         b.putInt(key,Integer.parseInt(value));
 else         if (uri.startsWith("l.",i))         b.putLong(key,Long.parseLong(value));
 else         if (uri.startsWith("s.",i))         b.putShort(key,Short.parseShort(value));
 else         throw new URISyntaxException(uri,"unknown EXTRA type",i);
      }
      i=semi + 1;
    }
    return intent;
  }
 catch (  IndexOutOfBoundsException e) {
    throw new URISyntaxException(uri,"illegal Intent URI format",i);
  }
}
