{
  mContext=context;
  mDisplay=display;
  mExitAnimId=exitAnim;
  mEnterAnimId=enterAnim;
  if (originalRotation == Surface.ROTATION_90 || originalRotation == Surface.ROTATION_270) {
    mWidth=originalHeight;
    mHeight=originalWidth;
  }
 else {
    mWidth=originalWidth;
    mHeight=originalHeight;
  }
  mOriginalRotation=originalRotation;
  mOriginalWidth=originalWidth;
  mOriginalHeight=originalHeight;
  if (!inTransaction) {
    if (WindowManagerService.SHOW_LIGHT_TRANSACTIONS)     Slog.i(WindowManagerService.TAG,">>> OPEN TRANSACTION ScreenRotationAnimation");
    Surface.openTransaction();
  }
  try {
    try {
      if (WindowManagerService.DEBUG_SURFACE_TRACE) {
        mSurface=new SurfaceTrace(session,"FreezeSurface",mWidth,mHeight,PixelFormat.OPAQUE,Surface.FX_SURFACE_SCREENSHOT | Surface.HIDDEN);
      }
 else {
        mSurface=new Surface(session,"FreezeSurface",mWidth,mHeight,PixelFormat.OPAQUE,Surface.FX_SURFACE_SCREENSHOT | Surface.HIDDEN);
      }
      if (!mSurface.isValid()) {
        mSurface=null;
        return;
      }
      mSurface.setLayerStack(mDisplay.getLayerStack());
      mSurface.setLayer(FREEZE_LAYER + 1);
      mSurface.setAlpha(0);
      mSurface.show();
    }
 catch (    Surface.OutOfResourcesException e) {
      Slog.w(TAG,"Unable to allocate freeze surface",e);
    }
    if (WindowManagerService.SHOW_TRANSACTIONS || WindowManagerService.SHOW_SURFACE_ALLOC)     Slog.i(WindowManagerService.TAG,"  FREEZE " + mSurface + ": CREATE");
    setRotationInTransaction(originalRotation);
  }
  finally {
    if (!inTransaction) {
      Surface.closeTransaction();
      if (WindowManagerService.SHOW_LIGHT_TRANSACTIONS)       Slog.i(WindowManagerService.TAG,"<<< CLOSE TRANSACTION ScreenRotationAnimation");
    }
  }
}
