{
  if (mSurface == null) {
    return false;
  }
  int delta=deltaRotation(mCurRotation,mOriginalRotation);
switch (delta) {
case Surface.ROTATION_0:
    mExitAnimation=AnimationUtils.loadAnimation(mContext,com.android.internal.R.anim.screen_rotate_0_exit);
  mEnterAnimation=AnimationUtils.loadAnimation(mContext,com.android.internal.R.anim.screen_rotate_0_enter);
break;
case Surface.ROTATION_90:
mExitAnimation=AnimationUtils.loadAnimation(mContext,com.android.internal.R.anim.screen_rotate_plus_90_exit);
mEnterAnimation=AnimationUtils.loadAnimation(mContext,com.android.internal.R.anim.screen_rotate_plus_90_enter);
break;
case Surface.ROTATION_180:
mExitAnimation=AnimationUtils.loadAnimation(mContext,com.android.internal.R.anim.screen_rotate_180_exit);
mEnterAnimation=AnimationUtils.loadAnimation(mContext,com.android.internal.R.anim.screen_rotate_180_enter);
break;
case Surface.ROTATION_270:
mExitAnimation=AnimationUtils.loadAnimation(mContext,com.android.internal.R.anim.screen_rotate_minus_90_exit);
mEnterAnimation=AnimationUtils.loadAnimation(mContext,com.android.internal.R.anim.screen_rotate_minus_90_enter);
break;
}
mDisplay.getMetrics(mDisplayMetrics);
mEnterAnimation.initialize(mDisplayMetrics.widthPixels,mDisplayMetrics.heightPixels,mOriginalWidth,mOriginalHeight);
mExitAnimation.initialize(mDisplayMetrics.widthPixels,mDisplayMetrics.heightPixels,mOriginalWidth,mOriginalHeight);
mStarted=false;
mExitAnimation.restrictDuration(maxAnimationDuration);
mExitAnimation.scaleCurrentDuration(animationScale);
mEnterAnimation.restrictDuration(maxAnimationDuration);
mEnterAnimation.scaleCurrentDuration(animationScale);
if (WindowManagerService.SHOW_TRANSACTIONS) Slog.i(WindowManagerService.TAG,">>> OPEN TRANSACTION ScreenRotationAnimation.dismiss");
Surface.openTransaction();
try {
final int w=mDisplayMetrics.widthPixels;
final int h=mDisplayMetrics.heightPixels;
Rect outer=new Rect(-w,-h,w * 2,h * 2);
Rect inner=new Rect(0,0,w,h);
mBlackFrame=new BlackFrame(session,outer,inner,FREEZE_LAYER);
}
 catch (Surface.OutOfResourcesException e) {
Slog.w(TAG,"Unable to allocate black surface",e);
}
 finally {
Surface.closeTransaction();
if (WindowManagerService.SHOW_TRANSACTIONS) Slog.i(WindowManagerService.TAG,"<<< CLOSE TRANSACTION ScreenRotationAnimation.dismiss");
}
return true;
}
