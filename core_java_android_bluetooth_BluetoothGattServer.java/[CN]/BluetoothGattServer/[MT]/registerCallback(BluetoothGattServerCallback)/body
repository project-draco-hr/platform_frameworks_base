{
  if (DBG)   Log.d(TAG,"registerCallback()");
  if (mService == null) {
    Log.e(TAG,"GATT service not available");
    return false;
  }
  UUID uuid=UUID.randomUUID();
  if (DBG)   Log.d(TAG,"registerCallback() - UUID=" + uuid);
synchronized (mServerIfLock) {
    if (mCallback != null) {
      Log.e(TAG,"App can register callback only once");
      return false;
    }
    mCallback=callback;
    try {
      mService.registerServer(new ParcelUuid(uuid),mBluetoothGattServerCallback);
    }
 catch (    RemoteException e) {
      Log.e(TAG,"",e);
      mCallback=null;
      return false;
    }
    try {
      mServerIfLock.wait(CALLBACK_REG_TIMEOUT);
    }
 catch (    InterruptedException e) {
      Log.e(TAG,"" + e);
      mCallback=null;
    }
    if (mServerIf == 0) {
      mCallback=null;
      return false;
    }
 else {
      return true;
    }
  }
}
