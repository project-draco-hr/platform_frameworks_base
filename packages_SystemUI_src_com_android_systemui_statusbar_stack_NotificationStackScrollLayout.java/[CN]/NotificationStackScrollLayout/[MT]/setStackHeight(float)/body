{
  mLastSetStackHeight=height;
  setIsExpanded(height > 0.0f);
  int newStackHeight=(int)height;
  int minStackHeight=getMinStackHeight();
  int stackHeight;
  if (newStackHeight - mTopPadding - mTopPaddingOverflow >= minStackHeight || getNotGoneChildCount() == 0) {
    setTranslationY(mTopPaddingOverflow);
    stackHeight=newStackHeight;
  }
 else {
    int translationY=(newStackHeight - minStackHeight);
    float partiallyThere=(newStackHeight - mTopPadding - mTopPaddingOverflow) / minStackHeight;
    partiallyThere=Math.max(0,partiallyThere);
    translationY+=(1 - partiallyThere) * (mBottomStackPeekSize + mCollapseSecondCardPadding);
    setTranslationY(translationY - mTopPadding);
    stackHeight=(int)(height - (translationY - mTopPadding));
  }
  if (stackHeight != mCurrentStackHeight) {
    mCurrentStackHeight=stackHeight;
    updateAlgorithmHeightAndPadding();
    requestChildrenUpdate();
  }
}
