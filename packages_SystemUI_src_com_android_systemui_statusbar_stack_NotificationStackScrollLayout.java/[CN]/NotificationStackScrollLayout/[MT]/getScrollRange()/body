{
  int scrollRange=0;
  ExpandableView firstChild=(ExpandableView)getFirstChildNotGone();
  if (firstChild != null) {
    int contentHeight=getContentHeight();
    scrollRange=Math.max(0,contentHeight - mMaxLayoutHeight + mBottomStackPeekSize + mBottomStackSlowDownHeight);
    if (scrollRange > 0) {
      int firstChildMaxExpandHeight=getMaxExpandHeight(firstChild);
      scrollRange=Math.max(scrollRange,firstChildMaxExpandHeight - firstChild.getMinHeight());
    }
  }
  int imeOverlap=Math.max(0,getContentHeight() - (getHeight() - mBottomInset));
  return scrollRange + imeOverlap;
}
