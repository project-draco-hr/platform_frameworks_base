{
  int oldVisibility=mDismissView.willBeGone() ? GONE : mDismissView.getVisibility();
  int newVisibility=visible ? VISIBLE : GONE;
  if (oldVisibility != newVisibility) {
    if (newVisibility != GONE) {
      if (mDismissView.willBeGone()) {
        mDismissView.cancelAnimation();
      }
 else {
        mDismissView.setInvisible();
      }
      mDismissView.setVisibility(newVisibility);
      mDismissView.setWillBeGone(false);
      updateContentHeight();
      notifyHeightChangeListener(mDismissView);
    }
 else {
      Runnable dimissHideFinishRunnable=new Runnable(){
        @Override public void run(){
          mDismissView.setVisibility(GONE);
          mDismissView.setWillBeGone(false);
          updateContentHeight();
          notifyHeightChangeListener(mDismissView);
        }
      }
;
      if (mDismissView.isButtonVisible() && mIsExpanded && mAnimationsEnabled) {
        mDismissView.setWillBeGone(true);
        mDismissView.performVisibilityAnimation(false,dimissHideFinishRunnable);
      }
 else {
        dimissHideFinishRunnable.run();
      }
    }
  }
}
