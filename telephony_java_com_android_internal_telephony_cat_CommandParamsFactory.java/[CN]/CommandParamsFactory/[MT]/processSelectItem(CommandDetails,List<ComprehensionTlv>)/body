{
  StkLog.d(this,"process SelectItem");
  Menu menu=new Menu();
  IconId titleIconId=null;
  ItemsIconId itemsIconId=null;
  Iterator<ComprehensionTlv> iter=ctlvs.iterator();
  ComprehensionTlv ctlv=searchForTag(ComprehensionTlvTag.ALPHA_ID,ctlvs);
  if (ctlv != null) {
    menu.title=ValueParser.retrieveAlphaId(ctlv);
  }
  while (true) {
    ctlv=searchForNextTag(ComprehensionTlvTag.ITEM,iter);
    if (ctlv != null) {
      menu.items.add(ValueParser.retrieveItem(ctlv));
    }
 else {
      break;
    }
  }
  if (menu.items.size() == 0) {
    throw new ResultException(ResultCode.REQUIRED_VALUES_MISSING);
  }
  ctlv=searchForTag(ComprehensionTlvTag.ITEM_ID,ctlvs);
  if (ctlv != null) {
    menu.defaultItem=ValueParser.retrieveItemId(ctlv) - 1;
  }
  ctlv=searchForTag(ComprehensionTlvTag.ICON_ID,ctlvs);
  if (ctlv != null) {
    mIconLoadState=LOAD_SINGLE_ICON;
    titleIconId=ValueParser.retrieveIconId(ctlv);
    menu.titleIconSelfExplanatory=titleIconId.selfExplanatory;
  }
  ctlv=searchForTag(ComprehensionTlvTag.ITEM_ICON_ID_LIST,ctlvs);
  if (ctlv != null) {
    mIconLoadState=LOAD_MULTI_ICONS;
    itemsIconId=ValueParser.retrieveItemsIconId(ctlv);
    menu.itemsIconSelfExplanatory=itemsIconId.selfExplanatory;
  }
  boolean presentTypeSpecified=(cmdDet.commandQualifier & 0x01) != 0;
  if (presentTypeSpecified) {
    if ((cmdDet.commandQualifier & 0x02) == 0) {
      menu.presentationType=PresentationType.DATA_VALUES;
    }
 else {
      menu.presentationType=PresentationType.NAVIGATION_OPTIONS;
    }
  }
  menu.softKeyPreferred=(cmdDet.commandQualifier & 0x04) != 0;
  menu.helpAvailable=(cmdDet.commandQualifier & 0x80) != 0;
  mCmdParams=new SelectItemParams(cmdDet,menu,titleIconId != null);
switch (mIconLoadState) {
case LOAD_NO_ICON:
    return false;
case LOAD_SINGLE_ICON:
  mIconLoader.loadIcon(titleIconId.recordNumber,this.obtainMessage(MSG_ID_LOAD_ICON_DONE));
break;
case LOAD_MULTI_ICONS:
int[] recordNumbers=itemsIconId.recordNumbers;
if (titleIconId != null) {
recordNumbers=new int[itemsIconId.recordNumbers.length + 1];
recordNumbers[0]=titleIconId.recordNumber;
System.arraycopy(itemsIconId.recordNumbers,0,recordNumbers,1,itemsIconId.recordNumbers.length);
}
mIconLoader.loadIcons(recordNumbers,this.obtainMessage(MSG_ID_LOAD_ICON_DONE));
break;
}
return true;
}
