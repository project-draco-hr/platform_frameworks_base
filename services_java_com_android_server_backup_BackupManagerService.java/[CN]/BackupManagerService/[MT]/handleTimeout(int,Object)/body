{
  Operation op=null;
synchronized (mCurrentOpLock) {
    op=mCurrentOperations.get(token);
    if (MORE_DEBUG) {
      if (op == null)       Slog.w(TAG,"Timeout of token " + Integer.toHexString(token) + " but no op found");
    }
    int state=(op != null) ? op.state : OP_TIMEOUT;
    if (state == OP_PENDING) {
      if (DEBUG)       Slog.v(TAG,"TIMEOUT: token=" + Integer.toHexString(token));
      op.state=OP_TIMEOUT;
      mCurrentOperations.put(token,op);
    }
    mCurrentOpLock.notifyAll();
  }
  if (op != null && op.callback != null) {
    op.callback.handleTimeout();
  }
}
