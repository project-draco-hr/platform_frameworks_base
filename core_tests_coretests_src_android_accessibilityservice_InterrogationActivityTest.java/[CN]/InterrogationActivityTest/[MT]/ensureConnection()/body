{
  if (sConnectionId == View.NO_ID) {
    IEventListener listener=new IEventListener.Stub(){
      public void setConnection(      IAccessibilityServiceConnection connection,      int connectionId){
        sConnectionId=connectionId;
        if (connection != null) {
          AccessibilityInteractionClient.getInstance().addConnection(connectionId,connection);
        }
 else {
          AccessibilityInteractionClient.getInstance().removeConnection(connectionId);
        }
synchronized (this) {
          notifyAll();
        }
      }
      public void onInterrupt(){
      }
      public void onAccessibilityEvent(      AccessibilityEvent event){
        mLastAccessibilityEvent=AccessibilityEvent.obtain(event);
synchronized (this) {
          notifyAll();
        }
      }
    }
;
    AccessibilityManager accessibilityManager=AccessibilityManager.getInstance(getInstrumentation().getContext());
synchronized (this) {
      IAccessibilityManager manager=IAccessibilityManager.Stub.asInterface(ServiceManager.getService(Context.ACCESSIBILITY_SERVICE));
      manager.registerEventListener(listener);
      wait(TIMEOUT_PROPAGATE_ACCESSIBLITY_SETTING);
    }
  }
}
