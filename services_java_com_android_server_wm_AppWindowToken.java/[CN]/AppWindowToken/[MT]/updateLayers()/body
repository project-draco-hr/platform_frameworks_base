{
  final int N=allAppWindows.size();
  final int adj=animLayerAdjustment;
  thumbnailLayer=-1;
  for (int i=0; i < N; i++) {
    final WindowState w=allAppWindows.get(i);
    final WindowStateAnimator winAnimator=w.mWinAnimator;
    winAnimator.mAnimLayer=w.mLayer + adj;
    if (winAnimator.mAnimLayer > thumbnailLayer) {
      thumbnailLayer=winAnimator.mAnimLayer;
    }
    if (WindowManagerService.DEBUG_LAYERS)     Slog.v(WindowManagerService.TAG,"Updating layer " + w + ": "+ winAnimator.mAnimLayer);
    if (w == service.mInputMethodTarget && !service.mInputMethodTargetWaitingAnim) {
      service.setInputMethodAnimLayerAdjustment(adj);
    }
    if (w == service.mWallpaperTarget && service.mLowerWallpaperTarget == null) {
      service.setWallpaperAnimLayerAdjustmentLocked(adj);
    }
  }
}
