{
  if (WindowManagerService.localLOGV)   Slog.v(WindowManagerService.TAG,"Setting animation in " + this + ": "+ anim);
  animation=anim;
  animating=false;
  anim.restrictDuration(WindowManagerService.MAX_ANIMATION_DURATION);
  anim.scaleCurrentDuration(service.mTransitionAnimationScale);
  int zorder=anim.getZAdjustment();
  int adj=0;
  if (zorder == Animation.ZORDER_TOP) {
    adj=WindowManagerService.TYPE_LAYER_OFFSET;
  }
 else   if (zorder == Animation.ZORDER_BOTTOM) {
    adj=-WindowManagerService.TYPE_LAYER_OFFSET;
  }
  if (animLayerAdjustment != adj) {
    animLayerAdjustment=adj;
    updateLayers();
  }
  transformation.clear();
  transformation.setAlpha(reportedVisible ? 1 : 0);
  hasTransformation=true;
}
