{
  Log.d(TAG,"getObjectProperty: " + property);
  String column=null;
  boolean isString=false;
  if (property == MtpConstants.PROPERTY_NAME) {
    property=MtpConstants.PROPERTY_OBJECT_FILE_NAME;
  }
switch (property) {
case MtpConstants.PROPERTY_STORAGE_ID:
    outIntValue[0]=mStorageID;
  return MtpConstants.RESPONSE_OK;
case MtpConstants.PROPERTY_OBJECT_FORMAT:
column=Files.FileColumns.FORMAT;
break;
case MtpConstants.PROPERTY_PROTECTION_STATUS:
outIntValue[0]=0;
return MtpConstants.RESPONSE_OK;
case MtpConstants.PROPERTY_OBJECT_SIZE:
column=Files.FileColumns.SIZE;
break;
case MtpConstants.PROPERTY_OBJECT_FILE_NAME:
column=Files.FileColumns.DATA;
isString=true;
break;
case MtpConstants.PROPERTY_DATE_MODIFIED:
column=Files.FileColumns.DATE_MODIFIED;
break;
case MtpConstants.PROPERTY_PARENT_OBJECT:
column=Files.FileColumns.PARENT;
break;
case MtpConstants.PROPERTY_PERSISTENT_UID:
long puid=mStorageID;
puid<<=32;
puid+=handle;
outIntValue[0]=puid;
return MtpConstants.RESPONSE_OK;
default :
return MtpConstants.RESPONSE_OBJECT_PROP_NOT_SUPPORTED;
}
Cursor c=null;
try {
c=mMediaProvider.query(mObjectsUri,new String[]{Files.FileColumns._ID,column},ID_WHERE,new String[]{Integer.toString(handle)},null);
if (c != null && c.moveToNext()) {
if (isString) {
String value=c.getString(1);
int start=0;
if (property == MtpConstants.PROPERTY_OBJECT_FILE_NAME) {
int lastSlash=value.lastIndexOf('/');
if (lastSlash >= 0) {
start=lastSlash + 1;
}
}
int end=value.length();
if (end - start > 255) {
end=start + 255;
}
value.getChars(start,end,outStringValue,0);
outStringValue[end - start]=0;
}
 else {
outIntValue[0]=c.getLong(1);
}
return MtpConstants.RESPONSE_OK;
}
}
 catch (Exception e) {
return MtpConstants.RESPONSE_GENERAL_ERROR;
}
 finally {
if (c != null) {
c.close();
}
}
return MtpConstants.RESPONSE_INVALID_OBJECT_HANDLE;
}
