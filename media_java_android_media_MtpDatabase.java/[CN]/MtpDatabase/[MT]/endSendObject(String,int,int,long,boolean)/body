{
  if (succeeded) {
    if (format == MtpConstants.FORMAT_ABSTRACT_AV_PLAYLIST) {
      if (path.endsWith(".pla")) {
        path=path.substring(0,path.length() - 4);
      }
      String name=path;
      int lastSlash=name.lastIndexOf('/');
      if (lastSlash >= 0) {
        name=name.substring(lastSlash + 1);
      }
      ContentValues values=new ContentValues(1);
      values.put(Audio.Playlists.DATA,path);
      values.put(Audio.Playlists.NAME,name);
      values.put(Files.FileColumns.FORMAT,format);
      values.put(MediaColumns.MEDIA_SCANNER_NEW_OBJECT_ID,handle);
      try {
        Uri uri=mMediaProvider.insert(Audio.Playlists.EXTERNAL_CONTENT_URI,values);
      }
 catch (      RemoteException e) {
        Log.e(TAG,"RemoteException in endSendObject",e);
      }
    }
 else {
      if (actualSize >= 0) {
        ContentValues values=new ContentValues();
        values.put(Files.FileColumns.SIZE,actualSize);
        try {
          String[] whereArgs=new String[]{Integer.toString(handle)};
          mMediaProvider.update(mObjectsUri,values,ID_WHERE,whereArgs);
        }
 catch (        RemoteException e) {
          Log.e(TAG,"RemoteException in mMediaProvider.update",e);
        }
      }
      mMediaScanner.scanMtpFile(path,mVolumeName,handle,format);
    }
  }
 else {
    deleteFile(handle);
  }
}
