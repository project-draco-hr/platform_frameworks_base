{
  int psState=mCdmaPhone.mSST.getCurrentCdmaDataConnectionState();
  boolean roaming=(mPhone.getServiceState().getRoaming() && !getDataOnRoamingEnabled());
  boolean desiredPowerState=mCdmaPhone.mSST.getDesiredPowerState();
  boolean allowed=(psState == ServiceState.STATE_IN_SERVICE || mAutoAttachOnCreation) && (mPhone.mCM.getNvState() == CommandsInterface.RadioState.NV_READY || mCdmaPhone.mIccRecords.getRecordsLoaded()) && (mCdmaPhone.mSST.isConcurrentVoiceAndDataAllowed() || mPhone.getState() == Phone.State.IDLE)&& !roaming&& mInternalDataEnabled&& desiredPowerState&& !mPendingRestartRadio&& !mCdmaPhone.needsOtaServiceProvisioning();
  if (!allowed && DBG) {
    String reason="";
    if (!((psState == ServiceState.STATE_IN_SERVICE) || mAutoAttachOnCreation)) {
      reason+=" - psState= " + psState;
    }
    if (!(mPhone.mCM.getNvState() == CommandsInterface.RadioState.NV_READY || mCdmaPhone.mIccRecords.getRecordsLoaded())) {
      reason+=" - radioState= " + mPhone.mCM.getNvState() + " - RUIM not loaded";
    }
    if (!(mCdmaPhone.mSST.isConcurrentVoiceAndDataAllowed() || mPhone.getState() == Phone.State.IDLE)) {
      reason+=" - concurrentVoiceAndData not allowed and state= " + mPhone.getState();
    }
    if (roaming)     reason+=" - Roaming";
    if (!mInternalDataEnabled)     reason+=" - mInternalDataEnabled= false";
    if (!desiredPowerState)     reason+=" - desiredPowerState= false";
    if (mPendingRestartRadio)     reason+=" - mPendingRestartRadio= true";
    if (mCdmaPhone.needsOtaServiceProvisioning())     reason+=" - needs Provisioning";
    log("Data not allowed due to" + reason);
  }
  return allowed;
}
