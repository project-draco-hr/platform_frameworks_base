{
  int psState=mCdmaPhone.mSST.getCurrentCdmaDataConnectionState();
  boolean roaming=(phone.getServiceState().getRoaming() && !getDataOnRoamingEnabled());
  boolean desiredPowerState=mCdmaPhone.mSST.getDesiredPowerState();
  boolean allowed=(psState == ServiceState.STATE_IN_SERVICE && (phone.mCM.getRadioState() == CommandsInterface.RadioState.NV_READY || mCdmaPhone.mRuimRecords.getRecordsLoaded()) && (mCdmaPhone.mSST.isConcurrentVoiceAndData() || phone.getState() == Phone.State.IDLE) && !roaming && mMasterDataEnabled && desiredPowerState && !mPendingRestartRadio && !mCdmaPhone.needsOtaServiceProvisioning());
  if (!allowed && DBG) {
    String reason="";
    if (psState != ServiceState.STATE_IN_SERVICE)     reason+=" - psState= " + psState;
    if (phone.mCM.getRadioState() != CommandsInterface.RadioState.NV_READY && !mCdmaPhone.mRuimRecords.getRecordsLoaded()) {
      reason+=" - radioState= " + phone.mCM.getRadioState() + " - RUIM not loaded";
    }
    if (phone.getState() != Phone.State.IDLE && mCdmaPhone.mSST.isConcurrentVoiceAndData()) {
      reason+=" - concurrentVoiceAndData not allowed and state= " + phone.getState();
    }
    if (roaming)     reason+=" - Roaming";
    if (!mMasterDataEnabled)     reason+=" - mMasterDataEnabled= false";
    if (!desiredPowerState)     reason+=" - desiredPowerState= false";
    if (mPendingRestartRadio)     reason+=" - mPendingRestartRadio= true";
    if (mCdmaPhone.needsOtaServiceProvisioning())     reason+=" - needs Provisioning";
    log("Data not allowed due to" + reason);
  }
  return allowed;
}
