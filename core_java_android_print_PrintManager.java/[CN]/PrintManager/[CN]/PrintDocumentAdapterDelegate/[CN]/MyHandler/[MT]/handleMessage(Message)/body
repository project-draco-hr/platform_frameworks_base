{
  if (isFinished()) {
    return;
  }
switch (message.what) {
case MSG_START:
{
      mDocumentAdapter.onStart();
    }
  break;
case MSG_LAYOUT:
{
  SomeArgs args=(SomeArgs)message.obj;
  PrintAttributes oldAttributes=(PrintAttributes)args.arg1;
  PrintAttributes newAttributes=(PrintAttributes)args.arg2;
  ILayoutResultCallback callback=(ILayoutResultCallback)args.arg3;
  Bundle metadata=(Bundle)args.arg4;
  final int sequence=args.argi1;
  args.recycle();
  CancellationSignal cancellation=new CancellationSignal();
synchronized (mLock) {
    mLayoutOrWriteCancellation=cancellation;
  }
  mDocumentAdapter.onLayout(oldAttributes,newAttributes,cancellation,new MyLayoutResultCallback(callback,sequence),metadata);
}
break;
case MSG_WRITE:
{
SomeArgs args=(SomeArgs)message.obj;
PageRange[] pages=(PageRange[])args.arg1;
ParcelFileDescriptor fd=(ParcelFileDescriptor)args.arg2;
IWriteResultCallback callback=(IWriteResultCallback)args.arg3;
final int sequence=args.argi1;
args.recycle();
CancellationSignal cancellation=new CancellationSignal();
synchronized (mLock) {
mLayoutOrWriteCancellation=cancellation;
}
mDocumentAdapter.onWrite(pages,fd,cancellation,new MyWriteResultCallback(callback,fd,sequence));
}
break;
case MSG_FINISH:
{
mDocumentAdapter.onFinish();
doFinish();
}
break;
default :
{
throw new IllegalArgumentException("Unknown message: " + message.what);
}
}
}
