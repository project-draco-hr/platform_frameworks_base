{
  if (!PageRangeUtils.contains(mSelectedPages,pageIndexInDocument)) {
    return INVALID_PAGE_INDEX;
  }
  if (mWrittenPages == null) {
    return INVALID_PAGE_INDEX;
  }
  int indexInFile=INVALID_PAGE_INDEX;
  final int rangeCount=mWrittenPages.length;
  for (int i=0; i < rangeCount; i++) {
    PageRange pageRange=mWrittenPages[i];
    if (!pageRange.contains(pageIndexInDocument)) {
      indexInFile+=pageRange.getSize();
    }
 else {
      indexInFile+=pageIndexInDocument - pageRange.getStart() + 1;
      return indexInFile;
    }
  }
  return INVALID_PAGE_INDEX;
}
