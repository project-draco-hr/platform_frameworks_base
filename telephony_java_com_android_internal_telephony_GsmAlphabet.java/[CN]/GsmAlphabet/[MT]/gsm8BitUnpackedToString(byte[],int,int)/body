{
  String languageTableToChar=sLanguageTables[0];
  String shiftTableToChar=sLanguageShiftTables[0];
  StringBuilder ret=new StringBuilder(length);
  boolean prevWasEscape=false;
  for (int i=offset; i < offset + length; i++) {
    int c=data[i] & 0xff;
    if (c == 0xff) {
      break;
    }
 else     if (c == GSM_EXTENDED_ESCAPE) {
      if (prevWasEscape) {
        ret.append(' ');
        prevWasEscape=false;
      }
 else {
        prevWasEscape=true;
      }
    }
 else {
      if (prevWasEscape) {
        char shiftChar=shiftTableToChar.charAt(c);
        if (shiftChar == ' ') {
          ret.append(languageTableToChar.charAt(c));
        }
 else {
          ret.append(shiftChar);
        }
      }
 else {
        ret.append(languageTableToChar.charAt(c));
      }
      prevWasEscape=false;
    }
  }
  return ret.toString();
}
