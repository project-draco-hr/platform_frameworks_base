{
  boolean prevWasEscape;
  StringBuilder ret=new StringBuilder(length);
  prevWasEscape=false;
  for (int i=offset; i < offset + length; i++) {
    int c=data[i] & 0xff;
    if (c == 0xff) {
      break;
    }
 else     if (c == GSM_EXTENDED_ESCAPE) {
      if (prevWasEscape) {
        ret.append(' ');
        prevWasEscape=false;
      }
 else {
        prevWasEscape=true;
      }
    }
 else {
      if (prevWasEscape) {
        ret.append((char)gsmExtendedToChar.get(c,' '));
      }
 else {
        ret.append((char)gsmToChar.get(c,' '));
      }
      prevWasEscape=false;
    }
  }
  return ret.toString();
}
