{
  int width=mInPixelsAllocation.getType().getX();
  int height=mInPixelsAllocation.getType().getY();
  if (mUseIntrinsic) {
    mIntrinsic=ScriptIntrinsicBlur.create(mRS,Element.U8_4(mRS));
    mIntrinsic.setRadius(25.f);
    mIntrinsic.setInput(mInPixelsAllocation);
  }
 else {
    Type.Builder tb=new Type.Builder(mRS,Element.F32_4(mRS));
    tb.setX(width);
    tb.setY(height);
    mScratchPixelsAllocation1=Allocation.createTyped(mRS,tb.create());
    mScratchPixelsAllocation2=Allocation.createTyped(mRS,tb.create());
    mScriptVBlur=new ScriptC_vertical_blur(mRS,res,R.raw.vertical_blur);
    mScriptHBlur=new ScriptC_horizontal_blur(mRS,res,R.raw.horizontal_blur);
    mScript=new ScriptC_threshold(mRS,res,R.raw.threshold);
    mScript.set_width(width);
    mScript.set_height(height);
    mScript.set_radius(mRadius);
    mScriptVBlur.invoke_setSaturation(mSaturation);
    mScript.bind_InPixel(mInPixelsAllocation);
    mScript.bind_OutPixel(mOutPixelsAllocation);
    mScript.bind_ScratchPixel1(mScratchPixelsAllocation1);
    mScript.bind_ScratchPixel2(mScratchPixelsAllocation2);
    mScript.set_vBlurScript(mScriptVBlur);
    mScript.set_hBlurScript(mScriptHBlur);
  }
}
