{
  KeyguardWidgetFrame frame;
  if (!(widget instanceof KeyguardWidgetFrame)) {
    frame=new KeyguardWidgetFrame(getContext());
    FrameLayout.LayoutParams lp=new FrameLayout.LayoutParams(LayoutParams.MATCH_PARENT,LayoutParams.MATCH_PARENT);
    lp.gravity=Gravity.TOP;
    widget.setPadding(0,0,0,0);
    frame.addView(widget,lp);
    if (widget instanceof AppWidgetHostView) {
      AppWidgetHostView awhv=(AppWidgetHostView)widget;
      AppWidgetProviderInfo info=awhv.getAppWidgetInfo();
      if ((info.resizeMode & AppWidgetProviderInfo.RESIZE_VERTICAL) != 0) {
        frame.setWidgetLockedSmall(false);
      }
 else {
        frame.setWidgetLockedSmall(true);
        if (mCenterSmallWidgetsVertically) {
          lp.gravity=Gravity.CENTER;
        }
      }
    }
  }
 else {
    frame=(KeyguardWidgetFrame)widget;
  }
  ViewGroup.LayoutParams pageLp=new ViewGroup.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT,ViewGroup.LayoutParams.MATCH_PARENT);
  frame.setOnLongClickListener(this);
  frame.setWorkerHandler(mBackgroundWorkerHandler);
  if (pageIndex == -1) {
    addView(frame,pageLp);
  }
 else {
    addView(frame,pageIndex,pageLp);
  }
  View content=(widget == frame) ? frame.getContent() : widget;
  if (content != null) {
    String contentDescription=mContext.getString(com.android.internal.R.string.keyguard_accessibility_widget,content.getContentDescription());
    frame.setContentDescription(contentDescription);
  }
  updateWidgetFrameImportantForAccessibility(frame);
}
