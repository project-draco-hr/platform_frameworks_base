{
  if (mState != STATE_PROCESSING_KEYCODE) {
    Slog.w(TAG,"Not in a valid state");
    return;
  }
  if (isPressed) {
    if (keycode != mLastKeycode) {
      if (!HdmiCecKeycode.isRepeatableKey(keycode)) {
        sendKeyDown(keycode);
        finish();
        return;
      }
      mActionTimer.clearTimerMessage();
      sendKeyDown(keycode);
      addTimer(mState,IRT_MS);
      mLastKeycode=keycode;
    }
  }
 else {
    if (keycode == mLastKeycode) {
      sendKeyUp();
      finish();
    }
  }
}
