{
  Listener l=null;
  for (  Listener listener : mListeners) {
    if (binder == listener.mToken) {
      l=listener;
      break;
    }
  }
  if (enable != SENSOR_DISABLE) {
    if (_sensors_control_activate(sensor,true) == false) {
      Slog.w(TAG,"could not enable sensor " + sensor);
      return false;
    }
    if (l == null) {
      l=new Listener(binder,uid);
      binder.linkToDeath(l,0);
      mListeners.add(l);
      mListeners.notify();
    }
    l.addSensor(sensor,enable);
  }
 else {
    if (l == null) {
      Slog.w(TAG,"listener with binder " + binder + ", doesn't exist (sensor="+ name+ ", id="+ sensor+ ")");
      return false;
    }
    l.removeSensor(sensor);
    deactivateIfUnusedLocked(sensor);
    if (l.mSensors == 0) {
      binder.unlinkToDeath(l,0);
      mListeners.remove(l);
      if (mListeners.size() == 0) {
        _sensors_control_wake();
        _sensors_control_close();
      }
      mListeners.notify();
    }
  }
  int minDelay=0x7FFFFFFF;
  for (  Listener listener : mListeners) {
    if (listener.mDelay < minDelay)     minDelay=listener.mDelay;
  }
  if (minDelay != 0x7FFFFFFF) {
    mCurrentDelay=minDelay;
    _sensors_control_set_delay(minDelay);
  }
  return true;
}
