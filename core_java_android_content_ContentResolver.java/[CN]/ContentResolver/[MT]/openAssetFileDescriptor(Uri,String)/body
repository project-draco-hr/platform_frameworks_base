{
  String scheme=uri.getScheme();
  if (SCHEME_ANDROID_RESOURCE.equals(scheme)) {
    if (!"r".equals(mode)) {
      throw new FileNotFoundException("Can't write resources: " + uri);
    }
    OpenResourceIdResult r=getResourceId(uri);
    try {
      return r.r.openRawResourceFd(r.id);
    }
 catch (    Resources.NotFoundException ex) {
      throw new FileNotFoundException("Resource does not exist: " + uri);
    }
  }
 else   if (SCHEME_FILE.equals(scheme)) {
    ParcelFileDescriptor pfd=ParcelFileDescriptor.open(new File(uri.getPath()),modeToMode(uri,mode));
    return new AssetFileDescriptor(pfd,0,-1);
  }
 else {
    if ("r".equals(mode)) {
      return openTypedAssetFileDescriptor(uri,"*/*",null);
    }
 else {
      int n=0;
      while (true) {
        n++;
        IContentProvider provider=acquireUnstableProvider(uri);
        if (provider == null) {
          throw new FileNotFoundException("No content provider: " + uri);
        }
        try {
          AssetFileDescriptor fd=provider.openAssetFile(uri,mode);
          if (fd == null) {
            return null;
          }
          ParcelFileDescriptor pfd=new ParcelFileDescriptorInner(fd.getParcelFileDescriptor(),provider);
          provider=null;
          return new AssetFileDescriptor(pfd,fd.getStartOffset(),fd.getDeclaredLength());
        }
 catch (        RemoteException e) {
          if (n <= 2) {
            try {
              Thread.sleep(100);
            }
 catch (            InterruptedException e1) {
            }
            continue;
          }
          throw new FileNotFoundException("Dead content provider: " + uri);
        }
catch (        FileNotFoundException e) {
          throw e;
        }
 finally {
          if (provider != null) {
            releaseUnstableProvider(provider);
          }
        }
      }
    }
  }
}
