{
  int numProfiles=profiles.length;
  int[] renderingIntents=new int[numProfiles];
  int currRenderingIntent=ICC_Profile.icPerceptual;
  if (profiles[0].getProfileClass() == ICC_Profile.CLASS_OUTPUT) {
    currRenderingIntent=ICC_Profile.icRelativeColorimetric;
  }
  for (int i=0; i < numProfiles; i++) {
    if (i != 0 && i != numProfiles - 1 && profiles[i].getProfileClass() == ICC_Profile.CLASS_ABSTRACT) {
      currRenderingIntent=ICC_Profile.icPerceptual;
    }
    renderingIntents[i]=currRenderingIntent;
    currRenderingIntent=ICC_ProfileHelper.getRenderingIntent(profiles[i]);
  }
  long[] profileHandles=new long[numProfiles];
  for (int i=0; i < numProfiles; i++) {
    profileHandles[i]=NativeCMM.getHandle(profiles[i]);
  }
  transformHandle=NativeCMM.cmmCreateMultiprofileTransform(profileHandles,renderingIntents);
  src=profiles[0];
  dst=profiles[numProfiles - 1];
  numInputChannels=src.getNumComponents();
  numOutputChannels=dst.getNumComponents();
}
