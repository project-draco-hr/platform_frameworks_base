{
  mListener=listener;
  mPendingIntent=intent;
  if (listener != null) {
    mKey=listener.asBinder();
  }
 else {
    mKey=intent;
  }
  mAllowedResolutionLevel=getAllowedResolutionLevel(pid,uid);
  mUid=uid;
  mPid=pid;
  mPackageName=packageName;
  if (workSource != null && workSource.size() <= 0) {
    workSource=null;
  }
  mWorkSource=workSource;
  mHideFromAppOps=hideFromAppOps;
  updateMonitoring(true);
  mWakeLock=mPowerManager.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK,WAKELOCK_KEY);
  if (workSource == null) {
    workSource=new WorkSource(mUid,mPackageName);
  }
  mWakeLock.setWorkSource(workSource);
}
