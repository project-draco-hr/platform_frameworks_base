{
  if (!currentlyMonitoring) {
    if (allowMonitoring) {
      return mAppOps.startOpNoThrow(op,mUid,mPackageName) == AppOpsManager.MODE_ALLOWED;
    }
  }
 else {
    if (!allowMonitoring || mAppOps.checkOpNoThrow(op,mUid,mPackageName) != AppOpsManager.MODE_ALLOWED) {
      mAppOps.finishOp(op,mUid,mPackageName);
      return false;
    }
  }
  return currentlyMonitoring;
}
