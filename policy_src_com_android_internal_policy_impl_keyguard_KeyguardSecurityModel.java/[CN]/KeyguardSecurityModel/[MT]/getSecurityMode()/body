{
  KeyguardUpdateMonitor mUpdateMonitor=KeyguardUpdateMonitor.getInstance(mContext);
  final IccCardConstants.State simState=mUpdateMonitor.getSimState();
  if (simState == IccCardConstants.State.PIN_REQUIRED) {
    return SecurityMode.SimPin;
  }
 else   if (simState == IccCardConstants.State.PUK_REQUIRED) {
    return SecurityMode.SimPuk;
  }
 else {
    final int mode=mLockPatternUtils.getKeyguardStoredPasswordQuality();
switch (mode) {
case DevicePolicyManager.PASSWORD_QUALITY_NUMERIC:
case DevicePolicyManager.PASSWORD_QUALITY_ALPHABETIC:
case DevicePolicyManager.PASSWORD_QUALITY_ALPHANUMERIC:
case DevicePolicyManager.PASSWORD_QUALITY_COMPLEX:
      return mLockPatternUtils.isLockPasswordEnabled() ? SecurityMode.Password : SecurityMode.None;
case DevicePolicyManager.PASSWORD_QUALITY_SOMETHING:
case DevicePolicyManager.PASSWORD_QUALITY_UNSPECIFIED:
    if (mLockPatternUtils.isLockPatternEnabled()) {
      return mLockPatternUtils.isPermanentlyLocked() ? SecurityMode.Account : SecurityMode.Pattern;
    }
 else {
      return SecurityMode.None;
    }
default :
  throw new IllegalStateException("Unknown unlock mode:" + mode);
}
}
}
