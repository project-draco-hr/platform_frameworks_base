{
  KeyguardUpdateMonitor mUpdateMonitor=KeyguardUpdateMonitor.getInstance(mContext);
  final IccCardConstants.State simState=mUpdateMonitor.getSimState();
  SecurityMode mode=SecurityMode.None;
  if (simState == IccCardConstants.State.PIN_REQUIRED) {
    mode=SecurityMode.SimPin;
  }
 else   if (simState == IccCardConstants.State.PUK_REQUIRED) {
    mode=SecurityMode.SimPuk;
  }
 else {
    final int security=mLockPatternUtils.getKeyguardStoredPasswordQuality();
switch (security) {
case DevicePolicyManager.PASSWORD_QUALITY_NUMERIC:
case DevicePolicyManager.PASSWORD_QUALITY_ALPHABETIC:
case DevicePolicyManager.PASSWORD_QUALITY_ALPHANUMERIC:
case DevicePolicyManager.PASSWORD_QUALITY_COMPLEX:
      mode=mLockPatternUtils.isLockPasswordEnabled() ? SecurityMode.Password : SecurityMode.None;
    break;
case DevicePolicyManager.PASSWORD_QUALITY_SOMETHING:
case DevicePolicyManager.PASSWORD_QUALITY_UNSPECIFIED:
  if (mLockPatternUtils.isLockPatternEnabled()) {
    mode=mLockPatternUtils.isPermanentlyLocked() ? SecurityMode.Account : SecurityMode.Pattern;
  }
break;
default :
throw new IllegalStateException("Unknown unlock mode:" + mode);
}
}
return mode;
}
