{
  final String action=intent.getAction();
  if (action.equals(BluetoothAdapter.ACTION_STATE_CHANGED)) {
    handleAdapterStateChange(intent.getIntExtra(BluetoothAdapter.EXTRA_STATE,BluetoothAdapter.ERROR));
  }
  if (action.equals(BluetoothAdapter.ACTION_CONNECTION_STATE_CHANGED)) {
    mConnecting=intent.getIntExtra(BluetoothAdapter.EXTRA_CONNECTION_STATE,-1) == BluetoothAdapter.STATE_CONNECTING;
    mLastDevice=intent.getParcelableExtra(BluetoothDevice.EXTRA_DEVICE);
  }
  fireCallbacks();
  updateBondedBluetoothDevices();
}
