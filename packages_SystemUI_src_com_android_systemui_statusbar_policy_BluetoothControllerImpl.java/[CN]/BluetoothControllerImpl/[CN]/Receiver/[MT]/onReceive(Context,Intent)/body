{
  final String action=intent.getAction();
  final BluetoothDevice device=intent.getParcelableExtra(BluetoothDevice.EXTRA_DEVICE);
  if (action.equals(BluetoothAdapter.ACTION_STATE_CHANGED)) {
    setAdapterState(intent.getIntExtra(BluetoothAdapter.EXTRA_STATE,ERROR));
    updateBondedDevices();
    if (DEBUG)     Log.d(TAG,"ACTION_STATE_CHANGED " + mEnabled);
  }
 else   if (action.equals(BluetoothAdapter.ACTION_CONNECTION_STATE_CHANGED)) {
    updateInfo(device);
    final int state=intent.getIntExtra(BluetoothAdapter.EXTRA_CONNECTION_STATE,ERROR);
    mLastDevice=device;
    if (DEBUG)     Log.d(TAG,"ACTION_CONNECTION_STATE_CHANGED " + connectionStateToString(state) + " "+ deviceToString(device));
    setConnecting(state == BluetoothAdapter.STATE_CONNECTING);
  }
 else   if (action.equals(BluetoothDevice.ACTION_ALIAS_CHANGED)) {
    updateInfo(device);
    mLastDevice=device;
  }
 else   if (action.equals(BluetoothDevice.ACTION_BOND_STATE_CHANGED)) {
    if (DEBUG)     Log.d(TAG,"ACTION_BOND_STATE_CHANGED " + device);
    updateBondedDevices();
  }
 else {
    int profile=getProfileFromAction(intent.getAction());
    int state=intent.getIntExtra(BluetoothProfile.EXTRA_STATE,-1);
    if (DEBUG)     Log.d(TAG,"ACTION_CONNECTION_STATE_CHANGE " + BluetoothUtil.profileToString(profile) + " "+ BluetoothUtil.connectionStateToString(state));
    if ((profile != -1) && (state != -1)) {
      updateConnectionState(device,profile,state);
    }
  }
}
