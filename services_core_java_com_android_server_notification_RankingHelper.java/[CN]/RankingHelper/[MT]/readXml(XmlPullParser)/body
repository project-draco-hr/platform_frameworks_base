{
  int type=parser.getEventType();
  if (type != XmlPullParser.START_TAG)   return;
  String tag=parser.getName();
  if (!TAG_RANKING.equals(tag))   return;
  mPackagePriorities.clear();
  final int version=safeInt(parser,ATT_VERSION,XML_VERSION);
  while ((type=parser.next()) != XmlPullParser.END_DOCUMENT) {
    tag=parser.getName();
    if (type == XmlPullParser.END_TAG && TAG_RANKING.equals(tag)) {
      return;
    }
    if (type == XmlPullParser.START_TAG) {
      if (TAG_PACKAGE.equals(tag)) {
        int uid=safeInt(parser,ATT_UID,UserHandle.USER_ALL);
        int priority=safeInt(parser,ATT_PRIORITY,Notification.PRIORITY_DEFAULT);
        String name=parser.getAttributeValue(null,ATT_NAME);
        if (!TextUtils.isEmpty(name) && priority != Notification.PRIORITY_DEFAULT) {
          SparseIntArray priorityByUid=mPackagePriorities.get(name);
          if (priorityByUid == null) {
            priorityByUid=new SparseIntArray();
            mPackagePriorities.put(name,priorityByUid);
          }
          priorityByUid.put(uid,priority);
        }
      }
    }
  }
  throw new IllegalStateException("Failed to reach END_DOCUMENT");
}
