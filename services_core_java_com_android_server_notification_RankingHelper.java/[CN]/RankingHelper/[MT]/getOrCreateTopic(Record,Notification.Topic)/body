{
  if (topic == null) {
    topic=createDefaultTopic();
  }
  Topic t=r.topics.get(topic.getId());
  if (t != null) {
    return t;
  }
 else {
    t=new Topic(topic);
    t.importance=r.importance;
    t.priority=r.priority;
    t.visibility=r.visibility;
    r.topics.put(topic.getId(),t);
    return t;
  }
}
