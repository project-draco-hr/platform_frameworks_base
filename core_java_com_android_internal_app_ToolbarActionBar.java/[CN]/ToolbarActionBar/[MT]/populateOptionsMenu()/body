{
  if (!mMenuCallbackSet) {
    mToolbar.setMenuCallbacks(new ActionMenuPresenterCallback(),new MenuBuilderCallback());
    mMenuCallbackSet=true;
  }
  final Menu menu=mToolbar.getMenu();
  final MenuBuilder mb=menu instanceof MenuBuilder ? (MenuBuilder)menu : null;
  if (mb != null) {
    mb.stopDispatchingItemsChanged();
  }
  try {
    menu.clear();
    if (!mWindowCallback.onCreatePanelMenu(Window.FEATURE_OPTIONS_PANEL,menu) || !mWindowCallback.onPreparePanel(Window.FEATURE_OPTIONS_PANEL,null,menu)) {
      menu.clear();
    }
  }
  finally {
    if (mb != null) {
      mb.startDispatchingItemsChanged();
    }
  }
}
