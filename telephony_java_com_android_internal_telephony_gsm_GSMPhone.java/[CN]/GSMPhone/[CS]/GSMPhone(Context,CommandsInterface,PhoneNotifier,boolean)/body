{
  super(notifier,context,ci,unitTestMode);
  if (ci instanceof SimulatedRadioControl) {
    mSimulatedRadioControl=(SimulatedRadioControl)ci;
  }
  mCM.setPhoneType(RILConstants.GSM_PHONE);
  mCT=new GsmCallTracker(this);
  mSST=new GsmServiceStateTracker(this);
  mSMS=new GsmSMSDispatcher(this);
  mIccFileHandler=new SIMFileHandler(this);
  mSIMRecords=new SIMRecords(this);
  mDataConnection=new GsmDataConnectionTracker(this);
  mSimCard=new SimCard(this);
  if (!unitTestMode) {
    mSimPhoneBookIntManager=new SimPhoneBookInterfaceManager(this);
    mSimSmsIntManager=new SimSmsInterfaceManager(this);
    mSubInfo=new PhoneSubInfo(this);
  }
  mStkService=StkService.getInstance(mCM,mSIMRecords,mContext,(SIMFileHandler)mIccFileHandler,mSimCard);
  mCM.registerForAvailable(this,EVENT_RADIO_AVAILABLE,null);
  mSIMRecords.registerForRecordsLoaded(this,EVENT_SIM_RECORDS_LOADED,null);
  mCM.registerForOffOrNotAvailable(this,EVENT_RADIO_OFF_OR_NOT_AVAILABLE,null);
  mCM.registerForOn(this,EVENT_RADIO_ON,null);
  mCM.setOnUSSD(this,EVENT_USSD,null);
  mCM.setOnSuppServiceNotification(this,EVENT_SSN,null);
  mSST.registerForNetworkAttach(this,EVENT_REGISTERED_TO_NETWORK,null);
  if (false) {
    try {
      debugSocket=new ServerSocket();
      debugSocket.setReuseAddress(true);
      debugSocket.bind(new InetSocketAddress("127.0.0.1",6666));
      debugPortThread=new Thread(new Runnable(){
        public void run(){
          for (; ; ) {
            try {
              Socket sock;
              sock=debugSocket.accept();
              Log.i(LOG_TAG,"New connection; resetting radio");
              mCM.resetRadio(null);
              sock.close();
            }
 catch (            IOException ex) {
              Log.w(LOG_TAG,"Exception accepting socket",ex);
            }
          }
        }
      }
,"GSMPhone debug");
      debugPortThread.start();
    }
 catch (    IOException ex) {
      Log.w(LOG_TAG,"Failure to open com.android.internal.telephony.debug socket",ex);
    }
  }
  SystemProperties.set(TelephonyProperties.CURRENT_ACTIVE_PHONE,new Integer(RILConstants.GSM_PHONE).toString());
}
