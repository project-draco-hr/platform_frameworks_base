{
  final int callingUserId=injectCallingUserId();
  final int targetUserId=userToCheck.getIdentifier();
  if (targetUserId == callingUserId)   return;
  long ident=injectClearCallingIdentity();
  try {
    UserInfo callingUserInfo=mUm.getUserInfo(callingUserId);
    UserInfo targetUserInfo=mUm.getUserInfo(targetUserId);
    if (targetUserInfo == null || targetUserInfo.profileGroupId == UserInfo.NO_PROFILE_GROUP_ID || targetUserInfo.profileGroupId != callingUserInfo.profileGroupId) {
      throw new SecurityException(message);
    }
  }
  finally {
    injectRestoreCallingIdentity(ident);
  }
}
