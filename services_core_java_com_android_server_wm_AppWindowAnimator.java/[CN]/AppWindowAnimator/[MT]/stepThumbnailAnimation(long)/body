{
  thumbnailTransformation.clear();
  final long animationFrameTime=getAnimationFrameTime(thumbnailAnimation,currentTime);
  thumbnailAnimation.getTransformation(animationFrameTime,thumbnailTransformation);
  thumbnailTransformation.getMatrix().preTranslate(thumbnailX,thumbnailY);
  ScreenRotationAnimation screenRotationAnimation=mAnimator.getScreenRotationAnimationLocked(Display.DEFAULT_DISPLAY);
  final boolean screenAnimation=screenRotationAnimation != null && screenRotationAnimation.isAnimating();
  if (screenAnimation) {
    thumbnailTransformation.postCompose(screenRotationAnimation.getEnterTransformation());
  }
  final float tmpFloats[]=mService.mTmpFloats;
  thumbnailTransformation.getMatrix().getValues(tmpFloats);
  if (SHOW_TRANSACTIONS)   WindowManagerService.logSurface(thumbnail,"thumbnail","POS " + tmpFloats[Matrix.MTRANS_X] + ", "+ tmpFloats[Matrix.MTRANS_Y],null);
  thumbnail.setPosition(tmpFloats[Matrix.MTRANS_X],tmpFloats[Matrix.MTRANS_Y]);
  if (SHOW_TRANSACTIONS)   WindowManagerService.logSurface(thumbnail,"thumbnail","alpha=" + thumbnailTransformation.getAlpha() + " layer="+ thumbnailLayer+ " matrix=["+ tmpFloats[Matrix.MSCALE_X]+ ","+ tmpFloats[Matrix.MSKEW_Y]+ "]["+ tmpFloats[Matrix.MSKEW_X]+ ","+ tmpFloats[Matrix.MSCALE_Y]+ "]",null);
  thumbnail.setAlpha(thumbnailTransformation.getAlpha());
  if (thumbnailForceAboveLayer > 0) {
    thumbnail.setLayer(thumbnailForceAboveLayer + 1);
  }
 else {
    thumbnail.setLayer(thumbnailLayer + WindowManagerService.WINDOW_LAYER_MULTIPLIER - WindowManagerService.LAYER_OFFSET_THUMBNAIL);
  }
  thumbnail.setMatrix(tmpFloats[Matrix.MSCALE_X],tmpFloats[Matrix.MSKEW_Y],tmpFloats[Matrix.MSKEW_X],tmpFloats[Matrix.MSCALE_Y]);
}
