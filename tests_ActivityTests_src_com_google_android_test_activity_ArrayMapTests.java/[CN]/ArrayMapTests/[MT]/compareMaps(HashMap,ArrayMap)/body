{
  if (map.size() != array.size()) {
    Log.e("test","Bad size: expected " + map.size() + ", got "+ array.size());
    return false;
  }
  Set<Map.Entry> mapSet=map.entrySet();
  for (  Map.Entry entry : mapSet) {
    Object expValue=entry.getValue();
    Object gotValue=array.get(entry.getKey());
    if (!compare(expValue,gotValue)) {
      Log.e("test","Bad value: expected " + expValue + ", got "+ gotValue+ " at key "+ entry.getKey());
      return false;
    }
  }
  for (int i=0; i < array.size(); i++) {
    Object gotValue=array.valueAt(i);
    Object key=array.keyAt(i);
    Object expValue=map.get(key);
    if (!compare(expValue,gotValue)) {
      Log.e("test","Bad value: expected " + expValue + ", got "+ gotValue+ " at key "+ key);
      return false;
    }
  }
  int index=0;
  for (  Object entry : array.entrySet()) {
    Object key=((Map.Entry)entry).getKey();
    Object value=((Map.Entry)entry).getValue();
    Object realKey=array.keyAt(index);
    Object realValue=array.valueAt(index);
    if (!compare(key,realKey)) {
      Log.e("test","Bad entry iterator: expected key " + realKey + ", got "+ key+ " at index "+ index);
      return false;
    }
    if (!compare(value,realValue)) {
      Log.e("test","Bad entry iterator: expected value " + realValue + ", got "+ value+ " at index "+ index);
      return false;
    }
    index++;
  }
  index=0;
  for (  Object key : array.keySet()) {
    Object realKey=array.keyAt(index);
    if (!compare(key,realKey)) {
      Log.e("test","Bad key iterator: expected key " + realKey + ", got "+ key+ " at index "+ index);
      return false;
    }
    index++;
  }
  index=0;
  for (  Object value : array.values()) {
    Object realValue=array.valueAt(index);
    if (!compare(value,realValue)) {
      Log.e("test","Bad value iterator: expected value " + realValue + ", got "+ value+ " at index "+ index);
      return false;
    }
    index++;
  }
  return true;
}
