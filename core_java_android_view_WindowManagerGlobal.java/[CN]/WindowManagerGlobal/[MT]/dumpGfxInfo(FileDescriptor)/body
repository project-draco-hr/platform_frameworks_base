{
  FileOutputStream fout=new FileOutputStream(fd);
  PrintWriter pw=new PrintWriter(fout);
  try {
synchronized (mLock) {
      if (mViews != null) {
        final int count=mViews.length;
        pw.println("Profile data in ms:");
        for (int i=0; i < count; i++) {
          ViewRootImpl root=mRoots[i];
          String name=getWindowName(root);
          pw.printf("\n\t%s",name);
          HardwareRenderer renderer=root.getView().mAttachInfo.mHardwareRenderer;
          if (renderer != null) {
            renderer.dumpGfxInfo(pw);
          }
        }
        pw.println("\nView hierarchy:\n");
        int viewsCount=0;
        int displayListsSize=0;
        int[] info=new int[2];
        for (int i=0; i < count; i++) {
          ViewRootImpl root=mRoots[i];
          root.dumpGfxInfo(info);
          String name=getWindowName(root);
          pw.printf("  %s\n  %d views, %.2f kB of display lists",name,info[0],info[1] / 1024.0f);
          HardwareRenderer renderer=root.getView().mAttachInfo.mHardwareRenderer;
          if (renderer != null) {
            pw.printf(", %d frames rendered",renderer.getFrameCount());
          }
          pw.printf("\n\n");
          viewsCount+=info[0];
          displayListsSize+=info[1];
        }
        pw.printf("\nTotal ViewRootImpl: %d\n",count);
        pw.printf("Total Views:        %d\n",viewsCount);
        pw.printf("Total DisplayList:  %.2f kB\n\n",displayListsSize / 1024.0f);
      }
    }
  }
  finally {
    pw.flush();
  }
}
