{
  stopDream();
  mContext.sendBroadcastAsUser(mCloseNotificationShadeIntent,UserHandle.ALL);
  Slog.i(TAG,"Starting dream: name=" + name + ", isTest="+ isTest+ ", canDoze="+ canDoze+ ", userId="+ userId);
  mCurrentDream=new DreamRecord(token,name,isTest,canDoze,userId);
  try {
    mIWindowManager.addWindowToken(token,WindowManager.LayoutParams.TYPE_DREAM);
  }
 catch (  RemoteException ex) {
    Slog.e(TAG,"Unable to add window token for dream.",ex);
    stopDream();
    return;
  }
  Intent intent=new Intent(DreamService.SERVICE_INTERFACE);
  intent.setComponent(name);
  intent.addFlags(Intent.FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS);
  try {
    if (!mContext.bindServiceAsUser(intent,mCurrentDream,Context.BIND_AUTO_CREATE,new UserHandle(userId))) {
      Slog.e(TAG,"Unable to bind dream service: " + intent);
      stopDream();
      return;
    }
  }
 catch (  SecurityException ex) {
    Slog.e(TAG,"Unable to bind dream service: " + intent,ex);
    stopDream();
    return;
  }
  mCurrentDream.mBound=true;
  mHandler.postDelayed(mStopUnconnectedDreamRunnable,DREAM_CONNECTION_TIMEOUT);
}
