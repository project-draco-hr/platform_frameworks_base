{
  final int base=pInfo.protectionLevel & PermissionInfo.PROTECTION_MASK_BASE;
  final boolean isNormal=(base == PermissionInfo.PROTECTION_NORMAL);
  final boolean isDangerous=(base == PermissionInfo.PROTECTION_DANGEROUS);
  final boolean isRequired=((newReqFlags & PackageInfo.REQUESTED_PERMISSION_REQUIRED) != 0);
  final boolean isDevelopment=((pInfo.protectionLevel & PermissionInfo.PROTECTION_FLAG_DEVELOPMENT) != 0);
  final boolean wasGranted=((existingReqFlags & PackageInfo.REQUESTED_PERMISSION_GRANTED) != 0);
  final boolean isGranted=((newReqFlags & PackageInfo.REQUESTED_PERMISSION_GRANTED) != 0);
  if ((isNormal || isDangerous) && (isRequired || wasGranted || isGranted)) {
    return true;
  }
  if (isDevelopment && wasGranted) {
    if (localLOGV)     Log.i(TAG,"Special perm " + pInfo.name + ": protlevel=0x"+ Integer.toHexString(pInfo.protectionLevel));
    return true;
  }
  return false;
}
