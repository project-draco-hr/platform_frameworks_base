{
  if (mHandler == null) {
    mHandler=new Handler(){
      @Override public void handleMessage(      Message msg){
switch (msg.what) {
case GET_ORIGINS:
{
            getOriginsImpl();
            ValueCallback callback=(ValueCallback)msg.obj;
            Set origins=new HashSet(mOrigins);
            Map values=new HashMap<String,Object>();
            values.put(CALLBACK,callback);
            values.put(ORIGINS,origins);
            postUIMessage(Message.obtain(null,RETURN_ORIGINS,values));
          }
        break;
case GET_ALLOWED:
{
        Map values=(Map)msg.obj;
        String origin=(String)values.get(ORIGIN);
        ValueCallback callback=(ValueCallback)values.get(CALLBACK);
        getAllowedImpl(origin);
        Map retValues=new HashMap<String,Object>();
        retValues.put(CALLBACK,callback);
        retValues.put(ALLOWED,new Boolean(mAllowed));
        postUIMessage(Message.obtain(null,RETURN_ALLOWED,retValues));
      }
    break;
case CLEAR:
  nativeClear((String)msg.obj);
break;
case ALLOW:
nativeAllow((String)msg.obj);
break;
case CLEAR_ALL:
nativeClearAll();
break;
}
}
}
;
if (mOriginsToClear != null) {
for (String origin : mOriginsToClear) {
nativeClear(origin);
}
}
if (mOriginsToAllow != null) {
for (String origin : mOriginsToAllow) {
nativeAllow(origin);
}
}
}
}
