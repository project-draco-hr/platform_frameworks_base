{
  mLock.lock();
  if (mHandler == null) {
    mHandler=new Handler(){
      @Override public void handleMessage(      Message msg){
switch (msg.what) {
case GET_ORIGINS:
          getOriginsImpl();
        break;
case GET_ALLOWED:
      getAllowedImpl((String)msg.obj);
    break;
case CLEAR:
  nativeClear((String)msg.obj);
break;
case ALLOW:
nativeAllow((String)msg.obj);
break;
case CLEAR_ALL:
nativeClearAll();
break;
}
}
}
;
if (mOriginsToClear != null) {
for (String origin : mOriginsToClear) {
nativeClear(origin);
}
}
if (mOriginsToAllow != null) {
for (String origin : mOriginsToAllow) {
nativeAllow(origin);
}
}
}
mLock.unlock();
}
