{
switch (m.what) {
case MSG_OPEN_NOTIFICATION_PEEK:
    if (DEBUG)     Slog.d(TAG,"opening notification peek window; arg=" + m.arg1);
  if (m.arg1 >= 0) {
    final int N=mNotns.size();
    if (mNotificationPeekIndex < N) {
      NotificationData.Entry entry=mNotns.get(N - 1 - mNotificationPeekIndex);
      entry.icon.setBackgroundColor(0);
    }
    final int peekIndex=m.arg1;
    if (peekIndex < N) {
      Slog.d(TAG,"loading peek: " + peekIndex);
      NotificationData.Entry entry=mNotns.get(N - 1 - peekIndex);
      NotificationData.Entry copy=new NotificationData.Entry(entry.key,entry.notification,entry.icon);
      inflateViews(copy,mNotificationPeekRow);
      entry.icon.setBackgroundColor(0x20FFFFFF);
      mNotificationPeekRow.removeAllViews();
      mNotificationPeekRow.addView(copy.row);
      mNotificationPeekWindow.setVisibility(View.VISIBLE);
      mNotificationPanel.setVisibility(View.GONE);
      mNotificationPeekIndex=peekIndex;
    }
  }
break;
case MSG_CLOSE_NOTIFICATION_PEEK:
if (DEBUG) Slog.d(TAG,"closing notification peek window");
mNotificationPeekWindow.setVisibility(View.GONE);
mNotificationPeekRow.removeAllViews();
final int N=mNotns.size();
if (mNotificationPeekIndex < N) {
NotificationData.Entry entry=mNotns.get(N - 1 - mNotificationPeekIndex);
entry.icon.setBackgroundColor(0);
}
break;
case MSG_OPEN_NOTIFICATION_PANEL:
if (DEBUG) Slog.d(TAG,"opening notifications panel");
if (mNotificationPanel.getVisibility() == View.GONE) {
mNotificationPeekWindow.setVisibility(View.GONE);
mNotificationPanel.setVisibility(View.VISIBLE);
mShadowController.hideElement(mNotificationArea);
mTicker.halt();
}
break;
case MSG_CLOSE_NOTIFICATION_PANEL:
if (DEBUG) Slog.d(TAG,"closing notifications panel");
if (mNotificationPanel.getVisibility() == View.VISIBLE) {
mNotificationPanel.setVisibility(View.GONE);
mShadowController.showElement(mNotificationArea);
}
break;
case MSG_OPEN_RECENTS_PANEL:
if (DEBUG) Slog.d(TAG,"opening recents panel");
if (mRecentsPanel != null) mRecentsPanel.setVisibility(View.VISIBLE);
break;
case MSG_CLOSE_RECENTS_PANEL:
if (DEBUG) Slog.d(TAG,"closing recents panel");
if (mRecentsPanel != null) mRecentsPanel.setVisibility(View.GONE);
break;
case MSG_HIDE_SHADOWS:
if (DEBUG) Slog.d(TAG,"hiding shadows (lights on)");
mShadowController.hideAllShadows();
break;
case MSG_SHOW_SHADOWS:
if (DEBUG) Slog.d(TAG,"showing shadows (lights out)");
animateCollapse();
mShadowController.showAllShadows();
break;
case MSG_RESTORE_SHADOWS:
if (DEBUG) Slog.d(TAG,"quickly re-showing shadows if appropriate");
mShadowController.refresh();
break;
}
}
