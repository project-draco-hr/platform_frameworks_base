{
  appFlags=appInfo.flags;
  if ((appInfo.flags & ApplicationInfo.FLAG_SUPPORTS_LARGE_SCREENS) != 0) {
    mCompatibilityFlags|=LARGE_SCREENS | CONFIGURED_LARGE_SCREENS;
  }
  if ((appInfo.flags & ApplicationInfo.FLAG_RESIZEABLE_FOR_SCREENS) != 0) {
    mCompatibilityFlags|=EXPANDABLE | CONFIGURED_EXPANDABLE;
  }
  float packageDensityScale=-1.0f;
  int packageDensity=0;
  if (appInfo.supportsDensities != null) {
    int minDiff=Integer.MAX_VALUE;
    for (    int density : appInfo.supportsDensities) {
      if (density == ApplicationInfo.ANY_DENSITY) {
        packageDensity=DisplayMetrics.DENSITY_DEVICE;
        packageDensityScale=1.0f;
        break;
      }
      int tmpDiff=Math.abs(DisplayMetrics.DENSITY_DEVICE - density);
      if (tmpDiff == 0) {
        packageDensity=DisplayMetrics.DENSITY_DEVICE;
        packageDensityScale=1.0f;
        break;
      }
      if (tmpDiff < minDiff && packageDensityScale < 1.0f) {
        packageDensity=density;
        packageDensityScale=DisplayMetrics.DENSITY_DEVICE / (float)density;
        minDiff=tmpDiff;
      }
    }
  }
  if (packageDensityScale > 0.0f) {
    applicationDensity=packageDensity;
    applicationScale=packageDensityScale;
  }
 else {
    applicationDensity=DisplayMetrics.DENSITY_DEFAULT;
    applicationScale=DisplayMetrics.DENSITY_DEVICE / (float)DisplayMetrics.DENSITY_DEFAULT;
  }
  applicationInvertedScale=1.0f / applicationScale;
  if (applicationScale != 1.0f) {
    mCompatibilityFlags|=SCALING_REQUIRED;
  }
}
