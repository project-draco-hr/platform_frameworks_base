{
  int compatFlags=0;
  if ((appInfo.flags & ApplicationInfo.FLAG_SUPPORTS_LARGE_SCREENS) != 0) {
    compatFlags|=LARGE_SCREENS;
    if (!forceCompat) {
      compatFlags|=XLARGE_SCREENS | EXPANDABLE;
    }
  }
  if ((appInfo.flags & ApplicationInfo.FLAG_SUPPORTS_XLARGE_SCREENS) != 0) {
    compatFlags|=XLARGE_SCREENS | EXPANDABLE;
  }
  if (!forceCompat) {
    if ((appInfo.flags & ApplicationInfo.FLAG_RESIZEABLE_FOR_SCREENS) != 0) {
      compatFlags|=EXPANDABLE;
    }
  }
  boolean supportsScreen=false;
switch (screenLayout & Configuration.SCREENLAYOUT_SIZE_MASK) {
case Configuration.SCREENLAYOUT_SIZE_XLARGE:
    if ((compatFlags & XLARGE_SCREENS) != 0) {
      supportsScreen=true;
    }
  if ((appInfo.flags & ApplicationInfo.FLAG_SUPPORTS_XLARGE_SCREENS) != 0) {
    compatFlags|=NEVER_COMPAT;
  }
break;
case Configuration.SCREENLAYOUT_SIZE_LARGE:
if ((compatFlags & LARGE_SCREENS) != 0) {
supportsScreen=true;
}
if ((appInfo.flags & ApplicationInfo.FLAG_SUPPORTS_LARGE_SCREENS) != 0) {
compatFlags|=NEVER_COMPAT;
}
break;
}
if ((screenLayout & Configuration.SCREENLAYOUT_COMPAT_NEEDED) == 0) {
if ((compatFlags & EXPANDABLE) != 0) {
supportsScreen=true;
}
if ((compatFlags & EXPANDABLE) == 0 && (appInfo.flags & ApplicationInfo.FLAG_RESIZEABLE_FOR_SCREENS) == 0) {
compatFlags|=ALWAYS_COMPAT;
}
}
if (supportsScreen) {
compatFlags&=~NEEDS_SCREEN_COMPAT;
}
 else {
compatFlags|=NEEDS_SCREEN_COMPAT;
}
if ((appInfo.flags & ApplicationInfo.FLAG_SUPPORTS_SCREEN_DENSITIES) != 0) {
applicationDensity=DisplayMetrics.DENSITY_DEVICE;
applicationScale=1.0f;
applicationInvertedScale=1.0f;
}
 else {
applicationDensity=DisplayMetrics.DENSITY_DEFAULT;
applicationScale=DisplayMetrics.DENSITY_DEVICE / (float)DisplayMetrics.DENSITY_DEFAULT;
applicationInvertedScale=1.0f / applicationScale;
compatFlags|=SCALING_REQUIRED;
}
mCompatibilityFlags=compatFlags;
}
