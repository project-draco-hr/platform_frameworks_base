{
  if (DEBUG_SIM_STATES) {
    Log.d(TAG,"handleSimStateChange(subId=" + subId + ", slotId="+ slotId+ ", state="+ state+ ")");
  }
  if (subId == SubscriptionManager.INVALID_SUBSCRIPTION_ID) {
    Log.w(TAG,"invalid subId in handleSimStateChange()");
    return;
  }
  SimData data=mSimDatas.get(subId);
  final boolean changed;
  if (data == null) {
    data=new SimData(state,slotId,subId);
    mSimDatas.put(subId,data);
    changed=true;
  }
 else {
    changed=(data.simState != state || data.subId != subId || data.slotId != slotId);
    data.simState=state;
    data.subId=subId;
    data.slotId=slotId;
  }
  if (changed && state != State.UNKNOWN) {
    for (int i=0; i < mCallbacks.size(); i++) {
      KeyguardUpdateMonitorCallback cb=mCallbacks.get(i).get();
      if (cb != null) {
        cb.onSimStateChanged(subId,slotId,state);
      }
    }
  }
}
