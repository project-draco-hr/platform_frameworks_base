{
  mMtpManager=new TestMtpManager(getContext()){
    @Override void openDevice(    int deviceId) throws IOException {
      throw new BusyDeviceException();
    }
  }
;
  setupProvider(MtpDatabaseConstants.FLAG_DATABASE_IN_MEMORY);
  mMtpManager.addValidDevice(new MtpDeviceRecord(0,"Device A",null,false,new MtpRoot[0],null,null));
  mProvider.resumeRootScanner();
  mResolver.waitForNotification(ROOTS_URI,1);
  try (final Cursor cursor=mProvider.queryRoots(null)){
    assertEquals(1,cursor.getCount());
  }
   try (final Cursor cursor=mProvider.queryChildDocuments("1",null,null)){
    assertEquals(0,cursor.getCount());
    assertEquals("error_busy_device",cursor.getExtras().getString(DocumentsContract.EXTRA_ERROR));
  }
 }
