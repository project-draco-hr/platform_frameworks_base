{
  final ContentResolver resolver=new ContentResolver();
  final MtpDocumentsProvider provider=new MtpDocumentsProvider();
  final MtpManagerMock mtpManager=new MtpManagerMock(getContext());
  mtpManager.addValidDevice(0);
  provider.onCreateForTesting(mtpManager,resolver);
  assertEquals(0,resolver.changeCount);
  provider.openDevice(0);
  assertEquals(1,resolver.changeCount);
  provider.closeDevice(0);
  assertEquals(2,resolver.changeCount);
  int exceptionCounter=0;
  try {
    provider.openDevice(1);
  }
 catch (  IOException error) {
    exceptionCounter++;
  }
  assertEquals(2,resolver.changeCount);
  try {
    provider.closeDevice(1);
  }
 catch (  IOException error) {
    exceptionCounter++;
  }
  assertEquals(2,resolver.changeCount);
  assertEquals(2,exceptionCounter);
}
