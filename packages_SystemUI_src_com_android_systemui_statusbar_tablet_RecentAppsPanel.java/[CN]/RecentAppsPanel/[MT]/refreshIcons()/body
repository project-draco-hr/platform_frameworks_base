{
  mRecentsContainer.removeAllViews();
  final Context context=getContext();
  final PackageManager pm=context.getPackageManager();
  final ActivityManager am=(ActivityManager)context.getSystemService(Context.ACTIVITY_SERVICE);
  final List<ActivityManager.RecentTaskInfo> recentTasks=am.getRecentTasks(MAX_RECENT_TASKS,ActivityManager.RECENT_IGNORE_UNAVAILABLE);
  ActivityInfo homeInfo=new Intent(Intent.ACTION_MAIN).addCategory(Intent.CATEGORY_HOME).resolveActivityInfo(pm,0);
  int numTasks=recentTasks.size();
  final int width=(int)(mDensity * ITEM_WIDTH + 0.5f);
  final int height=(int)(mDensity * ITEM_HEIGHT + 0.5f);
  ViewGroup.LayoutParams layoutParams=new ViewGroup.LayoutParams(width,height);
  for (int i=0; i < numTasks; ++i) {
    final ActivityManager.RecentTaskInfo info=recentTasks.get(i);
    Intent intent=new Intent(info.baseIntent);
    if (info.origActivity != null) {
      intent.setComponent(info.origActivity);
    }
    if (homeInfo != null && homeInfo.packageName.equals(intent.getComponent().getPackageName()) && homeInfo.name.equals(intent.getComponent().getClassName())) {
      continue;
    }
    intent.setFlags((intent.getFlags() & ~Intent.FLAG_ACTIVITY_RESET_TASK_IF_NEEDED) | Intent.FLAG_ACTIVITY_NEW_TASK);
    final ResolveInfo resolveInfo=pm.resolveActivity(intent,0);
    if (resolveInfo != null) {
      final ActivityInfo activityInfo=resolveInfo.activityInfo;
      final String title=activityInfo.loadLabel(pm).toString();
      Drawable icon=activityInfo.loadIcon(pm);
      if (title != null && title.length() > 0 && icon != null) {
        ImageView imageView=new ImageView(mContext);
        imageView.setScaleType(ImageView.ScaleType.FIT_XY);
        imageView.setLayoutParams(layoutParams);
        imageView.setOnClickListener(this);
        imageView.setTag(intent);
        imageView.setImageDrawable(icon);
        mRecentsContainer.addView(imageView);
      }
    }
  }
  int views=mRecentsContainer.getChildCount();
  mNoRecents.setVisibility(views == 0 ? View.VISIBLE : View.GONE);
  mRecentsContainer.setVisibility(views > 0 ? View.VISIBLE : View.GONE);
}
