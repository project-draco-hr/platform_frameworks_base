{
  String action=intent.getAction();
  if (action.equals(ConnectivityManager.CONNECTIVITY_ACTION)) {
    Bundle b=intent.getExtras();
    if (b != null) {
      NetworkInfo netInfo=(NetworkInfo)b.get(ConnectivityManager.EXTRA_NETWORK_INFO);
      String type=netInfo.getTypeName();
      NetworkInfo.State state=netInfo.getState();
      NetworkInfo activeNetInfo=getActiveNetworkInfo();
      if (DEBUG) {
        if (activeNetInfo != null) {
          Log.d(TAG,"active network: " + activeNetInfo.getTypeName() + ((activeNetInfo.getState() == NetworkInfo.State.CONNECTED) ? " CONNECTED" : " DISCONNECTED"));
        }
 else {
          Log.d(TAG,"active network: null");
        }
      }
      if ((state == NetworkInfo.State.CONNECTED) && (activeNetInfo != null) && (activeNetInfo.getType() != netInfo.getType())) {
        if (DEBUG)         Log.d(TAG,"ignore connect event: " + type + ", active: "+ activeNetInfo.getTypeName());
        return;
      }
      if (state == NetworkInfo.State.CONNECTED) {
        if (DEBUG)         Log.d(TAG,"Connectivity alert: CONNECTED " + type);
        onChanged(type,true);
      }
 else       if (state == NetworkInfo.State.DISCONNECTED) {
        if (DEBUG)         Log.d(TAG,"Connectivity alert: DISCONNECTED " + type);
        onChanged(type,false);
      }
 else {
        if (DEBUG)         Log.d(TAG,"Connectivity alert not processed: " + state + " "+ type);
      }
    }
  }
}
