{
  if (keys == null) {
    throw new NullPointerException("Provided keys cannot be null");
  }
  Set<Long> addedKeyIds=new HashSet<Long>(keys.size());
  for (  PublicKey k : keys) {
    long id=addPublicKeyLocked(k);
    addedKeyIds.add(id);
  }
  long existingKeySetId=getIdFromKeyIdsLocked(addedKeyIds);
  if (existingKeySetId != KEYSET_NOT_FOUND) {
    return mKeySets.get(existingKeySetId);
  }
  KeySet ks=new KeySet(new Binder());
  long id=getFreeKeySetIDLocked();
  mKeySets.put(id,ks);
  mKeySetMapping.put(id,addedKeyIds);
  return ks;
}
