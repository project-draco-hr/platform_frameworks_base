{
  if ((packageName == null) || (keys == null) || (alias == null)) {
    Log.e(TAG,"Got null argument for a defined keyset, ignoring!");
    return;
  }
synchronized (mLockObject) {
    KeySet ks=addKeySetLocked(keys);
    PackageSetting pkg=mPackages.get(packageName);
    if (pkg == null) {
      throw new NullPointerException("Unknown package");
    }
    long id=getIdByKeySetLocked(ks);
    pkg.keySetData.addDefinedKeySet(id,alias);
  }
}
