{
synchronized (mLockObject) {
    PackageSetting pkg=mPackages.get(packageName);
    if (pkg == null) {
      throw new NullPointerException("Invalid package name");
    }
    if (pkg.keySetData == null) {
      throw new NullPointerException("Package has no KeySet data");
    }
    long id=getIdByKeySetLocked(ks);
    return pkg.keySetData.packageIsSignedBy(id);
  }
}
