{
  if ((packageName == null) || (signingKeys == null)) {
    return;
  }
synchronized (mLockObject) {
    KeySet ks=addKeySetLocked(signingKeys);
    long id=getIdByKeySetLocked(ks);
    Set<Long> publicKeyIds=mKeySetMapping.get(id);
    if (publicKeyIds == null) {
      throw new NullPointerException("Got invalid KeySet id");
    }
    PackageSetting pkg=mPackages.get(packageName);
    if (pkg == null) {
      throw new NullPointerException("No such package!");
    }
    pkg.keySetData.addSigningKeySet(id);
    for (    Long keySetID : pkg.keySetData.getDefinedKeySets()) {
      Set<Long> definedKeys=mKeySetMapping.get(keySetID);
      if (publicKeyIds.contains(definedKeys)) {
        pkg.keySetData.addSigningKeySet(keySetID);
      }
    }
  }
}
