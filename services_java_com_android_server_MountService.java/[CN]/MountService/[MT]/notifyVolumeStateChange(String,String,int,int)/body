{
  String vs=getVolumeState(path);
  if (DEBUG_EVENTS)   Slog.i(TAG,"notifyVolumeStateChanged::" + vs);
  Intent in=null;
  if (oldState == VolumeState.Shared && newState != oldState) {
    if (LOCAL_LOGD)     Slog.d(TAG,"Sending ACTION_MEDIA_UNSHARED intent");
    mContext.sendBroadcast(new Intent(Intent.ACTION_MEDIA_UNSHARED,Uri.parse("file://" + path)));
  }
  if (newState == VolumeState.Init) {
  }
 else   if (newState == VolumeState.NoMedia) {
  }
 else   if (newState == VolumeState.Idle) {
    if (!vs.equals(Environment.MEDIA_BAD_REMOVAL) && !vs.equals(Environment.MEDIA_NOFS) && !vs.equals(Environment.MEDIA_UNMOUNTABLE)&& !getUmsEnabling()) {
      if (DEBUG_EVENTS)       Slog.i(TAG,"updating volume state for media bad removal nofs and unmountable");
      updatePublicVolumeState(path,Environment.MEDIA_UNMOUNTED);
      in=new Intent(Intent.ACTION_MEDIA_UNMOUNTED,Uri.parse("file://" + path));
    }
  }
 else   if (newState == VolumeState.Pending) {
  }
 else   if (newState == VolumeState.Checking) {
    if (DEBUG_EVENTS)     Slog.i(TAG,"updating volume state checking");
    updatePublicVolumeState(path,Environment.MEDIA_CHECKING);
    in=new Intent(Intent.ACTION_MEDIA_CHECKING,Uri.parse("file://" + path));
  }
 else   if (newState == VolumeState.Mounted) {
    if (DEBUG_EVENTS)     Slog.i(TAG,"updating volume state mounted");
    updatePublicVolumeState(path,Environment.MEDIA_MOUNTED);
    in=new Intent(Intent.ACTION_MEDIA_MOUNTED,Uri.parse("file://" + path));
    in.putExtra("read-only",false);
  }
 else   if (newState == VolumeState.Unmounting) {
    in=new Intent(Intent.ACTION_MEDIA_EJECT,Uri.parse("file://" + path));
  }
 else   if (newState == VolumeState.Formatting) {
  }
 else   if (newState == VolumeState.Shared) {
    if (DEBUG_EVENTS)     Slog.i(TAG,"Updating volume state media mounted");
    updatePublicVolumeState(path,Environment.MEDIA_UNMOUNTED);
    in=new Intent(Intent.ACTION_MEDIA_UNMOUNTED,Uri.parse("file://" + path));
    mContext.sendBroadcast(in);
    if (DEBUG_EVENTS)     Slog.i(TAG,"Updating media shared");
    updatePublicVolumeState(path,Environment.MEDIA_SHARED);
    in=new Intent(Intent.ACTION_MEDIA_SHARED,Uri.parse("file://" + path));
    if (LOCAL_LOGD)     Slog.d(TAG,"Sending ACTION_MEDIA_SHARED intent");
  }
 else   if (newState == VolumeState.SharedMnt) {
    Slog.e(TAG,"Live shared mounts not supported yet!");
    return;
  }
 else {
    Slog.e(TAG,"Unhandled VolumeState {" + newState + "}");
  }
  if (in != null) {
    mContext.sendBroadcast(in);
  }
}
