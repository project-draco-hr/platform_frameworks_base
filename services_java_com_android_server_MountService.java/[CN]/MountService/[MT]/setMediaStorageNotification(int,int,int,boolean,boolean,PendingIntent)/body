{
  if (!visible && mMediaStorageNotification == null) {
    return;
  }
  NotificationManager notificationManager=(NotificationManager)mContext.getSystemService(Context.NOTIFICATION_SERVICE);
  if (notificationManager == null) {
    return;
  }
  if (mMediaStorageNotification != null && visible) {
    final int notificationId=mMediaStorageNotification.icon;
    notificationManager.cancel(notificationId);
  }
  if (visible) {
    Resources r=Resources.getSystem();
    CharSequence title=r.getText(titleId);
    CharSequence message=r.getText(messageId);
    if (mMediaStorageNotification == null) {
      mMediaStorageNotification=new Notification();
      mMediaStorageNotification.when=0;
      if (mPlaySounds) {
        mMediaStorageNotification.defaults|=Notification.DEFAULT_SOUND;
      }
    }
    if (dismissable) {
      mMediaStorageNotification.flags=Notification.FLAG_AUTO_CANCEL;
    }
 else {
      mMediaStorageNotification.flags=Notification.FLAG_ONGOING_EVENT;
    }
    mMediaStorageNotification.tickerText=title;
    if (pi == null) {
      Intent intent=new Intent();
      pi=PendingIntent.getBroadcast(mContext,0,intent,0);
    }
    mMediaStorageNotification.icon=icon;
    mMediaStorageNotification.setLatestEventInfo(mContext,title,message,pi);
  }
  final int notificationId=mMediaStorageNotification.icon;
  if (visible) {
    notificationManager.notify(notificationId,mMediaStorageNotification);
  }
 else {
    notificationManager.cancel(notificationId);
  }
}
