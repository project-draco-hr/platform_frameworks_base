{
  validatePermission(android.Manifest.permission.MOUNT_UNMOUNT_FILESYSTEMS);
  if (!method.equals("ums")) {
    throw new IllegalArgumentException(String.format("Method %s not supported",method));
  }
  String vs=getVolumeState(path);
  if (enable && vs.equals(Environment.MEDIA_MOUNTED)) {
    mUmsEnabling=enable;
    unmountVolume(path);
    mUmsEnabling=false;
  }
  try {
    mConnector.doCommand(String.format("volume %sshare %s %s",(enable ? "" : "un"),path,method));
  }
 catch (  NativeDaemonConnectorException e) {
    Log.e(TAG,"Failed to share/unshare",e);
    return MountServiceResultCode.OperationFailedInternalError;
  }
  if (!enable) {
    if (mountVolume(path) != MountServiceResultCode.OperationSucceeded) {
      Log.e(TAG,String.format("Failed to remount %s after disabling share method %s",path,method));
    }
  }
  return MountServiceResultCode.OperationSucceeded;
}
