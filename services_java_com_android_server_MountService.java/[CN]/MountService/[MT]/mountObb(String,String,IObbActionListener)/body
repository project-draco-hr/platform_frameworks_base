{
  waitForReady();
  warnOnNotMounted();
  if (filename == null) {
    throw new IllegalArgumentException("filename cannot be null");
  }
 else   if (token == null) {
    throw new IllegalArgumentException("token cannot be null");
  }
  final ObbState obbState;
synchronized (mObbMounts) {
    if (isObbMounted(filename)) {
      try {
        token.onObbResult(filename,Environment.MEDIA_MOUNTED);
      }
 catch (      RemoteException e) {
        Slog.d(TAG,"Could not send unmount notification for: " + filename);
      }
      return;
    }
    final int callerUid=Binder.getCallingUid();
    final Integer uidUsage=mObbUidUsage.get(callerUid);
    if (uidUsage != null && uidUsage > MAX_OBBS) {
      throw new IllegalStateException("Maximum number of OBBs mounted!");
    }
    obbState=new ObbState(filename,token,callerUid);
    addObbState(obbState);
  }
  try {
    token.asBinder().linkToDeath(obbState,0);
  }
 catch (  RemoteException rex) {
    Slog.e(TAG,"Failed to link to listener death");
  }
  ObbAction action=new MountObbAction(obbState,key);
  mObbActionHandler.sendMessage(mObbActionHandler.obtainMessage(OBB_RUN_ACTION,action));
  if (DEBUG_OBB)   Slog.i(TAG,"Send to OBB handler: " + action.toString());
}
