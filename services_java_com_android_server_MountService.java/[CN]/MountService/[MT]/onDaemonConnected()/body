{
  new Thread(){
    @Override public void run(){
      try {
        final String[] vols=NativeDaemonEvent.filterMessageList(mConnector.executeForList("volume","list"),VoldResponseCode.VolumeListResult);
        for (        String volstr : vols) {
          String[] tok=volstr.split(" ");
          String path=tok[1];
          String state=Environment.MEDIA_REMOVED;
          int st=Integer.parseInt(tok[2]);
          if (st == VolumeState.NoMedia) {
            state=Environment.MEDIA_REMOVED;
          }
 else           if (st == VolumeState.Idle) {
            state=Environment.MEDIA_UNMOUNTED;
          }
 else           if (st == VolumeState.Mounted) {
            state=Environment.MEDIA_MOUNTED;
            Slog.i(TAG,"Media already mounted on daemon connection");
          }
 else           if (st == VolumeState.Shared) {
            state=Environment.MEDIA_SHARED;
            Slog.i(TAG,"Media shared on daemon connection");
          }
 else {
            throw new Exception(String.format("Unexpected state %d",st));
          }
          if (state != null) {
            if (DEBUG_EVENTS)             Slog.i(TAG,"Updating valid state " + state);
            updatePublicVolumeState(path,state);
          }
        }
      }
 catch (      Exception e) {
        Slog.e(TAG,"Error processing initial volume state",e);
        updatePublicVolumeState(mExternalStoragePath,Environment.MEDIA_REMOVED);
      }
      mReady=true;
    }
  }
.start();
}
