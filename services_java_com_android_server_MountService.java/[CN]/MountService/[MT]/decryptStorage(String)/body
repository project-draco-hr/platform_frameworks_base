{
  if (TextUtils.isEmpty(password)) {
    throw new IllegalArgumentException("password cannot be empty");
  }
  mContext.enforceCallingOrSelfPermission(Manifest.permission.CRYPT_KEEPER,"no permission to access the crypt keeper");
  waitForReady();
  if (DEBUG_EVENTS) {
    Slog.i(TAG,"decrypting storage...");
  }
  final NativeDaemonEvent event;
  try {
    event=mConnector.execute("cryptfs","checkpw",password);
    final int code=event.getCode();
    if (code == 0) {
      mHandler.postDelayed(new Runnable(){
        public void run(){
          try {
            mConnector.execute("cryptfs","restart");
          }
 catch (          NativeDaemonConnectorException e) {
            Slog.e(TAG,"problem executing in background",e);
          }
        }
      }
,1000);
    }
    return code;
  }
 catch (  NativeDaemonConnectorException e) {
    return e.getCode();
  }
}
