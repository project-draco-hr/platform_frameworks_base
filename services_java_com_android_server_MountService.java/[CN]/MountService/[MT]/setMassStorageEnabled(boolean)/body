{
  if (mContext.checkCallingOrSelfPermission(android.Manifest.permission.MOUNT_UNMOUNT_FILESYSTEMS) != PackageManager.PERMISSION_GRANTED) {
    throw new SecurityException("Requires MOUNT_UNMOUNT_FILESYSTEMS permission");
  }
  try {
    String vp=Environment.getExternalStorageDirectory().getPath();
    String vs=getVolumeState(vp);
    mUmsEnabling=enable;
    if (enable && vs.equals(Environment.MEDIA_MOUNTED)) {
      unmountVolume(vp);
      mUmsEnabling=false;
      updateUsbMassStorageNotification(true,false);
    }
    setShareMethodEnabled(vp,"ums",enable);
    mUmsEnabled=enable;
    mUmsEnabling=false;
    if (!enable) {
      mountVolume(vp);
      if (mPromptUms) {
        updateUsbMassStorageNotification(false,false);
      }
 else {
        updateUsbMassStorageNotification(true,false);
      }
    }
  }
 catch (  IllegalStateException rex) {
    Log.e(TAG,"Failed to set ums enable {" + enable + "}");
    return;
  }
}
