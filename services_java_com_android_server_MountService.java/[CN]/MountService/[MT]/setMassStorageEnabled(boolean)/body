{
  if (mContext.checkCallingOrSelfPermission(android.Manifest.permission.MOUNT_UNMOUNT_FILESYSTEMS) != PackageManager.PERMISSION_GRANTED) {
    throw new SecurityException("Requires MOUNT_UNMOUNT_FILESYSTEMS permission");
  }
  try {
    String vp=Environment.getExternalStorageDirectory().getPath();
    String vs=getVolumeState(vp);
    if (enable && vs.equals(Environment.MEDIA_MOUNTED)) {
      mListener.unmountVolume(vp);
      updateUsbMassStorageNotification(true,false);
    }
    mListener.setShareMethodEnabled(Environment.getExternalStorageDirectory().getPath(),"ums",enable);
    mUmsEnabled=enable;
    if (!enable) {
      mountMedia(vp);
      if (mPromptUms) {
        updateUsbMassStorageNotification(false,false);
      }
 else {
        updateUsbMassStorageNotification(true,false);
      }
    }
  }
 catch (  IllegalStateException rex) {
    Log.e(TAG,"Failed to set ums enable {" + enable + "}");
    return;
  }
}
