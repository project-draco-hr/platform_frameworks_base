{
  try {
    String vp=Environment.getExternalStorageDirectory().getPath();
    String vs=getVolumeState(vp);
    if (enable && vs.equals(Environment.MEDIA_MOUNTED)) {
      Log.d(TAG,"Unmounting media before UMS enable");
      unmountMedia(vp);
    }
    mListener.setShareMethodEnabled(Environment.getExternalStorageDirectory().getPath(),"ums",enable);
    mUmsEnabled=enable;
    if (!enable) {
      Log.d(TAG,"Mounting media after UMS disable");
      mountMedia(vp);
    }
  }
 catch (  IllegalStateException rex) {
    Log.e(TAG,"Failed to set ums enable {" + enable + "}");
    return;
  }
}
