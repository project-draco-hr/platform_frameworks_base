{
  ObbInfo obbInfo=mContainerService.getObbInfo(mObbState.filename);
  if (obbInfo == null) {
    throw new IOException("Couldn't read OBB file");
  }
  if (!isCallerOwnerOfPackageOrSystem(obbInfo.packageName)) {
    throw new IllegalArgumentException("Caller package does not match OBB file");
  }
  int rc=StorageResultCode.OperationSucceeded;
  String cmd=String.format("obb unmount %s%s",mObbState.filename,(mForceUnmount ? " force" : ""));
  try {
    mConnector.doCommand(cmd);
  }
 catch (  NativeDaemonConnectorException e) {
    int code=e.getCode();
    if (code == VoldResponseCode.OpFailedStorageBusy) {
      rc=StorageResultCode.OperationFailedStorageBusy;
    }
 else {
      rc=StorageResultCode.OperationFailedInternalError;
    }
  }
  if (rc == StorageResultCode.OperationSucceeded) {
    removeObbState(mObbState);
    try {
      mObbState.token.onObbResult(mObbState.filename,Environment.MEDIA_UNMOUNTED);
    }
 catch (    RemoteException e) {
      Slog.w(TAG,"MountServiceListener went away while calling onObbStateChanged");
    }
  }
 else {
    try {
      mObbState.token.onObbResult(mObbState.filename,Environment.MEDIA_BAD_REMOVAL);
    }
 catch (    RemoteException e) {
      Slog.w(TAG,"MountServiceListener went away while calling onObbStateChanged");
    }
  }
}
