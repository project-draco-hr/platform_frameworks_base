{
  String mainDir;
  String filesDir;
  String dbDir;
  String spDir;
  String cacheDir;
  String libDir;
  ApplicationInfo appInfo=getApplicationInfo();
  mainDir=new File(appInfo.dataDir).getAbsolutePath();
  filesDir=getFilesDir().getAbsolutePath();
  dbDir=getDatabasePath("foo").getParentFile().getAbsolutePath();
  spDir=getSharedPrefsFile("foo").getParentFile().getAbsolutePath();
  cacheDir=getCacheDir().getAbsolutePath();
  libDir=(appInfo.nativeLibraryDir == null) ? null : new File(appInfo.nativeLibraryDir).getAbsolutePath();
  String filePath=file.getAbsolutePath();
  if (filePath.startsWith(cacheDir) || filePath.startsWith(libDir)) {
    Log.w(TAG,"lib and cache files are not backed up");
    return;
  }
  final String domain;
  String rootpath=null;
  if (filePath.startsWith(dbDir)) {
    domain=FullBackup.DATABASE_TREE_TOKEN;
    rootpath=dbDir;
  }
 else   if (filePath.startsWith(spDir)) {
    domain=FullBackup.SHAREDPREFS_TREE_TOKEN;
    rootpath=spDir;
  }
 else   if (filePath.startsWith(filesDir)) {
    domain=FullBackup.DATA_TREE_TOKEN;
    rootpath=filesDir;
  }
 else   if (filePath.startsWith(mainDir)) {
    domain=FullBackup.ROOT_TREE_TOKEN;
    rootpath=mainDir;
  }
 else {
    Log.w(TAG,"File " + filePath + " is in an unsupported location; skipping");
    return;
  }
  Log.i(TAG,"backupFile() of " + filePath + " => domain="+ domain+ " rootpath="+ rootpath);
  FullBackup.backupToTar(getPackageName(),domain,null,rootpath,filePath,output.getData());
}
