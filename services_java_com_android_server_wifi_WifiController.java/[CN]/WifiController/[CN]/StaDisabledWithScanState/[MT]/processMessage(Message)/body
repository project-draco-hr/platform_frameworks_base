{
switch (msg.what) {
case CMD_WIFI_TOGGLED:
    if (mSettingsStore.isWifiToggleEnabled()) {
      if (doDeferEnable(msg)) {
        if (mHaveDeferredEnable) {
          mDeferredEnableSerialNumber++;
        }
        mHaveDeferredEnable=!mHaveDeferredEnable;
        break;
      }
      if (mDeviceIdle == false) {
        transitionTo(mDeviceActiveState);
      }
 else {
        checkLocksAndTransitionWhenDeviceIdle();
      }
    }
  break;
case CMD_AIRPLANE_TOGGLED:
if (mSettingsStore.isAirplaneModeOn() && !mSettingsStore.isWifiToggleEnabled()) {
  transitionTo(mApStaDisabledState);
}
case CMD_SCAN_ALWAYS_MODE_CHANGED:
if (!mSettingsStore.isScanAlwaysAvailable()) {
transitionTo(mApStaDisabledState);
}
break;
case CMD_SET_AP:
if (msg.arg1 == 1) {
deferMessage(msg);
transitionTo(mApStaDisabledState);
}
break;
case CMD_DEFERRED_TOGGLE:
if (msg.arg1 != mDeferredEnableSerialNumber) break;
sendMessage((Message)(msg.obj));
break;
default :
return NOT_HANDLED;
}
return HANDLED;
}
