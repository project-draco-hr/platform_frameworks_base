{
  if (mAttributes == null) {
    mAttributes=new AudioAttributes.Builder().setUsage(AudioAttributes.USAGE_MEDIA).build();
  }
  if (mFormat == null) {
    mFormat=new AudioFormat.Builder().setChannelMask(AudioFormat.CHANNEL_OUT_STEREO).setSampleRate(AudioSystem.getPrimaryOutputSamplingRate()).setEncoding(AudioFormat.ENCODING_DEFAULT).build();
  }
  try {
    if (mMode == MODE_STREAM && mBufferSizeInBytes == 0) {
      mBufferSizeInBytes=mFormat.getChannelCount() * mFormat.getBytesPerSample(mFormat.getEncoding());
    }
    return new AudioTrack(mAttributes,mFormat,mBufferSizeInBytes,mMode,mSessionId);
  }
 catch (  IllegalArgumentException e) {
    throw new UnsupportedOperationException(e.getMessage());
  }
}
