{
  if (DEBUG)   Slog.v(TAG,"loadSettingsLocked");
  JournaledFile journal=makeJournaledFile();
  FileInputStream stream=null;
  File file=journal.chooseForRead();
  boolean success=false;
  try {
    stream=new FileInputStream(file);
    XmlPullParser parser=Xml.newPullParser();
    parser.setInput(stream,null);
    int type;
    do {
      type=parser.next();
      if (type == XmlPullParser.START_TAG) {
        String tag=parser.getName();
        if ("wp".equals(tag)) {
          mWidth=Integer.parseInt(parser.getAttributeValue(null,"width"));
          mHeight=Integer.parseInt(parser.getAttributeValue(null,"height"));
          mName=parser.getAttributeValue(null,"name");
          String comp=parser.getAttributeValue(null,"component");
          mNextWallpaperComponent=comp != null ? ComponentName.unflattenFromString(comp) : null;
          if (mNextWallpaperComponent == null || "android".equals(mNextWallpaperComponent.getPackageName())) {
            mNextWallpaperComponent=mImageWallpaperComponent;
          }
          if (DEBUG) {
            Slog.v(TAG,"mWidth:" + mWidth);
            Slog.v(TAG,"mHeight:" + mHeight);
            Slog.v(TAG,"mName:" + mName);
            Slog.v(TAG,"mNextWallpaperComponent:" + mNextWallpaperComponent);
          }
        }
      }
    }
 while (type != XmlPullParser.END_DOCUMENT);
    success=true;
  }
 catch (  NullPointerException e) {
    Slog.w(TAG,"failed parsing " + file + " "+ e);
  }
catch (  NumberFormatException e) {
    Slog.w(TAG,"failed parsing " + file + " "+ e);
  }
catch (  XmlPullParserException e) {
    Slog.w(TAG,"failed parsing " + file + " "+ e);
  }
catch (  IOException e) {
    Slog.w(TAG,"failed parsing " + file + " "+ e);
  }
catch (  IndexOutOfBoundsException e) {
    Slog.w(TAG,"failed parsing " + file + " "+ e);
  }
  try {
    if (stream != null) {
      stream.close();
    }
  }
 catch (  IOException e) {
  }
  if (!success) {
    mWidth=-1;
    mHeight=-1;
    mName="";
  }
  WindowManager wm=(WindowManager)mContext.getSystemService(Context.WINDOW_SERVICE);
  Display d=wm.getDefaultDisplay();
  int baseSize=d.getMaximumSizeDimension();
  if (mWidth < baseSize) {
    mWidth=baseSize;
  }
  if (mHeight < baseSize) {
    mHeight=baseSize;
  }
}
