{
  checkPermission(android.Manifest.permission.SET_WALLPAPER_HINTS);
synchronized (mLock) {
    int userId=UserHandle.getCallingUserId();
    WallpaperData wallpaper=mWallpaperMap.get(userId);
    if (wallpaper == null) {
      throw new IllegalStateException("Wallpaper not yet initialized for user " + userId);
    }
    if (width <= 0 || height <= 0) {
      throw new IllegalArgumentException("width and height must be > 0");
    }
    if (width != wallpaper.width || height != wallpaper.height) {
      wallpaper.width=width;
      wallpaper.height=height;
      saveSettingsLocked(wallpaper);
      if (mCurrentUserId != userId)       return;
      if (wallpaper.connection != null) {
        if (wallpaper.connection.mEngine != null) {
          try {
            wallpaper.connection.mEngine.setDesiredSize(width,height);
          }
 catch (          RemoteException e) {
          }
          notifyCallbacksLocked(wallpaper);
        }
 else         if (wallpaper.connection.mService != null) {
          wallpaper.connection.mDimensionsChanged=true;
        }
      }
    }
  }
}
