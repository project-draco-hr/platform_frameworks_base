{
  if (DEBUG)   Slog.v(TAG,"setWallpaperComponent name=" + name);
  int userId=UserId.getCallingUserId();
  WallpaperData wallpaper=mWallpaperMap.get(userId);
  if (wallpaper == null) {
    throw new IllegalStateException("Wallpaper not yet initialized for user " + userId);
  }
  checkPermission(android.Manifest.permission.SET_WALLPAPER_COMPONENT);
synchronized (mLock) {
    final long ident=Binder.clearCallingIdentity();
    try {
      wallpaper.imageWallpaperPending=false;
      bindWallpaperComponentLocked(name,false,true,wallpaper);
    }
  finally {
      Binder.restoreCallingIdentity(ident);
    }
  }
}
