{
  int subDevices=nativeGetSubdeviceCount(card,device);
  if (subDevices <= 0) {
    Log.e(TAG,"nativeGetSubdeviceCount failed");
    return null;
  }
  FileDescriptor[] fileDescriptors=nativeOpen(card,device,subDevices);
  if (fileDescriptors == null) {
    Log.e(TAG,"nativeOpen failed");
    return null;
  }
  UsbMidiDevice midiDevice=new UsbMidiDevice(fileDescriptors,fileDescriptors);
  if (!midiDevice.register(context,properties)) {
    IoUtils.closeQuietly(midiDevice);
    Log.e(TAG,"createDeviceServer failed");
    return null;
  }
  return midiDevice;
}
