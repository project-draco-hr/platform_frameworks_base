{
  boolean isCdmaPhone=(TelephonyManager.getDefault().getPhoneType() == TelephonyManager.PHONE_TYPE_CDMA);
  String text1="123456789012345678901234567890123456789012345678901234567890" + "1234567890123456789012345678901234567890123456789012345678901234567890" + "12345678901234567890123456789[";
  TextEncodingDetails ted=SmsMessage.calculateLength(text1,false);
  assertEquals(ted.msgCount,1);
  assertEquals(ted.codeUnitCount,160);
  assertEquals(ted.codeUnitSize,1);
  if (isCdmaPhone) {
    ArrayList<String> fragments=android.telephony.SmsMessage.fragmentText(text1);
    assertEquals(fragments.size(),1);
  }
  String text2="123456789012345678901234567890123456789012345678901234567890" + "1234567890123456789012345678901234567890123456789012345678901234567890" + "12345678901234567890123456789\u00a3";
  ted=SmsMessage.calculateLength(text2,false);
  assertEquals(3,ted.msgCount);
  assertEquals(160,ted.codeUnitCount);
  assertEquals(3,ted.codeUnitSize);
  if (isCdmaPhone) {
    ArrayList<String> fragments=android.telephony.SmsMessage.fragmentText(text2);
    assertEquals(3,fragments.size());
    for (int i=0; i < 3; i++) {
      encodeDecodeAssertEquals(fragments.get(i),i + 1,3,false);
      encodeDecodeAssertEquals(fragments.get(i),i + 1,3,true);
    }
  }
  String text3=sUnicodeChars + sUnicodeChars + sUnicodeChars;
  ted=SmsMessage.calculateLength(text3,false);
  assertEquals(3,ted.msgCount);
  assertEquals(189,ted.codeUnitCount);
  assertEquals(3,ted.codeUnitSize);
  if (isCdmaPhone) {
    ArrayList<String> fragments=android.telephony.SmsMessage.fragmentText(text3);
    assertEquals(3,fragments.size());
    for (int i=0; i < 3; i++) {
      encodeDecodeAssertEquals(fragments.get(i),i + 1,3,false);
      encodeDecodeAssertEquals(fragments.get(i),i + 1,3,true);
    }
  }
}
