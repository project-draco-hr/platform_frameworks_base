{
  state.line=line;
  int len=state.line.length();
  char c=0;
  for (state.index=0; state.index < len; ++state.index) {
    c=line.charAt(state.index);
    if (c == ';' || c == ':') {
      break;
    }
  }
  String name=line.substring(0,state.index);
  if (component == null) {
    if (!Component.BEGIN.equals(name)) {
      throw new FormatException("Expected BEGIN");
    }
  }
  Property property;
  if (Component.BEGIN.equals(name)) {
    String componentName=extractValue(state);
    Component child=new Component(componentName,component);
    if (component != null) {
      component.addChild(child);
    }
    return child;
  }
 else   if (Component.END.equals(name)) {
    String componentName=extractValue(state);
    if (component == null || !componentName.equals(component.getName())) {
      throw new FormatException("Unexpected END " + componentName);
    }
    return component.getParent();
  }
 else {
    property=new Property(name);
  }
  if (c == ';') {
    Parameter parameter=null;
    while ((parameter=extractParameter(state)) != null) {
      property.addParameter(parameter);
    }
  }
  String value=extractValue(state);
  property.setValue(value);
  component.addProperty(property);
  return component;
}
