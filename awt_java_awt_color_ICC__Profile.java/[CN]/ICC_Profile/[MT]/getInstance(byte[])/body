{
  ICC_Profile res=null;
  try {
    res=new ICC_Profile(data);
  }
 catch (  CMMException e) {
    throw new IllegalArgumentException(Messages.getString("awt.162"));
  }
  if (System.getProperty("os.name").toLowerCase().indexOf("windows") >= 0) {
    try {
      if (res.getColorSpaceType() == ColorSpace.TYPE_RGB && res.getDataSize(icSigMediaWhitePointTag) > 0 && res.getDataSize(icSigRedColorantTag) > 0 && res.getDataSize(icSigGreenColorantTag) > 0 && res.getDataSize(icSigBlueColorantTag) > 0 && res.getDataSize(icSigRedTRCTag) > 0 && res.getDataSize(icSigGreenTRCTag) > 0 && res.getDataSize(icSigBlueTRCTag) > 0) {
        res=new ICC_ProfileRGB(res.getProfileHandle());
      }
 else       if (res.getColorSpaceType() == ColorSpace.TYPE_GRAY && res.getDataSize(icSigMediaWhitePointTag) > 0 && res.getDataSize(icSigGrayTRCTag) > 0) {
        res=new ICC_ProfileGray(res.getProfileHandle());
      }
    }
 catch (    CMMException e) {
    }
  }
  return res;
}
