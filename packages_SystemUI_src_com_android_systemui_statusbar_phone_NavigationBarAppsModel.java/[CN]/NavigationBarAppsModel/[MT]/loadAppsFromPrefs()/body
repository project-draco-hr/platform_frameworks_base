{
  UserManager mUserManager=(UserManager)mContext.getSystemService(Context.USER_SERVICE);
  boolean hadUnlauncheableApps=false;
  int appCount=mPrefs.getInt(userPrefixed(APP_COUNT_PREF),-1);
  for (int i=0; i < appCount; i++) {
    String prefValue=mPrefs.getString(prefNameForApp(i),null);
    if (prefValue == null) {
      Slog.w(TAG,"Couldn't find pref " + prefNameForApp(i));
      continue;
    }
    ComponentName componentName=ComponentName.unflattenFromString(prefValue);
    long userSerialNumber=mPrefs.getLong(prefUserForApp(i),-1);
    if (userSerialNumber == -1) {
      Slog.w(TAG,"Couldn't find pref " + prefUserForApp(i));
      continue;
    }
    UserHandle appUser=mUserManager.getUserForSerialNumber(userSerialNumber);
    AppInfo appInfo=new AppInfo(componentName,appUser);
    if (appUser != null && buildAppLaunchIntent(appInfo) != null) {
      mApps.add(appInfo);
    }
 else {
      hadUnlauncheableApps=true;
    }
  }
  if (hadUnlauncheableApps)   savePrefs();
}
