{
  int total=pkgs.size();
  int skipped=0;
  for (Iterator<PackageParser.Package> i=pkgs.iterator(); i.hasNext(); ) {
    PackageParser.Package pkg=i.next();
    long then=pkg.getLatestForegroundPackageUseTimeInMills();
    if (then < estimatedPreviousSystemUseTime - dexOptLRUThresholdInMills) {
      if (DEBUG_DEXOPT) {
        Log.i(TAG,"Skipping dexopt of " + pkg.packageName + " last used in foreground: "+ ((then == 0) ? "never" : new Date(then)));
      }
      i.remove();
      skipped++;
    }
 else {
      if (DEBUG_DEXOPT) {
        Log.i(TAG,"Will dexopt " + pkg.packageName + " last used in foreground: "+ ((then == 0) ? "never" : new Date(then)));
      }
    }
  }
  if (DEBUG_DEXOPT) {
    Log.i(TAG,"Skipped dexopt " + skipped + " of "+ total);
  }
}
