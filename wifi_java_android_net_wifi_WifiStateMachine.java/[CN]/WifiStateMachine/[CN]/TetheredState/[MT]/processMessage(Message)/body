{
  if (DBG)   log(getName() + message.toString() + "\n");
switch (message.what) {
case CMD_TETHER_STATE_CHANGE:
    TetherStateChange stateChange=(TetherStateChange)message.obj;
  if (!isWifiTethered(stateChange.active)) {
    loge("Tethering reports wifi as untethered!, shut down soft Ap");
    setWifiApEnabled(null,false);
    setWifiApEnabled(null,true);
  }
return HANDLED;
case CMD_STOP_AP:
if (DBG) log("Untethering before stopping AP");
setWifiApState(WIFI_AP_STATE_DISABLING);
stopTethering();
transitionTo(mSoftApStoppingState);
break;
default :
return NOT_HANDLED;
}
return HANDLED;
}
