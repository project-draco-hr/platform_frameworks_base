{
  if (DBG)   log(getName() + message.toString() + "\n");
switch (message.what) {
case CMD_STOP_AP:
    if (DBG)     log("Stopping Soft AP");
  setWifiApState(WIFI_AP_STATE_DISABLING);
try {
  mNwService.stopAccessPoint(mInterfaceName);
}
 catch (Exception e) {
  loge("Exception in stopAccessPoint()");
}
transitionTo(mDriverLoadedState);
break;
case CMD_START_AP:
break;
case CMD_START_SUPPLICANT:
loge("Cannot start supplicant with a running soft AP");
setWifiState(WIFI_STATE_UNKNOWN);
break;
case CMD_TETHER_STATE_CHANGE:
TetherStateChange stateChange=(TetherStateChange)message.obj;
if (startTethering(stateChange.available)) {
transitionTo(mTetheringState);
}
break;
case WifiP2pService.P2P_ENABLE_PENDING:
setWifiApEnabled(null,false);
deferMessage(message);
break;
default :
return NOT_HANDLED;
}
EventLog.writeEvent(EVENTLOG_WIFI_EVENT_HANDLED,message.what);
return HANDLED;
}
