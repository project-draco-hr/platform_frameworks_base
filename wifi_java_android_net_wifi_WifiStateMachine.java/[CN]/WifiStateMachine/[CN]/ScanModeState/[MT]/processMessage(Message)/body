{
switch (message.what) {
case CMD_SET_OPERATIONAL_MODE:
    if (message.arg1 == CONNECT_MODE) {
      if (mLastOperationMode == SCAN_ONLY_WITH_WIFI_OFF_MODE) {
        setWifiState(WIFI_STATE_ENABLED);
        mWifiConfigStore.loadAndEnableAllNetworks();
        mWifiP2pChannel.sendMessage(CMD_ENABLE_P2P);
      }
 else {
        mWifiConfigStore.enableAllNetworks();
      }
      mWifiNative.reconnect();
      mOperationalMode=CONNECT_MODE;
      transitionTo(mDisconnectedState);
    }
 else {
      return HANDLED;
    }
  break;
case CMD_START_SCAN:
noteScanStart(message.arg1,(WorkSource)message.obj);
startScanNative(WifiNative.SCAN_WITHOUT_CONNECTION_SETUP);
break;
default :
return NOT_HANDLED;
}
return HANDLED;
}
