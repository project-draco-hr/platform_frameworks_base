{
  if (DBG)   Log.d(TAG,getName() + "\n");
  EventLog.writeEvent(EVENTLOG_WIFI_STATE_CHANGED,getName());
  mIsRunning=true;
  updateBatteryWorkSource(null);
  setNumAllowedChannels();
  WifiNative.setBandCommand(BAND_2G);
  if (mIsScanMode) {
    WifiNative.setScanResultHandlingCommand(SCAN_ONLY_MODE);
    WifiNative.disconnectCommand();
    transitionTo(mScanModeState);
  }
 else {
    WifiNative.setScanResultHandlingCommand(CONNECT_MODE);
    WifiNative.reconnectCommand();
    transitionTo(mConnectModeState);
  }
}
