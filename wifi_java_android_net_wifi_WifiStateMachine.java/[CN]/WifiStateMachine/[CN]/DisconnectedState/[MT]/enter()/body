{
  if (DBG)   log(getName() + "\n");
  EventLog.writeEvent(EVENTLOG_WIFI_STATE_CHANGED,getName());
  mFrameworkScanIntervalMs=Settings.Global.getLong(mContext.getContentResolver(),Settings.Global.WIFI_FRAMEWORK_SCAN_INTERVAL_MS,mDefaultFrameworkScanIntervalMs);
  if (mEnableBackgroundScan) {
    if (!mScanResultIsPending) {
      mWifiNative.enableBackgroundScan(true);
    }
  }
 else {
    setScanAlarm(true);
  }
  if (mWifiConfigStore.getConfiguredNetworks().size() == 0) {
    sendMessageDelayed(obtainMessage(CMD_NO_NETWORKS_PERIODIC_SCAN,++mPeriodicScanToken,0),mSupplicantScanIntervalMs);
  }
}
