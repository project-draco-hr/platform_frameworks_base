{
  double w=options.outWidth;
  double h=options.outHeight;
  int lowerBound=(maxNumOfPixels == UNCONSTRAINED) ? 1 : (int)Math.ceil(Math.sqrt(w * h / maxNumOfPixels));
  int upperBound=(minSideLength == UNCONSTRAINED) ? 128 : (int)Math.min(Math.floor(w / minSideLength),Math.floor(h / minSideLength));
  if (upperBound < lowerBound) {
    return lowerBound;
  }
  if ((maxNumOfPixels == UNCONSTRAINED) && (minSideLength == UNCONSTRAINED)) {
    return 1;
  }
 else   if (minSideLength == UNCONSTRAINED) {
    return lowerBound;
  }
 else {
    return upperBound;
  }
}
