{
  if (DEBUG)   Log.d(TAG,"showSecurityScreen(" + securityMode + ")");
  if (securityMode == mCurrentSecuritySelection)   return;
  KeyguardSecurityView oldView=getSecurityView(mCurrentSecuritySelection);
  KeyguardSecurityView newView=getSecurityView(securityMode);
  boolean fullScreenEnabled=getResources().getBoolean(R.bool.kg_sim_puk_account_full_screen);
  boolean isSimOrAccount=securityMode == SecurityMode.SimPin || securityMode == SecurityMode.SimPuk || securityMode == SecurityMode.Account;
  mAppWidgetContainer.setVisibility(isSimOrAccount && fullScreenEnabled ? View.GONE : View.VISIBLE);
  if (mSlidingChallengeLayout != null) {
    mSlidingChallengeLayout.setChallengeInteractive(!fullScreenEnabled);
  }
  if (oldView != null) {
    oldView.onPause();
    oldView.setKeyguardCallback(mNullCallback);
  }
  newView.onResume(KeyguardSecurityView.VIEW_REVEALED);
  newView.setKeyguardCallback(mCallback);
  final boolean needsInput=newView.needsInput();
  if (mViewMediatorCallback != null) {
    mViewMediatorCallback.setNeedsInput(needsInput);
  }
  final int childCount=mSecurityViewContainer.getChildCount();
  final int securityViewIdForMode=getSecurityViewIdForMode(securityMode);
  for (int i=0; i < childCount; i++) {
    if (mSecurityViewContainer.getChildAt(i).getId() == securityViewIdForMode) {
      mSecurityViewContainer.setDisplayedChild(i);
      break;
    }
  }
  if (securityMode == SecurityMode.None) {
    setOnDismissAction(null);
  }
  if (securityMode == SecurityMode.Account && !mLockPatternUtils.isPermanentlyLocked()) {
    setBackButtonEnabled(true);
  }
  mCurrentSecuritySelection=securityMode;
}
