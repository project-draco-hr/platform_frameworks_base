{
  if (DEBUG)   Log.d(TAG,"showNextSecurityScreenOrFinish(" + authenticated + ")");
  boolean finish=false;
  if (SecurityMode.None == mCurrentSecuritySelection) {
    SecurityMode securityMode=mSecurityModel.getSecurityMode();
    securityMode=mSecurityModel.getAlternateFor(securityMode);
    if (SecurityMode.None == securityMode) {
      finish=true;
    }
 else {
      showSecurityScreen(securityMode);
    }
  }
 else   if (authenticated) {
switch (mCurrentSecuritySelection) {
case Pattern:
case Password:
case PIN:
case Account:
case Biometric:
      finish=true;
    break;
case SimPin:
case SimPuk:
  SecurityMode securityMode=mSecurityModel.getSecurityMode();
if (securityMode != SecurityMode.None) {
  showSecurityScreen(securityMode);
}
 else {
  finish=true;
}
break;
default :
Log.v(TAG,"Bad security screen " + mCurrentSecuritySelection + ", fail safe");
showPrimarySecurityScreen(false);
break;
}
}
 else {
showPrimarySecurityScreen(false);
}
if (finish) {
KeyguardUpdateMonitor.getInstance(mContext).setAlternateUnlockEnabled(true);
if (shouldRunHotwordInSecurityMode(mCurrentSecuritySelection)) {
maybeStopHotwordDetector();
}
boolean deferKeyguardDone=false;
if (mDismissAction != null) {
deferKeyguardDone=mDismissAction.onDismiss();
mDismissAction=null;
}
if (mViewMediatorCallback != null) {
if (deferKeyguardDone) {
mViewMediatorCallback.keyguardDonePending();
}
 else {
mViewMediatorCallback.keyguardDone(true);
}
}
}
 else {
mViewStateManager.showBouncer(true);
}
}
