{
  String firstPackage="first";
  String secondPackage="second";
  String thirdPackage="third";
  WebViewProviderInfo[] packages=new WebViewProviderInfo[]{new WebViewProviderInfo(firstPackage,"",true,false,null),new WebViewProviderInfo(secondPackage,"",true,false,null),new WebViewProviderInfo(thirdPackage,"",true,false,null)};
  setupWithPackages(packages);
  setEnabledAndValidPackageInfos(packages);
  mTestSystemImpl.updateUserSetting(null,thirdPackage);
  mWebViewUpdateServiceImpl.prepareWebViewInSystemServer();
  checkPreparationPhasesForPackage(thirdPackage,1);
  mTestSystemImpl.setPackageInfo(createPackageInfo(secondPackage,true,false,true));
  assertEquals(firstPackage,mWebViewUpdateServiceImpl.changeProviderAndSetting(secondPackage));
  checkPreparationPhasesForPackage(firstPackage,1);
  Mockito.verify(mTestSystemImpl).killPackageDependents(Mockito.eq(thirdPackage));
}
