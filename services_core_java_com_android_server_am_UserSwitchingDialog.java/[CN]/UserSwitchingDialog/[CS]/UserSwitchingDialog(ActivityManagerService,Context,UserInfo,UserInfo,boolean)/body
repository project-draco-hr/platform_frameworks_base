{
  super(context);
  mService=service;
  mUserId=newUser.id;
  setCancelable(false);
  Resources res=getContext().getResources();
  View view=LayoutInflater.from(getContext()).inflate(R.layout.user_switching_dialog,null);
  String viewMessage;
  if (UserManager.isSplitSystemUser() && newUser.id == UserHandle.USER_SYSTEM) {
    viewMessage=res.getString(R.string.user_logging_out_message,oldUser.name);
  }
 else {
    viewMessage=res.getString(R.string.user_switching_message,newUser.name);
  }
  ((TextView)view.findViewById(R.id.message)).setText(viewMessage);
  setView(view);
  if (aboveSystem) {
    getWindow().setType(WindowManager.LayoutParams.TYPE_SYSTEM_ERROR);
  }
  WindowManager.LayoutParams attrs=getWindow().getAttributes();
  attrs.privateFlags=WindowManager.LayoutParams.PRIVATE_FLAG_SYSTEM_ERROR | WindowManager.LayoutParams.PRIVATE_FLAG_SHOW_FOR_ALL_USERS;
  getWindow().setAttributes(attrs);
}
