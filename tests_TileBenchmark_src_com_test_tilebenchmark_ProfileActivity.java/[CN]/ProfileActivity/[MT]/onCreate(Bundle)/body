{
  super.onCreate(savedInstanceState);
  setContentView(R.layout.main);
  mInspectButton=(Button)findViewById(R.id.inspect);
  mCaptureButton=(ToggleButton)findViewById(R.id.capture);
  mVelocitySpinner=(Spinner)findViewById(R.id.velocity);
  mMovementSpinner=(Spinner)findViewById(R.id.movement);
  mUrl=(EditText)findViewById(R.id.url);
  mWeb=(ProfiledWebView)findViewById(R.id.web);
  setCallback(new ProfileCallback(){
    @SuppressWarnings("unchecked") @Override public void profileCallback(    RunData data){
      new StoreFileTask().execute(new Pair<String,RunData>(TEMP_FILENAME,data));
      Log.d("ProfileActivity","stored " + data.frames.length + " frames in file");
      setTestingState(TestingState.STOP_TESTING);
    }
  }
);
  mInspectButton.setOnClickListener(new OnClickListener(){
    @Override public void onClick(    View v){
      startActivity(new Intent(ProfileActivity.this,PlaybackActivity.class));
    }
  }
);
  ArrayAdapter<CharSequence> adapter=ArrayAdapter.createFromResource(this,R.array.velocity_array,android.R.layout.simple_spinner_item);
  adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
  mVelocitySpinner.setAdapter(adapter);
  mVelocitySpinner.setOnItemSelectedListener(new VelocitySelectedListener());
  mVelocitySpinner.setSelection(3);
  String content[]={getResources().getString(R.string.movement_auto_scroll),getResources().getString(R.string.movement_manual),getResources().getString(R.string.movement_timed)};
  adapter=new ArrayAdapter<CharSequence>(this,android.R.layout.simple_spinner_item,content);
  adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
  mMovementSpinner.setAdapter(adapter);
  mMovementSpinner.setOnItemSelectedListener(new MovementSelectedListener());
  mMovementSpinner.setSelection(0);
  mCaptureButton.setOnClickListener(new OnClickListener(){
    @Override public void onClick(    View v){
      if (mCaptureButton.isChecked()) {
        startViewProfiling(false);
      }
 else {
        mWeb.stopScrollTest();
      }
    }
  }
);
  mWeb.init(this);
  mWeb.setWebViewClient(new LoggingWebViewClient());
  mUrl.setOnEditorActionListener(new OnEditorActionListener(){
    public boolean onEditorAction(    TextView v,    int actionId,    KeyEvent event){
      String url=mUrl.getText().toString();
      mWeb.loadUrl(url);
      mWeb.requestFocus();
      return true;
    }
  }
);
  setTestingState(TestingState.NOT_TESTING);
}
