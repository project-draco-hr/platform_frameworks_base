{
  dest.writeInt(mEventCount);
  dest.writeInt(mIndex);
  if (mEventCount > 0) {
    dest.writeStringArray(mStringPool);
    if (mEventsToWrite != null) {
      Parcel p=Parcel.obtain();
      try {
        p.setDataPosition(0);
        for (int i=0; i < mEventCount; i++) {
          final Event event=mEventsToWrite.get(i);
          final int packageIndex;
          if (event.mPackage != null) {
            packageIndex=findStringIndex(event.mPackage);
          }
 else {
            packageIndex=-1;
          }
          final int classIndex;
          if (event.mClass != null) {
            classIndex=findStringIndex(event.mClass);
          }
 else {
            classIndex=-1;
          }
          p.writeInt(packageIndex);
          p.writeInt(classIndex);
          p.writeInt(event.getEventType());
          p.writeLong(event.getTimeStamp());
        }
        final int listByteLength=p.dataPosition();
        dest.writeInt(listByteLength);
        dest.writeInt(0);
        dest.appendFrom(p,0,listByteLength);
      }
  finally {
        p.recycle();
      }
    }
 else     if (mParcel != null) {
      dest.writeInt(mParcel.dataSize());
      dest.writeInt(mParcel.dataPosition());
      dest.appendFrom(mParcel,0,mParcel.dataSize());
    }
 else {
      throw new IllegalStateException("Either mParcel or mEventsToWrite must not be null");
    }
  }
}
