{
  final ActivityManager am=(ActivityManager)mContext.getSystemService(Context.ACTIVITY_SERVICE);
  final PackageManager pm=mContext.getPackageManager();
  final Bitmap thumbnail=SystemServicesProxy.getThumbnail(am,td.persistentTaskId);
  Drawable icon=getFullResIcon(td.resolveInfo,pm);
  if (td.userId != UserHandle.myUserId()) {
    final UserManager um=(UserManager)mContext.getSystemService(Context.USER_SERVICE);
    icon=um.getBadgedDrawableForUser(icon,new UserHandle(td.userId));
  }
  if (DEBUG)   Log.v(TAG,"Loaded bitmap for task " + td + ": "+ thumbnail);
synchronized (td) {
    if (thumbnail != null) {
      td.setThumbnail(new BitmapDrawable(mContext.getResources(),thumbnail));
    }
 else {
      td.setThumbnail(mDefaultThumbnailBackground);
    }
    if (icon != null) {
      td.setIcon(icon);
    }
    td.setLoaded(true);
  }
}
