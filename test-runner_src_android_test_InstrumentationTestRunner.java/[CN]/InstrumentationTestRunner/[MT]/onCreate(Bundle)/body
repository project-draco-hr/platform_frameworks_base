{
  super.onCreate(arguments);
  mArguments=arguments;
  String[] apkPaths={getTargetContext().getPackageCodePath(),getContext().getPackageCodePath()};
  ClassPathPackageInfoSource.setApkPaths(apkPaths);
  Predicate<TestMethod> testSizePredicate=null;
  Predicate<TestMethod> testAnnotationPredicate=null;
  Predicate<TestMethod> testNotAnnotationPredicate=null;
  String testClassesArg=null;
  boolean logOnly=false;
  if (arguments != null) {
    testClassesArg=arguments.getString(ARGUMENT_TEST_CLASS);
    mDebug=getBooleanArgument(arguments,"debug");
    mJustCount=getBooleanArgument(arguments,"count");
    mSuiteAssignmentMode=getBooleanArgument(arguments,"suiteAssignment");
    mPackageOfTests=arguments.getString(ARGUMENT_TEST_PACKAGE);
    testSizePredicate=getSizePredicateFromArg(arguments.getString(ARGUMENT_TEST_SIZE_PREDICATE));
    testAnnotationPredicate=getAnnotationPredicate(arguments.getString(ARGUMENT_ANNOTATION));
    testNotAnnotationPredicate=getNotAnnotationPredicate(arguments.getString(ARGUMENT_NOT_ANNOTATION));
    logOnly=getBooleanArgument(arguments,ARGUMENT_LOG_ONLY);
    mCoverage=getBooleanArgument(arguments,"coverage");
    mCoverageFilePath=arguments.getString("coverageFile");
    try {
      Object delay=arguments.get(ARGUMENT_DELAY_MSEC);
      if (delay != null)       mDelayMsec=Integer.parseInt(delay.toString());
    }
 catch (    NumberFormatException e) {
      Log.e(LOG_TAG,"Invalid delay_msec parameter",e);
    }
  }
  TestSuiteBuilder testSuiteBuilder=new TestSuiteBuilder(getClass().getName(),getTargetContext().getClassLoader());
  if (testSizePredicate != null) {
    testSuiteBuilder.addRequirements(testSizePredicate);
  }
  if (testAnnotationPredicate != null) {
    testSuiteBuilder.addRequirements(testAnnotationPredicate);
  }
  if (testNotAnnotationPredicate != null) {
    testSuiteBuilder.addRequirements(testNotAnnotationPredicate);
  }
  if (testClassesArg == null) {
    if (mPackageOfTests != null) {
      testSuiteBuilder.includePackages(mPackageOfTests);
    }
 else {
      TestSuite testSuite=getTestSuite();
      if (testSuite != null) {
        testSuiteBuilder.addTestSuite(testSuite);
      }
 else {
        testSuiteBuilder.includePackages("");
      }
    }
  }
 else {
    parseTestClasses(testClassesArg,testSuiteBuilder);
  }
  testSuiteBuilder.addRequirements(getBuilderRequirements());
  mTestRunner=getAndroidTestRunner();
  mTestRunner.setContext(getTargetContext());
  mTestRunner.setInstrumentation(this);
  mTestRunner.setSkipExecution(logOnly);
  mTestRunner.setTest(testSuiteBuilder.build());
  mTestCount=mTestRunner.getTestCases().size();
  if (mSuiteAssignmentMode) {
    mTestRunner.addTestListener(new SuiteAssignmentPrinter());
  }
 else {
    WatcherResultPrinter resultPrinter=new WatcherResultPrinter(mTestCount);
    mTestRunner.addTestListener(new TestPrinter("TestRunner",false));
    mTestRunner.addTestListener(resultPrinter);
    mTestRunner.setPerformanceResultsWriter(resultPrinter);
  }
  start();
}
