{
  if (DEBUG_LAYERS)   Slog.v(TAG_WM,"Setting im layer adj to " + adj);
  mInputMethodAnimLayerAdjustment=adj;
  final WindowState imw=mService.mInputMethodWindow;
  if (imw != null) {
    imw.mWinAnimator.mAnimLayer=imw.mLayer + adj;
    if (DEBUG_LAYERS)     Slog.v(TAG_WM,"IM win " + imw + " anim layer: "+ imw.mWinAnimator.mAnimLayer);
    for (int i=imw.mChildWindows.size() - 1; i >= 0; i--) {
      final WindowState childWindow=imw.mChildWindows.get(i);
      childWindow.mWinAnimator.mAnimLayer=childWindow.mLayer + adj;
      if (DEBUG_LAYERS)       Slog.v(TAG_WM,"IM win " + childWindow + " anim layer: "+ childWindow.mWinAnimator.mAnimLayer);
    }
  }
  for (int i=mService.mInputMethodDialogs.size(); i >= 0; i--) {
    final WindowState dialog=mService.mInputMethodDialogs.get(i);
    dialog.mWinAnimator.mAnimLayer=dialog.mLayer + adj;
    if (DEBUG_LAYERS)     Slog.v(TAG_WM,"IM win " + imw + " anim layer: "+ dialog.mWinAnimator.mAnimLayer);
  }
}
