{
  final ArrayList<byte[]> stored1=BackupUtils.hashSignatureArray(Arrays.asList("abc".getBytes()));
  final ArrayList<byte[]> stored2=BackupUtils.hashSignatureArray(Arrays.asList("abc".getBytes(),"def".getBytes()));
  PackageInfo pi;
  assertFalse(BackupUtils.signaturesMatch(stored1,null));
  pi=genPackage("xyz");
  pi.applicationInfo.flags|=ApplicationInfo.FLAG_SYSTEM;
  assertTrue(BackupUtils.signaturesMatch(stored1,pi));
  assertTrue(BackupUtils.signaturesMatch(stored1,genPackage("abc")));
  assertTrue(BackupUtils.signaturesMatch(stored1,genPackage("abc","xyz")));
  assertTrue(BackupUtils.signaturesMatch(stored1,genPackage("xyz","abc")));
  assertFalse(BackupUtils.signaturesMatch(stored1,genPackage("xyz")));
  assertFalse(BackupUtils.signaturesMatch(stored1,genPackage("xyz","def")));
  assertTrue(BackupUtils.signaturesMatch(stored2,genPackage("def","abc")));
  assertTrue(BackupUtils.signaturesMatch(stored2,genPackage("x","def","abc","y")));
  assertFalse(BackupUtils.signaturesMatch(stored2,genPackage("abc")));
  assertFalse(BackupUtils.signaturesMatch(stored2,genPackage("def")));
}
