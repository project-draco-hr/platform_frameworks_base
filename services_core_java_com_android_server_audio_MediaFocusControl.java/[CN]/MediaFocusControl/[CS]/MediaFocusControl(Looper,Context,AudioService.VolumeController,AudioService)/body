{
  mEventHandler=new MediaEventHandler(looper);
  mContext=cntxt;
  mContentResolver=mContext.getContentResolver();
  mVolumeController=volumeCtrl;
  mAudioService=as;
  PowerManager pm=(PowerManager)mContext.getSystemService(Context.POWER_SERVICE);
  mMediaEventWakeLock=pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK,"handleMediaEvent");
  int maxMusicLevel=as.getStreamMaxVolume(AudioManager.STREAM_MUSIC);
  mMainRemote=new RemotePlaybackState(-1,maxMusicLevel,maxMusicLevel);
  TelephonyManager tmgr=(TelephonyManager)mContext.getSystemService(Context.TELEPHONY_SERVICE);
  tmgr.listen(mPhoneStateListener,PhoneStateListener.LISTEN_CALL_STATE);
  mAppOps=(AppOpsManager)mContext.getSystemService(Context.APP_OPS_SERVICE);
  mKeyguardManager=(KeyguardManager)mContext.getSystemService(Context.KEYGUARD_SERVICE);
  mNotifListenerObserver=new NotificationListenerObserver();
  mHasRemotePlayback=false;
  mMainRemoteIsActive=false;
  PlayerRecord.setMediaFocusControl(this);
  postReevaluateRemote();
}
