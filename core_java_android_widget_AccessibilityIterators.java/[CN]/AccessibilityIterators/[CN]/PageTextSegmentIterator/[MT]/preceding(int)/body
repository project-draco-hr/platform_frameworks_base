{
  final int textLength=mText.length();
  if (textLength <= 0) {
    return null;
  }
  if (offset <= 0) {
    return null;
  }
  if (!mView.getGlobalVisibleRect(mTempRect)) {
    return null;
  }
  final int end=Math.min(mText.length(),offset);
  final int currentLine=mLayout.getLineForOffset(end);
  final int currentLineTop=mLayout.getLineTop(currentLine);
  final int pageHeight=mTempRect.height() - mView.getTotalPaddingTop() - mView.getTotalPaddingBottom();
  final int previousPageEndY=currentLineTop - pageHeight;
  int currentPageStartLine=(previousPageEndY > 0) ? mLayout.getLineForVertical(previousPageEndY) : 0;
  if (end == mText.length() && (currentPageStartLine < currentLine)) {
    currentPageStartLine+=1;
  }
  final int start=getLineEdgeIndex(currentPageStartLine,DIRECTION_START);
  return getRange(start,end);
}
