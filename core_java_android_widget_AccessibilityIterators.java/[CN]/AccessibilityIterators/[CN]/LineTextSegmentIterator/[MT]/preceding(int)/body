{
  final int textLegth=mText.length();
  if (textLegth <= 0) {
    return null;
  }
  if (offset <= 0) {
    return null;
  }
  int previousLine;
  if (offset > mText.length()) {
    previousLine=mLayout.getLineForOffset(mText.length());
  }
 else {
    final int currentLine=mLayout.getLineForOffset(offset);
    if (getLineEdgeIndex(currentLine,DIRECTION_END) + 1 == offset) {
      previousLine=currentLine;
    }
 else {
      previousLine=currentLine - 1;
    }
  }
  if (previousLine < 0) {
    return null;
  }
  final int start=getLineEdgeIndex(previousLine,DIRECTION_START);
  final int end=getLineEdgeIndex(previousLine,DIRECTION_END) + 1;
  return getRange(start,end);
}
