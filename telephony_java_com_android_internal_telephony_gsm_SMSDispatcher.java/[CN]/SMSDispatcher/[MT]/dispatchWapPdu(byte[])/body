{
  int index=0;
  int transactionId=pdu[index++] & 0xFF;
  int pduType=pdu[index++] & 0xFF;
  int headerLength=0;
  if ((pduType != WAP_PDU_TYPE_PUSH) && (pduType != WAP_PDU_TYPE_CONFIRMED_PUSH)) {
    Log.w(TAG,"Received non-PUSH WAP PDU. Type = " + pduType);
    return;
  }
  int temp=0;
  do {
    temp=pdu[index++];
    headerLength=headerLength << 7;
    headerLength|=temp & 0x7F;
  }
 while ((temp & 0x80) != 0);
  int headerStartIndex=index;
  if ((pdu[index] & 0xff) <= WAP_PDU_SHORT_LENGTH_MAX) {
    index++;
  }
 else   if (pdu[index] == WAP_PDU_LENGTH_QUOTE) {
    index++;
    index++;
  }
  String mimeType;
switch (pdu[headerStartIndex]) {
case DRM_RIGHTS_XML:
    mimeType=DRM_RIGHTS_XML_MIME_TYPE;
  break;
case DRM_RIGHTS_WBXML:
mimeType=DRM_RIGHTS_WBXML_MIME_TYPE;
break;
case WAP_SI_MIME_PORT:
mimeType=WAP_SI_MIME_TYPE;
break;
case WAP_SL_MIME_PORT:
mimeType=WAP_SL_MIME_TYPE;
break;
case WAP_CO_MIME_PORT:
mimeType=WAP_CO_MIME_TYPE;
break;
default :
int start=index;
while (pdu[index++] != '\0') {
;
}
mimeType=new String(pdu,start,index - start - 1);
break;
}
int dataIndex=headerStartIndex + headerLength;
byte[] data;
if (pdu[headerStartIndex] == WAP_CO_MIME_PORT) {
data=pdu;
}
 else {
data=new byte[pdu.length - dataIndex];
System.arraycopy(pdu,dataIndex,data,0,data.length);
}
Intent intent=new Intent(Intents.WAP_PUSH_RECEIVED_ACTION);
intent.setType(mimeType);
intent.putExtra("transactionId",transactionId);
intent.putExtra("pduType",pduType);
intent.putExtra("data",data);
if (mimeType.equals(MMS_MIME_TYPE)) {
mPhone.getContext().sendBroadcast(intent,"android.permission.RECEIVE_MMS");
}
 else {
mPhone.getContext().sendBroadcast(intent,"android.permission.RECEIVE_WAP_PUSH");
}
}
