{
  if (useOldZoom(mContext))   return;
  if (visible) {
    dismissZoomRingDelayed(ZOOM_CONTROLS_TIMEOUT);
  }
 else {
    mPanner.stop();
  }
  if (mIsZoomRingVisible == visible) {
    return;
  }
  mIsZoomRingVisible=visible;
  if (visible) {
    if (mContainerLayoutParams.token == null) {
      mContainerLayoutParams.token=mOwnerView.getWindowToken();
    }
    mWindowManager.addView(mContainer,mContainerLayoutParams);
    if (mPostedVisibleInitializer == null) {
      mPostedVisibleInitializer=new Runnable(){
        public void run(){
          refreshPositioningVariables();
          resetZoomRing();
          mWindowManager.updateViewLayout(mContainer,mContainerLayoutParams);
          if (mCallback != null) {
            mCallback.onVisibilityChanged(true);
          }
        }
      }
;
    }
    mHandler.post(mPostedVisibleInitializer);
    mContext.registerReceiver(mConfigurationChangedReceiver,mConfigurationChangedFilter);
    mOwnerView.setOnKeyListener(this);
    mOwnerView.setOnTouchListener(this);
    mReleaseTouchListenerOnUp=false;
  }
 else {
    mOwnerView.setOnKeyListener(null);
    if (mTouchTargetView != null) {
      mReleaseTouchListenerOnUp=true;
    }
 else {
      mOwnerView.setOnTouchListener(null);
    }
    mContext.unregisterReceiver(mConfigurationChangedReceiver);
    mWindowManager.removeView(mContainer);
    if (mCallback != null) {
      mCallback.onVisibilityChanged(false);
    }
  }
}
