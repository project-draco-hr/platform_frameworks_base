{
  int action=event.getAction();
  if (action == MotionEvent.ACTION_DOWN) {
    mTouchMode=TOUCH_MODE_WAITING_FOR_TAP_DRAG_MOVEMENT;
    int x=(int)event.getX();
    int y=(int)event.getY();
    refreshPositioningVariables();
    setVisible(true);
    centerPoint(x,y);
    ensureZoomRingIsCentered();
    mTapDragStartX=x;
    mTapDragStartY=y;
  }
 else   if (action == MotionEvent.ACTION_CANCEL) {
    mTouchMode=TOUCH_MODE_IDLE;
  }
 else {
switch (mTouchMode) {
case TOUCH_MODE_WAITING_FOR_TAP_DRAG_MOVEMENT:
{
switch (action) {
case MotionEvent.ACTION_MOVE:
          int x=(int)event.getX();
        int y=(int)event.getY();
      if (Math.abs(x - mTapDragStartX) > mViewConfig.getScaledTouchSlop() || Math.abs(y - mTapDragStartY) > mViewConfig.getScaledTouchSlop()) {
        mZoomRing.setTapDragMode(true,x,y);
        mTouchMode=TOUCH_MODE_FORWARDING_FOR_TAP_DRAG;
      }
    return true;
case MotionEvent.ACTION_UP:
  mTouchMode=TOUCH_MODE_IDLE;
break;
}
break;
}
case TOUCH_MODE_FORWARDING_FOR_TAP_DRAG:
{
switch (action) {
case MotionEvent.ACTION_MOVE:
giveTouchToZoomRing(event);
return true;
case MotionEvent.ACTION_UP:
mTouchMode=TOUCH_MODE_IDLE;
mZoomRing.setTapDragMode(false,(int)event.getX(),(int)event.getY());
dismissZoomRingDelayed(0);
break;
}
break;
}
}
}
return true;
}
