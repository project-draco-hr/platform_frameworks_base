{
  try {
    int num;
    try {
      num=in.readInt();
    }
 catch (    EOFException e) {
      Slog.w(TAG,"Read empty signature block");
      return null;
    }
    if (DEBUG)     Slog.v(TAG," ... unflatten read " + num);
    if (num > 20) {
      Slog.e(TAG,"Suspiciously large sig count in restore data; aborting");
      throw new IllegalStateException("Bad restore state");
    }
    boolean nonHashFound=false;
    ArrayList<byte[]> sigs=new ArrayList<byte[]>(num);
    for (int i=0; i < num; i++) {
      int len=in.readInt();
      byte[] readHash=new byte[len];
      in.read(readHash);
      sigs.add(readHash);
      if (len != 32) {
        nonHashFound=true;
      }
    }
    if (nonHashFound) {
      sigs=BackupUtils.hashSignatureArray(sigs);
    }
    return sigs;
  }
 catch (  IOException e) {
    Slog.e(TAG,"Unable to read signatures");
    return null;
  }
}
