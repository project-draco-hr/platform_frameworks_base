{
  mExisting.clear();
  mStateVersions.clear();
  mStoredSdkVersion=0;
  mStoredIncrementalVersion=null;
  mStoredHomeComponent=null;
  mStoredHomeVersion=0;
  mStoredHomeSigs=null;
  FileInputStream instream=new FileInputStream(stateFile.getFileDescriptor());
  BufferedInputStream inbuffer=new BufferedInputStream(instream);
  DataInputStream in=new DataInputStream(inbuffer);
  try {
    String pkg=in.readUTF();
    if (pkg.equals(DEFAULT_HOME_KEY)) {
      mStoredHomeComponent=ComponentName.unflattenFromString(in.readUTF());
      mStoredHomeVersion=in.readLong();
      mStoredHomeSigs=readSignatureArray(in);
      pkg=in.readUTF();
    }
 else {
    }
    if (pkg.equals(GLOBAL_METADATA_KEY)) {
      mStoredSdkVersion=in.readInt();
      mStoredIncrementalVersion=in.readUTF();
      mExisting.add(GLOBAL_METADATA_KEY);
    }
 else {
      Slog.e(TAG,"No global metadata in state file!");
      return;
    }
    while (true) {
      pkg=in.readUTF();
      int versionCode=in.readInt();
      mExisting.add(pkg);
      mStateVersions.put(pkg,new Metadata(versionCode,null));
    }
  }
 catch (  EOFException eof) {
  }
catch (  IOException e) {
    Slog.e(TAG,"Unable to read Package Manager state file: " + e);
  }
}
