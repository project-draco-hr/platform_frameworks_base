{
  mExisting.clear();
  mStateVersions.clear();
  mStoredSdkVersion=0;
  mStoredIncrementalVersion=null;
  FileInputStream instream=new FileInputStream(stateFile.getFileDescriptor());
  DataInputStream in=new DataInputStream(instream);
  int bufSize=256;
  byte[] buf=new byte[bufSize];
  try {
    String pkg=in.readUTF();
    if (pkg.equals(GLOBAL_METADATA_KEY)) {
      mStoredSdkVersion=in.readInt();
      mStoredIncrementalVersion=in.readUTF();
      mExisting.add(GLOBAL_METADATA_KEY);
    }
 else {
      Slog.e(TAG,"No global metadata in state file!");
      return;
    }
    while (true) {
      pkg=in.readUTF();
      int versionCode=in.readInt();
      mExisting.add(pkg);
      mStateVersions.put(pkg,new Metadata(versionCode,null));
    }
  }
 catch (  EOFException eof) {
  }
catch (  IOException e) {
    Slog.e(TAG,"Unable to read Package Manager state file: " + e);
  }
}
