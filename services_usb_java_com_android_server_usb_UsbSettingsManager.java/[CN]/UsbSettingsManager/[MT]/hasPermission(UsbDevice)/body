{
synchronized (mLock) {
    int uid=Binder.getCallingUid();
    if (uid == Process.SYSTEM_UID) {
      return true;
    }
    SparseBooleanArray uidList=mDevicePermissionMap.get(device.getDeviceName());
    if (uidList == null) {
      return false;
    }
    return uidList.get(uid);
  }
}
