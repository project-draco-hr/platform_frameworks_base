{
  if (info == null || info.isConnected() || info.getType() != mNetworkType) {
    ConnectivityManager cm=(ConnectivityManager)mContext.getSystemService(Context.CONNECTIVITY_SERVICE);
    info=cm.getActiveNetworkInfo();
  }
  int networkType=(info != null && info.isConnected()) ? info.getType() : -1;
  if (mSipOnWifiOnly && networkType != ConnectivityManager.TYPE_WIFI) {
    networkType=-1;
  }
  if (mNetworkType == networkType) {
    return;
  }
  if (DBG) {
    log("onConnectivityChanged: " + mNetworkType + " -> "+ networkType);
  }
  try {
    if (mNetworkType != -1) {
      mLocalIp=null;
      stopPortMappingMeasurement();
      for (      SipSessionGroupExt group : mSipGroups.values()) {
        group.onConnectivityChanged(false);
      }
    }
    mNetworkType=networkType;
    if (mNetworkType != -1) {
      mLocalIp=determineLocalIp();
      mKeepAliveInterval=-1;
      mLastGoodKeepAliveInterval=DEFAULT_KEEPALIVE_INTERVAL;
      for (      SipSessionGroupExt group : mSipGroups.values()) {
        group.onConnectivityChanged(true);
      }
    }
    updateWakeLocks();
  }
 catch (  SipException e) {
    loge("onConnectivityChanged()",e);
  }
}
