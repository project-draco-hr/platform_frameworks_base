{
  SipSessionGroup.SipSessionImpl session=(SipSessionGroup.SipSessionImpl)s;
synchronized (SipService.this) {
    try {
      if (!isRegistered() || callingSelf(this,session)) {
        if (SSGE_DBG)         log("onRinging: end notReg or self");
        session.endCall();
        return;
      }
      addPendingSession(session);
      Intent intent=SipManager.createIncomingCallBroadcast(session.getCallId(),sessionDescription);
      if (SSGE_DBG)       log("onRinging: uri=" + getUri() + ": "+ caller.getUri()+ ": "+ session.getCallId()+ " "+ mIncomingCallPendingIntent);
      mIncomingCallPendingIntent.send(mContext,SipManager.INCOMING_CALL_RESULT_CODE,intent);
    }
 catch (    PendingIntent.CanceledException e) {
      loge("onRinging: pendingIntent is canceled, drop incoming call",e);
      session.endCall();
    }
  }
}
