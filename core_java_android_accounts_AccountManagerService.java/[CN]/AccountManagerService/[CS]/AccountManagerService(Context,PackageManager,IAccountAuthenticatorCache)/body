{
  mContext=context;
  mPackageManager=packageManager;
synchronized (mCacheLock) {
    mOpenHelper=new DatabaseHelper(mContext);
  }
  mMessageThread=new HandlerThread("AccountManagerService");
  mMessageThread.start();
  mMessageHandler=new MessageHandler(mMessageThread.getLooper());
  mAuthenticatorCache=authenticatorCache;
  mAuthenticatorCache.setListener(this,null);
  sThis.set(this);
  IntentFilter intentFilter=new IntentFilter();
  intentFilter.addAction(Intent.ACTION_PACKAGE_REMOVED);
  intentFilter.addDataScheme("package");
  mContext.registerReceiver(new BroadcastReceiver(){
    @Override public void onReceive(    Context context1,    Intent intent){
      purgeOldGrants();
    }
  }
,intentFilter);
  purgeOldGrants();
  validateAccountsAndPopulateCache();
}
