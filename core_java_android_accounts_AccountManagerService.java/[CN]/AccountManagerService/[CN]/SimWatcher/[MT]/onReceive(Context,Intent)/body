{
  String imsi=((TelephonyManager)context.getSystemService(Context.TELEPHONY_SERVICE)).getSubscriberId();
  if (TextUtils.isEmpty(imsi))   return;
  String storedImsi=getMetaValue("imsi");
  if (Log.isLoggable(TAG,Log.VERBOSE)) {
    Log.v(TAG,"current IMSI=" + imsi + "; stored IMSI="+ storedImsi);
  }
  if (!imsi.equals(storedImsi) && !TextUtils.isEmpty(storedImsi)) {
    Log.w(TAG,"wiping all passwords and authtokens because IMSI changed (" + "stored=" + storedImsi + ", current="+ imsi+ ")");
    SQLiteDatabase db=mOpenHelper.getWritableDatabase();
    db.beginTransaction();
    try {
      db.execSQL("DELETE from " + TABLE_AUTHTOKENS);
      db.execSQL("UPDATE " + TABLE_ACCOUNTS + " SET "+ ACCOUNTS_PASSWORD+ " = ''");
      sendAccountsChangedBroadcast();
      db.setTransactionSuccessful();
    }
  finally {
      db.endTransaction();
    }
  }
  setMetaValue("imsi",imsi);
}
