{
  if (Binder.getCallingUid() == android.os.Process.SYSTEM_UID) {
    return true;
  }
synchronized (mCacheLock) {
    final SQLiteDatabase db=mOpenHelper.getReadableDatabase();
    String[] args={String.valueOf(Binder.getCallingUid()),authTokenType,account.name,account.type};
    final boolean permissionGranted=DatabaseUtils.longForQuery(db,COUNT_OF_MATCHING_GRANTS,args) != 0;
    if (!permissionGranted && ActivityManager.isRunningInTestHarness()) {
      Log.d(TAG,"no credentials permission for usage of " + account + ", "+ authTokenType+ " by uid "+ Binder.getCallingUid()+ " but ignoring since device is in test harness.");
      return true;
    }
    return permissionGranted;
  }
}
