{
  long identityToken=clearCallingIdentity();
  try {
    SQLiteDatabase db=mOpenHelper.getWritableDatabase();
    db.beginTransaction();
    try {
      long numMatches=DatabaseUtils.longForQuery(db,"select count(*) from " + TABLE_ACCOUNTS + " WHERE "+ ACCOUNTS_NAME+ "=? AND "+ ACCOUNTS_TYPE+ "=?",new String[]{account.mName,account.mType});
      if (numMatches > 0) {
        return false;
      }
      ContentValues values=new ContentValues();
      values.put(ACCOUNTS_NAME,account.mName);
      values.put(ACCOUNTS_TYPE,account.mType);
      values.put(ACCOUNTS_PASSWORD,password);
      long accountId=db.insert(TABLE_ACCOUNTS,ACCOUNTS_NAME,values);
      if (accountId < 0) {
        return false;
      }
      if (extras != null) {
        for (        String key : extras.keySet()) {
          final String value=extras.getString(key);
          if (insertExtra(db,accountId,key,value) < 0) {
            return false;
          }
        }
      }
      db.setTransactionSuccessful();
      sendAccountsChangedBroadcast();
      return true;
    }
  finally {
      db.endTransaction();
    }
  }
  finally {
    restoreCallingIdentity(identityToken);
  }
}
