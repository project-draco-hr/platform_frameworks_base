{
  final boolean inSystemImage=inSystemImage(callerUid);
  final boolean fromAuthenticator=account != null && hasAuthenticatorUid(account.type,callerUid);
  final boolean hasExplicitGrants=account != null && hasExplicitlyGrantedPermission(account,authTokenType);
  if (Log.isLoggable(TAG,Log.VERBOSE)) {
    Log.v(TAG,"checkGrantsOrCallingUidAgainstAuthenticator: caller uid " + callerUid + ", "+ account+ ": is authenticator? "+ fromAuthenticator+ ", has explicit permission? "+ hasExplicitGrants);
  }
  return fromAuthenticator || hasExplicitGrants || inSystemImage;
}
