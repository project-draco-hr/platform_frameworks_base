{
  long identityToken=clearCallingIdentity();
  try {
    if (Log.isLoggable(TAG,Log.VERBOSE)) {
      Log.v(TAG,"doNotification: " + message + " intent:"+ intent);
    }
    if (intent.getComponent() != null && GrantCredentialsPermissionActivity.class.getName().equals(intent.getComponent().getClassName())) {
      createNoCredentialsPermissionNotification(account,intent);
    }
 else {
      Notification n=new Notification(android.R.drawable.stat_sys_warning,null,0);
      n.setLatestEventInfo(mContext,mContext.getText(R.string.notification_title),message,PendingIntent.getActivity(mContext,0,intent,PendingIntent.FLAG_CANCEL_CURRENT));
      ((NotificationManager)mContext.getSystemService(Context.NOTIFICATION_SERVICE)).notify(getSigninRequiredNotificationId(account),n);
    }
  }
  finally {
    restoreCallingIdentity(identityToken);
  }
}
