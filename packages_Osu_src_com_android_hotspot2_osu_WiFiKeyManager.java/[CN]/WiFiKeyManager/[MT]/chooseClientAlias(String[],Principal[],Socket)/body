{
  Map<String,Integer> keyPrefs=new HashMap<>(keyTypes.length);
  int pref=0;
  for (  String keyType : keyTypes) {
    keyPrefs.put(keyType,pref++);
  }
  List<AliasEntry> aliases=new ArrayList<>();
  if (issuers != null) {
    for (    Principal issuer : issuers) {
      if (issuer instanceof X500Principal) {
        String[] aliasAndKey=mAliases.get((X500Principal)issuer);
        if (aliasAndKey != null) {
          Integer preference=keyPrefs.get(aliasAndKey[1]);
          if (preference != null) {
            aliases.add(new AliasEntry(preference,aliasAndKey[0]));
          }
        }
      }
    }
  }
 else {
    for (    String[] aliasAndKey : mAliases.values()) {
      Integer preference=keyPrefs.get(aliasAndKey[1]);
      if (preference != null) {
        aliases.add(new AliasEntry(preference,aliasAndKey[0]));
      }
    }
  }
  Collections.sort(aliases);
  return aliases.isEmpty() ? null : aliases.get(0).getAlias();
}
