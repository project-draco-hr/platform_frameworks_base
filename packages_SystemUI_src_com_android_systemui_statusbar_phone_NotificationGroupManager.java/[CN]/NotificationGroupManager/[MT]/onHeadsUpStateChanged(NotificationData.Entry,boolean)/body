{
  final StatusBarNotification sbn=entry.notification;
  if (entry.row.isHeadsUp()) {
    final boolean groupChild=sbn.getNotification().isGroupChild();
    if (groupChild) {
      onEntryRemovedInternal(entry,entry.notification);
    }
    mHeadsUpedEntries.put(sbn.getKey(),sbn);
    if (groupChild) {
      onEntryAdded(entry);
      updateSuppression(mGroupMap.get(entry.notification.getGroupKey()));
      mListener.onGroupsChanged();
    }
  }
 else {
    if (mHeadsUpedEntries.containsKey(sbn.getKey())) {
      boolean isolatedBefore=isIsolated(sbn);
      if (isolatedBefore) {
        onEntryRemovedInternal(entry,entry.notification);
      }
      mHeadsUpedEntries.remove(sbn.getKey());
      if (isolatedBefore) {
        onEntryAdded(entry);
        mListener.onGroupsChanged();
      }
    }
  }
}
