{
  final StatusBarNotification sbn=entry.notification;
  if (entry.row.isHeadsUp()) {
    if (!mHeadsUpedEntries.contains(sbn.getKey())) {
      final boolean groupChild=sbn.getNotification().isGroupChild();
      if (groupChild) {
        onEntryRemovedInternal(entry,entry.notification);
      }
      mHeadsUpedEntries.add(sbn.getKey());
      if (groupChild) {
        onEntryAdded(entry);
        mListener.onGroupsChanged();
      }
    }
  }
 else {
    if (mHeadsUpedEntries.contains(sbn.getKey())) {
      boolean isolatedBefore=isIsolated(sbn);
      if (isolatedBefore) {
        onEntryRemovedInternal(entry,entry.notification);
      }
      mHeadsUpedEntries.remove(sbn.getKey());
      if (isolatedBefore) {
        onEntryAdded(entry);
        mListener.onGroupsChanged();
      }
    }
  }
}
