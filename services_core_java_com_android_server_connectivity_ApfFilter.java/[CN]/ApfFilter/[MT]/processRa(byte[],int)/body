{
  if (VDBG)   hexDump("Read packet = ",packet,length);
  for (int i=0; i < mRas.size(); i++) {
    Ra ra=mRas.get(i);
    if (ra.matches(packet,length)) {
      if (VDBG)       log("matched RA " + ra);
      ra.mLastSeen=curTime();
      ra.mMinLifetime=ra.minLifetime(packet,length);
      ra.seenCount++;
      mRas.add(0,mRas.remove(i));
      maybeInstallNewProgram();
      return;
    }
  }
  for (int i=0; i < mRas.size(); ) {
    if (mRas.get(i).isExpired()) {
      log("Expired RA " + mRas.get(i));
      mRas.remove(i);
    }
 else {
      i++;
    }
  }
  if (mRas.size() >= MAX_RAS)   return;
  try {
    Ra ra=new Ra(packet,length);
    log("Adding " + ra);
    mRas.add(ra);
  }
 catch (  Exception e) {
    Log.e(TAG,"Error parsing RA: " + e);
    return;
  }
  installNewProgram();
}
