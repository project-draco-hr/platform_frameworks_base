{
  mIfaceName=mNai.linkProperties.getInterfaceName();
  if (mIfaceName == null)   return;
  FileDescriptor socket;
  try {
    NetworkInterface networkInterface=NetworkInterface.getByName(mIfaceName);
    if (networkInterface == null) {
      Log.e(TAG,"Can't find interface " + mIfaceName);
      return;
    }
    mIfaceMac=networkInterface.getHardwareAddress();
synchronized (this) {
      installNewProgramLocked();
    }
    socket=Os.socket(AF_PACKET,SOCK_RAW,ETH_P_IPV6);
    PacketSocketAddress addr=new PacketSocketAddress((short)ETH_P_IPV6,networkInterface.getIndex());
    Os.bind(socket,addr);
    NetworkUtils.attachRaFilter(socket,mNai.networkMisc.apfPacketFormat);
  }
 catch (  SocketException|ErrnoException e) {
    Log.e(TAG,"Error starting filter",e);
    return;
  }
  mReceiveThread=new ReceiveThread(socket);
  mReceiveThread.start();
}
