{
  final boolean wasShowing=isShowing();
  computeContentWidth();
  setInputMethodMode(ListPopupWindow.INPUT_METHOD_NOT_NEEDED);
  super.show();
  getListView().setChoiceMode(ListView.CHOICE_MODE_SINGLE);
  setSelection(Spinner.this.getSelectedItemPosition());
  if (wasShowing) {
    return;
  }
  final ViewTreeObserver vto=getViewTreeObserver();
  if (vto != null) {
    final OnGlobalLayoutListener layoutListener=new OnGlobalLayoutListener(){
      @Override public void onGlobalLayout(){
        if (!Spinner.this.isVisibleToUser()) {
          dismiss();
        }
 else {
          computeContentWidth();
          DropdownPopup.super.show();
        }
      }
    }
;
    vto.addOnGlobalLayoutListener(layoutListener);
    setOnDismissListener(new OnDismissListener(){
      @Override public void onDismiss(){
        final ViewTreeObserver vto=getViewTreeObserver();
        if (vto != null) {
          vto.removeOnGlobalLayoutListener(layoutListener);
        }
      }
    }
);
  }
}
