{
  super(context,attrs,defStyleAttr,defStyleRes);
  final TypedArray a=context.obtainStyledAttributes(attrs,com.android.internal.R.styleable.Spinner,defStyleAttr,defStyleRes);
  if (mode == MODE_THEME) {
    mode=a.getInt(com.android.internal.R.styleable.Spinner_spinnerMode,MODE_DIALOG);
  }
switch (mode) {
case MODE_DIALOG:
{
      mPopup=new DialogPopup();
      break;
    }
case MODE_DROPDOWN:
{
    final DropdownPopup popup=new DropdownPopup(context,attrs,defStyleAttr,defStyleRes);
    mDropDownWidth=a.getLayoutDimension(com.android.internal.R.styleable.Spinner_dropDownWidth,ViewGroup.LayoutParams.WRAP_CONTENT);
    popup.setBackgroundDrawable(a.getDrawable(com.android.internal.R.styleable.Spinner_popupBackground));
    mPopup=popup;
    mForwardingListener=new ForwardingListener(this){
      @Override public ListPopupWindow getPopup(){
        return popup;
      }
      @Override public boolean onForwardingStarted(){
        if (!mPopup.isShowing()) {
          mPopup.show(getTextDirection(),getTextAlignment());
        }
        return true;
      }
    }
;
    break;
  }
}
mGravity=a.getInt(com.android.internal.R.styleable.Spinner_gravity,Gravity.CENTER);
mPopup.setPromptText(a.getString(com.android.internal.R.styleable.Spinner_prompt));
mDisableChildrenWhenDisabled=a.getBoolean(com.android.internal.R.styleable.Spinner_disableChildrenWhenDisabled,false);
a.recycle();
if (mTempAdapter != null) {
mPopup.setAdapter(mTempAdapter);
mTempAdapter=null;
}
}
