{
  if (DEBUG) {
    Log.d(TAG,"Received result for id " + requestId);
  }
  final CaptureListenerHolder holder;
synchronized (mLock) {
    holder=CameraDevice.this.mCaptureListenerMap.get(requestId);
    if (holder != null && !holder.isRepeating()) {
      CameraDevice.this.mCaptureListenerMap.remove(requestId);
    }
    if (holder != null && holder.isRepeating() && mRepeatingRequestIdDeletedList.size() > 0) {
      Iterator<Integer> iter=mRepeatingRequestIdDeletedList.iterator();
      while (iter.hasNext()) {
        int deletedRequestId=iter.next();
        if (deletedRequestId < requestId) {
          CameraDevice.this.mCaptureListenerMap.remove(deletedRequestId);
          iter.remove();
        }
      }
    }
  }
  if (holder == null) {
    return;
  }
  if (isClosed())   return;
  final CaptureRequest request=holder.getRequest();
  final CaptureResult resultAsCapture=new CaptureResult(result,request,requestId);
  holder.getHandler().post(new Runnable(){
    @Override public void run(){
      if (!CameraDevice.this.isClosed()) {
        holder.getListener().onCaptureCompleted(CameraDevice.this,request,resultAsCapture);
      }
    }
  }
);
}
