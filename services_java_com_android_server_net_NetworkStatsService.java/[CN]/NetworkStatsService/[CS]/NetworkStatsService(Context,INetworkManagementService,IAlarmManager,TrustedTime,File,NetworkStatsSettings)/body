{
  mContext=checkNotNull(context,"missing Context");
  mNetworkManager=checkNotNull(networkManager,"missing INetworkManagementService");
  mAlarmManager=checkNotNull(alarmManager,"missing IAlarmManager");
  mTime=checkNotNull(time,"missing TrustedTime");
  mTeleManager=checkNotNull(TelephonyManager.getDefault(),"missing TelephonyManager");
  mSettings=checkNotNull(settings,"missing NetworkStatsSettings");
  final PowerManager powerManager=(PowerManager)context.getSystemService(Context.POWER_SERVICE);
  mWakeLock=powerManager.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK,TAG);
  mHandlerThread=new HandlerThread(TAG);
  mHandlerThread.start();
  mHandler=new Handler(mHandlerThread.getLooper(),mHandlerCallback);
  mSystemDir=checkNotNull(systemDir);
  mBaseDir=new File(systemDir,"netstats");
  mBaseDir.mkdirs();
}
