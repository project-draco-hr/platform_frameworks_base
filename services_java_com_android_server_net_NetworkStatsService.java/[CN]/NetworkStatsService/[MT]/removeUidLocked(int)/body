{
  ensureUidStatsLoadedLocked();
  for (  NetworkIdentitySet ident : mUidStats.keySet()) {
    final LongSparseArray<NetworkStatsHistory> uidStats=mUidStats.get(ident);
    for (int i=0; i < uidStats.size(); i++) {
      final long packed=uidStats.keyAt(i);
      if (unpackUid(packed) == uid) {
        if (unpackTag(packed) == TAG_NONE) {
          final NetworkStatsHistory uidHistory=uidStats.valueAt(i);
          final NetworkStatsHistory removedHistory=findOrCreateUidStatsLocked(ident,UID_REMOVED,TAG_NONE);
          removedHistory.recordEntireHistory(uidHistory);
        }
        uidStats.remove(packed);
      }
    }
  }
  writeUidStatsLocked();
}
