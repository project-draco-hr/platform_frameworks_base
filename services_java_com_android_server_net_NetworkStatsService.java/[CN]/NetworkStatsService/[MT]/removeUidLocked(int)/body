{
  ensureUidStatsLoadedLocked();
  for (  NetworkIdentitySet ident : mUidStats.keySet()) {
    final SparseArray<NetworkStatsHistory> uidStats=mUidStats.get(ident);
    final NetworkStatsHistory uidHistory=uidStats.get(uid);
    if (uidHistory != null) {
      final NetworkStatsHistory removedHistory=findOrCreateUidStatsLocked(ident,UID_REMOVED);
      removedHistory.recordEntireHistory(uidHistory);
      uidStats.remove(uid);
    }
  }
  writeUidStatsLocked();
}
