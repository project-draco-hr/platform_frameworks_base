{
  final long largestBucketSize=Math.max(mSettings.getNetworkBucketDuration(),mSettings.getUidBucketDuration());
  final long now=mTime.hasCache() ? mTime.currentTimeMillis() : System.currentTimeMillis();
  final long end=now - (now % largestBucketSize) + largestBucketSize;
  final long start=end - largestBucketSize;
  final long trustedTime=mTime.hasCache() ? mTime.currentTimeMillis() : -1;
  NetworkTemplate template=null;
  NetworkStats.Entry devTotal=null;
  NetworkStats.Entry xtTotal=null;
  NetworkStats.Entry uidTotal=null;
  template=buildTemplateMobileAll(getActiveSubscriberId(mContext));
  devTotal=getSummaryForNetworkDev(template,start,end).getTotal(devTotal);
  xtTotal=getSummaryForNetworkXt(template,start,end).getTotal(xtTotal);
  uidTotal=getSummaryForAllUid(template,start,end,false).getTotal(uidTotal);
  EventLogTags.writeNetstatsMobileSample(devTotal.rxBytes,devTotal.rxPackets,devTotal.txBytes,devTotal.txPackets,xtTotal.rxBytes,xtTotal.rxPackets,xtTotal.txBytes,xtTotal.txPackets,uidTotal.rxBytes,uidTotal.rxPackets,uidTotal.txBytes,uidTotal.txPackets,trustedTime);
  template=buildTemplateWifi();
  devTotal=getSummaryForNetworkDev(template,start,end).getTotal(devTotal);
  xtTotal=getSummaryForNetworkXt(template,start,end).getTotal(xtTotal);
  uidTotal=getSummaryForAllUid(template,start,end,false).getTotal(uidTotal);
  EventLogTags.writeNetstatsWifiSample(devTotal.rxBytes,devTotal.rxPackets,devTotal.txBytes,devTotal.txPackets,xtTotal.rxBytes,xtTotal.rxPackets,xtTotal.txBytes,xtTotal.txPackets,uidTotal.rxBytes,uidTotal.rxPackets,uidTotal.txBytes,uidTotal.txPackets,trustedTime);
}
