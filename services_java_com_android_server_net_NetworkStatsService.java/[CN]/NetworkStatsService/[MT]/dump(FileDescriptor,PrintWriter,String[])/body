{
  mContext.enforceCallingOrSelfPermission(DUMP,TAG);
  final HashSet<String> argSet=new HashSet<String>();
  for (  String arg : args) {
    argSet.add(arg);
  }
  final boolean poll=argSet.contains("--poll") || argSet.contains("poll");
  final boolean checkin=argSet.contains("--checkin");
  final boolean fullHistory=argSet.contains("--full") || argSet.contains("full");
  final boolean includeUid=argSet.contains("--uid") || argSet.contains("detail");
  final boolean includeTag=argSet.contains("--tag") || argSet.contains("detail");
  final IndentingPrintWriter pw=new IndentingPrintWriter(writer,"  ");
synchronized (mStatsLock) {
    if (poll) {
      performPollLocked(FLAG_PERSIST_ALL | FLAG_PERSIST_FORCE);
      pw.println("Forced poll");
      return;
    }
    if (checkin) {
      pw.println("Current files:");
      pw.increaseIndent();
      for (      String file : mBaseDir.list()) {
        pw.println(file);
      }
      pw.decreaseIndent();
      return;
    }
    pw.println("Active interfaces:");
    pw.increaseIndent();
    for (    String iface : mActiveIfaces.keySet()) {
      final NetworkIdentitySet ident=mActiveIfaces.get(iface);
      pw.print("iface=");
      pw.print(iface);
      pw.print(" ident=");
      pw.println(ident.toString());
    }
    pw.decreaseIndent();
    pw.println("Dev stats:");
    pw.increaseIndent();
    mDevRecorder.dumpLocked(pw,fullHistory);
    pw.decreaseIndent();
    pw.println("Xt stats:");
    pw.increaseIndent();
    mXtRecorder.dumpLocked(pw,fullHistory);
    pw.decreaseIndent();
    if (includeUid) {
      pw.println("UID stats:");
      pw.increaseIndent();
      mUidRecorder.dumpLocked(pw,fullHistory);
      pw.decreaseIndent();
    }
    if (includeTag) {
      pw.println("UID tag stats:");
      pw.increaseIndent();
      mUidTagRecorder.dumpLocked(pw,fullHistory);
      pw.decreaseIndent();
    }
  }
}
