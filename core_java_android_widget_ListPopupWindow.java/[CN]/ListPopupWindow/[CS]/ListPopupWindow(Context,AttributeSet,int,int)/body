{
  mContext=context;
  mHandler=new Handler(context.getMainLooper());
  final TypedArray a=context.obtainStyledAttributes(attrs,R.styleable.ListPopupWindow,defStyleAttr,defStyleRes);
  mDropDownHorizontalOffset=a.getDimensionPixelOffset(R.styleable.ListPopupWindow_dropDownHorizontalOffset,0);
  mDropDownVerticalOffset=a.getDimensionPixelOffset(R.styleable.ListPopupWindow_dropDownVerticalOffset,0);
  if (mDropDownVerticalOffset != 0) {
    mDropDownVerticalOffsetSet=true;
  }
  a.recycle();
  mPopup=new PopupWindow(context,attrs,defStyleAttr,defStyleRes);
  mPopup.setInputMethodMode(PopupWindow.INPUT_METHOD_NEEDED);
  final Locale locale=mContext.getResources().getConfiguration().locale;
  mLayoutDirection=TextUtils.getLayoutDirectionFromLocale(locale);
}
