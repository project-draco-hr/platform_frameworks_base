{
  Animation a;
  final int thumbWidthI=mNextAppTransitionThumbnail.getWidth();
  final float thumbWidth=thumbWidthI > 0 ? thumbWidthI : 1;
  final int thumbHeightI=mNextAppTransitionThumbnail.getHeight();
  final float thumbHeight=thumbHeightI > 0 ? thumbHeightI : 1;
  if (thumb) {
    if (mNextAppTransitionScaleUp) {
      float scaleW=appWidth / thumbWidth;
      float scaleH=appHeight / thumbHeight;
      Animation scale=new ScaleAnimation(1,scaleW,1,scaleH,computePivot(mNextAppTransitionStartX,1 / scaleW),computePivot(mNextAppTransitionStartY,1 / scaleH));
      scale.setInterpolator(mDecelerateInterpolator);
      Animation alpha=new AlphaAnimation(1,0);
      alpha.setInterpolator(mThumbnailFadeoutInterpolator);
      AnimationSet set=new AnimationSet(false);
      set.addAnimation(scale);
      set.addAnimation(alpha);
      a=set;
    }
 else {
      float scaleW=appWidth / thumbWidth;
      float scaleH=appHeight / thumbHeight;
      a=new ScaleAnimation(scaleW,1,scaleH,1,computePivot(mNextAppTransitionStartX,1 / scaleW),computePivot(mNextAppTransitionStartY,1 / scaleH));
    }
  }
 else   if (enter) {
    if (mNextAppTransitionScaleUp) {
      float scaleW=thumbWidth / appWidth;
      float scaleH=thumbHeight / appHeight;
      a=new ScaleAnimation(scaleW,1,scaleH,1,computePivot(mNextAppTransitionStartX,scaleW),computePivot(mNextAppTransitionStartY,scaleH));
    }
 else {
      a=new AlphaAnimation(1,1);
    }
  }
 else {
    if (mNextAppTransitionScaleUp) {
      if (transit == WindowManagerPolicy.TRANSIT_WALLPAPER_INTRA_OPEN) {
        a=new AlphaAnimation(1,0);
      }
 else {
        a=new AlphaAnimation(1,1);
      }
    }
 else {
      float scaleW=thumbWidth / appWidth;
      float scaleH=thumbHeight / appHeight;
      Animation scale=new ScaleAnimation(1,scaleW,1,scaleH,computePivot(mNextAppTransitionStartX,scaleW),computePivot(mNextAppTransitionStartY,scaleH));
      Animation alpha=new AlphaAnimation(1,0);
      AnimationSet set=new AnimationSet(true);
      set.addAnimation(scale);
      set.addAnimation(alpha);
      set.setZAdjustment(Animation.ZORDER_TOP);
      a=set;
    }
  }
  final long duration;
switch (transit) {
case WindowManagerPolicy.TRANSIT_ACTIVITY_OPEN:
case WindowManagerPolicy.TRANSIT_ACTIVITY_CLOSE:
    duration=mConfigShortAnimTime;
  break;
default :
duration=DEFAULT_APP_TRANSITION_DURATION;
break;
}
a.setDuration(duration);
a.setFillAfter(true);
a.setInterpolator(mDecelerateInterpolator);
a.initialize(appWidth,appHeight,appWidth,appHeight);
return a;
}
