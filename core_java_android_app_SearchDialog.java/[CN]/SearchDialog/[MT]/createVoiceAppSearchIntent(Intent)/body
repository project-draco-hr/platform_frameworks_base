{
  ComponentName searchActivity=mSearchable.getSearchActivity();
  Intent queryIntent=new Intent(Intent.ACTION_SEARCH);
  queryIntent.setComponent(searchActivity);
  PendingIntent pending=PendingIntent.getActivity(getContext(),0,queryIntent,PendingIntent.FLAG_ONE_SHOT);
  Bundle queryExtras=new Bundle();
  if (mAppSearchData != null) {
    queryExtras.putBundle(SearchManager.APP_DATA,mAppSearchData);
  }
  Intent voiceIntent=new Intent(baseIntent);
  String languageModel=RecognizerIntent.LANGUAGE_MODEL_FREE_FORM;
  String prompt=null;
  String language=null;
  int maxResults=1;
  Resources resources=mActivityContext.getResources();
  if (mSearchable.getVoiceLanguageModeId() != 0) {
    languageModel=resources.getString(mSearchable.getVoiceLanguageModeId());
  }
  if (mSearchable.getVoicePromptTextId() != 0) {
    prompt=resources.getString(mSearchable.getVoicePromptTextId());
  }
  if (mSearchable.getVoiceLanguageId() != 0) {
    language=resources.getString(mSearchable.getVoiceLanguageId());
  }
  if (mSearchable.getVoiceMaxResults() != 0) {
    maxResults=mSearchable.getVoiceMaxResults();
  }
  voiceIntent.putExtra(RecognizerIntent.EXTRA_LANGUAGE_MODEL,languageModel);
  voiceIntent.putExtra(RecognizerIntent.EXTRA_PROMPT,prompt);
  voiceIntent.putExtra(RecognizerIntent.EXTRA_LANGUAGE,language);
  voiceIntent.putExtra(RecognizerIntent.EXTRA_MAX_RESULTS,maxResults);
  voiceIntent.putExtra(EXTRA_CALLING_PACKAGE,searchActivity == null ? null : searchActivity.toShortString());
  voiceIntent.putExtra(RecognizerIntent.EXTRA_RESULTS_PENDINGINTENT,pending);
  voiceIntent.putExtra(RecognizerIntent.EXTRA_RESULTS_PENDINGINTENT_BUNDLE,queryExtras);
  return voiceIntent;
}
