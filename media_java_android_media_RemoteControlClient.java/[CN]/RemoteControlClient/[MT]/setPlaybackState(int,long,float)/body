{
synchronized (mCacheLock) {
    if ((mPlaybackState != state) || (mPlaybackPositionMs != timeInMs) || (mPlaybackSpeed != playbackSpeed)) {
      mPlaybackState=state;
      mPlaybackPositionMs=timeInMs;
      mPlaybackSpeed=playbackSpeed;
      mPlaybackStateChangeTimeMs=SystemClock.elapsedRealtime();
      sendPlaybackState_syncCacheLock();
      sendAudioServiceNewPlaybackState_syncCacheLock();
      if (mEventHandler == null) {
        return;
      }
      mEventHandler.removeMessages(MSG_POSITION_DRIFT_CHECK);
      if (timeInMs == PLAYBACK_POSITION_INVALID) {
        return;
      }
      if (playbackPositionShouldMove(mPlaybackState)) {
        mEventHandler.sendMessageDelayed(mEventHandler.obtainMessage(MSG_POSITION_DRIFT_CHECK),getCheckPeriodFromSpeed(playbackSpeed));
      }
    }
  }
}
