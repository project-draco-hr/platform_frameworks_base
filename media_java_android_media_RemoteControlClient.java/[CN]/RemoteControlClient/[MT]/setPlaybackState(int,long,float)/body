{
synchronized (mCacheLock) {
    if (timeInMs != PLAYBACK_POSITION_INVALID) {
      mPlaybackPositionCapabilities|=MEDIA_POSITION_READABLE;
    }
 else {
      mPlaybackPositionCapabilities&=~MEDIA_POSITION_READABLE;
    }
    if ((mPlaybackState != state) || (mPlaybackPositionMs != timeInMs) || (mPlaybackSpeed != playbackSpeed)) {
      mPlaybackState=state;
      mPlaybackPositionMs=timeInMs;
      mPlaybackSpeed=playbackSpeed;
      mPlaybackStateChangeTimeMs=SystemClock.elapsedRealtime();
      sendPlaybackState_syncCacheLock();
      sendAudioServiceNewPlaybackState_syncCacheLock();
    }
  }
}
