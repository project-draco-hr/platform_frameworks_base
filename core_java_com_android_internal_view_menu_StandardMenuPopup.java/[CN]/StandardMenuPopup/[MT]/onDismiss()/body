{
  wasDismissed=true;
  mMenu.close();
  if (mTreeObserver != null) {
    if (!mTreeObserver.isAlive())     mTreeObserver=mShownAnchorView.getViewTreeObserver();
    mTreeObserver.removeGlobalOnLayoutListener(this);
    mTreeObserver=null;
  }
  mShownAnchorView.removeOnAttachStateChangeListener(this);
  mOnDismissListener.onDismiss();
}
