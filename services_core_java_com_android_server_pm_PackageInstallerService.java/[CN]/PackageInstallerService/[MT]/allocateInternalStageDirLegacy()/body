{
synchronized (mSessions) {
    try {
      final int sessionId=allocateSessionIdLocked();
      mLegacySessions.put(sessionId,true);
      final File stageDir=buildInternalStageDir(sessionId);
      prepareInternalStageDir(stageDir);
      return stageDir;
    }
 catch (    IllegalStateException e) {
      throw new IOException(e);
    }
  }
}
