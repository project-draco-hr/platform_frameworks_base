{
  mPm.enforceCrossUserPermission(Binder.getCallingUid(),userId,true,false,"uninstall");
  final PackageDeleteObserverAdapter adapter=new PackageDeleteObserverAdapter(mContext,statusReceiver,packageName);
  if (mContext.checkCallingOrSelfPermission(android.Manifest.permission.DELETE_PACKAGES) == PackageManager.PERMISSION_GRANTED) {
    mPm.deletePackage(packageName,adapter.getBinder(),userId,flags);
  }
 else {
    final Intent intent=new Intent(Intent.ACTION_UNINSTALL_PACKAGE);
    intent.setData(Uri.fromParts("package",packageName,null));
    intent.putExtra(PackageInstaller.EXTRA_CALLBACK,adapter.getBinder().asBinder());
    adapter.onUserActionRequired(intent);
  }
}
