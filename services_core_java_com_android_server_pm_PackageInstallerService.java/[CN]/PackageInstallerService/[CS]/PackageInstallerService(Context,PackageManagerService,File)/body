{
  mContext=context;
  mPm=pm;
  mAppOps=(AppOpsManager)mContext.getSystemService(Context.APP_OPS_SERVICE);
  mStagingDir=stagingDir;
  mInstallThread=new HandlerThread(TAG);
  mInstallThread.start();
synchronized (mSessions) {
    readSessionsLocked();
    final ArraySet<File> stages=Sets.newArraySet(mStagingDir.listFiles(sStageFilter));
    for (int i=0; i < mSessions.size(); i++) {
      final PackageInstallerSession session=mSessions.valueAt(i);
      stages.remove(session.sessionStageDir);
    }
    for (    File stage : stages) {
      Slog.w(TAG,"Deleting orphan stage " + stage);
      if (stage.isDirectory()) {
        FileUtils.deleteContents(stage);
      }
      stage.delete();
    }
  }
}
