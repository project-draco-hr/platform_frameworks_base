{
  final int pid=Binder.getCallingPid();
  final int uid=Binder.getCallingUid();
  final long token=Binder.clearCallingIdentity();
  try {
    String packageName=null;
    if (componentName != null) {
      packageName=componentName.getPackageName();
      enforcePackageName(packageName,uid);
    }
    int resolvedUserId=ActivityManager.handleIncomingUser(pid,uid,userId,true,true,"getSessions",packageName);
    enforceMediaPermissions(componentName,pid,uid,resolvedUserId);
    ArrayList<IBinder> binders=new ArrayList<IBinder>();
synchronized (mLock) {
      ArrayList<MediaSessionRecord> records=mPriorityStack.getActiveSessions(resolvedUserId);
      int size=records.size();
      for (int i=0; i < size; i++) {
        binders.add(records.get(i).getControllerBinder().asBinder());
      }
    }
    return binders;
  }
  finally {
    Binder.restoreCallingIdentity(token);
  }
}
