{
  if (session != null) {
    if (DEBUG) {
      Log.d(TAG,"Sending media key to " + session.getSessionInfo());
    }
    if (needWakeLock) {
      mKeyEventReceiver.aquireWakeLockLocked();
    }
    session.sendMediaButton(keyEvent,needWakeLock ? mKeyEventReceiver.mLastTimeoutId : -1,mKeyEventReceiver);
  }
 else {
    if (needWakeLock) {
      mMediaEventWakeLock.acquire();
    }
    if (DEBUG) {
      Log.d(TAG,"Sending media key ordered broadcast");
    }
    Intent keyIntent=new Intent(Intent.ACTION_MEDIA_BUTTON,null);
    keyIntent.putExtra(Intent.EXTRA_KEY_EVENT,keyEvent);
    if (needWakeLock) {
      keyIntent.putExtra(EXTRA_WAKELOCK_ACQUIRED,WAKELOCK_RELEASE_ON_FINISHED);
    }
    getContext().sendOrderedBroadcastAsUser(keyIntent,UserHandle.ALL,null,mKeyEventDone,mHandler,Activity.RESULT_OK,null,null);
  }
}
