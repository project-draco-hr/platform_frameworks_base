{
  final int pid=Binder.getCallingPid();
  final int uid=Binder.getCallingUid();
  final long token=Binder.clearCallingIdentity();
  try {
    enforcePackageName(packageName,uid);
    int resolvedUserId=ActivityManager.handleIncomingUser(pid,uid,userId,false,true,"createSession",packageName);
    if (cb == null) {
      throw new IllegalArgumentException("Controller callback cannot be null");
    }
    return createSessionInternal(pid,uid,resolvedUserId,packageName,cb,tag).getSessionBinder();
  }
  finally {
    Binder.restoreCallingIdentity(token);
  }
}
