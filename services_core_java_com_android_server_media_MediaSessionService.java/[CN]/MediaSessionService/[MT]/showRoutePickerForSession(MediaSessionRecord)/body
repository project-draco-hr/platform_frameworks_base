{
synchronized (mLock) {
    if (!mAllSessions.contains(record)) {
      Log.d(TAG,"Unknown session tried to show route picker. Ignoring.");
      return;
    }
    RouteInfo current=record.getRoute();
    UserRecord user=mUserRecords.get(record.getUserId());
    if (current != null) {
      MediaRouteProviderProxy proxy=user.getProviderLocked(current.getProvider());
      if (proxy != null) {
        proxy.removeSession(record);
      }
      record.selectRoute(null);
      return;
    }
    ArrayList<MediaRouteProviderProxy> providers=user.getProvidersLocked();
    mShowRoutesRequestId++;
    for (int i=providers.size() - 1; i >= 0; i--) {
      MediaRouteProviderProxy provider=providers.get(i);
      provider.getRoutes(record,mShowRoutesRequestId);
    }
  }
}
