{
  final MediaSessionRecord session=new MediaSessionRecord(callerPid,callerUid,userId,callerPackageName,cb,tag,this,mHandler);
  try {
    cb.asBinder().linkToDeath(session,0);
  }
 catch (  RemoteException e) {
    throw new RuntimeException("Media Session owner died prematurely.",e);
  }
  mAllSessions.add(session);
  mPriorityStack.addSession(session);
  UserRecord user=getOrCreateUser(userId);
  user.addSessionLocked(session);
  mHandler.post(MessageHandler.MSG_SESSIONS_CHANGED,userId,0);
  if (DEBUG) {
    Log.d(TAG,"Created session for package " + callerPackageName + " with tag "+ tag);
  }
  return session;
}
