{
{
    int stabModes[]=p.isVideoStabilizationSupported() ? new int[]{CONTROL_VIDEO_STABILIZATION_MODE_OFF,CONTROL_VIDEO_STABILIZATION_MODE_ON} : new int[]{CONTROL_VIDEO_STABILIZATION_MODE_OFF};
    m.set(CONTROL_AVAILABLE_VIDEO_STABILIZATION_MODES,stabModes);
  }
  final int AE=0, AWB=1, AF=2;
  int[] maxRegions=new int[3];
  maxRegions[AE]=p.getMaxNumMeteringAreas();
  maxRegions[AWB]=0;
  maxRegions[AF]=p.getMaxNumFocusAreas();
  if (LIE_ABOUT_AE_MAX_REGIONS) {
    maxRegions[AE]=0;
  }
  if (LIE_ABOUT_AF_MAX_REGIONS) {
    maxRegions[AF]=0;
  }
  m.set(CONTROL_MAX_REGIONS,maxRegions);
  List<String> effectModes=p.getSupportedColorEffects();
  int[] supportedEffectModes=(effectModes == null) ? new int[0] : ArrayUtils.convertStringListToIntArray(effectModes,sLegacyEffectMode,sEffectModes);
  m.set(CONTROL_AVAILABLE_EFFECTS,supportedEffectModes);
  int maxNumDetectedFaces=p.getMaxNumDetectedFaces();
  List<String> sceneModes=p.getSupportedSceneModes();
  List<Integer> supportedSceneModes=ArrayUtils.convertStringListToIntList(sceneModes,sLegacySceneModes,sSceneModes);
  if (sceneModes != null && sceneModes.size() == 1 && sceneModes.get(0) == Parameters.SCENE_MODE_AUTO) {
    supportedSceneModes=null;
  }
  boolean sceneModeSupported=true;
  if (supportedSceneModes == null && maxNumDetectedFaces == 0) {
    sceneModeSupported=false;
  }
  if (sceneModeSupported) {
    if (supportedSceneModes == null) {
      supportedSceneModes=new ArrayList<Integer>();
    }
    if (maxNumDetectedFaces > 0) {
      supportedSceneModes.add(CONTROL_SCENE_MODE_FACE_PRIORITY);
    }
    if (supportedSceneModes.contains(CONTROL_SCENE_MODE_DISABLED)) {
      while (supportedSceneModes.remove(new Integer(CONTROL_SCENE_MODE_DISABLED))) {
      }
    }
    m.set(CONTROL_AVAILABLE_SCENE_MODES,ArrayUtils.toIntArray(supportedSceneModes));
  }
 else {
    m.set(CONTROL_AVAILABLE_SCENE_MODES,new int[]{CONTROL_SCENE_MODE_DISABLED});
  }
  m.set(CONTROL_AVAILABLE_MODES,sceneModeSupported ? new int[]{CONTROL_MODE_AUTO,CONTROL_MODE_USE_SCENE_MODE} : new int[]{CONTROL_MODE_AUTO});
}
