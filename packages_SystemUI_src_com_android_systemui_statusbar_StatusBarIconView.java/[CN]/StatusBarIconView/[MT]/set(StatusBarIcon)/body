{
  final boolean iconEquals=mIcon != null && streq(mIcon.iconPackage,icon.iconPackage) && mIcon.iconId == icon.iconId;
  final boolean levelEquals=iconEquals && mIcon.iconLevel == icon.iconLevel;
  final boolean visibilityEquals=mIcon != null && mIcon.visible == icon.visible;
  final boolean numberEquals=mIcon != null && mIcon.number == icon.number;
  mIcon=icon.clone();
  if (!iconEquals) {
    Drawable drawable=getIcon(icon);
    if (drawable == null) {
      Slog.w(StatusBar.TAG,"No icon for slot " + mSlot);
      return false;
    }
    setImageDrawable(drawable);
  }
  if (!levelEquals) {
    setImageLevel(icon.iconLevel);
  }
  if (!numberEquals) {
    if (icon.number > 0 && mContext.getResources().getBoolean(R.bool.config_statusBarShowNumber)) {
      if (mNumberBackground == null) {
        mNumberBackground=getContext().getResources().getDrawable(R.drawable.ic_notification_overlay);
      }
      placeNumber();
    }
 else {
      mNumberBackground=null;
      mNumberText=null;
    }
    invalidate();
  }
  if (!visibilityEquals) {
    setVisibility(icon.visible ? VISIBLE : GONE);
  }
  return true;
}
