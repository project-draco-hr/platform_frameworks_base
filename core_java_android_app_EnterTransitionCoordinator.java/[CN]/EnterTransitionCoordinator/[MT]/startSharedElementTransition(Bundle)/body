{
  ArrayList<String> rejectedNames=new ArrayList<String>(mAllSharedElementNames);
  rejectedNames.removeAll(mSharedElementNames);
  ArrayList<View> rejectedSnapshots=createSnapshots(sharedElementState,rejectedNames);
  mListener.handleRejectedSharedElements(rejectedSnapshots);
  startRejectedAnimations(rejectedSnapshots);
  ArrayList<View> sharedElementSnapshots=createSnapshots(sharedElementState,mSharedElementNames);
  setViewVisibility(mSharedElements,View.VISIBLE);
  ArrayMap<ImageView,Pair<ImageView.ScaleType,Matrix>> originalImageViewState=setSharedElementState(sharedElementState,sharedElementSnapshots);
  requestLayoutForSharedElements();
  boolean startEnterTransition=allowOverlappingTransitions() && !mIsReturning;
  boolean startSharedElementTransition=true;
  Transition transition=beginTransition(startEnterTransition,startSharedElementTransition);
  if (startEnterTransition) {
    startEnterTransition(transition);
  }
  setOriginalImageViewState(originalImageViewState);
  if (mResultReceiver != null) {
    getDecor().postOnAnimation(new Runnable(){
      int mAnimations;
      @Override public void run(){
        if (mAnimations++ < MIN_ANIMATION_FRAMES) {
          getDecor().postOnAnimation(this);
        }
 else {
          mResultReceiver.send(MSG_HIDE_SHARED_ELEMENTS,null);
          mResultReceiver=null;
        }
      }
    }
);
  }
}
