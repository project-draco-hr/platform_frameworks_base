{
  super(activity.getWindow(),sharedElementNames,getListener(activity,isReturning),isReturning);
  mActivity=activity;
  setResultReceiver(resultReceiver);
  prepareEnter();
  Bundle resultReceiverBundle=new Bundle();
  resultReceiverBundle.putParcelable(KEY_REMOTE_RECEIVER,this);
  mResultReceiver.send(MSG_SET_REMOTE_RECEIVER,resultReceiverBundle);
  final View decorView=getDecor();
  if (decorView != null) {
    decorView.getViewTreeObserver().addOnPreDrawListener(new ViewTreeObserver.OnPreDrawListener(){
      @Override public boolean onPreDraw(){
        if (mIsReadyForTransition) {
          decorView.getViewTreeObserver().removeOnPreDrawListener(this);
        }
        return mIsReadyForTransition;
      }
    }
);
  }
}
