{
  final int mode=MeasureSpec.getMode(measureSpec);
switch (mode) {
case MeasureSpec.EXACTLY:
    return MeasureSpec.getSize(measureSpec);
case MeasureSpec.AT_MOST:
  return Math.min(MeasureSpec.getSize(measureSpec),maxValue);
case MeasureSpec.UNSPECIFIED:
return maxValue;
default :
throw new IllegalArgumentException();
}
}
