{
  update();
  final int count=canvas.save();
  final float y=mBounds.height();
  final float centerY=y - mRadius;
  final float centerX=mBounds.centerX();
  mArcRect.set(centerX - mRadius,centerY - mRadius,centerX + mRadius,centerY + mRadius);
  canvas.scale(1.f,Math.min(mGlowScaleY,1.f),centerX,0);
  final float displacement=Math.max(0,Math.min(mDisplacement,1.f)) - 0.5f;
  float translateX=mBounds.width() * displacement;
  float translateY=0;
  if (mGlowScaleY > 1.f) {
    translateY=(mGlowScaleY - 1.f) * mBounds.height();
  }
  canvas.clipRect(Float.MIN_VALUE,mBounds.top,Float.MAX_VALUE,Float.MAX_VALUE);
  canvas.translate(translateX,translateY);
  canvas.drawArc(mArcRect,0,180,true,mPaint);
  canvas.restoreToCount(count);
  boolean oneLastFrame=false;
  if (mState == STATE_RECEDE && mGlowScaleY == 0) {
    mState=STATE_IDLE;
    oneLastFrame=true;
  }
  return mState != STATE_IDLE || oneLastFrame;
}
