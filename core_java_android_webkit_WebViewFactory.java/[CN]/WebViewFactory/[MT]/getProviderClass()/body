{
  try {
    Trace.traceBegin(Trace.TRACE_TAG_WEBVIEW,"WebViewFactory.waitForProviderAndSetPackageInfo()");
    try {
      int res=waitForProviderAndSetPackageInfo();
      if (res != LIBLOAD_SUCCESS) {
        throw new MissingWebViewPackageException("Failed to load WebView provider, error: " + getWebViewPreparationErrorReason(res));
      }
    }
  finally {
      Trace.traceEnd(Trace.TRACE_TAG_WEBVIEW);
    }
    Log.i(LOGTAG,"Loading " + sPackageInfo.packageName + " version "+ sPackageInfo.versionName+ " (code "+ sPackageInfo.versionCode+ ")");
    Application initialApplication=AppGlobals.getInitialApplication();
    Context webViewContext=null;
    Trace.traceBegin(Trace.TRACE_TAG_WEBVIEW,"PackageManager.getApplicationInfo()");
    try {
      ApplicationInfo applicationInfo=initialApplication.getPackageManager().getApplicationInfo(sPackageInfo.packageName,PackageManager.GET_SHARED_LIBRARY_FILES | PackageManager.MATCH_DEBUG_TRIAGED_MISSING | PackageManager.MATCH_UNINSTALLED_PACKAGES);
      Trace.traceBegin(Trace.TRACE_TAG_WEBVIEW,"initialApplication.createApplicationContext");
      try {
        webViewContext=initialApplication.createApplicationContext(applicationInfo,Context.CONTEXT_INCLUDE_CODE | Context.CONTEXT_IGNORE_SECURITY);
      }
  finally {
        Trace.traceEnd(Trace.TRACE_TAG_WEBVIEW);
      }
    }
 catch (    PackageManager.NameNotFoundException e) {
      throw new MissingWebViewPackageException(e);
    }
 finally {
      Trace.traceEnd(Trace.TRACE_TAG_WEBVIEW);
    }
    Trace.traceBegin(Trace.TRACE_TAG_WEBVIEW,"WebViewFactory.loadNativeLibrary()");
    loadNativeLibrary();
    Trace.traceEnd(Trace.TRACE_TAG_WEBVIEW);
    Trace.traceBegin(Trace.TRACE_TAG_WEBVIEW,"WebViewFactory.getChromiumProviderClass()");
    try {
      initialApplication.getAssets().addAssetPathAsSharedLibrary(webViewContext.getApplicationInfo().sourceDir);
      ClassLoader clazzLoader=webViewContext.getClassLoader();
      Trace.traceBegin(Trace.TRACE_TAG_WEBVIEW,"Class.forName()");
      try {
        return (Class<WebViewFactoryProvider>)Class.forName(CHROMIUM_WEBVIEW_FACTORY,true,clazzLoader);
      }
  finally {
        Trace.traceEnd(Trace.TRACE_TAG_WEBVIEW);
      }
    }
 catch (    ClassNotFoundException e) {
      Log.e(LOGTAG,"error loading provider",e);
      throw new AndroidRuntimeException(e);
    }
 finally {
      Trace.traceEnd(Trace.TRACE_TAG_WEBVIEW);
    }
  }
 catch (  MissingWebViewPackageException e) {
    try {
      return (Class<WebViewFactoryProvider>)Class.forName(NULL_WEBVIEW_FACTORY);
    }
 catch (    ClassNotFoundException e2) {
    }
    Log.e(LOGTAG,"Chromium WebView package does not exist",e);
    throw new AndroidRuntimeException(e);
  }
}
