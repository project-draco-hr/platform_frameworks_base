{
  if (family == null) {
    return null;
  }
  String ttf=mFamilyToTtf.get(family);
  if (ttf == null) {
    return null;
  }
  Map<Integer,Font> styleMap=mTtfToFontMap.get(ttf);
  if (styleMap == null) {
    styleMap=new HashMap<Integer,Font>();
    mTtfToFontMap.put(ttf,styleMap);
  }
  Font f=styleMap.get(style);
  if (f != null) {
    return f;
  }
switch (style[0]) {
case Typeface.NORMAL:
    f=getFont(ttf,FONT_STYLES[Typeface.NORMAL]);
  break;
case Typeface.BOLD:
case Typeface.ITALIC:
f=getFont(ttf,FONT_STYLES[style[0]]);
if (f == null) {
f=getFont(ttf,FONT_STYLES[Typeface.NORMAL]);
style[0]=Typeface.NORMAL;
}
break;
case Typeface.BOLD_ITALIC:
f=getFont(ttf,FONT_STYLES[style[0]]);
if (f == null) {
f=getFont(ttf,FONT_STYLES[Typeface.BOLD]);
if (f != null) {
style[0]=Typeface.BOLD;
}
 else {
f=getFont(ttf,FONT_STYLES[Typeface.ITALIC]);
if (f != null) {
style[0]=Typeface.ITALIC;
}
 else {
f=getFont(ttf,FONT_STYLES[Typeface.NORMAL]);
style[0]=Typeface.NORMAL;
}
}
}
break;
}
if (f != null) {
styleMap.put(style[0],f);
return f;
}
return null;
}
