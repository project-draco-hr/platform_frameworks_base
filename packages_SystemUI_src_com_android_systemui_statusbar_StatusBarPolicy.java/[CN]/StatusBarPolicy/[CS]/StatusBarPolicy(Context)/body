{
  mContext=context;
  mService=(StatusBarManager)context.getSystemService(Context.STATUS_BAR_SERVICE);
  mSignalStrength=new SignalStrength();
  mBatteryStats=BatteryStatsService.getService();
  mStorageManager=(StorageManager)context.getSystemService(Context.STORAGE_SERVICE);
  mStorageManager.registerListener(new com.android.systemui.usb.StorageNotification(context));
  mService.setIcon("battery",com.android.internal.R.drawable.stat_sys_battery_unknown,0);
  mPhone=(TelephonyManager)context.getSystemService(Context.TELEPHONY_SERVICE);
  mPhoneSignalIconId=R.drawable.stat_sys_signal_null;
  mService.setIcon("phone_signal",mPhoneSignalIconId,0);
  ((TelephonyManager)mContext.getSystemService(Context.TELEPHONY_SERVICE)).listen(mPhoneStateListener,PhoneStateListener.LISTEN_SERVICE_STATE | PhoneStateListener.LISTEN_SIGNAL_STRENGTHS | PhoneStateListener.LISTEN_CALL_STATE| PhoneStateListener.LISTEN_DATA_CONNECTION_STATE| PhoneStateListener.LISTEN_DATA_ACTIVITY);
  mService.setIcon("data_connection",R.drawable.stat_sys_data_connected_g,0);
  mService.setIconVisibility("data_connection",false);
  mService.setIcon("wifi",sWifiSignalImages[0][0],0);
  mService.setIconVisibility("wifi",false);
  boolean isWimaxEnabled=mContext.getResources().getBoolean(com.android.internal.R.bool.config_wimaxEnabled);
  if (isWimaxEnabled) {
    mService.setIcon("wimax",sWimaxDisconnectedImg,0);
    mService.setIconVisibility("wimax",false);
  }
  mService.setIcon("tty",R.drawable.stat_sys_tty_mode,0);
  mService.setIconVisibility("tty",false);
  mService.setIcon("cdma_eri",R.drawable.stat_sys_roaming_cdma_0,0);
  mService.setIconVisibility("cdma_eri",false);
  mService.setIcon("bluetooth",R.drawable.stat_sys_data_bluetooth,0);
  BluetoothAdapter adapter=BluetoothAdapter.getDefaultAdapter();
  if (adapter != null) {
    mBluetoothEnabled=adapter.isEnabled();
  }
 else {
    mBluetoothEnabled=false;
  }
  mBluetoothA2dpConnected=false;
  mBluetoothHeadsetState=BluetoothHeadset.STATE_DISCONNECTED;
  mBluetoothPbapState=BluetoothPbap.STATE_DISCONNECTED;
  mService.setIconVisibility("bluetooth",mBluetoothEnabled);
  mService.setIcon("gps",R.drawable.stat_sys_gps_acquiring_anim,0);
  mService.setIconVisibility("gps",false);
  mService.setIcon("alarm_clock",R.drawable.stat_notify_alarm,0);
  mService.setIconVisibility("alarm_clock",false);
  mService.setIcon("sync_active",com.android.internal.R.drawable.stat_notify_sync_anim0,0);
  mService.setIcon("sync_failing",com.android.internal.R.drawable.stat_notify_sync_error,0);
  mService.setIconVisibility("sync_active",false);
  mService.setIconVisibility("sync_failing",false);
  mService.setIcon("volume",R.drawable.stat_sys_ringer_silent,0);
  mService.setIconVisibility("volume",false);
  updateVolume();
  IntentFilter filter=new IntentFilter();
  filter.addAction(Intent.ACTION_BATTERY_CHANGED);
  filter.addAction(Intent.ACTION_BATTERY_LOW);
  filter.addAction(Intent.ACTION_BATTERY_OKAY);
  filter.addAction(Intent.ACTION_POWER_CONNECTED);
  filter.addAction(Intent.ACTION_ALARM_CHANGED);
  filter.addAction(Intent.ACTION_SYNC_STATE_CHANGED);
  filter.addAction(AudioManager.RINGER_MODE_CHANGED_ACTION);
  filter.addAction(AudioManager.VIBRATE_SETTING_CHANGED_ACTION);
  filter.addAction(BluetoothAdapter.ACTION_STATE_CHANGED);
  filter.addAction(BluetoothHeadset.ACTION_STATE_CHANGED);
  filter.addAction(BluetoothA2dp.ACTION_SINK_STATE_CHANGED);
  filter.addAction(BluetoothPbap.PBAP_STATE_CHANGED_ACTION);
  filter.addAction(WifiManager.WIFI_STATE_CHANGED_ACTION);
  filter.addAction(WifiManager.SUPPLICANT_CONNECTION_CHANGE_ACTION);
  filter.addAction(WifiManager.NETWORK_STATE_CHANGED_ACTION);
  filter.addAction(WifiManager.RSSI_CHANGED_ACTION);
  filter.addAction(LocationManager.GPS_ENABLED_CHANGE_ACTION);
  filter.addAction(LocationManager.GPS_FIX_CHANGE_ACTION);
  filter.addAction(TelephonyIntents.ACTION_SIM_STATE_CHANGED);
  filter.addAction(TtyIntent.TTY_ENABLED_CHANGE_ACTION);
  filter.addAction(ConnectivityManager.CONNECTIVITY_ACTION);
  filter.addAction(ConnectivityManager.INET_CONDITION_ACTION);
  filter.addAction(WimaxManagerConstants.WIMAX_STATE_CHANGED_ACTION);
  filter.addAction(WimaxManagerConstants.SIGNAL_LEVEL_CHANGED_ACTION);
  filter.addAction(WimaxManagerConstants.WIMAX_ENABLED_STATUS_CHANGED);
  mContext.registerReceiver(mIntentReceiver,filter,null,mHandler);
  try {
    mHspaDataDistinguishable=mContext.getResources().getBoolean(R.bool.config_hspa_data_distinguishable);
  }
 catch (  Exception e) {
    mHspaDataDistinguishable=false;
  }
}
