{
  if (surfaces == null || surfaces.size() == 0) {
    throw new IllegalStateException("No Surfaces were provided to draw to");
  }
  int maxLength=0;
  int[] dimens=new int[2];
  for (  EGLSurfaceHolder holder : surfaces) {
    LegacyCameraDevice.nativeDetectSurfaceDimens(holder.surface,dimens);
    int length=dimens[0] * dimens[1];
    maxLength=(length > maxLength) ? length : maxLength;
    int[] surfaceAttribs={EGL14.EGL_WIDTH,dimens[0],EGL14.EGL_HEIGHT,dimens[1],EGL14.EGL_NONE};
    holder.width=dimens[0];
    holder.height=dimens[1];
    holder.eglSurface=EGL14.eglCreatePbufferSurface(mEGLDisplay,mConfigs,surfaceAttribs,0);
    checkEglError("eglCreatePbufferSurface");
  }
  mPBufferPixels=ByteBuffer.allocateDirect(maxLength * PBUFFER_PIXEL_BYTES).order(ByteOrder.nativeOrder());
}
