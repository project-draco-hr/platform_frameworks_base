{
  int widthMode=MeasureSpec.getMode(widthMeasureSpec);
  if (widthMode != MeasureSpec.EXACTLY) {
    throw new IllegalStateException(getClass().getSimpleName() + " can only be used " + "with android:layout_width=\"match_parent\" (or fill_parent)");
  }
  int heightMode=MeasureSpec.getMode(heightMeasureSpec);
  if (heightMode != MeasureSpec.AT_MOST) {
    throw new IllegalStateException(getClass().getSimpleName() + " can only be used " + "with android:layout_height=\"wrap_content\"");
  }
  int contentWidth=MeasureSpec.getSize(widthMeasureSpec);
  int maxHeight=mContentHeight > 0 ? mContentHeight : MeasureSpec.getSize(heightMeasureSpec);
  final int verticalPadding=getPaddingTop() + getPaddingBottom();
  int availableWidth=contentWidth - getPaddingLeft() - getPaddingRight();
  final int height=maxHeight - verticalPadding;
  final int childSpecHeight=MeasureSpec.makeMeasureSpec(height,MeasureSpec.AT_MOST);
  if (mLogoView != null && mLogoView.getVisibility() != GONE) {
    availableWidth=measureChildView(mLogoView,availableWidth,childSpecHeight,mSpacing);
  }
  if (mIconView != null && mIconView.getVisibility() != GONE) {
    availableWidth=measureChildView(mIconView,availableWidth,childSpecHeight,mSpacing);
  }
  if (mMenuView != null) {
    availableWidth=measureChildView(mMenuView,availableWidth,childSpecHeight,0);
  }
switch (mNavigationMode) {
case ActionBar.NAVIGATION_MODE_STANDARD:
    if (mTitleLayout != null) {
      measureChildView(mTitleLayout,availableWidth,childSpecHeight,mSpacing);
    }
  break;
case ActionBar.NAVIGATION_MODE_DROPDOWN_LIST:
if (mSpinner != null) {
  mSpinner.measure(MeasureSpec.makeMeasureSpec(availableWidth,MeasureSpec.AT_MOST),MeasureSpec.makeMeasureSpec(height,MeasureSpec.AT_MOST));
}
break;
case ActionBar.NAVIGATION_MODE_CUSTOM:
if (mCustomNavView != null) {
LayoutParams lp=mCustomNavView.getLayoutParams();
final int customNavWidthMode=lp.width != LayoutParams.WRAP_CONTENT ? MeasureSpec.EXACTLY : MeasureSpec.AT_MOST;
final int customNavWidth=lp.width >= 0 ? Math.min(lp.width,availableWidth) : availableWidth;
int customNavHeightMode;
if (mContentHeight <= 0) {
customNavHeightMode=MeasureSpec.AT_MOST;
}
 else {
customNavHeightMode=lp.height != LayoutParams.WRAP_CONTENT ? MeasureSpec.EXACTLY : MeasureSpec.AT_MOST;
}
final int customNavHeight=lp.height >= 0 ? Math.min(lp.height,height) : height;
mCustomNavView.measure(MeasureSpec.makeMeasureSpec(customNavWidth,customNavWidthMode),MeasureSpec.makeMeasureSpec(customNavHeight,customNavHeightMode));
}
break;
case ActionBar.NAVIGATION_MODE_TABS:
if (mTabLayout != null) {
mTabLayout.measure(MeasureSpec.makeMeasureSpec(availableWidth,MeasureSpec.AT_MOST),MeasureSpec.makeMeasureSpec(height,MeasureSpec.AT_MOST));
}
break;
}
if (mContentHeight <= 0) {
int measuredHeight=0;
final int count=getChildCount();
for (int i=0; i < count; i++) {
View v=getChildAt(i);
int paddedViewHeight=v.getMeasuredHeight() + verticalPadding;
if (paddedViewHeight > measuredHeight) {
measuredHeight=paddedViewHeight;
}
}
setMeasuredDimension(contentWidth,measuredHeight);
}
 else {
setMeasuredDimension(contentWidth,maxHeight);
}
if (mContextView != null) {
mContextView.setHeight(getMeasuredHeight());
}
}
