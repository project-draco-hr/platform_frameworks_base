{
  if (task != null && task.removeActivity(this)) {
    if (task != newTask) {
      mStackSupervisor.removeTask(task);
    }
 else {
      Slog.d(TAG,"!!! REMOVE THIS LOG !!! setTask: nearly removed stack=" + (newTask == null ? null : newTask.stack));
    }
  }
  if (inHistory && !finishing) {
    if (task != null) {
      task.numActivities--;
    }
    if (newTask != null) {
      newTask.numActivities++;
    }
  }
  if (newThumbHolder == null) {
    newThumbHolder=newTask;
  }
  task=newTask;
  if (!isRoot && (intent.getFlags() & Intent.FLAG_ACTIVITY_CLEAR_WHEN_TASK_RESET) != 0) {
    if (thumbHolder == null) {
      thumbHolder=new ThumbnailHolder();
    }
  }
 else {
    thumbHolder=newThumbHolder;
  }
}
