{
  ActivityRecord r=this;
  if (r.waitingVisible) {
    r=stack.mResumedActivity;
    if (r == null) {
      if (stack.mPausingActivities.size() > 0) {
        r=stack.mPausingActivities.get(stack.mPausingActivities.size() - 1);
      }
    }
    if (r == null) {
      r=this;
    }
  }
  return r;
}
