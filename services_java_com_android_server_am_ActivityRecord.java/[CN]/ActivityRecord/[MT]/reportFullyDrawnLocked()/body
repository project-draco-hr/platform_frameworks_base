{
  final long curTime=SystemClock.uptimeMillis();
  if (displayStartTime != 0) {
    reportLaunchTimeLocked(curTime);
  }
  if (fullyDrawnStartTime != 0) {
    final ActivityStack stack=task.stack;
    final long thisTime=curTime - fullyDrawnStartTime;
    final long totalTime=stack.mFullyDrawnStartTime != 0 ? (curTime - stack.mFullyDrawnStartTime) : thisTime;
    if (ActivityManagerService.SHOW_ACTIVITY_START_TIME) {
      Trace.traceCounter(Trace.TRACE_TAG_ACTIVITY_MANAGER,"fully-drawn",(int)totalTime);
      EventLog.writeEvent(EventLogTags.AM_ACTIVITY_FULLY_DRAWN_TIME,userId,System.identityHashCode(this),shortComponentName,thisTime,totalTime);
      StringBuilder sb=service.mStringBuilder;
      sb.setLength(0);
      sb.append("Fully drawn ");
      sb.append(shortComponentName);
      sb.append(": ");
      TimeUtils.formatDuration(thisTime,sb);
      if (thisTime != totalTime) {
        sb.append(" (total ");
        TimeUtils.formatDuration(totalTime,sb);
        sb.append(")");
      }
      Log.i(ActivityManagerService.TAG,sb.toString());
    }
    if (totalTime > 0) {
      service.mUsageStatsService.noteFullyDrawnTime(realActivity,(int)totalTime);
    }
    fullyDrawnStartTime=0;
    stack.mFullyDrawnStartTime=0;
  }
}
