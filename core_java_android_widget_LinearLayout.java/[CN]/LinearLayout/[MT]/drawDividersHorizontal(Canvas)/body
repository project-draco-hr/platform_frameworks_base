{
  final int count=getVirtualChildCount();
  for (int i=0; i < count; i++) {
    final View child=getVirtualChildAt(i);
    if (child != null && child.getVisibility() != GONE) {
      if (hasDividerBeforeChildAt(i)) {
        final LayoutParams lp=(LayoutParams)child.getLayoutParams();
        final int left=child.getLeft() - lp.leftMargin - mDividerWidth;
        drawVerticalDivider(canvas,left);
      }
    }
  }
  if (hasDividerBeforeChildAt(count)) {
    final View child=getVirtualChildAt(count - 1);
    int right=0;
    if (child == null) {
      right=getWidth() - getPaddingRight() - mDividerWidth;
    }
 else {
      final LayoutParams lp=(LayoutParams)child.getLayoutParams();
      right=child.getRight() + lp.rightMargin;
    }
    drawVerticalDivider(canvas,right);
  }
}
