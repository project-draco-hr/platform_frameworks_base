{
  byte[] buffer=new byte[MidiDevice.MAX_PACKED_MESSAGE_SIZE];
  while (true) {
    try {
      int count=readMessage(buffer);
      if (count > 0) {
synchronized (mOutputStreams) {
          for (int i=0; i < mOutputStreams.size(); i++) {
            FileOutputStream fos=mOutputStreams.get(i);
            try {
              fos.write(buffer,0,count);
            }
 catch (            IOException e) {
              Log.e(TAG,"write failed",e);
              mOutputStreams.remove(fos);
            }
          }
        }
      }
    }
 catch (    IOException e) {
      Log.e(TAG,"read failed",e);
      break;
    }
  }
}
