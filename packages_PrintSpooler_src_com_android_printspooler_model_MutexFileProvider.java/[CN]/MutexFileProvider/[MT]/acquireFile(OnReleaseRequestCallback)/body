{
synchronized (mLock) {
    if (mOwnerThread == Thread.currentThread()) {
      return mFile;
    }
    if (mOwnerThread != null && mOnReleaseRequestCallback != null) {
      mOnReleaseRequestCallback.onReleaseRequested(mFile);
    }
    while (mOwnerThread != null) {
      try {
        mLock.wait();
      }
 catch (      InterruptedException ie) {
      }
    }
    mOwnerThread=Thread.currentThread();
    mOnReleaseRequestCallback=callback;
    if (DEBUG) {
      Log.i(LOG_TAG,"Acquired file: " + mFile + " by thread: "+ mOwnerThread);
    }
    return mFile;
  }
}
