{
  int uid=Binder.getCallingUid();
  boolean isSystem=(UserHandle.getAppId(uid) == Process.SYSTEM_UID || uid == 0);
  if (!(isSystem || packageCanTapNotificationsForUser(uid,pkg))) {
    throw new SecurityException("Package " + pkg + " may not listen for notifications");
  }
synchronized (mNotificationList) {
    try {
      NotificationListenerInfo info=new NotificationListenerInfo(listener,pkg,userid,isSystem);
      listener.asBinder().linkToDeath(info,0);
      mListeners.add(info);
    }
 catch (    RemoteException e) {
    }
  }
}
