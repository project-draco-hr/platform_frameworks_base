{
  int uid=Binder.getCallingUid();
  if (UserHandle.getAppId(uid) == Process.SYSTEM_UID || uid == 0) {
    return;
  }
  try {
    ApplicationInfo ai=mContext.getPackageManager().getApplicationInfo(pkg,0);
    if (!UserHandle.isSameApp(ai.uid,uid)) {
      throw new SecurityException("Calling uid " + uid + " gave package"+ pkg+ " which is owned by uid "+ ai.uid);
    }
  }
 catch (  PackageManager.NameNotFoundException e) {
    throw new SecurityException("Unknown package " + pkg);
  }
}
