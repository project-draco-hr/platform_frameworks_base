{
  if (mKeyguardFadingOutInProgress) {
    return;
  }
  ValueAnimator previousAnimator=StackStateAnimator.getChildTag(scrim,TAG_KEY_ANIM);
  float animEndValue=-1;
  if (previousAnimator != null) {
    if (animate || alpha == currentAlpha) {
      previousAnimator.cancel();
    }
 else {
      animEndValue=StackStateAnimator.getChildTag(scrim,TAG_END_ALPHA);
    }
  }
  if (alpha != currentAlpha && alpha != animEndValue) {
    if (animate) {
      startScrimAnimation(scrim,alpha);
      scrim.setTag(TAG_START_ALPHA,currentAlpha);
      scrim.setTag(TAG_END_ALPHA,alpha);
    }
 else {
      if (previousAnimator != null) {
        float previousStartValue=StackStateAnimator.getChildTag(scrim,TAG_START_ALPHA);
        float previousEndValue=StackStateAnimator.getChildTag(scrim,TAG_END_ALPHA);
        PropertyValuesHolder[] values=previousAnimator.getValues();
        float relativeDiff=alpha - previousEndValue;
        float newStartValue=previousStartValue + relativeDiff;
        newStartValue=Math.max(0,Math.min(1.0f,newStartValue));
        values[0].setFloatValues(newStartValue,alpha);
        scrim.setTag(TAG_START_ALPHA,newStartValue);
        scrim.setTag(TAG_END_ALPHA,alpha);
        previousAnimator.setCurrentPlayTime(previousAnimator.getCurrentPlayTime());
      }
 else {
        setCurrentScrimAlpha(scrim,alpha);
        updateScrimColor(scrim);
      }
    }
  }
}
