{
  String interfaceName=linkProperties.getInterfaceName();
  InetAddress inetAddress=null;
  InetAddress gateway=null;
  boolean success;
  for (  LinkAddress la : linkProperties.getLinkAddresses()) {
    inetAddress=la.getAddress();
    break;
  }
  for (  RouteInfo route : linkProperties.getRoutes()) {
    gateway=route.getGateway();
    break;
  }
  try {
    ArpPeer peer=new ArpPeer(interfaceName,inetAddress,myMacAddress,gateway);
    int responses=0;
    for (int i=0; i < numArpPings; i++) {
      if (peer.doArp(timeoutMillis) != null)       responses++;
    }
    if (DBG)     Log.d(TAG,"ARP test result: " + responses + "/"+ numArpPings);
    success=(responses >= minArpResponses);
    peer.close();
  }
 catch (  SocketException se) {
    Log.e(TAG,"ARP test initiation failure: " + se);
    success=true;
  }
  return success;
}
