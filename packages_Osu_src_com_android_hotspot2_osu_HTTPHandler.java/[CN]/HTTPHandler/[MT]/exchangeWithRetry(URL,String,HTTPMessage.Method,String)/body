{
  HTTPResponse response=null;
  int retry=0;
  for (; ; ) {
    try {
      response=httpExchange(url,message,method,contentType);
      break;
    }
 catch (    IOException ioe) {
      close();
      retry++;
      if (retry > 3) {
        break;
      }
      Log.d(OSUManager.TAG,"Failed HTTP exchange, retry " + retry);
      mSocket=mSocketFactory.createSocket();
      mOut=new BufferedOutputStream(mSocket.getOutputStream());
      mIn=new BufferedInputStream(mSocket.getInputStream());
    }
  }
  if (response == null) {
    throw new IOException("Failed to establish connection to peer");
  }
  return response;
}
