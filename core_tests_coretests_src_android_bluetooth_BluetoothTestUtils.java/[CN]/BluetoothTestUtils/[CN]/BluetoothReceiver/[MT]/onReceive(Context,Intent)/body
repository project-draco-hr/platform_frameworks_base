{
synchronized (this) {
    if (BluetoothAdapter.ACTION_DISCOVERY_STARTED.equals(intent.getAction())) {
      mFiredFlags|=DISCOVERY_STARTED_FLAG;
    }
 else     if (BluetoothAdapter.ACTION_DISCOVERY_FINISHED.equals(intent.getAction())) {
      mFiredFlags|=DISCOVERY_FINISHED_FLAG;
    }
 else     if (BluetoothAdapter.ACTION_SCAN_MODE_CHANGED.equals(intent.getAction())) {
      int mode=intent.getIntExtra(BluetoothAdapter.EXTRA_SCAN_MODE,BluetoothAdapter.ERROR);
      assertNotSame(mode,BluetoothAdapter.ERROR);
switch (mode) {
case BluetoothAdapter.SCAN_MODE_NONE:
        mFiredFlags|=SCAN_MODE_NONE_FLAG;
      break;
case BluetoothAdapter.SCAN_MODE_CONNECTABLE:
    mFiredFlags|=SCAN_MODE_CONNECTABLE_FLAG;
  break;
case BluetoothAdapter.SCAN_MODE_CONNECTABLE_DISCOVERABLE:
mFiredFlags|=SCAN_MODE_CONNECTABLE_DISCOVERABLE_FLAG;
break;
}
}
 else if (BluetoothAdapter.ACTION_STATE_CHANGED.equals(intent.getAction())) {
int state=intent.getIntExtra(BluetoothAdapter.EXTRA_STATE,BluetoothAdapter.ERROR);
assertNotSame(state,BluetoothAdapter.ERROR);
switch (state) {
case BluetoothAdapter.STATE_OFF:
mFiredFlags|=STATE_OFF_FLAG;
break;
case BluetoothAdapter.STATE_TURNING_ON:
mFiredFlags|=STATE_TURNING_ON_FLAG;
break;
case BluetoothAdapter.STATE_ON:
mFiredFlags|=STATE_ON_FLAG;
break;
case BluetoothAdapter.STATE_TURNING_OFF:
mFiredFlags|=STATE_TURNING_OFF_FLAG;
break;
}
}
 else if (BluetoothDevice.ACTION_BOND_STATE_CHANGED.equals(intent.getAction())) {
mFiredFlags|=PAIR_STATE_FLAG;
int state=intent.getIntExtra(BluetoothDevice.EXTRA_BOND_STATE,-1);
assertNotSame(state,-1);
switch (state) {
case BluetoothDevice.BOND_BONDED:
mPairFiredFlags|=PAIR_STATE_BONDED;
break;
case BluetoothDevice.BOND_BONDING:
mPairFiredFlags|=PAIR_STATE_BONDING;
break;
case BluetoothDevice.BOND_NONE:
mPairFiredFlags|=PAIR_STATE_NONE;
break;
}
}
 else if (BluetoothA2dp.ACTION_SINK_STATE_CHANGED.equals(intent.getAction())) {
mFiredFlags|=PROFILE_A2DP_FLAG;
int state=intent.getIntExtra(BluetoothA2dp.EXTRA_SINK_STATE,-1);
assertNotSame(state,-1);
switch (state) {
case BluetoothA2dp.STATE_DISCONNECTED:
mA2dpFiredFlags|=A2DP_STATE_DISCONNECTED;
break;
case BluetoothA2dp.STATE_CONNECTING:
mA2dpFiredFlags|=A2DP_STATE_CONNECTING;
break;
case BluetoothA2dp.STATE_CONNECTED:
mA2dpFiredFlags|=A2DP_STATE_CONNECTED;
break;
case BluetoothA2dp.STATE_DISCONNECTING:
mA2dpFiredFlags|=A2DP_STATE_DISCONNECTING;
break;
case BluetoothA2dp.STATE_PLAYING:
mA2dpFiredFlags|=A2DP_STATE_PLAYING;
break;
}
}
 else if (BluetoothHeadset.ACTION_STATE_CHANGED.equals(intent.getAction())) {
mFiredFlags|=PROFILE_HEADSET_FLAG;
int state=intent.getIntExtra(BluetoothHeadset.EXTRA_STATE,BluetoothHeadset.STATE_ERROR);
assertNotSame(state,BluetoothHeadset.STATE_ERROR);
switch (state) {
case BluetoothHeadset.STATE_DISCONNECTED:
mHeadsetFiredFlags|=HEADSET_STATE_DISCONNECTED;
break;
case BluetoothHeadset.STATE_CONNECTING:
mHeadsetFiredFlags|=HEADSET_STATE_CONNECTING;
break;
case BluetoothHeadset.STATE_CONNECTED:
mHeadsetFiredFlags|=HEADSET_STATE_CONNECTED;
break;
}
}
}
}
