{
  this.job=job;
  this.callingUid=callingUid;
  int tempSourceUid=-1;
  if (sourceUserId != -1 && sourcePackageName != null) {
    try {
      tempSourceUid=AppGlobals.getPackageManager().getPackageUid(sourcePackageName,0,sourceUserId);
    }
 catch (    RemoteException ex) {
    }
  }
  if (tempSourceUid == -1) {
    this.sourceUid=callingUid;
    this.sourceUserId=UserHandle.getUserId(callingUid);
    this.sourcePackageName=job.getService().getPackageName();
    this.sourceTag=null;
  }
 else {
    this.sourceUid=tempSourceUid;
    this.sourceUserId=sourceUserId;
    this.sourcePackageName=sourcePackageName;
    this.sourceTag=tag;
  }
  this.batteryName=this.sourceTag != null ? this.sourceTag + ":" + job.getService().getPackageName() : job.getService().flattenToShortString();
  this.tag="*job*/" + this.batteryName;
  this.earliestRunTimeElapsedMillis=earliestRunTimeElapsedMillis;
  this.latestRunTimeElapsedMillis=latestRunTimeElapsedMillis;
  this.numFailures=numFailures;
  int requiredConstraints=0;
  if (job.getNetworkType() == JobInfo.NETWORK_TYPE_ANY) {
    requiredConstraints|=CONSTRAINT_CONNECTIVITY;
  }
  if (job.getNetworkType() == JobInfo.NETWORK_TYPE_UNMETERED) {
    requiredConstraints|=CONSTRAINT_UNMETERED;
  }
  if (job.getNetworkType() == JobInfo.NETWORK_TYPE_NOT_ROAMING) {
    requiredConstraints|=CONSTRAINT_NOT_ROAMING;
  }
  if (job.isRequireCharging()) {
    requiredConstraints|=CONSTRAINT_CHARGING;
  }
  if (earliestRunTimeElapsedMillis != NO_EARLIEST_RUNTIME) {
    requiredConstraints|=CONSTRAINT_TIMING_DELAY;
  }
  if (latestRunTimeElapsedMillis != NO_LATEST_RUNTIME) {
    requiredConstraints|=CONSTRAINT_DEADLINE;
  }
  if (job.isRequireDeviceIdle()) {
    requiredConstraints|=CONSTRAINT_IDLE;
  }
  if (job.getTriggerContentUris() != null) {
    requiredConstraints|=CONSTRAINT_CONTENT_TRIGGER;
  }
  this.requiredConstraints=requiredConstraints;
}
