{
switch (action) {
case MotionEvent.ACTION_DOWN:
    if (mPreviousDownTime + DOUBLE_TAP_DISMISS_TIMEOUT >= time) {
      if (mCallback != null) {
        mCallback.onZoomRingDismissed();
      }
    }
 else {
      mPreviousDownTime=time;
      mPreviousDownX=x;
      mPreviousDownY=y;
    }
  resetState();
return true;
case MotionEvent.ACTION_MOVE:
break;
case MotionEvent.ACTION_CANCEL:
case MotionEvent.ACTION_UP:
if (mCallback != null) {
if (mMode == MODE_MOVE_ZOOM_RING || mMode == MODE_WAITING_FOR_MOVE_ZOOM_RING) {
mCallback.onZoomRingSetMovableHintVisible(false);
if (mMode == MODE_MOVE_ZOOM_RING) {
  mCallback.onZoomRingMovingStopped();
}
}
 else if (mMode == MODE_DRAG_THUMB || mMode == MODE_TAP_DRAG) {
onThumbDragStopped(getAngle(x - mCenterX,y - mCenterY));
}
}
mDisabler.setEnabling(true);
return true;
default :
return false;
}
int localX=x - mCenterX;
int localY=y - mCenterY;
boolean isTouchingThumb=true;
boolean isInBounds=true;
int touchAngle=getAngle(localX,localY);
int radiusSquared=localX * localX + localY * localY;
if (radiusSquared < mBoundInnerRadiusSquared || radiusSquared > mBoundOuterRadiusSquared) {
isTouchingThumb=false;
isInBounds=false;
}
int deltaThumbAndTouch=getDelta(touchAngle,mThumbAngle);
int absoluteDeltaThumbAndTouch=deltaThumbAndTouch >= 0 ? deltaThumbAndTouch : -deltaThumbAndTouch;
if (isTouchingThumb && absoluteDeltaThumbAndTouch > THUMB_GRAB_SLOP) {
isTouchingThumb=false;
}
if (mMode == MODE_IDLE) {
if (isTouchingThumb) {
mMode=MODE_DRAG_THUMB;
}
 else {
mMode=MODE_WAITING_FOR_MOVE_ZOOM_RING;
}
if (mCallback != null) {
if (mMode == MODE_DRAG_THUMB) {
onThumbDragStarted(touchAngle);
}
 else if (mMode == MODE_WAITING_FOR_MOVE_ZOOM_RING) {
mCallback.onZoomRingSetMovableHintVisible(true);
}
}
}
 else if (mMode == MODE_WAITING_FOR_MOVE_ZOOM_RING) {
if (Math.abs(x - mPreviousDownX) > mTouchSlop || Math.abs(y - mPreviousDownY) > mTouchSlop) {
mMode=MODE_MOVE_ZOOM_RING;
if (mCallback != null) {
mCallback.onZoomRingMovingStarted();
}
}
}
if (mMode == MODE_DRAG_THUMB || mMode == MODE_TAP_DRAG) {
if (isInBounds) {
onThumbDragged(touchAngle,mIsThumbAngleValid ? deltaThumbAndTouch : 0);
}
 else {
mIsThumbAngleValid=false;
}
}
 else if (mMode == MODE_MOVE_ZOOM_RING) {
onZoomRingMoved(rawX,rawY);
}
return true;
}
