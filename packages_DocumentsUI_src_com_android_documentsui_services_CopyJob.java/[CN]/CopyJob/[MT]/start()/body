{
  mStartTime=elapsedRealtime();
  try {
    mBatchSize=calculateSize(mSrcs);
  }
 catch (  ResourceException e) {
    Log.w(TAG,"Failed to calculate total size. Copying without progress.",e);
    mBatchSize=-1;
  }
  DocumentInfo srcInfo;
  DocumentInfo dstInfo=stack.peek();
  for (int i=0; i < mSrcs.size() && !isCanceled(); ++i) {
    srcInfo=mSrcs.get(i);
    if (DEBUG)     Log.d(TAG,"Copying " + srcInfo.displayName + " ("+ srcInfo.derivedUri+ ")"+ " to "+ dstInfo.displayName+ " ("+ dstInfo.derivedUri+ ")");
    try {
      if (dstInfo.equals(srcInfo) || isDescendentOf(srcInfo,dstInfo)) {
        Log.e(TAG,"Skipping recursive copy of " + srcInfo.derivedUri);
        onFileFailed(srcInfo);
      }
 else {
        processDocument(srcInfo,null,dstInfo);
      }
    }
 catch (    ResourceException e) {
      Log.e(TAG,"Failed to copy " + srcInfo.derivedUri,e);
      onFileFailed(srcInfo);
    }
  }
  Metrics.logFileOperation(service,operationType,mSrcs,dstInfo);
}
