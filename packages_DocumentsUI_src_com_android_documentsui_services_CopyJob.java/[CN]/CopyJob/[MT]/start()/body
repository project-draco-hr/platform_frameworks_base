{
  mStartTime=elapsedRealtime();
  try {
    mBatchSize=calculateSize(mSrcs);
  }
 catch (  ResourceException e) {
    Log.w(TAG,"Failed to calculate total size. Copying without progress.");
    mBatchSize=-1;
  }
  DocumentInfo srcInfo;
  DocumentInfo dstInfo=stack.peek();
  for (int i=0; i < mSrcs.size() && !isCanceled(); ++i) {
    srcInfo=mSrcs.get(i);
    try {
      if (dstInfo.equals(srcInfo) || isDescendentOf(srcInfo,dstInfo)) {
        throw new ResourceException("Cannot copy to itself recursively.");
      }
    }
 catch (    ResourceException e) {
      Log.e(TAG,e.toString());
      onFileFailed(srcInfo);
      continue;
    }
    if (DEBUG)     Log.d(TAG,"Copying " + srcInfo.displayName + " ("+ srcInfo.derivedUri+ ")"+ " to "+ dstInfo.displayName+ " ("+ dstInfo.derivedUri+ ")");
    try {
      processDocument(srcInfo,null,dstInfo);
    }
 catch (    ResourceException e) {
      Log.e(TAG,e.toString());
      onFileFailed(srcInfo);
    }
  }
  Metrics.logFileOperation(service,operationType,mSrcs,dstInfo);
}
