{
  Intent intent=getIntent();
  Parcelable targetParcelable=intent.getParcelableExtra(Intent.EXTRA_INTENT);
  if (!(targetParcelable instanceof Intent)) {
    Log.w("ChooserActivity","Target is not an intent: " + targetParcelable);
    finish();
    super.onCreate(null);
    return;
  }
  Intent target=(Intent)targetParcelable;
  if (target != null) {
    modifyTargetIntent(target);
  }
  mReplacementExtras=intent.getBundleExtra(Intent.EXTRA_REPLACEMENT_EXTRAS);
  CharSequence title=intent.getCharSequenceExtra(Intent.EXTRA_TITLE);
  int defaultTitleRes=0;
  if (title == null) {
    defaultTitleRes=com.android.internal.R.string.chooseActivity;
  }
  Parcelable[] pa=intent.getParcelableArrayExtra(Intent.EXTRA_INITIAL_INTENTS);
  Intent[] initialIntents=null;
  if (pa != null) {
    initialIntents=new Intent[pa.length];
    for (int i=0; i < pa.length; i++) {
      if (!(pa[i] instanceof Intent)) {
        Log.w("ChooserActivity","Initial intent #" + i + " not an Intent: "+ pa[i]);
        finish();
        super.onCreate(null);
        return;
      }
      final Intent in=(Intent)pa[i];
      modifyTargetIntent(in);
      initialIntents[i]=in;
    }
  }
  pa=intent.getParcelableArrayExtra(Intent.EXTRA_CHOOSER_TARGETS);
  if (pa != null) {
    final ChooserTarget[] targets=new ChooserTarget[pa.length];
    for (int i=0; i < pa.length; i++) {
      if (!(pa[i] instanceof ChooserTarget)) {
        Log.w("ChooserActivity","Chooser target #" + i + " is not a ChooserTarget: "+ pa[i]);
        finish();
        super.onCreate(null);
        return;
      }
      targets[i]=(ChooserTarget)pa[i];
    }
    mCallerChooserTargets=targets;
  }
  mChosenComponentSender=intent.getParcelableExtra(Intent.EXTRA_CHOSEN_COMPONENT_INTENT_SENDER);
  setSafeForwardingMode(true);
  super.onCreate(savedInstanceState,target,title,defaultTitleRes,initialIntents,null,false);
}
