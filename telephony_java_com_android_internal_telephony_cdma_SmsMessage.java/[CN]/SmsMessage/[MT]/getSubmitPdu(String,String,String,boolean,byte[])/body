{
  SmsMessage sms=new SmsMessage();
  SubmitPdu ret=new SubmitPdu();
  UserData uData=new UserData();
  SmsHeader smsHeader;
  if (message == null || destinationAddress == null) {
    return null;
  }
  try {
    int septetCount=GsmAlphabet.countGsmSeptets(message,true);
    uData.userData=message.getBytes();
    if (uData.userData.length > MAX_USER_DATA_SEPTETS) {
      return null;
    }
    uData.userDataEncoding=UserData.UD_ENCODING_GSM_7BIT_ALPHABET;
    if (headerData != null) {
      smsHeader=SmsHeader.parse(headerData);
      uData.userDataHeader=smsHeader;
    }
 else {
    }
  }
 catch (  EncodeException ex) {
    byte[] textPart;
    try {
      textPart=message.getBytes("utf-16be");
    }
 catch (    UnsupportedEncodingException uex) {
      Log.e(LOG_TAG,"Implausible UnsupportedEncodingException ",uex);
      return null;
    }
    uData.userData=textPart;
    if (uData.userData.length > MAX_USER_DATA_BYTES) {
      return null;
    }
    uData.userDataEncoding=UserData.UD_ENCODING_UNICODE_16;
    if (headerData != null) {
      smsHeader=SmsHeader.parse(headerData);
      uData.userDataHeader=smsHeader;
    }
 else {
    }
  }
  byte[] data=sms.getEnvelope(destinationAddress,statusReportRequested,uData,(headerData != null),(null == headerData));
  if (null == data)   return null;
  ret.encodedMessage=data;
  ret.encodedScAddress=null;
  return ret;
}
