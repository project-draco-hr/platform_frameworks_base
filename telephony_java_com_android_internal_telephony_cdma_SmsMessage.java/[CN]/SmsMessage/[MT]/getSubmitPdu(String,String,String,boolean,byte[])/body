{
  SmsMessage sms=new SmsMessage();
  SubmitPdu ret=new SubmitPdu();
  UserData uData=new UserData();
  SmsHeader smsHeader;
  byte[] data;
  if (message == null || destinationAddress == null) {
    return null;
  }
  try {
    uData.payload=message.getBytes();
    if (uData.payload.length > MAX_USER_DATA_SEPTETS) {
      return null;
    }
    uData.msgEncoding=UserData.ENCODING_7BIT_ASCII;
    if (headerData != null) {
      smsHeader=SmsHeader.parse(headerData);
      uData.userDataHeader=smsHeader;
    }
 else {
    }
    data=sms.getEnvelope(destinationAddress,statusReportRequested,uData,(headerData != null),(null == headerData));
  }
 catch (  Exception ex) {
    Log.e(LOG_TAG,"getSubmitPdu: 7 bit ASCII encoding in cdma.SMSMesage failed: " + ex.getMessage());
    Log.w(LOG_TAG,"getSubmitPdu: The message will be sent as UCS-2 encoded message.");
    byte[] textPart;
    try {
      textPart=message.getBytes("utf-16be");
    }
 catch (    UnsupportedEncodingException uex) {
      Log.e(LOG_TAG,"Implausible UnsupportedEncodingException ",uex);
      return null;
    }
    uData.payload=textPart;
    if (uData.payload.length > MAX_USER_DATA_BYTES) {
      return null;
    }
    uData.msgEncoding=UserData.ENCODING_UNICODE_16;
    if (headerData != null) {
      smsHeader=SmsHeader.parse(headerData);
      uData.userDataHeader=smsHeader;
    }
 else {
    }
    data=sms.getEnvelope(destinationAddress,statusReportRequested,uData,(headerData != null),(null == headerData));
  }
  if (null == data)   return null;
  ret.encodedMessage=data;
  ret.encodedScAddress=null;
  return ret;
}
