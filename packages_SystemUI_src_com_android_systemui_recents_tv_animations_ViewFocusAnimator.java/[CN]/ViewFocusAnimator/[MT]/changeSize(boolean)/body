{
  ViewGroup.LayoutParams lp=mTargetView.getLayoutParams();
  int width=lp.width;
  int height=lp.height;
  if (width < 0 && height < 0) {
    mTargetView.measure(View.MeasureSpec.UNSPECIFIED,View.MeasureSpec.UNSPECIFIED);
  }
  if (mTargetView.isAttachedToWindow() && mTargetView.hasWindowFocus() && mTargetView.getVisibility() == View.VISIBLE) {
    animateFocus(hasFocus);
  }
 else {
    if (mFocusAnimation.isStarted()) {
      mFocusAnimation.cancel();
    }
    setFocusProgress(hasFocus ? 1.0f : 0.0f);
  }
}
