{
  mContext=context;
  mNMService=nmService;
  mStatsService=statsService;
  mLooper=looper;
  mIfaces=new HashMap<String,TetherInterfaceSM>();
  mThread=new HandlerThread("Tethering");
  mThread.start();
  mLooper=mThread.getLooper();
  mTetherMasterSM=new TetherMasterSM("TetherMaster",mLooper);
  mTetherMasterSM.start();
  mStateReceiver=new StateReceiver();
  IntentFilter filter=new IntentFilter();
  filter.addAction(UsbManager.ACTION_USB_STATE);
  filter.addAction(ConnectivityManager.CONNECTIVITY_ACTION);
  mContext.registerReceiver(mStateReceiver,filter);
  filter=new IntentFilter();
  filter.addAction(Intent.ACTION_MEDIA_SHARED);
  filter.addAction(Intent.ACTION_MEDIA_UNSHARED);
  filter.addDataScheme("file");
  mContext.registerReceiver(mStateReceiver,filter);
  mDhcpRange=context.getResources().getStringArray(com.android.internal.R.array.config_tether_dhcp_range);
  if ((mDhcpRange.length == 0) || (mDhcpRange.length % 2 == 1)) {
    mDhcpRange=DHCP_DEFAULT_RANGE;
  }
  mTetherableUsbRegexs=context.getResources().getStringArray(com.android.internal.R.array.config_tether_usb_regexs);
  mTetherableWifiRegexs=context.getResources().getStringArray(com.android.internal.R.array.config_tether_wifi_regexs);
  mTetherableBluetoothRegexs=context.getResources().getStringArray(com.android.internal.R.array.config_tether_bluetooth_regexs);
  int ifaceTypes[]=context.getResources().getIntArray(com.android.internal.R.array.config_tether_upstream_types);
  mUpstreamIfaceTypes=new ArrayList();
  for (  int i : ifaceTypes) {
    mUpstreamIfaceTypes.add(new Integer(i));
  }
  checkDunRequired();
  mDnsServers=new String[2];
  mDnsServers[0]=DNS_DEFAULT_SERVER1;
  mDnsServers[1]=DNS_DEFAULT_SERVER2;
}
