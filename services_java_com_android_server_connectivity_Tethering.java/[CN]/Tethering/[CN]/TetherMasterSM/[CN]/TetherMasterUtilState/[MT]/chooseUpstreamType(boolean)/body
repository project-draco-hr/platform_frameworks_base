{
  IBinder b=ServiceManager.getService(Context.CONNECTIVITY_SERVICE);
  IConnectivityManager cm=IConnectivityManager.Stub.asInterface(b);
  int upType=ConnectivityManager.TYPE_NONE;
  String iface=null;
  for (  Integer netType : mUpstreamIfaceTypes) {
    NetworkInfo info=null;
    try {
      info=cm.getNetworkInfo(netType.intValue());
    }
 catch (    RemoteException e) {
    }
    if ((info != null) && info.isConnected()) {
      upType=netType.intValue();
      break;
    }
  }
  if (VDBG) {
    Log.d(TAG,"chooseUpstreamType(" + tryCell + "), preferredApn ="+ mPreferredUpstreamMobileApn+ ", got type="+ upType);
  }
  if (upType == ConnectivityManager.TYPE_MOBILE_DUN || upType == ConnectivityManager.TYPE_MOBILE_HIPRI) {
    turnOnUpstreamMobileConnection(upType);
  }
  if (upType == ConnectivityManager.TYPE_NONE) {
    boolean tryAgainLater=true;
    if ((tryCell == TRY_TO_SETUP_MOBILE_CONNECTION) && (turnOnUpstreamMobileConnection(mPreferredUpstreamMobileApn) == true)) {
      tryAgainLater=false;
    }
    if (tryAgainLater) {
      sendMessageDelayed(CMD_RETRY_UPSTREAM,UPSTREAM_SETTLE_TIME_MS);
    }
  }
 else {
    LinkProperties linkProperties=null;
    try {
      linkProperties=cm.getLinkProperties(upType);
    }
 catch (    RemoteException e) {
    }
    if (linkProperties != null)     iface=linkProperties.getInterfaceName();
  }
  notifyTetheredOfNewUpstreamIface(iface);
}
