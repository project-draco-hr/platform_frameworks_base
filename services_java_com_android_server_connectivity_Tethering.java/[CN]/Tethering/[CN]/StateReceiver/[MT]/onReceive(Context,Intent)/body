{
  String action=intent.getAction();
  if (action.equals(Usb.ACTION_USB_STATE)) {
    boolean connected=intent.getExtras().getBoolean(Usb.USB_CONNECTED);
    Message msg=Message.obtain(mUsbHandler,USB_STATE_CHANGE,(connected ? USB_CONNECTED : USB_DISCONNECTED),0);
    mUsbHandler.removeMessages(USB_STATE_CHANGE);
    mUsbHandler.sendMessageDelayed(msg,connected ? 0 : USB_DISCONNECT_DELAY);
  }
 else   if (action.equals(Intent.ACTION_MEDIA_SHARED)) {
    mUsbMassStorageOff=false;
    updateUsbStatus();
  }
 else   if (action.equals(Intent.ACTION_MEDIA_UNSHARED)) {
    mUsbMassStorageOff=true;
    updateUsbStatus();
  }
 else   if (action.equals(ConnectivityManager.CONNECTIVITY_ACTION)) {
    if (DEBUG)     Log.d(TAG,"Tethering got CONNECTIVITY_ACTION");
    mTetherMasterSM.sendMessage(TetherMasterSM.CMD_UPSTREAM_CHANGED);
  }
 else   if (action.equals(Intent.ACTION_BOOT_COMPLETED)) {
    mBooted=true;
    updateUsbStatus();
  }
}
