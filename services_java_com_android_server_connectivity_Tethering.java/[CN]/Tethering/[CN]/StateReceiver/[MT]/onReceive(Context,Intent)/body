{
  String action=intent.getAction();
  if (action.equals(UsbManager.ACTION_USB_STATE)) {
synchronized (Tethering.this) {
      boolean usbConnected=intent.getBooleanExtra(UsbManager.USB_CONNECTED,false);
      mRndisEnabled=intent.getBooleanExtra(UsbManager.USB_FUNCTION_RNDIS,false);
      if (usbConnected && mRndisEnabled && mUsbTetherRequested) {
        tetherUsb(true);
      }
      mUsbTetherRequested=false;
    }
  }
 else   if (action.equals(ConnectivityManager.CONNECTIVITY_ACTION)) {
    if (VDBG)     Log.d(TAG,"Tethering got CONNECTIVITY_ACTION");
    mTetherMasterSM.sendMessage(TetherMasterSM.CMD_UPSTREAM_CHANGED);
  }
}
