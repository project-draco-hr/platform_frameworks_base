{
  String action=intent.getAction();
  if (action.equals(Intent.ACTION_UMS_CONNECTED)) {
    Log.w(TAG,"got UMS connected");
synchronized (Tethering.this) {
      if (mUsbResetExpected != 0) {
        Log.w(TAG,"mUsbResetExpected == " + mUsbResetExpected + ", ignored");
        mUsbResetExpected--;
        return;
      }
    }
    Tethering.this.toggleUsbIfaces(true);
  }
 else   if (action.equals(Intent.ACTION_UMS_DISCONNECTED)) {
    Log.w(TAG,"got UMS disconneded broadcast");
synchronized (Tethering.this) {
      if (mUsbResetExpected != 0) {
        Log.w(TAG,"mUsbResetExpected == " + mUsbResetExpected + ", ignored");
        mUsbResetExpected--;
        return;
      }
    }
    Tethering.this.toggleUsbIfaces(false);
  }
 else   if (action.equals(ConnectivityManager.CONNECTIVITY_ACTION)) {
    IBinder b=ServiceManager.getService(Context.CONNECTIVITY_SERVICE);
    IConnectivityManager service=IConnectivityManager.Stub.asInterface(b);
    try {
      NetworkInfo info=service.getNetworkInfo(ConnectivityManager.TYPE_MOBILE_DUN);
      int msg;
      if (info != null && info.isConnected() == true) {
        msg=TetherMasterSM.CMD_CELL_DUN_ENABLED;
      }
 else {
        msg=TetherMasterSM.CMD_CELL_DUN_DISABLED;
      }
      mTetherMasterSM.sendMessage(mTetherMasterSM.obtainMessage(msg));
    }
 catch (    RemoteException e) {
    }
  }
}
