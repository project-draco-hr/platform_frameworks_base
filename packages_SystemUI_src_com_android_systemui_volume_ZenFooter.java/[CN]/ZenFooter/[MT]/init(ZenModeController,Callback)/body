{
  mCallback=callback;
  mController=controller;
  mZenModePanel.init(controller);
  mZenModePanel.setEmbedded(true);
  mSwitch.setOnCheckedChangeListener(mCheckedListener);
  mController.addCallback(new ZenModeController.Callback(){
    @Override public void onZenChanged(    int zen){
      setZen(zen);
    }
    @Override public void onExitConditionChanged(    Condition exitCondition){
      update();
    }
  }
);
  mSwitchBar.setOnClickListener(new OnClickListener(){
    @Override public void onClick(    View v){
      mSwitch.setChecked(!mSwitch.isChecked());
    }
  }
);
  mZenModePanelMoreButton.setOnClickListener(new OnClickListener(){
    @Override public void onClick(    View v){
      if (mCallback != null) {
        mCallback.onSettingsClicked();
      }
    }
  }
);
  mZenModePanelDoneButton.setOnClickListener(new OnClickListener(){
    @Override public void onClick(    View v){
      if (mCallback != null) {
        mCallback.onDoneClicked();
      }
    }
  }
);
  mZen=mController.getZen();
  update();
}
