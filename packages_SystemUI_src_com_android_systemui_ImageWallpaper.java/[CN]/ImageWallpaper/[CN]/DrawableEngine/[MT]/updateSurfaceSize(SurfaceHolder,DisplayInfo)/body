{
  if (mBackgroundWidth <= 0 || mBackgroundHeight <= 0) {
    mWallpaperManager.forgetLoadedWallpaper();
    updateWallpaperLocked();
    if (mBackgroundWidth <= 0 || mBackgroundHeight <= 0) {
      mBackgroundWidth=displayInfo.logicalWidth;
      mBackgroundHeight=displayInfo.logicalHeight;
    }
  }
  int surfaceWidth=Math.max(displayInfo.logicalWidth,mBackgroundWidth);
  int surfaceHeight=Math.max(displayInfo.logicalHeight,mBackgroundHeight);
  final Rect frame=surfaceHolder.getSurfaceFrame();
  if (frame != null) {
    final int dw=frame.width();
    final int dh=frame.height();
    if (surfaceWidth == dw && surfaceHeight == dh) {
      return;
    }
  }
  if (FIXED_SIZED_SURFACE) {
    surfaceHolder.setFixedSize(surfaceWidth,surfaceHeight);
  }
 else {
    surfaceHolder.setSizeFromLayout();
  }
}
