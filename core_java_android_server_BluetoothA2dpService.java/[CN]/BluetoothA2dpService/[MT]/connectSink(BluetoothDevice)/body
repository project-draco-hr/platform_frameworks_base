{
  mContext.enforceCallingOrSelfPermission(BLUETOOTH_ADMIN_PERM,"Need BLUETOOTH_ADMIN permission");
  if (DBG)   log("connectSink(" + device + ")");
  if (lookupSinksMatchingStates(new int[]{BluetoothA2dp.STATE_CONNECTING,BluetoothA2dp.STATE_CONNECTED,BluetoothA2dp.STATE_PLAYING,BluetoothA2dp.STATE_DISCONNECTING}).size() != 0) {
    return BluetoothError.ERROR;
  }
  if (mAudioDevices.get(device) == null && !addAudioSink(device))   return BluetoothError.ERROR;
  int state=mAudioDevices.get(device);
switch (state) {
case BluetoothA2dp.STATE_CONNECTED:
case BluetoothA2dp.STATE_PLAYING:
case BluetoothA2dp.STATE_DISCONNECTING:
    return BluetoothError.ERROR;
case BluetoothA2dp.STATE_CONNECTING:
  return BluetoothError.SUCCESS;
}
String path=mBluetoothService.getObjectPathFromAddress(device.getAddress());
if (path == null) return BluetoothError.ERROR;
if (!connectSinkNative(path)) {
return BluetoothError.ERROR;
}
return BluetoothError.SUCCESS;
}
