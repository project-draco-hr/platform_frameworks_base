{
  mContext=context;
  mAudioManager=(AudioManager)context.getSystemService(Context.AUDIO_SERVICE);
  mBluetooth=(BluetoothDevice)mContext.getSystemService(Context.BLUETOOTH_SERVICE);
  if (mBluetooth == null) {
    throw new RuntimeException("Platform does not support Bluetooth");
  }
  if (!initNative()) {
    throw new RuntimeException("Could not init BluetoothA2dpService");
  }
  mIntentFilter=new IntentFilter(BluetoothIntent.BLUETOOTH_STATE_CHANGED_ACTION);
  mIntentFilter.addAction(BluetoothIntent.BOND_STATE_CHANGED_ACTION);
  mIntentFilter.addAction(BluetoothIntent.REMOTE_DEVICE_CONNECTED_ACTION);
  mContext.registerReceiver(mReceiver,mIntentFilter);
  if (mBluetooth.isEnabled()) {
    onBluetoothEnable();
  }
}
