{
  mContext=context;
  mAudioManager=(AudioManager)context.getSystemService(Context.AUDIO_SERVICE);
  BluetoothDevice device=(BluetoothDevice)mContext.getSystemService(Context.BLUETOOTH_SERVICE);
  if (device == null) {
    throw new RuntimeException("Platform does not support Bluetooth");
  }
  if (!initNative()) {
    throw new RuntimeException("Could not init BluetoothA2dpService");
  }
  mIntentFilter=new IntentFilter(BluetoothIntent.ENABLED_ACTION);
  mIntentFilter.addAction(BluetoothIntent.DISABLED_ACTION);
  mContext.registerReceiver(mReceiver,mIntentFilter);
  if (device.isEnabled()) {
    onBluetoothEnable();
  }
}
