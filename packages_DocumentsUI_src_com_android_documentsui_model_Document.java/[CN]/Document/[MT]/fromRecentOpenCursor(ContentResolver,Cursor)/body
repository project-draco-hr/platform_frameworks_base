{
  final Uri uri=Uri.parse(getCursorString(cursor,RecentsProvider.COL_URI));
  final long lastModified=getCursorLong(cursor,RecentsProvider.COL_TIMESTAMP);
  final Cursor itemCursor=resolver.query(uri,null,null,null,null);
  try {
    if (!itemCursor.moveToFirst()) {
      throw new IllegalArgumentException("Missing details for " + uri);
    }
    final String mimeType=getCursorString(itemCursor,DocumentColumns.MIME_TYPE);
    final String displayName=getCursorString(itemCursor,DocumentColumns.DISPLAY_NAME);
    final int flags=getCursorInt(itemCursor,DocumentColumns.FLAGS) & DocumentsContract.FLAG_SUPPORTS_THUMBNAIL;
    return new Document(uri,mimeType,displayName,lastModified,flags);
  }
  finally {
    itemCursor.close();
  }
}
