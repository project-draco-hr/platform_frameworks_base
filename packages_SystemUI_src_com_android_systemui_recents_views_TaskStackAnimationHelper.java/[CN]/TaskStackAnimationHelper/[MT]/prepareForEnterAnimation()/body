{
  RecentsConfiguration config=Recents.getConfiguration();
  RecentsActivityLaunchState launchState=config.getLaunchState();
  Resources res=mStackView.getResources();
  Resources appResources=mStackView.getContext().getApplicationContext().getResources();
  TaskStackLayoutAlgorithm stackLayout=mStackView.getStackAlgorithm();
  TaskStackViewScroller stackScroller=mStackView.getScroller();
  TaskStack stack=mStackView.getStack();
  Task launchTargetTask=stack.getLaunchTarget();
  if (stack.getTaskCount() == 0) {
    return;
  }
  int offscreenYOffset=stackLayout.mStackRect.height();
  int taskViewAffiliateGroupEnterOffset=res.getDimensionPixelSize(R.dimen.recents_task_stack_animation_affiliate_enter_offset);
  int launchedWhileDockingOffset=res.getDimensionPixelSize(R.dimen.recents_task_stack_animation_launched_while_docking_offset);
  boolean isLandscape=appResources.getConfiguration().orientation == Configuration.ORIENTATION_LANDSCAPE;
  List<TaskView> taskViews=mStackView.getTaskViews();
  for (int i=taskViews.size() - 1; i >= 0; i--) {
    TaskView tv=taskViews.get(i);
    Task task=tv.getTask();
    boolean currentTaskOccludesLaunchTarget=launchTargetTask != null && launchTargetTask.group != null && launchTargetTask.group.isTaskAboveTask(task,launchTargetTask);
    boolean hideTask=launchTargetTask != null && launchTargetTask.isFreeformTask() && task.isFreeformTask();
    stackLayout.getStackTransform(task,stackScroller.getStackScroll(),mTmpTransform,null);
    if (hideTask) {
      tv.setVisibility(View.INVISIBLE);
    }
 else     if (launchState.launchedFromApp && !launchState.launchedViaDockGesture) {
      if (task.isLaunchTarget) {
        tv.onPrepareLaunchTargetForEnterAnimation();
      }
 else       if (currentTaskOccludesLaunchTarget) {
        mTmpTransform.rect.offset(0,taskViewAffiliateGroupEnterOffset);
        mTmpTransform.alpha=0f;
        mStackView.updateTaskViewToTransform(tv,mTmpTransform,AnimationProps.IMMEDIATE);
        tv.setClipViewInStack(false);
      }
    }
 else     if (launchState.launchedFromHome) {
      mTmpTransform.rect.offset(0,offscreenYOffset);
      mTmpTransform.alpha=0f;
      mStackView.updateTaskViewToTransform(tv,mTmpTransform,AnimationProps.IMMEDIATE);
    }
 else     if (launchState.launchedViaDockGesture) {
      int offset=isLandscape ? launchedWhileDockingOffset : (int)(offscreenYOffset * 0.9f);
      mTmpTransform.rect.offset(0,offset);
      mTmpTransform.alpha=0f;
      mStackView.updateTaskViewToTransform(tv,mTmpTransform,AnimationProps.IMMEDIATE);
    }
  }
}
