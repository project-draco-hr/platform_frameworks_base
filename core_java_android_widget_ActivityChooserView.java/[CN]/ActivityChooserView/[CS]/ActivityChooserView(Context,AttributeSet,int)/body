{
  super(context,attrs,defStyle);
  TypedArray attributesArray=context.obtainStyledAttributes(attrs,R.styleable.ActivityChooserView,defStyle,0);
  mInitialActivityCount=attributesArray.getInt(R.styleable.ActivityChooserView_initialActivityCount,ActivityChooserViewAdapter.MAX_ACTIVITY_COUNT_DEFAULT);
  Drawable expandActivityOverflowButtonDrawable=attributesArray.getDrawable(R.styleable.ActivityChooserView_expandActivityOverflowButtonDrawable);
  LayoutInflater inflater=LayoutInflater.from(mContext);
  inflater.inflate(R.layout.activity_chooser_view,this,true);
  mCallbacks=new Callbacks();
  mActivityChooserContent=(LinearLayout)findViewById(R.id.activity_chooser_view_content);
  mDefaultActionButton=(ImageButton)findViewById(R.id.default_activity_button);
  mDefaultActionButton.setOnClickListener(mCallbacks);
  mDefaultActionButton.setOnLongClickListener(mCallbacks);
  mExpandActivityOverflowButton=(ImageButton)findViewById(R.id.expand_activities_button);
  mExpandActivityOverflowButton.setOnClickListener(mCallbacks);
  mExpandActivityOverflowButton.setBackgroundDrawable(expandActivityOverflowButtonDrawable);
  mAdapter=new ActivityChooserViewAdapter();
  mAdapter.registerDataSetObserver(new DataSetObserver(){
    @Override public void onChanged(){
      super.onChanged();
      updateButtons();
    }
  }
);
}
