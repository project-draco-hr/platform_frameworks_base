{
  if (mAdapter.getDataModel() == null) {
    throw new IllegalStateException("No data model. Did you call #setDataModel?");
  }
  mAdapter.setMaxActivityCount(maxActivityCount);
  final int activityCount=mAdapter.getActivityCount();
  if (maxActivityCount != ActivityChooserViewAdapter.MAX_ACTIVITY_COUNT_UNLIMITED && activityCount > maxActivityCount + 1) {
    mAdapter.setShowFooterView(true);
  }
 else {
    mAdapter.setShowFooterView(false);
  }
  ListPopupWindow popupWindow=getListPopupWindow();
  if (!popupWindow.isShowing()) {
    if (mIsSelectingDefaultActivity) {
      mAdapter.setShowDefaultActivity(true);
    }
 else {
      mAdapter.setShowDefaultActivity(false);
    }
    popupWindow.setContentWidth(mAdapter.measureContentWidth());
    popupWindow.show();
  }
}
