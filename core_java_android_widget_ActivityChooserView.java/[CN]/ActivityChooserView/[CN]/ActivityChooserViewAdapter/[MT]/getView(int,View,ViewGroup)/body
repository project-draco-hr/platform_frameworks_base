{
  final int itemViewType=getItemViewType(position);
switch (itemViewType) {
case ITEM_VIEW_TYPE_HEADER:
    return mHeaderView;
case ITEM_VIEW_TYPE_FOOTER:
  return mFooterView;
case ITEM_VIEW_TYPE_ACTIVITY:
if (convertView == null || convertView.getId() != R.id.list_item) {
  convertView=LayoutInflater.from(getContext()).inflate(R.layout.activity_chooser_view_list_item,parent,false);
}
PackageManager packageManager=mContext.getPackageManager();
ImageView iconView=(ImageView)convertView.findViewById(R.id.icon);
ResolveInfo activity=(ResolveInfo)getItem(position);
iconView.setBackgroundDrawable(activity.loadIcon(packageManager));
TextView titleView=(TextView)convertView.findViewById(R.id.title);
titleView.setText(activity.loadLabel(packageManager));
return convertView;
default :
throw new IllegalArgumentException();
}
}
