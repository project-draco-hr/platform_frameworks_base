{
  updateIcon(mAutomatic);
  if (mExternalChange)   return;
  if (!mAutomatic) {
    final int val=value + mMinimumBacklight;
    if (stopTracking) {
      MetricsLogger.action(mContext,MetricsEvent.ACTION_BRIGHTNESS,val);
    }
    setBrightness(val);
    if (!tracking) {
      AsyncTask.execute(new Runnable(){
        public void run(){
          Settings.System.putIntForUser(mContext.getContentResolver(),Settings.System.SCREEN_BRIGHTNESS,val,UserHandle.USER_CURRENT);
        }
      }
);
    }
  }
 else {
    final float adj=value / (BRIGHTNESS_ADJ_RESOLUTION / 2f) - 1;
    if (stopTracking) {
      MetricsLogger.action(mContext,MetricsEvent.ACTION_BRIGHTNESS_AUTO,value);
    }
    setBrightnessAdj(adj);
    if (!tracking) {
      AsyncTask.execute(new Runnable(){
        public void run(){
          Settings.System.putFloatForUser(mContext.getContentResolver(),Settings.System.SCREEN_AUTO_BRIGHTNESS_ADJ,adj,UserHandle.USER_CURRENT);
        }
      }
);
    }
  }
  for (  BrightnessStateChangeCallback cb : mChangeCallbacks) {
    cb.onBrightnessLevelChanged();
  }
}
