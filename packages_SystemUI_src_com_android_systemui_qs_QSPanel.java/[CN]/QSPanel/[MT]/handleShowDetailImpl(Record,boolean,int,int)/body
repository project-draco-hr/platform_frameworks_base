{
  if ((mDetailRecord != null) == show)   return;
  DetailAdapter detailAdapter=null;
  AnimatorListener listener=null;
  if (show) {
    detailAdapter=r.detailAdapter;
    r.detailView=detailAdapter.createDetailView(mContext,r.detailView,mDetailContent);
    if (r.detailView == null)     throw new IllegalStateException("Must return detail view");
    final Intent settingsIntent=detailAdapter.getSettingsIntent();
    mDetailSettingsButton.setVisibility(settingsIntent != null ? VISIBLE : GONE);
    mDetailSettingsButton.setOnClickListener(new OnClickListener(){
      @Override public void onClick(      View v){
        mHost.startSettingsActivity(settingsIntent);
      }
    }
);
    mDetailContent.removeAllViews();
    mDetail.bringToFront();
    mDetailContent.addView(r.detailView);
    MetricsLogger.visible(mContext,detailAdapter.getMetricsCategory());
    setDetailRecord(r);
    listener=mHideGridContentWhenDone;
    if (r instanceof TileRecord) {
      ((TileRecord)r).openingDetail=true;
    }
  }
 else {
    MetricsLogger.hidden(mContext,mDetailRecord.detailAdapter.getMetricsCategory());
    mClosingDetail=true;
    setGridContentVisibility(true);
    listener=mTeardownDetailWhenDone;
    fireScanStateChanged(false);
  }
  sendAccessibilityEvent(AccessibilityEvent.TYPE_WINDOW_STATE_CHANGED);
  fireShowingDetail(show ? detailAdapter : null);
  mClipper.animateCircularClip(x,y,show,listener);
}
