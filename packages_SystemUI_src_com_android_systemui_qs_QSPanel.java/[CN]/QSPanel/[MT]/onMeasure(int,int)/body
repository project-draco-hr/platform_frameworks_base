{
  final int width=MeasureSpec.getSize(widthMeasureSpec);
  mCellWidth=width / mColumns;
  mCellHeight=(int)(mCellWidth / TILE_ASPECT);
  mLargeCellWidth=(int)(mCellWidth * LARGE_TILE_FACTOR);
  mLargeCellHeight=(int)(mCellHeight * LARGE_TILE_FACTOR);
  int r=0;
  int c=0;
  int rows=0;
  for (  TileRecord record : mRecords) {
    if (record.tileView.getVisibility() == GONE)     continue;
    record.row=r;
    record.col=c;
    rows=r + 1;
    c++;
    if (c == mColumns || r == 0 && c == 2) {
      c=0;
      r++;
    }
  }
  for (  TileRecord record : mRecords) {
    if (record.tileView.getVisibility() == GONE)     continue;
    record.tileView.setDual(record.row == 0);
    final int cw=record.row == 0 ? mLargeCellWidth : mCellWidth;
    final int ch=record.row == 0 ? mLargeCellHeight : mCellHeight;
    record.tileView.measure(exactly(cw),exactly(ch));
  }
  final int actualHeight=rows == 0 ? 0 : getRowTop(rows);
  mDetail.measure(exactly(width),exactly(actualHeight));
  setMeasuredDimension(width,actualHeight);
}
