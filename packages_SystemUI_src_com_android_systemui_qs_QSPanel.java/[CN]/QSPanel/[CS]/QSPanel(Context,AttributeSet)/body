{
  super(context,attrs);
  mContext=context;
  mDetail=LayoutInflater.from(context).inflate(R.layout.qs_detail,this,false);
  mDetailContent=(ViewGroup)mDetail.findViewById(android.R.id.content);
  mDetailSettingsButton=(TextView)mDetail.findViewById(android.R.id.button2);
  mDetailDoneButton=(TextView)mDetail.findViewById(android.R.id.button1);
  updateDetailText();
  mDetail.setVisibility(GONE);
  mDetail.setClickable(true);
  addView(mDetail);
  mQsContainer=new LinearLayout(mContext);
  mQsContainer.setOrientation(LinearLayout.VERTICAL);
  mQsContainer.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT,LayoutParams.WRAP_CONTENT));
  addView(mQsContainer);
  mBrightnessView=LayoutInflater.from(context).inflate(R.layout.quick_settings_brightness_dialog,this,false);
  mQsContainer.addView(mBrightnessView);
  mTileLayout=(QSTileLayout)LayoutInflater.from(mContext).inflate(R.layout.qs_paged_tile_layout,mQsContainer,false);
  mQsContainer.addView((View)mTileLayout);
  findViewById(android.R.id.edit).setOnClickListener(new OnClickListener(){
    @Override public void onClick(    final View v){
      mHost.startRunnableDismissingKeyguard(new Runnable(){
        @Override public void run(){
          showEdit(v);
        }
      }
);
    }
  }
);
  mFooter=new QSFooter(this,context);
  mQsContainer.addView(mFooter.getView());
  mClipper=new QSDetailClipper(mDetail);
  updateResources();
  mBrightnessController=new BrightnessController(getContext(),(ImageView)findViewById(R.id.brightness_icon),(ToggleSlider)findViewById(R.id.brightness_slider));
  mDetailDoneButton.setOnClickListener(new OnClickListener(){
    @Override public void onClick(    View v){
      announceForAccessibility(mContext.getString(R.string.accessibility_desc_quick_settings));
      closeDetail();
    }
  }
);
}
