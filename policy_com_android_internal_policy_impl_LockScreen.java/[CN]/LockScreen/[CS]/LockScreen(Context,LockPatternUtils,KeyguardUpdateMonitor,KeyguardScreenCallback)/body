{
  super(context);
  mLockPatternUtils=lockPatternUtils;
  mUpdateMonitor=updateMonitor;
  mCallback=callback;
  final LayoutInflater inflater=LayoutInflater.from(context);
  inflater.inflate(R.layout.keyguard_screen_lock,this,true);
  mSimOk=isSimOk(updateMonitor.getSimState());
  mShowingBatteryInfo=updateMonitor.shouldShowBatteryInfo();
  mPluggedIn=updateMonitor.isDevicePluggedIn();
  mBatteryLevel=updateMonitor.getBatteryLevel();
  mHeaderSimOk1=(TextView)findViewById(R.id.headerSimOk1);
  mHeaderSimOk2=(TextView)findViewById(R.id.headerSimOk2);
  mHeaderSimBad1=(TextView)findViewById(R.id.headerSimBad1);
  mHeaderSimBad2=(TextView)findViewById(R.id.headerSimBad2);
  mTime=(TextView)findViewById(R.id.time);
  mDate=(TextView)findViewById(R.id.date);
  mBatteryInfoGroup=(ViewGroup)findViewById(R.id.batteryInfo);
  mBatteryInfoIcon=(ImageView)findViewById(R.id.batteryInfoIcon);
  mBatteryInfoText=(TextView)findViewById(R.id.batteryInfoText);
  mBatteryInfoSpacer=findViewById(R.id.batteryInfoSpacer);
  mNextAlarmGroup=(ViewGroup)findViewById(R.id.nextAlarmInfo);
  mAlarmText=(TextView)findViewById(R.id.nextAlarmText);
  mAlarmSpacer=findViewById(R.id.nextAlarmSpacer);
  mScreenLockedMessageGroup=(ViewGroup)findViewById(R.id.screenLockedInfo);
  mLockInstructions=(TextView)findViewById(R.id.lockInstructions);
  mEmergencyCallButton=(Button)findViewById(R.id.emergencyCallButton);
  mEmergencyCallButton.setOnClickListener(new View.OnClickListener(){
    public void onClick(    View v){
      mCallback.takeEmergencyCallAction();
    }
  }
);
  mOnlyVisibleWhenSimOk=new View[]{mHeaderSimOk1,mHeaderSimOk2,mBatteryInfoGroup,mBatteryInfoSpacer,mNextAlarmGroup,mAlarmSpacer,mScreenLockedMessageGroup,mLockInstructions};
  mOnlyVisibleWhenSimNotOk=new View[]{mHeaderSimBad1,mHeaderSimBad2,mEmergencyCallButton};
  setFocusable(true);
  setFocusableInTouchMode(true);
  setDescendantFocusability(ViewGroup.FOCUS_BLOCK_DESCENDANTS);
  refreshBatteryDisplay();
  refreshAlarmDisplay();
  refreshTimeAndDateDisplay();
  refreshUnlockIntructions();
  refreshViewsWRTSimOk();
  refreshSimOkHeaders(mUpdateMonitor.getTelephonyPlmn(),mUpdateMonitor.getTelephonySpn());
  updateMonitor.registerInfoCallback(this);
  updateMonitor.registerSimStateCallback(this);
  updateMonitor.registerConfigurationChangeCallback(this);
}
