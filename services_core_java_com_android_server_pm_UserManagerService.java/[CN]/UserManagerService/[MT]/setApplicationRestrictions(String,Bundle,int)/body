{
  if (UserHandle.getCallingUserId() != userId || !UserHandle.isSameApp(Binder.getCallingUid(),getUidForPackage(packageName))) {
    checkProfileOwnerOrManageUsersPermission("Only system or device owner can set restrictions for other users/apps");
  }
synchronized (mPackagesLock) {
    writeApplicationRestrictionsLocked(packageName,restrictions,userId);
  }
  Intent changeIntent=new Intent(Intent.ACTION_APPLICATION_RESTRICTIONS_CHANGED);
  changeIntent.setPackage(packageName);
  changeIntent.addFlags(Intent.FLAG_RECEIVER_REGISTERED_ONLY);
  mContext.sendBroadcastAsUser(changeIntent,new UserHandle(userId));
}
