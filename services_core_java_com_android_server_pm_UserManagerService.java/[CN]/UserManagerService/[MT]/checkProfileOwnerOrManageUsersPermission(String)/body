{
  final int uid=Binder.getCallingUid();
  boolean isProfileOwner=false;
  if (mContext != null && mContext.getPackageManager() != null) {
    String[] pkgs=mContext.getPackageManager().getPackagesForUid(uid);
    DevicePolicyManager dpm=(DevicePolicyManager)mContext.getSystemService(Context.DEVICE_POLICY_SERVICE);
    if (dpm != null) {
      for (      String pkg : pkgs) {
        if (dpm.isDeviceOwnerApp(pkg) || dpm.isProfileOwnerApp(pkg)) {
          isProfileOwner=true;
        }
      }
    }
  }
  if (missingManageUsersPermission(uid) && !isProfileOwner) {
    throw new SecurityException("You need MANAGE_USERS permission or device owner privileges to: " + message);
  }
}
