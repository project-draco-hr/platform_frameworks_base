{
synchronized (mInstallLock) {
synchronized (mPackagesLock) {
synchronized (mUsersLock) {
        ArrayList<UserInfo> partials=new ArrayList<UserInfo>();
        final int userSize=mUsers.size();
        for (int i=0; i < userSize; i++) {
          UserInfo ui=mUsers.valueAt(i);
          if ((ui.partial || ui.guestToRemove) && i != 0) {
            partials.add(ui);
          }
        }
        final int partialsSize=partials.size();
        for (int i=0; i < partialsSize; i++) {
          UserInfo ui=partials.get(i);
          Slog.w(LOG_TAG,"Removing partially created user " + ui.id + " (name="+ ui.name+ ")");
          removeUserStateLILP(ui.id);
        }
      }
    }
  }
  onUserForeground(UserHandle.USER_SYSTEM);
  mAppOpsService=IAppOpsService.Stub.asInterface(ServiceManager.getService(Context.APP_OPS_SERVICE));
  for (int i=0; i < mUserIds.length; ++i) {
    final int userId=mUserIds[i];
    try {
      mAppOpsService.setUserRestrictions(getEffectiveUserRestrictions(userId),userId);
    }
 catch (    RemoteException e) {
      Log.w(LOG_TAG,"Unable to notify AppOpsService of UserRestrictions");
    }
  }
}
