{
  mContext.getSystemService(StorageManager.class).destroyUserKey(userHandle);
  mPm.cleanUpUser(this,userHandle);
synchronized (mUsersLock) {
    mUsers.remove(userHandle);
    mUserAccounts.delete(userHandle);
    mIsUserManaged.delete(userHandle);
  }
synchronized (mRestrictionsLock) {
    mBaseUserRestrictions.remove(userHandle);
    mAppliedUserRestrictions.remove(userHandle);
    mCachedEffectiveUserRestrictions.remove(userHandle);
    mDevicePolicyLocalUserRestrictions.remove(userHandle);
  }
  AtomicFile userFile=new AtomicFile(new File(mUsersDir,userHandle + XML_SUFFIX));
  userFile.delete();
synchronized (mPackagesLock) {
    writeUserListLP();
  }
  updateUserIds();
  removeDirectoryRecursive(Environment.getUserSystemDirectory(userHandle));
}
