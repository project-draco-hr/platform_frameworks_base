{
  try {
    mContext.getSystemService(StorageManager.class).destroyUserKey(userHandle);
  }
 catch (  IllegalStateException e) {
    Slog.i(LOG_TAG,"Destroying key for user " + userHandle + " failed, continuing anyway",e);
  }
  mPm.cleanUpUser(this,userHandle);
synchronized (mUsersLock) {
    mUsers.remove(userHandle);
    mIsUserManaged.delete(userHandle);
  }
synchronized (mRestrictionsLock) {
    mBaseUserRestrictions.remove(userHandle);
    mAppliedUserRestrictions.remove(userHandle);
    mCachedEffectiveUserRestrictions.remove(userHandle);
    mDevicePolicyLocalUserRestrictions.remove(userHandle);
  }
synchronized (mPackagesLock) {
    writeUserListLP();
  }
  AtomicFile userFile=new AtomicFile(new File(mUsersDir,userHandle + XML_SUFFIX));
  userFile.delete();
  updateUserIds();
  File userDir=Environment.getUserSystemDirectory(userHandle);
  File renamedUserDir=Environment.getUserSystemDirectory(UserHandle.USER_NULL - userHandle);
  if (userDir.renameTo(renamedUserDir)) {
    removeDirectoryRecursive(renamedUserDir);
  }
 else {
    removeDirectoryRecursive(userDir);
  }
}
