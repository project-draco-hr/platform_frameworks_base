{
  checkManageUsersPermission("check if more managed profiles can be added.");
  if (ActivityManager.isLowRamDeviceStatic()) {
    return false;
  }
  if (!mContext.getPackageManager().hasSystemFeature(PackageManager.FEATURE_MANAGED_USERS)) {
    return false;
  }
  int managedProfilesCount=getProfiles(userId,true).size() - 1;
  if (managedProfilesCount >= MAX_MANAGED_PROFILES) {
    return false;
  }
synchronized (mUsersLock) {
    UserInfo userInfo=getUserInfoLU(userId);
    if (!userInfo.canHaveProfile()) {
      return false;
    }
    int usersCount=getAliveUsersExcludingGuestsCountLU();
    return usersCount == 1 || usersCount < UserManager.getMaxSupportedUsers();
  }
}
