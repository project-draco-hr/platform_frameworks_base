{
  if (DBG) {
    Log.d(LOG_TAG,"updateUserRestrictionsInternalLocked userId=" + userId + " bundle="+ newRestrictions);
  }
  if (newRestrictions != null) {
    Preconditions.checkState(mBaseUserRestrictions.get(userId) != newRestrictions);
    Preconditions.checkState(mCachedEffectiveUserRestrictions.get(userId) != newRestrictions);
    mBaseUserRestrictions.put(userId,newRestrictions);
    scheduleWriteUser(mUsers.get(userId));
  }
  final Bundle effective=computeEffectiveUserRestrictionsLR(userId);
  mCachedEffectiveUserRestrictions.put(userId,effective);
  applyUserRestrictionsLR(userId,effective);
}
