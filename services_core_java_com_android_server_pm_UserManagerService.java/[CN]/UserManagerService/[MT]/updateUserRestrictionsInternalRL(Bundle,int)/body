{
  if (DBG) {
    Log.d(LOG_TAG,"updateUserRestrictionsInternalLocked userId=" + userId + " bundle="+ newRestrictions);
  }
  final Bundle prevRestrictions=getEffectiveUserRestrictions(userId);
  if (newRestrictions != null) {
    Preconditions.checkState(mBaseUserRestrictions.get(userId) != newRestrictions);
    Preconditions.checkState(mCachedEffectiveUserRestrictions.get(userId) != newRestrictions);
    mBaseUserRestrictions.put(userId,newRestrictions);
  }
  final Bundle effective=computeEffectiveUserRestrictionsRL(userId);
  mCachedEffectiveUserRestrictions.put(userId,effective);
  applyUserRestrictionsRL(userId,effective,prevRestrictions);
}
