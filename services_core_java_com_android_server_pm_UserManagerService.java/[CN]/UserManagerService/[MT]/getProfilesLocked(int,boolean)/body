{
  UserInfo user=getUserInfoLocked(userId);
  ArrayList<UserInfo> users=new ArrayList<UserInfo>(mUsers.size());
  if (user == null) {
    return users;
  }
  final int userSize=mUsers.size();
  for (int i=0; i < userSize; i++) {
    UserInfo profile=mUsers.valueAt(i);
    if (!isProfileOf(user,profile)) {
      continue;
    }
    if (enabledOnly && !profile.isEnabled()) {
      continue;
    }
    if (mRemovingUserIds.get(profile.id)) {
      continue;
    }
    users.add(profile);
  }
  return users;
}
