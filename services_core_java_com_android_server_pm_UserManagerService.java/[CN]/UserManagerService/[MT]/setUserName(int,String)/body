{
  checkManageUsersPermission("rename users");
  boolean changed=false;
synchronized (mPackagesLock) {
    UserData userData=getUserDataNoChecks(userId);
    if (userData == null || userData.info.partial) {
      Slog.w(LOG_TAG,"setUserName: unknown user #" + userId);
      return;
    }
    if (name != null && !name.equals(userData.info.name)) {
      userData.info.name=name;
      writeUserLP(userData);
      changed=true;
    }
  }
  if (changed) {
    sendUserInfoChangedBroadcast(userId);
  }
}
