{
  final int credentialOwnerUserId=getCredentialOwnerProfile(userHandle);
  if (mContext.getSystemService(StorageManager.class).isUserKeyUnlocked(userHandle) || !mLockPatternUtils.isSecure(credentialOwnerUserId)) {
    setQuietModeEnabled(userHandle,false);
    return true;
  }
  long identity=Binder.clearCallingIdentity();
  try {
    final KeyguardManager km=(KeyguardManager)mContext.getSystemService(Context.KEYGUARD_SERVICE);
    final Intent unlockIntent=km.createConfirmDeviceCredentialIntent(null,null,userHandle);
    if (unlockIntent == null) {
      return false;
    }
    if (target != null) {
      unlockIntent.putExtra(Intent.EXTRA_INTENT,target);
    }
    unlockIntent.setFlags(FLAG_ACTIVITY_NEW_TASK | FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS);
    mContext.startActivity(unlockIntent);
  }
  finally {
    Binder.restoreCallingIdentity(identity);
  }
  return false;
}
