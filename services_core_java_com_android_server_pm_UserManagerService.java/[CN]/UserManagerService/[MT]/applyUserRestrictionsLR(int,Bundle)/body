{
  if (newRestrictions == null) {
    newRestrictions=Bundle.EMPTY;
  }
  Bundle prevRestrictions=mAppliedUserRestrictions.get(userId);
  if (prevRestrictions == null) {
    prevRestrictions=Bundle.EMPTY;
  }
  if (DBG) {
    Log.d(LOG_TAG,"applyUserRestrictionsRL userId=" + userId + " new="+ newRestrictions+ " prev="+ prevRestrictions);
  }
  final long token=Binder.clearCallingIdentity();
  try {
    mAppOpsService.setUserRestrictions(newRestrictions,userId);
  }
 catch (  RemoteException e) {
    Log.w(LOG_TAG,"Unable to notify AppOpsService of UserRestrictions");
  }
 finally {
    Binder.restoreCallingIdentity(token);
  }
  UserRestrictionsUtils.applyUserRestrictionsLR(mContext,userId,newRestrictions,prevRestrictions);
  notifyUserRestrictionsListeners(userId,newRestrictions,prevRestrictions);
  mAppliedUserRestrictions.put(userId,new Bundle(newRestrictions));
}
