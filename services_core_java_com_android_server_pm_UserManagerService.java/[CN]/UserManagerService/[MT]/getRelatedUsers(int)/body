{
  checkManageUsersPermission("query users");
synchronized (mPackagesLock) {
    UserInfo user=getUserInfoLocked(userId);
    ArrayList<UserInfo> users=new ArrayList<UserInfo>(mUsers.size());
    for (int i=0; i < mUsers.size(); i++) {
      UserInfo ui=mUsers.valueAt(i);
      if (!areRelatedUsers(user,ui)) {
        continue;
      }
      users.add(ui);
    }
    return users;
  }
}
