{
  checkManageUsersPermission("canHaveRestrictedProfile");
synchronized (mUsersLock) {
    final UserInfo userInfo=getUserInfoLU(userId);
    if (userInfo == null || !userInfo.canHaveProfile()) {
      return false;
    }
    if (!userInfo.isAdmin()) {
      return false;
    }
  }
  DevicePolicyManager dpm=(DevicePolicyManager)mContext.getSystemService(Context.DEVICE_POLICY_SERVICE);
  return !dpm.isDeviceManaged() && dpm.getProfileOwnerAsUser(userId) == null;
}
