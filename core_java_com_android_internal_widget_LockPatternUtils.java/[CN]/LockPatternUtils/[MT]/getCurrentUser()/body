{
  if (Process.myUid() == Process.SYSTEM_UID) {
    if (mCurrentUserId != UserHandle.USER_NULL) {
      return mCurrentUserId;
    }
    try {
      return ActivityManagerNative.getDefault().getCurrentUser().id;
    }
 catch (    RemoteException re) {
      return UserHandle.USER_OWNER;
    }
  }
 else {
    throw new SecurityException("Only the system process can get the current user");
  }
}
