{
  long mode=getKeyguardStoredPasswordQuality(userId);
  final boolean isPattern=mode == DevicePolicyManager.PASSWORD_QUALITY_SOMETHING;
  final boolean isPassword=mode == DevicePolicyManager.PASSWORD_QUALITY_NUMERIC || mode == DevicePolicyManager.PASSWORD_QUALITY_NUMERIC_COMPLEX || mode == DevicePolicyManager.PASSWORD_QUALITY_ALPHABETIC || mode == DevicePolicyManager.PASSWORD_QUALITY_ALPHANUMERIC || mode == DevicePolicyManager.PASSWORD_QUALITY_COMPLEX;
  final boolean secure=isPattern && isLockPatternEnabled(userId) && savedPatternExists(userId) || isPassword && savedPasswordExists(userId);
  return secure;
}
