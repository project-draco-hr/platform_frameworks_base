{
  long deadline=getLong(LOCKOUT_ATTEMPT_DEADLINE,0L,userId);
  final long timeoutMs=getLong(LOCKOUT_ATTEMPT_TIMEOUT_MS,0L,userId);
  final long now=SystemClock.elapsedRealtime();
  if (deadline < now) {
    setLong(LOCKOUT_ATTEMPT_DEADLINE,0,userId);
    setLong(LOCKOUT_ATTEMPT_TIMEOUT_MS,0,userId);
    return 0L;
  }
  if (deadline > (now + timeoutMs)) {
    deadline=now + timeoutMs;
    setLong(LOCKOUT_ATTEMPT_DEADLINE,deadline,userId);
  }
  return deadline;
}
