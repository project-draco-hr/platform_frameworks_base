{
  if (!(getUserManager().isSystemUser() || getUserManager().isPrimaryUser())) {
    throw new IllegalStateException("Only the system or primary user may call setCredentialRequiredForDecrypt()");
  }
  if (isDeviceEncryptionEnabled()) {
    Settings.Global.putInt(mContext.getContentResolver(),Settings.Global.REQUIRE_PASSWORD_TO_DECRYPT,required ? 1 : 0);
  }
}
