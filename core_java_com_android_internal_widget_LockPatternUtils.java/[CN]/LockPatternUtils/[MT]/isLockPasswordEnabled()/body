{
  long mode=getLong(PASSWORD_TYPE_KEY,0);
  long backupMode=getLong(PASSWORD_TYPE_ALTERNATE_KEY,0);
  final boolean passwordEnabled=mode == DevicePolicyManager.PASSWORD_QUALITY_ALPHABETIC || mode == DevicePolicyManager.PASSWORD_QUALITY_NUMERIC || mode == DevicePolicyManager.PASSWORD_QUALITY_ALPHANUMERIC || mode == DevicePolicyManager.PASSWORD_QUALITY_COMPLEX;
  final boolean backupEnabled=backupMode == DevicePolicyManager.PASSWORD_QUALITY_ALPHABETIC || backupMode == DevicePolicyManager.PASSWORD_QUALITY_NUMERIC || backupMode == DevicePolicyManager.PASSWORD_QUALITY_ALPHANUMERIC || backupMode == DevicePolicyManager.PASSWORD_QUALITY_COMPLEX;
  return savedPasswordExists() && (passwordEnabled || (usingBiometricWeak() && backupEnabled));
}
