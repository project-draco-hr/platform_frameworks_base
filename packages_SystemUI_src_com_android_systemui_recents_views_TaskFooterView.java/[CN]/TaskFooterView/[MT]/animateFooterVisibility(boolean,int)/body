{
  if (mMaxFooterHeight <= 0)   return;
  if (!visible && getVisibility() != View.VISIBLE)   return;
  if (visible && getVisibility() == View.VISIBLE)   return;
  if (mFooterAnimator != null) {
    mFooterAnimator.removeAllListeners();
    mFooterAnimator.cancel();
  }
  int finalHeight=visible ? mMaxFooterHeight : 0;
  if (duration > 0) {
    if (visible && getVisibility() != View.VISIBLE) {
      setVisibility(View.VISIBLE);
    }
    mFooterAnimator=ObjectAnimator.ofInt(this,"footerHeight",finalHeight);
    mFooterAnimator.setDuration(duration);
    mFooterAnimator.setInterpolator(mConfig.fastOutSlowInInterpolator);
    mFooterAnimator.addListener(new AnimatorListenerAdapter(){
      @Override public void onAnimationEnd(      Animator animation){
        if (!visible) {
          setVisibility(View.INVISIBLE);
        }
      }
    }
);
    mFooterAnimator.start();
  }
 else {
    setFooterHeight(finalHeight);
    setVisibility(visible ? View.VISIBLE : View.INVISIBLE);
  }
}
