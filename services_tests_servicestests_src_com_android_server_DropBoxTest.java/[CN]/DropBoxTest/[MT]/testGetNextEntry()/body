{
  File dir=getEmptyDir("testGetNextEntry");
  DropBoxManagerService service=new DropBoxManagerService(getContext(),dir);
  DropBoxManager dropbox=new DropBoxManager(getContext(),service.getServiceStub());
  long before=System.currentTimeMillis();
  dropbox.addText("DropBoxTest.A","A0");
  dropbox.addText("DropBoxTest.B","B0");
  dropbox.addText("DropBoxTest.A","A1");
  DropBoxManager.Entry a0=dropbox.getNextEntry("DropBoxTest.A",before);
  DropBoxManager.Entry a1=dropbox.getNextEntry("DropBoxTest.A",a0.getTimeMillis());
  assertTrue(null == dropbox.getNextEntry("DropBoxTest.A",a1.getTimeMillis()));
  DropBoxManager.Entry b0=dropbox.getNextEntry("DropBoxTest.B",before);
  assertTrue(null == dropbox.getNextEntry("DropBoxTest.B",b0.getTimeMillis()));
  DropBoxManager.Entry x0=dropbox.getNextEntry(null,before);
  DropBoxManager.Entry x1=dropbox.getNextEntry(null,x0.getTimeMillis());
  DropBoxManager.Entry x2=dropbox.getNextEntry(null,x1.getTimeMillis());
  assertTrue(null == dropbox.getNextEntry(null,x2.getTimeMillis()));
  assertEquals("DropBoxTest.A",a0.getTag());
  assertEquals("DropBoxTest.A",a1.getTag());
  assertEquals("A0",a0.getText(80));
  assertEquals("A1",a1.getText(80));
  assertEquals("DropBoxTest.B",b0.getTag());
  assertEquals("B0",b0.getText(80));
  assertEquals("DropBoxTest.A",x0.getTag());
  assertEquals("DropBoxTest.B",x1.getTag());
  assertEquals("DropBoxTest.A",x2.getTag());
  assertEquals("A0",x0.getText(80));
  assertEquals("B0",x1.getText(80));
  assertEquals("A1",x2.getText(80));
  a0.close();
  a1.close();
  b0.close();
  x0.close();
  x1.close();
  x2.close();
}
