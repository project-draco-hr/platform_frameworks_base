{
  Process.setThreadPriority(Process.THREAD_PRIORITY_BACKGROUND);
synchronized (RootScanner.this) {
    while (!mClosed) {
      final int[] deviceIds=mManager.getOpenedDeviceIds();
      if (deviceIds.length == 0) {
        break;
      }
      boolean changed=false;
      for (      int deviceId : deviceIds) {
        mDatabase.startAddingRootDocuments(deviceId);
        try {
          changed=mDatabase.putRootDocuments(deviceId,mResources,mManager.getRoots(deviceId)) || changed;
        }
 catch (        IOException|SQLiteException exp) {
          Log.e(MtpDocumentsProvider.TAG,exp.getMessage());
          continue;
        }
 finally {
          changed=mDatabase.stopAddingRootDocuments(deviceId) || changed;
        }
      }
      if (changed) {
        notifyChange();
      }
      mPollingCount++;
      try {
        RootScanner.this.wait(mPollingCount > SHORT_POLLING_TIMES ? LONG_POLLING_INTERVAL : SHORT_POLLING_INTERVAL);
      }
 catch (      InterruptedException exception) {
        break;
      }
    }
    mBackgroundThread=null;
  }
}
