{
  if (alias == null) {
    throw new NullPointerException("alias == null");
  }
  KeyChainConnection keyChainConnection=bind(context);
  try {
    IKeyChainService keyChainService=keyChainConnection.getService();
    byte[] certificateBytes=keyChainService.getCertificate(alias);
    List<X509Certificate> chain=new ArrayList<X509Certificate>();
    chain.add(toCertificate(certificateBytes));
    TrustedCertificateStore store=new TrustedCertificateStore();
    for (int i=0; true; i++) {
      X509Certificate cert=chain.get(i);
      if (Objects.equal(cert.getSubjectX500Principal(),cert.getIssuerX500Principal())) {
        break;
      }
      X509Certificate issuer=store.findIssuer(cert);
      if (issuer == null) {
        break;
      }
      chain.add(issuer);
    }
    return chain.toArray(new X509Certificate[chain.size()]);
  }
 catch (  RemoteException e) {
    throw new KeyChainException(e);
  }
catch (  RuntimeException e) {
    throw new KeyChainException(e);
  }
 finally {
    keyChainConnection.close();
  }
}
