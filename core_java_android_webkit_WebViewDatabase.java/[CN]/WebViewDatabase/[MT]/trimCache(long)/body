{
  ArrayList<String> pathList=new ArrayList<String>(100);
  Cursor cursor=mCacheDatabase.rawQuery("SELECT contentlength, filepath FROM cache ORDER BY expires ASC",null);
  if (cursor.moveToFirst()) {
    int batchSize=100;
    StringBuilder pathStr=new StringBuilder(20 + 16 * batchSize);
    pathStr.append("DELETE FROM cache WHERE filepath = ?");
    for (int i=1; i < batchSize; i++) {
      pathStr.append(" OR filepath = ?");
    }
    SQLiteStatement statement=mCacheDatabase.compileStatement(pathStr.toString());
    int index=1;
    do {
      long length=cursor.getLong(0);
      if (length == 0) {
        continue;
      }
      amount-=length;
      String filePath=cursor.getString(1);
      statement.bindString(index,filePath);
      pathList.add(filePath);
      if (index++ == batchSize) {
        statement.execute();
        index=1;
      }
    }
 while (cursor.moveToNext() && amount > 0);
    if (index > 1) {
      statement.execute();
    }
    statement.close();
  }
  cursor.close();
  return pathList;
}
