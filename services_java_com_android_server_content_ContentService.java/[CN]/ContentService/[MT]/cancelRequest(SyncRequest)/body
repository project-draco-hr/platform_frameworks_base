{
  SyncManager syncManager=getSyncManager();
  if (syncManager == null)   return;
  int userId=UserHandle.getCallingUserId();
  int callerUid=Binder.getCallingUid();
  long identityToken=clearCallingIdentity();
  try {
    SyncStorageEngine.EndPoint info;
    Bundle extras=new Bundle(request.getBundle());
    if (request.hasAuthority()) {
      Account account=request.getAccount();
      String provider=request.getProvider();
      info=new SyncStorageEngine.EndPoint(account,provider,userId);
    }
 else {
      ComponentName service=request.getService();
      verifySignatureForPackage(callerUid,service.getPackageName(),"cancel");
      info=new SyncStorageEngine.EndPoint(service,userId);
    }
    if (request.isPeriodic()) {
      mContext.enforceCallingOrSelfPermission(Manifest.permission.WRITE_SYNC_SETTINGS,"no permission to write the sync settings");
      getSyncManager().getSyncStorageEngine().removePeriodicSync(info,extras);
    }
    syncManager.cancelScheduledSyncOperation(info,extras);
    syncManager.cancelActiveSync(info,extras);
  }
  finally {
    restoreCallingIdentity(identityToken);
  }
}
