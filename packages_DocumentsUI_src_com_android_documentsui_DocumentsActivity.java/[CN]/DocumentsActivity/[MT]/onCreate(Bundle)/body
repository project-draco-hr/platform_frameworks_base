{
  super.onCreate(icicle);
  mRoots=DocumentsApplication.getRootsCache(this);
  setResult(Activity.RESULT_CANCELED);
  setContentView(R.layout.activity);
  mRootsContainer=findViewById(R.id.container_roots);
  mDrawerLayout=(DrawerLayout)findViewById(R.id.drawer_layout);
  mDrawerToggle=new ActionBarDrawerToggle(this,mDrawerLayout,R.drawable.ic_drawer,R.string.drawer_open,R.string.drawer_close);
  mDrawerLayout.setDrawerListener(mDrawerListener);
  mDrawerLayout.setDrawerShadow(R.drawable.ic_drawer_shadow,GravityCompat.START);
  if (icicle != null) {
    mState=icicle.getParcelable(EXTRA_STATE);
  }
 else {
    buildDefaultState();
  }
  if (mState.action == ACTION_MANAGE) {
    mDrawerLayout.setDrawerLockMode(DrawerLayout.LOCK_MODE_LOCKED_CLOSED);
  }
  if (mState.action == ACTION_CREATE) {
    final String mimeType=getIntent().getType();
    final String title=getIntent().getStringExtra(Intent.EXTRA_TITLE);
    SaveFragment.show(getFragmentManager(),mimeType,title);
  }
  if (mState.action == ACTION_GET_CONTENT) {
    final Intent moreApps=new Intent(getIntent());
    moreApps.setComponent(null);
    moreApps.setPackage(null);
    RootsFragment.show(getFragmentManager(),moreApps);
  }
 else   if (mState.action == ACTION_OPEN || mState.action == ACTION_CREATE) {
    RootsFragment.show(getFragmentManager(),null);
  }
  onCurrentDirectoryChanged();
}
