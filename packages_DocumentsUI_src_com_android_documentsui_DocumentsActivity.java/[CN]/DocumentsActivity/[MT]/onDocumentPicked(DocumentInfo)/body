{
  final FragmentManager fm=getFragmentManager();
  if (doc.isDirectory()) {
    mState.stack.push(doc);
    mState.stackTouched=true;
    onCurrentDirectoryChanged(ANIM_DOWN);
  }
 else   if (mState.action == ACTION_OPEN || mState.action == ACTION_GET_CONTENT) {
    new ExistingFinishTask(doc.derivedUri).executeOnExecutor(getCurrentExecutor());
  }
 else   if (mState.action == ACTION_CREATE) {
    SaveFragment.get(fm).setReplaceTarget(doc);
  }
 else   if (mState.action == ACTION_MANAGE) {
    final Intent manage=new Intent(DocumentsContract.ACTION_MANAGE_DOCUMENT);
    manage.setData(doc.derivedUri);
    try {
      startActivity(manage);
    }
 catch (    ActivityNotFoundException ex) {
      final Intent view=new Intent(Intent.ACTION_VIEW);
      view.setFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION);
      view.setData(doc.derivedUri);
      try {
        startActivity(view);
      }
 catch (      ActivityNotFoundException ex2) {
        Toast.makeText(this,R.string.toast_no_application,Toast.LENGTH_SHORT).show();
      }
    }
  }
 else   if (mState.action == ACTION_BROWSE) {
    final Intent view=new Intent(Intent.ACTION_VIEW);
    view.setFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION);
    view.setData(doc.derivedUri);
    try {
      startActivity(view);
    }
 catch (    ActivityNotFoundException ex) {
      Toast.makeText(this,R.string.toast_no_application,Toast.LENGTH_SHORT).show();
    }
  }
}
