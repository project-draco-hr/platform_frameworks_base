{
  Log.d(TAG,"onFinished() " + Arrays.toString(uris));
  final Intent intent=new Intent();
  if (uris.length == 1) {
    intent.setData(uris[0]);
  }
 else   if (uris.length > 1) {
    final ClipData clipData=new ClipData(null,mState.acceptMimes,new ClipData.Item(uris[0]));
    for (int i=1; i < uris.length; i++) {
      clipData.addItem(new ClipData.Item(uris[i]));
    }
    intent.setClipData(clipData);
  }
  if (mState.action == ACTION_GET_CONTENT) {
    intent.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION);
  }
 else   if (mState.action == ACTION_OPEN_TREE || mState.action == ACTION_OPEN_COPY_DESTINATION) {
    intent.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION | Intent.FLAG_GRANT_WRITE_URI_PERMISSION | Intent.FLAG_GRANT_PERSISTABLE_URI_PERMISSION| Intent.FLAG_GRANT_PREFIX_URI_PERMISSION);
    intent.putExtra(CopyService.EXTRA_STACK,(Parcelable)mState.stack);
    intent.putExtra(CopyService.EXTRA_TRANSFER_MODE,mState.transferMode);
  }
 else {
    intent.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION | Intent.FLAG_GRANT_WRITE_URI_PERMISSION | Intent.FLAG_GRANT_PERSISTABLE_URI_PERMISSION);
  }
  setResult(Activity.RESULT_OK,intent);
  finish();
}
