{
  super.onCreateOptionsMenu(menu);
  getMenuInflater().inflate(R.menu.activity,menu);
  final MenuItem searchMenu=menu.findItem(R.id.menu_search);
  mSearchView=(SearchView)searchMenu.getActionView();
  mSearchView.setOnQueryTextListener(new OnQueryTextListener(){
    @Override public boolean onQueryTextSubmit(    String query){
      mState.currentSearch=query;
      onCurrentDirectoryChanged();
      return true;
    }
    @Override public boolean onQueryTextChange(    String newText){
      return false;
    }
  }
);
  searchMenu.setOnActionExpandListener(new OnActionExpandListener(){
    @Override public boolean onMenuItemActionExpand(    MenuItem item){
      return true;
    }
    @Override public boolean onMenuItemActionCollapse(    MenuItem item){
      if (mIgnoreNextCollapse) {
        mIgnoreNextCollapse=false;
        return true;
      }
      mState.currentSearch=null;
      onCurrentDirectoryChanged();
      return true;
    }
  }
);
  return true;
}
