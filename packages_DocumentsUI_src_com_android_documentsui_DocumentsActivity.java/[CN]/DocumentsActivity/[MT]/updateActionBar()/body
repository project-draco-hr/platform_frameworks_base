{
  final FragmentManager fm=getFragmentManager();
  final ActionBar actionBar=getActionBar();
  if (fm.getBackStackEntryCount() > 0) {
    actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_LIST);
    actionBar.setDisplayShowHomeEnabled(true);
    actionBar.setDisplayHomeAsUpEnabled(true);
    actionBar.setTitle(null);
    actionBar.setListNavigationCallbacks(mStackAdapter,mNavigationListener);
    actionBar.setSelectedNavigationItem(mStackAdapter.getCount() - 1);
    mIgnoreNextNavigation=true;
  }
 else {
    actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_STANDARD);
    actionBar.setDisplayShowHomeEnabled(false);
    actionBar.setDisplayHomeAsUpEnabled(false);
    if (mMode == MODE_OPEN) {
      actionBar.setTitle(R.string.title_open);
    }
 else     if (mMode == MODE_CREATE) {
      actionBar.setTitle(R.string.title_save);
    }
  }
}
