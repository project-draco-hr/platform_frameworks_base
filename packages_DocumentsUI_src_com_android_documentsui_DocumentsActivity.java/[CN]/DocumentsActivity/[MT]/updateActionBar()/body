{
  final ActionBar actionBar=getActionBar();
  actionBar.setDisplayShowHomeEnabled(true);
  if (mState.action == ACTION_MANAGE) {
    actionBar.setDisplayHomeAsUpEnabled(false);
    mDrawerToggle.setDrawerIndicatorEnabled(false);
  }
 else {
    actionBar.setDisplayHomeAsUpEnabled(true);
    mDrawerToggle.setDrawerIndicatorEnabled(true);
  }
  if (mDrawerLayout.isDrawerOpen(mRootsContainer)) {
    actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_STANDARD);
    actionBar.setIcon(new ColorDrawable());
    if (mState.action == ACTION_OPEN || mState.action == ACTION_GET_CONTENT) {
      actionBar.setTitle(R.string.title_open);
    }
 else     if (mState.action == ACTION_CREATE) {
      actionBar.setTitle(R.string.title_save);
    }
  }
 else {
    final RootInfo root=getCurrentRoot();
    actionBar.setIcon(root != null ? root.loadIcon(this) : null);
    if (mState.stack.size() <= 1) {
      actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_STANDARD);
      actionBar.setTitle(root.title);
    }
 else {
      mIgnoreNextNavigation=true;
      actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_LIST);
      actionBar.setTitle(null);
      actionBar.setListNavigationCallbacks(mStackAdapter,mStackListener);
      actionBar.setSelectedNavigationItem(mStackAdapter.getCount() - 1);
    }
  }
}
