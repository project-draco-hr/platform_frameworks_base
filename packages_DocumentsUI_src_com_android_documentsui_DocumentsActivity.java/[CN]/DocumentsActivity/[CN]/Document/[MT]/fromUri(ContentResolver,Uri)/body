{
  final Document doc=new Document();
  doc.uri=uri;
  final Cursor cursor=resolver.query(uri,null,null,null,null);
  try {
    if (!cursor.moveToFirst()) {
      throw new IllegalArgumentException("Missing details for " + uri);
    }
    doc.mimeType=getCursorString(cursor,DocumentColumns.MIME_TYPE);
    doc.displayName=getCursorString(cursor,DocumentColumns.DISPLAY_NAME);
    doc.lastModified=getCursorLong(cursor,DocumentColumns.LAST_MODIFIED);
    doc.flags=getCursorInt(cursor,DocumentColumns.FLAGS);
  }
  finally {
    cursor.close();
  }
  return doc;
}
