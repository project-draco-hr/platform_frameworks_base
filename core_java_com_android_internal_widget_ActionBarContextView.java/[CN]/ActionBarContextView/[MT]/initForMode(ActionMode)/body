{
  if (mClose == null) {
    LayoutInflater inflater=LayoutInflater.from(mContext);
    mClose=inflater.inflate(R.layout.action_mode_close_item,this,false);
    addView(mClose);
  }
 else   if (mClose.getParent() == null) {
    addView(mClose);
  }
  View closeButton=mClose.findViewById(R.id.action_mode_close_button);
  closeButton.setOnClickListener(new OnClickListener(){
    public void onClick(    View v){
      mode.finish();
    }
  }
);
  final MenuBuilder menu=(MenuBuilder)mode.getMenu();
  mMenuPresenter=new ActionMenuPresenter();
  menu.addMenuPresenter(mMenuPresenter);
  mMenuView=(ActionMenuView)mMenuPresenter.getMenuView(this);
  final LayoutParams layoutParams=new LayoutParams(LayoutParams.WRAP_CONTENT,LayoutParams.MATCH_PARENT);
  mMenuView.setLayoutParams(layoutParams);
  if (mSplitView == null) {
    addView(mMenuView);
  }
 else {
    mMenuPresenter.setWidthLimit(getContext().getResources().getDisplayMetrics().widthPixels,true);
    mMenuPresenter.setItemLimit(Integer.MAX_VALUE);
    layoutParams.width=LayoutParams.MATCH_PARENT;
    mSplitView.addView(mMenuView);
  }
  mAnimateInOnLayout=true;
}
