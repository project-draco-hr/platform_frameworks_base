{
synchronized (mLockObj) {
    if (!mRegistered && mConnectionRequested && mNetworkInfo != null && mNetworkInfo.isConnected() && mNetworkCapabilities != null && mLinkProperties != null && mNetworkScore != 0) {
      if (DBG)       log("Registering NetworkAgent");
      mRegistered=true;
      ConnectivityManager cm=(ConnectivityManager)mContext.getSystemService(Context.CONNECTIVITY_SERVICE);
      cm.registerNetworkAgent(new Messenger(this),new NetworkInfo(mNetworkInfo),new LinkProperties(mLinkProperties),new NetworkCapabilities(mNetworkCapabilities),mNetworkScore);
    }
 else     if (DBG && !mRegistered) {
      String err="Not registering due to ";
      if (mConnectionRequested == false)       err+="no Connect requested ";
      if (mNetworkInfo == null)       err+="null NetworkInfo ";
      if (mNetworkInfo != null && mNetworkInfo.isConnected() == false) {
        err+="NetworkInfo disconnected ";
      }
      if (mLinkProperties == null)       err+="null LinkProperties ";
      if (mNetworkCapabilities == null)       err+="null NetworkCapabilities ";
      if (mNetworkScore == 0)       err+="null NetworkScore";
      log(err);
    }
  }
}
