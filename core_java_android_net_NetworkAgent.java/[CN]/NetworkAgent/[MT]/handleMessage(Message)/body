{
switch (msg.what) {
case AsyncChannel.CMD_CHANNEL_FULL_CONNECTION:
{
synchronized (mLockObj) {
        if (mAsyncChannel != null) {
          log("Received new connection while already connected!");
        }
 else {
          if (DBG)           log("NetworkAgent fully connected");
          mAsyncChannel=new AsyncChannel();
          mAsyncChannel.connected(null,this,msg.replyTo);
          mAsyncChannel.replyToMessage(msg,AsyncChannel.CMD_CHANNEL_FULLY_CONNECTED,AsyncChannel.STATUS_SUCCESSFUL);
        }
      }
      break;
    }
case AsyncChannel.CMD_CHANNEL_DISCONNECT:
{
    if (DBG)     log("CMD_CHANNEL_DISCONNECT");
    if (mAsyncChannel != null)     mAsyncChannel.disconnect();
    break;
  }
case AsyncChannel.CMD_CHANNEL_DISCONNECTED:
{
  if (DBG)   log("NetworkAgent channel lost");
  disconnect();
  clear();
  break;
}
case CMD_SUSPECT_BAD:
{
log("Unhandled Message " + msg);
break;
}
case CMD_ADD_REQUEST:
{
handleAddRequest(msg);
break;
}
case CMD_REMOVE_REQUEST:
{
handleRemoveRequest(msg);
break;
}
}
}
