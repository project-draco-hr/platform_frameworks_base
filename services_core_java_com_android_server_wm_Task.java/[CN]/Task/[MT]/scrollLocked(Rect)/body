{
  mStack.getDimBounds(mTmpRect);
  if (mService.mCurConfiguration.orientation == ORIENTATION_LANDSCAPE) {
    if (bounds.left > mTmpRect.left) {
      bounds.left=mTmpRect.left;
      bounds.right=mTmpRect.left + mBounds.width();
    }
 else     if (bounds.right < mTmpRect.right) {
      bounds.left=mTmpRect.right - mBounds.width();
      bounds.right=mTmpRect.right;
    }
  }
 else {
    if (bounds.top > mTmpRect.top) {
      bounds.top=mTmpRect.top;
      bounds.bottom=mTmpRect.top + mBounds.height();
    }
 else     if (bounds.bottom < mTmpRect.bottom) {
      bounds.top=mTmpRect.bottom - mBounds.height();
      bounds.bottom=mTmpRect.bottom;
    }
  }
  if (bounds.equals(mBounds)) {
    return false;
  }
  mBounds.set(bounds);
  for (int activityNdx=mAppTokens.size() - 1; activityNdx >= 0; --activityNdx) {
    final ArrayList<WindowState> windows=mAppTokens.get(activityNdx).allAppWindows;
    for (int winNdx=windows.size() - 1; winNdx >= 0; --winNdx) {
      final WindowState win=windows.get(winNdx);
      win.mXOffset=bounds.left;
      win.mYOffset=bounds.top;
    }
  }
  return true;
}
