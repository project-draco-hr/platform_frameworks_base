{
  if (config == null) {
    config=Configuration.EMPTY;
  }
  if (bounds == null && !Configuration.EMPTY.equals(config)) {
    throw new IllegalArgumentException("null bounds but non empty configuration: " + config);
  }
  if (bounds != null && Configuration.EMPTY.equals(config)) {
    throw new IllegalArgumentException("non null bounds, but empty configuration");
  }
  boolean oldFullscreen=mFullscreen;
  int rotation=Surface.ROTATION_0;
  final DisplayContent displayContent=mStack.getDisplayContent();
  if (displayContent != null) {
    displayContent.getLogicalDisplayRect(mTmpRect);
    rotation=displayContent.getDisplayInfo().rotation;
    if (bounds == null) {
      bounds=mTmpRect;
      mFullscreen=true;
    }
 else {
      if (mStack.mStackId != FREEFORM_WORKSPACE_STACK_ID || bounds.isEmpty()) {
        if (!bounds.intersect(mTmpRect)) {
          return BOUNDS_CHANGE_NONE;
        }
      }
      mFullscreen=mTmpRect.equals(bounds);
    }
  }
  if (bounds == null) {
    return BOUNDS_CHANGE_NONE;
  }
  if (mBounds.equals(bounds) && oldFullscreen == mFullscreen && mRotation == rotation) {
    return BOUNDS_CHANGE_NONE;
  }
  int boundsChange=BOUNDS_CHANGE_NONE;
  if (mBounds.left != bounds.left || mBounds.right != bounds.right) {
    boundsChange|=BOUNDS_CHANGE_POSITION;
  }
  if (mBounds.width() != bounds.width() || mBounds.height() != bounds.height()) {
    boundsChange|=BOUNDS_CHANGE_SIZE;
  }
  mBounds.set(bounds);
  mRotation=rotation;
  updateDimLayer();
  mOverrideConfig=mFullscreen ? Configuration.EMPTY : config;
  return boundsChange;
}
