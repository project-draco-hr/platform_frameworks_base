{
  boolean res=(enableNative() == 0);
  if (res) {
    int retryCount=2;
    boolean running=false;
    while ((retryCount-- > 0) && !running) {
      mEventLoop.start();
      int pollCount=5;
      while ((pollCount-- > 0) && !running) {
        if (mEventLoop.isEventLoopRunning()) {
          running=true;
          break;
        }
        try {
          Thread.sleep(100);
        }
 catch (        InterruptedException e) {
        }
      }
    }
    if (!running) {
      log("bt EnableThread giving up");
      res=false;
      disableNative();
    }
  }
  if (res) {
    if (!setupNativeDataNative()) {
      return;
    }
    if (mSaveSetting) {
      persistBluetoothOnSetting(true);
    }
    updateSdpRecords();
    mIsDiscovering=false;
    mBondState.readAutoPairingData();
    mBondState.loadBondState();
    initProfileState();
    long ident=Binder.clearCallingIdentity();
    try {
      mBatteryStats.noteBluetoothOn();
    }
 catch (    RemoteException e) {
    }
 finally {
      Binder.restoreCallingIdentity(ident);
    }
  }
 else {
    setBluetoothState(BluetoothAdapter.STATE_OFF);
  }
  mEnableThread=null;
}
