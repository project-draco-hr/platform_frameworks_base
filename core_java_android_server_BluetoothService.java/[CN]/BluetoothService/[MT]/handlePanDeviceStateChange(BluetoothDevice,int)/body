{
  int prevState;
  if (mPanDevices.get(device) == null) {
    prevState=BluetoothPan.STATE_DISCONNECTED;
  }
 else {
    prevState=mPanDevices.get(device);
  }
  if (prevState == state)   return;
  mPanDevices.put(device,state);
  if (state == BluetoothPan.STATE_CONNECTED) {
    updateTetherState(true);
  }
  Intent intent=new Intent(BluetoothPan.ACTION_PAN_STATE_CHANGED);
  intent.putExtra(BluetoothDevice.EXTRA_DEVICE,device);
  intent.putExtra(BluetoothPan.EXTRA_PREVIOUS_PAN_STATE,prevState);
  intent.putExtra(BluetoothPan.EXTRA_PAN_STATE,state);
  mContext.sendBroadcast(intent,BLUETOOTH_PERM);
  if (DBG)   log("Pan Device state : device: " + device + " State:"+ prevState+ "->"+ state);
}
