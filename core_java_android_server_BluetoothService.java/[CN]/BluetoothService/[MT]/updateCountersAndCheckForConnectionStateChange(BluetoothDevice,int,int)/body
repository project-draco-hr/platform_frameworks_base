{
switch (state) {
case BluetoothProfile.STATE_CONNECTING:
    mProfilesConnecting++;
  if (prevState == BluetoothAdapter.STATE_DISCONNECTING)   mProfilesDisconnecting--;
if (mProfilesConnected > 0 || mProfilesConnecting > 1) return false;
break;
case BluetoothProfile.STATE_CONNECTED:
if (prevState == BluetoothAdapter.STATE_CONNECTING) mProfilesConnecting--;
if (prevState == BluetoothAdapter.STATE_DISCONNECTING) mProfilesDisconnecting--;
mProfilesConnected++;
if (mProfilesConnected > 1) return false;
break;
case BluetoothProfile.STATE_DISCONNECTING:
mProfilesDisconnecting++;
mProfilesConnected--;
if (mProfilesConnected > 0 || mProfilesDisconnecting > 1) return false;
break;
case BluetoothProfile.STATE_DISCONNECTED:
if (prevState == BluetoothAdapter.STATE_CONNECTING) mProfilesConnecting--;
if (prevState == BluetoothAdapter.STATE_DISCONNECTING) mProfilesDisconnecting--;
if (prevState == BluetoothAdapter.STATE_CONNECTED) {
mProfilesConnected--;
}
if (mProfilesConnected > 0 || mProfilesConnecting > 0) return false;
break;
}
return true;
}
