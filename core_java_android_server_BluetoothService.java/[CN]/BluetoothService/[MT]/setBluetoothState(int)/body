{
  if (state == mBluetoothState) {
    return;
  }
  if (DBG)   Log.d(TAG,"Bluetooth state " + mBluetoothState + " -> "+ state);
  Intent intent=new Intent(BluetoothAdapter.ACTION_STATE_CHANGED);
  intent.putExtra(BluetoothAdapter.EXTRA_PREVIOUS_STATE,mBluetoothState);
  intent.putExtra(BluetoothAdapter.EXTRA_STATE,state);
  intent.addFlags(Intent.FLAG_RECEIVER_REGISTERED_ONLY_BEFORE_BOOT);
  mBluetoothState=state;
  mContext.sendBroadcast(intent,BLUETOOTH_PERM);
}
