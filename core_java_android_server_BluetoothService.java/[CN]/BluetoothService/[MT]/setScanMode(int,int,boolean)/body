{
  boolean pairable;
  boolean discoverable;
switch (mode) {
case BluetoothAdapter.SCAN_MODE_NONE:
    pairable=false;
  discoverable=false;
break;
case BluetoothAdapter.SCAN_MODE_CONNECTABLE:
pairable=true;
discoverable=false;
break;
case BluetoothAdapter.SCAN_MODE_CONNECTABLE_DISCOVERABLE:
pairable=true;
discoverable=true;
if (DBG) Log.d(TAG,"BT Discoverable for " + duration + " seconds");
break;
default :
Log.w(TAG,"Requested invalid scan mode " + mode);
return false;
}
if (allowOnlyInOnState) {
setPropertyBoolean("Discoverable",discoverable);
setPropertyBoolean("Pairable",pairable);
}
 else {
setAdapterPropertyBooleanNative("Discoverable",discoverable ? 1 : 0);
setAdapterPropertyBooleanNative("Pairable",pairable ? 1 : 0);
}
return true;
}
