{
  mContext=context;
  mBatteryStats=IBatteryStats.Stub.asInterface(ServiceManager.getService("batteryinfo"));
  initializeNativeDataNative();
  if (isEnabledNative() == 1) {
    Log.w(TAG,"Bluetooth daemons already running - runtime restart? ");
    disableNative();
  }
  mBluetoothState=BluetoothAdapter.STATE_OFF;
  mIsDiscovering=false;
  mAdapterProperties=new HashMap<String,String>();
  mDeviceProperties=new HashMap<String,Map<String,String>>();
  mDeviceServiceChannelCache=new HashMap<String,Map<ParcelUuid,Integer>>();
  mDeviceOobData=new HashMap<String,Pair<byte[],byte[]>>();
  mUuidIntentTracker=new ArrayList<String>();
  mUuidCallbackTracker=new HashMap<RemoteService,IBluetoothCallback>();
  mServiceRecordToPid=new HashMap<Integer,Integer>();
  mDeviceProfileState=new HashMap<String,BluetoothDeviceProfileState>();
  mA2dpProfileState=new BluetoothProfileState(mContext,BluetoothProfileState.A2DP);
  mHfpProfileState=new BluetoothProfileState(mContext,BluetoothProfileState.HFP);
  mHfpProfileState.start();
  mA2dpProfileState.start();
  IntentFilter filter=new IntentFilter();
  registerForAirplaneMode(filter);
  filter.addAction(Intent.ACTION_DOCK_EVENT);
  mContext.registerReceiver(mReceiver,filter);
  mIncomingConnections=new HashMap<String,Pair<Integer,String>>();
}
