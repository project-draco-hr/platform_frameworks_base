{
  rs.validate();
  if (type.getID() == 0) {
    throw new RSInvalidStateException("Bad Type");
  }
  int id=rs.nAllocationCreateTyped(type.getID());
  if (id == 0) {
    throw new RSRuntimeException("Allocation creation failed.");
  }
  return new Allocation(id,rs,type);
}
