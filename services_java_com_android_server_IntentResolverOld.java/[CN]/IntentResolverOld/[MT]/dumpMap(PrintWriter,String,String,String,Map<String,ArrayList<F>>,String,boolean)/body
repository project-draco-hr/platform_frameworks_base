{
  String eprefix=prefix + "  ";
  String fprefix=prefix + "    ";
  boolean printedSomething=false;
  Printer printer=null;
  for (  Map.Entry<String,ArrayList<F>> e : map.entrySet()) {
    ArrayList<F> a=e.getValue();
    final int N=a.size();
    boolean printedHeader=false;
    for (int i=0; i < N; i++) {
      F filter=a.get(i);
      if (packageName != null && !packageName.equals(packageForFilter(filter))) {
        continue;
      }
      if (title != null) {
        out.print(titlePrefix);
        out.println(title);
        title=null;
      }
      if (!printedHeader) {
        out.print(eprefix);
        out.print(e.getKey());
        out.println(":");
        printedHeader=true;
      }
      printedSomething=true;
      dumpFilter(out,fprefix,filter);
      if (printFilter) {
        if (printer == null) {
          printer=new PrintWriterPrinter(out);
        }
        filter.dump(printer,fprefix + "  ");
      }
    }
  }
  return printedSomething;
}
