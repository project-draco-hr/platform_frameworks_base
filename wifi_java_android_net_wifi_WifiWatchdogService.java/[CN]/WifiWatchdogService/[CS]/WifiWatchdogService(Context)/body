{
  mContext=context;
  mContentResolver=context.getContentResolver();
  mWifiManager=(WifiManager)context.getSystemService(Context.WIFI_SERVICE);
  mDnsPinger=new DnsPinger("WifiWatchdogServer.DnsPinger",context,ConnectivityManager.TYPE_WIFI);
  HandlerThread handlerThread=new HandlerThread("WifiWatchdogServiceThread");
  handlerThread.start();
  mHandler=new WifiWatchdogHandler(handlerThread.getLooper());
  setupNetworkReceiver();
  registerForSettingsChanges();
  if (isWatchdogEnabled()) {
    mHandler.sendEmptyMessage(WifiWatchdogHandler.MESSAGE_CONTEXT_EVENT);
  }
}
