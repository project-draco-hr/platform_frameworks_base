{
  if (typeSize < 0 || typeSize > 2) {
    throw new IllegalArgumentException("Invalid arguments - typeSize must be 0, 1, or 2: typeSize=" + typeSize);
  }
  if (lengthSize <= 0 || lengthSize > 2) {
    throw new IllegalArgumentException("Invalid arguments - lengthSize must be 1 or 2: lengthSize=" + lengthSize);
  }
  if (length < 0 || length > array.length) {
    throw new IllegalArgumentException("Invalid arguments - length must be non-negative and <= array.length: length=" + length + ", array.length="+ array.length);
  }
  int nextTlvIndex=0;
  while (nextTlvIndex + typeSize + lengthSize <= length) {
    nextTlvIndex+=typeSize;
    if (lengthSize == 1) {
      nextTlvIndex+=lengthSize + array[nextTlvIndex];
    }
 else {
      nextTlvIndex+=lengthSize + Memory.peekShort(array,nextTlvIndex,ByteOrder.BIG_ENDIAN);
    }
  }
  return nextTlvIndex == length;
}
