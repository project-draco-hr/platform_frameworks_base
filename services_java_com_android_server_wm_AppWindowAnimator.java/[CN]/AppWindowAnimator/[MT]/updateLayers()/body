{
  final int N=mAppToken.allAppWindows.size();
  final int adj=animLayerAdjustment;
  thumbnailLayer=-1;
  for (int i=0; i < N; i++) {
    final WindowState w=mAppToken.allAppWindows.get(i);
    final WindowStateAnimator winAnimator=w.mWinAnimator;
    winAnimator.mAnimLayer=w.mLayer + adj;
    if (winAnimator.mAnimLayer > thumbnailLayer) {
      thumbnailLayer=winAnimator.mAnimLayer;
    }
    if (WindowManagerService.DEBUG_LAYERS)     Slog.v(WindowManagerService.TAG,"Updating layer " + w + ": "+ winAnimator.mAnimLayer);
    if (w == mService.mInputMethodTarget && !mService.mInputMethodTargetWaitingAnim) {
      mService.setInputMethodAnimLayerAdjustment(adj);
    }
    if (w == mService.mWallpaperTarget && mService.mLowerWallpaperTarget == null) {
      mService.setWallpaperAnimLayerAdjustmentLocked(adj);
    }
  }
}
