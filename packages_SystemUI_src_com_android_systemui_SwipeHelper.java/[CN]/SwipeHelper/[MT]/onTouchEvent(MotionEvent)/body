{
  if (mLongPressSent) {
    return true;
  }
  if (!mDragging) {
    if (mCallback.getChildAtPosition(ev) != null) {
      onInterceptTouchEvent(ev);
      return true;
    }
 else {
      removeLongPressCallback();
      return false;
    }
  }
  mVelocityTracker.addMovement(ev);
  final int action=ev.getAction();
switch (action) {
case MotionEvent.ACTION_OUTSIDE:
case MotionEvent.ACTION_MOVE:
    if (mCurrView != null) {
      float delta=getPos(ev) - mInitialTouchPos;
      float absDelta=Math.abs(delta);
      if (absDelta >= getFalsingThreshold()) {
        mTouchAboveFalsingThreshold=true;
      }
      if (CONSTRAIN_SWIPE && !mCallback.canChildBeDismissed(mCurrView)) {
        float size=getSize(mCurrView);
        float maxScrollDistance=0.25f * size;
        if (absDelta >= size) {
          delta=delta > 0 ? maxScrollDistance : -maxScrollDistance;
        }
 else {
          delta=maxScrollDistance * (float)Math.sin((delta / size) * (Math.PI / 2));
        }
      }
      setTranslation(mCurrView,mTranslation + delta);
      updateSwipeProgressFromOffset(mCurrView,mCanCurrViewBeDimissed);
      onMoveUpdate(mCurrView,mTranslation + delta,delta);
    }
  break;
case MotionEvent.ACTION_UP:
case MotionEvent.ACTION_CANCEL:
if (mCurrView != null) {
  float maxVelocity=MAX_DISMISS_VELOCITY * mDensityScale;
  mVelocityTracker.computeCurrentVelocity(1000,maxVelocity);
  float escapeVelocity=SWIPE_ESCAPE_VELOCITY * mDensityScale;
  float velocity=getVelocity(mVelocityTracker);
  float perpendicularVelocity=getPerpendicularVelocity(mVelocityTracker);
  float translation=getTranslation(mCurrView);
  boolean childSwipedFarEnough=DISMISS_IF_SWIPED_FAR_ENOUGH && Math.abs(translation) > 0.4 * getSize(mCurrView);
  boolean childSwipedFastEnough=(Math.abs(velocity) > escapeVelocity) && (Math.abs(velocity) > Math.abs(perpendicularVelocity)) && (velocity > 0) == (translation > 0);
  boolean falsingDetected=mCallback.isAntiFalsingNeeded();
  if (mFalsingManager.isClassiferEnabled()) {
    falsingDetected=falsingDetected && mFalsingManager.isFalseTouch();
  }
 else {
    falsingDetected=falsingDetected && !mTouchAboveFalsingThreshold;
  }
  boolean dismissChild=mCallback.canChildBeDismissed(mCurrView) && !falsingDetected && (childSwipedFastEnough || childSwipedFarEnough)&& ev.getActionMasked() == MotionEvent.ACTION_UP;
  if (dismissChild) {
    dismissChild(mCurrView,childSwipedFastEnough ? velocity : 0f);
  }
 else {
    mCallback.onDragCancelled(mCurrView);
    snapChild(mCurrView,0,velocity);
  }
}
break;
}
return true;
}
