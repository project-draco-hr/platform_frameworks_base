{
  FirewallIntentResolver[] resolvers=new FirewallIntentResolver[3];
  for (int i=0; i < resolvers.length; i++) {
    resolvers[i]=new FirewallIntentResolver();
  }
  File[] files=rulesDir.listFiles();
  if (files != null) {
    for (int i=0; i < files.length; i++) {
      File file=files[i];
      if (file.getName().endsWith(".xml")) {
        readRules(file,resolvers);
      }
    }
  }
  Slog.i(TAG,"Read new rules (A:" + resolvers[TYPE_ACTIVITY].filterSet().size() + " B:"+ resolvers[TYPE_BROADCAST].filterSet().size()+ " S:"+ resolvers[TYPE_SERVICE].filterSet().size()+ ")");
synchronized (mAms.getAMSLock()) {
    mActivityResolver=resolvers[TYPE_ACTIVITY];
    mBroadcastResolver=resolvers[TYPE_BROADCAST];
    mServiceResolver=resolvers[TYPE_SERVICE];
  }
}
