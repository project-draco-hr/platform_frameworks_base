{
  int bin=DATA_CONNECTION_NONE;
  if (hasData) {
switch (dataType) {
case TelephonyManager.NETWORK_TYPE_EDGE:
      bin=DATA_CONNECTION_EDGE;
    break;
case TelephonyManager.NETWORK_TYPE_GPRS:
  bin=DATA_CONNECTION_GPRS;
break;
case TelephonyManager.NETWORK_TYPE_UMTS:
bin=DATA_CONNECTION_UMTS;
break;
default :
bin=DATA_CONNECTION_OTHER;
break;
}
}
if (DEBUG) Log.i(TAG,"Phone Data Connection -> " + dataType + " = "+ hasData);
if (mPhoneDataConnectionType != bin) {
mHistoryCur.states=(mHistoryCur.states & ~BatteryHistoryRecord.STATE_DATA_CONNECTION_MASK) | (bin << BatteryHistoryRecord.STATE_DATA_CONNECTION_SHIFT);
if (DEBUG_HISTORY) Slog.v(TAG,"Data connection " + bin + " to: "+ Integer.toHexString(mHistoryCur.states));
addHistoryRecord(SystemClock.elapsedRealtime());
if (mPhoneDataConnectionType >= 0) {
mPhoneDataConnectionsTimer[mPhoneDataConnectionType].stopRunningLocked(this);
}
mPhoneDataConnectionType=bin;
mPhoneDataConnectionsTimer[bin].startRunningLocked(this);
}
}
