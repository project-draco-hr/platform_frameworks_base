{
  if ((mFile == null) || (mBackupFile == null)) {
    Log.w("BatteryStats","writeLocked: no file associated with this instance");
    return;
  }
  if (mFile.exists()) {
    if (mBackupFile.exists()) {
      mBackupFile.delete();
    }
    mFile.renameTo(mBackupFile);
  }
  try {
    FileOutputStream stream=new FileOutputStream(mFile);
    Parcel out=Parcel.obtain();
    writeSummaryToParcel(out);
    stream.write(out.marshall());
    out.recycle();
    stream.flush();
    stream.close();
    mBackupFile.delete();
    mLastWriteTime=SystemClock.elapsedRealtime();
  }
 catch (  IOException e) {
    Log.e("BatteryStats","Error writing battery statistics",e);
  }
}
