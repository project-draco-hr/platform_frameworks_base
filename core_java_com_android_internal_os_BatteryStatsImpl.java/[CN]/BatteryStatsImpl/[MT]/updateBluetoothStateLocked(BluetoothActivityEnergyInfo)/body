{
  if (DEBUG_ENERGY) {
    Slog.d(TAG,"Updating bluetooth stats: " + info);
  }
  if (info != null && mOnBatteryInternal) {
    mHasBluetoothEnergyReporting=true;
    mBluetoothActivityCounters[CONTROLLER_RX_TIME].addCountLocked(info.getControllerRxTimeMillis());
    mBluetoothActivityCounters[CONTROLLER_TX_TIME].addCountLocked(info.getControllerTxTimeMillis());
    mBluetoothActivityCounters[CONTROLLER_IDLE_TIME].addCountLocked(info.getControllerIdleTimeMillis());
    final double opVolt=mPowerProfile.getAveragePower(PowerProfile.POWER_BLUETOOTH_CONTROLLER_OPERATING_VOLTAGE) / 1000.0;
    if (opVolt != 0) {
      mBluetoothActivityCounters[CONTROLLER_POWER_DRAIN].addCountLocked((long)(info.getControllerEnergyUsed() / opVolt));
    }
    final UidTraffic[] uidTraffic=info.getUidTraffic();
    final int numUids=uidTraffic != null ? uidTraffic.length : 0;
    for (int i=0; i < numUids; i++) {
      final UidTraffic traffic=uidTraffic[i];
      mNetworkByteActivityCounters[NETWORK_BT_RX_DATA].addCountLocked(traffic.getRxBytes());
      mNetworkByteActivityCounters[NETWORK_BT_TX_DATA].addCountLocked(traffic.getTxBytes());
      final Uid u=getUidStatsLocked(mapUid(traffic.getUid()));
      u.noteNetworkActivityLocked(NETWORK_BT_RX_DATA,traffic.getRxBytes(),0);
      u.noteNetworkActivityLocked(NETWORK_BT_TX_DATA,traffic.getTxBytes(),0);
    }
  }
}
