{
  if (mPowerSaveModeEnabled != enabled) {
    int stepState=enabled ? STEP_LEVEL_MODE_POWER_SAVE : 0;
    mModStepMode|=(mCurStepMode & STEP_LEVEL_MODE_POWER_SAVE) ^ stepState;
    mCurStepMode=(mCurStepMode & ~STEP_LEVEL_MODE_POWER_SAVE) | stepState;
    final long elapsedRealtime=mClocks.elapsedRealtime();
    final long uptime=mClocks.uptimeMillis();
    mPowerSaveModeEnabled=enabled;
    if (enabled) {
      mHistoryCur.states2|=HistoryItem.STATE2_POWER_SAVE_FLAG;
      if (DEBUG_HISTORY)       Slog.v(TAG,"Power save mode enabled to: " + Integer.toHexString(mHistoryCur.states2));
      mPowerSaveModeEnabledTimer.startRunningLocked(elapsedRealtime);
    }
 else {
      mHistoryCur.states2&=~HistoryItem.STATE2_POWER_SAVE_FLAG;
      if (DEBUG_HISTORY)       Slog.v(TAG,"Power save mode disabled to: " + Integer.toHexString(mHistoryCur.states2));
      mPowerSaveModeEnabledTimer.stopRunningLocked(elapsedRealtime);
    }
    addHistoryRecordLocked(elapsedRealtime,uptime);
  }
}
