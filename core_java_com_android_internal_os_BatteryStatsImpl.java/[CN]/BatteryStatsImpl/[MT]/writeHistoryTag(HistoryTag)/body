{
  Integer idxObj=mHistoryTagPool.get(tag);
  int idx;
  if (idxObj != null) {
    idx=idxObj;
  }
 else {
    idx=mNextHistoryTagIdx;
    HistoryTag key=new HistoryTag();
    key.setTo(tag);
    tag.poolIdx=idx;
    mHistoryTagPool.put(key,idx);
    mNextHistoryTagIdx++;
    mNumHistoryTagChars+=key.string.length() + 1;
  }
  return idx;
}
