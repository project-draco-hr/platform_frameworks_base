{
  if (mLowPowerModeEnabled != enabled) {
    int stepState=enabled ? STEP_LEVEL_MODE_POWER_SAVE : 0;
    mModStepMode|=(mCurStepMode & STEP_LEVEL_MODE_POWER_SAVE) ^ stepState;
    mCurStepMode=(mCurStepMode & ~STEP_LEVEL_MODE_POWER_SAVE) | stepState;
    final long elapsedRealtime=SystemClock.elapsedRealtime();
    final long uptime=SystemClock.uptimeMillis();
    mLowPowerModeEnabled=enabled;
    if (enabled) {
      mHistoryCur.states2|=HistoryItem.STATE2_LOW_POWER_FLAG;
      if (DEBUG_HISTORY)       Slog.v(TAG,"Low power mode enabled to: " + Integer.toHexString(mHistoryCur.states2));
      mLowPowerModeEnabledTimer.startRunningLocked(elapsedRealtime);
    }
 else {
      mHistoryCur.states2&=~HistoryItem.STATE2_LOW_POWER_FLAG;
      if (DEBUG_HISTORY)       Slog.v(TAG,"Low power mode disabled to: " + Integer.toHexString(mHistoryCur.states2));
      mLowPowerModeEnabledTimer.stopRunningLocked(elapsedRealtime);
    }
    addHistoryRecordLocked(elapsedRealtime,uptime);
  }
}
