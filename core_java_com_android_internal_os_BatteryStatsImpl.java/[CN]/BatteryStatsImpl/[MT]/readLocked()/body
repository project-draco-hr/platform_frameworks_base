{
  if (mFile == null) {
    Slog.w("BatteryStats","readLocked: no file associated with this instance");
    return;
  }
  mUidStats.clear();
  try {
    File file=mFile.chooseForRead();
    if (!file.exists()) {
      return;
    }
    FileInputStream stream=new FileInputStream(file);
    byte[] raw=readFully(stream);
    Parcel in=Parcel.obtain();
    in.unmarshall(raw,0,raw.length);
    in.setDataPosition(0);
    stream.close();
    readSummaryFromParcel(in);
  }
 catch (  Exception e) {
    Slog.e("BatteryStats","Error reading battery statistics",e);
  }
  if (mHistoryBuffer.dataPosition() > 0) {
    final long elapsedRealtime=SystemClock.elapsedRealtime();
    final long uptime=SystemClock.uptimeMillis();
    if (USE_OLD_HISTORY) {
      addHistoryRecordLocked(elapsedRealtime,uptime,HistoryItem.CMD_START);
    }
    addHistoryBufferLocked(elapsedRealtime,uptime,HistoryItem.CMD_START);
    mHistoryCur.currentTime=System.currentTimeMillis();
    addHistoryBufferLocked(elapsedRealtime,uptime,HistoryItem.CMD_CURRENT_TIME);
    mHistoryCur.currentTime=0;
  }
}
