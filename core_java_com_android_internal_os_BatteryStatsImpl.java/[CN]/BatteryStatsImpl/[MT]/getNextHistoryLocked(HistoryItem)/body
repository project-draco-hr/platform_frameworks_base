{
  final int pos=mHistoryBuffer.dataPosition();
  if (pos == 0) {
    out.clear();
  }
  boolean end=pos >= mHistoryBuffer.dataSize();
  if (end) {
    return false;
  }
  final long lastRealtime=out.time;
  final long lastWalltime=out.currentTime;
  readHistoryDelta(mHistoryBuffer,out);
  if (out.cmd != HistoryItem.CMD_CURRENT_TIME && lastWalltime != 0) {
    out.currentTime=lastWalltime + (out.time - lastRealtime);
  }
  return true;
}
