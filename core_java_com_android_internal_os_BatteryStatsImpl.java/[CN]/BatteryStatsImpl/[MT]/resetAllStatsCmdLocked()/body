{
  resetAllStatsLocked();
  final long mSecUptime=mClocks.uptimeMillis();
  long uptime=mSecUptime * 1000;
  long mSecRealtime=mClocks.elapsedRealtime();
  long realtime=mSecRealtime * 1000;
  mDischargeStartLevel=mHistoryCur.batteryLevel;
  pullPendingStateUpdatesLocked();
  addHistoryRecordLocked(mSecRealtime,mSecUptime);
  mDischargeCurrentLevel=mDischargeUnplugLevel=mDischargePlugLevel=mCurrentBatteryLevel=mHistoryCur.batteryLevel;
  mOnBatteryTimeBase.reset(uptime,realtime);
  mOnBatteryScreenOffTimeBase.reset(uptime,realtime);
  if ((mHistoryCur.states & HistoryItem.STATE_BATTERY_PLUGGED_FLAG) == 0) {
    if (mScreenState == Display.STATE_ON) {
      mDischargeScreenOnUnplugLevel=mHistoryCur.batteryLevel;
      mDischargeScreenOffUnplugLevel=0;
    }
 else {
      mDischargeScreenOnUnplugLevel=0;
      mDischargeScreenOffUnplugLevel=mHistoryCur.batteryLevel;
    }
    mDischargeAmountScreenOn=0;
    mDischargeAmountScreenOff=0;
  }
  initActiveHistoryEventsLocked(mSecRealtime,mSecUptime);
}
