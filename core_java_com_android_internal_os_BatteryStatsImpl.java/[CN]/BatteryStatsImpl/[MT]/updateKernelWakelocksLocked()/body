{
  final KernelWakelockStats wakelockStats=mKernelWakelockReader.readKernelWakelockStats(mTmpWakelockStats);
  if (wakelockStats == null) {
    Slog.w(TAG,"Couldn't get kernel wake lock stats");
    return;
  }
  for (  Map.Entry<String,KernelWakelockStats.Entry> ent : wakelockStats.entrySet()) {
    String name=ent.getKey();
    KernelWakelockStats.Entry kws=ent.getValue();
    SamplingTimer kwlt=mKernelWakelockStats.get(name);
    if (kwlt == null) {
      kwlt=new SamplingTimer(mClocks,mOnBatteryScreenOffTimeBase);
      mKernelWakelockStats.put(name,kwlt);
    }
    kwlt.update(kws.mTotalTime,kws.mCount);
    kwlt.setUpdateVersion(kws.mVersion);
  }
  int numWakelocksSetStale=0;
  for (  Map.Entry<String,SamplingTimer> ent : mKernelWakelockStats.entrySet()) {
    SamplingTimer st=ent.getValue();
    if (st.getUpdateVersion() != wakelockStats.kernelWakelockVersion) {
      st.endSample();
      numWakelocksSetStale++;
    }
  }
  if (wakelockStats.isEmpty()) {
    Slog.wtf(TAG,"All kernel wakelocks had time of zero");
  }
  if (numWakelocksSetStale == mKernelWakelockStats.size()) {
    Slog.wtf(TAG,"All kernel wakelocks were set stale. new version=" + wakelockStats.kernelWakelockVersion);
  }
}
