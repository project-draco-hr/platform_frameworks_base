{
  mOnBatteryTimeBase.setRunning(unplugged,uptime,realtime);
  boolean unpluggedScreenOff=unplugged && screenOff;
  if (unpluggedScreenOff != mOnBatteryScreenOffTimeBase.isRunning()) {
    updateKernelWakelocksLocked();
    if (DEBUG_ENERGY_CPU) {
      Slog.d(TAG,"Updating cpu time because screen is now " + (unpluggedScreenOff ? "off" : "on"));
    }
    updateCpuTimeLocked();
    mOnBatteryScreenOffTimeBase.setRunning(unpluggedScreenOff,uptime,realtime);
  }
}
