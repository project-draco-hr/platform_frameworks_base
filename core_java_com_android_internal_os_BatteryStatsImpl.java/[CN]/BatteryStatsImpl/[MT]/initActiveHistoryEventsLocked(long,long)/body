{
  for (int i=0; i < HistoryItem.EVENT_COUNT; i++) {
    if (!mRecordAllHistory && i == HistoryItem.EVENT_PROC) {
      continue;
    }
    HashMap<String,SparseIntArray> active=mActiveEvents.getStateForEvent(i);
    if (active == null) {
      continue;
    }
    for (    HashMap.Entry<String,SparseIntArray> ent : active.entrySet()) {
      SparseIntArray uids=ent.getValue();
      for (int j=0; j < uids.size(); j++) {
        addHistoryEventLocked(elapsedRealtimeMs,uptimeMs,i,ent.getKey(),uids.keyAt(j));
      }
    }
  }
}
