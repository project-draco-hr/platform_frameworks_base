{
  if (srccols == null) {
    initArrays();
  }
  byte buff[];
  if (outpixbuf == null || !(outpixbuf instanceof byte[])) {
    buff=new byte[destWidth];
    outpixbuf=buff;
  }
 else {
    buff=(byte[])outpixbuf;
  }
  int wa=(srcWidth - 1) >>> 1;
  int ha=(srcHeight - 1) >>> 1;
  int dstX=(x * destWidth + wa) / srcWidth;
  int dstY=(y * destHeight + ha) / srcHeight;
  int sx, sy, dx, dy;
  dy=dstY;
  while ((dy < destHeight) && ((sy=srcrows[dy]) < y + h)) {
    dx=dstX;
    int srcOff=off + (sy - y) * scansize;
    while ((dx < destWidth) && ((sx=srccols[dx]) < x + w)) {
      buff[dx]=pixels[srcOff + (sx - x)];
      dx++;
    }
    consumer.setPixels(dstX,dy,dx - dstX,1,model,buff,dstX,destWidth);
    dy++;
  }
}
