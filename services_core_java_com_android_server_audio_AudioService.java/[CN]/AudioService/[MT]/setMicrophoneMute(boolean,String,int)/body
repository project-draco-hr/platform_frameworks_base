{
  int uid=Binder.getCallingUid();
  if (uid == android.os.Process.SYSTEM_UID) {
    uid=UserHandle.getUid(userId,UserHandle.getAppId(uid));
  }
  if (!on && mAppOps.noteOp(AppOpsManager.OP_MUTE_MICROPHONE,uid,callingPackage) != AppOpsManager.MODE_ALLOWED) {
    return;
  }
  if (!checkAudioSettingsPermission("setMicrophoneMute()")) {
    return;
  }
  if (userId != UserHandle.getCallingUserId() && mContext.checkCallingOrSelfPermission(android.Manifest.permission.INTERACT_ACROSS_USERS_FULL) != PackageManager.PERMISSION_GRANTED) {
    return;
  }
  if (getCurrentUserId() == userId) {
    AudioSystem.muteMicrophone(on);
  }
  sendMsg(mAudioHandler,MSG_PERSIST_MICROPHONE_MUTE,SENDMSG_REPLACE,on ? 1 : 0,userId,null,PERSIST_DELAY);
}
