{
  if (DEBUG_VOL) {
    Log.d(TAG,String.format("Master mute %s, %d, user=%d",mute,flags,userId));
  }
  if (mUseFixedVolume) {
    return;
  }
  if (getCurrentUserId() == userId) {
    if (mute != AudioSystem.getMasterMute()) {
      setSystemAudioMute(mute);
      AudioSystem.setMasterMute(mute);
      sendMsg(mAudioHandler,MSG_PERSIST_MASTER_VOLUME_MUTE,SENDMSG_REPLACE,mute ? 1 : 0,userId,null,PERSIST_DELAY);
      sendMasterMuteUpdate(mute,flags);
      Intent intent=new Intent(AudioManager.MASTER_MUTE_CHANGED_ACTION);
      intent.putExtra(AudioManager.EXTRA_MASTER_VOLUME_MUTED,mute);
      sendBroadcastToAll(intent);
    }
  }
 else {
    sendMsg(mAudioHandler,MSG_PERSIST_MASTER_VOLUME_MUTE,SENDMSG_REPLACE,mute ? 1 : 0,userId,null,PERSIST_DELAY);
  }
}
