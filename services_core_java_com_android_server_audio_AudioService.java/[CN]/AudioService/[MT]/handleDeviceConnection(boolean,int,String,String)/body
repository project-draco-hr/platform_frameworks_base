{
  if (DEBUG_DEVICES) {
    Slog.i(TAG,"handleDeviceConnection(" + connect + " dev:"+ Integer.toHexString(device)+ " address:"+ address+ " name:"+ deviceName+ ")");
  }
synchronized (mConnectedDevices) {
    String deviceKey=makeDeviceListKey(device,address);
    if (DEBUG_DEVICES) {
      Slog.i(TAG,"deviceKey:" + deviceKey);
    }
    DeviceListSpec deviceSpec=mConnectedDevices.get(deviceKey);
    boolean isConnected=deviceSpec != null;
    if (DEBUG_DEVICES) {
      Slog.i(TAG,"deviceSpec:" + deviceSpec + " is(already)Connected:"+ isConnected);
    }
    if (connect && !isConnected) {
      AudioSystem.setDeviceConnectionState(device,AudioSystem.DEVICE_STATE_AVAILABLE,address,deviceName);
      mConnectedDevices.put(deviceKey,new DeviceListSpec(device,deviceName,address));
      return true;
    }
 else     if (!connect && isConnected) {
      AudioSystem.setDeviceConnectionState(device,AudioSystem.DEVICE_STATE_UNAVAILABLE,address,deviceName);
      mConnectedDevices.remove(deviceKey);
      return true;
    }
  }
  return false;
}
