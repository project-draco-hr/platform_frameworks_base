{
  if (DEBUG_VOL) {
    Log.d(TAG,"onSetA2dpSourceConnectionState btDevice=" + btDevice + " state="+ state);
  }
  if (btDevice == null) {
    return;
  }
  String address=btDevice.getAddress();
  if (!BluetoothAdapter.checkBluetoothAddress(address)) {
    address="";
  }
synchronized (mConnectedDevices) {
    boolean isConnected=(mConnectedDevices.containsKey(AudioSystem.DEVICE_IN_BLUETOOTH_A2DP) && mConnectedDevices.get(AudioSystem.DEVICE_IN_BLUETOOTH_A2DP).equals(address));
    if (isConnected && state != BluetoothProfile.STATE_CONNECTED) {
      makeA2dpSrcUnavailable(address);
    }
 else     if (!isConnected && state == BluetoothProfile.STATE_CONNECTED) {
      makeA2dpSrcAvailable(address);
    }
  }
}
