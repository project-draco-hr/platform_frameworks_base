{
  int delay=0;
  if ((state == 0) && ((device & mBecomingNoisyIntentDevices) != 0)) {
    int devices=0;
    for (    int dev : mConnectedDevices.keySet()) {
      if (((dev & AudioSystem.DEVICE_BIT_IN) == 0) && ((dev & mBecomingNoisyIntentDevices) != 0)) {
        devices|=dev;
      }
    }
    if (devices == device) {
      sendMsg(mAudioHandler,MSG_BROADCAST_AUDIO_BECOMING_NOISY,SENDMSG_REPLACE,0,0,null,0);
      delay=1000;
    }
  }
  if (mAudioHandler.hasMessages(MSG_SET_A2DP_SRC_CONNECTION_STATE) || mAudioHandler.hasMessages(MSG_SET_A2DP_SINK_CONNECTION_STATE) || mAudioHandler.hasMessages(MSG_SET_WIRED_DEVICE_CONNECTION_STATE)) {
synchronized (mLastDeviceConnectMsgTime) {
      long time=SystemClock.uptimeMillis();
      if (mLastDeviceConnectMsgTime > time) {
        delay=(int)(mLastDeviceConnectMsgTime - time) + 30;
      }
    }
  }
  return delay;
}
