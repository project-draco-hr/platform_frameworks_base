{
synchronized (VolumeStreamState.class) {
    int oldIndex=getIndex(device);
    index=getValidIndex(index);
synchronized (mCameraSoundForced) {
      if ((mStreamType == AudioSystem.STREAM_SYSTEM_ENFORCED) && mCameraSoundForced) {
        index=mIndexMax;
      }
    }
    mIndex.put(device,index);
    if (oldIndex != index) {
      boolean currentDevice=(device == getDeviceForStream(mStreamType));
      int numStreamTypes=AudioSystem.getNumStreamTypes();
      for (int streamType=numStreamTypes - 1; streamType >= 0; streamType--) {
        if (streamType != mStreamType && mStreamVolumeAlias[streamType] == mStreamType) {
          int scaledIndex=rescaleIndex(index,mStreamType,streamType);
          mStreamStates[streamType].setIndex(scaledIndex,device);
          if (currentDevice) {
            mStreamStates[streamType].setIndex(scaledIndex,getDeviceForStream(streamType));
          }
        }
      }
      return true;
    }
 else {
      return false;
    }
  }
}
