{
synchronized (VolumeStreamState.class) {
    int index;
    for (int i=0; i < mIndexMap.size(); i++) {
      final int device=mIndexMap.keyAt(i);
      if (device != AudioSystem.DEVICE_OUT_DEFAULT) {
        if (mIsMuted) {
          index=0;
        }
 else         if ((device & AudioSystem.DEVICE_OUT_ALL_A2DP) != 0 && mAvrcpAbsVolSupported) {
          index=getAbsoluteVolumeIndex((getIndex(device) + 5) / 10);
        }
 else         if ((device & mFullVolumeDevices) != 0) {
          index=(mIndexMax + 5) / 10;
        }
 else {
          index=(mIndexMap.valueAt(i) + 5) / 10;
        }
        AudioSystem.setStreamVolumeIndex(mStreamType,index,device);
      }
    }
    if (mIsMuted) {
      index=0;
    }
 else {
      index=(getIndex(AudioSystem.DEVICE_OUT_DEFAULT) + 5) / 10;
    }
    AudioSystem.setStreamVolumeIndex(mStreamType,index,AudioSystem.DEVICE_OUT_DEFAULT);
  }
}
