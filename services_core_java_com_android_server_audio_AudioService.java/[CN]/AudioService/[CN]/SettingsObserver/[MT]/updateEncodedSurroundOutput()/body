{
  int newSurroundMode=Settings.Global.getInt(mContentResolver,Settings.Global.ENCODED_SURROUND_OUTPUT,Settings.Global.ENCODED_SURROUND_OUTPUT_AUTO);
  if (mEncodedSurroundMode != newSurroundMode) {
    sendEncodedSurroundMode(newSurroundMode);
synchronized (mConnectedDevices) {
      String key=makeDeviceListKey(AudioSystem.DEVICE_OUT_HDMI,"");
      DeviceListSpec deviceSpec=mConnectedDevices.get(key);
      if (deviceSpec != null) {
        setWiredDeviceConnectionState(AudioSystem.DEVICE_OUT_HDMI,AudioSystem.DEVICE_STATE_UNAVAILABLE,"","","android");
        setWiredDeviceConnectionState(AudioSystem.DEVICE_OUT_HDMI,AudioSystem.DEVICE_STATE_AVAILABLE,"","","android");
      }
    }
    mEncodedSurroundMode=newSurroundMode;
  }
}
