{
  try {
    mPacketSock=Os.socket(AF_PACKET,SOCK_RAW,ETH_P_IP);
    PacketSocketAddress addr=new PacketSocketAddress((short)ETH_P_IP,mIface.getIndex());
    Os.bind(mPacketSock,addr);
    NetworkUtils.attachDhcpFilter(mPacketSock);
  }
 catch (  SocketException|ErrnoException e) {
    Log.e(TAG,"Error creating packet socket",e);
    return false;
  }
  try {
    mUdpSock=Os.socket(AF_INET,SOCK_DGRAM,IPPROTO_UDP);
    Os.setsockoptInt(mUdpSock,SOL_SOCKET,SO_REUSEADDR,1);
    Os.setsockoptIfreq(mUdpSock,SOL_SOCKET,SO_BINDTODEVICE,mIfaceName);
    Os.setsockoptInt(mUdpSock,SOL_SOCKET,SO_BROADCAST,1);
    Os.setsockoptInt(mUdpSock,SOL_SOCKET,SO_RCVBUF,0);
    Os.bind(mUdpSock,Inet4Address.ANY,DhcpPacket.DHCP_CLIENT);
    NetworkUtils.protectFromVpn(mUdpSock);
  }
 catch (  SocketException|ErrnoException e) {
    Log.e(TAG,"Error creating UDP socket",e);
    return false;
  }
  return true;
}
