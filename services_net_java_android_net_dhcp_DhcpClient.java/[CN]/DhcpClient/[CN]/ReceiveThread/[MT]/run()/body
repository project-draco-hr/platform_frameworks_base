{
  maybeLog("Receive thread started");
  while (!stopped) {
    try {
      int length=Os.read(mPacketSock,mPacket,0,mPacket.length);
      DhcpPacket packet=null;
      packet=DhcpPacket.decodeFullPacket(mPacket,length,DhcpPacket.ENCAP_L2);
      if (packet != null) {
        maybeLog("Received packet: " + packet);
        sendMessage(CMD_RECEIVED_PACKET,packet);
      }
 else       if (PACKET_DBG) {
        Log.d(TAG,"Can't parse packet" + HexDump.dumpHexString(mPacket,0,length));
      }
    }
 catch (    IOException|ErrnoException e) {
      if (!stopped) {
        Log.e(TAG,"Read error",e);
      }
    }
  }
  maybeLog("Receive thread stopped");
}
