{
  int retOffset=getWordIteratorWithText().getEnd(offset);
  if (retOffset == BreakIterator.DONE) {
    retOffset=offset;
  }
 else   if (includePunctuation) {
    retOffset=handlePunctuation(retOffset);
  }
  return retOffset;
}
