{
  if (extractedTextModeWillBeStarted()) {
    return;
  }
  final boolean hasSelection=mTextView.hasSelection();
  final SelectionModifierCursorController selectionController=getSelectionController();
  final InsertionPointCursorController insertionController=getInsertionController();
  if ((selectionController != null && selectionController.isCursorBeingModified()) || (insertionController != null && insertionController.isCursorBeingModified())) {
    return;
  }
  if (hasSelection) {
    if (mTextActionMode == null || selectionController == null || !selectionController.isActive()) {
      stopTextActionModeWithPreservingSelection();
      startSelectionActionMode();
    }
 else {
      mTextActionMode.invalidateContentRect();
    }
  }
 else {
    if (insertionController == null || !insertionController.isActive()) {
      stopTextActionMode();
    }
 else     if (mTextActionMode != null) {
      mTextActionMode.invalidateContentRect();
    }
  }
}
