{
  if (!canSelectText()) {
    return false;
  }
  if (hasPasswordTransformationMethod()) {
    return mTextView.selectAllText();
  }
  int inputType=mTextView.getInputType();
  int klass=inputType & InputType.TYPE_MASK_CLASS;
  int variation=inputType & InputType.TYPE_MASK_VARIATION;
  if (klass == InputType.TYPE_CLASS_NUMBER || klass == InputType.TYPE_CLASS_PHONE || klass == InputType.TYPE_CLASS_DATETIME || variation == InputType.TYPE_TEXT_VARIATION_URI || variation == InputType.TYPE_TEXT_VARIATION_EMAIL_ADDRESS || variation == InputType.TYPE_TEXT_VARIATION_WEB_EMAIL_ADDRESS || variation == InputType.TYPE_TEXT_VARIATION_FILTER) {
    return mTextView.selectAllText();
  }
  long lastTouchOffsets=getLastTouchOffsets();
  final int minOffset=TextUtils.unpackRangeStartFromLong(lastTouchOffsets);
  final int maxOffset=TextUtils.unpackRangeEndFromLong(lastTouchOffsets);
  if (minOffset < 0 || minOffset >= mTextView.getText().length())   return false;
  if (maxOffset < 0 || maxOffset >= mTextView.getText().length())   return false;
  int selectionStart, selectionEnd;
  URLSpan[] urlSpans=((Spanned)mTextView.getText()).getSpans(minOffset,maxOffset,URLSpan.class);
  if (urlSpans.length >= 1) {
    URLSpan urlSpan=urlSpans[0];
    selectionStart=((Spanned)mTextView.getText()).getSpanStart(urlSpan);
    selectionEnd=((Spanned)mTextView.getText()).getSpanEnd(urlSpan);
  }
 else {
    final WordIterator wordIterator=getWordIterator();
    wordIterator.setCharSequence(mTextView.getText(),minOffset,maxOffset);
    selectionStart=wordIterator.getBeginning(minOffset);
    selectionEnd=wordIterator.getEnd(maxOffset);
    if (selectionStart == BreakIterator.DONE || selectionEnd == BreakIterator.DONE || selectionStart == selectionEnd) {
      long range=getCharRange(minOffset);
      selectionStart=TextUtils.unpackRangeStartFromLong(range);
      selectionEnd=TextUtils.unpackRangeEndFromLong(range);
    }
  }
  Selection.setSelection((Spannable)mTextView.getText(),selectionStart,selectionEnd);
  return selectionEnd > selectionStart;
}
