{
  if (hasWindowFocus) {
    if (mBlink != null) {
      mBlink.uncancel();
      makeBlink();
    }
    final InputMethodManager imm=InputMethodManager.peekInstance();
    final boolean immFullScreen=(imm != null && imm.isFullscreenMode());
    if (mSelectionModifierCursorController != null && mTextView.hasSelection() && !immFullScreen) {
      mSelectionModifierCursorController.show();
    }
  }
 else {
    if (mBlink != null) {
      mBlink.cancel();
    }
    if (mInputContentType != null) {
      mInputContentType.enterDown=false;
    }
    hideCursorAndSpanControllers();
    if (mSelectionModifierCursorController != null) {
      mSelectionModifierCursorController.hide();
    }
    if (mSuggestionsPopupWindow != null) {
      mSuggestionsPopupWindow.onParentLostFocus();
    }
    ensureEndedBatchEdit();
  }
}
