{
  mTextView.onEndBatchEdit();
  mUndoInputFilter.endBatchEdit();
  if (ims.mContentChanged || ims.mSelectionModeChanged) {
    mTextView.updateAfterEdit();
    reportExtractedText();
  }
 else   if (ims.mCursorChanged) {
    mTextView.invalidateCursor();
  }
  sendUpdateSelection();
}
