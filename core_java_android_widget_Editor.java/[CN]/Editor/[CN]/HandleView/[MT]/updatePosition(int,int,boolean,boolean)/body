{
  positionAtCursorOffset(getCurrentCursorOffset(),parentScrolled);
  if (parentPositionChanged || mPositionHasChanged) {
    if (mIsDragging) {
      if (parentPositionX != mLastParentX || parentPositionY != mLastParentY) {
        mTouchToWindowOffsetX+=parentPositionX - mLastParentX;
        mTouchToWindowOffsetY+=parentPositionY - mLastParentY;
        mLastParentX=parentPositionX;
        mLastParentY=parentPositionY;
      }
      onHandleMoved();
    }
    if (isVisible()) {
      final int[] pts={mPositionX + mHotspotX + getHorizontalOffset(),mPositionY};
      mTextView.transformFromViewToWindowSpace(pts);
      pts[0]-=mHotspotX + getHorizontalOffset();
      if (isShowing()) {
        mContainer.update(pts[0],pts[1],-1,-1);
      }
 else {
        mContainer.showAtLocation(mTextView,Gravity.NO_GRAVITY,pts[0],pts[1]);
      }
    }
 else {
      if (isShowing()) {
        dismiss();
      }
    }
    mPositionHasChanged=false;
  }
}
