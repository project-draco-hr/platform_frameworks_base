{
  if (mDisplayFrozen || mOpeningApps.size() > 0 || mClosingApps.size() > 0) {
    return mLastWindowForcedOrientation;
  }
  final WindowList windows=getDefaultWindowListLocked();
  int pos=windows.size() - 1;
  while (pos >= 0) {
    WindowState win=windows.get(pos);
    pos--;
    if (win.mAppToken != null) {
      return (mLastWindowForcedOrientation=ActivityInfo.SCREEN_ORIENTATION_UNSPECIFIED);
    }
    if (!win.isVisibleLw() || !win.mPolicyVisibilityAfterAnim) {
      continue;
    }
    int req=win.mAttrs.screenOrientation;
    if ((req == ActivityInfo.SCREEN_ORIENTATION_UNSPECIFIED) || (req == ActivityInfo.SCREEN_ORIENTATION_BEHIND)) {
      continue;
    }
    if (DEBUG_ORIENTATION)     Slog.v(TAG,win + " forcing orientation to " + req);
    return (mLastWindowForcedOrientation=req);
  }
  return (mLastWindowForcedOrientation=ActivityInfo.SCREEN_ORIENTATION_UNSPECIFIED);
}
