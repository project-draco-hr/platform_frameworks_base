{
  long ident=Binder.clearCallingIdentity();
  try {
    int req=getOrientationFromWindowsLocked();
    if (req == ActivityInfo.SCREEN_ORIENTATION_UNSPECIFIED) {
      req=getOrientationFromAppTokensLocked();
    }
    if (req != mForcedAppOrientation) {
      mForcedAppOrientation=req;
      mPolicy.setCurrentOrientationLw(req);
      if (updateRotationUncheckedLocked(inTransaction)) {
        return true;
      }
    }
    return false;
  }
  finally {
    Binder.restoreCallingIdentity(ident);
  }
}
