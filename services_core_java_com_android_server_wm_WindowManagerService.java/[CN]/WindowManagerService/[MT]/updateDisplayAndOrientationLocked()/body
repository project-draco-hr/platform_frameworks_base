{
  if (!mDisplayReady) {
    return null;
  }
  final DisplayContent displayContent=getDefaultDisplayContentLocked();
  final boolean rotated=(mRotation == Surface.ROTATION_90 || mRotation == Surface.ROTATION_270);
  final int realdw=rotated ? displayContent.mBaseDisplayHeight : displayContent.mBaseDisplayWidth;
  final int realdh=rotated ? displayContent.mBaseDisplayWidth : displayContent.mBaseDisplayHeight;
  int dw=realdw;
  int dh=realdh;
  if (mAltOrientation) {
    if (realdw > realdh) {
      int maxw=(int)(realdh / 1.3f);
      if (maxw < realdw) {
        dw=maxw;
      }
    }
 else {
      int maxh=(int)(realdw / 1.3f);
      if (maxh < realdh) {
        dh=maxh;
      }
    }
  }
  final int appWidth=mPolicy.getNonDecorDisplayWidth(dw,dh,mRotation);
  final int appHeight=mPolicy.getNonDecorDisplayHeight(dw,dh,mRotation);
  final DisplayInfo displayInfo=displayContent.getDisplayInfo();
synchronized (displayContent.mDisplaySizeLock) {
    displayInfo.rotation=mRotation;
    displayInfo.logicalWidth=dw;
    displayInfo.logicalHeight=dh;
    displayInfo.logicalDensityDpi=displayContent.mBaseDisplayDensity;
    displayInfo.appWidth=appWidth;
    displayInfo.appHeight=appHeight;
    displayInfo.getLogicalMetrics(mRealDisplayMetrics,CompatibilityInfo.DEFAULT_COMPATIBILITY_INFO,null);
    displayInfo.getAppMetrics(mDisplayMetrics);
    mDisplayManagerInternal.setDisplayInfoOverrideFromWindowManager(displayContent.getDisplayId(),displayInfo);
    displayContent.mBaseDisplayRect.set(0,0,dw,dh);
  }
  if (false) {
    Slog.i(TAG,"Set app display size: " + appWidth + " x "+ appHeight);
  }
  mCompatibleScreenScale=CompatibilityInfo.computeCompatibleScaling(mDisplayMetrics,mCompatDisplayMetrics);
  return displayInfo;
}
