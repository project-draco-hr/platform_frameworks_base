{
  final DisplayContent displayContent=changingTarget.getDisplayContent();
  if (displayContent == null) {
    return;
  }
  final DisplayInfo displayInfo=displayContent.getDisplayInfo();
  final int dw=displayInfo.logicalWidth;
  final int dh=displayInfo.logicalHeight;
  WindowState target=mWallpaperTarget;
  if (target != null) {
    if (target.mWallpaperX >= 0) {
      mLastWallpaperX=target.mWallpaperX;
    }
 else     if (changingTarget.mWallpaperX >= 0) {
      mLastWallpaperX=changingTarget.mWallpaperX;
    }
    if (target.mWallpaperY >= 0) {
      mLastWallpaperY=target.mWallpaperY;
    }
 else     if (changingTarget.mWallpaperY >= 0) {
      mLastWallpaperY=changingTarget.mWallpaperY;
    }
    if (target.mWallpaperDisplayOffsetX != Integer.MIN_VALUE) {
      mLastWallpaperDisplayOffsetX=target.mWallpaperDisplayOffsetX;
    }
 else     if (changingTarget.mWallpaperDisplayOffsetX != Integer.MIN_VALUE) {
      mLastWallpaperDisplayOffsetX=changingTarget.mWallpaperDisplayOffsetX;
    }
    if (target.mWallpaperDisplayOffsetY != Integer.MIN_VALUE) {
      mLastWallpaperDisplayOffsetY=target.mWallpaperDisplayOffsetY;
    }
 else     if (changingTarget.mWallpaperDisplayOffsetY != Integer.MIN_VALUE) {
      mLastWallpaperDisplayOffsetY=changingTarget.mWallpaperDisplayOffsetY;
    }
  }
  int curTokenIndex=mWallpaperTokens.size();
  while (curTokenIndex > 0) {
    curTokenIndex--;
    WindowToken token=mWallpaperTokens.get(curTokenIndex);
    int curWallpaperIndex=token.windows.size();
    while (curWallpaperIndex > 0) {
      curWallpaperIndex--;
      WindowState wallpaper=token.windows.get(curWallpaperIndex);
      if (updateWallpaperOffsetLocked(wallpaper,dw,dh,sync)) {
        WindowStateAnimator winAnimator=wallpaper.mWinAnimator;
        winAnimator.computeShownFrameLocked();
        winAnimator.setWallpaperOffset(wallpaper.mShownFrame);
        sync=false;
      }
    }
  }
}
