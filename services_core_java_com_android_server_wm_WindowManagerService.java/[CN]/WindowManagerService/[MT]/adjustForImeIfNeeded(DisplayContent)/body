{
  final WindowState imeWin=mInputMethodWindow;
  final TaskStack focusedStack=mCurrentFocus != null ? mCurrentFocus.getStack() : null;
  if (imeWin != null && imeWin.isVisibleLw() && imeWin.isDisplayedLw() && isStackVisibleLocked(DOCKED_STACK_ID) && focusedStack != null && focusedStack.getDockSide() == DOCKED_BOTTOM) {
    final ArrayList<TaskStack> stacks=displayContent.getStacks();
    for (int i=stacks.size() - 1; i >= 0; --i) {
      final TaskStack stack=stacks.get(i);
      if (stack.isVisibleLocked()) {
        stack.setAdjustedForIme(imeWin);
      }
    }
  }
 else {
    final ArrayList<TaskStack> stacks=displayContent.getStacks();
    for (int i=stacks.size() - 1; i >= 0; --i) {
      final TaskStack stack=stacks.get(i);
      stack.resetAdjustedForIme();
    }
  }
}
