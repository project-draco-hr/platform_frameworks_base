{
  int unrotDw, unrotDh;
  if (rotated) {
    unrotDw=dh;
    unrotDh=dw;
  }
 else {
    unrotDw=dw;
    unrotDh=dh;
  }
  displayInfo.smallestNominalAppWidth=1 << 30;
  displayInfo.smallestNominalAppHeight=1 << 30;
  displayInfo.largestNominalAppWidth=0;
  displayInfo.largestNominalAppHeight=0;
  adjustDisplaySizeRanges(displayInfo,Surface.ROTATION_0,uiMode,unrotDw,unrotDh);
  adjustDisplaySizeRanges(displayInfo,Surface.ROTATION_90,uiMode,unrotDh,unrotDw);
  adjustDisplaySizeRanges(displayInfo,Surface.ROTATION_180,uiMode,unrotDw,unrotDh);
  adjustDisplaySizeRanges(displayInfo,Surface.ROTATION_270,uiMode,unrotDh,unrotDw);
  int sl=Configuration.resetScreenLayout(outConfig.screenLayout);
  sl=reduceConfigLayout(sl,Surface.ROTATION_0,density,unrotDw,unrotDh,uiMode);
  sl=reduceConfigLayout(sl,Surface.ROTATION_90,density,unrotDh,unrotDw,uiMode);
  sl=reduceConfigLayout(sl,Surface.ROTATION_180,density,unrotDw,unrotDh,uiMode);
  sl=reduceConfigLayout(sl,Surface.ROTATION_270,density,unrotDh,unrotDw,uiMode);
  outConfig.smallestScreenWidthDp=(int)(displayInfo.smallestNominalAppWidth / density);
  outConfig.screenLayout=sl;
}
