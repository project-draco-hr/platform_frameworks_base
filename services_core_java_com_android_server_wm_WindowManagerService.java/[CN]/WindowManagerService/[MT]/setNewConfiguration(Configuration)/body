{
  if (!checkCallingPermission(android.Manifest.permission.MANAGE_APP_TOKENS,"setNewConfiguration()")) {
    throw new SecurityException("Requires MANAGE_APP_TOKENS permission");
  }
synchronized (mWindowMap) {
    final boolean orientationChanged=mCurConfiguration.orientation != config.orientation;
    mCurConfiguration=new Configuration(config);
    if (mWaitingForConfig) {
      mWaitingForConfig=false;
      mLastFinishedFreezeSource="new-config";
    }
    mWindowPlacerLocked.performSurfacePlacement();
  }
}
