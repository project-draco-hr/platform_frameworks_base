{
  if (!checkCallingPermission(android.Manifest.permission.MANAGE_APP_TOKENS,"setNewConfiguration()")) {
    throw new SecurityException("Requires MANAGE_APP_TOKENS permission");
  }
synchronized (mWindowMap) {
    if (mWaitingForConfig) {
      mWaitingForConfig=false;
      mLastFinishedFreezeSource="new-config";
    }
    boolean configChanged=mCurConfiguration.diff(config) != 0;
    if (!configChanged) {
      return null;
    }
    prepareFreezingAllTaskBounds();
    mCurConfiguration=new Configuration(config);
    return onConfigurationChanged();
  }
}
