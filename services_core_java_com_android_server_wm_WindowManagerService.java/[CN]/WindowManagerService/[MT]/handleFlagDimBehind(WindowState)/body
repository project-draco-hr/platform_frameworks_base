{
  final WindowManager.LayoutParams attrs=w.mAttrs;
  if ((attrs.flags & FLAG_DIM_BEHIND) != 0 && w.isDisplayedLw() && !w.mExiting) {
    final WindowStateAnimator winAnimator=w.mWinAnimator;
    final TaskStack stack=w.getStack();
    if (stack == null) {
      return;
    }
    stack.setDimmingTag();
    if (!stack.isDimming(winAnimator)) {
      if (localLOGV)       Slog.v(TAG,"Win " + w + " start dimming.");
      stack.startDimmingIfNeeded(winAnimator);
    }
  }
}
