{
  final WindowManager.LayoutParams attrs=w.mAttrs;
  final int attrFlags=attrs.flags;
  final boolean canBeSeen=w.isDisplayedLw();
  final boolean opaqueDrawn=canBeSeen && w.isOpaqueDrawn();
  if (opaqueDrawn && w.isFullscreen(innerDw,innerDh)) {
    mInnerFields.mObscured=true;
  }
  if (w.mHasSurface) {
    if ((attrFlags & FLAG_KEEP_SCREEN_ON) != 0) {
      mInnerFields.mHoldScreen=w.mSession;
    }
    if (!mInnerFields.mSyswin && w.mAttrs.screenBrightness >= 0 && mInnerFields.mScreenBrightness < 0) {
      mInnerFields.mScreenBrightness=w.mAttrs.screenBrightness;
    }
    if (!mInnerFields.mSyswin && w.mAttrs.buttonBrightness >= 0 && mInnerFields.mButtonBrightness < 0) {
      mInnerFields.mButtonBrightness=w.mAttrs.buttonBrightness;
    }
    if (!mInnerFields.mSyswin && w.mAttrs.userActivityTimeout >= 0 && mInnerFields.mUserActivityTimeout < 0) {
      mInnerFields.mUserActivityTimeout=w.mAttrs.userActivityTimeout;
    }
    final int type=attrs.type;
    if (canBeSeen && (type == TYPE_SYSTEM_DIALOG || type == TYPE_RECENTS_OVERLAY || type == TYPE_SYSTEM_ERROR || (attrs.privateFlags & PRIVATE_FLAG_KEYGUARD) != 0)) {
      mInnerFields.mSyswin=true;
    }
    if (canBeSeen) {
      final DisplayContent displayContent=w.getDisplayContent();
      if (displayContent != null && displayContent.isDefaultDisplay) {
        if (type == TYPE_DREAM || (attrs.privateFlags & PRIVATE_FLAG_KEYGUARD) != 0) {
          mInnerFields.mObscureApplicationContentOnSecondaryDisplays=true;
        }
        mInnerFields.mDisplayHasContent=true;
      }
 else       if (displayContent != null && (!mInnerFields.mObscureApplicationContentOnSecondaryDisplays || (mInnerFields.mObscured && type == TYPE_KEYGUARD_DIALOG))) {
        mInnerFields.mDisplayHasContent=true;
      }
    }
  }
}
