{
  if (chain.isEmpty()) {
    return false;
  }
  X509Certificate anchorCert=chain.get(chain.size() - 1);
  TrustAnchor chainAnchor=null;
  for (  TrustAnchor anchor : mNetworkSecurityConfig.getTrustAnchors()) {
    if (anchor.certificate.equals(anchorCert)) {
      chainAnchor=anchor;
      break;
    }
  }
  if (chainAnchor == null) {
    throw new CertificateException("Trusted chain does not end in a TrustAnchor");
  }
  return !chainAnchor.overridesPins;
}
