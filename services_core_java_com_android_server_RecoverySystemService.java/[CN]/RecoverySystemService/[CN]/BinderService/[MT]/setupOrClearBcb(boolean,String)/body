{
  mContext.enforceCallingOrSelfPermission(android.Manifest.permission.RECOVERY,null);
  if (isSetup) {
    SystemProperties.set("ctl.start","setup-bcb");
  }
 else {
    SystemProperties.set("ctl.start","clear-bcb");
  }
  LocalSocket socket=connectService();
  if (socket == null) {
    Slog.e(TAG,"Failed to connect to uncrypt socket");
    return false;
  }
  try (DataInputStream dis=new DataInputStream(socket.getInputStream());DataOutputStream dos=new DataOutputStream(socket.getOutputStream())){
    if (isSetup) {
      dos.writeInt(command.length());
      dos.writeBytes(command);
      dos.flush();
    }
    int status=dis.readInt();
    dos.writeInt(0);
    dos.flush();
    if (status == 100) {
      Slog.i(TAG,"uncrypt " + (isSetup ? "setup" : "clear") + " bcb successfully finished.");
    }
 else {
      Slog.e(TAG,"uncrypt failed with status: " + status);
      return false;
    }
  }
 catch (  IOException e) {
    Slog.e(TAG,"IOException when getting output stream: " + e);
    return false;
  }
 finally {
    IoUtils.closeQuietly(socket);
  }
  return true;
}
