{
  if (!task.mResizeable) {
    Slog.w(TAG,"resizeTask: task " + task + " not resizeable.");
    return;
  }
  if (task.mBounds != null && task.mBounds.equals(bounds)) {
    return;
  }
  if (!mWindowManager.isValidTaskId(task.taskId)) {
    task.mBounds=task.mLastNonFullscreenBounds=new Rect(bounds);
    if (task.stack != null && task.stack.mStackId != FREEFORM_WORKSPACE_STACK_ID) {
      restoreRecentTaskLocked(task,FREEFORM_WORKSPACE_STACK_ID);
    }
    return;
  }
  int stackId=task.stack.mStackId;
  final boolean wasFrontStack=isFrontStack(task.stack);
  if (bounds == null && stackId != FULLSCREEN_WORKSPACE_STACK_ID) {
    stackId=FULLSCREEN_WORKSPACE_STACK_ID;
  }
 else   if (bounds != null && stackId != FREEFORM_WORKSPACE_STACK_ID && stackId != DOCKED_STACK_ID) {
    stackId=FREEFORM_WORKSPACE_STACK_ID;
  }
  if (stackId != task.stack.mStackId) {
    final String reason="resizeTask";
    final ActivityStack stack=moveTaskToStackUncheckedLocked(task,stackId,ON_TOP,reason);
    if (wasFrontStack) {
      stack.moveToFront(reason);
    }
  }
  final Configuration overrideConfig=mWindowManager.resizeTask(task.taskId,bounds);
  if (task.updateOverrideConfiguration(overrideConfig,bounds)) {
    ActivityRecord r=task.topRunningActivityLocked(null);
    if (r != null) {
      final ActivityStack stack=task.stack;
      final boolean updated=stack.ensureActivityConfigurationLocked(r,0);
      ensureActivitiesVisibleLocked(r,0);
      if (!updated) {
        resumeTopActivitiesLocked(stack,null,null);
      }
    }
  }
}
