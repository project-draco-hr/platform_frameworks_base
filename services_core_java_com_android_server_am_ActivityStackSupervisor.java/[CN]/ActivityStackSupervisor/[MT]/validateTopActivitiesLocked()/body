{
  for (int displayNdx=mActivityDisplays.size() - 1; displayNdx >= 0; --displayNdx) {
    final ArrayList<ActivityStack> stacks=mActivityDisplays.valueAt(displayNdx).mStacks;
    for (int stackNdx=stacks.size() - 1; stackNdx >= 0; --stackNdx) {
      final ActivityStack stack=stacks.get(stackNdx);
      final ActivityRecord r=stack.topRunningActivityLocked();
      final ActivityState state=r == null ? DESTROYED : r.state;
      if (isFrontStack(stack)) {
        if (r == null)         Slog.e(TAG,"validateTop...: null top activity, stack=" + stack);
 else {
          final ActivityRecord pausing=stack.mPausingActivity;
          if (pausing != null && pausing == r)           Slog.e(TAG,"validateTop...: top stack has pausing activity r=" + r + " state="+ state);
          if (state != INITIALIZING && state != RESUMED)           Slog.e(TAG,"validateTop...: activity in front not resumed r=" + r + " state="+ state);
        }
      }
 else {
        final ActivityRecord resumed=stack.mResumedActivity;
        if (resumed != null && resumed == r)         Slog.e(TAG,"validateTop...: back stack has resumed activity r=" + r + " state="+ state);
        if (r != null && (state == INITIALIZING || state == RESUMED))         Slog.e(TAG,"validateTop...: activity in back resumed r=" + r + " state="+ state);
      }
    }
  }
}
