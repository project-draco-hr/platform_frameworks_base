{
  scheduleSleepTimeout();
  if (!mGoingToSleep.isHeld()) {
    mGoingToSleep.acquire();
    if (mLaunchingActivity.isHeld()) {
      if (VALIDATE_WAKE_LOCK_CALLER && Binder.getCallingUid() != Process.myUid()) {
        throw new IllegalStateException("Calling must be system uid");
      }
      mLaunchingActivity.release();
      mService.mHandler.removeMessages(LAUNCH_TIMEOUT_MSG);
    }
  }
  checkReadyForSleepLocked();
}
