{
  if (!focusCandidate.isFocusable()) {
    focusCandidate=focusCandidate.getNextFocusableStackLocked();
  }
  if (focusCandidate != mFocusedStack) {
    mLastFocusedStack=mFocusedStack;
    mFocusedStack=focusCandidate;
    EventLogTags.writeAmFocusedStack(mCurrentUser,mFocusedStack == null ? -1 : mFocusedStack.getStackId(),mLastFocusedStack == null ? -1 : mLastFocusedStack.getStackId(),reason);
  }
  final ActivityRecord r=topRunningActivityLocked();
  if (mService.mFocusedActivity != r) {
    mService.setFocusedActivityLocked(r,reason + " setFocusStack");
  }
  if (mService.mBooting || !mService.mBooted) {
    if (r != null && r.idle) {
      checkFinishBootingLocked();
    }
  }
}
