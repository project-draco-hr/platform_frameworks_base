{
  if ((flags & ActivityManager.MOVE_TASK_NO_USER_ACTION) == 0) {
    mUserLeaving=true;
  }
  if ((flags & ActivityManager.MOVE_TASK_WITH_HOME) != 0) {
    task.setTaskToReturnTo(HOME_ACTIVITY_TYPE);
  }
  if (task.stack == null) {
    Slog.e(TAG,"findTaskToMoveToFrontLocked: can't move task=" + task + " to front. Stack is null");
    return;
  }
  task.stack.moveTaskToFrontLocked(task,false,options,task.getTopActivity() == null ? null : task.getTopActivity().appTimeTracker,reason);
  if (DEBUG_STACK)   Slog.d(TAG_STACK,"findTaskToMoveToFront: moved to front of stack=" + task.stack);
}
