{
  if (stackId == DOCKED_STACK_ID) {
    resizeDockedStackLocked(bounds,tempTaskBounds,tempTaskInsetBounds,null,null,preserveWindows);
    return;
  }
  final ActivityStack stack=getStack(stackId);
  if (stack == null) {
    Slog.w(TAG,"resizeStack: stackId " + stackId + " not found.");
    return;
  }
  if (!allowResizeInDockedMode && getStack(DOCKED_STACK_ID) != null) {
    return;
  }
  Trace.traceBegin(TRACE_TAG_ACTIVITY_MANAGER,"am.resizeStack_" + stackId);
  mWindowManager.deferSurfaceLayout();
  try {
    resizeStackUncheckedLocked(stack,bounds,tempTaskBounds,tempTaskInsetBounds);
    if (!deferResume) {
      stack.ensureVisibleActivitiesConfigurationLocked(stack.topRunningActivityLocked(),preserveWindows);
    }
  }
  finally {
    mWindowManager.continueSurfaceLayout();
    Trace.traceEnd(TRACE_TAG_ACTIVITY_MANAGER);
  }
}
