{
  bounds=TaskRecord.validateBounds(bounds);
  if (!stack.updateBoundsAllowed(bounds,tempTaskBounds,tempTaskInsetBounds)) {
    return;
  }
  mTmpBounds.clear();
  mTmpConfigs.clear();
  mTmpInsetBounds.clear();
  final ArrayList<TaskRecord> tasks=stack.getAllTasks();
  final Rect taskBounds=tempTaskBounds != null ? tempTaskBounds : bounds;
  final Rect insetBounds=tempTaskInsetBounds != null ? tempTaskInsetBounds : taskBounds;
  for (int i=tasks.size() - 1; i >= 0; i--) {
    final TaskRecord task=tasks.get(i);
    if (task.isResizeable()) {
      if (stack.mStackId == FREEFORM_WORKSPACE_STACK_ID) {
        tempRect2.set(task.mBounds);
        fitWithinBounds(tempRect2,bounds);
        task.updateOverrideConfiguration(tempRect2);
      }
 else {
        task.updateOverrideConfiguration(taskBounds,insetBounds);
      }
    }
    mTmpConfigs.put(task.taskId,task.mOverrideConfig);
    mTmpBounds.put(task.taskId,task.mBounds);
    if (tempTaskInsetBounds != null) {
      mTmpInsetBounds.put(task.taskId,tempTaskInsetBounds);
    }
  }
  mWindowManager.prepareFreezingTaskBounds(stack.mStackId);
  stack.mFullscreen=mWindowManager.resizeStack(stack.mStackId,bounds,mTmpConfigs,mTmpBounds,mTmpInsetBounds);
  stack.setBounds(bounds);
}
