{
  if (bounds != null && mWindowManager.isFullscreenBounds(stack.mStackId,bounds)) {
    bounds=null;
  }
  mTmpBounds.clear();
  mTmpConfigs.clear();
  mTmpInsetBounds.clear();
  ArrayList<TaskRecord> tasks=stack.getAllTasks();
  for (int i=tasks.size() - 1; i >= 0; i--) {
    TaskRecord task=tasks.get(i);
    if (task.mResizeable) {
      if (stack.mStackId == FREEFORM_WORKSPACE_STACK_ID) {
        tempRect2.set(task.mBounds);
        fitWithinBounds(tempRect2,bounds);
        task.updateOverrideConfiguration(tempRect2);
      }
 else {
        task.updateOverrideConfiguration(tempTaskBounds != null ? tempTaskBounds : bounds);
      }
    }
    mTmpConfigs.put(task.taskId,task.mOverrideConfig);
    mTmpBounds.put(task.taskId,task.mBounds);
    if (tempTaskInsetBounds != null) {
      mTmpInsetBounds.put(task.taskId,tempTaskInsetBounds);
    }
  }
  mWindowManager.prepareFreezingTaskBounds(stack.mStackId);
  stack.mFullscreen=mWindowManager.resizeStack(stack.mStackId,bounds,mTmpConfigs,mTmpBounds,mTmpInsetBounds);
  stack.setBounds(bounds);
}
