{
  final ActivityStack stack=getStack(stackId);
  if (stack == null) {
    Slog.w(TAG,"resizeStack: stackId " + stackId + " not found.");
    return;
  }
  final ActivityRecord r=stack.topRunningActivityLocked(null);
  if (r != null && !r.task.mResizeable) {
    Slog.w(TAG,"resizeStack: top task " + r.task + " not resizeable.");
    return;
  }
  final IntArray changedTaskIds=new IntArray(stack.numTasks());
  final List<Configuration> newTaskConfigs=new ArrayList<>(stack.numTasks());
  stack.mFullscreen=mWindowManager.resizeStack(stackId,bounds,changedTaskIds,newTaskConfigs);
  for (int i=changedTaskIds.size() - 1; i >= 0; i--) {
    final TaskRecord task=anyTaskForIdLocked(changedTaskIds.get(i),false);
    if (task == null) {
      Slog.wtf(TAG,"Task in WindowManager, but not in ActivityManager???");
      continue;
    }
    task.updateOverrideConfiguration(newTaskConfigs.get(i));
  }
  if (r != null) {
    final boolean updated=stack.ensureActivityConfigurationLocked(r,0);
    ensureActivitiesVisibleLocked(r,0);
    if (!updated) {
      resumeTopActivitiesLocked(stack,null,null);
    }
  }
}
