{
  if (activityInfo.permission == null) {
    return ACTIVITY_RESTRICTION_NONE;
  }
  if (mService.checkComponentPermission(activityInfo.permission,callingPid,callingUid,activityInfo.applicationInfo.uid,activityInfo.exported) == PackageManager.PERMISSION_DENIED) {
    return ACTIVITY_RESTRICTION_PERMISSION;
  }
  final int opCode=AppOpsManager.permissionToOpCode(activityInfo.permission);
  if (opCode == AppOpsManager.OP_NONE) {
    return ACTIVITY_RESTRICTION_NONE;
  }
  if (mService.mAppOpsService.noteOperation(opCode,callingUid,callingPackage) != AppOpsManager.MODE_ALLOWED) {
    return ACTIVITY_RESTRICTION_APPOP;
  }
  return ACTIVITY_RESTRICTION_NONE;
}
