{
  if (task == null) {
    if (mLockTaskModeTask != null) {
      final Message lockTaskMsg=Message.obtain();
      lockTaskMsg.arg1=mLockTaskModeTask.userId;
      lockTaskMsg.what=LOCK_TASK_END_MSG;
      mLockTaskModeTask=null;
      mHandler.sendMessage(lockTaskMsg);
    }
    return;
  }
  if (isLockTaskModeViolation(task)) {
    Slog.e(TAG,"setLockTaskMode: Attempt to start a second Lock Task Mode task.");
    return;
  }
  mLockTaskModeTask=task;
  findTaskToMoveToFrontLocked(task,0,null,reason);
  resumeTopActivitiesLocked();
  final Message lockTaskMsg=Message.obtain();
  lockTaskMsg.obj=mLockTaskModeTask.intent.getComponent().getPackageName();
  lockTaskMsg.arg1=mLockTaskModeTask.userId;
  lockTaskMsg.what=LOCK_TASK_START_MSG;
  lockTaskMsg.arg2=lockTaskModeState;
  mHandler.sendMessage(lockTaskMsg);
}
