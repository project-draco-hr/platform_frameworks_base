{
  final ActivityStack stack=task.stack;
  if (prevStack == null || prevStack == stack || (prevStack.mStackId != PINNED_STACK_ID && stack.mStackId != PINNED_STACK_ID)) {
    return;
  }
  for (int i=task.mActivities.size() - 1; i >= 0; i--) {
    final ActivityRecord r=task.mActivities.get(i);
    if (r.app != null && r.app.thread != null) {
      mPipModeChangedActivities.add(r);
    }
  }
  if (!mHandler.hasMessages(REPORT_PIP_MODE_CHANGED_MSG)) {
    mHandler.sendEmptyMessage(REPORT_PIP_MODE_CHANGED_MSG);
  }
}
