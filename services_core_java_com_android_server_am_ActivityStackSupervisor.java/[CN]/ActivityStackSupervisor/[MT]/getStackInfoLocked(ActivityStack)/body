{
  StackInfo info=new StackInfo();
  mWindowManager.getStackBounds(stack.mStackId,info.bounds);
  info.displayId=Display.DEFAULT_DISPLAY;
  info.stackId=stack.mStackId;
  info.userId=stack.mCurrentUser;
  info.visible=stack.getStackVisibilityLocked(null) == STACK_VISIBLE;
  ArrayList<TaskRecord> tasks=stack.getAllTasks();
  final int numTasks=tasks.size();
  int[] taskIds=new int[numTasks];
  String[] taskNames=new String[numTasks];
  Rect[] taskBounds=new Rect[numTasks];
  int[] taskUserIds=new int[numTasks];
  for (int i=0; i < numTasks; ++i) {
    final TaskRecord task=tasks.get(i);
    taskIds[i]=task.taskId;
    taskNames[i]=task.origActivity != null ? task.origActivity.flattenToString() : task.realActivity != null ? task.realActivity.flattenToString() : task.getTopActivity() != null ? task.getTopActivity().packageName : "unknown";
    taskBounds[i]=new Rect();
    mWindowManager.getTaskBounds(task.taskId,taskBounds[i]);
    taskUserIds[i]=task.userId;
  }
  info.taskIds=taskIds;
  info.taskNames=taskNames;
  info.taskBounds=taskBounds;
  info.taskUserIds=taskUserIds;
  final ActivityRecord top=stack.topRunningActivityLocked();
  info.topActivity=top != null ? top.intent.getComponent() : null;
  return info;
}
