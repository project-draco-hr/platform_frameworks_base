{
  final TaskRecord task=anyTaskForIdLocked(taskId);
  if (task == null) {
    Slog.w(TAG,"moveTaskToStack: no task for id=" + taskId);
    return;
  }
  final String reason="moveTaskToStack";
  final ActivityRecord top=task.topRunningActivityLocked(null);
  final boolean adjustFocus=forceFocus || mService.mFocusedActivity == top;
  final ActivityStack stack=moveTaskToStackUncheckedLocked(task,stackId,toTop,reason);
  if (stackId == FULLSCREEN_WORKSPACE_STACK_ID && task.mBounds != null) {
    resizeTaskLocked(task,stack.mBounds);
  }
 else   if (stackId == FREEFORM_WORKSPACE_STACK_ID && task.mBounds == null && task.mLastNonFullscreenBounds != null) {
    resizeTaskLocked(task,task.mLastNonFullscreenBounds);
  }
 else   if (stackId == DOCKED_STACK_ID) {
    resizeTaskLocked(task,stack.mBounds);
  }
  if (top != null && adjustFocus) {
    if (mService.mFocusedActivity != top) {
      mService.setFocusedActivityLocked(top,reason);
    }
 else {
      setFocusedStack(top,reason);
    }
  }
  ensureActivitiesVisibleLocked(null,0);
  resumeTopActivitiesLocked();
}
