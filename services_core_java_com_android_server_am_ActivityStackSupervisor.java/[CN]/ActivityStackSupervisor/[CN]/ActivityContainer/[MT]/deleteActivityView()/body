{
synchronized (mService) {
    if (!isAttached()) {
      return;
    }
    VirtualDisplay virtualDisplay=mActivityDisplay.mVirtualDisplay;
    if (virtualDisplay != null) {
      virtualDisplay.release();
      mActivityDisplay.mVirtualDisplay=null;
    }
    detachLocked();
  }
}
