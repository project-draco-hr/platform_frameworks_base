{
  mDatabase.getMapper().startAddingDocuments(null);
  mDatabase.getMapper().putDeviceDocument(new MtpDeviceRecord(0,"Device",true,new MtpRoot[0]));
  mDatabase.getMapper().stopAddingDocuments(null);
  mDatabase.getMapper().startAddingDocuments("1");
  mDatabase.getMapper().putStorageDocuments("1",resources,new MtpRoot[]{new MtpRoot(0,100,"Device","Storage A",0,0,"")});
  mDatabase.getMapper().clearMapping();
  final Cursor oldCursor=mDatabase.queryRoots(strings(Root.COLUMN_ROOT_ID));
  assertEquals(1,oldCursor.getCount());
  mDatabase.getMapper().startAddingDocuments("1");
  mDatabase.getMapper().putStorageDocuments("1",resources,new MtpRoot[]{new MtpRoot(0,101,"Device","Storage B",1000,1000,"")});
  mDatabase.getMapper().putStorageDocuments("1",resources,new MtpRoot[]{new MtpRoot(0,102,"Device","Storage B",1000,1000,"")});
  mDatabase.getMapper().stopAddingDocuments("1");
  final Cursor newCursor=mDatabase.queryChildDocuments(strings(Document.COLUMN_DOCUMENT_ID),"1");
  assertEquals(2,newCursor.getCount());
  oldCursor.moveToNext();
  newCursor.moveToNext();
  assertFalse(oldCursor.getString(0).equals(newCursor.getString(0)));
  newCursor.moveToNext();
  assertFalse(oldCursor.getString(0).equals(newCursor.getString(0)));
  oldCursor.close();
  newCursor.close();
}
