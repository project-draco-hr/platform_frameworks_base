{
  final MtpDatabase database=new MtpDatabase(getContext());
  final String[] columns=new String[]{DocumentsContract.Document.COLUMN_DOCUMENT_ID,MtpDatabaseConstants.COLUMN_OBJECT_HANDLE,DocumentsContract.Document.COLUMN_DISPLAY_NAME};
  database.startAddingChildDocuments("parentId");
  database.putChildDocuments(0,"parentId",new MtpObjectInfo[]{createDocument(100,"note.txt",MtpConstants.FORMAT_TEXT,1024),createDocument(101,"image.jpg",MtpConstants.FORMAT_EXIF_JPEG,2 * 1024 * 1024),createDocument(102,"music.mp3",MtpConstants.FORMAT_MP3,3 * 1024 * 1024)});
  database.clearMapping();
{
    final Cursor cursor=database.queryChildDocuments(columns,"parentId");
    assertEquals(3,cursor.getCount());
    cursor.moveToNext();
    assertEquals("documentId",1,cursor.getInt(0));
    assertTrue("objectHandle",cursor.isNull(1));
    assertEquals("name","note.txt",cursor.getString(2));
    cursor.moveToNext();
    assertEquals("documentId",2,cursor.getInt(0));
    assertTrue("objectHandle",cursor.isNull(1));
    assertEquals("name","image.jpg",cursor.getString(2));
    cursor.moveToNext();
    assertEquals("documentId",3,cursor.getInt(0));
    assertTrue("objectHandle",cursor.isNull(1));
    assertEquals("name","music.mp3",cursor.getString(2));
    cursor.close();
  }
  database.startAddingChildDocuments("parentId");
  database.putChildDocuments(0,"parentId",new MtpObjectInfo[]{createDocument(200,"note.txt",MtpConstants.FORMAT_TEXT,1024),createDocument(203,"video.mp4",MtpConstants.FORMAT_MP4_CONTAINER,1024)});
{
    final Cursor cursor=database.queryChildDocuments(columns,"parentId");
    assertEquals(4,cursor.getCount());
    cursor.moveToPosition(3);
    assertEquals("documentId",5,cursor.getInt(0));
    assertEquals("objectHandle",203,cursor.getInt(1));
    assertEquals("name","video.mp4",cursor.getString(2));
    cursor.close();
  }
  database.stopAddingChildDocuments("parentId");
{
    final Cursor cursor=database.queryChildDocuments(columns,"parentId");
    assertEquals(2,cursor.getCount());
    cursor.moveToNext();
    assertEquals("documentId",1,cursor.getInt(0));
    assertEquals("objectHandle",200,cursor.getInt(1));
    assertEquals("name","note.txt",cursor.getString(2));
    cursor.moveToNext();
    assertEquals("documentId",5,cursor.getInt(0));
    assertEquals("objectHandle",203,cursor.getInt(1));
    assertEquals("name","video.mp4",cursor.getString(2));
    cursor.close();
  }
}
