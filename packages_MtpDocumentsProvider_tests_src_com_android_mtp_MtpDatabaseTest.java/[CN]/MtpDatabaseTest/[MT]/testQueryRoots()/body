{
  mDatabase.getMapper().startAddingDocuments(null);
  mDatabase.getMapper().putDeviceDocument(new MtpDeviceRecord(0,"Device",false,new MtpRoot[0],new int[0]));
  mDatabase.getMapper().stopAddingDocuments(null);
{
    final Cursor cursor=mDatabase.queryRoots(strings(Root.COLUMN_TITLE));
    assertEquals(1,cursor.getCount());
    cursor.moveToNext();
    assertEquals("Device",cursor.getString(0));
    cursor.close();
  }
  mDatabase.getMapper().startAddingDocuments("1");
  mDatabase.getMapper().putStorageDocuments("1",resources,new MtpRoot[]{new MtpRoot(0,100,"Device","Storage A",0,0,"")});
  mDatabase.getMapper().stopAddingDocuments("1");
{
    final Cursor cursor=mDatabase.queryRoots(strings(Root.COLUMN_TITLE));
    assertEquals(1,cursor.getCount());
    cursor.moveToNext();
    assertEquals("Device Storage A",cursor.getString(0));
    cursor.close();
  }
  mDatabase.getMapper().startAddingDocuments("1");
  mDatabase.getMapper().putStorageDocuments("1",resources,new MtpRoot[]{new MtpRoot(0,100,"Device","Storage A",0,0,""),new MtpRoot(0,101,"Device","Storage B",0,0,"")});
  mDatabase.getMapper().stopAddingDocuments("1");
{
    final Cursor cursor=mDatabase.queryRoots(strings(Root.COLUMN_TITLE));
    assertEquals(1,cursor.getCount());
    cursor.moveToNext();
    assertEquals("Device",cursor.getString(0));
    cursor.close();
  }
}
