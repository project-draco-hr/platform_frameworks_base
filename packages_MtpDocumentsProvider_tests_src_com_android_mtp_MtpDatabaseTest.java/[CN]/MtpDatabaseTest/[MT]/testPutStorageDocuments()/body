{
  addTestDevice();
  mDatabase.getMapper().startAddingDocuments("1");
  mDatabase.getMapper().putStorageDocuments("1",new MtpRoot[]{new MtpRoot(0,1,"Storage",1000,2000,""),new MtpRoot(0,2,"Storage",2000,4000,""),new MtpRoot(0,3,"/@#%&<>Storage",3000,6000,"")});
{
    final Cursor cursor=mDatabase.queryRootDocuments(COLUMN_NAMES);
    assertEquals(3,cursor.getCount());
    cursor.moveToNext();
    assertEquals(2,getInt(cursor,COLUMN_DOCUMENT_ID));
    assertEquals(0,getInt(cursor,COLUMN_DEVICE_ID));
    assertEquals(1,getInt(cursor,COLUMN_STORAGE_ID));
    assertTrue(isNull(cursor,COLUMN_OBJECT_HANDLE));
    assertEquals(DocumentsContract.Document.MIME_TYPE_DIR,getString(cursor,COLUMN_MIME_TYPE));
    assertEquals("Storage",getString(cursor,COLUMN_DISPLAY_NAME));
    assertTrue(isNull(cursor,COLUMN_SUMMARY));
    assertTrue(isNull(cursor,COLUMN_LAST_MODIFIED));
    assertEquals(R.drawable.ic_root_mtp,getInt(cursor,COLUMN_ICON));
    assertEquals(0,getInt(cursor,COLUMN_FLAGS));
    assertEquals(1000,getInt(cursor,COLUMN_SIZE));
    assertEquals(MtpDatabaseConstants.DOCUMENT_TYPE_STORAGE,getInt(cursor,COLUMN_DOCUMENT_TYPE));
    cursor.moveToNext();
    assertEquals(3,getInt(cursor,COLUMN_DOCUMENT_ID));
    assertEquals("Storage",getString(cursor,COLUMN_DISPLAY_NAME));
    cursor.moveToNext();
    assertEquals(4,getInt(cursor,COLUMN_DOCUMENT_ID));
    assertEquals("/@#%&<>Storage",getString(cursor,COLUMN_DISPLAY_NAME));
    cursor.close();
  }
}
