{
  enforceCallingPermission(android.Manifest.permission.GET_TOP_ACTIVITY_INFO,"enqueueAssistContext()");
synchronized (this) {
    ActivityRecord activity=getFocusedStack().topActivity();
    if (activity == null) {
      Slog.w(TAG,"getAssistContextExtras failed: no top activity");
      return null;
    }
    if (activity.app == null || activity.app.thread == null) {
      Slog.w(TAG,"getAssistContextExtras failed: no process for " + activity);
      return null;
    }
    if (activity.app.pid == Binder.getCallingPid()) {
      Slog.w(TAG,"getAssistContextExtras failed: request process same as " + activity);
      return null;
    }
    PendingAssistExtras pae;
    Bundle extras=new Bundle();
    if (args != null) {
      extras.putAll(args);
    }
    extras.putString(Intent.EXTRA_ASSIST_PACKAGE,activity.packageName);
    extras.putInt(Intent.EXTRA_ASSIST_UID,activity.app.uid);
    pae=new PendingAssistExtras(activity,extras,intent,hint,receiver,userHandle);
    try {
      activity.app.thread.requestAssistContextExtras(activity.appToken,pae,requestType);
      mPendingAssistExtras.add(pae);
      mHandler.postDelayed(pae,timeout);
    }
 catch (    RemoteException e) {
      Slog.w(TAG,"getAssistContextExtras failed: crash calling " + activity);
      return null;
    }
    return pae;
  }
}
