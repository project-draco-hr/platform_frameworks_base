{
  if (mFocusedActivity == r) {
    ActivityStack stack=mStackSupervisor.getFocusedStack();
    if (stack != null) {
      ActivityRecord top=stack.topActivity();
      if (top != null && top.userId != mLastFocusedUserId) {
        mHandler.removeMessages(FOREGROUND_PROFILE_CHANGED_MSG);
        mHandler.sendMessage(mHandler.obtainMessage(FOREGROUND_PROFILE_CHANGED_MSG,top.userId,0));
        mLastFocusedUserId=top.userId;
      }
    }
    mFocusedActivity=null;
    EventLog.writeEvent(EventLogTags.AM_FOCUSED_ACTIVITY,-1,"NULL");
  }
}
