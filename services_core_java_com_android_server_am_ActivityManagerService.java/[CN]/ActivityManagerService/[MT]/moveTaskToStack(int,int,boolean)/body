{
  enforceCallingPermission(MANAGE_ACTIVITY_STACKS,"moveTaskToStack()");
  if (stackId == HOME_STACK_ID) {
    throw new IllegalArgumentException("moveTaskToStack: Attempt to move task " + taskId + " to home stack");
  }
synchronized (this) {
    long ident=Binder.clearCallingIdentity();
    try {
      if (DEBUG_STACK)       Slog.d(TAG_STACK,"moveTaskToStack: moving task=" + taskId + " to stackId="+ stackId+ " toTop="+ toTop);
      if (stackId == DOCKED_STACK_ID) {
        mWindowManager.setDockedStackCreateState(DOCKED_STACK_CREATE_MODE_TOP_OR_LEFT,null);
      }
      boolean result=mStackSupervisor.moveTaskToStackLocked(taskId,stackId,toTop,!FORCE_FOCUS,"moveTaskToStack",ANIMATE);
      if (result && stackId == DOCKED_STACK_ID) {
        mStackSupervisor.moveHomeStackTaskToTop(RECENTS_ACTIVITY_TYPE,"moveTaskToDockedStack");
      }
    }
  finally {
      Binder.restoreCallingIdentity(ident);
    }
  }
}
