{
  if (permission == null) {
    return PackageManager.PERMISSION_DENIED;
  }
  Identity tlsIdentity=sCallerIdentity.get();
  if (tlsIdentity != null && tlsIdentity.token == callerToken) {
    Slog.d(TAG,"checkComponentPermission() adjusting {pid,uid} to {" + tlsIdentity.pid + ","+ tlsIdentity.uid+ "}");
    uid=tlsIdentity.uid;
    pid=tlsIdentity.pid;
  }
  return checkComponentPermission(permission,pid,uid,-1,true);
}
