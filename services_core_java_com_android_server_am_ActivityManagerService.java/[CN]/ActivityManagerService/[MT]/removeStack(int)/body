{
  enforceCallingPermission(android.Manifest.permission.MANAGE_ACTIVITY_STACKS,"detahStack()");
  if (stackId == HOME_STACK_ID) {
    throw new IllegalArgumentException("Removing home stack is not allowed.");
  }
synchronized (this) {
    long origId=Binder.clearCallingIdentity();
    ActivityStack stack=mStackSupervisor.getStack(stackId);
    if (stack != null) {
      ArrayList<TaskRecord> tasks=stack.getAllTasks();
      for (int i=tasks.size() - 1; i >= 0; i--) {
        removeTaskByIdLocked(tasks.get(i).taskId,false,!REMOVE_FROM_RECENTS);
      }
    }
    Binder.restoreCallingIdentity(origId);
  }
}
