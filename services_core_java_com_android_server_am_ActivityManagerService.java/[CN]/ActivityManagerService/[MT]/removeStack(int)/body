{
  enforceCallingPermission(Manifest.permission.MANAGE_ACTIVITY_STACKS,"removeStack()");
  if (stackId == HOME_STACK_ID) {
    throw new IllegalArgumentException("Removing home stack is not allowed.");
  }
synchronized (this) {
    final long ident=Binder.clearCallingIdentity();
    try {
      final ActivityStack stack=mStackSupervisor.getStack(stackId);
      if (stack == null) {
        return;
      }
      final ArrayList<TaskRecord> tasks=stack.getAllTasks();
      for (int i=tasks.size() - 1; i >= 0; i--) {
        removeTaskByIdLocked(tasks.get(i).taskId,true,REMOVE_FROM_RECENTS);
      }
    }
  finally {
      Binder.restoreCallingIdentity(ident);
    }
  }
}
