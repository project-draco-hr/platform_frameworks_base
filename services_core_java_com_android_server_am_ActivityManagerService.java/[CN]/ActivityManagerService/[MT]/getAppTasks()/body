{
  final PackageManager pm=mContext.getPackageManager();
  int callingUid=Binder.getCallingUid();
  long ident=Binder.clearCallingIdentity();
  HashSet<String> packages=new HashSet<String>();
  String[] uidPackages=pm.getPackagesForUid(callingUid);
  for (int i=0; i < uidPackages.length; i++) {
    packages.add(uidPackages[i]);
  }
synchronized (this) {
    ArrayList<IAppTask> list=new ArrayList<IAppTask>();
    try {
      if (localLOGV)       Slog.v(TAG,"getAppTasks");
      final int N=mRecentTasks.size();
      for (int i=0; i < N; i++) {
        TaskRecord tr=mRecentTasks.get(i);
        if (packages.contains(tr.getBaseIntent().getComponent().getPackageName())) {
          ActivityManager.RecentTaskInfo taskInfo=createRecentTaskInfoFromTaskRecord(tr);
          AppTaskImpl taskImpl=new AppTaskImpl(taskInfo.persistentId,callingUid);
          list.add(taskImpl);
        }
      }
    }
  finally {
      Binder.restoreCallingIdentity(ident);
    }
    return list;
  }
}
