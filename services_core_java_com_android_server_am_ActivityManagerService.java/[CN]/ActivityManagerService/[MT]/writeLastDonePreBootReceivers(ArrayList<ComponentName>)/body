{
  File file=getCalledPreBootReceiversFile();
  FileOutputStream fos=null;
  DataOutputStream dos=null;
  try {
    Slog.i(TAG,"Writing new set of last done pre-boot receivers...");
    fos=new FileOutputStream(file);
    dos=new DataOutputStream(new BufferedOutputStream(fos,2048));
    dos.writeInt(LAST_DONE_VERSION);
    dos.writeUTF(android.os.Build.VERSION.RELEASE);
    dos.writeUTF(android.os.Build.VERSION.CODENAME);
    dos.writeUTF(android.os.Build.VERSION.INCREMENTAL);
    dos.writeInt(list.size());
    for (int i=0; i < list.size(); i++) {
      dos.writeUTF(list.get(i).getPackageName());
      dos.writeUTF(list.get(i).getClassName());
    }
  }
 catch (  IOException e) {
    Slog.w(TAG,"Failure writing last done pre-boot receivers",e);
    file.delete();
  }
 finally {
    FileUtils.sync(fos);
    if (dos != null) {
      try {
        dos.close();
      }
 catch (      IOException e) {
        e.printStackTrace();
      }
    }
  }
}
