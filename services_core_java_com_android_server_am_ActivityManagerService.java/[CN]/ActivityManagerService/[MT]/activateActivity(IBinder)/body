{
  if (DEBUG_FOCUS)   Slog.d(TAG_FOCUS,"ActivateActivity token=" + token);
  long callingId=Binder.clearCallingIdentity();
  try {
synchronized (ActivityManagerService.this) {
      final ActivityRecord anyTaskRecord=ActivityRecord.isInStackLocked(token);
      if (anyTaskRecord == null) {
        Slog.w(TAG,"ActivateActivity: token=" + token + " not found");
        return;
      }
      TaskRecord task=anyTaskRecord.task;
      final boolean runsOnFreeformStack=task.stack.getStackId() == FREEFORM_WORKSPACE_STACK_ID;
      if (!runsOnFreeformStack) {
        Slog.w(TAG,"Tried to use activateActivity on a non freeform workspace!");
      }
 else       if (task != null) {
        ActivityRecord topTaskRecord=task.topRunningActivityLocked(null);
        if (topTaskRecord != null) {
          setFocusedActivityLocked(topTaskRecord,"activateActivity");
          mStackSupervisor.resumeTopActivitiesLocked(task.stack,null,null);
        }
      }
    }
  }
  finally {
    Binder.restoreCallingIdentity(callingId);
  }
}
