{
  if (!Intent.isAccessUriMode(modeFlags)) {
    return;
  }
  if (DEBUG_URI_PERMISSION)   Slog.v(TAG,"Granting " + targetPkg + "/"+ targetUid+ " permission to "+ uri);
  final String authority=uri.getAuthority();
  final ProviderInfo pi=getProviderInfoLocked(authority,UserHandle.getUserId(targetUid));
  if (pi == null) {
    Slog.w(TAG,"No content provider found for grant: " + uri.toSafeString());
    return;
  }
  final boolean prefix=(modeFlags & Intent.FLAG_GRANT_PREFIX_URI_PERMISSION) != 0;
  final UriPermission perm=findOrCreateUriPermissionLocked(pi.packageName,targetPkg,targetUid,new GrantUri(uri,prefix));
  perm.grantModes(modeFlags,owner);
}
