{
  if (mFocusedActivity != r) {
    if (DEBUG_FOCUS)     Slog.d(TAG,"setFocusedActivityLocked: r=" + r);
    mFocusedActivity=r;
    if (r.task != null && r.task.voiceInteractor != null) {
      startRunningVoiceLocked();
    }
 else {
      finishRunningVoiceLocked();
    }
    mStackSupervisor.setFocusedStack(r);
    if (r != null) {
      mWindowManager.setFocusedApp(r.appToken,true);
    }
    applyUpdateLockStateLocked(r);
  }
}
