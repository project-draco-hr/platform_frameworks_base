{
  enforceNotIsolatedCaller("revokeUriPermission");
synchronized (this) {
    final ProcessRecord r=getRecordForAppLocked(caller);
    if (r == null) {
      throw new SecurityException("Unable to find app for caller " + caller + " when revoking permission to uri "+ uri);
    }
    if (uri == null) {
      Slog.w(TAG,"revokeUriPermission: null uri");
      return;
    }
    modeFlags&=(Intent.FLAG_GRANT_READ_URI_PERMISSION | Intent.FLAG_GRANT_WRITE_URI_PERMISSION);
    if (modeFlags == 0) {
      return;
    }
    final IPackageManager pm=AppGlobals.getPackageManager();
    final String authority=uri.getAuthority();
    final ProviderInfo pi=getProviderInfoLocked(authority,r.userId);
    if (pi == null) {
      Slog.w(TAG,"No content provider found for permission revoke: " + uri.toSafeString());
      return;
    }
    revokeUriPermissionLocked(r.uid,uri,modeFlags);
  }
}
