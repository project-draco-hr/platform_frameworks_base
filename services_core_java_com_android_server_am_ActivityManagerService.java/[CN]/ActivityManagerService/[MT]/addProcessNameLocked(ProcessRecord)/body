{
  ProcessRecord old=removeProcessNameLocked(proc.processName,proc.uid);
  if (old == proc && proc.persistent) {
    Slog.w(TAG,"Re-adding persistent process " + proc);
  }
 else   if (old != null) {
    Slog.wtf(TAG,"Already have existing proc " + old + " when adding "+ proc);
  }
  UidRecord uidRec=mActiveUids.get(proc.uid);
  if (uidRec == null) {
    uidRec=new UidRecord(proc.uid);
    if (DEBUG_UID_OBSERVERS)     Slog.i(TAG_UID_OBSERVERS,"Creating new process uid: " + uidRec);
    mActiveUids.put(proc.uid,uidRec);
    noteUidProcessState(uidRec.uid,uidRec.curProcState);
    enqueueUidChangeLocked(uidRec,-1,UidRecord.CHANGE_ACTIVE);
  }
  proc.uidRecord=uidRec;
  uidRec.numProcs++;
  mProcessNames.put(proc.processName,proc.uid,proc);
  if (proc.isolated) {
    mIsolatedProcesses.put(proc.uid,proc);
  }
}
