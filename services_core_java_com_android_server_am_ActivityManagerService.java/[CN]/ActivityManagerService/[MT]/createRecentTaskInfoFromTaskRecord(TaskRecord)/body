{
  tr.updateTaskDescription();
  ActivityManager.RecentTaskInfo rti=new ActivityManager.RecentTaskInfo();
  rti.id=tr.getTopActivity() == null ? INVALID_TASK_ID : tr.taskId;
  rti.persistentId=tr.taskId;
  rti.baseIntent=new Intent(tr.getBaseIntent());
  rti.origActivity=tr.origActivity;
  rti.realActivity=tr.realActivity;
  rti.description=tr.lastDescription;
  rti.stackId=tr.stack != null ? tr.stack.mStackId : -1;
  rti.userId=tr.userId;
  rti.taskDescription=new ActivityManager.TaskDescription(tr.lastTaskDescription);
  rti.firstActiveTime=tr.firstActiveTime;
  rti.lastActiveTime=tr.lastActiveTime;
  rti.affiliatedTaskId=tr.mAffiliatedTaskId;
  rti.affiliatedTaskColor=tr.mAffiliatedTaskColor;
  rti.numActivities=0;
  if (tr.mBounds != null) {
    rti.bounds=new Rect(tr.mBounds);
  }
  rti.isDockable=tr.canGoInDockedStack();
  rti.resizeMode=tr.mResizeMode;
  ActivityRecord base=null;
  ActivityRecord top=null;
  ActivityRecord tmp;
  for (int i=tr.mActivities.size() - 1; i >= 0; --i) {
    tmp=tr.mActivities.get(i);
    if (tmp.finishing) {
      continue;
    }
    base=tmp;
    if (top == null || (top.state == ActivityState.INITIALIZING)) {
      top=base;
    }
    rti.numActivities++;
  }
  rti.baseActivity=(base != null) ? base.intent.getComponent() : null;
  rti.topActivity=(top != null) ? top.intent.getComponent() : null;
  return rti;
}
