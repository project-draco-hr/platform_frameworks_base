{
  Identity tlsIdentity=sCallerIdentity.get();
  if (tlsIdentity != null) {
    Slog.d(TAG,"checkComponentPermission() adjusting {pid,uid} to {" + tlsIdentity.pid + ","+ tlsIdentity.uid+ "}");
    uid=tlsIdentity.uid;
    pid=tlsIdentity.pid;
  }
  if (pid == MY_PID) {
    return PackageManager.PERMISSION_GRANTED;
  }
  return ActivityManager.checkComponentPermission(permission,uid,owningUid,exported);
}
