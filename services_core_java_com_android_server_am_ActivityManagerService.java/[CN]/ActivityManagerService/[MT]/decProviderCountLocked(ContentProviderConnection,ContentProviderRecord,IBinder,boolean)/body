{
  if (conn != null) {
    cpr=conn.provider;
    if (DEBUG_PROVIDER)     Slog.v(TAG_PROVIDER,"Removing provider requested by " + conn.client.processName + " from process "+ cpr.info.processName+ ": "+ cpr.name.flattenToShortString()+ " scnt="+ conn.stableCount+ " uscnt="+ conn.unstableCount);
    if (stable) {
      conn.stableCount--;
    }
 else {
      conn.unstableCount--;
    }
    if (conn.stableCount == 0 && conn.unstableCount == 0) {
      cpr.connections.remove(conn);
      conn.client.conProviders.remove(conn);
      stopAssociationLocked(conn.client.uid,conn.client.processName,cpr.uid,cpr.name);
      return true;
    }
    return false;
  }
  cpr.removeExternalProcessHandleLocked(externalProcessToken);
  return false;
}
