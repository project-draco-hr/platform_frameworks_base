{
  Preconditions.checkNotNull(tag);
synchronized (ActivityManagerService.this) {
    SleepTokenImpl token=new SleepTokenImpl(tag);
    mSleepTokens.add(token);
    updateSleepIfNeededLocked();
    applyVrModeIfNeededLocked(mFocusedActivity,false);
    return token;
  }
}
