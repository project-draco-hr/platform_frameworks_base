{
  checkCaller();
synchronized (ActivityManagerService.this) {
    long origId=Binder.clearCallingIdentity();
    try {
      TaskRecord tr=recentTaskForIdLocked(mTaskId);
      if (tr != null) {
        int flags=tr.getBaseIntent().getFlags();
        boolean isDocument=(flags & Intent.FLAG_ACTIVITY_NEW_DOCUMENT) == Intent.FLAG_ACTIVITY_NEW_DOCUMENT;
        removeTaskByIdLocked(mTaskId,!isDocument ? ActivityManager.REMOVE_TASK_KILL_PROCESS : 0);
      }
    }
  finally {
      Binder.restoreCallingIdentity(origId);
    }
  }
}
