{
  checkCaller();
synchronized (ActivityManagerService.this) {
    long origId=Binder.clearCallingIdentity();
    try {
      TaskRecord tr=mRecentTasks.taskForIdLocked(mTaskId);
      if (tr == null) {
        throw new IllegalArgumentException("Unable to find task ID " + mTaskId);
      }
      Intent intent=tr.getBaseIntent();
      if (exclude) {
        intent.addFlags(Intent.FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS);
      }
 else {
        intent.setFlags(intent.getFlags() & ~Intent.FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS);
      }
    }
  finally {
      Binder.restoreCallingIdentity(origId);
    }
  }
}
