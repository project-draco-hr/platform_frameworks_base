{
  PackageInfo pkg=null;
  try {
    pkg=mPackageManager.getPackageInfo("com.android.sharedstoragebackup",0);
    IBackupAgent agent=bindToAgentSynchronous(pkg.applicationInfo,IApplicationThread.BACKUP_MODE_FULL);
    if (agent != null) {
      sendOnBackupPackage("Shared storage");
      final int token=generateToken();
      prepareOperationTimeout(token,TIMEOUT_SHARED_BACKUP_INTERVAL);
      agent.doFullBackup(mOutputFile,token,mBackupManagerBinder);
      if (!waitUntilOperationComplete(token)) {
        Slog.e(TAG,"Full backup failed on shared storage");
      }
 else {
        if (DEBUG)         Slog.d(TAG,"Full shared storage backup success");
      }
    }
 else {
      Slog.e(TAG,"Could not bind to shared storage backup agent");
    }
  }
 catch (  NameNotFoundException e) {
    Slog.e(TAG,"Shared storage backup package not found");
  }
 finally {
    tearDown(pkg);
  }
}
