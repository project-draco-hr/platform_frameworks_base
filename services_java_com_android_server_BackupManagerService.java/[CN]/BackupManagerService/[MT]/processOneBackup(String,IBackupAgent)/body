{
  Log.d(TAG,"processOneBackup doBackup() on " + packageName);
  BackupRequest request;
synchronized (mQueueLock) {
    if (mBackupQueue == null) {
      Log.d(TAG,"mBackupQueue is null.  WHY?");
    }
    request=mBackupQueue.get(0);
  }
  try {
    File savedStateName=new File(mStateDir,request.appInfo.packageName);
    File backupDataName=new File(mDataDir,request.appInfo.packageName + ".data");
    File newStateName=new File(mStateDir,request.appInfo.packageName + ".new");
    ParcelFileDescriptor savedState=(request.fullBackup) ? null : ParcelFileDescriptor.open(savedStateName,ParcelFileDescriptor.MODE_READ_ONLY | ParcelFileDescriptor.MODE_CREATE);
    backupDataName.delete();
    ParcelFileDescriptor backupData=ParcelFileDescriptor.open(backupDataName,ParcelFileDescriptor.MODE_READ_WRITE | ParcelFileDescriptor.MODE_CREATE);
    newStateName.delete();
    ParcelFileDescriptor newState=ParcelFileDescriptor.open(newStateName,ParcelFileDescriptor.MODE_READ_WRITE | ParcelFileDescriptor.MODE_CREATE);
    try {
      bs.doBackup(savedState,backupData,newState);
    }
  finally {
      if (savedState != null) {
        savedState.close();
      }
      backupData.close();
      newState.close();
    }
    newStateName.renameTo(savedStateName);
  }
 catch (  FileNotFoundException fnf) {
    Log.d(TAG,"File not found on backup: ");
    fnf.printStackTrace();
  }
catch (  RemoteException e) {
    Log.d(TAG,"Remote target " + packageName + " threw during backup:");
    e.printStackTrace();
  }
catch (  Exception e) {
    Log.w(TAG,"Final exception guard in backup: ");
    e.printStackTrace();
  }
synchronized (mQueueLock) {
    mBackupQueue.remove(0);
  }
  if (request != null) {
    try {
      mActivityManager.unbindBackupAgent(request.appInfo);
    }
 catch (    RemoteException e) {
    }
  }
  startOneAgent();
}
