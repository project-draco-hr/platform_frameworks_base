{
  HashSet<ApplicationInfo> targets;
  if ((mContext.checkPermission(android.Manifest.permission.BACKUP,Binder.getCallingPid(),Binder.getCallingUid())) == PackageManager.PERMISSION_DENIED) {
    targets=mBackupParticipants.get(Binder.getCallingUid());
  }
 else {
    targets=new HashSet<ApplicationInfo>();
    int N=mBackupParticipants.size();
    for (int i=0; i < N; i++) {
      HashSet<ApplicationInfo> s=mBackupParticipants.valueAt(i);
      if (s != null) {
        targets.addAll(s);
      }
    }
  }
  if (targets != null) {
synchronized (mQueueLock) {
      for (      ApplicationInfo app : targets) {
        if (app.packageName.equals(packageName)) {
          BackupRequest req=new BackupRequest(app,false);
          if (mPendingBackups.put(app,req) == null) {
            writeToJournalLocked(packageName);
            if (DEBUG) {
              int numKeys=mPendingBackups.size();
              Log.d(TAG,"Now awaiting backup for " + numKeys + " participants:");
              for (              BackupRequest b : mPendingBackups.values()) {
                Log.d(TAG,"    + " + b + " agent="+ b.appInfo.backupAgentName);
              }
            }
          }
        }
      }
    }
  }
 else {
    Log.w(TAG,"dataChanged but no participant pkg='" + packageName + "'");
  }
}
