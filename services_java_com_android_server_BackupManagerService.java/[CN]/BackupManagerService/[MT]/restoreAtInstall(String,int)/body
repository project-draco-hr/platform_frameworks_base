{
  if (Binder.getCallingUid() != Process.SYSTEM_UID) {
    Log.w(TAG,"Non-system process uid=" + Binder.getCallingUid() + " attemping install-time restore");
    return;
  }
  long restoreSet=getAvailableRestoreToken(packageName);
  if (DEBUG)   Log.v(TAG,"restoreAtInstall pkg=" + packageName + " token="+ Integer.toHexString(token));
  if (restoreSet != 0) {
    PackageInfo pkg=new PackageInfo();
    pkg.packageName=packageName;
    mWakelock.acquire();
    Message msg=mBackupHandler.obtainMessage(MSG_RUN_RESTORE);
    msg.obj=new RestoreParams(getTransport(mCurrentTransport),null,restoreSet,pkg,token);
    mBackupHandler.sendMessage(msg);
  }
 else {
    if (DEBUG)     Log.v(TAG,"No restore set -- skipping restore");
    try {
      mPackageManagerBinder.finishPackageInstall(token);
    }
 catch (    RemoteException e) {
    }
  }
}
