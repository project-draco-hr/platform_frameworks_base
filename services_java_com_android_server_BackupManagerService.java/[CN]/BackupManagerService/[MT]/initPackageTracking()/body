{
  if (DEBUG)   Log.v(TAG,"Initializing package tracking");
  mEverStored=new File(mBaseStateDir,"processed");
  File tempProcessedFile=new File(mBaseStateDir,"processed.new");
  try {
    RandomAccessFile temp=new RandomAccessFile(tempProcessedFile,"rw");
    mEverStoredStream=new RandomAccessFile(mEverStored,"r");
    mEverStoredStream.seek(0);
    temp.seek(0);
    try {
      while (true) {
        PackageInfo info;
        String pkg=mEverStoredStream.readUTF();
        try {
          info=mPackageManager.getPackageInfo(pkg,0);
          mEverStoredApps.add(pkg);
          temp.writeUTF(pkg);
          if (DEBUG)           Log.v(TAG,"   + " + pkg);
        }
 catch (        NameNotFoundException e) {
          if (DEBUG)           Log.v(TAG,"   - " + pkg);
        }
      }
    }
 catch (    EOFException e) {
    }
    temp.close();
    mEverStoredStream.close();
    tempProcessedFile.renameTo(mEverStored);
    mEverStoredStream=new RandomAccessFile(mEverStored,"rwd");
  }
 catch (  IOException e) {
    Log.e(TAG,"Unable to open known-stored file!");
    mEverStoredStream=null;
  }
  if (tempProcessedFile.exists()) {
    tempProcessedFile.delete();
  }
  IntentFilter filter=new IntentFilter();
  filter.addAction(Intent.ACTION_PACKAGE_ADDED);
  filter.addAction(Intent.ACTION_PACKAGE_REMOVED);
  filter.addDataScheme("package");
  mContext.registerReceiver(mBroadcastReceiver,filter);
}
