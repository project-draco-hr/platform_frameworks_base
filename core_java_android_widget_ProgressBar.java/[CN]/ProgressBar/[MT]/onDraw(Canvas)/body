{
  super.onDraw(canvas);
  Drawable d=mCurrentDrawable;
  if (d != null) {
    canvas.save();
    canvas.translate(mPaddingLeft,mPaddingTop);
    long time=getDrawingTime();
    if (mAnimation != null) {
      mAnimation.getTransformation(time,mTransformation);
      float scale=mTransformation.getAlpha();
      try {
        mInDrawing=true;
        d.setLevel((int)(scale * MAX_LEVEL));
      }
  finally {
        mInDrawing=false;
      }
      if (SystemClock.uptimeMillis() - mLastDrawTime >= ANIMATION_RESOLUTION) {
        mLastDrawTime=SystemClock.uptimeMillis();
        postInvalidateDelayed(ANIMATION_RESOLUTION);
      }
    }
    d.draw(canvas);
    canvas.restore();
    if (mShouldStartAnimationDrawable && d instanceof AnimationDrawable) {
      ((AnimationDrawable)d).start();
      mShouldStartAnimationDrawable=false;
    }
  }
}
