{
  float scale=getScale(progress);
  final Drawable d=mCurrentDrawable;
  if (d != null) {
    Drawable progressDrawable=null;
    if (d instanceof LayerDrawable) {
      progressDrawable=((LayerDrawable)d).findDrawableByLayerId(id);
      if (progressDrawable != null && canResolveLayoutDirection()) {
        progressDrawable.setLayoutDirection(getLayoutDirection());
      }
    }
    final int level=(int)(scale * MAX_LEVEL);
    (progressDrawable != null ? progressDrawable : d).setLevel(level);
  }
 else {
    invalidate();
  }
  if (id == R.id.progress) {
    if (animate) {
      onAnimatePosition(scale,fromUser);
    }
 else     if (callBackToApp) {
      onProgressRefresh(scale,fromUser);
    }
  }
}
