{
  if (mProgressDrawable != d) {
    if (mProgressDrawable != null) {
      mProgressDrawable.setCallback(null);
      unscheduleDrawable(mProgressDrawable);
    }
    mProgressDrawable=d;
    if (d != null) {
      d.setCallback(this);
      d.setLayoutDirection(getLayoutDirection());
      if (d.isStateful()) {
        d.setState(getDrawableState());
      }
      int drawableHeight=d.getMinimumHeight();
      if (mMaxHeight < drawableHeight) {
        mMaxHeight=drawableHeight;
        requestLayout();
      }
      if (mHasProgressTint) {
        applyProgressLayerTint(R.id.progress,mProgressTintList,mProgressTintMode,true);
      }
      if (mHasProgressBackgroundTint) {
        applyProgressLayerTint(R.id.background,mProgressBackgroundTintList,mProgressBackgroundTintMode,false);
      }
      if (mHasSecondaryProgressTint) {
        applyProgressLayerTint(R.id.secondaryProgress,mSecondaryProgressTintList,mSecondaryProgressTintMode,false);
      }
    }
    if (!mIndeterminate) {
      mCurrentDrawable=d;
      postInvalidate();
    }
    updateDrawableBounds(getWidth(),getHeight());
    updateDrawableState();
    doRefreshProgress(R.id.progress,mProgress,false,false);
    doRefreshProgress(R.id.secondaryProgress,mSecondaryProgress,false,false);
  }
}
