{
  final int mode=getMode();
  mListView.setVisibility(mode == MODE_LIST ? View.VISIBLE : View.GONE);
  mGridView.setVisibility(mode == MODE_GRID ? View.VISIBLE : View.GONE);
  final int choiceMode;
  if (getArguments().getBoolean(EXTRA_ALLOW_MULTIPLE)) {
    choiceMode=ListView.CHOICE_MODE_MULTIPLE_MODAL;
  }
 else {
    choiceMode=ListView.CHOICE_MODE_NONE;
  }
  if (mode == MODE_GRID) {
    mListView.setAdapter(null);
    mListView.setChoiceMode(ListView.CHOICE_MODE_NONE);
    mGridView.setAdapter(mAdapter);
    mGridView.setColumnWidth(getResources().getDimensionPixelSize(R.dimen.grid_width));
    mGridView.setNumColumns(GridView.AUTO_FIT);
    mGridView.setChoiceMode(choiceMode);
    mCurrentView=mGridView;
  }
 else {
    mGridView.setAdapter(null);
    mGridView.setChoiceMode(ListView.CHOICE_MODE_NONE);
    mListView.setAdapter(mAdapter);
    mListView.setChoiceMode(choiceMode);
    mCurrentView=mListView;
  }
}
