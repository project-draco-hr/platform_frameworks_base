{
  final State state=getDisplayState(DirectoryFragment.this);
  final LayoutInflater inflater=LayoutInflater.from(getContext());
switch (state.derivedMode) {
case MODE_GRID:
    return new DocumentHolder(inflater.inflate(R.layout.item_doc_grid,parent,false));
case MODE_LIST:
  return new DocumentHolder(inflater.inflate(R.layout.item_doc_list,parent,false));
case MODE_UNKNOWN:
default :
throw new IllegalStateException("Unsupported layout mode.");
}
}
