{
  final Cursor cursor=mAdapter.getItem(position);
  checkNotNull(cursor,"Cursor cannot be null.");
  final int docFlags=getCursorInt(cursor,Document.COLUMN_FLAGS);
  if ((docFlags & Document.FLAG_SUPPORTS_DELETE) == 0) {
    mNoDeleteCount+=selected ? 1 : -1;
  }
  mSelectionManager.getSelection(mSelected);
  if (mSelected.size() > 0) {
    if (DEBUG)     Log.d(TAG,"Maybe starting action mode.");
    if (mActionMode == null) {
      if (DEBUG)       Log.d(TAG,"Yeah. Starting action mode.");
      mActionMode=getActivity().startActionMode(this);
      getActivity().getWindow().setStatusBarColor(getResources().getColor(R.color.action_mode_status_bar_background));
    }
    updateActionMenu();
  }
 else {
    if (DEBUG)     Log.d(TAG,"Finishing action mode.");
    if (mActionMode != null) {
      mActionMode.finish();
    }
    getActivity().getWindow().setStatusBarColor(getResources().getColor(R.color.status_bar_background));
  }
  if (mActionMode != null) {
    mActionMode.setTitle(TextUtils.formatSelectedCount(mSelected.size()));
  }
}
