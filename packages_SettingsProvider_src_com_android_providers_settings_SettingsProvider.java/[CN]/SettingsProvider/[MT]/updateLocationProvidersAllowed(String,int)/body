{
  if (TextUtils.isEmpty(value)) {
    return false;
  }
  final char prefix=value.charAt(0);
  if (prefix != '+' && prefix != '-') {
    return false;
  }
  value=value.substring(1);
  Setting settingValue=getSecureSettingLocked(Settings.Secure.LOCATION_PROVIDERS_ALLOWED,owningUserId);
  String oldProviders=(settingValue != null) ? settingValue.getValue() : "";
  int index=oldProviders.indexOf(value);
  int end=index + value.length();
  if (index > 0 && oldProviders.charAt(index - 1) != ',') {
    index=-1;
  }
  if (end < oldProviders.length() && oldProviders.charAt(end) != ',') {
    index=-1;
  }
  String newProviders;
  if (prefix == '+' && index < 0) {
    if (oldProviders.length() == 0) {
      newProviders=value;
    }
 else {
      newProviders=oldProviders + ',' + value;
    }
  }
 else   if (prefix == '-' && index >= 0) {
    if (index > 0) {
      index--;
    }
 else     if (end < oldProviders.length()) {
      end++;
    }
    newProviders=oldProviders.substring(0,index);
    if (end < oldProviders.length()) {
      newProviders+=oldProviders.substring(end);
    }
  }
 else {
    return false;
  }
  updateSecureSettingLocked(Settings.Secure.LOCATION_PROVIDERS_ALLOWED,newProviders,owningUserId);
  return true;
}
