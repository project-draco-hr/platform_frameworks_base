{
  int callingUser=UserHandle.getCallingUserId();
  if (LOCAL_LOGV)   Slog.v(TAG,"update() for user " + callingUser);
  SqlArguments args=new SqlArguments(url,where,whereArgs);
  if (TABLE_FAVORITES.equals(args.table)) {
    return 0;
  }
 else   if (TABLE_GLOBAL.equals(args.table)) {
    callingUser=UserHandle.USER_OWNER;
  }
  checkWritePermissions(args);
  checkUserRestrictions(initialValues.getAsString(Settings.Secure.NAME),callingUser);
  final AtomicInteger mutationCount;
synchronized (this) {
    mutationCount=sKnownMutationsInFlight.get(callingUser);
  }
  if (mutationCount != null) {
    mutationCount.incrementAndGet();
  }
  DatabaseHelper dbH=getOrEstablishDatabase(callingUser);
  SQLiteDatabase db=dbH.getWritableDatabase();
  int count=db.update(args.table,initialValues,args.where,args.args);
  if (mutationCount != null) {
    mutationCount.decrementAndGet();
  }
  if (count > 0) {
    invalidateCache(callingUser,args.table);
    sendNotify(url,callingUser);
  }
  startAsyncCachePopulation(callingUser);
  if (LOCAL_LOGV)   Log.v(TAG,args.table + ": " + count+ " row(s) <- "+ initialValues);
  return count;
}
