{
  if (DEBUG) {
    Slog.v(LOG_TAG,"getAllSecureSettings(" + userId + ")");
  }
  final int callingUserId=resolveCallingUserIdEnforcingPermissionsLocked(userId);
synchronized (mLock) {
    List<String> names=mSettingsRegistry.getSettingsNamesLocked(SETTINGS_TYPE_SECURE,callingUserId);
    final int nameCount=names.size();
    String[] normalizedProjection=normalizeProjection(projection);
    MatrixCursor result=new MatrixCursor(normalizedProjection,nameCount);
    for (int i=0; i < nameCount; i++) {
      String name=names.get(i);
      final int owningUserId=resolveOwningUserIdForSecureSettingLocked(callingUserId,name);
      if (isLocationProvidersAllowedRestricted(name,callingUserId,owningUserId)) {
        return null;
      }
      Setting setting=mSettingsRegistry.getSettingLocked(SETTINGS_TYPE_SECURE,owningUserId,name);
      appendSettingToCursor(result,setting);
    }
    return result;
  }
}
