{
  mConnectionFailedLock.lock();
  if (mConnectionFailed) {
    mConnectionFailedLock.unlock();
    return false;
  }
  mConnectionFailedLock.unlock();
  if (mPostEntity == null)   return false;
  if (!mPostEntity.isReady())   return false;
  if (data == null && bytes == 0) {
    mBuffer.put(null);
  }
 else {
    mBuffer.put(new DataPacket(data,bytes));
  }
  mSignal.waitUntilPacketConsumed();
  mConnectionFailedLock.lock();
  if (mConnectionFailed) {
    Log.e(LOG_TAG,"failure");
    mConnectionFailedLock.unlock();
    return false;
  }
  mConnectionFailedLock.unlock();
  return true;
}
