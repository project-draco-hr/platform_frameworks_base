{
  for (  final Map.Entry<String,? extends BatteryStats.Uid.Pkg.Serv> entry : pkg.getServiceStats().entrySet()) {
    final HealthStatsWriter writer=new HealthStatsWriter(ServiceHealthStats.CONSTANTS);
    writeServ(writer,entry.getValue());
    pkgWriter.addStats(PackageHealthStats.STATS_SERVICES,entry.getKey(),writer);
  }
  for (  final Map.Entry<String,? extends BatteryStats.Counter> entry : pkg.getWakeupAlarmStats().entrySet()) {
    final BatteryStats.Counter counter=entry.getValue();
    if (counter != null) {
      pkgWriter.addMeasurements(PackageHealthStats.MEASUREMENTS_WAKEUP_ALARMS_COUNT,entry.getKey(),counter.getCountLocked(STATS_SINCE_UNPLUGGED));
    }
  }
}
