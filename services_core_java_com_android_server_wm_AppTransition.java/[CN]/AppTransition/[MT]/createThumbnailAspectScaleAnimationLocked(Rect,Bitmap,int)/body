{
  Animation a;
  final int thumbWidthI=thumbnailHeader.getWidth();
  final float thumbWidth=thumbWidthI > 0 ? thumbWidthI : 1;
  final int thumbHeightI=thumbnailHeader.getHeight();
  final float thumbHeight=thumbHeightI > 0 ? thumbHeightI : 1;
  final int appWidth=appRect.width();
  float scaleW=appWidth / thumbWidth;
  float unscaledHeight=thumbHeight * scaleW;
  getNextAppTransitionStartRect(taskId,mTmpRect);
  final float unscaledStartY=mTmpRect.top - (unscaledHeight - thumbHeight) / 2f;
  final float toY=appRect.top + mNextAppTransitionInsets.top + -unscaledStartY;
  if (mNextAppTransitionScaleUp) {
    Animation scale=new ScaleAnimation(1f,scaleW,1f,scaleW,mTmpRect.left + (thumbWidth / 2f),mTmpRect.top + (thumbHeight / 2f));
    scale.setInterpolator(mTouchResponseInterpolator);
    scale.setDuration(THUMBNAIL_APP_TRANSITION_DURATION);
    Animation alpha=new AlphaAnimation(1,0);
    alpha.setInterpolator(mThumbnailFadeOutInterpolator);
    alpha.setDuration(THUMBNAIL_APP_TRANSITION_ALPHA_DURATION);
    final float toX=appRect.left + appRect.width() / 2 - (mTmpRect.left + thumbWidth / 2);
    Animation translate=new TranslateAnimation(0,toX,0,toY);
    translate.setInterpolator(mTouchResponseInterpolator);
    translate.setDuration(THUMBNAIL_APP_TRANSITION_DURATION);
    AnimationSet set=new AnimationSet(false);
    set.addAnimation(scale);
    set.addAnimation(alpha);
    set.addAnimation(translate);
    a=set;
  }
 else {
    Animation scale=new ScaleAnimation(scaleW,1f,scaleW,1f,mTmpRect.left + (thumbWidth / 2f),mTmpRect.top + (thumbHeight / 2f));
    scale.setInterpolator(mTouchResponseInterpolator);
    scale.setDuration(THUMBNAIL_APP_TRANSITION_DURATION);
    Animation alpha=new AlphaAnimation(0f,1f);
    alpha.setInterpolator(mThumbnailFadeInInterpolator);
    alpha.setDuration(THUMBNAIL_APP_TRANSITION_ALPHA_DURATION);
    final float toX=appRect.left + appRect.width() / 2 - (mTmpRect.left + thumbWidth / 2);
    Animation translate=new TranslateAnimation(toX,0,toY,0);
    translate.setInterpolator(mTouchResponseInterpolator);
    translate.setDuration(THUMBNAIL_APP_TRANSITION_DURATION);
    AnimationSet set=new AnimationSet(false);
    set.addAnimation(scale);
    set.addAnimation(alpha);
    set.addAnimation(translate);
    a=set;
  }
  return prepareThumbnailAnimationWithDuration(a,appWidth,appRect.height(),0,mTouchResponseInterpolator);
}
