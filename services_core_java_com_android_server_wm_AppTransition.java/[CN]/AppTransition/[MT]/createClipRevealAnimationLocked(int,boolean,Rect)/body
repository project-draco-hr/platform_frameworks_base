{
  final Animation anim;
  if (enter) {
    final int appWidth=appFrame.width();
    final int appHeight=appFrame.height();
    float t=0f;
    if (appHeight > 0) {
      t=(float)mNextAppTransitionStartY / appHeight;
    }
    int translationY=mClipRevealTranslationY + (int)(appHeight / 7f * t);
    int centerX=mNextAppTransitionStartX + mNextAppTransitionStartWidth / 2;
    int centerY=mNextAppTransitionStartY + mNextAppTransitionStartHeight / 2;
    Animation clipAnimLR=new ClipRectLRAnimation(centerX - mNextAppTransitionStartWidth / 2,centerX + mNextAppTransitionStartWidth / 2,0,appWidth);
    clipAnimLR.setInterpolator(mClipHorizontalInterpolator);
    clipAnimLR.setDuration((long)(DEFAULT_APP_TRANSITION_DURATION / 2.5f));
    Animation clipAnimTB=new ClipRectTBAnimation(centerY - mNextAppTransitionStartHeight / 2 - translationY,centerY + mNextAppTransitionStartHeight / 2 - translationY,0,appHeight);
    clipAnimTB.setInterpolator(mTouchResponseInterpolator);
    clipAnimTB.setDuration(DEFAULT_APP_TRANSITION_DURATION);
    TranslateYAnimation translateY=new TranslateYAnimation(Animation.ABSOLUTE,translationY,Animation.ABSOLUTE,0);
    translateY.setInterpolator(mLinearOutSlowInInterpolator);
    translateY.setDuration(DEFAULT_APP_TRANSITION_DURATION);
    final int alphaDuration=DEFAULT_APP_TRANSITION_DURATION / 4;
    AlphaAnimation alpha=new AlphaAnimation(0.5f,1);
    alpha.setDuration(alphaDuration);
    alpha.setInterpolator(mLinearOutSlowInInterpolator);
    AnimationSet set=new AnimationSet(false);
    set.addAnimation(clipAnimLR);
    set.addAnimation(clipAnimTB);
    set.addAnimation(translateY);
    set.addAnimation(alpha);
    set.setZAdjustment(Animation.ZORDER_TOP);
    set.initialize(appWidth,appHeight,appWidth,appHeight);
    anim=set;
  }
 else {
    final long duration;
switch (transit) {
case TRANSIT_ACTIVITY_OPEN:
case TRANSIT_ACTIVITY_CLOSE:
      duration=mConfigShortAnimTime;
    break;
default :
  duration=DEFAULT_APP_TRANSITION_DURATION;
break;
}
if (transit == TRANSIT_WALLPAPER_INTRA_OPEN || transit == TRANSIT_WALLPAPER_INTRA_CLOSE) {
anim=new AlphaAnimation(1,0);
anim.setDetachWallpaper(true);
}
 else {
anim=new AlphaAnimation(1,1);
}
anim.setInterpolator(mDecelerateInterpolator);
anim.setDuration(duration);
anim.setFillAfter(true);
}
return anim;
}
