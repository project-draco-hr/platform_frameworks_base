{
  enforceAccessPermission();
  if (mBatchedScanSupported == false)   return new ArrayList<BatchedScanResult>();
  int userId=UserHandle.getCallingUserId();
  int uid=Binder.getCallingUid();
  long ident=Binder.clearCallingIdentity();
  try {
    if (mAppOps.noteOp(AppOpsManager.OP_WIFI_SCAN,uid,callingPackage) != AppOpsManager.MODE_ALLOWED) {
      return new ArrayList<BatchedScanResult>();
    }
    int currentUser=ActivityManager.getCurrentUser();
    if (userId != currentUser) {
      return new ArrayList<BatchedScanResult>();
    }
 else {
      return mWifiStateMachine.syncGetBatchedScanResultsList();
    }
  }
  finally {
    Binder.restoreCallingIdentity(ident);
  }
}
