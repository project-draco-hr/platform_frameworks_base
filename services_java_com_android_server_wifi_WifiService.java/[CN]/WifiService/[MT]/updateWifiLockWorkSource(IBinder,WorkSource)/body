{
  int uid=Binder.getCallingUid();
  int pid=Binder.getCallingPid();
  if (ws != null && ws.size() == 0) {
    ws=null;
  }
  if (ws != null) {
    enforceWakeSourcePermission(uid,pid);
  }
  long ident=Binder.clearCallingIdentity();
  try {
synchronized (mLocks) {
      int index=mLocks.findLockByBinder(lock);
      if (index < 0) {
        throw new IllegalArgumentException("Wifi lock not active");
      }
      WifiLock wl=mLocks.mList.get(index);
      noteReleaseWifiLock(wl);
      wl.mWorkSource=ws != null ? new WorkSource(ws) : new WorkSource(uid);
      noteAcquireWifiLock(wl);
    }
  }
 catch (  RemoteException e) {
  }
 finally {
    Binder.restoreCallingIdentity(ident);
  }
}
