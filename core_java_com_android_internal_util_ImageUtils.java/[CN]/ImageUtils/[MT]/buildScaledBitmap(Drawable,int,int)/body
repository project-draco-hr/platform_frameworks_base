{
  if (drawable == null) {
    return null;
  }
  int originalWidth=drawable.getIntrinsicWidth();
  int originalHeight=drawable.getIntrinsicHeight();
  if ((originalWidth <= maxWidth) && (originalHeight <= maxHeight) && (drawable instanceof BitmapDrawable)) {
    return ((BitmapDrawable)drawable).getBitmap();
  }
  if (originalHeight <= 0 || originalWidth <= 0) {
    return null;
  }
  float ratio=Math.min((float)maxWidth / (float)originalWidth,(float)maxHeight / (float)originalHeight);
  ratio=Math.min(1.0f,ratio);
  int scaledWidth=(int)(ratio * originalWidth);
  int scaledHeight=(int)(ratio * originalHeight);
  Bitmap result=Bitmap.createBitmap(scaledWidth,scaledHeight,Config.ARGB_8888);
  Canvas canvas=new Canvas(result);
  drawable.setBounds(0,0,scaledWidth,scaledHeight);
  drawable.draw(canvas);
  return result;
}
