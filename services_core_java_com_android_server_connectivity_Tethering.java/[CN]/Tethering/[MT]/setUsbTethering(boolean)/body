{
  if (VDBG)   Log.d(TAG,"setUsbTethering(" + enable + ")");
  UsbManager usbManager=(UsbManager)mContext.getSystemService(Context.USB_SERVICE);
synchronized (mPublicSync) {
    if (enable) {
      if (mRndisEnabled) {
        final long ident=Binder.clearCallingIdentity();
        try {
          tetherMatchingInterfaces(true,ConnectivityManager.TETHERING_USB);
        }
  finally {
          Binder.restoreCallingIdentity(ident);
        }
      }
 else {
        mUsbTetherRequested=true;
        usbManager.setCurrentFunction(UsbManager.USB_FUNCTION_RNDIS);
      }
    }
 else {
      final long ident=Binder.clearCallingIdentity();
      try {
        tetherMatchingInterfaces(false,ConnectivityManager.TETHERING_USB);
      }
  finally {
        Binder.restoreCallingIdentity(ident);
      }
      if (mRndisEnabled) {
        usbManager.setCurrentFunction(null);
      }
      mUsbTetherRequested=false;
    }
  }
  return ConnectivityManager.TETHER_ERROR_NO_ERROR;
}
