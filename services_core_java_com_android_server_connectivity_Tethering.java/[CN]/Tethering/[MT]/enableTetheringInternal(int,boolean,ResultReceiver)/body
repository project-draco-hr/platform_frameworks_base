{
  boolean isProvisioningRequired=isTetherProvisioningRequired();
switch (type) {
case ConnectivityManager.TETHERING_WIFI:
    final WifiManager wifiManager=(WifiManager)mContext.getSystemService(Context.WIFI_SERVICE);
  if (wifiManager.setWifiApEnabled(null,enable)) {
    sendTetherResult(receiver,ConnectivityManager.TETHER_ERROR_NO_ERROR);
    if (enable && isProvisioningRequired) {
      scheduleProvisioningRechecks(type);
    }
  }
 else {
    sendTetherResult(receiver,ConnectivityManager.TETHER_ERROR_MASTER_ERROR);
  }
break;
case ConnectivityManager.TETHERING_USB:
int result=setUsbTethering(enable);
if (enable && isProvisioningRequired && result == ConnectivityManager.TETHER_ERROR_NO_ERROR) {
scheduleProvisioningRechecks(type);
}
sendTetherResult(receiver,result);
break;
case ConnectivityManager.TETHERING_BLUETOOTH:
setBluetoothTethering(enable,receiver);
break;
default :
Log.w(TAG,"Invalid tether type.");
sendTetherResult(receiver,ConnectivityManager.TETHER_ERROR_UNKNOWN_IFACE);
}
}
