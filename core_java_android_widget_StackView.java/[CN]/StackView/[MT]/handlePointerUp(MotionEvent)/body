{
  int pointerIndex=ev.findPointerIndex(mActivePointerId);
  float newY=ev.getY(pointerIndex);
  int deltaY=(int)(newY - mInitialY);
  if (mVelocityTracker != null) {
    mVelocityTracker.computeCurrentVelocity(1000,mMaximumVelocity);
    mYVelocity=(int)mVelocityTracker.getYVelocity(mActivePointerId);
  }
  if (mVelocityTracker != null) {
    mVelocityTracker.recycle();
    mVelocityTracker=null;
  }
  if (deltaY > mSwipeThreshold && mSwipeGestureType == GESTURE_SLIDE_DOWN && mStackSlider.mMode == StackSlider.NORMAL_MODE) {
    showNext();
    mHighlight.bringToFront();
  }
 else   if (deltaY < -mSwipeThreshold && mSwipeGestureType == GESTURE_SLIDE_UP && mStackSlider.mMode == StackSlider.NORMAL_MODE) {
    showPrevious();
    mHighlight.bringToFront();
  }
 else   if (mSwipeGestureType == GESTURE_SLIDE_UP) {
    int duration=Math.round(mStackSlider.getDurationForNeutralPosition() * DEFAULT_ANIMATION_DURATION);
    StackSlider animationSlider=new StackSlider(mStackSlider);
    PropertyAnimator snapBackY=new PropertyAnimator(duration,animationSlider,"YProgress",mStackSlider.getYProgress(),0);
    snapBackY.setInterpolator(new LinearInterpolator());
    snapBackY.start();
    PropertyAnimator snapBackX=new PropertyAnimator(duration,animationSlider,"XProgress",mStackSlider.getXProgress(),0);
    snapBackX.setInterpolator(new LinearInterpolator());
    snapBackX.start();
  }
 else   if (mSwipeGestureType == GESTURE_SLIDE_DOWN) {
    int duration=Math.round(mStackSlider.getDurationForOffscreenPosition() * DEFAULT_ANIMATION_DURATION);
    StackSlider animationSlider=new StackSlider(mStackSlider);
    PropertyAnimator snapBackY=new PropertyAnimator(duration,animationSlider,"YProgress",mStackSlider.getYProgress(),1);
    snapBackY.setInterpolator(new LinearInterpolator());
    snapBackY.start();
    PropertyAnimator snapBackX=new PropertyAnimator(duration,animationSlider,"XProgress",mStackSlider.getXProgress(),0);
    snapBackX.setInterpolator(new LinearInterpolator());
    snapBackX.start();
  }
  mActivePointerId=INVALID_POINTER;
  mSwipeGestureType=GESTURE_NONE;
}
