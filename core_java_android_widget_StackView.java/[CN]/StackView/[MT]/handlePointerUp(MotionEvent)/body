{
  int pointerIndex=ev.findPointerIndex(mActivePointerId);
  float newY=ev.getY(pointerIndex);
  int deltaY=(int)(newY - mInitialY);
  mVelocityTracker.computeCurrentVelocity(1000,mMaximumVelocity);
  mYVelocity=(int)mVelocityTracker.getYVelocity(mActivePointerId);
  if (mVelocityTracker != null) {
    mVelocityTracker.recycle();
    mVelocityTracker=null;
  }
  if (deltaY > mSwipeThreshold && mSwipeGestureType == GESTURE_SLIDE_DOWN && !mGestureComplete) {
    showNext();
  }
 else   if (deltaY < -mSwipeThreshold && mSwipeGestureType == GESTURE_SLIDE_UP && !mGestureComplete) {
    showPrevious();
  }
 else   if (mSwipeGestureType == GESTURE_SLIDE_UP && !mGestureComplete) {
    View v=getViewAtRelativeIndex(mNumActiveViews - 2);
    if (v != null) {
      LayoutParams lp=(LayoutParams)v.getLayoutParams();
      int duration=(int)Math.round(lp.verticalOffset * 1.0f / -mViewHeight * DEFAULT_ANIMATION_DURATION);
      duration=Math.max(MINIMUM_ANIMATION_DURATION,duration);
      PropertyAnimator slideDown=new PropertyAnimator(duration,lp,"verticalOffset",lp.verticalOffset,0);
      slideDown.start();
      PropertyAnimator fadeIn=new PropertyAnimator(duration,v,"alpha",v.getAlpha(),1.0f);
      fadeIn.start();
    }
  }
 else   if (mSwipeGestureType == GESTURE_SLIDE_DOWN && !mGestureComplete) {
    View v=getViewAtRelativeIndex(mNumActiveViews - 1);
    if (v != null) {
      LayoutParams lp=(LayoutParams)v.getLayoutParams();
      int duration=(int)Math.round((1 - lp.verticalOffset * 1.0f / -mViewHeight) * DEFAULT_ANIMATION_DURATION);
      duration=Math.max(MINIMUM_ANIMATION_DURATION,duration);
      PropertyAnimator slideUp=new PropertyAnimator(duration,lp,"verticalOffset",lp.verticalOffset,-mViewHeight);
      slideUp.start();
      PropertyAnimator fadeOut=new PropertyAnimator(duration,v,"alpha",v.getAlpha(),0.0f);
      fadeOut.start();
    }
  }
  mActivePointerId=INVALID_POINTER;
  mGestureComplete=true;
  mSwipeGestureType=GESTURE_NONE;
  mYOffset=0;
}
