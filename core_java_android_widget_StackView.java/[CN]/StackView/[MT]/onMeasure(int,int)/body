{
  int widthSpecSize=MeasureSpec.getSize(widthMeasureSpec);
  int heightSpecSize=MeasureSpec.getSize(heightMeasureSpec);
  final int widthSpecMode=MeasureSpec.getMode(widthMeasureSpec);
  final int heightSpecMode=MeasureSpec.getMode(heightMeasureSpec);
  boolean haveChildRefSize=(mReferenceChildWidth != -1 && mReferenceChildHeight != -1);
  float factor=1 / (1 - PERSPECTIVE_SHIFT_FACTOR);
  if (heightSpecMode == MeasureSpec.UNSPECIFIED) {
    heightSpecSize=haveChildRefSize ? Math.round(mReferenceChildHeight * (1 + factor)) + mPaddingTop + mPaddingBottom : 0;
  }
 else   if (heightSpecMode == MeasureSpec.AT_MOST) {
    heightSpecSize=haveChildRefSize ? Math.min(Math.round(mReferenceChildHeight * (1 + factor)) + mPaddingTop + mPaddingBottom,heightSpecSize) : 0;
  }
  if (widthSpecMode == MeasureSpec.UNSPECIFIED) {
    widthSpecSize=haveChildRefSize ? mReferenceChildWidth + mPaddingLeft + mPaddingRight : 0;
  }
 else   if (heightSpecMode == MeasureSpec.AT_MOST) {
    widthSpecSize=haveChildRefSize ? Math.min(mReferenceChildWidth + mPaddingLeft + mPaddingRight,widthSpecSize) : 0;
  }
  setMeasuredDimension(widthSpecSize,heightSpecSize);
  measureChildren();
}
