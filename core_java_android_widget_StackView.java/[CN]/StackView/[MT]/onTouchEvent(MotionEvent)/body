{
  int action=ev.getAction();
  int pointerIndex=ev.findPointerIndex(mActivePointerId);
  if (pointerIndex == INVALID_POINTER) {
    Log.d(TAG,"Error: No data for our primary pointer.");
    return false;
  }
  float newY=ev.getY(pointerIndex);
  float deltaY=newY - mInitialY;
  if (mVelocityTracker == null) {
    mVelocityTracker=VelocityTracker.obtain();
  }
  mVelocityTracker.addMovement(ev);
switch (action & MotionEvent.ACTION_MASK) {
case MotionEvent.ACTION_MOVE:
{
      if ((int)Math.abs(deltaY) > mTouchSlop && mSwipeGestureType == GESTURE_NONE) {
        mSwipeGestureType=deltaY < 0 ? GESTURE_SLIDE_UP : GESTURE_SLIDE_DOWN;
        mGestureComplete=false;
        cancelLongPress();
        requestDisallowInterceptTouchEvent(true);
      }
      if (!mGestureComplete) {
        if (mSwipeGestureType == GESTURE_SLIDE_DOWN) {
          View v=getViewAtRelativeIndex(mNumActiveViews - 1);
          if (v != null) {
            v.setVisibility(VISIBLE);
            float r=(deltaY - mTouchSlop) * 1.0f / (mSwipeThreshold);
            mYOffset=Math.min(-mViewHeight + (int)Math.round(r * mSwipeThreshold) - mTouchSlop,0);
            LayoutParams lp=(LayoutParams)v.getLayoutParams();
            lp.setVerticalOffset(mYOffset);
            float alpha=Math.max(0.0f,1.0f - (1.0f * mYOffset / -mViewHeight));
            alpha=Math.min(1.0f,alpha);
            v.setAlpha(alpha);
          }
          return true;
        }
 else         if (mSwipeGestureType == GESTURE_SLIDE_UP) {
          View v=getViewAtRelativeIndex(mNumActiveViews - 2);
          if (v != null) {
            float r=-(deltaY * 1.0f + mTouchSlop) / (mSwipeThreshold);
            mYOffset=Math.min((int)Math.round(r * -mSwipeThreshold),0);
            LayoutParams lp=(LayoutParams)v.getLayoutParams();
            lp.setVerticalOffset(mYOffset);
            float alpha=Math.max(0.0f,1.0f - (1.0f * mYOffset / -mViewHeight));
            alpha=Math.min(1.0f,alpha);
            v.setAlpha(alpha);
          }
          return true;
        }
      }
      break;
    }
case MotionEvent.ACTION_UP:
{
    handlePointerUp(ev);
    break;
  }
case MotionEvent.ACTION_POINTER_UP:
{
  onSecondaryPointerUp(ev);
  break;
}
case MotionEvent.ACTION_CANCEL:
{
mActivePointerId=INVALID_POINTER;
mGestureComplete=true;
mSwipeGestureType=GESTURE_NONE;
mYOffset=0;
break;
}
}
return true;
}
