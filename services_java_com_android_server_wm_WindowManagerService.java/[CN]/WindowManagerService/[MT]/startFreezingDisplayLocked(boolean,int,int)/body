{
  if (mDisplayFrozen) {
    return;
  }
  if (!mDisplayReady || !mPolicy.isScreenOnFully()) {
    return;
  }
  mScreenFrozenLock.acquire();
  mDisplayFrozen=true;
  mInputMonitor.freezeInputDispatchingLw();
  mPolicy.setLastInputMethodWindowLw(null,null);
  if (mAppTransition.isTransitionSet()) {
    mAppTransition.setAppTransition(WindowManagerPolicy.TRANSIT_UNSET);
    mAppTransition.clear();
    mAppTransition.setReady();
  }
  if (PROFILE_ORIENTATION) {
    File file=new File("/data/system/frozen");
    Debug.startMethodTracing(file.toString(),8 * 1024 * 1024);
  }
  if (CUSTOM_SCREEN_ROTATION) {
    final DisplayContent displayContent=getDefaultDisplayContentLocked();
    final int displayId=displayContent.getDisplayId();
    ScreenRotationAnimation screenRotationAnimation=mAnimator.getScreenRotationAnimationLocked(displayId);
    if (screenRotationAnimation != null) {
      screenRotationAnimation.kill();
    }
    final Display display=displayContent.getDisplay();
    final DisplayInfo displayInfo=displayContent.getDisplayInfo();
    screenRotationAnimation=new ScreenRotationAnimation(mContext,display,mFxSession,inTransaction,displayInfo.logicalWidth,displayInfo.logicalHeight,display.getRotation(),exitAnim,enterAnim);
    mAnimator.setScreenRotationAnimationLocked(displayId,screenRotationAnimation);
  }
}
