{
  if (mDisplayFrozen) {
    return;
  }
  if (!mDisplayReady || !mPolicy.isScreenOnFully()) {
    return;
  }
  mScreenFrozenLock.acquire();
  mDisplayFrozen=true;
  mInputMonitor.freezeInputDispatchingLw();
  if (mNextAppTransition != WindowManagerPolicy.TRANSIT_UNSET) {
    mNextAppTransition=WindowManagerPolicy.TRANSIT_UNSET;
    mNextAppTransitionType=ActivityOptions.ANIM_NONE;
    mNextAppTransitionPackage=null;
    mNextAppTransitionThumbnail=null;
    mAppTransitionReady=true;
  }
  if (PROFILE_ORIENTATION) {
    File file=new File("/data/system/frozen");
    Debug.startMethodTracing(file.toString(),8 * 1024 * 1024);
  }
  if (CUSTOM_SCREEN_ROTATION) {
    if (mAnimator.mScreenRotationAnimation != null) {
      mAnimator.mScreenRotationAnimation.kill();
      mAnimator.mScreenRotationAnimation=null;
    }
    final DisplayContent displayContent=getDefaultDisplayContent();
    final Display display=displayContent.getDisplay();
    final DisplayInfo displayInfo=displayContent.getDisplayInfo();
    mAnimator.mScreenRotationAnimation=new ScreenRotationAnimation(mContext,display,mFxSession,inTransaction,displayInfo.logicalWidth,displayInfo.logicalHeight,display.getRotation(),exitAnim,enterAnim);
  }
}
