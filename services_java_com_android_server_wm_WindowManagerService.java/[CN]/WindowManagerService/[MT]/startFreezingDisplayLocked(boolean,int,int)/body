{
  if (mDisplayFrozen) {
    return;
  }
  if (!mDisplayReady || !mPolicy.isScreenOnFully()) {
    return;
  }
  mScreenFrozenLock.acquire();
  mDisplayFrozen=true;
  mDisplayFreezeTime=SystemClock.elapsedRealtime();
  mLastFinishedFreezeSource=null;
  mInputMonitor.freezeInputDispatchingLw();
  mPolicy.setLastInputMethodWindowLw(null,null);
  if (mAppTransition.isTransitionSet()) {
    mAppTransition.freeze();
  }
  if (PROFILE_ORIENTATION) {
    File file=new File("/data/system/frozen");
    Debug.startMethodTracing(file.toString(),8 * 1024 * 1024);
  }
  if (CUSTOM_SCREEN_ROTATION) {
    mExitAnimId=exitAnim;
    mEnterAnimId=enterAnim;
    final DisplayContent displayContent=getDefaultDisplayContentLocked();
    final int displayId=displayContent.getDisplayId();
    ScreenRotationAnimation screenRotationAnimation=mAnimator.getScreenRotationAnimationLocked(displayId);
    if (screenRotationAnimation != null) {
      screenRotationAnimation.kill();
    }
    screenRotationAnimation=new ScreenRotationAnimation(mContext,displayContent,mFxSession,inTransaction,mPolicy.isDefaultOrientationForced());
    mAnimator.setScreenRotationAnimationLocked(displayId,screenRotationAnimation);
  }
}
