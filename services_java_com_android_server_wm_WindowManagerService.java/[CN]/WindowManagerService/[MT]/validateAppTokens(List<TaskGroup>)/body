{
synchronized (mWindowMap) {
    int t=tasks.size() - 1;
    if (t < 0) {
      Slog.w(TAG,"validateAppTokens: empty task list");
      return;
    }
    TaskGroup task=tasks.get(0);
    int taskId=task.taskId;
    DisplayContent displayContent=mTaskIdToDisplayContents.get(taskId);
    if (displayContent == null) {
      Slog.w(TAG,"validateAppTokens: no Display for taskId=" + taskId);
      return;
    }
    boolean mismatch=false;
    AppTokenIterator iterator=displayContent.getTmpAppIterator(REVERSE_ITERATOR);
    for (; t >= 0 && !mismatch; --t) {
      task=tasks.get(t);
      List<IApplicationToken> tokens=task.tokens;
      int v=task.tokens.size() - 1;
      DisplayContent lastDisplayContent=displayContent;
      displayContent=mTaskIdToDisplayContents.get(taskId);
      if (displayContent != lastDisplayContent) {
        Slog.w(TAG,"validateAppTokens: displayContent changed in TaskGroup list!");
        return;
      }
      while (v >= 0) {
        AppWindowToken atoken=iterator.next();
        if (atoken.removed) {
          continue;
        }
        if (tokens.get(v) != atoken.token) {
          mismatch=true;
          break;
        }
        v--;
      }
    }
    if (mismatch || iterator.hasNext()) {
      Slog.w(TAG,"validateAppTokens: Mismatch! ActivityManager=" + tasks + " WindowManager="+ iterator);
    }
  }
}
