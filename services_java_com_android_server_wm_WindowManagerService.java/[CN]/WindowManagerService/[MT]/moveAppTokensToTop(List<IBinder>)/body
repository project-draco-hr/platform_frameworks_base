{
  if (!checkCallingPermission(android.Manifest.permission.MANAGE_APP_TOKENS,"moveAppTokensToTop()")) {
    throw new SecurityException("Requires MANAGE_APP_TOKENS permission");
  }
  final long origId=Binder.clearCallingIdentity();
synchronized (mWindowMap) {
    removeAppTokensLocked(tokens);
    final int N=tokens.size();
    for (int i=0; i < N; i++) {
      AppWindowToken wt=findAppWindowToken(tokens.get(i));
      if (wt != null) {
        if (DEBUG_TOKEN_MOVEMENT || DEBUG_REORDER)         Slog.v(TAG,"Adding next to top: " + wt);
        mAppTokens.add(wt);
        if (mAppTransition.isTransitionSet()) {
          wt.sendingToBottom=false;
        }
      }
    }
    mAnimatingAppTokens.clear();
    mAnimatingAppTokens.addAll(mAppTokens);
    moveAppWindowsLocked(tokens,mAppTokens.size());
  }
  Binder.restoreCallingIdentity(origId);
}
