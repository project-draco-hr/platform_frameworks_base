{
  tmpRemoveAppWindowsLocked(wtoken);
  DisplayContentsIterator iterator=new DisplayContentsIterator();
  while (iterator.hasNext()) {
    final DisplayContent displayContent=iterator.next();
    final WindowList windows=displayContent.getWindowList();
    final int pos=findWindowOffsetLocked(windows,tokenPos);
    final int newPos=reAddAppWindowsLocked(displayContent,pos,wtoken);
    if (pos != newPos) {
      displayContent.layoutNeeded=true;
    }
    if (updateFocusAndLayout && !updateFocusedWindowLocked(UPDATE_FOCUS_WILL_PLACE_SURFACES,false)) {
      assignLayersLocked(windows);
    }
  }
  if (updateFocusAndLayout) {
    mInputMonitor.setUpdateInputWindowsNeededLw();
    if (!mInLayout) {
      performLayoutAndPlaceSurfacesLocked();
    }
    mInputMonitor.updateInputWindowsLw(false);
  }
}
