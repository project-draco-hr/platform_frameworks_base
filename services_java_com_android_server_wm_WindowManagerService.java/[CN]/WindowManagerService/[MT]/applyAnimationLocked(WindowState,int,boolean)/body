{
  if (win.mLocalAnimating && win.mAnimationIsEntrance == isEntrance) {
    return true;
  }
  if (okToDisplay()) {
    int anim=mPolicy.selectAnimationLw(win,transit);
    int attr=-1;
    Animation a=null;
    if (anim != 0) {
      a=AnimationUtils.loadAnimation(mContext,anim);
    }
 else {
switch (transit) {
case WindowManagerPolicy.TRANSIT_ENTER:
        attr=com.android.internal.R.styleable.WindowAnimation_windowEnterAnimation;
      break;
case WindowManagerPolicy.TRANSIT_EXIT:
    attr=com.android.internal.R.styleable.WindowAnimation_windowExitAnimation;
  break;
case WindowManagerPolicy.TRANSIT_SHOW:
attr=com.android.internal.R.styleable.WindowAnimation_windowShowAnimation;
break;
case WindowManagerPolicy.TRANSIT_HIDE:
attr=com.android.internal.R.styleable.WindowAnimation_windowHideAnimation;
break;
}
if (attr >= 0) {
a=loadAnimation(win.mAttrs,attr);
}
}
if (DEBUG_ANIM) Slog.v(TAG,"applyAnimation: win=" + win + " anim="+ anim+ " attr=0x"+ Integer.toHexString(attr)+ " mAnimation="+ win.mAnimation+ " isEntrance="+ isEntrance);
if (a != null) {
if (DEBUG_ANIM) {
RuntimeException e=null;
if (!HIDE_STACK_CRAWLS) {
e=new RuntimeException();
e.fillInStackTrace();
}
Slog.v(TAG,"Loaded animation " + a + " for "+ win,e);
}
win.setAnimation(a);
win.mAnimationIsEntrance=isEntrance;
}
}
 else {
win.clearAnimation();
}
return win.mAnimation != null;
}
