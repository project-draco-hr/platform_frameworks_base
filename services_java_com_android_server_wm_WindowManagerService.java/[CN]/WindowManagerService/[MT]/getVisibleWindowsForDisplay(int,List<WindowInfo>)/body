{
  if (!checkCallingPermission(android.Manifest.permission.RETRIEVE_WINDOW_INFO,"getWindowInfos()")) {
    throw new SecurityException("Requires RETRIEVE_WINDOW_INFO permission.");
  }
synchronized (mWindowMap) {
    DisplayContent displayContent=getDisplayContentLocked(displayId);
    if (displayContent == null) {
      return;
    }
    WindowList windows=displayContent.getWindowList();
    final int windowCount=windows.size();
    for (int i=0; i < windowCount; i++) {
      WindowState window=windows.get(i);
      if (window.isVisibleLw() || window.mAttrs.type == TYPE_UNIVERSE_BACKGROUND) {
        WindowInfo info=getWindowInfoForWindowStateLocked(window);
        outInfos.add(info);
      }
    }
  }
}
