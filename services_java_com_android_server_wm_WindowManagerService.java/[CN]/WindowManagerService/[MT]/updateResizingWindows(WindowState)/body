{
  if (!w.mAppFreezing && w.mLayoutSeq == mLayoutSeq) {
    w.mContentInsetsChanged|=!w.mLastContentInsets.equals(w.mContentInsets);
    w.mVisibleInsetsChanged|=!w.mLastVisibleInsets.equals(w.mVisibleInsets);
    boolean configChanged=w.mConfiguration != mCurConfiguration && (w.mConfiguration == null || mCurConfiguration.diff(w.mConfiguration) != 0);
    if (DEBUG_CONFIGURATION && configChanged) {
      Slog.v(TAG,"Win " + w + " config changed: "+ mCurConfiguration);
    }
    if (localLOGV)     Slog.v(TAG,"Resizing " + w + ": configChanged="+ configChanged+ " last="+ w.mLastFrame+ " frame="+ w.mFrame);
    w.mLastFrame.set(w.mFrame);
    if (w.mContentInsetsChanged || w.mVisibleInsetsChanged || w.mSurfaceResized|| configChanged) {
      if (DEBUG_RESIZE || DEBUG_ORIENTATION) {
        Slog.v(TAG,"Resize reasons: " + " contentInsetsChanged=" + w.mContentInsetsChanged + " visibleInsetsChanged="+ w.mVisibleInsetsChanged+ " surfaceResized="+ w.mSurfaceResized+ " configChanged="+ configChanged);
      }
      w.mLastContentInsets.set(w.mContentInsets);
      w.mLastVisibleInsets.set(w.mVisibleInsets);
      makeWindowFreezingScreenIfNeededLocked(w);
      if (w.mOrientationChanging) {
        if (DEBUG_ORIENTATION)         Slog.v(TAG,"Orientation start waiting for draw in " + w + ", surface "+ w.mSurface);
        w.mDrawPending=true;
        w.mCommitDrawPending=false;
        w.mReadyToShow=false;
        if (w.mAppToken != null) {
          w.mAppToken.allDrawn=false;
        }
      }
      if (!mResizingWindows.contains(w)) {
        if (DEBUG_RESIZE || DEBUG_ORIENTATION)         Slog.v(TAG,"Resizing window " + w + " to "+ w.mSurfaceW+ "x"+ w.mSurfaceH);
        mResizingWindows.add(w);
      }
    }
 else     if (w.mOrientationChanging) {
      if (!w.mDrawPending && !w.mCommitDrawPending) {
        if (DEBUG_ORIENTATION)         Slog.v(TAG,"Orientation not waiting for draw in " + w + ", surface "+ w.mSurface);
        w.mOrientationChanging=false;
      }
    }
  }
}
