{
  DisplayContent displayContent=mTaskIdToDisplayContents.get(taskId);
  if (displayContent == null) {
    Slog.w(TAG,"moveTaskWindowsLocked: can't find DisplayContent for taskId=" + taskId);
    return;
  }
  WindowList windows;
  WindowList windowsAtStart;
  if (DEBUG_TASK_MOVEMENT) {
    windows=displayContent.getWindowList();
    windowsAtStart=new WindowList(windows);
    windows.clear();
    windows.addAll(mSavedWindows);
  }
  TaskList taskList=displayContent.mTaskIdToTaskList.get(taskId);
  if (taskList == null) {
    Slog.w(TAG,"moveTaskWindowsLocked: can't find TaskList for taskId=" + taskId);
    return;
  }
  for (  AppWindowToken wtoken : taskList.mAppTokens) {
    tmpRemoveAppWindowsLocked(wtoken);
  }
  int pos=findAppWindowInsertionPointLocked(taskList.mAppTokens.get(0));
  for (  AppWindowToken wtoken : taskList.mAppTokens) {
    if (wtoken != null) {
      final int newPos=reAddAppWindowsLocked(displayContent,pos,wtoken);
      if (newPos != pos) {
        displayContent.layoutNeeded=true;
      }
      pos=newPos;
    }
  }
  if (!updateFocusedWindowLocked(UPDATE_FOCUS_WILL_PLACE_SURFACES,false)) {
    assignLayersLocked(displayContent.getWindowList());
  }
  if (DEBUG_TASK_MOVEMENT) {
    if (windowsAtStart.size() != windows.size()) {
      Slog.e(TAG,"moveTaskWindowsLocked: Mismatch in size!");
    }
    for (int i=0; i < windowsAtStart.size(); i++) {
      if (windowsAtStart.get(i) != windows.get(i)) {
        Slog.e(TAG,"moveTaskWindowsLocked: Mismatch at " + i + " app="+ windowsAtStart.get(i)+ " task="+ windows.get(i));
      }
    }
  }
  updateFocusedWindowLocked(UPDATE_FOCUS_WILL_PLACE_SURFACES,false);
  mInputMonitor.setUpdateInputWindowsNeededLw();
  performLayoutAndPlaceSurfacesLocked();
  mInputMonitor.updateInputWindowsLw(false);
}
