{
  if (!mStealEvents) {
    dispatchEventToModel(event);
  }
  if (mIsGesturing) {
    return;
  }
  final float x=event.getX();
  final float y=event.getY();
  final float dx=x - mX;
  final float dy=y - mY;
  mTotalLength+=(float)Math.sqrt(dx * dx + dy * dy);
  mX=x;
  mY=y;
  if (mTotalLength > STROKE_LENGTH_THRESHOLD) {
    final OrientedBoundingBox box=GestureUtilities.computeOrientedBoundingBox(overlay.getCurrentStroke());
    float angle=Math.abs(box.orientation);
    if (angle > 90) {
      angle=180 - angle;
    }
    if (box.squareness > SQUARENESS_THRESHOLD || angle < ANGLE_THRESHOLD) {
      mIsGesturing=true;
      overlay.setGestureDrawingColor(overlay.getGestureColor());
      if (mStealEvents) {
        event=MotionEvent.obtain(event.getDownTime(),System.currentTimeMillis(),MotionEvent.ACTION_UP,x,y,event.getPressure(),event.getSize(),event.getMetaState(),event.getXPrecision(),event.getYPrecision(),event.getDeviceId(),event.getEdgeFlags());
      }
    }
  }
  if (mStealEvents) {
    dispatchEventToModel(event);
  }
}
