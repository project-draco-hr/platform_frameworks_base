{
  if (downtime == null)   return null;
  final Uri id=ZenModeConfig.toDowntimeConditionId(downtime);
  final String skeleton=DateFormat.is24HourFormat(mContext) ? "Hm" : "hma";
  final Locale locale=Locale.getDefault();
  final String pattern=DateFormat.getBestDateTimePattern(locale,skeleton);
  final long now=System.currentTimeMillis();
  long endTime=mCalendar.getNextTime(now,downtime.endHour,downtime.endMinute);
  if (isZenNone()) {
    final AlarmClockInfo nextAlarm=mTracker.getNextAlarm();
    final long nextAlarmTime=nextAlarm != null ? nextAlarm.getTriggerTime() : 0;
    if (nextAlarmTime > now && nextAlarmTime < endTime) {
      endTime=nextAlarmTime;
    }
  }
  final String formatted=new SimpleDateFormat(pattern,locale).format(new Date(endTime));
  final String summary=mContext.getString(R.string.downtime_condition_summary,formatted);
  final String line1=mContext.getString(R.string.downtime_condition_line_one);
  return new Condition(id,summary,line1,formatted,0,state,Condition.FLAG_RELEVANT_NOW);
}
