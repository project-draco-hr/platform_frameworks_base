{
  final long now=System.currentTimeMillis();
  final boolean inDowntimeNow=isInDowntime(now);
  final int downtimeMode=inDowntimeNow ? (mConfig.sleepNone ? Global.ZEN_MODE_NO_INTERRUPTIONS : Global.ZEN_MODE_IMPORTANT_INTERRUPTIONS) : Global.ZEN_MODE_OFF;
  if (DEBUG)   Slog.d(TAG,"downtimeMode=" + downtimeMode);
  if (downtimeMode == mDowntimeMode)   return;
  mDowntimeMode=downtimeMode;
  Slog.i(TAG,(isInDowntime() ? "Entering" : "Exiting") + " downtime");
  ZenLog.traceDowntime(mDowntimeMode,getDayOfWeek(now),mDays);
  fireDowntimeChanged();
}
