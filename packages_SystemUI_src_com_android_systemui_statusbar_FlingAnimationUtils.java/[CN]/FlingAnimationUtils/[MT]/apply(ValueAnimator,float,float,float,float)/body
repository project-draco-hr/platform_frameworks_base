{
  float maxLengthSeconds=(float)(mMaxLengthSeconds * Math.sqrt(Math.abs(endValue - currValue) / maxDistance));
  float diff=Math.abs(endValue - currValue);
  float velAbs=Math.abs(velocity);
  float durationSeconds=LINEAR_OUT_SLOW_IN_START_GRADIENT * diff / velAbs;
  if (durationSeconds <= maxLengthSeconds) {
    animator.setInterpolator(mLinearOutSlowIn);
  }
 else   if (velAbs >= mMinVelocityPxPerSecond) {
    durationSeconds=maxLengthSeconds;
    VelocityInterpolator velocityInterpolator=new VelocityInterpolator(durationSeconds,velAbs,diff);
    InterpolatorInterpolator superInterpolator=new InterpolatorInterpolator(velocityInterpolator,mLinearOutSlowIn,mLinearOutSlowIn);
    animator.setInterpolator(superInterpolator);
  }
 else {
    durationSeconds=maxLengthSeconds;
    animator.setInterpolator(mFastOutSlowIn);
  }
  animator.setDuration((long)(durationSeconds * 1000));
}
