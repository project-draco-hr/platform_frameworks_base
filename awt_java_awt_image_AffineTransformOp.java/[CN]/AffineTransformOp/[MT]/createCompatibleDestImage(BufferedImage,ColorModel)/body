{
  Rectangle2D newBounds=getBounds2D(src);
  double dstWidth=newBounds.getX() + newBounds.getWidth();
  double dstHeight=newBounds.getY() + newBounds.getHeight();
  if (dstWidth <= 0 || dstHeight <= 0) {
    throw new RasterFormatException(Messages.getString("awt.251",dstWidth,dstHeight));
  }
  if (destCM != null) {
    return new BufferedImage(destCM,destCM.createCompatibleWritableRaster((int)dstWidth,(int)dstHeight),destCM.isAlphaPremultiplied(),null);
  }
  ColorModel cm=src.getColorModel();
  if (iType != TYPE_NEAREST_NEIGHBOR && cm instanceof IndexColorModel) {
    return new BufferedImage((int)dstWidth,(int)dstHeight,BufferedImage.TYPE_INT_ARGB);
  }
  return new BufferedImage(cm,src.getRaster().createCompatibleWritableRaster((int)dstWidth,(int)dstHeight),cm.isAlphaPremultiplied(),null);
}
