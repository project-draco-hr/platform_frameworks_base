{
synchronized (service) {
    HistoryRecord r=getWaitingHistoryRecordLocked();
    if (r != null && r.app != null) {
      if (r.app.debugging) {
        return false;
      }
      if (service.mDidDexOpt) {
        service.mDidDexOpt=false;
        return false;
      }
      if (r.app.instrumentationClass == null) {
        service.appNotRespondingLocked(r.app,r,this,"keyDispatchingTimedOut");
      }
 else {
        Bundle info=new Bundle();
        info.putString("shortMsg","keyDispatchingTimedOut");
        info.putString("longMsg","Timed out while dispatching key event");
        service.finishInstrumentationLocked(r.app,Activity.RESULT_CANCELED,info);
      }
    }
    return true;
  }
}
