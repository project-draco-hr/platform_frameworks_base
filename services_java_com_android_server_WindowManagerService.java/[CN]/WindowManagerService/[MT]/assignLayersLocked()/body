{
  if (mInLayout) {
    if (Config.DEBUG) {
      throw new RuntimeException("Recursive call!");
    }
    return;
  }
  int N=mWindows.size();
  int curBaseLayer=0;
  int curLayer=0;
  int i;
  for (i=0; i < N; i++) {
    WindowState w=(WindowState)mWindows.get(i);
    if (w.mBaseLayer == curBaseLayer) {
      curLayer+=WINDOW_LAYER_MULTIPLIER;
      w.mLayer=curLayer;
    }
 else     if (w.mAttrs.type == TYPE_INPUT_METHOD || w.mAttrs.type == TYPE_INPUT_METHOD_DIALOG) {
      curLayer+=WINDOW_LAYER_MULTIPLIER;
      w.mLayer=curLayer;
    }
 else {
      curBaseLayer=curLayer=w.mBaseLayer;
      w.mLayer=curLayer;
    }
    if (w.mTargetAppToken != null) {
      w.mAnimLayer=w.mLayer + w.mTargetAppToken.animLayerAdjustment;
    }
 else     if (w.mAppToken != null) {
      w.mAnimLayer=w.mLayer + w.mAppToken.animLayerAdjustment;
    }
 else {
      w.mAnimLayer=w.mLayer;
    }
  }
}
