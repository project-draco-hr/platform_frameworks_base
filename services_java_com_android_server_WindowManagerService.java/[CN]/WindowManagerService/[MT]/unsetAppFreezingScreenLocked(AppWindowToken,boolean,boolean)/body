{
  if (wtoken.freezingScreen) {
    if (DEBUG_ORIENTATION)     Log.v(TAG,"Clear freezing of " + wtoken + " force="+ force);
    final int N=wtoken.allAppWindows.size();
    boolean unfrozeWindows=false;
    for (int i=0; i < N; i++) {
      WindowState w=wtoken.allAppWindows.get(i);
      if (w.mAppFreezing) {
        w.mAppFreezing=false;
        if (w.mSurface != null && !w.mOrientationChanging) {
          w.mOrientationChanging=true;
        }
        unfrozeWindows=true;
      }
    }
    if (force || unfrozeWindows) {
      if (DEBUG_ORIENTATION)       Log.v(TAG,"No longer freezing: " + wtoken);
      wtoken.freezingScreen=false;
      mAppsFreezingScreen--;
    }
    if (unfreezeSurfaceNow) {
      if (unfrozeWindows) {
        mLayoutNeeded=true;
        performLayoutAndPlaceSurfacesLocked();
      }
      if (mAppsFreezingScreen == 0 && !mWindowsFreezingScreen) {
        stopFreezingDisplayLocked();
      }
    }
  }
}
