{
  if (injectorUid > 0 && (focus == null || injectorUid != focus.mSession.mUid)) {
    if (mContext.checkPermission(android.Manifest.permission.INJECT_EVENTS,injectorPid,injectorUid) != PackageManager.PERMISSION_GRANTED) {
      Slog.w(TAG,"Permission denied: injecting key event from pid " + injectorPid + " uid "+ injectorUid+ " to window "+ focus+ " owned by uid "+ focus.mSession.mUid);
      return false;
    }
  }
  return true;
}
