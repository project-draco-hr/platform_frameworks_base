{
synchronized (mWindowMap) {
    int idx=findDesiredInputMethodWindowIndexLocked(false);
    WindowState imFocus;
    if (idx > 0) {
      imFocus=mWindows.get(idx - 1);
      if (imFocus != null) {
        if (imFocus.mAttrs.type == LayoutParams.TYPE_APPLICATION_STARTING && imFocus.mAppToken != null) {
          for (int i=0; i < imFocus.mAppToken.windows.size(); i++) {
            WindowState w=imFocus.mAppToken.windows.get(i);
            if (w != imFocus) {
              imFocus=w;
              break;
            }
          }
        }
        if (imFocus.mSession.mClient != null && imFocus.mSession.mClient.asBinder() == client.asBinder()) {
          return true;
        }
        if (mCurrentFocus != null && mCurrentFocus.mSession.mClient != null && mCurrentFocus.mSession.mClient.asBinder() == client.asBinder()) {
          return true;
        }
      }
    }
  }
  return false;
}
