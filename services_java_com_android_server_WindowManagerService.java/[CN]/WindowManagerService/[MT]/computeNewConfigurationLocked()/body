{
synchronized (mWindowMap) {
    if (mDisplay == null) {
      return null;
    }
    Configuration config=new Configuration();
    mQueue.getInputConfiguration(config);
    final int dw=mDisplay.getWidth();
    final int dh=mDisplay.getHeight();
    int orientation=Configuration.ORIENTATION_SQUARE;
    if (dw < dh) {
      orientation=Configuration.ORIENTATION_PORTRAIT;
    }
 else     if (dw > dh) {
      orientation=Configuration.ORIENTATION_LANDSCAPE;
    }
    config.orientation=orientation;
    config.keyboardHidden=Configuration.KEYBOARDHIDDEN_NO;
    mPolicy.adjustConfigurationLw(config);
    Log.i(TAG,"Input configuration changed: " + config);
    long now=SystemClock.uptimeMillis();
    if (mFreezeGcPending != 0) {
      if (now > (mFreezeGcPending + 1000)) {
        mH.removeMessages(H.FORCE_GC);
        Runtime.getRuntime().gc();
        mFreezeGcPending=now;
      }
    }
 else {
      mFreezeGcPending=now;
    }
    return config;
  }
}
