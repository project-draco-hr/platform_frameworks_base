{
  if (!checkCallingPermission(android.Manifest.permission.MANAGE_APP_TOKENS,"moveAppTokensToBottom()")) {
    throw new SecurityException("Requires MANAGE_APP_TOKENS permission");
  }
  final long origId=Binder.clearCallingIdentity();
synchronized (mWindowMap) {
    removeAppTokensLocked(tokens);
    final int N=tokens.size();
    int pos=0;
    for (int i=0; i < N; i++) {
      AppWindowToken wt=findAppWindowToken(tokens.get(i));
      if (wt != null) {
        mAppTokens.add(pos,wt);
        if (mNextAppTransition != WindowManagerPolicy.TRANSIT_UNSET) {
          mToTopApps.remove(wt);
          mToBottomApps.remove(wt);
          mToBottomApps.add(i,wt);
          wt.sendingToTop=false;
          wt.sendingToBottom=true;
        }
        pos++;
      }
    }
    if (mNextAppTransition == WindowManagerPolicy.TRANSIT_UNSET) {
      moveAppWindowsLocked(tokens,0);
    }
  }
  Binder.restoreCallingIdentity(origId);
}
