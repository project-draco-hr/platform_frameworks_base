{
  if (mDisplayFrozen) {
synchronized (mKeyWaiter) {
      mKeyWaiter.mWasFrozen=true;
    }
    return;
  }
  mScreenFrozenLock.acquire();
  long now=SystemClock.uptimeMillis();
  if (mFreezeGcPending != 0) {
    if (now > (mFreezeGcPending + 1000)) {
      mH.removeMessages(H.FORCE_GC);
      Runtime.getRuntime().gc();
      mFreezeGcPending=now;
    }
  }
 else {
    mFreezeGcPending=now;
  }
  mDisplayFrozen=true;
  if (mNextAppTransition != WindowManagerPolicy.TRANSIT_NONE) {
    mNextAppTransition=WindowManagerPolicy.TRANSIT_NONE;
    mAppTransitionReady=true;
  }
  if (PROFILE_ORIENTATION) {
    File file=new File("/data/system/frozen");
    Debug.startMethodTracing(file.toString(),8 * 1024 * 1024);
  }
  Surface.freezeDisplay(0);
}
