{
  final int dw=mDisplay.getWidth();
  final int dh=mDisplay.getHeight();
  boolean changed=false;
  WindowState target=mWallpaperTarget;
  if (target != null) {
    mLastWallpaperX=target.mWallpaperX;
    mLastWallpaperY=target.mWallpaperY;
    int curTokenIndex=mWallpaperTokens.size();
    while (curTokenIndex > 0) {
      curTokenIndex--;
      WindowToken token=mWallpaperTokens.get(curTokenIndex);
      int curWallpaperIndex=token.windows.size();
      while (curWallpaperIndex > 0) {
        curWallpaperIndex--;
        WindowState wallpaper=token.windows.get(curWallpaperIndex);
        if (updateWallpaperOffsetLocked(wallpaper,dw,dh,sync)) {
          wallpaper.computeShownFrameLocked();
          changed=true;
          sync=false;
        }
      }
    }
  }
  return changed;
}
