{
  if (DEBUG_VISIBILITY) {
    RuntimeException e=new RuntimeException();
    if (!HIDE_STACK_CRAWLS)     e.fillInStackTrace();
    Log.v(TAG,"performShow on " + this + ": readyToShow="+ mReadyToShow+ " readyForDisplay="+ isReadyForDisplay()+ " starting="+ (mAttrs.type == TYPE_APPLICATION_STARTING),e);
  }
  if (mReadyToShow && isReadyForDisplay()) {
    if (SHOW_TRANSACTIONS || DEBUG_ORIENTATION)     Log.i(TAG,"  SURFACE " + mSurface + ": SHOW (performShowLocked)");
    if (DEBUG_VISIBILITY)     Log.v(TAG,"Showing " + this + " during animation: policyVis="+ mPolicyVisibility+ " attHidden="+ mAttachedHidden+ " tok.hiddenRequested="+ (mAppToken != null ? mAppToken.hiddenRequested : false)+ " tok.hidden="+ (mAppToken != null ? mAppToken.hidden : false)+ " animating="+ mAnimating+ " tok animating="+ (mAppToken != null ? mAppToken.animating : false));
    if (!showSurfaceRobustlyLocked(this)) {
      return false;
    }
    mLastAlpha=-1;
    mHasDrawn=true;
    mLastHidden=false;
    mReadyToShow=false;
    enableScreenIfNeededLocked();
    applyEnterAnimationLocked(this);
    int i=mChildWindows.size();
    while (i > 0) {
      i--;
      WindowState c=(WindowState)mChildWindows.get(i);
      if (c.mSurface != null && c.mAttachedHidden) {
        c.mAttachedHidden=false;
        c.performShowLocked();
      }
    }
    if (mAttrs.type != TYPE_APPLICATION_STARTING && mAppToken != null) {
      mAppToken.firstWindowDrawn=true;
      if (mAppToken.startingData != null) {
        if (DEBUG_STARTING_WINDOW || DEBUG_ANIM)         Log.v(TAG,"Finish starting " + mToken + ": first real window is shown, no animation");
        if (mAnimation != null) {
          mAnimation=null;
          mAnimating=true;
        }
        mFinishedStarting.add(mAppToken);
        mH.sendEmptyMessage(H.FINISHED_STARTING);
      }
      mAppToken.updateReportedVisibilityLocked();
    }
  }
  return true;
}
