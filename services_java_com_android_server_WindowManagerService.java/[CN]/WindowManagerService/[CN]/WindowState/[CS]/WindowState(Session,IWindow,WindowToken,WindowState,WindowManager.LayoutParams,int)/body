{
  mSession=s;
  mClient=c;
  mToken=token;
  mAttrs.copyFrom(a);
  mViewVisibility=viewVisibility;
  DeathRecipient deathRecipient=new DeathRecipient();
  mAlpha=a.alpha;
  if (localLOGV)   Log.v(TAG,"Window " + this + " client="+ c.asBinder()+ " token="+ token+ " ("+ mAttrs.token+ ")");
  try {
    c.asBinder().linkToDeath(deathRecipient,0);
  }
 catch (  RemoteException e) {
    mDeathRecipient=null;
    mAttachedWindow=null;
    mBaseLayer=0;
    mSubLayer=0;
    return;
  }
  mDeathRecipient=deathRecipient;
  if (mAttrs.type >= mAttrs.FIRST_SUB_WINDOW && mAttrs.type <= mAttrs.LAST_SUB_WINDOW) {
    mBaseLayer=mPolicy.windowTypeToLayerLw(attachedWindow.mAttrs.type) * TYPE_LAYER_MULTIPLIER + TYPE_LAYER_OFFSET;
    mSubLayer=mPolicy.subWindowTypeToLayerLw(a.type);
    mAttachedWindow=attachedWindow;
    mAttachedWindow.mChildWindows.add(this);
  }
 else {
    mBaseLayer=mPolicy.windowTypeToLayerLw(a.type) * TYPE_LAYER_MULTIPLIER + TYPE_LAYER_OFFSET;
    mSubLayer=0;
    mAttachedWindow=null;
  }
  WindowState appWin=this;
  while (appWin.mAttachedWindow != null) {
    appWin=mAttachedWindow;
  }
  WindowToken appToken=appWin.mToken;
  while (appToken.appWindowToken == null) {
    WindowToken parent=mTokenMap.get(appToken.token);
    if (parent == null || appToken == parent) {
      break;
    }
    appToken=parent;
  }
  mAppToken=appToken.appWindowToken;
  mSurface=null;
  mRequestedWidth=0;
  mRequestedHeight=0;
  mLastRequestedWidth=0;
  mLastRequestedHeight=0;
  mReqXPos=0;
  mReqYPos=0;
  mLayer=0;
  mAnimLayer=0;
  mLastLayer=0;
}
