{
  if (MEASURE_LATENCY) {
    lt=new LatencyTimer(100,1000);
  }
  mContext=context;
  mHaveInputMethods=haveInputMethods;
  mLimitedAlphaCompositing=context.getResources().getBoolean(com.android.internal.R.bool.config_sf_limitedAlpha);
  mPowerManager=pm;
  mPowerManager.setPolicy(mPolicy);
  PowerManager pmc=(PowerManager)context.getSystemService(Context.POWER_SERVICE);
  mScreenFrozenLock=pmc.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK,"SCREEN_FROZEN");
  mScreenFrozenLock.setReferenceCounted(false);
  mActivityManager=ActivityManagerNative.getDefault();
  mBatteryStats=BatteryStatsService.getService();
  mWindowAnimationScale=Settings.System.getFloat(context.getContentResolver(),Settings.System.WINDOW_ANIMATION_SCALE,mWindowAnimationScale);
  mTransitionAnimationScale=Settings.System.getFloat(context.getContentResolver(),Settings.System.TRANSITION_ANIMATION_SCALE,mTransitionAnimationScale);
  IntentFilter filter=new IntentFilter();
  filter.addAction(DevicePolicyManager.ACTION_DEVICE_POLICY_MANAGER_STATE_CHANGED);
  mContext.registerReceiver(mBroadcastReceiver,filter);
  int max_events_per_sec=35;
  try {
    max_events_per_sec=Integer.parseInt(SystemProperties.get("windowsmgr.max_events_per_sec"));
    if (max_events_per_sec < 1) {
      max_events_per_sec=35;
    }
  }
 catch (  NumberFormatException e) {
  }
  mMinWaitTimeBetweenTouchEvents=1000 / max_events_per_sec;
  mQueue=new KeyQ();
  mInputThread=new InputDispatcherThread();
  PolicyThread thr=new PolicyThread(mPolicy,this,context,pm);
  thr.start();
synchronized (thr) {
    while (!thr.mRunning) {
      try {
        thr.wait();
      }
 catch (      InterruptedException e) {
      }
    }
  }
  mInputThread.start();
  Watchdog.getInstance().addMonitor(this);
}
