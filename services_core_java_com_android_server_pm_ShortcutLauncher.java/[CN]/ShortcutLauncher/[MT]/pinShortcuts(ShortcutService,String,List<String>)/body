{
  final int idSize=ids.size();
  if (idSize == 0) {
    mPinnedShortcuts.remove(packageName);
  }
 else {
    final ArraySet<String> prevSet=mPinnedShortcuts.get(packageName);
    final ShortcutPackage packageShortcuts=s.getPackageShortcutsLocked(packageName,mUserId);
    final ArraySet<String> newSet=new ArraySet<>();
    for (int i=0; i < idSize; i++) {
      final String id=ids.get(i);
      final ShortcutInfo si=packageShortcuts.findShortcutById(id);
      if (si == null) {
        continue;
      }
      if (si.isDynamic() || (prevSet != null && prevSet.contains(id))) {
        newSet.add(id);
      }
    }
    mPinnedShortcuts.put(packageName,newSet);
  }
  s.getPackageShortcutsLocked(packageName,mUserId).refreshPinnedFlags(s);
}
