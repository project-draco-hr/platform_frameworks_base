{
  if (cookie instanceof Intent) {
    final Intent intent=(Intent)cookie;
    if ((intent.getFlags() & Intent.FLAG_DEBUG_ENCRYPTION_TRIAGED) != 0) {
      flags|=PackageManager.MATCH_ENCRYPTION_DEFAULT;
    }
  }
  if ((flags & (PackageManager.MATCH_ENCRYPTION_UNAWARE_ONLY | PackageManager.MATCH_ENCRYPTION_AWARE_ONLY)) != 0) {
  }
 else {
    if (isUserKeyUnlocked(userId)) {
      flags|=PackageManager.MATCH_ENCRYPTION_AWARE_AND_UNAWARE;
    }
 else {
      flags|=PackageManager.MATCH_ENCRYPTION_AWARE_ONLY;
      if (DEBUG_ENCRYPTION_AWARE && (Binder.getCallingUid() == Process.SYSTEM_UID) && ((flags & PackageManager.MATCH_ENCRYPTION_DEFAULT) == 0)) {
        Log.v(TAG,"Caller hasn't been triaged for FBE; they asked about " + cookie,new Throwable());
      }
    }
  }
  return flags;
}
