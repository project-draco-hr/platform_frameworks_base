{
  try {
    String sdEncKey=SystemKeyStore.getInstance().retrieveKeyHexString(SD_ENCRYPTION_KEYSTORE_NAME);
    if (sdEncKey == null) {
      sdEncKey=SystemKeyStore.getInstance().generateNewKeyHexString(128,SD_ENCRYPTION_ALGORITHM,SD_ENCRYPTION_KEYSTORE_NAME);
      if (sdEncKey == null) {
        Slog.e(TAG,"Failed to create encryption keys");
        return null;
      }
    }
    return sdEncKey;
  }
 catch (  NoSuchAlgorithmException nsae) {
    Slog.e(TAG,"Failed to create encryption keys with exception: " + nsae);
    return null;
  }
catch (  IOException ioe) {
    Slog.e(TAG,"Failed to retrieve encryption keys with exception: " + ioe);
    return null;
  }
}
