{
  int size=pkg.activities.size();
  if (size == 0) {
    Slog.d(TAG,"No activity, so no need to verify any IntentFilter!");
    return;
  }
  Slog.d(TAG,"Checking for userId:" + userId + " if any IntentFilter from the "+ size+ " Activities needs verification ...");
  final int verificationId=mIntentFilterVerificationToken++;
  int count=0;
synchronized (mPackages) {
    for (    PackageParser.Activity a : pkg.activities) {
      for (      ActivityIntentInfo filter : a.intents) {
        boolean needFilterVerification=filter.needsVerification() && !filter.isVerified();
        if (needFilterVerification && needNetworkVerificationLPr(filter)) {
          Slog.d(TAG,"Verification needed for IntentFilter:" + filter.toString());
          mIntentFilterVerifier.addOneIntentFilterVerification(verifierUid,userId,verificationId,filter,pkg.packageName);
          count++;
        }
 else {
          Slog.d(TAG,"No verification needed for IntentFilter:" + filter.toString());
        }
      }
    }
  }
  if (count > 0) {
    mIntentFilterVerifier.startVerifications(userId);
    Slog.d(TAG,"Started " + count + " IntentFilter verification"+ (count > 1 ? "s" : "")+ " for userId:"+ userId+ "!");
  }
 else {
    Slog.d(TAG,"No need to start any IntentFilter verification!");
  }
}
