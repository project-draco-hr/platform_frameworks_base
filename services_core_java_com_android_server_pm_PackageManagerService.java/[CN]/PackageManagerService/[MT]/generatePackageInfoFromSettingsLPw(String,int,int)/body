{
  if (!sUserManager.exists(userId))   return null;
  PackageSetting ps=mSettings.mPackages.get(packageName);
  if (ps != null) {
    PackageParser.Package pkg=ps.pkg;
    if (pkg == null) {
      if ((flags & PackageManager.GET_UNINSTALLED_PACKAGES) == 0) {
        return null;
      }
      pkg=new PackageParser.Package(packageName,null);
      pkg.applicationInfo.packageName=packageName;
      pkg.applicationInfo.flags=ps.pkgFlags | ApplicationInfo.FLAG_IS_DATA_ONLY;
      pkg.applicationInfo.publicSourceDir=ps.resourcePathString;
      pkg.applicationInfo.sourceDir=ps.codePathString;
      pkg.applicationInfo.dataDir=getDataPathForPackage(packageName,0).getPath();
      pkg.applicationInfo.nativeLibraryDir=ps.nativeLibraryPathString;
      pkg.applicationInfo.cpuAbi=ps.cpuAbiString;
    }
    return generatePackageInfo(pkg,flags,userId);
  }
  return null;
}
