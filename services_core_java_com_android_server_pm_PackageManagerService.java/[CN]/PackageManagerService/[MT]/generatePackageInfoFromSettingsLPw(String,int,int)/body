{
  if (!sUserManager.exists(userId))   return null;
  PackageSetting ps=mSettings.mPackages.get(packageName);
  if (ps != null) {
    PackageParser.Package pkg=ps.pkg;
    if (pkg == null) {
      if ((flags & PackageManager.GET_UNINSTALLED_PACKAGES) == 0) {
        return null;
      }
      pkg=new PackageParser.Package(packageName);
      pkg.applicationInfo.packageName=packageName;
      pkg.applicationInfo.flags=ps.pkgFlags | ApplicationInfo.FLAG_IS_DATA_ONLY;
      pkg.applicationInfo.privateFlags=ps.pkgPrivateFlags;
      pkg.applicationInfo.dataDir=getDataPathForPackage(packageName,0).getPath();
      pkg.applicationInfo.primaryCpuAbi=ps.primaryCpuAbiString;
      pkg.applicationInfo.secondaryCpuAbi=ps.secondaryCpuAbiString;
    }
    return generatePackageInfo(pkg,flags,userId);
  }
  return null;
}
