{
  HashSet<String> pkgs=null;
synchronized (mPackages) {
    for (    PackageParser.Package p : mPackages.values()) {
      if (DEBUG_DEXOPT) {
        Log.i(TAG,p.packageName + " mDexOptNeeded=" + p.mDexOptNeeded);
      }
      if (!p.mDexOptNeeded) {
        continue;
      }
      if (pkgs == null) {
        pkgs=new HashSet<String>();
      }
      pkgs.add(p.packageName);
    }
  }
  return pkgs;
}
