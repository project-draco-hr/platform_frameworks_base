{
  if (ps != null && ps.codePath.equals(srcFile) && ps.timeStamp == srcFile.lastModified() && !isCompatSignatureUpdateNeeded(pkg)) {
    if (ps.signatures.mSignatures != null && ps.signatures.mSignatures.length != 0) {
      pkg.mSignatures=ps.signatures.mSignatures;
      return true;
    }
    Slog.w(TAG,"PackageSetting for " + ps.name + " is missing signatures.  Collecting certs again to recover them.");
  }
 else {
    Log.i(TAG,srcFile.toString() + " changed; collecting certs");
  }
  try {
    pp.collectCertificates(pkg,parseFlags);
    pp.collectManifestDigest(pkg);
  }
 catch (  PackageParserException e) {
    mLastScanError=e.error;
    return false;
  }
  return true;
}
