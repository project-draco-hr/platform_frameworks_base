{
  if (ps != null && ps.codePath.equals(srcFile) && ps.timeStamp == srcFile.lastModified() && !isCompatSignatureUpdateNeeded(pkg)) {
    long mSigningKeySetId=ps.keySetData.getProperSigningKeySet();
    if (ps.signatures.mSignatures != null && ps.signatures.mSignatures.length != 0 && mSigningKeySetId != PackageKeySetData.KEYSET_UNASSIGNED) {
      pkg.mSignatures=ps.signatures.mSignatures;
      KeySetManagerService ksms=mSettings.mKeySetManagerService;
synchronized (mPackages) {
        pkg.mSigningKeys=ksms.getPublicKeysFromKeySetLPr(mSigningKeySetId);
      }
      return;
    }
    Slog.w(TAG,"PackageSetting for " + ps.name + " is missing signatures.  Collecting certs again to recover them.");
  }
 else {
    Log.i(TAG,srcFile.toString() + " changed; collecting certs");
  }
  try {
    pp.collectCertificates(pkg,parseFlags);
    pp.collectManifestDigest(pkg);
  }
 catch (  PackageParserException e) {
    throw PackageManagerException.from(e);
  }
}
