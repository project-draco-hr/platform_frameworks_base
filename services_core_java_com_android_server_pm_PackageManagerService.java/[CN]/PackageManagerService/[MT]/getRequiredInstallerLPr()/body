{
  Intent installerIntent=new Intent(Intent.ACTION_INSTALL_PACKAGE);
  installerIntent.addCategory(Intent.CATEGORY_DEFAULT);
  installerIntent.setDataAndType(Uri.fromFile(new File("foo.apk")),PACKAGE_MIME_TYPE);
  final List<ResolveInfo> installers=queryIntentActivities(installerIntent,PACKAGE_MIME_TYPE,0,0);
  String requiredInstaller=null;
  final int N=installers.size();
  for (int i=0; i < N; i++) {
    final ResolveInfo info=installers.get(i);
    final String packageName=info.activityInfo.packageName;
    if (!info.activityInfo.applicationInfo.isSystemApp()) {
      continue;
    }
    if (requiredInstaller != null) {
      throw new RuntimeException("There must be one required installer");
    }
    requiredInstaller=packageName;
  }
  if (requiredInstaller == null) {
    throw new RuntimeException("There must be one required installer");
  }
  return requiredInstaller;
}
