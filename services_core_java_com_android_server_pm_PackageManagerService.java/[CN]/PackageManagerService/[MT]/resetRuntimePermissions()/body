{
  mContext.enforceCallingOrSelfPermission(android.Manifest.permission.REVOKE_RUNTIME_PERMISSIONS,"revokeRuntimePermission");
  int callingUid=Binder.getCallingUid();
  if (callingUid != Process.SYSTEM_UID && callingUid != 0) {
    mContext.enforceCallingOrSelfPermission(android.Manifest.permission.INTERACT_ACROSS_USERS_FULL,"resetRuntimePermissions");
  }
synchronized (mPackages) {
    updatePermissionsLPw(null,null,UPDATE_PERMISSIONS_ALL);
    for (    int userId : UserManagerService.getInstance().getUserIds()) {
      final int packageCount=mPackages.size();
      for (int i=0; i < packageCount; i++) {
        PackageParser.Package pkg=mPackages.valueAt(i);
        if (!(pkg.mExtras instanceof PackageSetting)) {
          continue;
        }
        PackageSetting ps=(PackageSetting)pkg.mExtras;
        resetUserChangesToRuntimePermissionsAndFlagsLocked(ps,userId);
      }
    }
  }
}
