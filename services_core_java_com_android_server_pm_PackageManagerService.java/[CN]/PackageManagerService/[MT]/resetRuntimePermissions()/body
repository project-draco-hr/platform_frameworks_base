{
  mContext.enforceCallingOrSelfPermission(android.Manifest.permission.GRANT_REVOKE_PERMISSIONS,"revokeRuntimePermission");
  int callingUid=Binder.getCallingUid();
  if (callingUid != Process.SYSTEM_UID && callingUid != 0) {
    mContext.enforceCallingOrSelfPermission(android.Manifest.permission.INTERACT_ACROSS_USERS_FULL,"resetRuntimePermissions");
  }
synchronized (mPackages) {
    updatePermissionsLPw(null,null,UPDATE_PERMISSIONS_ALL);
    for (    int userId : UserManagerService.getInstance().getUserIds()) {
      mDefaultPermissionPolicy.grantDefaultPermissions(userId);
    }
  }
}
