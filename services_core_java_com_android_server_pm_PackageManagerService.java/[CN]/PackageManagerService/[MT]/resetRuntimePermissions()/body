{
  mContext.enforceCallingOrSelfPermission(android.Manifest.permission.GRANT_REVOKE_PERMISSIONS,"revokeRuntimePermission");
  int callingUid=Binder.getCallingUid();
  if (callingUid != Process.SYSTEM_UID && callingUid != 0) {
    mContext.enforceCallingOrSelfPermission(android.Manifest.permission.INTERACT_ACROSS_USERS_FULL,"resetRuntimePermissions");
  }
  final int[] userIds;
synchronized (mPackages) {
    updatePermissionsLPw(null,null,UPDATE_PERMISSIONS_ALL);
    final int userCount=UserManagerService.getInstance().getUserIds().length;
    userIds=Arrays.copyOf(UserManagerService.getInstance().getUserIds(),userCount);
  }
  for (  int userId : userIds) {
    mDefaultPermissionPolicy.grantDefaultPermissions(userId);
  }
}
