{
  mContext.enforceCallingOrSelfPermission(android.Manifest.permission.PACKAGE_VERIFICATION_AGENT,"Only package verification agents can extend verification timeouts");
  final PackageVerificationState state=mPendingVerification.get(id);
  final PackageVerificationResponse response=new PackageVerificationResponse(verificationCodeAtTimeout,Binder.getCallingUid());
  if (millisecondsToDelay > PackageManager.MAXIMUM_VERIFICATION_TIMEOUT) {
    millisecondsToDelay=PackageManager.MAXIMUM_VERIFICATION_TIMEOUT;
  }
  if (millisecondsToDelay < 0) {
    millisecondsToDelay=0;
  }
  if ((verificationCodeAtTimeout != PackageManager.VERIFICATION_ALLOW) && (verificationCodeAtTimeout != PackageManager.VERIFICATION_REJECT)) {
    verificationCodeAtTimeout=PackageManager.VERIFICATION_REJECT;
  }
  if ((state != null) && !state.timeoutExtended()) {
    state.extendTimeout();
    final Message msg=mHandler.obtainMessage(PACKAGE_VERIFIED);
    msg.arg1=id;
    msg.obj=response;
    mHandler.sendMessageDelayed(msg,millisecondsToDelay);
  }
}
