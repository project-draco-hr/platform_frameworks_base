{
  PackageParser.Package p;
synchronized (mPackages) {
    p=mPackages.get(packageName);
    if (p == null) {
      return PackageDexOptimizer.DEX_OPT_FAILED;
    }
    mPackageUsage.maybeWriteAsync(mPackages);
    mCompilerStats.maybeWriteAsync();
  }
  long callingId=Binder.clearCallingIdentity();
  try {
synchronized (mInstallLock) {
      return performDexOptInternalWithDependenciesLI(p,checkProfiles,targetCompilerFilter,force);
    }
  }
  finally {
    Binder.restoreCallingIdentity(callingId);
  }
}
