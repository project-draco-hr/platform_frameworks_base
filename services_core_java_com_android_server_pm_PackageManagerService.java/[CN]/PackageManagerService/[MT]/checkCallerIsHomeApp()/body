{
  final Intent intent=new Intent(Intent.ACTION_MAIN);
  intent.addCategory(Intent.CATEGORY_HOME);
  final int callingUid=Binder.getCallingUid();
  final int callingUserId=UserHandle.getCallingUserId();
  final List<ResolveInfo> allHomes=queryIntentActivities(intent,null,0,callingUserId);
  final ResolveInfo preferredHome=findPreferredActivity(intent,null,0,allHomes,0,true,false,false,callingUserId);
  if (preferredHome != null) {
    if (callingUid == preferredHome.activityInfo.applicationInfo.uid) {
      return true;
    }
  }
 else {
    for (    ResolveInfo info : allHomes) {
      if (callingUid == info.activityInfo.applicationInfo.uid) {
        return true;
      }
    }
  }
  return false;
}
