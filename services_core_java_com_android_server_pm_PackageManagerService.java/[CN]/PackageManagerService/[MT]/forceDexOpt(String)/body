{
  enforceSystemOrRoot("forceDexOpt");
  PackageParser.Package pkg;
synchronized (mPackages) {
    pkg=mPackages.get(packageName);
    if (pkg == null) {
      throw new IllegalArgumentException("Unknown package: " + packageName);
    }
  }
synchronized (mInstallLock) {
    final String[] instructionSets=new String[]{getPrimaryInstructionSet(pkg.applicationInfo)};
    Trace.traceBegin(TRACE_TAG_PACKAGE_MANAGER,"dexopt");
    final int res=mPackageDexOptimizer.performDexOpt(pkg,instructionSets,true,pkg.volumeUuid,false);
    Trace.traceEnd(TRACE_TAG_PACKAGE_MANAGER);
    if (res != PackageDexOptimizer.DEX_OPT_PERFORMED) {
      throw new IllegalStateException("Failed to dexopt: " + res);
    }
  }
}
