{
  if (packageName == null) {
    return null;
  }
synchronized (mPackages) {
    final PackageParser.Package pkg=mPackages.get(packageName);
    if (pkg == null) {
      Slog.w(TAG,"KeySet requested for unknown package: " + packageName);
      throw new IllegalArgumentException("Unknown package: " + packageName);
    }
    if (pkg.applicationInfo.uid != Binder.getCallingUid() && Process.SYSTEM_UID != Binder.getCallingUid()) {
      throw new SecurityException("May not access signing KeySet of other apps.");
    }
    KeySetManagerService ksms=mSettings.mKeySetManagerService;
    return new KeySet(ksms.getSigningKeySetByPackageNameLPr(packageName));
  }
}
