{
  if (!sUserManager.exists(userId)) {
    return PackageManager.PERMISSION_DENIED;
  }
synchronized (mPackages) {
    final PackageParser.Package p=mPackages.get(pkgName);
    if (p != null && p.mExtras != null) {
      final PackageSetting ps=(PackageSetting)p.mExtras;
      if (ps.getPermissionsState().hasPermission(permName,userId)) {
        return PackageManager.PERMISSION_GRANTED;
      }
    }
  }
  return PackageManager.PERMISSION_DENIED;
}
