{
synchronized (mPackages) {
    mDirtyUsers.remove(userHandle);
    mUserNeedsBadging.delete(userHandle);
    mSettings.removeUserLPw(userHandle);
    mPendingBroadcasts.remove(userHandle);
    mEphemeralApplicationRegistry.onUserRemovedLPw(userHandle);
  }
synchronized (mInstallLock) {
    final StorageManager storage=mContext.getSystemService(StorageManager.class);
    for (    VolumeInfo vol : storage.getWritablePrivateVolumes()) {
      final String volumeUuid=vol.getFsUuid();
      if (DEBUG_INSTALL)       Slog.d(TAG,"Removing user data on volume " + volumeUuid);
      try {
        mInstaller.removeUserDataDirs(volumeUuid,userHandle);
      }
 catch (      InstallerException e) {
        Slog.w(TAG,"Failed to remove user data",e);
      }
    }
synchronized (mPackages) {
      removeUnusedPackagesLILPw(userManager,userHandle);
    }
  }
}
