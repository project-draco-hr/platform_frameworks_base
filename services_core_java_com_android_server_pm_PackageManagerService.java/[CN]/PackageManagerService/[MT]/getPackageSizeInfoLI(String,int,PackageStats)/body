{
  final PackageSetting ps;
synchronized (mPackages) {
    ps=mSettings.mPackages.get(packageName);
    if (ps == null) {
      Slog.w(TAG,"Failed to find settings for " + packageName);
      return false;
    }
  }
  try {
    mInstaller.getAppSize(ps.volumeUuid,packageName,userId,StorageManager.FLAG_STORAGE_DE | StorageManager.FLAG_STORAGE_CE,ps.getCeDataInode(userId),ps.codePathString,stats);
  }
 catch (  InstallerException e) {
    Slog.w(TAG,String.valueOf(e));
    return false;
  }
  if (isSystemApp(ps) && !isUpdatedSystemApp(ps)) {
    stats.codeSize=0;
  }
  return true;
}
