{
  if (packageName == null || ks == null) {
    return false;
  }
synchronized (mPackages) {
    final PackageParser.Package pkg=mPackages.get(packageName);
    if (pkg == null) {
      Slog.w(TAG,"KeySet requested for unknown package: " + packageName);
      throw new IllegalArgumentException("Unknown package: " + packageName);
    }
    IBinder ksh=ks.getToken();
    if (ksh instanceof KeySetHandle) {
      KeySetManagerService ksms=mSettings.mKeySetManagerService;
      return ksms.packageIsSignedByExactlyLPr(packageName,(KeySetHandle)ksh);
    }
    return false;
  }
}
