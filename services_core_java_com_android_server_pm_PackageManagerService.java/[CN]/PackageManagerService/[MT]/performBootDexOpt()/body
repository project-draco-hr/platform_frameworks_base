{
  enforceSystemOrRoot("Only the system can request dexopt be performed");
  final HashSet<PackageParser.Package> pkgs;
synchronized (mPackages) {
    pkgs=mDeferredDexOpt;
    mDeferredDexOpt=null;
  }
  if (pkgs != null) {
    int i=0;
    for (    PackageParser.Package pkg : pkgs) {
      if (!isFirstBoot()) {
        i++;
        try {
          ActivityManagerNative.getDefault().showBootMessage(mContext.getResources().getString(com.android.internal.R.string.android_upgrading_apk,i,pkgs.size()),true);
        }
 catch (        RemoteException e) {
        }
      }
      PackageParser.Package p=pkg;
synchronized (mInstallLock) {
        if (!p.mDidDexOpt) {
          performDexOptLI(p,false,false,true);
        }
      }
    }
  }
}
