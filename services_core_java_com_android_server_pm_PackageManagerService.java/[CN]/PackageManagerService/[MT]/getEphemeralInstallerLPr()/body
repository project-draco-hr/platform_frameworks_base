{
  Intent installerIntent=new Intent(Intent.ACTION_INSTALL_EPHEMERAL_PACKAGE);
  installerIntent.addCategory(Intent.CATEGORY_DEFAULT);
  installerIntent.setDataAndType(Uri.fromFile(new File("foo.apk")),PACKAGE_MIME_TYPE);
  final List<ResolveInfo> installers=queryIntentActivities(installerIntent,PACKAGE_MIME_TYPE,0,0);
  ComponentName ephemeralInstaller=null;
  final int N=installers.size();
  for (int i=0; i < N; i++) {
    final ResolveInfo info=installers.get(i);
    final String packageName=info.activityInfo.packageName;
    if (!info.activityInfo.applicationInfo.isSystemApp()) {
      if (DEBUG_EPHEMERAL) {
        Slog.d(TAG,"Ephemeral installer is not system app;" + " pkg: " + packageName + ", info:"+ info);
      }
      continue;
    }
    if (ephemeralInstaller != null) {
      throw new RuntimeException("There must only be one ephemeral installer");
    }
    ephemeralInstaller=new ComponentName(packageName,info.activityInfo.name);
  }
  return ephemeralInstaller;
}
