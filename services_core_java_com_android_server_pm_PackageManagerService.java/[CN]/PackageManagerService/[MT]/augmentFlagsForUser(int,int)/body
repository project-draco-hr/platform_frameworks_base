{
  final IActivityManager am=ActivityManagerNative.getDefault();
  if (am == null) {
    return flags;
  }
  final long token=Binder.clearCallingIdentity();
  try {
    if (am.isUserRunning(userId,ActivityManager.FLAG_WITH_AMNESIA)) {
      flags|=PackageManager.FLAG_USER_RUNNING_WITH_AMNESIA;
    }
  }
 catch (  RemoteException e) {
    throw e.rethrowAsRuntimeException();
  }
 finally {
    Binder.restoreCallingIdentity(token);
  }
  return flags;
}
