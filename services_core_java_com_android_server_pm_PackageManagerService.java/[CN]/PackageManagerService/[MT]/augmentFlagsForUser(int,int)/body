{
  if (SystemProperties.getBoolean(StorageManager.PROP_HAS_FBE,false)) {
    final IMountService mount=IMountService.Stub.asInterface(ServiceManager.getService(Context.STORAGE_SERVICE));
    if (mount == null) {
      return flags;
    }
    final long token=Binder.clearCallingIdentity();
    try {
      if (!mount.isUserKeyUnlocked(userId)) {
        flags|=PackageManager.FLAG_USER_RUNNING_WITH_AMNESIA;
      }
    }
 catch (    RemoteException e) {
      throw e.rethrowAsRuntimeException();
    }
 finally {
      Binder.restoreCallingIdentity(token);
    }
  }
  return flags;
}
