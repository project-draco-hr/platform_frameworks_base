{
  if (StorageManager.isFileBasedEncryptionEnabled()) {
    final IMountService mount=IMountService.Stub.asInterface(ServiceManager.getService("mount"));
    if (mount == null) {
      Slog.w(TAG,"Early during boot, assuming locked");
      return false;
    }
    final long token=Binder.clearCallingIdentity();
    try {
      return mount.isUserKeyUnlocked(userId);
    }
 catch (    RemoteException e) {
      throw e.rethrowAsRuntimeException();
    }
 finally {
      Binder.restoreCallingIdentity(token);
    }
  }
 else {
    return true;
  }
}
