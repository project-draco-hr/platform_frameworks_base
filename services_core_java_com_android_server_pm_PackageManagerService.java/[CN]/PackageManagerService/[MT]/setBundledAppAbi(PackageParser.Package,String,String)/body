{
  final boolean has64BitLibs=(new File(apkRoot,new File(LIB64_DIR_NAME,apkName).getPath())).exists();
  final boolean has32BitLibs=(new File(apkRoot,new File(LIB_DIR_NAME,apkName).getPath())).exists();
  if (has64BitLibs && !has32BitLibs) {
    pkg.applicationInfo.primaryCpuAbi=Build.SUPPORTED_64_BIT_ABIS[0];
    pkg.applicationInfo.secondaryCpuAbi=null;
  }
 else   if (has32BitLibs && !has64BitLibs) {
    pkg.applicationInfo.primaryCpuAbi=Build.SUPPORTED_32_BIT_ABIS[0];
    pkg.applicationInfo.secondaryCpuAbi=null;
  }
 else   if (has32BitLibs && has64BitLibs) {
    if ((pkg.applicationInfo.flags & ApplicationInfo.FLAG_MULTIARCH) == 0) {
      Slog.e(TAG,"Package: " + pkg + " has multiple bundled libs, but is not multiarch.");
    }
    if (VMRuntime.is64BitAbi(getPreferredInstructionSet())) {
      pkg.applicationInfo.primaryCpuAbi=Build.SUPPORTED_64_BIT_ABIS[0];
      pkg.applicationInfo.secondaryCpuAbi=Build.SUPPORTED_32_BIT_ABIS[0];
    }
 else {
      pkg.applicationInfo.primaryCpuAbi=Build.SUPPORTED_32_BIT_ABIS[0];
      pkg.applicationInfo.secondaryCpuAbi=Build.SUPPORTED_64_BIT_ABIS[0];
    }
  }
 else {
    pkg.applicationInfo.primaryCpuAbi=null;
    pkg.applicationInfo.secondaryCpuAbi=null;
  }
}
