{
  boolean success=false;
  try {
    final PackageParser.Package res=scanPackageDirtyLI(pkg,policyFlags,scanFlags,currentTime,user);
    success=true;
    return res;
  }
  finally {
    if (!success && (scanFlags & SCAN_DELETE_DATA_ON_FAILURES) != 0) {
      destroyAppDataLIF(pkg,UserHandle.USER_ALL,StorageManager.FLAG_STORAGE_DE | StorageManager.FLAG_STORAGE_CE);
      destroyAppProfilesLIF(pkg,UserHandle.USER_ALL);
    }
  }
}
