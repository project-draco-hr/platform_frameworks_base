{
  boolean success=false;
  try {
    final PackageParser.Package res=scanPackageDirtyLI(pkg,parseFlags,scanFlags,currentTime,user);
    success=true;
    return res;
  }
  finally {
    if (!success && (scanFlags & SCAN_DELETE_DATA_ON_FAILURES) != 0) {
      removeDataDirsLI(pkg.packageName);
    }
  }
}
