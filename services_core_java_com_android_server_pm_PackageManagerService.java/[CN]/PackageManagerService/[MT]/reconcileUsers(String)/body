{
  final File[] files=FileUtils.listFilesOrEmpty(Environment.getDataUserDirectory(volumeUuid));
  for (  File file : files) {
    if (!file.isDirectory())     continue;
    final int userId;
    final UserInfo info;
    try {
      userId=Integer.parseInt(file.getName());
      info=sUserManager.getUserInfo(userId);
    }
 catch (    NumberFormatException e) {
      Slog.w(TAG,"Invalid user directory " + file);
      continue;
    }
    boolean destroyUser=false;
    if (info == null) {
      logCriticalInfo(Log.WARN,"Destroying user directory " + file + " because no matching user was found");
      destroyUser=true;
    }
 else {
      try {
        UserManagerService.enforceSerialNumber(file,info.serialNumber);
      }
 catch (      IOException e) {
        logCriticalInfo(Log.WARN,"Destroying user directory " + file + " because we failed to enforce serial number: "+ e);
        destroyUser=true;
      }
    }
    if (destroyUser) {
synchronized (mInstallLock) {
        try {
          mInstaller.removeUserDataDirs(volumeUuid,userId);
        }
 catch (        InstallerException e) {
          Slog.w(TAG,"Failed to clean up user dirs",e);
        }
      }
    }
  }
}
