{
  mContext.enforceCallingOrSelfPermission(android.Manifest.permission.INTERACT_ACROSS_USERS_FULL,null);
  List<CrossProfileIntentFilter> matches=getMatchingCrossProfileIntentFilters(intent,resolvedType,sourceUserId);
  if (matches != null) {
    int size=matches.size();
    for (int i=0; i < size; i++) {
      if (matches.get(i).getTargetUserId() == targetUserId)       return true;
    }
  }
  ArrayList<String> packageNames=null;
  SparseArray<ArrayList<String>> fromSource=mSettings.mCrossProfilePackageInfo.get(sourceUserId);
  if (fromSource != null) {
    packageNames=fromSource.get(targetUserId);
  }
  if (packageNames.contains(intent.getPackage())) {
    return true;
  }
  List<ResolveInfo> resolveInfos=mActivities.queryIntent(intent,resolvedType,PackageManager.GET_UNINSTALLED_PACKAGES,targetUserId);
  int count=resolveInfos.size();
  for (int i=0; i < count; i++) {
    ResolveInfo resolveInfo=resolveInfos.get(i);
    if (packageNames.contains(resolveInfo.activityInfo.packageName)) {
      return true;
    }
  }
  return false;
}
