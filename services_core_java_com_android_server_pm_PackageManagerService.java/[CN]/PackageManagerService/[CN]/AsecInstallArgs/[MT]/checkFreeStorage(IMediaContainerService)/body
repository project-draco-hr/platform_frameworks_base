{
  final long sizeBytes=imcs.calculateInstalledSize(packagePath,isFwdLocked(),abiOverride);
  final File target;
  if (isExternalAsec()) {
    target=new UserEnvironment(UserHandle.USER_OWNER).getExternalStorageDirectory();
  }
 else {
    target=Environment.getDataDirectory();
  }
  final StorageManager storage=StorageManager.from(mContext);
  return (sizeBytes <= storage.getStorageBytesUntilLow(target));
}
