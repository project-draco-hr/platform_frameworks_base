{
  LayoutTestsAutoRunner runner=(LayoutTestsAutoRunner)getInstrumentation();
  if (runner.mTestPath == null) {
    Log.e(LOGTAG,"No test specified");
    return;
  }
  this.mTestList=new Vector<String>();
  this.mTestListIgnoreResult=new Vector<Boolean>();
  mTestPathPrefix=(new File(LAYOUT_TESTS_ROOT + runner.mTestPath)).getAbsolutePath();
  mRebaselineResults=runner.mRebaseline;
  mJsEngine=runner.mJsEngine == null ? "jsc" : runner.mJsEngine;
  int timeout=runner.mTimeoutInMillis;
  if (timeout <= 0) {
    timeout=DEFAULT_TIMEOUT_IN_MILLIS;
  }
  this.mResultRecorder=new MyTestRecorder(resume);
  if (!resume)   clearTestStatus();
  getTestList();
  if (resume)   resumeTestList();
  TestShellActivity activity=getActivity();
  activity.setDefaultDumpDataType(DumpDataType.EXT_REPR);
  int addr=-1;
  try {
    addr=AdbUtils.resolve("android-browser-test.mtv.corp.google.com");
  }
 catch (  IOException ioe) {
    Log.w(LOGTAG,"error while resolving test host name",ioe);
  }
  if (addr == -1) {
    Log.w(LOGTAG,"failed to resolve test host. http tests will fail.");
  }
  for (int i=0; i < mTestList.size(); i++) {
    String s=mTestList.elementAt(i);
    boolean ignoreResult=mTestListIgnoreResult.elementAt(i);
    FsUtils.updateTestStatus(TEST_STATUS_FILE,s);
    runTestAndWaitUntilDone(activity,s,runner.mTimeoutInMillis,ignoreResult);
  }
  FsUtils.updateTestStatus(TEST_STATUS_FILE,"#DONE");
  ForwardService.getForwardService().stopForwardService();
  activity.finish();
}
