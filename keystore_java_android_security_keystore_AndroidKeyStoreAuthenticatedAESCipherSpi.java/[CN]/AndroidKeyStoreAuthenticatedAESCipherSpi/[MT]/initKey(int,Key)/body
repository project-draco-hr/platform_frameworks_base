{
  if (!(key instanceof AndroidKeyStoreSecretKey)) {
    throw new InvalidKeyException("Unsupported key: " + ((key != null) ? key.getClass().getName() : "null"));
  }
  if (!KeyProperties.KEY_ALGORITHM_AES.equalsIgnoreCase(key.getAlgorithm())) {
    throw new InvalidKeyException("Unsupported key algorithm: " + key.getAlgorithm() + ". Only "+ KeyProperties.KEY_ALGORITHM_AES+ " supported");
  }
  setKey((AndroidKeyStoreSecretKey)key);
}
