{
  if (ap == null)   return false;
  if (DEBUG)   Log.d(TAG,"connect networkId=" + ap.networkId);
  if (ap.networkId < 0) {
    if (ap.hasSecurity) {
      Intent intent=new Intent(Settings.ACTION_WIFI_SETTINGS);
      intent.putExtra(EXTRA_START_CONNECT_SSID,ap.ssid);
      intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
      mContext.startActivityAsUser(intent,new UserHandle(mCurrentUser));
      return true;
    }
 else {
      WifiConfiguration config=new WifiConfiguration();
      config.SSID="\"" + ap.ssid + "\"";
      config.allowedKeyManagement.set(KeyMgmt.NONE);
      mWifiManager.connect(config,mConnectListener);
    }
  }
 else {
    mWifiManager.connect(ap.networkId,mConnectListener);
  }
  return false;
}
