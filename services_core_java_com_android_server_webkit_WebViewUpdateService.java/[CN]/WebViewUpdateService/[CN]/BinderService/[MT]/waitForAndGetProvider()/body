{
  if (Binder.getCallingPid() == Process.myPid()) {
    throw new IllegalStateException("Cannot create a WebView from the SystemServer");
  }
  PackageInfo webViewPackage=null;
  final long NS_PER_MS=1000000;
  final long timeoutTimeMs=System.nanoTime() / NS_PER_MS + WAIT_TIMEOUT_MS;
  boolean webViewReady=false;
  int webViewStatus=WebViewFactory.LIBLOAD_SUCCESS;
synchronized (WebViewUpdateService.this) {
    webViewReady=WebViewUpdateService.this.webViewIsReadyLocked();
    while (!webViewReady) {
      final long timeNowMs=System.nanoTime() / NS_PER_MS;
      if (timeNowMs >= timeoutTimeMs)       break;
      try {
        WebViewUpdateService.this.wait(timeoutTimeMs - timeNowMs);
      }
 catch (      InterruptedException e) {
      }
      webViewReady=WebViewUpdateService.this.webViewIsReadyLocked();
    }
    webViewPackage=WebViewUpdateService.this.mCurrentWebViewPackage;
    if (webViewReady) {
    }
 else     if (!mAnyWebViewInstalled) {
      webViewStatus=WebViewFactory.LIBLOAD_FAILED_LISTING_WEBVIEW_PACKAGES;
    }
 else {
      webViewStatus=WebViewFactory.LIBLOAD_FAILED_WAITING_FOR_RELRO;
    }
  }
  if (!webViewReady)   Slog.w(TAG,"creating relro file timed out");
  return new WebViewProviderResponse(webViewPackage,webViewStatus);
}
