{
  PackageInfo oldPackage=null;
  PackageInfo newPackage=null;
synchronized (this) {
    oldPackage=mCurrentWebViewPackage;
    updateUserSetting(newProviderName);
    try {
      newPackage=findPreferredWebViewPackage();
      if (oldPackage != null && newPackage.packageName.equals(oldPackage.packageName)) {
        updateUserSetting(newPackage.packageName);
        return newPackage.packageName;
      }
    }
 catch (    WebViewFactory.MissingWebViewPackageException e) {
      Slog.e(TAG,"Tried to change WebView provider but failed to fetch WebView package " + e);
      return newProviderName;
    }
    onWebViewProviderChanged(newPackage);
  }
  try {
    if (oldPackage != null) {
      ActivityManagerNative.getDefault().killPackageDependents(oldPackage.packageName,UserHandle.USER_ALL);
    }
  }
 catch (  RemoteException e) {
  }
  return newPackage.packageName;
}
