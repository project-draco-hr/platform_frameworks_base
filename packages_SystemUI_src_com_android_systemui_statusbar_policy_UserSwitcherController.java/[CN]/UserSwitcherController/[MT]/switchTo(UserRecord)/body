{
  int id;
  if (record.isGuest && record.info == null) {
    id=mUserManager.createGuest(mContext,mContext.getString(R.string.guest_nickname)).id;
  }
 else   if (record.isAddUser) {
    id=mUserManager.createUser(mContext.getString(R.string.user_new_user_name),0).id;
  }
 else {
    id=record.info.id;
  }
  if (ActivityManager.getCurrentUser() == id) {
    if (record.isGuest) {
      showExitGuestDialog(id);
    }
    return;
  }
  switchToUserId(id);
}
