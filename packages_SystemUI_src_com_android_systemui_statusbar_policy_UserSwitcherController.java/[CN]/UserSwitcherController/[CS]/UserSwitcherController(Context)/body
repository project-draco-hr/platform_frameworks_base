{
  mContext=context;
  mGuestResumeSessionReceiver.register(context);
  mUserManager=UserManager.get(context);
  IntentFilter filter=new IntentFilter();
  filter.addAction(Intent.ACTION_USER_ADDED);
  filter.addAction(Intent.ACTION_USER_REMOVED);
  filter.addAction(Intent.ACTION_USER_INFO_CHANGED);
  filter.addAction(Intent.ACTION_USER_SWITCHED);
  filter.addAction(Intent.ACTION_USER_STOPPING);
  mContext.registerReceiverAsUser(mReceiver,UserHandle.OWNER,filter,null,null);
  mSimpleUserSwitcher=Settings.Global.getInt(context.getContentResolver(),SIMPLE_USER_SWITCHER_GLOBAL_SETTING,0) != 0;
  mContext.getContentResolver().registerContentObserver(Settings.Global.getUriFor(SIMPLE_USER_SWITCHER_GLOBAL_SETTING),true,mSimpleUserSwitcherObserver);
  refreshUsers(UserHandle.USER_NULL);
}
