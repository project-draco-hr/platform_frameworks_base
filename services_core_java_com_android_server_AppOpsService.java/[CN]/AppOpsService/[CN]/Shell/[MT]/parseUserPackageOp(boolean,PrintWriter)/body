{
  userId=UserHandle.USER_CURRENT;
  packageName=null;
  opStr=null;
  for (String argument; (argument=getNextArg()) != null; ) {
    if ("--user".equals(argument)) {
      userId=UserHandle.parseUserArg(getNextArgRequired());
    }
 else {
      if (packageName == null) {
        packageName=argument;
      }
 else       if (opStr == null) {
        opStr=argument;
        break;
      }
    }
  }
  if (packageName == null) {
    err.println("Error: Package name not specified.");
    return -1;
  }
 else   if (opStr == null && reqOp) {
    err.println("Error: Operation not specified.");
    return -1;
  }
  if (opStr != null) {
    op=strOpToOp(opStr,err);
    if (op < 0) {
      return -1;
    }
  }
 else {
    op=AppOpsManager.OP_NONE;
  }
  if (userId == UserHandle.USER_CURRENT) {
    userId=ActivityManager.getCurrentUser();
  }
  if ("root".equals(packageName)) {
    packageUid=0;
  }
 else {
    packageUid=AppGlobals.getPackageManager().getPackageUid(packageName,userId);
  }
  if (packageUid < 0) {
    err.println("Error: No UID for " + packageName + " in user "+ userId);
    return -1;
  }
  return 0;
}
