{
  verifyIncomingOp(code);
  final int proxyUid=Binder.getCallingUid();
  String resolveProxyPackageName=resolvePackageName(proxyUid,proxyPackageName);
  if (resolveProxyPackageName == null) {
    return AppOpsManager.MODE_IGNORED;
  }
  final int proxyMode=noteOperationUnchecked(code,proxyUid,resolveProxyPackageName,-1,null);
  if (proxyMode != AppOpsManager.MODE_ALLOWED || Binder.getCallingUid() == proxiedUid) {
    return proxyMode;
  }
  String resolveProxiedPackageName=resolvePackageName(proxiedUid,proxiedPackageName);
  if (resolveProxiedPackageName == null) {
    return AppOpsManager.MODE_IGNORED;
  }
  return noteOperationUnchecked(code,proxiedUid,resolveProxiedPackageName,proxyMode,resolveProxyPackageName);
}
