{
  if (Binder.getCallingPid() != Process.myPid()) {
    mContext.enforcePermission(Manifest.permission.MANAGE_APP_OPS_RESTRICTIONS,Binder.getCallingPid(),Binder.getCallingUid(),null);
  }
  if (userHandle != UserHandle.getCallingUserId()) {
    if (mContext.checkCallingOrSelfPermission(Manifest.permission.INTERACT_ACROSS_USERS_FULL) != PackageManager.PERMISSION_GRANTED && mContext.checkCallingOrSelfPermission(Manifest.permission.INTERACT_ACROSS_USERS) != PackageManager.PERMISSION_GRANTED) {
      throw new SecurityException("Need INTERACT_ACROSS_USERS_FULL or" + " INTERACT_ACROSS_USERS to interact cross user ");
    }
  }
  verifyIncomingOp(code);
  Preconditions.checkNotNull(token);
  setUserRestrictionNoCheck(code,restricted,token,userHandle,exceptionPackages);
}
