{
  if (DBG)   Log.d(TAG,"setScorerInternal(" + packageName + ")");
  long token=Binder.clearCallingIdentity();
  try {
    unbindFromScoringServiceIfNeeded();
    clearInternal();
    NetworkScorerAppData prevScorer=NetworkScorerAppManager.getActiveScorer(mContext);
    boolean result=NetworkScorerAppManager.setActiveScorer(mContext,packageName);
    bindToScoringServiceIfNeeded();
    if (result) {
      registerPackageMonitorIfNeeded();
      Intent intent=new Intent(NetworkScoreManager.ACTION_SCORER_CHANGED);
      if (prevScorer != null) {
        intent.setPackage(prevScorer.mPackageName);
        mContext.sendBroadcastAsUser(intent,UserHandle.SYSTEM);
      }
      if (packageName != null) {
        intent.putExtra(NetworkScoreManager.EXTRA_NEW_SCORER,packageName);
        intent.setPackage(packageName);
        mContext.sendBroadcastAsUser(intent,UserHandle.SYSTEM);
      }
    }
    return result;
  }
  finally {
    Binder.restoreCallingIdentity(token);
  }
}
