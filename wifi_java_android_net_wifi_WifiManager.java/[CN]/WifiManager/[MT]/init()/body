{
  mWifiServiceMessenger=getWifiServiceMessenger();
  if (mWifiServiceMessenger == null) {
    mAsyncChannel=null;
    return;
  }
synchronized (sThreadRefLock) {
    if (++sThreadRefCount == 1) {
      sHandlerThread=new HandlerThread("WifiManager");
      sHandlerThread.start();
    }
  }
  mHandler=new ServiceHandler(sHandlerThread.getLooper());
  mAsyncChannel.connect(mContext,mHandler,mWifiServiceMessenger);
  try {
    mConnected.await();
  }
 catch (  InterruptedException e) {
    Log.e(TAG,"interrupted wait at init");
  }
}
