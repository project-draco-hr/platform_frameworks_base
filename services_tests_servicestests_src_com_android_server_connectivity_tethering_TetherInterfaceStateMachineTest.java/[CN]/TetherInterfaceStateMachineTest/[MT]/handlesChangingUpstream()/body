{
  initTetheredStateMachine(false,UPSTREAM_IFACE);
  dispatchTetherConnectionChanged(UPSTREAM_IFACE2);
  InOrder inOrder=inOrder(mNMService,mStatsService);
  inOrder.verify(mStatsService).forceUpdate();
  inOrder.verify(mNMService).stopInterfaceForwarding(IFACE_NAME,UPSTREAM_IFACE);
  inOrder.verify(mNMService).disableNat(IFACE_NAME,UPSTREAM_IFACE);
  inOrder.verify(mNMService).enableNat(IFACE_NAME,UPSTREAM_IFACE2);
  inOrder.verify(mNMService).startInterfaceForwarding(IFACE_NAME,UPSTREAM_IFACE2);
  verifyNoMoreInteractions(mNMService,mStatsService,mTetherHelper);
  assertFalse("Should not be tetherable when tethered",mTestedSm.isAvailable());
  assertTrue("Should be in a tethered state",mTestedSm.isTethered());
  assertFalse("Should have no errors when tethered",mTestedSm.isErrored());
}
