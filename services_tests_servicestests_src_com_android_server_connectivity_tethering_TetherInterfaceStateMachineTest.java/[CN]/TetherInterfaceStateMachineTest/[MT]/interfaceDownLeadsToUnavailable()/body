{
  for (  boolean shouldThrow : new boolean[]{true,false}) {
    initTetheredStateMachine(ConnectivityManager.TETHERING_USB,null);
    if (shouldThrow) {
      doThrow(RemoteException.class).when(mNMService).untetherInterface(IFACE_NAME);
    }
    dispatchCommand(TetherInterfaceStateMachine.CMD_INTERFACE_DOWN);
    InOrder usbTeardownOrder=inOrder(mNMService,mInterfaceConfiguration,mTetherHelper);
    usbTeardownOrder.verify(mInterfaceConfiguration).setInterfaceDown();
    usbTeardownOrder.verify(mNMService).setInterfaceConfig(IFACE_NAME,mInterfaceConfiguration);
    usbTeardownOrder.verify(mTetherHelper).notifyInterfaceStateChange(IFACE_NAME,mTestedSm,STATE_UNAVAILABLE,TETHER_ERROR_NO_ERROR);
  }
}
