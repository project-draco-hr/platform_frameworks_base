{
  final String system=SystemProperties.get("ro.build.fingerprint");
  final String vendor=SystemProperties.get("ro.vendor.build.fingerprint");
  final String bootimage=SystemProperties.get("ro.bootimage.build.fingerprint");
  if (TextUtils.isEmpty(system)) {
    Slog.e(TAG,"Required ro.build.fingerprint is empty!");
    return false;
  }
  if (!TextUtils.isEmpty(vendor)) {
    if (!Objects.equals(system,vendor)) {
      Slog.e(TAG,"Mismatched fingerprints; system reported " + system + " but vendor reported "+ vendor);
      return false;
    }
  }
  if (!TextUtils.isEmpty(bootimage)) {
    if (!Objects.equals(vendor,bootimage)) {
      Slog.e(TAG,"Mismatched fingerprints; system and vendor reported " + system + " but bootimage reported "+ bootimage);
      return false;
    }
  }
  return true;
}
