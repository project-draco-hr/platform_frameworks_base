{
  if (mInvisible) {
    return;
  }
  int mul=(int)((1.0f - mDimAlpha) * 255);
  if (mBitmapShader != null) {
    if (mDisabledInSafeMode) {
      TMP_FILTER_COLOR_MATRIX.setSaturation(0);
      float scale=1f - mDimAlpha;
      float[] mat=TMP_BRIGHTNESS_COLOR_MATRIX.getArray();
      mat[0]=scale;
      mat[6]=scale;
      mat[12]=scale;
      mat[4]=mDimAlpha * 255f;
      mat[9]=mDimAlpha * 255f;
      mat[14]=mDimAlpha * 255f;
      TMP_FILTER_COLOR_MATRIX.preConcat(TMP_BRIGHTNESS_COLOR_MATRIX);
      ColorMatrixColorFilter filter=new ColorMatrixColorFilter(TMP_FILTER_COLOR_MATRIX);
      mDrawPaint.setColorFilter(filter);
      mBgFillPaint.setColorFilter(filter);
    }
 else {
      mLightingColorFilter.setColorMultiply(Color.argb(255,mul,mul,mul));
      mDrawPaint.setColorFilter(mLightingColorFilter);
      mDrawPaint.setColor(0xFFffffff);
      mBgFillPaint.setColorFilter(mLightingColorFilter);
    }
  }
 else {
    int grey=mul;
    mDrawPaint.setColorFilter(null);
    mDrawPaint.setColor(Color.argb(255,grey,grey,grey));
  }
  if (!mInvisible) {
    invalidate();
  }
}
