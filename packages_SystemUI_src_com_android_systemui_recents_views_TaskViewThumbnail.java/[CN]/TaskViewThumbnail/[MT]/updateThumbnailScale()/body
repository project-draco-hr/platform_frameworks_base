{
  mThumbnailScale=1f;
  if (mBitmapShader != null) {
    if (mThumbnailInfo != null) {
      System.out.println(mTask.title + " bounds: " + mThumbnailInfo.taskWidth+ "x"+ mThumbnailInfo.taskHeight+ ", "+ mThumbnailInfo.screenOrientation);
    }
    boolean isStackTask=!mTask.isFreeformTask() || mTask.bounds == null;
    if (mTaskViewRect.isEmpty() || mThumbnailInfo == null || mThumbnailInfo.taskWidth == 0 || mThumbnailInfo.taskHeight == 0) {
      mThumbnailScale=0f;
    }
 else     if (isStackTask) {
      float invThumbnailScale=1f / mFullscreenThumbnailScale;
      if (mOrientation == Configuration.ORIENTATION_PORTRAIT) {
        if (mThumbnailInfo.screenOrientation == Configuration.ORIENTATION_PORTRAIT) {
          mThumbnailScale=(float)mTaskViewRect.width() / mThumbnailRect.width();
        }
 else {
          mThumbnailScale=invThumbnailScale * ((float)mTaskViewRect.width() / mDisplayRect.width());
        }
      }
 else {
        mThumbnailScale=invThumbnailScale;
      }
    }
 else {
      mThumbnailScale=Math.min((float)mTaskViewRect.width() / mThumbnailRect.width(),(float)mTaskViewRect.height() / mThumbnailRect.height());
    }
    mScaleMatrix.setScale(mThumbnailScale,mThumbnailScale);
    mBitmapShader.setLocalMatrix(mScaleMatrix);
  }
  if (!mInvisible) {
    invalidate();
  }
}
