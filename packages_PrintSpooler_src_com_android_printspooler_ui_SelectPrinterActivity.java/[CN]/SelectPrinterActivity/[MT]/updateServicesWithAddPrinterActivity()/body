{
  mAddPrinterServices.clear();
  PrintManager printManager=(PrintManager)getSystemService(Context.PRINT_SERVICE);
  List<PrintServiceInfo> enabledServices=printManager.getEnabledPrintServices();
  if (enabledServices.isEmpty()) {
    return;
  }
  final int enabledServiceCount=enabledServices.size();
  for (int i=0; i < enabledServiceCount; i++) {
    PrintServiceInfo enabledService=enabledServices.get(i);
    if (TextUtils.isEmpty(enabledService.getAddPrintersActivityName())) {
      continue;
    }
    ServiceInfo serviceInfo=enabledService.getResolveInfo().serviceInfo;
    ComponentName addPrintersComponentName=new ComponentName(serviceInfo.packageName,enabledService.getAddPrintersActivityName());
    Intent addPritnersIntent=new Intent().setComponent(addPrintersComponentName);
    PackageManager pm=getPackageManager();
    List<ResolveInfo> resolvedActivities=pm.queryIntentActivities(addPritnersIntent,0);
    if (!resolvedActivities.isEmpty()) {
      ActivityInfo activityInfo=resolvedActivities.get(0).activityInfo;
      if (activityInfo.exported && (activityInfo.permission == null || pm.checkPermission(activityInfo.permission,getPackageName()) == PackageManager.PERMISSION_GRANTED)) {
        mAddPrinterServices.add(enabledService);
      }
    }
  }
}
