{
synchronized (this) {
    if (mScannerId == -1)     return;
    try {
      mBluetoothGatt.registerScanner(this);
      wait(REGISTRATION_CALLBACK_TIMEOUT_MILLIS);
    }
 catch (    InterruptedException|RemoteException e) {
      Log.e(TAG,"application registeration exception",e);
      postCallbackError(mScanCallback,ScanCallback.SCAN_FAILED_INTERNAL_ERROR);
    }
    if (mScannerId > 0) {
      mLeScanClients.put(mScanCallback,this);
    }
 else {
      if (mScannerId == 0)       mScannerId=-1;
      postCallbackError(mScanCallback,ScanCallback.SCAN_FAILED_APPLICATION_REGISTRATION_FAILED);
    }
  }
}
