{
  final SynthesisMessageParams param=(SynthesisMessageParams)msg;
  if (param.getAudioTrack() == null) {
    Log.w(TAG,"Error : null audio track in handleDataAvailable.");
    return;
  }
  if (param != mLastSynthesisRequest) {
    Log.e(TAG,"Call to dataAvailable without done() / start()");
    return;
  }
  final AudioTrack audioTrack=param.getAudioTrack();
  final SynthesisMessageParams.ListEntry bufferCopy=param.getNextBuffer();
  if (bufferCopy == null) {
    Log.e(TAG,"No buffers available to play.");
    return;
  }
  int playState=audioTrack.getPlayState();
  if (playState == AudioTrack.PLAYSTATE_STOPPED) {
    if (DBG)     Log.d(TAG,"AudioTrack stopped, restarting : " + audioTrack.hashCode());
    audioTrack.play();
  }
  int count=0;
  while (count < bufferCopy.mLength) {
    int written=audioTrack.write(bufferCopy.mBytes,count,bufferCopy.mLength);
    if (written <= 0) {
      break;
    }
    count+=written;
  }
}
