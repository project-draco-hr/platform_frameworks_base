{
  if (b == null) {
    throw new NullPointerException("buffer is null");
  }
  if ((offset | length) < 0 || length > b.length - offset) {
    throw new ArrayIndexOutOfBoundsException("index outof bound");
  }
  ensureOpen();
  int currentDataLength=data.length - index;
  int remainReadLength=length;
  int offset1=offset;
  int result=0;
  while (currentDataLength <= remainReadLength) {
    System.arraycopy(data,index,b,offset1,currentDataLength);
    index+=currentDataLength;
    offset1+=currentDataLength;
    result+=currentDataLength;
    remainReadLength-=currentDataLength;
    if (!parent.continueOperation(true,true)) {
      return result == 0 ? -1 : result;
    }
    currentDataLength=data.length - index;
  }
  if (remainReadLength > 0) {
    System.arraycopy(data,index,b,offset1,remainReadLength);
    index+=remainReadLength;
    result+=remainReadLength;
  }
  return result;
}
