{
  Context context=mContext;
  mKeyboardName=context.getString(com.android.internal.R.string.config_packagedKeyboardName);
  if (TextUtils.isEmpty(mKeyboardName)) {
    if (DEBUG) {
      Slog.d(TAG,"No packaged keyboard name given.");
    }
    return;
  }
  LocalBluetoothManager bluetoothManager=LocalBluetoothManager.getInstance(context,null);
  if (bluetoothManager == null) {
    if (DEBUG) {
      Slog.e(TAG,"Failed to retrieve LocalBluetoothManager instance");
    }
    return;
  }
  mEnabled=true;
  mCachedDeviceManager=bluetoothManager.getCachedDeviceManager();
  mLocalBluetoothAdapter=bluetoothManager.getBluetoothAdapter();
  mProfileManager=bluetoothManager.getProfileManager();
  bluetoothManager.getEventManager().registerCallback(new BluetoothCallbackHandler());
  Utils.setErrorListener(new BluetoothErrorListener());
  InputManager im=context.getSystemService(InputManager.class);
  im.registerOnTabletModeChangedListener(this,mHandler);
  mInTabletMode=im.isInTabletMode();
  processKeyboardState();
  mUIHandler=new KeyboardUIHandler();
}
