{
  if (mStoredCredentialType != 0) {
    return mStoredCredentialType;
  }
  CredentialHash pattern=readPatternHash(userId);
  if (pattern == null) {
    if (readPasswordHash(userId) != null) {
      mStoredCredentialType=CredentialHash.TYPE_PASSWORD;
    }
 else {
      mStoredCredentialType=CredentialHash.TYPE_NONE;
    }
  }
 else {
    CredentialHash password=readPasswordHash(userId);
    if (password != null) {
      if (password.version == CredentialHash.VERSION_GATEKEEPER) {
        mStoredCredentialType=CredentialHash.TYPE_PASSWORD;
      }
 else {
        mStoredCredentialType=CredentialHash.TYPE_PATTERN;
      }
    }
 else {
      mStoredCredentialType=CredentialHash.TYPE_PATTERN;
    }
  }
  return mStoredCredentialType;
}
