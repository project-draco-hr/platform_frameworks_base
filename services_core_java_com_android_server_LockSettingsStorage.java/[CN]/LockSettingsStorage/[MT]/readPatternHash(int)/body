{
  byte[] stored=readFile(getLockPatternFilename(userId));
  if (stored != null && stored.length > 0) {
    return new CredentialHash(stored,CredentialHash.VERSION_GATEKEEPER);
  }
  stored=readFile(getBaseZeroLockPatternFilename(userId));
  if (stored != null && stored.length > 0) {
    return new CredentialHash(stored,true);
  }
  stored=readFile(getLegacyLockPatternFilename(userId));
  if (stored != null && stored.length > 0) {
    return new CredentialHash(stored,CredentialHash.VERSION_LEGACY);
  }
  return null;
}
