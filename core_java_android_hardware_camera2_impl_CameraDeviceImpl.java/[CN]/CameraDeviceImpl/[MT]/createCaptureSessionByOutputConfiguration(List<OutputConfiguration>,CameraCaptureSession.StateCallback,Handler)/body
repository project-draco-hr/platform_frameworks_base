{
synchronized (mInterfaceLock) {
    if (DEBUG) {
      Log.d(TAG,"createCaptureSession");
    }
    checkIfCameraClosedOrInError();
    if (mCurrentSession != null) {
      mCurrentSession.replaceSessionClose();
    }
    boolean configureSuccess=true;
    CameraAccessException pendingException=null;
    List<Surface> outSurfaces=new ArrayList<>(outputConfigurations.size());
    for (    OutputConfiguration config : outputConfigurations) {
      outSurfaces.add(config.getSurface());
    }
    try {
      configureSuccess=configureOutputsChecked(outSurfaces);
    }
 catch (    CameraAccessException e) {
      configureSuccess=false;
      pendingException=e;
      if (DEBUG) {
        Log.v(TAG,"createCaptureSession - failed with exception ",e);
      }
    }
    CameraCaptureSessionImpl newSession=new CameraCaptureSessionImpl(mNextSessionId++,outSurfaces,callback,handler,this,mDeviceHandler,configureSuccess);
    mCurrentSession=newSession;
    if (pendingException != null) {
      throw pendingException;
    }
    mSessionStateCallback=mCurrentSession.getDeviceStateCallback();
  }
}
