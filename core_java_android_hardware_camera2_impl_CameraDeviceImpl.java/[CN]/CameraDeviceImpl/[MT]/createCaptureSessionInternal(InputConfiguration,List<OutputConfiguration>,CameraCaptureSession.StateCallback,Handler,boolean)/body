{
synchronized (mInterfaceLock) {
    if (DEBUG) {
      Log.d(TAG,"createCaptureSessionInternal");
    }
    checkIfCameraClosedOrInError();
    if (isConstrainedHighSpeed && inputConfig != null) {
      throw new IllegalArgumentException("Constrained high speed session doesn't support" + " input configuration yet.");
    }
    if (mCurrentSession != null) {
      mCurrentSession.replaceSessionClose();
    }
    boolean configureSuccess=true;
    CameraAccessException pendingException=null;
    Surface input=null;
    try {
      configureSuccess=configureStreamsChecked(inputConfig,outputConfigurations,isConstrainedHighSpeed);
      if (inputConfig != null) {
        input=new Surface();
        mRemoteDevice.getInputSurface(input);
      }
    }
 catch (    CameraAccessException e) {
      configureSuccess=false;
      pendingException=e;
      input=null;
      if (DEBUG) {
        Log.v(TAG,"createCaptureSession - failed with exception ",e);
      }
    }
catch (    RemoteException e) {
      return;
    }
    List<Surface> outSurfaces=new ArrayList<>(outputConfigurations.size());
    for (    OutputConfiguration config : outputConfigurations) {
      outSurfaces.add(config.getSurface());
    }
    CameraCaptureSessionImpl newSession=new CameraCaptureSessionImpl(mNextSessionId++,input,outSurfaces,callback,handler,this,mDeviceHandler,configureSuccess,isConstrainedHighSpeed);
    mCurrentSession=newSession;
    if (pendingException != null) {
      throw pendingException;
    }
    mSessionStateCallback=mCurrentSession.getDeviceStateCallback();
  }
}
