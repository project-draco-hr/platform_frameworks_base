{
  String opt;
  String filename=null;
  while ((opt=nextOption()) != null) {
    if (opt.equals("--dump-file")) {
      filename=nextArgRequired();
    }
 else {
      System.err.println("Error: Unknown option: " + opt);
      return;
    }
  }
  if (filename == null) {
    System.err.println("Error: Specify filename to dump logs to.");
    return;
  }
  ParcelFileDescriptor fd=null;
  try {
    File file=new File(filename);
    file.delete();
    fd=openForSystemServer(file,ParcelFileDescriptor.MODE_CREATE | ParcelFileDescriptor.MODE_TRUNCATE | ParcelFileDescriptor.MODE_READ_WRITE);
  }
 catch (  FileNotFoundException e) {
    System.err.println("Error: Unable to open file: " + filename);
    System.err.println("Consider using a file under /data/local/tmp/");
    return;
  }
  ;
  if (!mAm.stopBinderTrackingAndDump(fd)) {
    throw new AndroidException("STOP TRACE FAILED.");
  }
  System.out.println("Stopped IPC tracing. Dumping logs to: " + filename);
}
