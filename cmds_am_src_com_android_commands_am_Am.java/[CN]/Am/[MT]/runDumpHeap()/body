{
  boolean managed=!"-n".equals(nextOption());
  String process=nextArgRequired();
  String heapFile=nextArgRequired();
  ParcelFileDescriptor fd=null;
  try {
    fd=ParcelFileDescriptor.open(new File(heapFile),ParcelFileDescriptor.MODE_CREATE | ParcelFileDescriptor.MODE_TRUNCATE | ParcelFileDescriptor.MODE_READ_WRITE);
  }
 catch (  FileNotFoundException e) {
    System.err.println("Error: Unable to open file: " + heapFile);
    return;
  }
  if (!mAm.dumpHeap(process,managed,heapFile,fd)) {
    throw new AndroidException("HEAP DUMP FAILED on process " + process);
  }
}
