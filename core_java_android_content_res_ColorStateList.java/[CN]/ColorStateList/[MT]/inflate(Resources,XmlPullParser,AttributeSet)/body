{
  int type;
  final int innerDepth=parser.getDepth() + 1;
  int depth;
  int listAllocated=20;
  int listSize=0;
  int[] colorList=new int[listAllocated];
  int[][] stateSpecList=new int[listAllocated][];
  while ((type=parser.next()) != XmlPullParser.END_DOCUMENT && ((depth=parser.getDepth()) >= innerDepth || type != XmlPullParser.END_TAG)) {
    if (type != XmlPullParser.START_TAG) {
      continue;
    }
    if (depth > innerDepth || !parser.getName().equals("item")) {
      continue;
    }
    int colorRes=0;
    int color=0xffff0000;
    boolean haveColor=false;
    int i;
    int j=0;
    final int numAttrs=attrs.getAttributeCount();
    int[] stateSpec=new int[numAttrs];
    for (i=0; i < numAttrs; i++) {
      final int stateResId=attrs.getAttributeNameResource(i);
      if (stateResId == 0)       break;
      if (stateResId == com.android.internal.R.attr.color) {
        colorRes=attrs.getAttributeResourceValue(i,0);
        if (colorRes == 0) {
          color=attrs.getAttributeIntValue(i,color);
          haveColor=true;
        }
      }
 else {
        stateSpec[j++]=attrs.getAttributeBooleanValue(i,false) ? stateResId : -stateResId;
      }
    }
    stateSpec=StateSet.trimStateSet(stateSpec,j);
    if (colorRes != 0) {
      color=r.getColor(colorRes);
    }
 else     if (!haveColor) {
      throw new XmlPullParserException(parser.getPositionDescription() + ": <item> tag requires a 'android:color' attribute.");
    }
    if (listSize == 0 || stateSpec.length == 0) {
      mDefaultColor=color;
    }
    if (listSize + 1 >= listAllocated) {
      listAllocated=ArrayUtils.idealIntArraySize(listSize + 1);
      int[] ncolor=new int[listAllocated];
      System.arraycopy(colorList,0,ncolor,0,listSize);
      int[][] nstate=new int[listAllocated][];
      System.arraycopy(stateSpecList,0,nstate,0,listSize);
      colorList=ncolor;
      stateSpecList=nstate;
    }
    colorList[listSize]=color;
    stateSpecList[listSize]=stateSpec;
    listSize++;
  }
  mColors=new int[listSize];
  mStateSpecs=new int[listSize][];
  System.arraycopy(colorList,0,mColors,0,listSize);
  System.arraycopy(stateSpecList,0,mStateSpecs,0,listSize);
}
