{
  if (mInputChannel != null) {
    throw new IllegalStateException("Window already has an input channel.");
  }
  String name=makeInputChannelName();
  InputChannel[] inputChannels=InputChannel.openInputChannelPair(name);
  mInputChannel=inputChannels[0];
  mClientChannel=inputChannels[1];
  mInputWindowHandle.inputChannel=inputChannels[0];
  if (outInputChannel != null) {
    mClientChannel.transferTo(outInputChannel);
    mClientChannel.dispose();
    mClientChannel=null;
  }
 else {
    mDeadWindowEventReceiver=new DeadWindowEventReceiver(mClientChannel);
  }
  mService.mInputManager.registerInputChannel(mInputChannel,mInputWindowHandle);
}
