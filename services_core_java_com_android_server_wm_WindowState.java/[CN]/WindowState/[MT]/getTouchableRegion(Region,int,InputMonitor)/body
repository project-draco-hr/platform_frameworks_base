{
  final boolean modal=(flags & (WindowManager.LayoutParams.FLAG_NOT_TOUCH_MODAL | WindowManager.LayoutParams.FLAG_NOT_FOCUSABLE)) == 0;
  if (modal && mAppToken != null) {
    flags|=WindowManager.LayoutParams.FLAG_NOT_TOUCH_MODAL;
    if (!inFreeformWorkspace()) {
      final DimLayer.DimLayerUser dimLayerUser=getDimLayerUser();
      if (dimLayerUser != null) {
        dimLayerUser.getBounds(mTmpRect);
      }
 else {
        getVisibleBounds(mTmpRect,BOUNDS_FOR_TOUCH);
      }
    }
 else {
      getVisibleBounds(mTmpRect,BOUNDS_FOR_TOUCH);
    }
    region.set(mTmpRect);
  }
 else {
    getTouchableRegion(region);
  }
  return flags;
}
