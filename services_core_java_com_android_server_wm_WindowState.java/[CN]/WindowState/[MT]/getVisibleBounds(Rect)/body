{
  final Task task=getTask();
  boolean intersectWithStackBounds=task != null && task.cropWindowsToStackBounds();
  bounds.setEmpty();
  mTmpRect.setEmpty();
  if (intersectWithStackBounds) {
    final TaskStack stack=task.mStack;
    if (stack != null) {
      stack.getDimBounds(mTmpRect);
    }
 else {
      intersectWithStackBounds=false;
    }
  }
  bounds.set(mVisibleFrame);
  if (intersectWithStackBounds) {
    bounds.intersect(mTmpRect);
  }
  if (bounds.isEmpty()) {
    bounds.set(mFrame);
    if (intersectWithStackBounds) {
      bounds.intersect(mTmpRect);
    }
    return;
  }
}
