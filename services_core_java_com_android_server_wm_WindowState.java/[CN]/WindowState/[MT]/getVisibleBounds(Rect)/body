{
  boolean intersectWithStackBounds=mAppToken != null && mAppToken.mCropWindowsToStack;
  bounds.setEmpty();
  mTmpRect.setEmpty();
  if (intersectWithStackBounds) {
    final TaskStack stack=getStack();
    if (stack != null) {
      stack.getDimBounds(mTmpRect);
    }
 else {
      intersectWithStackBounds=false;
    }
  }
  bounds.set(mVisibleFrame);
  if (intersectWithStackBounds) {
    bounds.intersect(mTmpRect);
  }
  if (bounds.isEmpty()) {
    bounds.set(mFrame);
    if (intersectWithStackBounds) {
      bounds.intersect(mTmpRect);
    }
    return;
  }
}
