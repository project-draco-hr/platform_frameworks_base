{
  mContext=context;
  mHandler=new Handler();
  mStrongAuth=new LockSettingsStrongAuth(context);
  mLockPatternUtils=new LockPatternUtils(context);
  mFirstCallToVold=true;
  IntentFilter filter=new IntentFilter();
  filter.addAction(Intent.ACTION_USER_ADDED);
  filter.addAction(Intent.ACTION_USER_STARTING);
  filter.addAction(Intent.ACTION_USER_REMOVED);
  mContext.registerReceiverAsUser(mBroadcastReceiver,UserHandle.ALL,filter,null,null);
  mStorage=new LockSettingsStorage(context,new LockSettingsStorage.Callback(){
    @Override public void initialize(    SQLiteDatabase db){
      boolean lockScreenDisable=SystemProperties.getBoolean("ro.lockscreen.disable.default",false);
      if (lockScreenDisable) {
        mStorage.writeKeyValue(db,LockPatternUtils.DISABLE_LOCKSCREEN_KEY,"1",0);
      }
    }
  }
);
  mNotificationManager=(NotificationManager)mContext.getSystemService(Context.NOTIFICATION_SERVICE);
  mUserManager=(UserManager)mContext.getSystemService(Context.USER_SERVICE);
  mStrongAuthTracker=new SynchronizedStrongAuthTracker(mContext);
  mStrongAuthTracker.register();
}
