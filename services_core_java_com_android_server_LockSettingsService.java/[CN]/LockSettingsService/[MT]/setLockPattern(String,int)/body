{
  checkWritePermission(userId);
  maybeUpdateKeystore(pattern,userId);
  final byte[] hash=LockPatternUtils.patternToHash(LockPatternUtils.stringToPattern(pattern));
  mStorage.writePatternHash(hash,userId);
  notifyObservers(LockPatternUtilsCache.HAS_LOCK_PATTERN_CACHE_KEY,userId);
}
