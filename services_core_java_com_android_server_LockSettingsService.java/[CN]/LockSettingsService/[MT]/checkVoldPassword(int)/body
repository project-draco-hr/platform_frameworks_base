{
  if (!mFirstCallToVold) {
    return false;
  }
  mFirstCallToVold=false;
  checkPasswordReadPermission(userId);
  final IMountService service=getMountService();
  String password=service.getPassword();
  service.clearPassword();
  if (service.getPasswordType() == StorageManager.CRYPT_TYPE_PATTERN) {
    return checkPattern(password,userId);
  }
 else {
    return checkPassword(password,userId);
  }
}
