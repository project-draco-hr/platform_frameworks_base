{
  CredentialHash credential;
  byte[] currentHandle;
  int currentHandleType=mStorage.getStoredCredentialType(userId);
switch (currentHandleType) {
case CredentialHash.TYPE_PATTERN:
    credential=mStorage.readPatternHash(userId);
  currentHandle=credential != null ? credential.hash : null;
break;
case CredentialHash.TYPE_PASSWORD:
credential=mStorage.readPasswordHash(userId);
currentHandle=credential != null ? credential.hash : null;
break;
case CredentialHash.TYPE_NONE:
default :
currentHandle=null;
break;
}
if (currentHandleType != CredentialHash.TYPE_NONE && currentHandle == null) {
Slog.e(TAG,"Stored handle type [" + currentHandleType + "] but no handle available");
}
return currentHandle;
}
