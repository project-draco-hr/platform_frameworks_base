{
  checkWritePermission(userId);
  byte[] enrolledCredentialBytes=enrolledCredential == null ? null : enrolledCredential.getBytes();
  byte[] toEnrollBytes=toEnroll == null ? null : toEnroll.getBytes();
  byte[] hash=getGateKeeperService().enroll(userId,enrolledHandle,enrolledCredentialBytes,toEnrollBytes);
  if (hash != null) {
    maybeUpdateKeystore(toEnroll,userId);
  }
  return hash;
}
