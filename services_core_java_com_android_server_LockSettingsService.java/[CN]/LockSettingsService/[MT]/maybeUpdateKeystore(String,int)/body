{
  final UserManager um=(UserManager)mContext.getSystemService(USER_SERVICE);
  final KeyStore ks=KeyStore.getInstance();
  final List<UserInfo> profiles=um.getProfiles(userHandle);
  boolean shouldReset=TextUtils.isEmpty(password);
  if (userHandle == UserHandle.USER_OWNER && profiles.size() == 1) {
    if (!ks.isEmpty()) {
      shouldReset=false;
    }
  }
  for (  UserInfo pi : profiles) {
    final int profileUid=UserHandle.getUid(pi.id,Process.SYSTEM_UID);
    if (shouldReset) {
      ks.resetUid(profileUid);
    }
 else {
      ks.passwordUid(password,profileUid);
    }
  }
}
