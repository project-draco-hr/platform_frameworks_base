{
  checkPasswordReadPermission(userId);
  CredentialHash storedHash=mStorage.readPatternHash(userId);
  return verifyCredential(userId,storedHash,pattern,hasChallenge,challenge,new CredentialUtil(){
    @Override public void setCredential(    String pattern,    String oldPattern,    int userId) throws RemoteException {
      setLockPattern(pattern,oldPattern,userId);
    }
    @Override public byte[] toHash(    String pattern,    int userId){
      return mLockPatternUtils.patternToHash(mLockPatternUtils.stringToPattern(pattern));
    }
  }
);
}
