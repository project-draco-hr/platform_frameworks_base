{
  if (vcr == null) {
    throw new RemoteException("Null response verifying a credential we just set");
  }
  if (vcr.getResponseCode() != VerifyCredentialResponse.RESPONSE_OK) {
    throw new RemoteException("Non-OK response verifying a credential we just set: " + vcr.getResponseCode());
  }
  byte[] token=vcr.getPayload();
  if (token == null) {
    throw new RemoteException("Empty payload verifying a credential we just set");
  }
  addUserKeyAuth(userId,token,secretFromCredential(credential));
}
