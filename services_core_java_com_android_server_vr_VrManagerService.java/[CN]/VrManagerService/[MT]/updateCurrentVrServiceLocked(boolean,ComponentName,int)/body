{
  boolean validUserComponent=(mComponentObserver.isValid(component,userId) == EnabledComponentsObserver.NO_ERROR);
  changeVrModeLocked(enabled,(enabled && validUserComponent) ? component : null);
  if (!enabled || !validUserComponent) {
    if (mCurrentVrService != null) {
      Slog.i(TAG,"Disconnecting " + mCurrentVrService.getComponent() + " for user "+ mCurrentVrService.getUserId());
      mCurrentVrService.disconnect();
      mCurrentVrService=null;
    }
    return validUserComponent;
  }
  if (mCurrentVrService != null) {
    if (mCurrentVrService.disconnectIfNotMatching(component,userId)) {
      Slog.i(TAG,"Disconnecting " + mCurrentVrService.getComponent() + " for user "+ mCurrentVrService.getUserId());
      mCurrentVrService=VrManagerService.create(mContext,component,userId);
      mCurrentVrService.connect();
      Slog.i(TAG,"Connecting " + mCurrentVrService.getComponent() + " for user "+ mCurrentVrService.getUserId());
    }
  }
 else {
    mCurrentVrService=VrManagerService.create(mContext,component,userId);
    mCurrentVrService.connect();
    Slog.i(TAG,"Connecting " + mCurrentVrService.getComponent() + " for user "+ mCurrentVrService.getUserId());
  }
  return validUserComponent;
}
