{
  PackageManager pm=mContext.getPackageManager();
  ArraySet<ComponentName> possibleServices=EnabledComponentsObserver.loadComponentNames(pm,userId.getIdentifier(),NotificationListenerService.SERVICE_INTERFACE,android.Manifest.permission.BIND_NOTIFICATION_LISTENER_SERVICE);
  ContentResolver resolver=mContext.getContentResolver();
  ArraySet<String> current=getCurrentNotifListeners(resolver);
  for (  ComponentName c : possibleServices) {
    String flatName=c.flattenToString();
    if (Objects.equals(c.getPackageName(),pkg) && !current.contains(flatName)) {
      current.add(flatName);
    }
  }
  if (current.size() > 0) {
    String flatSettings=formatSettings(current);
    Settings.Secure.putString(resolver,Settings.Secure.ENABLED_NOTIFICATION_LISTENERS,flatSettings);
  }
}
