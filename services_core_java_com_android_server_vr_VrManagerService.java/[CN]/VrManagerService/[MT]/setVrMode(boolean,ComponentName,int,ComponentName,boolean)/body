{
synchronized (mLock) {
    if (!enabled && mCurrentVrService != null && !immediate) {
      if (mPendingState == null) {
        mHandler.sendEmptyMessageDelayed(MSG_PENDING_VR_STATE_CHANGE,PENDING_STATE_DELAY_MS);
      }
      mPendingState=new VrState(enabled,targetPackageName,userId,callingPackage);
      return;
    }
 else {
      mHandler.removeMessages(MSG_PENDING_VR_STATE_CHANGE);
      mPendingState=null;
    }
    updateCurrentVrServiceLocked(enabled,targetPackageName,userId,callingPackage);
  }
}
