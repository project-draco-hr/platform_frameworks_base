{
  if (!mGuard) {
    throw new IllegalStateException("Disabling permissions without enabling.");
  }
  mGuard=false;
  PackageManager pm=mContext.getPackageManager();
  if (pm == null) {
    Slog.e(TAG,"Couldn't remove implied permissions for " + component + ", PackageManager isn't running");
    return;
  }
  String pName=component.getPackageName();
  if (mWasDefaultGranted) {
    revokeOverlayAccess(userId);
    revokeNotificationPolicyAccess(pName);
    revokeNotificiationListenerAccess();
    mWasDefaultGranted=false;
  }
}
