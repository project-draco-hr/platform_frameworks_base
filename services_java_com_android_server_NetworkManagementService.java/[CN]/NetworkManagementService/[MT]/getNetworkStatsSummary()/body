{
  mContext.enforceCallingOrSelfPermission(android.Manifest.permission.ACCESS_NETWORK_STATE,"NetworkManagementService");
  final String[] ifaces=listInterfaces();
  final NetworkStats stats=new NetworkStats(SystemClock.elapsedRealtime(),ifaces.length);
  for (  String iface : ifaces) {
    final long rx=getInterfaceCounter(iface,true);
    final long tx=getInterfaceCounter(iface,false);
    stats.addEntry(iface,NetworkStats.UID_ALL,rx,tx);
  }
  return stats;
}
