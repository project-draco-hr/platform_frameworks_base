{
  if (mCachedException != null) {
    throw new SignatureException(mCachedException);
  }
  try {
    ensureKeystoreOperationInitialized();
  }
 catch (  InvalidKeyException e) {
    throw new SignatureException(e);
  }
  boolean verified;
  try {
    byte[] output=mMessageStreamer.doFinal(EmptyArray.BYTE,0,0,signature,null);
    if (output.length != 0) {
      throw new ProviderException("Signature verification unexpected produced output: " + output.length + " bytes");
    }
    verified=true;
  }
 catch (  KeyStoreException e) {
switch (e.getErrorCode()) {
case KeymasterDefs.KM_ERROR_VERIFICATION_FAILED:
      verified=false;
    break;
default :
  throw new SignatureException(e);
}
}
resetWhilePreservingInitState();
return verified;
}
