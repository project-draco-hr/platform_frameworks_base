{
  String body=null;
switch (encoding) {
case android.telephony.SmsMessage.ENCODING_7BIT:
    body=GsmAlphabet.gsm7BitPackedToString(pdu,offset,length * 8 / 7);
  if (hasLanguageIndicator && body != null && body.length() > 2) {
    language=body.substring(0,2);
    body=body.substring(3);
  }
break;
case android.telephony.SmsMessage.ENCODING_16BIT:
if (hasLanguageIndicator && pdu.length >= offset + 2) {
language=GsmAlphabet.gsm7BitPackedToString(pdu,offset,2);
offset+=2;
length-=2;
}
try {
body=new String(pdu,offset,(length & 0xfffe),"utf-16");
}
 catch (UnsupportedEncodingException e) {
throw new IllegalArgumentException("Error decoding UTF-16 message",e);
}
break;
default :
break;
}
if (body != null) {
for (int i=body.length() - 1; i >= 0; i--) {
if (body.charAt(i) != CARRIAGE_RETURN) {
body=body.substring(0,i + 1);
break;
}
}
}
 else {
body="";
}
return new Pair<String,String>(language,body);
}
