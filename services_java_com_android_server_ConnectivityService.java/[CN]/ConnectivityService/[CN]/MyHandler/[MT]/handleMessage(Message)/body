{
  NetworkInfo info;
switch (msg.what) {
case NetworkStateTracker.EVENT_STATE_CHANGED:
    info=(NetworkInfo)msg.obj;
  if (DBG)   Log.d(TAG,"ConnectivityChange for " + info.getTypeName() + ": "+ info.getState()+ "/"+ info.getDetailedState());
int eventLogParam=(info.getType() & 0x7) | ((info.getDetailedState().ordinal() & 0x3f) << 3) | (info.getSubtype() << 9);
EventLog.writeEvent(EVENTLOG_CONNECTIVITY_STATE_CHANGED,eventLogParam);
if (info.getDetailedState() == NetworkInfo.DetailedState.FAILED) {
handleConnectionFailure(info);
}
 else if (info.getState() == NetworkInfo.State.DISCONNECTED) {
handleDisconnect(info);
}
 else if (info.getState() == NetworkInfo.State.SUSPENDED) {
handleDisconnect(info);
}
 else if (info.getState() == NetworkInfo.State.CONNECTED) {
handleConnect(info);
}
break;
case NetworkStateTracker.EVENT_SCAN_RESULTS_AVAILABLE:
info=(NetworkInfo)msg.obj;
handleScanResultsAvailable(info);
break;
case NetworkStateTracker.EVENT_NOTIFICATION_CHANGED:
handleNotificationChange(msg.arg1 == 1,msg.arg2,(Notification)msg.obj);
case NetworkStateTracker.EVENT_CONFIGURATION_CHANGED:
handleDnsConfigurationChange();
break;
case NetworkStateTracker.EVENT_ROAMING_CHANGED:
break;
case NetworkStateTracker.EVENT_NETWORK_SUBTYPE_CHANGED:
break;
case NetworkStateTracker.EVENT_RESTORE_DEFAULT_NETWORK:
for (NetworkStateTracker net : mNetTrackers) {
NetworkInfo i=net.getNetworkInfo();
if (i.isConnected() && !mNetAttributes[i.getType()].isDefault()) {
if (DBG) {
Log.d(TAG,"tearing down " + i + " to restore the default network");
}
teardown(net);
}
}
break;
}
}
