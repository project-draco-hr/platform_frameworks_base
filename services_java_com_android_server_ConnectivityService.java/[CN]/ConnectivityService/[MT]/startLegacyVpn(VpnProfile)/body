{
  throwIfLockdownEnabled();
  final LinkProperties egress=getActiveLinkProperties();
  if (egress == null) {
    throw new IllegalStateException("Missing active network connection");
  }
  int user=UserHandle.getUserId(Binder.getCallingUid());
synchronized (mVpns) {
    mVpns.get(user).startLegacyVpn(profile,mKeyStore,egress);
  }
}
