{
  if (DBG) {
    Slog.d(TAG,"startUsingNetworkFeature for net " + networkType + ": "+ feature);
  }
  enforceChangePermission();
  if (!ConnectivityManager.isNetworkTypeValid(networkType) || mNetAttributes[networkType] == null) {
    return Phone.APN_REQUEST_FAILED;
  }
  FeatureUser f=new FeatureUser(networkType,feature,binder);
  int usedNetworkType=networkType;
  if (networkType == ConnectivityManager.TYPE_MOBILE) {
    if (!getMobileDataEnabled()) {
      if (DBG)       Slog.d(TAG,"requested special network with data disabled - rejected");
      return Phone.APN_TYPE_NOT_AVAILABLE;
    }
    if (TextUtils.equals(feature,Phone.FEATURE_ENABLE_MMS)) {
      usedNetworkType=ConnectivityManager.TYPE_MOBILE_MMS;
    }
 else     if (TextUtils.equals(feature,Phone.FEATURE_ENABLE_SUPL)) {
      usedNetworkType=ConnectivityManager.TYPE_MOBILE_SUPL;
    }
 else     if (TextUtils.equals(feature,Phone.FEATURE_ENABLE_DUN)) {
      usedNetworkType=ConnectivityManager.TYPE_MOBILE_DUN;
    }
 else     if (TextUtils.equals(feature,Phone.FEATURE_ENABLE_HIPRI)) {
      usedNetworkType=ConnectivityManager.TYPE_MOBILE_HIPRI;
    }
  }
  NetworkStateTracker network=mNetTrackers[usedNetworkType];
  if (network != null) {
    if (usedNetworkType != networkType) {
      Integer currentPid=new Integer(getCallingPid());
      NetworkStateTracker radio=mNetTrackers[networkType];
      NetworkInfo ni=network.getNetworkInfo();
      if (ni.isAvailable() == false) {
        if (DBG)         Slog.d(TAG,"special network not available");
        return Phone.APN_TYPE_NOT_AVAILABLE;
      }
synchronized (this) {
        mFeatureUsers.add(f);
        if (!mNetRequestersPids[usedNetworkType].contains(currentPid)) {
          mNetRequestersPids[usedNetworkType].add(currentPid);
        }
      }
      mHandler.sendMessageDelayed(mHandler.obtainMessage(EVENT_RESTORE_DEFAULT_NETWORK,f),getRestoreDefaultNetworkDelay());
      if ((ni.isConnectedOrConnecting() == true) && !network.isTeardownRequested()) {
        if (ni.isConnected() == true) {
          handleDnsConfigurationChange(networkType);
          if (DBG)           Slog.d(TAG,"special network already active");
          return Phone.APN_ALREADY_ACTIVE;
        }
        if (DBG)         Slog.d(TAG,"special network already connecting");
        return Phone.APN_REQUEST_STARTED;
      }
      if (DBG)       Slog.d(TAG,"reconnecting to special network");
      network.reconnect();
      return Phone.APN_REQUEST_STARTED;
    }
 else {
synchronized (this) {
        mFeatureUsers.add(f);
      }
      mHandler.sendMessageDelayed(mHandler.obtainMessage(EVENT_RESTORE_DEFAULT_NETWORK,f),getRestoreDefaultNetworkDelay());
      return network.startUsingNetworkFeature(feature,getCallingPid(),getCallingUid());
    }
  }
  return Phone.APN_TYPE_NOT_AVAILABLE;
}
