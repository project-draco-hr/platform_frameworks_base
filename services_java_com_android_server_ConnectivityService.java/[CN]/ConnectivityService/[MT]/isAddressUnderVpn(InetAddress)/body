{
synchronized (mVpns) {
synchronized (mRoutesLock) {
      int uid=UserHandle.getCallingUserId();
      Vpn vpn=mVpns.get(uid);
      if (vpn == null) {
        return false;
      }
      for (      LinkAddress destination : mExemptAddresses) {
        if (!NetworkUtils.addressTypeMatches(address,destination.getAddress())) {
          continue;
        }
        int prefix=destination.getNetworkPrefixLength();
        InetAddress addrMasked=NetworkUtils.getNetworkPart(address,prefix);
        InetAddress destMasked=NetworkUtils.getNetworkPart(destination.getAddress(),prefix);
        if (addrMasked.equals(destMasked)) {
          return false;
        }
      }
      return vpn.isAddressCovered(address);
    }
  }
}
