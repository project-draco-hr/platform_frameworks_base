{
  NetworkStateTracker nt=mNetTrackers[netType];
  if (nt != null && nt.getNetworkInfo().isConnected() && !nt.isTeardownRequested()) {
    LinkProperties p=nt.getLinkProperties();
    if (p == null)     return;
    Collection<InetAddress> dnses=p.getDnses();
    if (mNetAttributes[netType].isDefault()) {
      int j=1;
      if (dnses.size() == 0 && mDefaultDns != null) {
        if (DBG) {
          Slog.d(TAG,"no dns provided - using " + mDefaultDns.getHostAddress());
        }
        SystemProperties.set("net.dns1",mDefaultDns.getHostAddress());
        j++;
      }
 else {
        for (        InetAddress dns : dnses) {
          if (DBG) {
            Slog.d(TAG,"adding dns " + dns + " for "+ nt.getNetworkInfo().getTypeName());
          }
          SystemProperties.set("net.dns" + j++,dns.getHostAddress());
        }
      }
      for (int k=j; k < mNumDnsEntries; k++) {
        if (DBG)         Slog.d(TAG,"erasing net.dns" + k);
        SystemProperties.set("net.dns" + k,"");
      }
      mNumDnsEntries=j;
    }
 else {
      List pids=mNetRequestersPids[netType];
      for (int y=0; y < pids.size(); y++) {
        Integer pid=(Integer)pids.get(y);
        writePidDns(dnses,pid.intValue());
      }
    }
    bumpDns();
  }
}
