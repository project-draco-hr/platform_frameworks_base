{
  NetworkStateTracker newNet=null;
  if (mNetAttributes[prevNetType].isDefault()) {
    if (mActiveDefaultNetwork == prevNetType) {
      mActiveDefaultNetwork=-1;
    }
    int newType=-1;
    int newPriority=-1;
    boolean noMobileData=!getMobileDataEnabled();
    for (int checkType=0; checkType <= ConnectivityManager.MAX_NETWORK_TYPE; checkType++) {
      if (checkType == prevNetType)       continue;
      if (mNetAttributes[checkType] == null)       continue;
      if (mNetAttributes[checkType].mRadio == ConnectivityManager.TYPE_MOBILE && noMobileData) {
        if (DBG) {
          Slog.d(TAG,"not failing over to mobile type " + checkType + " because Mobile Data Disabled");
        }
        continue;
      }
      if (mNetAttributes[checkType].isDefault()) {
        if (checkType == mNetworkPreference) {
          newType=checkType;
          break;
        }
        if (mNetAttributes[checkType].mPriority > newPriority) {
          newType=checkType;
          newPriority=mNetAttributes[newType].mPriority;
        }
      }
    }
    if (newType != -1) {
      newNet=mNetTrackers[newType];
      if (newNet.isAvailable()) {
        NetworkInfo switchTo=newNet.getNetworkInfo();
        switchTo.setFailover(true);
        if (!switchTo.isConnectedOrConnecting() || newNet.isTeardownRequested()) {
          newNet.reconnect();
        }
        if (DBG) {
          if (switchTo.isConnected()) {
            Slog.v(TAG,"Switching to already connected " + switchTo.getTypeName());
          }
 else {
            Slog.v(TAG,"Attempting to switch to " + switchTo.getTypeName());
          }
        }
      }
 else {
        newNet.reconnect();
        newNet=null;
      }
    }
  }
  return newNet;
}
