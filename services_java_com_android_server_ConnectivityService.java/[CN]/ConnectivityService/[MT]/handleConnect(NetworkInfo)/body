{
  int type=info.getType();
  boolean isFailover=info.isFailover();
  NetworkStateTracker thisNet=mNetTrackers[type];
  if (mNetAttributes[type].isDefault()) {
    if (mActiveDefaultNetwork != -1 && mActiveDefaultNetwork != type) {
      if ((type != mNetworkPreference && mNetAttributes[mActiveDefaultNetwork].mPriority > mNetAttributes[type].mPriority) || mNetworkPreference == mActiveDefaultNetwork) {
        if (DBG)         Slog.v(TAG,"Not broadcasting CONNECT_ACTION " + "to torn down network " + info.getTypeName());
        teardown(thisNet);
        return;
      }
 else {
        NetworkStateTracker otherNet=mNetTrackers[mActiveDefaultNetwork];
        if (DBG)         Slog.v(TAG,"Policy requires " + otherNet.getNetworkInfo().getTypeName() + " teardown");
        if (!teardown(otherNet)) {
          Slog.e(TAG,"Network declined teardown request");
          return;
        }
      }
    }
synchronized (ConnectivityService.this) {
      if (mNetTransitionWakeLock.isHeld()) {
        mHandler.sendMessageDelayed(mHandler.obtainMessage(NetworkStateTracker.EVENT_CLEAR_NET_TRANSITION_WAKELOCK,mNetTransitionWakeLockSerialNumber,0),1000);
      }
    }
    mActiveDefaultNetwork=type;
  }
  thisNet.setTeardownRequested(false);
  updateNetworkSettings(thisNet);
  handleConnectivityChange(type);
  sendConnectedBroadcast(info);
}
