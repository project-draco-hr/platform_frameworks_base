{
  int prevNetType=info.getType();
  mNetTrackers[prevNetType].setTeardownRequested(false);
  if (!mNetConfigs[prevNetType].isDefault()) {
    List pids=mNetRequestersPids[prevNetType];
    for (int i=0; i < pids.size(); i++) {
      Integer pid=(Integer)pids.get(i);
      reassessPidDns(pid.intValue(),false);
    }
  }
  Intent intent=new Intent(ConnectivityManager.CONNECTIVITY_ACTION);
  intent.putExtra(ConnectivityManager.EXTRA_NETWORK_INFO,info);
  if (info.isFailover()) {
    intent.putExtra(ConnectivityManager.EXTRA_IS_FAILOVER,true);
    info.setFailover(false);
  }
  if (info.getReason() != null) {
    intent.putExtra(ConnectivityManager.EXTRA_REASON,info.getReason());
  }
  if (info.getExtraInfo() != null) {
    intent.putExtra(ConnectivityManager.EXTRA_EXTRA_INFO,info.getExtraInfo());
  }
  if (mNetConfigs[prevNetType].isDefault()) {
    tryFailover(prevNetType);
    if (mActiveDefaultNetwork != -1) {
      NetworkInfo switchTo=mNetTrackers[mActiveDefaultNetwork].getNetworkInfo();
      intent.putExtra(ConnectivityManager.EXTRA_OTHER_NETWORK_INFO,switchTo);
    }
 else {
      mDefaultInetConditionPublished=0;
      intent.putExtra(ConnectivityManager.EXTRA_NO_CONNECTIVITY,true);
    }
  }
  intent.putExtra(ConnectivityManager.EXTRA_INET_CONDITION,mDefaultInetConditionPublished);
  boolean doReset=true;
  LinkProperties linkProperties=mNetTrackers[prevNetType].getLinkProperties();
  if (linkProperties != null) {
    String oldIface=linkProperties.getInterfaceName();
    if (TextUtils.isEmpty(oldIface) == false) {
      for (      NetworkStateTracker networkStateTracker : mNetTrackers) {
        if (networkStateTracker == null)         continue;
        NetworkInfo networkInfo=networkStateTracker.getNetworkInfo();
        if (networkInfo.isConnected() && networkInfo.getType() != prevNetType) {
          LinkProperties l=networkStateTracker.getLinkProperties();
          if (l == null)           continue;
          if (oldIface.equals(l.getInterfaceName())) {
            doReset=false;
            break;
          }
        }
      }
    }
  }
  handleConnectivityChange(prevNetType,doReset);
  sendStickyBroadcast(intent);
  if (mActiveDefaultNetwork != -1) {
    sendConnectedBroadcast(mNetTrackers[mActiveDefaultNetwork].getNetworkInfo());
  }
}
