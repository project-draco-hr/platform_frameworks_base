{
  if (DBG)   Log.v(TAG,"Handle DISCONNECT for " + info.getTypeName());
  mNetTrackers[info.getType()].setTeardownRequested(false);
  if (mActiveNetwork == null || info.getType() != mActiveNetwork.getNetworkInfo().getType())   return;
  NetworkStateTracker newNet;
  if (info.getType() == ConnectivityManager.TYPE_MOBILE) {
    newNet=mWifiStateTracker;
  }
 else {
    newNet=mMobileDataStateTracker;
  }
  NetworkInfo switchTo=null;
  if (newNet.isAvailable()) {
    mActiveNetwork=newNet;
    switchTo=newNet.getNetworkInfo();
    switchTo.setFailover(true);
    if (!switchTo.isConnectedOrConnecting()) {
      newNet.reconnect();
    }
  }
 else {
    newNet.reconnect();
  }
  boolean otherNetworkConnected=false;
  Intent intent=new Intent(ConnectivityManager.CONNECTIVITY_ACTION);
  intent.putExtra(ConnectivityManager.EXTRA_NETWORK_INFO,info);
  if (info.isFailover()) {
    intent.putExtra(ConnectivityManager.EXTRA_IS_FAILOVER,true);
    info.setFailover(false);
  }
  if (info.getReason() != null) {
    intent.putExtra(ConnectivityManager.EXTRA_REASON,info.getReason());
  }
  if (info.getExtraInfo() != null) {
    intent.putExtra(ConnectivityManager.EXTRA_EXTRA_INFO,info.getExtraInfo());
  }
  if (switchTo != null) {
    otherNetworkConnected=switchTo.isConnected();
    if (DBG) {
      if (otherNetworkConnected) {
        Log.v(TAG,"Switching to already connected " + switchTo.getTypeName());
      }
 else {
        Log.v(TAG,"Attempting to switch to " + switchTo.getTypeName());
      }
    }
    intent.putExtra(ConnectivityManager.EXTRA_OTHER_NETWORK_INFO,switchTo);
  }
 else {
    intent.putExtra(ConnectivityManager.EXTRA_NO_CONNECTIVITY,true);
  }
  if (DBG)   Log.v(TAG,"Sending DISCONNECT bcast for " + info.getTypeName() + (switchTo == null ? "" : " other=" + switchTo.getTypeName()));
  mContext.sendStickyBroadcast(intent);
  if (switchTo != null && otherNetworkConnected)   sendConnectedBroadcast(switchTo);
}
