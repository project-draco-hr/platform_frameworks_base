{
  if (TextUtils.isEmpty(name) || ".".equals(name) || "..".equals(name)) {
    return "(invalid)";
  }
  final StringBuilder res=new StringBuilder(name.length());
  for (int i=0; i < name.length(); i++) {
    final char c=name.charAt(i);
    if (isValidFatFilenameChar(c)) {
      res.append(c);
    }
 else {
      res.append('_');
    }
  }
  trimFilename(res,255);
  return res.toString();
}
