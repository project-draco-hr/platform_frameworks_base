{
  final Uri bugreportUri;
  try {
    bugreportUri=getUri(context,info.bugreportFile);
  }
 catch (  IllegalArgumentException e) {
    Log.wtf(TAG,"Could not get URI for " + info.bugreportFile,e);
    return null;
  }
  final Intent intent=new Intent(Intent.ACTION_SEND_MULTIPLE);
  final String mimeType="application/vnd.android.bugreport";
  intent.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION);
  intent.addCategory(Intent.CATEGORY_DEFAULT);
  intent.setType(mimeType);
  final String subject=!TextUtils.isEmpty(info.title) ? info.title : bugreportUri.getLastPathSegment();
  intent.putExtra(Intent.EXTRA_SUBJECT,subject);
  final StringBuilder messageBody=new StringBuilder("Build info: ").append(SystemProperties.get("ro.build.description")).append("\nSerial number: ").append(SystemProperties.get("ro.serialno"));
  if (!TextUtils.isEmpty(info.description)) {
    messageBody.append("\nDescription: ").append(info.description);
  }
  intent.putExtra(Intent.EXTRA_TEXT,messageBody.toString());
  final ClipData clipData=new ClipData(null,new String[]{mimeType},new ClipData.Item(null,null,null,bugreportUri));
  final ArrayList<Uri> attachments=Lists.newArrayList(bugreportUri);
  for (  File screenshot : info.screenshotFiles) {
    final Uri screenshotUri=getUri(context,screenshot);
    clipData.addItem(new ClipData.Item(null,null,null,screenshotUri));
    attachments.add(screenshotUri);
  }
  intent.setClipData(clipData);
  intent.putParcelableArrayListExtra(Intent.EXTRA_STREAM,attachments);
  final Account sendToAccount=findSendToAccount(context);
  if (sendToAccount != null) {
    intent.putExtra(Intent.EXTRA_EMAIL,new String[]{sendToAccount.name});
  }
  return intent;
}
