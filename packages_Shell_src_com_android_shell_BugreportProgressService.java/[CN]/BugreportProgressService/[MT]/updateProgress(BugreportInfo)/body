{
  if (info.max <= 0 || info.progress < 0) {
    Log.e(TAG,"Invalid progress values for " + info);
    return;
  }
  final NumberFormat nf=NumberFormat.getPercentInstance();
  nf.setMinimumFractionDigits(2);
  nf.setMaximumFractionDigits(2);
  final String percentText=nf.format((double)info.progress / info.max);
  final Action cancelAction=new Action.Builder(null,mContext.getString(com.android.internal.R.string.cancel),newCancelIntent(mContext,info)).build();
  final Intent infoIntent=new Intent(mContext,BugreportProgressService.class);
  infoIntent.setAction(INTENT_BUGREPORT_INFO_LAUNCH);
  infoIntent.putExtra(EXTRA_PID,info.pid);
  final Action infoAction=new Action.Builder(null,mContext.getString(R.string.bugreport_info_action),PendingIntent.getService(mContext,info.pid,infoIntent,PendingIntent.FLAG_UPDATE_CURRENT)).build();
  final Intent screenshotIntent=new Intent(mContext,BugreportProgressService.class);
  screenshotIntent.setAction(INTENT_BUGREPORT_SCREENSHOT);
  screenshotIntent.putExtra(EXTRA_PID,info.pid);
  PendingIntent screenshotPendingIntent=mTakingScreenshot ? null : PendingIntent.getService(mContext,info.pid,screenshotIntent,PendingIntent.FLAG_UPDATE_CURRENT);
  final Action screenshotAction=new Action.Builder(null,mContext.getString(R.string.bugreport_screenshot_action),screenshotPendingIntent).build();
  final String title=mContext.getString(R.string.bugreport_in_progress_title);
  final String name=info.name != null ? info.name : mContext.getString(R.string.bugreport_unnamed);
  final Notification notification=new Notification.Builder(mContext).setSmallIcon(com.android.internal.R.drawable.stat_sys_adb).setContentTitle(title).setTicker(title).setContentText(name).setContentInfo(percentText).setProgress(info.max,info.progress,false).setOngoing(true).setLocalOnly(true).setColor(mContext.getColor(com.android.internal.R.color.system_notification_accent_color)).addAction(infoAction).addAction(screenshotAction).addAction(cancelAction).build();
  if (info.finished) {
    Log.w(TAG,"Not sending progress notification because bugreport has finished already (" + info + ")");
    return;
  }
  Log.v(TAG,"Sending 'Progress' notification for pid " + info.pid + ": "+ percentText);
  NotificationManager.from(mContext).notify(TAG,info.pid,notification);
}
