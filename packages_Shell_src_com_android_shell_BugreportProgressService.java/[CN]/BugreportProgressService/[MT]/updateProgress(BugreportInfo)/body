{
  if (info.max <= 0 || info.progress < 0) {
    Log.e(TAG,"Invalid progress values for " + info);
    return;
  }
  final NumberFormat nf=NumberFormat.getPercentInstance();
  nf.setMinimumFractionDigits(2);
  nf.setMaximumFractionDigits(2);
  final String percentageText=nf.format((double)info.progress / info.max);
  final Action cancelAction=new Action.Builder(null,mContext.getString(com.android.internal.R.string.cancel),newCancelIntent(mContext,info)).build();
  final Intent infoIntent=new Intent(mContext,BugreportProgressService.class);
  infoIntent.setAction(INTENT_BUGREPORT_INFO_LAUNCH);
  infoIntent.putExtra(EXTRA_ID,info.id);
  final PendingIntent infoPendingIntent=PendingIntent.getService(mContext,info.id,infoIntent,PendingIntent.FLAG_UPDATE_CURRENT);
  final Action infoAction=new Action.Builder(null,mContext.getString(R.string.bugreport_info_action),infoPendingIntent).build();
  final Intent screenshotIntent=new Intent(mContext,BugreportProgressService.class);
  screenshotIntent.setAction(INTENT_BUGREPORT_SCREENSHOT);
  screenshotIntent.putExtra(EXTRA_ID,info.id);
  PendingIntent screenshotPendingIntent=mTakingScreenshot ? null : PendingIntent.getService(mContext,info.id,screenshotIntent,PendingIntent.FLAG_UPDATE_CURRENT);
  final Action screenshotAction=new Action.Builder(null,mContext.getString(R.string.bugreport_screenshot_action),screenshotPendingIntent).build();
  final String title=mContext.getString(R.string.bugreport_in_progress_title,info.id);
  final String name=info.name != null ? info.name : mContext.getString(R.string.bugreport_unnamed);
  final Notification notification=newBaseNotification(mContext).setContentTitle(title).setTicker(title).setContentText(name).setProgress(info.max,info.progress,false).setOngoing(true).setContentIntent(infoPendingIntent).setActions(infoAction,screenshotAction,cancelAction).build();
  if (info.finished) {
    Log.w(TAG,"Not sending progress notification because bugreport has finished already (" + info + ")");
    return;
  }
  if (DEBUG) {
    Log.d(TAG,"Sending 'Progress' notification for id " + info.id + " (pid "+ info.pid+ "): "+ percentageText);
  }
  sendForegroundabledNotification(info.id,notification);
}
