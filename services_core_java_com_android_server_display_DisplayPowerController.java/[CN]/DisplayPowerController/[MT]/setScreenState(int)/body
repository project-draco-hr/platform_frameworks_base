{
  if (mPowerState.getScreenState() != state) {
    final boolean wasOn=(mPowerState.getScreenState() != Display.STATE_OFF);
    mPowerState.setScreenState(state);
    try {
      mBatteryStats.noteScreenState(state);
    }
 catch (    RemoteException ex) {
    }
  }
  final boolean isOff=(state == Display.STATE_OFF);
  if (isOff && mReportedScreenStateToPolicy != REPORTED_TO_POLICY_SCREEN_OFF && !mScreenOffBecauseOfProximity) {
    mReportedScreenStateToPolicy=REPORTED_TO_POLICY_SCREEN_OFF;
    unblockScreenOn();
    mWindowManagerPolicy.screenTurnedOff();
  }
 else   if (!isOff && mReportedScreenStateToPolicy == REPORTED_TO_POLICY_SCREEN_OFF) {
    mReportedScreenStateToPolicy=REPORTED_TO_POLICY_SCREEN_TURNING_ON;
    if (mPowerState.getColorFadeLevel() == 0.0f) {
      blockScreenOn();
    }
 else {
      unblockScreenOn();
    }
    mWindowManagerPolicy.screenTurningOn(mPendingScreenOnUnblocker);
  }
  return mPendingScreenOnUnblocker == null;
}
