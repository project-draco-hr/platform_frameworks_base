{
  if (mBuffer.remaining() < 1)   return null;
switch (mBuffer.get()) {
case INT:
    if (mBuffer.remaining() < 4)     return null;
  return mBuffer.getInt();
case LONG:
if (mBuffer.remaining() < 8) return null;
return mBuffer.getLong();
case STRING:
try {
if (mBuffer.remaining() < 4) return null;
int length=mBuffer.getInt();
if (length < 0 || mBuffer.remaining() < length) return null;
int start=mBuffer.position();
mBuffer.position(start + length);
return new String(mBuffer.array(),start,length,"UTF-8");
}
 catch (UnsupportedEncodingException e) {
throw new RuntimeException(e);
}
case LIST:
if (mBuffer.remaining() < 1) return null;
int length=mBuffer.get();
if (length <= 0) return null;
Object[] array=new Object[length];
for (int i=0; i < length; ++i) {
array[i]=decodeObject();
if (array[i] == null) return null;
}
return new List(array);
default :
return null;
}
}
