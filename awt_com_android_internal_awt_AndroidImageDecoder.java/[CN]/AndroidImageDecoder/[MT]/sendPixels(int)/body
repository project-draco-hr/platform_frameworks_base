{
  int w=imageWidth;
  int h=imageHeight;
  int n=1;
  if (nbOfLinesPerChunk > 0 && nbOfLinesPerChunk <= h) {
    n=nbOfLinesPerChunk;
  }
  if (transferInts) {
    intOut=new int[w * n];
    for (int yi=0; yi < h; yi+=n) {
      if (n > 1 && h - yi < n) {
        n=h - yi;
      }
      bm.getPixels(intOut,0,w,0,yi,w,n);
      setPixels(0,yi,w,n,model,intOut,0,w);
    }
  }
 else {
    throw new RuntimeException("Byte transfer not supported");
  }
}
