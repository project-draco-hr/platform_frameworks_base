{
  if (DEBUG)   Log.i(TAG,"POSTED " + sbn.getKey());
  try {
    List<String> notificationsToBundle=new ArrayList<>();
    if (!sbn.isGroup()) {
synchronized (mUnbundledNotifications) {
        LinkedHashSet<String> notificationsForPackage=mUnbundledNotifications.get(sbn.getPackageName());
        if (notificationsForPackage == null) {
          notificationsForPackage=new LinkedHashSet<>();
        }
        notificationsForPackage.add(sbn.getKey());
        mUnbundledNotifications.put(sbn.getPackageName(),notificationsForPackage);
        if (notificationsForPackage.size() >= AUTOBUNDLE_AT_COUNT) {
          int count=0;
          for (          String key : notificationsForPackage) {
            if (count < notificationsForPackage.size() - 1) {
              notificationsToBundle.add(key);
            }
            count++;
          }
        }
      }
      if (notificationsToBundle.size() > 0) {
        adjustAutobundlingSummary(sbn.getPackageName(),notificationsToBundle.get(0),true);
        adjustNotificationBundling(sbn.getPackageName(),notificationsToBundle,true);
      }
    }
 else {
      maybeUnbundle(sbn,false);
    }
  }
 catch (  Exception e) {
    Slog.e(TAG,"Failure processing new notification",e);
  }
}
