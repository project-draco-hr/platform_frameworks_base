{
  super.onCreate(icicle);
  Intent intent=getIntent();
  mDevice=(UsbDevice)intent.getParcelableExtra(UsbManager.EXTRA_DEVICE);
  mAccessory=(UsbAccessory)intent.getParcelableExtra(UsbManager.EXTRA_ACCESSORY);
  mResolveInfo=(ResolveInfo)intent.getParcelableExtra("rinfo");
  PackageManager packageManager=getPackageManager();
  String appName=mResolveInfo.loadLabel(packageManager).toString();
  final AlertController.AlertParams ap=mAlertParams;
  ap.mIcon=mResolveInfo.loadIcon(packageManager);
  ap.mTitle=appName;
  if (mDevice == null) {
    ap.mMessage=getString(R.string.usb_accessory_confirm_prompt,appName);
    mDisconnectedReceiver=new UsbDisconnectedReceiver(this,mAccessory);
  }
 else {
    ap.mMessage=getString(R.string.usb_device_confirm_prompt,appName);
    mDisconnectedReceiver=new UsbDisconnectedReceiver(this,mDevice);
  }
  ap.mPositiveButtonText=getString(com.android.internal.R.string.ok);
  ap.mNegativeButtonText=getString(com.android.internal.R.string.cancel);
  ap.mPositiveButtonListener=this;
  ap.mNegativeButtonListener=this;
  LayoutInflater inflater=(LayoutInflater)getSystemService(Context.LAYOUT_INFLATER_SERVICE);
  ap.mView=inflater.inflate(com.android.internal.R.layout.always_use_checkbox,null);
  mAlwaysUse=(CheckBox)ap.mView.findViewById(com.android.internal.R.id.alwaysUse);
  mAlwaysUse.setText(com.android.internal.R.string.alwaysUse);
  mAlwaysUse.setOnCheckedChangeListener(this);
  mClearDefaultHint=(TextView)ap.mView.findViewById(com.android.internal.R.id.clearDefaultHint);
  mClearDefaultHint.setVisibility(View.GONE);
  setupAlert();
}
