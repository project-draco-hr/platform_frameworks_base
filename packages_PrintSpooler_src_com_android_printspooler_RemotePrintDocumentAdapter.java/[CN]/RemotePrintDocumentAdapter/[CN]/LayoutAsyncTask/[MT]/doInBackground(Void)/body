{
synchronized (mLock) {
    if (mState != STATE_START_COMPLETED && mState != STATE_LAYOUT_COMPLETED && mState != STATE_WRITE_COMPLETED) {
      throw new IllegalStateException("Invalid state: " + mState);
    }
  }
  try {
    mRemoteInterface.layout(mOldAttributes,mNewAttributes,mILayoutResultCallback);
synchronized (mLock) {
      while (true) {
        if (isCancelled()) {
          mState=STATE_INITIALIZED;
          mTaskQueue.remove(this);
          break;
        }
        if (mCompleted) {
          mState=STATE_LAYOUT_COMPLETED;
          mTaskQueue.remove(this);
          break;
        }
        try {
          mLock.wait();
        }
 catch (        InterruptedException ie) {
        }
      }
    }
  }
 catch (  RemoteException re) {
    Slog.e(LOG_TAG,"Error calling layout",re);
    mState=STATE_INITIALIZED;
  }
  return null;
}
