{
  HashMap<ComponentName,SearchableInfo> newSearchablesMap=new HashMap<ComponentName,SearchableInfo>();
  ArrayList<SearchableInfo> newSearchablesList=new ArrayList<SearchableInfo>();
  final PackageManager pm=context.getPackageManager();
  List<ResolveInfo> infoList;
  final Intent intent=new Intent(Intent.ACTION_SEARCH);
  infoList=pm.queryIntentActivities(intent,PackageManager.GET_META_DATA);
  if (infoList != null) {
    int count=infoList.size();
    for (int ii=0; ii < count; ii++) {
      ResolveInfo info=infoList.get(ii);
      ActivityInfo ai=info.activityInfo;
      XmlResourceParser xml=ai.loadXmlMetaData(context.getPackageManager(),MD_LABEL_SEARCHABLE);
      if (xml == null) {
        continue;
      }
      ComponentName cName=new ComponentName(info.activityInfo.packageName,info.activityInfo.name);
      SearchableInfo searchable=getActivityMetaData(context,xml,cName);
      xml.close();
      if (searchable != null) {
        searchable.mCacheActivityContext=null;
        newSearchablesList.add(searchable);
        newSearchablesMap.put(cName,searchable);
      }
    }
  }
synchronized (SearchableInfo.class) {
    sSearchablesList=newSearchablesList;
    sSearchablesMap=newSearchablesMap;
  }
}
