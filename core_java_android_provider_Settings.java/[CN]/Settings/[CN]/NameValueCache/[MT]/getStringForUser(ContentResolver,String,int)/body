{
  final boolean isSelf=(userHandle == UserHandle.myUserId());
  if (isSelf) {
    long newValuesVersion=SystemProperties.getLong(mVersionSystemProperty,0);
synchronized (this) {
      if (mValuesVersion != newValuesVersion) {
        if (LOCAL_LOGV || false) {
          Log.v(TAG,"invalidate [" + mUri.getLastPathSegment() + "]: current "+ newValuesVersion+ " != cached "+ mValuesVersion);
        }
        mValues.clear();
        mValuesVersion=newValuesVersion;
      }
      if (mValues.containsKey(name)) {
        return mValues.get(name);
      }
    }
  }
 else {
    if (LOCAL_LOGV)     Log.v(TAG,"get setting for user " + userHandle + " by user "+ UserHandle.myUserId()+ " so skipping cache");
  }
  IContentProvider cp=lazyGetProvider(cr);
  if (mCallGetCommand != null) {
    try {
      Bundle args=null;
      if (!isSelf) {
        args=new Bundle();
        args.putInt(CALL_METHOD_USER_KEY,userHandle);
      }
      Bundle b=cp.call(cr.getPackageName(),mCallGetCommand,name,args);
      if (b != null) {
        String value=b.getPairValue();
        if (isSelf) {
synchronized (this) {
            mValues.put(name,value);
          }
        }
 else {
          if (LOCAL_LOGV)           Log.i(TAG,"call-query of user " + userHandle + " by "+ UserHandle.myUserId()+ " so not updating cache");
        }
        return value;
      }
    }
 catch (    RemoteException e) {
    }
  }
  Cursor c=null;
  try {
    c=cp.query(cr.getPackageName(),mUri,SELECT_VALUE,NAME_EQ_PLACEHOLDER,new String[]{name},null,null);
    if (c == null) {
      Log.w(TAG,"Can't get key " + name + " from "+ mUri);
      return null;
    }
    String value=c.moveToNext() ? c.getString(0) : null;
synchronized (this) {
      mValues.put(name,value);
    }
    if (LOCAL_LOGV) {
      Log.v(TAG,"cache miss [" + mUri.getLastPathSegment() + "]: "+ name+ " = "+ (value == null ? "(null)" : value));
    }
    return value;
  }
 catch (  RemoteException e) {
    Log.w(TAG,"Can't get key " + name + " from "+ mUri,e);
    return null;
  }
 finally {
    if (c != null)     c.close();
  }
}
