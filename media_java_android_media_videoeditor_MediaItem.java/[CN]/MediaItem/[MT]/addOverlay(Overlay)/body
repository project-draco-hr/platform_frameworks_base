{
  if (mOverlays.contains(overlay)) {
    throw new IllegalArgumentException("Overlay already exists: " + overlay.getId());
  }
  if (overlay.getStartTime() + overlay.getDuration() > getDuration()) {
    throw new IllegalArgumentException("Overlay start time + overlay duration > media clip duration");
  }
  if (overlay instanceof OverlayFrame) {
    final OverlayFrame frame=(OverlayFrame)overlay;
    final Bitmap bitmap=frame.getBitmap();
    if (bitmap == null) {
      throw new IllegalArgumentException("Overlay bitmap not specified");
    }
    if (bitmap.getWidth() != getWidth() || bitmap.getHeight() != getHeight()) {
      throw new IllegalArgumentException("Bitmap dimensions must match media item dimensions");
    }
  }
 else {
    throw new IllegalArgumentException("Overlay not supported");
  }
  mOverlays.add(overlay);
  invalidateTransitions(overlay);
}
