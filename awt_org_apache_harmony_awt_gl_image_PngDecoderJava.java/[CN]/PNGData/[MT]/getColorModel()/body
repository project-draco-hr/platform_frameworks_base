{
  short colorType=getColorType();
  int bitsPerPixel=getBitsPerPixel();
  if (colorType == 3) {
    byte[] paletteData=getChunk("PLTE").getData();
    int paletteLength=paletteData.length / 3;
    return new IndexColorModel(bitsPerPixel,paletteLength,paletteData,0,false);
  }
  System.out.println("Unsupported color type: " + colorType);
  return null;
}
