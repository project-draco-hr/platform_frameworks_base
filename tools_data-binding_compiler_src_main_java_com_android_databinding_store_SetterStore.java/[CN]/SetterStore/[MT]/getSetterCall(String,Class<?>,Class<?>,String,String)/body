{
  L.d("getting setter call for %s %s %s %s %s",attribute,viewType,valueType,viewExpression,valueExpression);
  if (!attribute.startsWith("android:")) {
    int colon=attribute.indexOf(':');
    if (colon >= 0) {
      attribute=attribute.substring(colon + 1);
    }
  }
  ArrayList<AdaptedMethod> adapters=mAdaptedMethods.get(attribute);
  L.d("returned adapter count %d",adapters == null ? -1 : adapters.size());
  AdaptedMethod adapter=null;
  String setterName=null;
  Method bestSetterMethod=getBestSetter(viewType,valueType,attribute);
  L.d("setter method: %s",bestSetterMethod == null ? "null" : bestSetterMethod.getName());
  Class<?> bestViewType=null;
  Class<?> bestValueType=null;
  if (bestSetterMethod != null) {
    bestViewType=bestSetterMethod.getDeclaringClass();
    bestValueType=bestSetterMethod.getParameterTypes()[0];
    setterName=bestSetterMethod.getName();
  }
  if (adapters != null) {
    for (    AdaptedMethod adaptedMethod : adapters) {
      L.d("checking adapter method %s",adaptedMethod);
      if (adaptedMethod.viewType.isAssignableFrom(viewType)) {
        boolean isBetterView=bestViewType == null || bestValueType.isAssignableFrom(adaptedMethod.valueType);
        if (isBetterParameter(valueType,adaptedMethod.valueType,bestValueType,isBetterView)) {
          bestViewType=adaptedMethod.viewType;
          bestValueType=adaptedMethod.valueType;
          adapter=adaptedMethod;
          L.d("chosen %s",adaptedMethod);
        }
 else {
          L.d("not better");
        }
      }
 else {
        L.d("not assignable");
      }
    }
  }
  ConversionMethod conversionMethod=getConversionMethod(valueType,bestValueType);
  if (conversionMethod != null) {
    valueExpression=conversionMethod.type + "." + conversionMethod.method+ "("+ valueExpression+ ")";
  }
  if (adapter == null) {
    if (setterName == null) {
      setterName=getDefaultSetter(attribute);
    }
    return viewExpression + "." + setterName+ "("+ valueExpression+ ")";
  }
 else {
    return adapter.type + "." + adapter.method+ "("+ viewExpression+ ", "+ valueExpression+ ")";
  }
}
